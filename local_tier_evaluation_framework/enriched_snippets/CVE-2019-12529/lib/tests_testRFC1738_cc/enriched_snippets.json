[
  {
    "function_name": "PercentZeroNullDecoding",
    "container": "testRFC1738",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/tests/testRFC1738.cc",
    "lines": "127-154",
    "snippet": "void testRFC1738::PercentZeroNullDecoding()\n{\n    char *unescaped_str;\n\n    /* Attack with %00 encoded NULL */\n    unescaped_str = xstrdup(\"w%00rd\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%00rd\",7)==0);\n    xfree(unescaped_str);\n\n    /* Attack with %0 encoded NULL */\n    unescaped_str = xstrdup(\"w%0rd\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%0rd\",6)==0);\n    xfree(unescaped_str);\n\n    /* Handle '0' bytes embeded in encoded % */\n    unescaped_str = xstrdup(\"w%%00%rd\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%00%rd\",8)==0);\n    xfree(unescaped_str);\n\n    /* Handle NULL bytes with encoded % */\n    unescaped_str = xstrdup(\"w%%%00%rd\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%%00%rd\",9)==0);\n    xfree(unescaped_str);\n}",
    "includes": [
      "#include \"lib/rfc1738.c\"",
      "#include <cassert>",
      "#include \"unitTestMain.h\"",
      "#include \"testRFC1738.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"w%%00%rd\",9)==0"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"w%%00%rd\"",
            "9"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"w%%%00%rd\""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"w%00%rd\",8)==0"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"w%00%rd\"",
            "8"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"w%%00%rd\""
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"w%0rd\",6)==0"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"w%0rd\"",
            "6"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"w%0rd\""
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"w%00rd\",7)==0"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"w%00rd\"",
            "7"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"w%00rd\""
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lib/rfc1738.c\"\n#include <cassert>\n#include \"unitTestMain.h\"\n#include \"testRFC1738.h\"\n#include \"squid.h\"\n\ntestRFC1738 {\n  void testRFC1738::PercentZeroNullDecoding()\n  {\n      char *unescaped_str;\n  \n      /* Attack with %00 encoded NULL */\n      unescaped_str = xstrdup(\"w%00rd\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%00rd\",7)==0);\n      xfree(unescaped_str);\n  \n      /* Attack with %0 encoded NULL */\n      unescaped_str = xstrdup(\"w%0rd\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%0rd\",6)==0);\n      xfree(unescaped_str);\n  \n      /* Handle '0' bytes embeded in encoded % */\n      unescaped_str = xstrdup(\"w%%00%rd\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%00%rd\",8)==0);\n      xfree(unescaped_str);\n  \n      /* Handle NULL bytes with encoded % */\n      unescaped_str = xstrdup(\"w%%%00%rd\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%%00%rd\",9)==0);\n      xfree(unescaped_str);\n  }\n}"
  },
  {
    "function_name": "testUrlEncode",
    "container": "testRFC1738",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/tests/testRFC1738.cc",
    "lines": "90-124",
    "snippet": "void testRFC1738::testUrlEncode()\n{\n    char *result;\n\n    /* TEST: Escaping only unsafe characters */\n\n    /* regular URL (no encoding needed) */\n    result = rfc1738_do_escape(\"http://foo.invalid/data/source/path\", RFC1738_ESCAPE_UNSAFE);\n    CPPUNIT_ASSERT(memcmp(result, \"http://foo.invalid/data/source/path\",36)==0);\n\n    /* long string of unsafe # characters */\n    result = rfc1738_do_escape(\"################ ################ ################ ################ ################ ################ ################ ################\", RFC1738_ESCAPE_UNSAFE);\n    CPPUNIT_ASSERT(memcmp(result, \"%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\",406)==0);\n\n    /* TEST: escaping only reserved characters */\n\n    /* regular URL (full encoding requested) */\n    result = rfc1738_do_escape(\"http://foo.invalid/data/source/path\", RFC1738_ESCAPE_RESERVED);\n    CPPUNIT_ASSERT(memcmp(result, \"http%3A%2F%2Ffoo.invalid%2Fdata%2Fsource%2Fpath\",48)==0);\n\n    /* regular path (encoding wanted for ALL special chars) */\n    result = rfc1738_do_escape(\"/data/source/path\", RFC1738_ESCAPE_RESERVED);\n    CPPUNIT_ASSERT(memcmp(result, \"%2Fdata%2Fsource%2Fpath\",24)==0);\n\n    /* TEST: safety-escaping a string already partially escaped */\n\n    /* escaping of dangerous characters in a partially escaped string */\n    result = rfc1738_do_escape(\"http://foo.invalid/data%2Fsource[]\", RFC1738_ESCAPE_UNESCAPED);\n    CPPUNIT_ASSERT(memcmp(result, \"http://foo.invalid/data%2Fsource%5B%5D\",39)==0);\n\n    /* escaping of hexadecimal 0xFF characters in a partially escaped string */\n    result = rfc1738_do_escape(\"http://foo.invalid/data%2Fsource\\xFF\\xFF\", RFC1738_ESCAPE_UNESCAPED);\n    CPPUNIT_ASSERT(memcmp(result, \"http://foo.invalid/data%2Fsource%FF%FF\",39)==0);\n\n}",
    "includes": [
      "#include \"lib/rfc1738.c\"",
      "#include <cassert>",
      "#include \"unitTestMain.h\"",
      "#include \"testRFC1738.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(result, \"http://foo.invalid/data%2Fsource%FF%FF\",39)==0"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "result",
            "\"http://foo.invalid/data%2Fsource%FF%FF\"",
            "39"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_do_escape",
          "args": [
            "\"http://foo.invalid/data%2Fsource\\xFF\\xFF\"",
            "RFC1738_ESCAPE_UNESCAPED"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(result, \"http://foo.invalid/data%2Fsource%5B%5D\",39)==0"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "result",
            "\"http://foo.invalid/data%2Fsource%5B%5D\"",
            "39"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_do_escape",
          "args": [
            "\"http://foo.invalid/data%2Fsource[]\"",
            "RFC1738_ESCAPE_UNESCAPED"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(result, \"%2Fdata%2Fsource%2Fpath\",24)==0"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "result",
            "\"%2Fdata%2Fsource%2Fpath\"",
            "24"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_do_escape",
          "args": [
            "\"/data/source/path\"",
            "RFC1738_ESCAPE_RESERVED"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(result, \"http%3A%2F%2Ffoo.invalid%2Fdata%2Fsource%2Fpath\",48)==0"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "result",
            "\"http%3A%2F%2Ffoo.invalid%2Fdata%2Fsource%2Fpath\"",
            "48"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_do_escape",
          "args": [
            "\"http://foo.invalid/data/source/path\"",
            "RFC1738_ESCAPE_RESERVED"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(result, \"%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\",406)==0"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "result",
            "\"%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"",
            "406"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_do_escape",
          "args": [
            "\"################ ################ ################ ################ ################ ################ ################ ################\"",
            "RFC1738_ESCAPE_UNSAFE"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(result, \"http://foo.invalid/data/source/path\",36)==0"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "result",
            "\"http://foo.invalid/data/source/path\"",
            "36"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_do_escape",
          "args": [
            "\"http://foo.invalid/data/source/path\"",
            "RFC1738_ESCAPE_UNSAFE"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lib/rfc1738.c\"\n#include <cassert>\n#include \"unitTestMain.h\"\n#include \"testRFC1738.h\"\n#include \"squid.h\"\n\ntestRFC1738 {\n  void testRFC1738::testUrlEncode()\n  {\n      char *result;\n  \n      /* TEST: Escaping only unsafe characters */\n  \n      /* regular URL (no encoding needed) */\n      result = rfc1738_do_escape(\"http://foo.invalid/data/source/path\", RFC1738_ESCAPE_UNSAFE);\n      CPPUNIT_ASSERT(memcmp(result, \"http://foo.invalid/data/source/path\",36)==0);\n  \n      /* long string of unsafe # characters */\n      result = rfc1738_do_escape(\"################ ################ ################ ################ ################ ################ ################ ################\", RFC1738_ESCAPE_UNSAFE);\n      CPPUNIT_ASSERT(memcmp(result, \"%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%20%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\",406)==0);\n  \n      /* TEST: escaping only reserved characters */\n  \n      /* regular URL (full encoding requested) */\n      result = rfc1738_do_escape(\"http://foo.invalid/data/source/path\", RFC1738_ESCAPE_RESERVED);\n      CPPUNIT_ASSERT(memcmp(result, \"http%3A%2F%2Ffoo.invalid%2Fdata%2Fsource%2Fpath\",48)==0);\n  \n      /* regular path (encoding wanted for ALL special chars) */\n      result = rfc1738_do_escape(\"/data/source/path\", RFC1738_ESCAPE_RESERVED);\n      CPPUNIT_ASSERT(memcmp(result, \"%2Fdata%2Fsource%2Fpath\",24)==0);\n  \n      /* TEST: safety-escaping a string already partially escaped */\n  \n      /* escaping of dangerous characters in a partially escaped string */\n      result = rfc1738_do_escape(\"http://foo.invalid/data%2Fsource[]\", RFC1738_ESCAPE_UNESCAPED);\n      CPPUNIT_ASSERT(memcmp(result, \"http://foo.invalid/data%2Fsource%5B%5D\",39)==0);\n  \n      /* escaping of hexadecimal 0xFF characters in a partially escaped string */\n      result = rfc1738_do_escape(\"http://foo.invalid/data%2Fsource\\xFF\\xFF\", RFC1738_ESCAPE_UNESCAPED);\n      CPPUNIT_ASSERT(memcmp(result, \"http://foo.invalid/data%2Fsource%FF%FF\",39)==0);\n  \n  }\n}"
  },
  {
    "function_name": "testUrlDecode",
    "container": "testRFC1738",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/tests/testRFC1738.cc",
    "lines": "21-80",
    "snippet": "void testRFC1738::testUrlDecode()\n{\n    char *unescaped_str;\n\n    /* regular URL-path */\n    unescaped_str = xstrdup(\"%2Fdata%2Fsource%2Fpath\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"/data/source/path\",18)==0);\n    xfree(unescaped_str);\n\n    /* path in full URL */\n    unescaped_str = xstrdup(\"http://foo.invalid%2Fdata%2Fsource%2Fpath\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"http://foo.invalid/data/source/path\",36)==0);\n    xfree(unescaped_str);\n\n// TODO query string...\n\n    /* Newline %0A encoded */\n    unescaped_str = xstrdup(\"w%0Ard\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"w\\nrd\",5)==0);\n    xfree(unescaped_str);\n\n    /* Handle Un-encoded % */\n    unescaped_str = xstrdup(\"w%rd\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%rd\",5)==0);\n    xfree(unescaped_str);\n\n    /* Handle encoded % */\n    unescaped_str = xstrdup(\"w%%rd\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%rd\",5)==0);\n    xfree(unescaped_str);\n\n    /* Handle mixed-encoded % */\n    unescaped_str = xstrdup(\"w%%%rd\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%%rd\",6)==0);\n    xfree(unescaped_str);\n\n    /* A corrupt string */\n    unescaped_str = xstrdup(\"Bad String %1\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"Bad String %1\",14)==0);\n    xfree(unescaped_str);\n\n    /* A partly corrupt string */\n    unescaped_str = xstrdup(\"Bad String %1A%3\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"Bad String \\032%3\",15)==0);\n    xfree(unescaped_str);\n\n    /* A non corrupt string */\n    unescaped_str = xstrdup(\"Good String %1A\");\n    rfc1738_unescape(unescaped_str);\n    CPPUNIT_ASSERT(memcmp(unescaped_str, \"Good String \\032\",14)==0);\n    xfree(unescaped_str);\n}",
    "includes": [
      "#include \"lib/rfc1738.c\"",
      "#include <cassert>",
      "#include \"unitTestMain.h\"",
      "#include \"testRFC1738.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"Good String \\032\",14)==0"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"Good String \\032\"",
            "14"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"Good String %1A\""
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"Bad String \\032%3\",15)==0"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"Bad String \\032%3\"",
            "15"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"Bad String %1A%3\""
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"Bad String %1\",14)==0"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"Bad String %1\"",
            "14"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"Bad String %1\""
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"w%%rd\",6)==0"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"w%%rd\"",
            "6"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"w%%%rd\""
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"w%rd\",5)==0"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"w%rd\"",
            "5"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"w%%rd\""
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"w%rd\",5)==0"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"w%rd\"",
            "5"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"w%rd\""
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"w\\nrd\",5)==0"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"w\\nrd\"",
            "5"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"w%0Ard\""
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"http://foo.invalid/data/source/path\",36)==0"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"http://foo.invalid/data/source/path\"",
            "36"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"http://foo.invalid%2Fdata%2Fsource%2Fpath\""
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "unescaped_str"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CPPUNIT_ASSERT",
          "args": [
            "memcmp(unescaped_str, \"/data/source/path\",18)==0"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "unescaped_str",
            "\"/data/source/path\"",
            "18"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rfc1738_unescape",
          "args": [
            "unescaped_str"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "\"%2Fdata%2Fsource%2Fpath\""
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"lib/rfc1738.c\"\n#include <cassert>\n#include \"unitTestMain.h\"\n#include \"testRFC1738.h\"\n#include \"squid.h\"\n\ntestRFC1738 {\n  void testRFC1738::testUrlDecode()\n  {\n      char *unescaped_str;\n  \n      /* regular URL-path */\n      unescaped_str = xstrdup(\"%2Fdata%2Fsource%2Fpath\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"/data/source/path\",18)==0);\n      xfree(unescaped_str);\n  \n      /* path in full URL */\n      unescaped_str = xstrdup(\"http://foo.invalid%2Fdata%2Fsource%2Fpath\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"http://foo.invalid/data/source/path\",36)==0);\n      xfree(unescaped_str);\n  \n  // TODO query string...\n  \n      /* Newline %0A encoded */\n      unescaped_str = xstrdup(\"w%0Ard\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"w\\nrd\",5)==0);\n      xfree(unescaped_str);\n  \n      /* Handle Un-encoded % */\n      unescaped_str = xstrdup(\"w%rd\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%rd\",5)==0);\n      xfree(unescaped_str);\n  \n      /* Handle encoded % */\n      unescaped_str = xstrdup(\"w%%rd\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%rd\",5)==0);\n      xfree(unescaped_str);\n  \n      /* Handle mixed-encoded % */\n      unescaped_str = xstrdup(\"w%%%rd\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"w%%rd\",6)==0);\n      xfree(unescaped_str);\n  \n      /* A corrupt string */\n      unescaped_str = xstrdup(\"Bad String %1\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"Bad String %1\",14)==0);\n      xfree(unescaped_str);\n  \n      /* A partly corrupt string */\n      unescaped_str = xstrdup(\"Bad String %1A%3\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"Bad String \\032%3\",15)==0);\n      xfree(unescaped_str);\n  \n      /* A non corrupt string */\n      unescaped_str = xstrdup(\"Good String %1A\");\n      rfc1738_unescape(unescaped_str);\n      CPPUNIT_ASSERT(memcmp(unescaped_str, \"Good String \\032\",14)==0);\n      xfree(unescaped_str);\n  }\n}"
  }
]