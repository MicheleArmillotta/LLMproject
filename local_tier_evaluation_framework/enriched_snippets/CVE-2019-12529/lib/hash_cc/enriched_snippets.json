[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "328-379",
    "snippet": "int\nmain(void)\n{\n    hash_table *hid;\n    LOCAL_ARRAY(char, buf, BUFSIZ);\n    LOCAL_ARRAY(char, todelete, BUFSIZ);\n    hash_link *walker = NULL;\n\n    todelete[0] = '\\0';\n    printf(\"init\\n\");\n\n    printf(\"creating hash table\\n\");\n    if ((hid = hash_create((HASHCMP *) strcmp, 229, hash4)) < 0) {\n        printf(\"hash_create error.\\n\");\n        exit(1);\n    }\n    printf(\"done creating hash table: %d\\n\", hid);\n\n    std::mt19937 mt;\n    xuniform_int_distribution<> dist(0,16);\n\n    while (fgets(buf, BUFSIZ, stdin)) {\n        buf[strlen(buf) - 1] = '\\0';\n        printf(\"Inserting '%s' for item %p to hash table: %d\\n\",\n               buf, buf, hid);\n        hash_insert(hid, xstrdup(buf), (void *) 0x12345678);\n        if (dist(mt) == 0)\n            strcpy(todelete, buf);\n    }\n\n    printf(\"walking hash table...\\n\");\n    for (int i = 0, walker = hash_first(hid); walker; walker = hash_next(hid)) {\n        printf(\"item %5d: key: '%s' item: %p\\n\", i++, walker->key,\n               walker->item);\n    }\n    printf(\"done walking hash table...\\n\");\n\n    if (todelete[0]) {\n        printf(\"deleting %s from %d\\n\", todelete, hid);\n        if (hash_delete(hid, todelete))\n            printf(\"hash_delete error\\n\");\n    }\n    printf(\"walking hash table...\\n\");\n    for (int i = 0, walker = hash_first(hid); walker; walker = hash_next(hid)) {\n        printf(\"item %5d: key: '%s' item: %p\\n\", i++, walker->key,\n               walker->item);\n    }\n    printf(\"done walking hash table...\\n\");\n\n    printf(\"driver finished.\\n\");\n    exit(0);\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void hash_next_bucket(hash_table * hid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "0"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"driver finished.\\n\""
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"done walking hash table...\\n\""
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"item %5d: key: '%s' item: %p\\n\"",
            "i++",
            "walker->key",
            "walker->item"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_next",
          "args": [
            "hid"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "hash_next_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
          "lines": "164-169",
          "snippet": "static void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <gnumalloc.h>",
            "#include <unistd.h>",
            "#include <cstring>",
            "#include <cstdlib>",
            "#include <cmath>",
            "#include <cassert>",
            "#include \"profiler/Profiler.h\"",
            "#include \"hash.h\"",
            "#include \"squid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void hash_next_bucket(hash_table * hid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nstatic void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_first",
          "args": [
            "hid"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "hash_first",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
          "lines": "175-183",
          "snippet": "void\nhash_first(hash_table * hid)\n{\n    assert(NULL == hid->next);\n    hid->current_slot = 0;\n    hid->next = hid->buckets[hid->current_slot];\n    if (NULL == hid->next)\n        hash_next_bucket(hid);\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <gnumalloc.h>",
            "#include <unistd.h>",
            "#include <cstring>",
            "#include <cstdlib>",
            "#include <cmath>",
            "#include <cassert>",
            "#include \"profiler/Profiler.h\"",
            "#include \"hash.h\"",
            "#include \"squid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void hash_next_bucket(hash_table * hid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nvoid\nhash_first(hash_table * hid)\n{\n    assert(NULL == hid->next);\n    hid->current_slot = 0;\n    hid->next = hid->buckets[hid->current_slot];\n    if (NULL == hid->next)\n        hash_next_bucket(hid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"walking hash table...\\n\""
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"hash_delete error\\n\""
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_delete",
          "args": [
            "hid",
            "todelete"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"deleting %s from %d\\n\"",
            "todelete",
            "hid"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"done walking hash table...\\n\""
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"item %5d: key: '%s' item: %p\\n\"",
            "i++",
            "walker->key",
            "walker->item"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"walking hash table...\\n\""
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "todelete",
            "buf"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dist",
          "args": [
            "mt"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_insert",
          "args": [
            "hid",
            "xstrdup(buf)",
            "(void *) 0x12345678"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xstrdup",
          "args": [
            "buf"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"Inserting '%s' for item %p to hash table: %d\\n\"",
            "buf",
            "buf",
            "hid"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "buf"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fgets",
          "args": [
            "buf",
            "BUFSIZ",
            "stdin"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"done creating hash table: %d\\n\"",
            "hid"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exit",
          "args": [
            "1"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"hash_create error.\\n\""
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_create",
          "args": [
            "(HASHCMP *) strcmp",
            "229",
            "hash4"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"creating hash table\\n\""
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"init\\n\""
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nint\nmain(void)\n{\n    hash_table *hid;\n    LOCAL_ARRAY(char, buf, BUFSIZ);\n    LOCAL_ARRAY(char, todelete, BUFSIZ);\n    hash_link *walker = NULL;\n\n    todelete[0] = '\\0';\n    printf(\"init\\n\");\n\n    printf(\"creating hash table\\n\");\n    if ((hid = hash_create((HASHCMP *) strcmp, 229, hash4)) < 0) {\n        printf(\"hash_create error.\\n\");\n        exit(1);\n    }\n    printf(\"done creating hash table: %d\\n\", hid);\n\n    std::mt19937 mt;\n    xuniform_int_distribution<> dist(0,16);\n\n    while (fgets(buf, BUFSIZ, stdin)) {\n        buf[strlen(buf) - 1] = '\\0';\n        printf(\"Inserting '%s' for item %p to hash table: %d\\n\",\n               buf, buf, hid);\n        hash_insert(hid, xstrdup(buf), (void *) 0x12345678);\n        if (dist(mt) == 0)\n            strcpy(todelete, buf);\n    }\n\n    printf(\"walking hash table...\\n\");\n    for (int i = 0, walker = hash_first(hid); walker; walker = hash_next(hid)) {\n        printf(\"item %5d: key: '%s' item: %p\\n\", i++, walker->key,\n               walker->item);\n    }\n    printf(\"done walking hash table...\\n\");\n\n    if (todelete[0]) {\n        printf(\"deleting %s from %d\\n\", todelete, hid);\n        if (hash_delete(hid, todelete))\n            printf(\"hash_delete error\\n\");\n    }\n    printf(\"walking hash table...\\n\");\n    for (int i = 0, walker = hash_first(hid); walker; walker = hash_next(hid)) {\n        printf(\"item %5d: key: '%s' item: %p\\n\", i++, walker->key,\n               walker->item);\n    }\n    printf(\"done walking hash table...\\n\");\n\n    printf(\"driver finished.\\n\");\n    exit(0);\n}"
  },
  {
    "function_name": "hashPrime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "296-311",
    "snippet": "int\nhashPrime(int n)\n{\n    int I = sizeof(hash_primes) / sizeof(int);\n    int best_prime = hash_primes[0];\n    double min = fabs(log((double) n) - log((double) hash_primes[0]));\n    double d;\n    for (int i = 0; i < I; ++i) {\n        d = fabs(log((double) n) - log((double) hash_primes[i]));\n        if (d > min)\n            continue;\n        min = d;\n        best_prime = hash_primes[i];\n    }\n    return best_prime;\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static int hash_primes[] = {\n    103,\n    229,\n    467,\n    977,\n    1979,\n    4019,\n    6037,\n    7951,\n    12149,\n    16231,\n    33493,\n    65357\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "fabs",
          "args": [
            "log((double) n) - log((double) hash_primes[i])"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log",
          "args": [
            "(double) hash_primes[i]"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log",
          "args": [
            "(double) n"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fabs",
          "args": [
            "log((double) n) - log((double) hash_primes[0])"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log",
          "args": [
            "(double) hash_primes[0]"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log",
          "args": [
            "(double) n"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic int hash_primes[] = {\n    103,\n    229,\n    467,\n    977,\n    1979,\n    4019,\n    6037,\n    7951,\n    12149,\n    16231,\n    33493,\n    65357\n};\n\nint\nhashPrime(int n)\n{\n    int I = sizeof(hash_primes) / sizeof(int);\n    int best_prime = hash_primes[0];\n    double min = fabs(log((double) n) - log((double) hash_primes[0]));\n    double d;\n    for (int i = 0; i < I; ++i) {\n        d = fabs(log((double) n) - log((double) hash_primes[i]));\n        if (d > min)\n            continue;\n        min = d;\n        best_prime = hash_primes[i];\n    }\n    return best_prime;\n}"
  },
  {
    "function_name": "hashFreeMemory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "271-279",
    "snippet": "void\nhashFreeMemory(hash_table * hid)\n{\n    if (hid == NULL)\n        return;\n    if (hid->buckets)\n        xfree(hid->buckets);\n    xfree(hid);\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void hash_next_bucket(hash_table * hid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "hid"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "hid->buckets"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nvoid\nhashFreeMemory(hash_table * hid)\n{\n    if (hid == NULL)\n        return;\n    if (hid->buckets)\n        xfree(hid->buckets);\n    xfree(hid);\n}"
  },
  {
    "function_name": "hashFreeItems",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "255-269",
    "snippet": "void\nhashFreeItems(hash_table * hid, HASHFREE * free_func)\n{\n    hash_link *l;\n    int i = 0;\n    hash_link **list = (hash_link **)xcalloc(hid->count, sizeof(hash_link *));\n    hash_first(hid);\n    while ((l = hash_next(hid)) && i < hid->count) {\n        *(list + i) = l;\n        ++i;\n    }\n    for (int j = 0; j < i; ++j)\n        free_func(*(list + j));\n    xfree(list);\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void hash_next_bucket(hash_table * hid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "xfree",
          "args": [
            "list"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free_func",
          "args": [
            "*(list + j)"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_next",
          "args": [
            "hid"
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "hash_next_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
          "lines": "164-169",
          "snippet": "static void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <gnumalloc.h>",
            "#include <unistd.h>",
            "#include <cstring>",
            "#include <cstdlib>",
            "#include <cmath>",
            "#include <cassert>",
            "#include \"profiler/Profiler.h\"",
            "#include \"hash.h\"",
            "#include \"squid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void hash_next_bucket(hash_table * hid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nstatic void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash_first",
          "args": [
            "hid"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "hash_first",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
          "lines": "175-183",
          "snippet": "void\nhash_first(hash_table * hid)\n{\n    assert(NULL == hid->next);\n    hid->current_slot = 0;\n    hid->next = hid->buckets[hid->current_slot];\n    if (NULL == hid->next)\n        hash_next_bucket(hid);\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <gnumalloc.h>",
            "#include <unistd.h>",
            "#include <cstring>",
            "#include <cstdlib>",
            "#include <cmath>",
            "#include <cassert>",
            "#include \"profiler/Profiler.h\"",
            "#include \"hash.h\"",
            "#include \"squid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void hash_next_bucket(hash_table * hid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nvoid\nhash_first(hash_table * hid)\n{\n    assert(NULL == hid->next);\n    hid->current_slot = 0;\n    hid->next = hid->buckets[hid->current_slot];\n    if (NULL == hid->next)\n        hash_next_bucket(hid);\n}"
        }
      },
      {
        "call_info": {
          "callee": "xcalloc",
          "args": [
            "hid->count",
            "sizeof(hash_link *)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nvoid\nhashFreeItems(hash_table * hid, HASHFREE * free_func)\n{\n    hash_link *l;\n    int i = 0;\n    hash_link **list = (hash_link **)xcalloc(hid->count, sizeof(hash_link *));\n    hash_first(hid);\n    while ((l = hash_next(hid)) && i < hid->count) {\n        *(list + i) = l;\n        ++i;\n    }\n    for (int j = 0; j < i; ++j)\n        free_func(*(list + j));\n    xfree(list);\n}"
  },
  {
    "function_name": "hash_remove_link",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "223-241",
    "snippet": "void\nhash_remove_link(hash_table * hid, hash_link * hl)\n{\n    assert(hl != NULL);\n    int i = hid->hash(hl->key, hid->size);\n    for (hash_link **P = &hid->buckets[i]; *P; P = &(*P)->next) {\n        if (*P != hl)\n            continue;\n        *P = hl->next;\n        if (hid->next == hl) {\n            hid->next = hl->next;\n            if (NULL == hid->next)\n                hash_next_bucket(hid);\n        }\n        --hid->count;\n        return;\n    }\n    assert(0);\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void hash_next_bucket(hash_table * hid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "0"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash_next_bucket",
          "args": [
            "hid"
          ],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "hash_next_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
          "lines": "164-169",
          "snippet": "static void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <gnumalloc.h>",
            "#include <unistd.h>",
            "#include <cstring>",
            "#include <cstdlib>",
            "#include <cmath>",
            "#include <cassert>",
            "#include \"profiler/Profiler.h\"",
            "#include \"hash.h\"",
            "#include \"squid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void hash_next_bucket(hash_table * hid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nstatic void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}"
        }
      },
      {
        "call_info": {
          "callee": "hid->hash",
          "args": [
            "hl->key",
            "hid->size"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "hl != NULL"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nvoid\nhash_remove_link(hash_table * hid, hash_link * hl)\n{\n    assert(hl != NULL);\n    int i = hid->hash(hl->key, hid->size);\n    for (hash_link **P = &hid->buckets[i]; *P; P = &(*P)->next) {\n        if (*P != hl)\n            continue;\n        *P = hl->next;\n        if (hid->next == hl) {\n            hid->next = hl->next;\n            if (NULL == hid->next)\n                hash_next_bucket(hid);\n        }\n        --hid->count;\n        return;\n    }\n    assert(0);\n}"
  },
  {
    "function_name": "hash_last",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "207-213",
    "snippet": "void\nhash_last(hash_table * hid)\n{\n    assert(hid != NULL);\n    hid->next = NULL;\n    hid->current_slot = 0;\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void hash_next_bucket(hash_table * hid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "hid != NULL"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nvoid\nhash_last(hash_table * hid)\n{\n    assert(hid != NULL);\n    hid->next = NULL;\n    hid->current_slot = 0;\n}"
  },
  {
    "function_name": "hash_first",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "175-183",
    "snippet": "void\nhash_first(hash_table * hid)\n{\n    assert(NULL == hid->next);\n    hid->current_slot = 0;\n    hid->next = hid->buckets[hid->current_slot];\n    if (NULL == hid->next)\n        hash_next_bucket(hid);\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void hash_next_bucket(hash_table * hid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash_next_bucket",
          "args": [
            "hid"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "hash_next_bucket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
          "lines": "164-169",
          "snippet": "static void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <gnumalloc.h>",
            "#include <unistd.h>",
            "#include <cstring>",
            "#include <cstdlib>",
            "#include <cmath>",
            "#include <cassert>",
            "#include \"profiler/Profiler.h\"",
            "#include \"hash.h\"",
            "#include \"squid.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static void hash_next_bucket(hash_table * hid);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nstatic void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "NULL == hid->next"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nvoid\nhash_first(hash_table * hid)\n{\n    assert(NULL == hid->next);\n    hid->current_slot = 0;\n    hid->next = hid->buckets[hid->current_slot];\n    if (NULL == hid->next)\n        hash_next_bucket(hid);\n}"
  },
  {
    "function_name": "hash_next_bucket",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "164-169",
    "snippet": "static void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void hash_next_bucket(hash_table * hid);"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nstatic void\nhash_next_bucket(hash_table * hid)\n{\n    while (hid->next == NULL && ++hid->current_slot < hid->size)\n        hid->next = hid->buckets[hid->current_slot];\n}"
  },
  {
    "function_name": "hash_join",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "131-139",
    "snippet": "void\nhash_join(hash_table * hid, hash_link * lnk)\n{\n    int i;\n    i = hid->hash(lnk->key, hid->size);\n    lnk->next = hid->buckets[i];\n    hid->buckets[i] = lnk;\n    ++hid->count;\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static void hash_next_bucket(hash_table * hid);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "hid->hash",
          "args": [
            "lnk->key",
            "hid->size"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nstatic void hash_next_bucket(hash_table * hid);\n\nvoid\nhash_join(hash_table * hid, hash_link * lnk)\n{\n    int i;\n    i = hid->hash(lnk->key, hid->size);\n    lnk->next = hid->buckets[i];\n    hid->buckets[i] = lnk;\n    ++hid->count;\n}"
  },
  {
    "function_name": "hash4",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "50-101",
    "snippet": "unsigned int\nhash4(const void *data, unsigned int size)\n{\n    const char *key = static_cast<const char *>(data);\n    size_t loop;\n    unsigned int h;\n    size_t len;\n\n#define HASH4a   h = (h << 5) - h + *key++;\n#define HASH4b   h = (h << 5) + h + *key++;\n#define HASH4 HASH4b\n\n    h = 0;\n    len = strlen(key);\n    loop = len >> 3;\n    switch (len & (8 - 1)) {\n    case 0:\n        break;\n    case 7:\n        HASH4;\n    /* FALLTHROUGH */\n    case 6:\n        HASH4;\n    /* FALLTHROUGH */\n    case 5:\n        HASH4;\n    /* FALLTHROUGH */\n    case 4:\n        HASH4;\n    /* FALLTHROUGH */\n    case 3:\n        HASH4;\n    /* FALLTHROUGH */\n    case 2:\n        HASH4;\n    /* FALLTHROUGH */\n    case 1:\n        HASH4;\n    }\n    while (loop) {\n        --loop;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n    }\n    return h % size;\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [
      "#define HASH4 HASH4b",
      "#define HASH4b   h = (h << 5) + h + *key++;",
      "#define HASH4a   h = (h << 5) - h + *key++;"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "key"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<const char *>",
          "args": [
            "data"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\n#define HASH4 HASH4b\n#define HASH4b   h = (h << 5) + h + *key++;\n#define HASH4a   h = (h << 5) - h + *key++;\n\nunsigned int\nhash4(const void *data, unsigned int size)\n{\n    const char *key = static_cast<const char *>(data);\n    size_t loop;\n    unsigned int h;\n    size_t len;\n\n#define HASH4a   h = (h << 5) - h + *key++;\n#define HASH4b   h = (h << 5) + h + *key++;\n#define HASH4 HASH4b\n\n    h = 0;\n    len = strlen(key);\n    loop = len >> 3;\n    switch (len & (8 - 1)) {\n    case 0:\n        break;\n    case 7:\n        HASH4;\n    /* FALLTHROUGH */\n    case 6:\n        HASH4;\n    /* FALLTHROUGH */\n    case 5:\n        HASH4;\n    /* FALLTHROUGH */\n    case 4:\n        HASH4;\n    /* FALLTHROUGH */\n    case 3:\n        HASH4;\n    /* FALLTHROUGH */\n    case 2:\n        HASH4;\n    /* FALLTHROUGH */\n    case 1:\n        HASH4;\n    }\n    while (loop) {\n        --loop;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n        HASH4;\n    }\n    return h % size;\n}"
  },
  {
    "function_name": "hash_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2019-12529/repo/lib/hash.cc",
    "lines": "30-44",
    "snippet": "unsigned int\nhash_string(const void *data, unsigned int size)\n{\n    const unsigned char *s = static_cast<const unsigned char *>(data);\n    unsigned int n = 0;\n    unsigned int j = 0;\n    unsigned int i = 0;\n    while (*s) {\n        ++j;\n        n ^= 271 * *s;\n        ++s;\n    }\n    i = n ^ (j * 271);\n    return i % size;\n}",
    "includes": [
      "#include <malloc.h>",
      "#include <gnumalloc.h>",
      "#include <unistd.h>",
      "#include <cstring>",
      "#include <cstdlib>",
      "#include <cmath>",
      "#include <cassert>",
      "#include \"profiler/Profiler.h\"",
      "#include \"hash.h\"",
      "#include \"squid.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<const unsigned char *>",
          "args": [
            "data"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <malloc.h>\n#include <gnumalloc.h>\n#include <unistd.h>\n#include <cstring>\n#include <cstdlib>\n#include <cmath>\n#include <cassert>\n#include \"profiler/Profiler.h\"\n#include \"hash.h\"\n#include \"squid.h\"\n\nunsigned int\nhash_string(const void *data, unsigned int size)\n{\n    const unsigned char *s = static_cast<const unsigned char *>(data);\n    unsigned int n = 0;\n    unsigned int j = 0;\n    unsigned int i = 0;\n    while (*s) {\n        ++j;\n        n ^= 271 * *s;\n        ++s;\n    }\n    i = n ^ (j * 271);\n    return i % size;\n}"
  }
]