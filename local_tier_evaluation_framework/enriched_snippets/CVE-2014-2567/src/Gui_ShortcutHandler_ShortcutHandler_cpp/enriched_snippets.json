[
  {
    "function_name": "readSettings",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "187-202",
    "snippet": "void ShortcutHandler::readSettings()\n{\n    Q_ASSERT_X(m_settings, \"ShortcutHandler\", \"a settings object should be set using setSettingsObject() prior to using readSettings()\");\n    Common::SettingsCategoryGuard guard(m_settings, QLatin1String(\"ShortcutHandler\"));\n    const int size = m_settings->beginReadArray(QLatin1String(\"Shortcuts\"));\n    for (int i = 0; i < size; ++i) {\n        m_settings->setArrayIndex(i);\n        const QString actionName = m_settings->value(QLatin1String(\"Action\")).toString();\n        m_actionDescriptions[actionName].shortcut = m_settings->value(QLatin1String(\"Shortcut\")).toString();\n\n        QAction *action = m_actionDescriptions[actionName].action;\n        if (action)\n            action->setShortcut(QKeySequence(m_settings->value(QLatin1String(\"Shortcut\")).toString()));\n    }\n    m_settings->endArray();\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_settings->endArray",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "action->setShortcut",
          "args": [
            "QKeySequence(m_settings->value(QLatin1String(\"Shortcut\")).toString())"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QKeySequence",
          "args": [
            "m_settings->value(QLatin1String(\"Shortcut\")).toString()"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_settings->value",
          "args": [],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "333-336",
          "snippet": "QByteArray QMimeMagicRule::value() const\n{\n    return d->value;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QByteArray QMimeMagicRule::value() const\n  {\n      return d->value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_settings->value",
          "args": [
            "QLatin1String(\"Shortcut\")"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "187-205",
          "snippet": "QVariant XSqlQuery::value(const QString & name) const\n{\n    if (name.isEmpty())\n        return QVariant();\n\n    if (_data && !_data->_currRecord.isEmpty())\n    {\n        int i = _data->_currRecord.indexOf(name);\n        if(i<0)\n        {\n            QString err = \"Column \" + name + \" not found in record\";\n            qWarning(\"%s\", err.toLocal8Bit().constData());\n            return QVariant(_nameErrorValue);\n        }\n        return value(_data->_currRecord.indexOf(name));\n    }\n\n    return QVariant();\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [
            "static QString _nameErrorValue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nstatic QString _nameErrorValue;\n\nXSqlQuery {\n  QVariant XSqlQuery::value(const QString & name) const\n  {\n      if (name.isEmpty())\n          return QVariant();\n  \n      if (_data && !_data->_currRecord.isEmpty())\n      {\n          int i = _data->_currRecord.indexOf(name);\n          if(i<0)\n          {\n              QString err = \"Column \" + name + \" not found in record\";\n              qWarning(\"%s\", err.toLocal8Bit().constData());\n              return QVariant(_nameErrorValue);\n          }\n          return value(_data->_currRecord.indexOf(name));\n      }\n  \n      return QVariant();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"Shortcut\""
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"Shortcut\""
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"Action\""
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_settings->setArrayIndex",
          "args": [
            "i"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_settings->beginReadArray",
          "args": [
            "QLatin1String(\"Shortcuts\")"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"Shortcuts\""
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"ShortcutHandler\""
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_ASSERT_X",
          "args": [
            "m_settings",
            "\"ShortcutHandler\"",
            "\"a settings object should be set using setSettingsObject() prior to using readSettings()\""
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::readSettings()\n  {\n      Q_ASSERT_X(m_settings, \"ShortcutHandler\", \"a settings object should be set using setSettingsObject() prior to using readSettings()\");\n      Common::SettingsCategoryGuard guard(m_settings, QLatin1String(\"ShortcutHandler\"));\n      const int size = m_settings->beginReadArray(QLatin1String(\"Shortcuts\"));\n      for (int i = 0; i < size; ++i) {\n          m_settings->setArrayIndex(i);\n          const QString actionName = m_settings->value(QLatin1String(\"Action\")).toString();\n          m_actionDescriptions[actionName].shortcut = m_settings->value(QLatin1String(\"Shortcut\")).toString();\n  \n          QAction *action = m_actionDescriptions[actionName].action;\n          if (action)\n              action->setShortcut(QKeySequence(m_settings->value(QLatin1String(\"Shortcut\")).toString()));\n      }\n      m_settings->endArray();\n  }\n}"
  },
  {
    "function_name": "reject",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "180-183",
    "snippet": "void ShortcutHandler::reject()\n{\n    m_shortcutConfigWidget->reject();\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_shortcutConfigWidget->reject",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "reject",
          "container": "ShortcutHandler",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
          "lines": "180-183",
          "snippet": "void ShortcutHandler::reject()\n{\n    m_shortcutConfigWidget->reject();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::reject()\n  {\n      m_shortcutConfigWidget->reject();\n  }\n}"
  },
  {
    "function_name": "accept",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "175-178",
    "snippet": "void ShortcutHandler::accept()\n{\n    m_shortcutConfigWidget->accept();\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_shortcutConfigWidget->accept",
          "args": [],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "ShortcutHandler",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
          "lines": "175-178",
          "snippet": "void ShortcutHandler::accept()\n{\n    m_shortcutConfigWidget->accept();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::accept()\n  {\n      m_shortcutConfigWidget->accept();\n  }\n}"
  },
  {
    "function_name": "openShortcutConfigDialog",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "150-159",
    "snippet": "void ShortcutHandler::openShortcutConfigDialog()\n{\n    if (!m_shortcutConfigDialog) {\n        m_shortcutConfigDialog = new ShortcutConfigDialog(qobject_cast<QWidget*>(parent()));\n        m_shortcutConfigDialog->setActionDescriptions(m_actionDescriptions);\n        m_shortcutConfigDialog->setExclusivityGroups(m_exclusivityGroups);\n        connect(m_shortcutConfigDialog, SIGNAL(shortcutsChanged(QHash<QString,ActionDescription>)), this, SLOT(changeShortcuts(QHash<QString,ActionDescription>)));\n    }\n    m_shortcutConfigDialog->exec();\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_shortcutConfigDialog->exec",
          "args": [],
          "line": 158
        },
        "resolved": true,
        "details": {
          "function_name": "exec",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "217-242",
          "snippet": "bool XSqlQuery::exec()\n{\n  bool returnValue = false;\n\n  if(_data && _data->_emulatePrepare)\n  {\n// In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n// caused several problems with all our code and the way it worked so this is a modified copy\n// of their code to use the implemented prepare if we have that option set so we can use the method\n// that works best in the case we are using it for.\n    if (lastError().isValid())\n      ((XSqlResultHelper*)result())->setLastError(QSqlError());\n\n    returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n  }\n  else\n    returnValue = QSqlQuery::exec();\n\n  if (_data)\n    _data->_currRecord = record();\n\n  if(false == returnValue)\n    notifyErrorListeners(this);\n\n  return returnValue;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::exec()\n  {\n    bool returnValue = false;\n  \n    if(_data && _data->_emulatePrepare)\n    {\n  // In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n  // caused several problems with all our code and the way it worked so this is a modified copy\n  // of their code to use the implemented prepare if we have that option set so we can use the method\n  // that works best in the case we are using it for.\n      if (lastError().isValid())\n        ((XSqlResultHelper*)result())->setLastError(QSqlError());\n  \n      returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n    }\n    else\n      returnValue = QSqlQuery::exec();\n  \n    if (_data)\n      _data->_currRecord = record();\n  \n    if(false == returnValue)\n      notifyErrorListeners(this);\n  \n    return returnValue;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "m_shortcutConfigDialog",
            "SIGNAL(shortcutsChanged(QHash<QString,ActionDescription>))",
            "this",
            "SLOT(changeShortcuts(QHash<QString,ActionDescription>))"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "changeShortcuts(QHash<QString,ActionDescription>)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "changeShortcuts",
          "args": [
            "QHash<QString,ActionDescription>"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "changeShortcuts",
          "container": "ShortcutHandler",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
          "lines": "130-138",
          "snippet": "void ShortcutHandler::changeShortcuts(const QHash<QString, ActionDescription> &actionDescriptions)\n{\n    for (QHash<QString, ActionDescription>::const_iterator it = actionDescriptions.constBegin(); it != actionDescriptions.constEnd(); ++it) {\n        ActionDescription actionDescription = it.value();\n        QAction *action = m_actionDescriptions[it.key()].action;\n        if (action)\n            action->setShortcut(QKeySequence(actionDescription.shortcut));\n    }\n}",
          "includes": [
            "#include \"Common/SettingsCategoryGuard.h\"",
            "#include \"ShortcutConfigWidget.h\"",
            "#include \"ShortcutConfigDialog.h\"",
            "#include \"IconLoader.h\"",
            "#include <QSettings>",
            "#include <QAction>",
            "#include \"ShortcutHandler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::changeShortcuts(const QHash<QString, ActionDescription> &actionDescriptions)\n  {\n      for (QHash<QString, ActionDescription>::const_iterator it = actionDescriptions.constBegin(); it != actionDescriptions.constEnd(); ++it) {\n          ActionDescription actionDescription = it.value();\n          QAction *action = m_actionDescriptions[it.key()].action;\n          if (action)\n              action->setShortcut(QKeySequence(actionDescription.shortcut));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "shortcutsChanged(QHash<QString,ActionDescription>)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shortcutsChanged",
          "args": [
            "QHash<QString,ActionDescription>"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_shortcutConfigDialog->setExclusivityGroups",
          "args": [
            "m_exclusivityGroups"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_shortcutConfigDialog->setActionDescriptions",
          "args": [
            "m_actionDescriptions"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qobject_cast<QWidget*>",
          "args": [
            "parent()"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parent",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "parentOfRoot(",
          "container": "ubtreeModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SubtreeModel.cpp",
          "lines": "129-132",
          "snippet": "ModelIndex SubtreeModel::parentOfRoot() const\n{\n    return m_rootIndex.parent();\n}",
          "includes": [
            "include \"QAIM_reset.h\"",
            "include \"Model.h\"\n#",
            "include \"MailboxModel.h\"\n#",
            "include \"SubtreeModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"QAIM_reset.h\"\ninclude \"Model.h\"\n#\ninclude \"MailboxModel.h\"\n#\ninclude \"SubtreeModel.h\"\n#\n\nubtreeModel {\n  ModelIndex SubtreeModel::parentOfRoot() const\n  {\n      return m_rootIndex.parent();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::openShortcutConfigDialog()\n  {\n      if (!m_shortcutConfigDialog) {\n          m_shortcutConfigDialog = new ShortcutConfigDialog(qobject_cast<QWidget*>(parent()));\n          m_shortcutConfigDialog->setActionDescriptions(m_actionDescriptions);\n          m_shortcutConfigDialog->setExclusivityGroups(m_exclusivityGroups);\n          connect(m_shortcutConfigDialog, SIGNAL(shortcutsChanged(QHash<QString,ActionDescription>)), this, SLOT(changeShortcuts(QHash<QString,ActionDescription>)));\n      }\n      m_shortcutConfigDialog->exec();\n  }\n}"
  },
  {
    "function_name": "changeShortcuts",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "130-138",
    "snippet": "void ShortcutHandler::changeShortcuts(const QHash<QString, ActionDescription> &actionDescriptions)\n{\n    for (QHash<QString, ActionDescription>::const_iterator it = actionDescriptions.constBegin(); it != actionDescriptions.constEnd(); ++it) {\n        ActionDescription actionDescription = it.value();\n        QAction *action = m_actionDescriptions[it.key()].action;\n        if (action)\n            action->setShortcut(QKeySequence(actionDescription.shortcut));\n    }\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "action->setShortcut",
          "args": [
            "QKeySequence(actionDescription.shortcut)"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QKeySequence",
          "args": [
            "actionDescription.shortcut"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.key",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.value",
          "args": [],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "333-336",
          "snippet": "QByteArray QMimeMagicRule::value() const\n{\n    return d->value;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QByteArray QMimeMagicRule::value() const\n  {\n      return d->value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "actionDescriptions.constEnd",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "actionDescriptions.constBegin",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::changeShortcuts(const QHash<QString, ActionDescription> &actionDescriptions)\n  {\n      for (QHash<QString, ActionDescription>::const_iterator it = actionDescriptions.constBegin(); it != actionDescriptions.constEnd(); ++it) {\n          ActionDescription actionDescription = it.value();\n          QAction *action = m_actionDescriptions[it.key()].action;\n          if (action)\n              action->setShortcut(QKeySequence(actionDescription.shortcut));\n      }\n  }\n}"
  },
  {
    "function_name": "addExclusivityGroup",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "101-114",
    "snippet": "void ShortcutHandler::addExclusivityGroup(const QStringList &groups)\n{\n    if (groups.contains(tr(\"Main Window\"))) {\n        m_exclusivityGroups.takeFirst();\n        m_exclusivityGroups.prepend(groups);\n    } else {\n        m_exclusivityGroups.append(groups);\n    }\n\n    if (m_shortcutConfigDialog)\n        m_shortcutConfigDialog->setExclusivityGroups(m_exclusivityGroups);\n    if (m_shortcutConfigWidget)\n        m_shortcutConfigWidget->setExclusivityGroups(m_exclusivityGroups);\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_shortcutConfigWidget->setExclusivityGroups",
          "args": [
            "m_exclusivityGroups"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_shortcutConfigDialog->setExclusivityGroups",
          "args": [
            "m_exclusivityGroups"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_exclusivityGroups.append",
          "args": [
            "groups"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_exclusivityGroups.prepend",
          "args": [
            "groups"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_exclusivityGroups.takeFirst",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "groups.contains",
          "args": [
            "tr(\"Main Window\")"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Main Window\""
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "setGeometry",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "125-129",
          "snippet": "void FlowLayout::setGeometry(const QRect &rect)\n{\n    QLayout::setGeometry(rect);\n    doLayout(rect, false);\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  void FlowLayout::setGeometry(const QRect &rect)\n  {\n      QLayout::setGeometry(rect);\n      doLayout(rect, false);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::addExclusivityGroup(const QStringList &groups)\n  {\n      if (groups.contains(tr(\"Main Window\"))) {\n          m_exclusivityGroups.takeFirst();\n          m_exclusivityGroups.prepend(groups);\n      } else {\n          m_exclusivityGroups.append(groups);\n      }\n  \n      if (m_shortcutConfigDialog)\n          m_shortcutConfigDialog->setExclusivityGroups(m_exclusivityGroups);\n      if (m_shortcutConfigWidget)\n          m_shortcutConfigWidget->setExclusivityGroups(m_exclusivityGroups);\n  }\n}"
  },
  {
    "function_name": "defineAction",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "72-75",
    "snippet": "void ShortcutHandler::defineAction(const QString &actionName, const QString &iconName, const QString &text, const QKeySequence::StandardKey &key, const QString &parentId)\n{\n    m_actionDescriptions[actionName] = ActionDescription(iconName, text, QKeySequence(key).toString(QKeySequence::PortableText), parentId);\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ActionDescription",
          "args": [
            "iconName",
            "text",
            "QKeySequence(key).toString(QKeySequence::PortableText)",
            "parentId"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QKeySequence",
          "args": [
            "QKeySequence::PortableText"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QKeySequence",
          "args": [
            "key"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::defineAction(const QString &actionName, const QString &iconName, const QString &text, const QKeySequence::StandardKey &key, const QString &parentId)\n  {\n      m_actionDescriptions[actionName] = ActionDescription(iconName, text, QKeySequence(key).toString(QKeySequence::PortableText), parentId);\n  }\n}"
  },
  {
    "function_name": "defineAction",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "66-70",
    "snippet": "void ShortcutHandler::defineAction(const QString &actionName, const QString &iconName, const QString &text, const QString &defaultShortcut, const QString &parentId)\n{\n//  m_actionDescriptions[actionName] = {iconName, text, defaultShortcut, parentId}; // C++11 only, constructor in ActionDescription is then not needed\n    m_actionDescriptions[actionName] = ActionDescription(iconName, text, defaultShortcut, parentId);\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ActionDescription",
          "args": [
            "iconName",
            "text",
            "defaultShortcut",
            "parentId"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::defineAction(const QString &actionName, const QString &iconName, const QString &text, const QString &defaultShortcut, const QString &parentId)\n  {\n  //  m_actionDescriptions[actionName] = {iconName, text, defaultShortcut, parentId}; // C++11 only, constructor in ActionDescription is then not needed\n      m_actionDescriptions[actionName] = ActionDescription(iconName, text, defaultShortcut, parentId);\n  }\n}"
  },
  {
    "function_name": "setSettingsObject",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "61-64",
    "snippet": "void ShortcutHandler::setSettingsObject(QSettings *settings)\n{\n    m_settings = settings;\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::setSettingsObject(QSettings *settings)\n  {\n      m_settings = settings;\n  }\n}"
  },
  {
    "function_name": "~ShortcutHandler",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "50-59",
    "snippet": "ShortcutHandler::~ShortcutHandler()\n{\n    if (m_shortcutConfigAction)\n        delete m_shortcutConfigAction;\n    if (m_shortcutConfigDialog)\n        delete m_shortcutConfigDialog;\n    if (m_shortcutConfigWidget)\n        delete m_shortcutConfigWidget;\n    m_actionDescriptions.clear();\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_actionDescriptions.clear",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  ShortcutHandler::~ShortcutHandler()\n  {\n      if (m_shortcutConfigAction)\n          delete m_shortcutConfigAction;\n      if (m_shortcutConfigDialog)\n          delete m_shortcutConfigDialog;\n      if (m_shortcutConfigWidget)\n          delete m_shortcutConfigWidget;\n      m_actionDescriptions.clear();\n  }\n}"
  },
  {
    "function_name": "ShortcutHandler",
    "container": "ShortcutHandler",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
    "lines": "38-48",
    "snippet": "ShortcutHandler::ShortcutHandler(QWidget *parent)\n    : QObject(parent)\n    , m_settings(0)\n    , m_shortcutConfigAction(0)\n    , m_shortcutConfigDialog(0)\n    , m_shortcutConfigWidget(0)\n{\n    Q_ASSERT_X(!self, \"ShortcutHandler\", \"there should be only one shortcut handler object\");\n    ShortcutHandler::self = this;\n    m_exclusivityGroups.append(QStringList() << tr(\"Main Window\"));\n}",
    "includes": [
      "#include \"Common/SettingsCategoryGuard.h\"",
      "#include \"ShortcutConfigWidget.h\"",
      "#include \"ShortcutConfigDialog.h\"",
      "#include \"IconLoader.h\"",
      "#include <QSettings>",
      "#include <QAction>",
      "#include \"ShortcutHandler.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_exclusivityGroups.append",
          "args": [
            "QStringList() << tr(\"Main Window\")"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Main Window\""
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "setGeometry",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "125-129",
          "snippet": "void FlowLayout::setGeometry(const QRect &rect)\n{\n    QLayout::setGeometry(rect);\n    doLayout(rect, false);\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  void FlowLayout::setGeometry(const QRect &rect)\n  {\n      QLayout::setGeometry(rect);\n      doLayout(rect, false);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QStringList",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Q_ASSERT_X",
          "args": [
            "!self",
            "\"ShortcutHandler\"",
            "\"there should be only one shortcut handler object\""
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  ShortcutHandler::ShortcutHandler(QWidget *parent)\n      : QObject(parent)\n      , m_settings(0)\n      , m_shortcutConfigAction(0)\n      , m_shortcutConfigDialog(0)\n      , m_shortcutConfigWidget(0)\n  {\n      Q_ASSERT_X(!self, \"ShortcutHandler\", \"there should be only one shortcut handler object\");\n      ShortcutHandler::self = this;\n      m_exclusivityGroups.append(QStringList() << tr(\"Main Window\"));\n  }\n}"
  }
]