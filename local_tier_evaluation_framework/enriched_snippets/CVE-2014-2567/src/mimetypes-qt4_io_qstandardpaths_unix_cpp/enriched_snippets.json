[
  {
    "function_name": "standardLocations",
    "container": "QStandardPaths",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
    "lines": "279-312",
    "snippet": "QStringList QStandardPaths::standardLocations(StandardLocation type)\n{\n    QStringList dirs;\n    switch (type) {\n    case ConfigLocation:\n    {\n        // http://standards.freedesktop.org/basedir-spec/latest/\n        const QString xdgConfigDirs = QFile::decodeName(qgetenv(\"XDG_CONFIG_DIRS\"));\n        if (xdgConfigDirs.isEmpty())\n            dirs.append(QString::fromLatin1(\"/etc/xdg\"));\n        else\n            dirs = xdgConfigDirs.split(QLatin1Char(':'));\n    }\n    break;\n    case GenericDataLocation:\n        dirs = xdgDataDirs();\n        break;\n    case ApplicationsLocation:\n        dirs = xdgDataDirs();\n        for (int i = 0; i < dirs.count(); ++i)\n            dirs[i].append(QLatin1String(\"/applications\"));\n        break;\n    case DataLocation:\n        dirs = xdgDataDirs();\n        for (int i = 0; i < dirs.count(); ++i)\n            appendOrganizationAndApp(dirs[i]);\n        break;\n    default:\n        break;\n    }\n    const QString localDir = writableLocation(type);\n    dirs.prepend(localDir);\n    return dirs;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <qvarlengtharray.h>",
      "#include <qcoreapplication.h>",
      "#include <qtextstream.h>",
      "#include <qhash.h>",
      "#include <qfile.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\"",
      "#include \"qplatformdefs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dirs.prepend",
          "args": [
            "localDir"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writableLocation",
          "args": [
            "type"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "writableLocation",
          "container": "QStandardPaths",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
          "lines": "91-263",
          "snippet": "QString QStandardPaths::writableLocation(StandardLocation type)\n{\n    switch (type) {\n    case HomeLocation:\n        return QDir::homePath();\n    case TempLocation:\n        return QDir::tempPath();\n    case CacheLocation:\n    case GenericCacheLocation:\n    {\n        // http://standards.freedesktop.org/basedir-spec/basedir-spec-0.6.html\n        QString xdgCacheHome = QFile::decodeName(qgetenv(\"XDG_CACHE_HOME\"));\n        if (isTestModeEnabled())\n            xdgCacheHome = QDir::homePath() + QLatin1String(\"/.qttest/cache\");\n        if (xdgCacheHome.isEmpty())\n            xdgCacheHome = QDir::homePath() + QLatin1String(\"/.cache\");\n        if (type == QStandardPaths::CacheLocation)\n            appendOrganizationAndApp(xdgCacheHome);\n        return xdgCacheHome;\n    }\n    case DataLocation:\n    case GenericDataLocation:\n    {\n        QString xdgDataHome = QFile::decodeName(qgetenv(\"XDG_DATA_HOME\"));\n        if (isTestModeEnabled())\n            xdgDataHome = QDir::homePath() + QLatin1String(\"/.qttest/share\");\n        if (xdgDataHome.isEmpty())\n            xdgDataHome = QDir::homePath() + QLatin1String(\"/.local/share\");\n        if (type == QStandardPaths::DataLocation)\n            appendOrganizationAndApp(xdgDataHome);\n        return xdgDataHome;\n    }\n    case ConfigLocation:\n    {\n        // http://standards.freedesktop.org/basedir-spec/latest/\n        QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n        if (isTestModeEnabled())\n            xdgConfigHome = QDir::homePath() + QLatin1String(\"/.qttest/config\");\n        if (xdgConfigHome.isEmpty())\n            xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n        return xdgConfigHome;\n    }\n    case RuntimeLocation:\n    {\n        const uid_t myUid = geteuid();\n        // http://standards.freedesktop.org/basedir-spec/latest/\n        QString xdgRuntimeDir = QFile::decodeName(qgetenv(\"XDG_RUNTIME_DIR\"));\n        if (xdgRuntimeDir.isEmpty()) {\n            const QString userName = _resolveUserName(myUid);\n            xdgRuntimeDir = QDir::tempPath() + QLatin1String(\"/runtime-\") + userName;\n            QDir dir(xdgRuntimeDir);\n            if (!dir.exists()) {\n                if (!QDir().mkdir(xdgRuntimeDir)) {\n                    qWarning(\"QStandardPaths: error creating runtime directory %s: %s\", qPrintable(xdgRuntimeDir), qPrintable(qt_error_string(errno)));\n                    return QString();\n                }\n            }\n        }\n        // \"The directory MUST be owned by the user\"\n        QFileInfo fileInfo(xdgRuntimeDir);\n        if (fileInfo.ownerId() != myUid) {\n            qWarning(\"QStandardPaths: wrong ownership on runtime directory %s, %d instead of %d\", qPrintable(xdgRuntimeDir),\n                     fileInfo.ownerId(), myUid);\n            return QString();\n        }\n        // \"and he MUST be the only one having read and write access to it. Its Unix access mode MUST be 0700.\"\n        QFile file(xdgRuntimeDir);\n        const QFile::Permissions wantedPerms = QFile::ReadUser | QFile::WriteUser | QFile::ExeUser;\n        if (file.permissions() != wantedPerms && !file.setPermissions(wantedPerms)) {\n            qWarning(\"QStandardPaths: wrong permissions on runtime directory %s\", qPrintable(xdgRuntimeDir));\n            return QString();\n        }\n        return xdgRuntimeDir;\n    }\n    default:\n        break;\n    }\n\n    // http://www.freedesktop.org/wiki/Software/xdg-user-dirs\n    QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n    if (xdgConfigHome.isEmpty())\n        xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n    QFile file(xdgConfigHome + QLatin1String(\"/user-dirs.dirs\"));\n    if (!isTestModeEnabled() && file.open(QIODevice::ReadOnly)) {\n        QHash<QString, QString> lines;\n        QTextStream stream(&file);\n        // Only look for lines like: XDG_DESKTOP_DIR=\"$HOME/Desktop\"\n        QRegExp exp(QLatin1String(\"^XDG_(.*)_DIR=(.*)$\"));\n        while (!stream.atEnd()) {\n            const QString &line = stream.readLine();\n            if (exp.indexIn(line) != -1) {\n                const QStringList lst = exp.capturedTexts();\n                const QString key = lst.at(1);\n                QString value = lst.at(2);\n                if (value.length() > 2\n                    && value.startsWith(QLatin1Char('\\\"'))\n                    && value.endsWith(QLatin1Char('\\\"')))\n                    value = value.mid(1, value.length() - 2);\n                // Store the key and value: \"DESKTOP\", \"$HOME/Desktop\"\n                lines[key] = value;\n            }\n        }\n\n        QString key;\n        switch (type) {\n        case DesktopLocation:\n            key = QLatin1String(\"DESKTOP\");\n            break;\n        case DocumentsLocation:\n            key = QLatin1String(\"DOCUMENTS\");\n            break;\n        case PicturesLocation:\n            key = QLatin1String(\"PICTURES\");\n            break;\n        case MusicLocation:\n            key = QLatin1String(\"MUSIC\");\n            break;\n        case MoviesLocation:\n            key = QLatin1String(\"VIDEOS\");\n            break;\n        case DownloadLocation:\n            key = QLatin1String(\"DOWNLOAD\");\n            break;\n        default:\n            break;\n        }\n        if (!key.isEmpty()) {\n            QString value = lines.value(key);\n            if (!value.isEmpty()) {\n                // value can start with $HOME\n                if (value.startsWith(QLatin1String(\"$HOME\")))\n                    value = QDir::homePath() + value.mid(5);\n                return value;\n            }\n        }\n    }\n\n    QString path;\n    switch (type) {\n    case DesktopLocation:\n        path = QDir::homePath() + QLatin1String(\"/Desktop\");\n        break;\n    case DocumentsLocation:\n        path = QDir::homePath() + QLatin1String(\"/Documents\");\n       break;\n    case PicturesLocation:\n        path = QDir::homePath() + QLatin1String(\"/Pictures\");\n        break;\n\n    case FontsLocation:\n        path = QDir::homePath() + QLatin1String(\"/.fonts\");\n        break;\n\n    case MusicLocation:\n        path = QDir::homePath() + QLatin1String(\"/Music\");\n        break;\n\n    case MoviesLocation:\n        path = QDir::homePath() + QLatin1String(\"/Videos\");\n        break;\n    case DownloadLocation:\n        path = QDir::homePath() + QLatin1String(\"/Downloads\");\n        break;\n    case ApplicationsLocation:\n        path = writableLocation(GenericDataLocation) + QLatin1String(\"/applications\");\n        break;\n\n    default:\n        break;\n    }\n\n    return path;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <qvarlengtharray.h>",
            "#include <qcoreapplication.h>",
            "#include <qtextstream.h>",
            "#include <qhash.h>",
            "#include <qfile.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\"",
            "#include \"qplatformdefs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nQStandardPaths {\n  QString QStandardPaths::writableLocation(StandardLocation type)\n  {\n      switch (type) {\n      case HomeLocation:\n          return QDir::homePath();\n      case TempLocation:\n          return QDir::tempPath();\n      case CacheLocation:\n      case GenericCacheLocation:\n      {\n          // http://standards.freedesktop.org/basedir-spec/basedir-spec-0.6.html\n          QString xdgCacheHome = QFile::decodeName(qgetenv(\"XDG_CACHE_HOME\"));\n          if (isTestModeEnabled())\n              xdgCacheHome = QDir::homePath() + QLatin1String(\"/.qttest/cache\");\n          if (xdgCacheHome.isEmpty())\n              xdgCacheHome = QDir::homePath() + QLatin1String(\"/.cache\");\n          if (type == QStandardPaths::CacheLocation)\n              appendOrganizationAndApp(xdgCacheHome);\n          return xdgCacheHome;\n      }\n      case DataLocation:\n      case GenericDataLocation:\n      {\n          QString xdgDataHome = QFile::decodeName(qgetenv(\"XDG_DATA_HOME\"));\n          if (isTestModeEnabled())\n              xdgDataHome = QDir::homePath() + QLatin1String(\"/.qttest/share\");\n          if (xdgDataHome.isEmpty())\n              xdgDataHome = QDir::homePath() + QLatin1String(\"/.local/share\");\n          if (type == QStandardPaths::DataLocation)\n              appendOrganizationAndApp(xdgDataHome);\n          return xdgDataHome;\n      }\n      case ConfigLocation:\n      {\n          // http://standards.freedesktop.org/basedir-spec/latest/\n          QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n          if (isTestModeEnabled())\n              xdgConfigHome = QDir::homePath() + QLatin1String(\"/.qttest/config\");\n          if (xdgConfigHome.isEmpty())\n              xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n          return xdgConfigHome;\n      }\n      case RuntimeLocation:\n      {\n          const uid_t myUid = geteuid();\n          // http://standards.freedesktop.org/basedir-spec/latest/\n          QString xdgRuntimeDir = QFile::decodeName(qgetenv(\"XDG_RUNTIME_DIR\"));\n          if (xdgRuntimeDir.isEmpty()) {\n              const QString userName = _resolveUserName(myUid);\n              xdgRuntimeDir = QDir::tempPath() + QLatin1String(\"/runtime-\") + userName;\n              QDir dir(xdgRuntimeDir);\n              if (!dir.exists()) {\n                  if (!QDir().mkdir(xdgRuntimeDir)) {\n                      qWarning(\"QStandardPaths: error creating runtime directory %s: %s\", qPrintable(xdgRuntimeDir), qPrintable(qt_error_string(errno)));\n                      return QString();\n                  }\n              }\n          }\n          // \"The directory MUST be owned by the user\"\n          QFileInfo fileInfo(xdgRuntimeDir);\n          if (fileInfo.ownerId() != myUid) {\n              qWarning(\"QStandardPaths: wrong ownership on runtime directory %s, %d instead of %d\", qPrintable(xdgRuntimeDir),\n                       fileInfo.ownerId(), myUid);\n              return QString();\n          }\n          // \"and he MUST be the only one having read and write access to it. Its Unix access mode MUST be 0700.\"\n          QFile file(xdgRuntimeDir);\n          const QFile::Permissions wantedPerms = QFile::ReadUser | QFile::WriteUser | QFile::ExeUser;\n          if (file.permissions() != wantedPerms && !file.setPermissions(wantedPerms)) {\n              qWarning(\"QStandardPaths: wrong permissions on runtime directory %s\", qPrintable(xdgRuntimeDir));\n              return QString();\n          }\n          return xdgRuntimeDir;\n      }\n      default:\n          break;\n      }\n  \n      // http://www.freedesktop.org/wiki/Software/xdg-user-dirs\n      QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n      if (xdgConfigHome.isEmpty())\n          xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n      QFile file(xdgConfigHome + QLatin1String(\"/user-dirs.dirs\"));\n      if (!isTestModeEnabled() && file.open(QIODevice::ReadOnly)) {\n          QHash<QString, QString> lines;\n          QTextStream stream(&file);\n          // Only look for lines like: XDG_DESKTOP_DIR=\"$HOME/Desktop\"\n          QRegExp exp(QLatin1String(\"^XDG_(.*)_DIR=(.*)$\"));\n          while (!stream.atEnd()) {\n              const QString &line = stream.readLine();\n              if (exp.indexIn(line) != -1) {\n                  const QStringList lst = exp.capturedTexts();\n                  const QString key = lst.at(1);\n                  QString value = lst.at(2);\n                  if (value.length() > 2\n                      && value.startsWith(QLatin1Char('\\\"'))\n                      && value.endsWith(QLatin1Char('\\\"')))\n                      value = value.mid(1, value.length() - 2);\n                  // Store the key and value: \"DESKTOP\", \"$HOME/Desktop\"\n                  lines[key] = value;\n              }\n          }\n  \n          QString key;\n          switch (type) {\n          case DesktopLocation:\n              key = QLatin1String(\"DESKTOP\");\n              break;\n          case DocumentsLocation:\n              key = QLatin1String(\"DOCUMENTS\");\n              break;\n          case PicturesLocation:\n              key = QLatin1String(\"PICTURES\");\n              break;\n          case MusicLocation:\n              key = QLatin1String(\"MUSIC\");\n              break;\n          case MoviesLocation:\n              key = QLatin1String(\"VIDEOS\");\n              break;\n          case DownloadLocation:\n              key = QLatin1String(\"DOWNLOAD\");\n              break;\n          default:\n              break;\n          }\n          if (!key.isEmpty()) {\n              QString value = lines.value(key);\n              if (!value.isEmpty()) {\n                  // value can start with $HOME\n                  if (value.startsWith(QLatin1String(\"$HOME\")))\n                      value = QDir::homePath() + value.mid(5);\n                  return value;\n              }\n          }\n      }\n  \n      QString path;\n      switch (type) {\n      case DesktopLocation:\n          path = QDir::homePath() + QLatin1String(\"/Desktop\");\n          break;\n      case DocumentsLocation:\n          path = QDir::homePath() + QLatin1String(\"/Documents\");\n         break;\n      case PicturesLocation:\n          path = QDir::homePath() + QLatin1String(\"/Pictures\");\n          break;\n  \n      case FontsLocation:\n          path = QDir::homePath() + QLatin1String(\"/.fonts\");\n          break;\n  \n      case MusicLocation:\n          path = QDir::homePath() + QLatin1String(\"/Music\");\n          break;\n  \n      case MoviesLocation:\n          path = QDir::homePath() + QLatin1String(\"/Videos\");\n          break;\n      case DownloadLocation:\n          path = QDir::homePath() + QLatin1String(\"/Downloads\");\n          break;\n      case ApplicationsLocation:\n          path = writableLocation(GenericDataLocation) + QLatin1String(\"/applications\");\n          break;\n  \n      default:\n          break;\n      }\n  \n      return path;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "appendOrganizationAndApp",
          "args": [
            "dirs[i]"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "appendOrganizationAndApp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
          "lines": "81-89",
          "snippet": "static void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <qvarlengtharray.h>",
            "#include <qcoreapplication.h>",
            "#include <qtextstream.h>",
            "#include <qhash.h>",
            "#include <qfile.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\"",
            "#include \"qplatformdefs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nstatic void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dirs.count",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdgDataDirs",
          "args": [],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "xdgDataDirs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
          "lines": "265-277",
          "snippet": "static QStringList xdgDataDirs()\n{\n    QStringList dirs;\n    // http://standards.freedesktop.org/basedir-spec/latest/\n    QString xdgDataDirsEnv = QFile::decodeName(qgetenv(\"XDG_DATA_DIRS\"));\n    if (xdgDataDirsEnv.isEmpty()) {\n        dirs.append(QString::fromLatin1(\"/usr/local/share\"));\n        dirs.append(QString::fromLatin1(\"/usr/share\"));\n    } else {\n        dirs = xdgDataDirsEnv.split(QLatin1Char(':'));\n    }\n    return dirs;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <qvarlengtharray.h>",
            "#include <qcoreapplication.h>",
            "#include <qtextstream.h>",
            "#include <qhash.h>",
            "#include <qfile.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\"",
            "#include \"qplatformdefs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nstatic QStringList xdgDataDirs()\n{\n    QStringList dirs;\n    // http://standards.freedesktop.org/basedir-spec/latest/\n    QString xdgDataDirsEnv = QFile::decodeName(qgetenv(\"XDG_DATA_DIRS\"));\n    if (xdgDataDirsEnv.isEmpty()) {\n        dirs.append(QString::fromLatin1(\"/usr/local/share\"));\n        dirs.append(QString::fromLatin1(\"/usr/share\"));\n    } else {\n        dirs = xdgDataDirsEnv.split(QLatin1Char(':'));\n    }\n    return dirs;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dirs[i].append",
          "args": [
            "QLatin1String(\"/applications\")"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/applications\""
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdgConfigDirs.split",
          "args": [
            "QLatin1Char(':')"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "':'"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs.append",
          "args": [
            "QString::fromLatin1(\"/etc/xdg\")"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromLatin1",
          "args": [
            "\"/etc/xdg\""
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdgConfigDirs.isEmpty",
          "args": [],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFile::decodeName",
          "args": [
            "qgetenv(\"XDG_CONFIG_DIRS\")"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qgetenv",
          "args": [
            "\"XDG_CONFIG_DIRS\""
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nQStandardPaths {\n  QStringList QStandardPaths::standardLocations(StandardLocation type)\n  {\n      QStringList dirs;\n      switch (type) {\n      case ConfigLocation:\n      {\n          // http://standards.freedesktop.org/basedir-spec/latest/\n          const QString xdgConfigDirs = QFile::decodeName(qgetenv(\"XDG_CONFIG_DIRS\"));\n          if (xdgConfigDirs.isEmpty())\n              dirs.append(QString::fromLatin1(\"/etc/xdg\"));\n          else\n              dirs = xdgConfigDirs.split(QLatin1Char(':'));\n      }\n      break;\n      case GenericDataLocation:\n          dirs = xdgDataDirs();\n          break;\n      case ApplicationsLocation:\n          dirs = xdgDataDirs();\n          for (int i = 0; i < dirs.count(); ++i)\n              dirs[i].append(QLatin1String(\"/applications\"));\n          break;\n      case DataLocation:\n          dirs = xdgDataDirs();\n          for (int i = 0; i < dirs.count(); ++i)\n              appendOrganizationAndApp(dirs[i]);\n          break;\n      default:\n          break;\n      }\n      const QString localDir = writableLocation(type);\n      dirs.prepend(localDir);\n      return dirs;\n  }\n}"
  },
  {
    "function_name": "xdgDataDirs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
    "lines": "265-277",
    "snippet": "static QStringList xdgDataDirs()\n{\n    QStringList dirs;\n    // http://standards.freedesktop.org/basedir-spec/latest/\n    QString xdgDataDirsEnv = QFile::decodeName(qgetenv(\"XDG_DATA_DIRS\"));\n    if (xdgDataDirsEnv.isEmpty()) {\n        dirs.append(QString::fromLatin1(\"/usr/local/share\"));\n        dirs.append(QString::fromLatin1(\"/usr/share\"));\n    } else {\n        dirs = xdgDataDirsEnv.split(QLatin1Char(':'));\n    }\n    return dirs;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <qvarlengtharray.h>",
      "#include <qcoreapplication.h>",
      "#include <qtextstream.h>",
      "#include <qhash.h>",
      "#include <qfile.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\"",
      "#include \"qplatformdefs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xdgDataDirsEnv.split",
          "args": [
            "QLatin1Char(':')"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "':'"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs.append",
          "args": [
            "QString::fromLatin1(\"/usr/share\")"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromLatin1",
          "args": [
            "\"/usr/share\""
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dirs.append",
          "args": [
            "QString::fromLatin1(\"/usr/local/share\")"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromLatin1",
          "args": [
            "\"/usr/local/share\""
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdgDataDirsEnv.isEmpty",
          "args": [],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFile::decodeName",
          "args": [
            "qgetenv(\"XDG_DATA_DIRS\")"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qgetenv",
          "args": [
            "\"XDG_DATA_DIRS\""
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nstatic QStringList xdgDataDirs()\n{\n    QStringList dirs;\n    // http://standards.freedesktop.org/basedir-spec/latest/\n    QString xdgDataDirsEnv = QFile::decodeName(qgetenv(\"XDG_DATA_DIRS\"));\n    if (xdgDataDirsEnv.isEmpty()) {\n        dirs.append(QString::fromLatin1(\"/usr/local/share\"));\n        dirs.append(QString::fromLatin1(\"/usr/share\"));\n    } else {\n        dirs = xdgDataDirsEnv.split(QLatin1Char(':'));\n    }\n    return dirs;\n}"
  },
  {
    "function_name": "writableLocation",
    "container": "QStandardPaths",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
    "lines": "91-263",
    "snippet": "QString QStandardPaths::writableLocation(StandardLocation type)\n{\n    switch (type) {\n    case HomeLocation:\n        return QDir::homePath();\n    case TempLocation:\n        return QDir::tempPath();\n    case CacheLocation:\n    case GenericCacheLocation:\n    {\n        // http://standards.freedesktop.org/basedir-spec/basedir-spec-0.6.html\n        QString xdgCacheHome = QFile::decodeName(qgetenv(\"XDG_CACHE_HOME\"));\n        if (isTestModeEnabled())\n            xdgCacheHome = QDir::homePath() + QLatin1String(\"/.qttest/cache\");\n        if (xdgCacheHome.isEmpty())\n            xdgCacheHome = QDir::homePath() + QLatin1String(\"/.cache\");\n        if (type == QStandardPaths::CacheLocation)\n            appendOrganizationAndApp(xdgCacheHome);\n        return xdgCacheHome;\n    }\n    case DataLocation:\n    case GenericDataLocation:\n    {\n        QString xdgDataHome = QFile::decodeName(qgetenv(\"XDG_DATA_HOME\"));\n        if (isTestModeEnabled())\n            xdgDataHome = QDir::homePath() + QLatin1String(\"/.qttest/share\");\n        if (xdgDataHome.isEmpty())\n            xdgDataHome = QDir::homePath() + QLatin1String(\"/.local/share\");\n        if (type == QStandardPaths::DataLocation)\n            appendOrganizationAndApp(xdgDataHome);\n        return xdgDataHome;\n    }\n    case ConfigLocation:\n    {\n        // http://standards.freedesktop.org/basedir-spec/latest/\n        QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n        if (isTestModeEnabled())\n            xdgConfigHome = QDir::homePath() + QLatin1String(\"/.qttest/config\");\n        if (xdgConfigHome.isEmpty())\n            xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n        return xdgConfigHome;\n    }\n    case RuntimeLocation:\n    {\n        const uid_t myUid = geteuid();\n        // http://standards.freedesktop.org/basedir-spec/latest/\n        QString xdgRuntimeDir = QFile::decodeName(qgetenv(\"XDG_RUNTIME_DIR\"));\n        if (xdgRuntimeDir.isEmpty()) {\n            const QString userName = _resolveUserName(myUid);\n            xdgRuntimeDir = QDir::tempPath() + QLatin1String(\"/runtime-\") + userName;\n            QDir dir(xdgRuntimeDir);\n            if (!dir.exists()) {\n                if (!QDir().mkdir(xdgRuntimeDir)) {\n                    qWarning(\"QStandardPaths: error creating runtime directory %s: %s\", qPrintable(xdgRuntimeDir), qPrintable(qt_error_string(errno)));\n                    return QString();\n                }\n            }\n        }\n        // \"The directory MUST be owned by the user\"\n        QFileInfo fileInfo(xdgRuntimeDir);\n        if (fileInfo.ownerId() != myUid) {\n            qWarning(\"QStandardPaths: wrong ownership on runtime directory %s, %d instead of %d\", qPrintable(xdgRuntimeDir),\n                     fileInfo.ownerId(), myUid);\n            return QString();\n        }\n        // \"and he MUST be the only one having read and write access to it. Its Unix access mode MUST be 0700.\"\n        QFile file(xdgRuntimeDir);\n        const QFile::Permissions wantedPerms = QFile::ReadUser | QFile::WriteUser | QFile::ExeUser;\n        if (file.permissions() != wantedPerms && !file.setPermissions(wantedPerms)) {\n            qWarning(\"QStandardPaths: wrong permissions on runtime directory %s\", qPrintable(xdgRuntimeDir));\n            return QString();\n        }\n        return xdgRuntimeDir;\n    }\n    default:\n        break;\n    }\n\n    // http://www.freedesktop.org/wiki/Software/xdg-user-dirs\n    QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n    if (xdgConfigHome.isEmpty())\n        xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n    QFile file(xdgConfigHome + QLatin1String(\"/user-dirs.dirs\"));\n    if (!isTestModeEnabled() && file.open(QIODevice::ReadOnly)) {\n        QHash<QString, QString> lines;\n        QTextStream stream(&file);\n        // Only look for lines like: XDG_DESKTOP_DIR=\"$HOME/Desktop\"\n        QRegExp exp(QLatin1String(\"^XDG_(.*)_DIR=(.*)$\"));\n        while (!stream.atEnd()) {\n            const QString &line = stream.readLine();\n            if (exp.indexIn(line) != -1) {\n                const QStringList lst = exp.capturedTexts();\n                const QString key = lst.at(1);\n                QString value = lst.at(2);\n                if (value.length() > 2\n                    && value.startsWith(QLatin1Char('\\\"'))\n                    && value.endsWith(QLatin1Char('\\\"')))\n                    value = value.mid(1, value.length() - 2);\n                // Store the key and value: \"DESKTOP\", \"$HOME/Desktop\"\n                lines[key] = value;\n            }\n        }\n\n        QString key;\n        switch (type) {\n        case DesktopLocation:\n            key = QLatin1String(\"DESKTOP\");\n            break;\n        case DocumentsLocation:\n            key = QLatin1String(\"DOCUMENTS\");\n            break;\n        case PicturesLocation:\n            key = QLatin1String(\"PICTURES\");\n            break;\n        case MusicLocation:\n            key = QLatin1String(\"MUSIC\");\n            break;\n        case MoviesLocation:\n            key = QLatin1String(\"VIDEOS\");\n            break;\n        case DownloadLocation:\n            key = QLatin1String(\"DOWNLOAD\");\n            break;\n        default:\n            break;\n        }\n        if (!key.isEmpty()) {\n            QString value = lines.value(key);\n            if (!value.isEmpty()) {\n                // value can start with $HOME\n                if (value.startsWith(QLatin1String(\"$HOME\")))\n                    value = QDir::homePath() + value.mid(5);\n                return value;\n            }\n        }\n    }\n\n    QString path;\n    switch (type) {\n    case DesktopLocation:\n        path = QDir::homePath() + QLatin1String(\"/Desktop\");\n        break;\n    case DocumentsLocation:\n        path = QDir::homePath() + QLatin1String(\"/Documents\");\n       break;\n    case PicturesLocation:\n        path = QDir::homePath() + QLatin1String(\"/Pictures\");\n        break;\n\n    case FontsLocation:\n        path = QDir::homePath() + QLatin1String(\"/.fonts\");\n        break;\n\n    case MusicLocation:\n        path = QDir::homePath() + QLatin1String(\"/Music\");\n        break;\n\n    case MoviesLocation:\n        path = QDir::homePath() + QLatin1String(\"/Videos\");\n        break;\n    case DownloadLocation:\n        path = QDir::homePath() + QLatin1String(\"/Downloads\");\n        break;\n    case ApplicationsLocation:\n        path = writableLocation(GenericDataLocation) + QLatin1String(\"/applications\");\n        break;\n\n    default:\n        break;\n    }\n\n    return path;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <qvarlengtharray.h>",
      "#include <qcoreapplication.h>",
      "#include <qtextstream.h>",
      "#include <qhash.h>",
      "#include <qfile.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\"",
      "#include \"qplatformdefs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/applications\""
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writableLocation",
          "args": [
            "GenericDataLocation"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "writableLocation",
          "container": "QStandardPaths",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
          "lines": "91-263",
          "snippet": "QString QStandardPaths::writableLocation(StandardLocation type)\n{\n    switch (type) {\n    case HomeLocation:\n        return QDir::homePath();\n    case TempLocation:\n        return QDir::tempPath();\n    case CacheLocation:\n    case GenericCacheLocation:\n    {\n        // http://standards.freedesktop.org/basedir-spec/basedir-spec-0.6.html\n        QString xdgCacheHome = QFile::decodeName(qgetenv(\"XDG_CACHE_HOME\"));\n        if (isTestModeEnabled())\n            xdgCacheHome = QDir::homePath() + QLatin1String(\"/.qttest/cache\");\n        if (xdgCacheHome.isEmpty())\n            xdgCacheHome = QDir::homePath() + QLatin1String(\"/.cache\");\n        if (type == QStandardPaths::CacheLocation)\n            appendOrganizationAndApp(xdgCacheHome);\n        return xdgCacheHome;\n    }\n    case DataLocation:\n    case GenericDataLocation:\n    {\n        QString xdgDataHome = QFile::decodeName(qgetenv(\"XDG_DATA_HOME\"));\n        if (isTestModeEnabled())\n            xdgDataHome = QDir::homePath() + QLatin1String(\"/.qttest/share\");\n        if (xdgDataHome.isEmpty())\n            xdgDataHome = QDir::homePath() + QLatin1String(\"/.local/share\");\n        if (type == QStandardPaths::DataLocation)\n            appendOrganizationAndApp(xdgDataHome);\n        return xdgDataHome;\n    }\n    case ConfigLocation:\n    {\n        // http://standards.freedesktop.org/basedir-spec/latest/\n        QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n        if (isTestModeEnabled())\n            xdgConfigHome = QDir::homePath() + QLatin1String(\"/.qttest/config\");\n        if (xdgConfigHome.isEmpty())\n            xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n        return xdgConfigHome;\n    }\n    case RuntimeLocation:\n    {\n        const uid_t myUid = geteuid();\n        // http://standards.freedesktop.org/basedir-spec/latest/\n        QString xdgRuntimeDir = QFile::decodeName(qgetenv(\"XDG_RUNTIME_DIR\"));\n        if (xdgRuntimeDir.isEmpty()) {\n            const QString userName = _resolveUserName(myUid);\n            xdgRuntimeDir = QDir::tempPath() + QLatin1String(\"/runtime-\") + userName;\n            QDir dir(xdgRuntimeDir);\n            if (!dir.exists()) {\n                if (!QDir().mkdir(xdgRuntimeDir)) {\n                    qWarning(\"QStandardPaths: error creating runtime directory %s: %s\", qPrintable(xdgRuntimeDir), qPrintable(qt_error_string(errno)));\n                    return QString();\n                }\n            }\n        }\n        // \"The directory MUST be owned by the user\"\n        QFileInfo fileInfo(xdgRuntimeDir);\n        if (fileInfo.ownerId() != myUid) {\n            qWarning(\"QStandardPaths: wrong ownership on runtime directory %s, %d instead of %d\", qPrintable(xdgRuntimeDir),\n                     fileInfo.ownerId(), myUid);\n            return QString();\n        }\n        // \"and he MUST be the only one having read and write access to it. Its Unix access mode MUST be 0700.\"\n        QFile file(xdgRuntimeDir);\n        const QFile::Permissions wantedPerms = QFile::ReadUser | QFile::WriteUser | QFile::ExeUser;\n        if (file.permissions() != wantedPerms && !file.setPermissions(wantedPerms)) {\n            qWarning(\"QStandardPaths: wrong permissions on runtime directory %s\", qPrintable(xdgRuntimeDir));\n            return QString();\n        }\n        return xdgRuntimeDir;\n    }\n    default:\n        break;\n    }\n\n    // http://www.freedesktop.org/wiki/Software/xdg-user-dirs\n    QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n    if (xdgConfigHome.isEmpty())\n        xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n    QFile file(xdgConfigHome + QLatin1String(\"/user-dirs.dirs\"));\n    if (!isTestModeEnabled() && file.open(QIODevice::ReadOnly)) {\n        QHash<QString, QString> lines;\n        QTextStream stream(&file);\n        // Only look for lines like: XDG_DESKTOP_DIR=\"$HOME/Desktop\"\n        QRegExp exp(QLatin1String(\"^XDG_(.*)_DIR=(.*)$\"));\n        while (!stream.atEnd()) {\n            const QString &line = stream.readLine();\n            if (exp.indexIn(line) != -1) {\n                const QStringList lst = exp.capturedTexts();\n                const QString key = lst.at(1);\n                QString value = lst.at(2);\n                if (value.length() > 2\n                    && value.startsWith(QLatin1Char('\\\"'))\n                    && value.endsWith(QLatin1Char('\\\"')))\n                    value = value.mid(1, value.length() - 2);\n                // Store the key and value: \"DESKTOP\", \"$HOME/Desktop\"\n                lines[key] = value;\n            }\n        }\n\n        QString key;\n        switch (type) {\n        case DesktopLocation:\n            key = QLatin1String(\"DESKTOP\");\n            break;\n        case DocumentsLocation:\n            key = QLatin1String(\"DOCUMENTS\");\n            break;\n        case PicturesLocation:\n            key = QLatin1String(\"PICTURES\");\n            break;\n        case MusicLocation:\n            key = QLatin1String(\"MUSIC\");\n            break;\n        case MoviesLocation:\n            key = QLatin1String(\"VIDEOS\");\n            break;\n        case DownloadLocation:\n            key = QLatin1String(\"DOWNLOAD\");\n            break;\n        default:\n            break;\n        }\n        if (!key.isEmpty()) {\n            QString value = lines.value(key);\n            if (!value.isEmpty()) {\n                // value can start with $HOME\n                if (value.startsWith(QLatin1String(\"$HOME\")))\n                    value = QDir::homePath() + value.mid(5);\n                return value;\n            }\n        }\n    }\n\n    QString path;\n    switch (type) {\n    case DesktopLocation:\n        path = QDir::homePath() + QLatin1String(\"/Desktop\");\n        break;\n    case DocumentsLocation:\n        path = QDir::homePath() + QLatin1String(\"/Documents\");\n       break;\n    case PicturesLocation:\n        path = QDir::homePath() + QLatin1String(\"/Pictures\");\n        break;\n\n    case FontsLocation:\n        path = QDir::homePath() + QLatin1String(\"/.fonts\");\n        break;\n\n    case MusicLocation:\n        path = QDir::homePath() + QLatin1String(\"/Music\");\n        break;\n\n    case MoviesLocation:\n        path = QDir::homePath() + QLatin1String(\"/Videos\");\n        break;\n    case DownloadLocation:\n        path = QDir::homePath() + QLatin1String(\"/Downloads\");\n        break;\n    case ApplicationsLocation:\n        path = writableLocation(GenericDataLocation) + QLatin1String(\"/applications\");\n        break;\n\n    default:\n        break;\n    }\n\n    return path;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Downloads\""
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Videos\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Music\""
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.fonts\""
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Pictures\""
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Documents\""
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Desktop\""
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.mid",
          "args": [
            "5"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.startsWith",
          "args": [
            "QLatin1String(\"$HOME\")"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"$HOME\""
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.isEmpty",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lines.value",
          "args": [
            "key"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "187-205",
          "snippet": "QVariant XSqlQuery::value(const QString & name) const\n{\n    if (name.isEmpty())\n        return QVariant();\n\n    if (_data && !_data->_currRecord.isEmpty())\n    {\n        int i = _data->_currRecord.indexOf(name);\n        if(i<0)\n        {\n            QString err = \"Column \" + name + \" not found in record\";\n            qWarning(\"%s\", err.toLocal8Bit().constData());\n            return QVariant(_nameErrorValue);\n        }\n        return value(_data->_currRecord.indexOf(name));\n    }\n\n    return QVariant();\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [
            "static QString _nameErrorValue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nstatic QString _nameErrorValue;\n\nXSqlQuery {\n  QVariant XSqlQuery::value(const QString & name) const\n  {\n      if (name.isEmpty())\n          return QVariant();\n  \n      if (_data && !_data->_currRecord.isEmpty())\n      {\n          int i = _data->_currRecord.indexOf(name);\n          if(i<0)\n          {\n              QString err = \"Column \" + name + \" not found in record\";\n              qWarning(\"%s\", err.toLocal8Bit().constData());\n              return QVariant(_nameErrorValue);\n          }\n          return value(_data->_currRecord.indexOf(name));\n      }\n  \n      return QVariant();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.isEmpty",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"DOWNLOAD\""
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"VIDEOS\""
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"MUSIC\""
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"PICTURES\""
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"DOCUMENTS\""
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"DESKTOP\""
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.mid",
          "args": [
            "1",
            "value.length() - 2"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.length",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.endsWith",
          "args": [
            "QLatin1Char('\\\"')"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'\\\"'"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.startsWith",
          "args": [
            "QLatin1Char('\\\"')"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'\\\"'"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.length",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lst.at",
          "args": [
            "2"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lst.at",
          "args": [
            "1"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.capturedTexts",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "exp.indexIn",
          "args": [
            "line"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.readLine",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stream.atEnd",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"^XDG_(.*)_DIR=(.*)$\""
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.open",
          "args": [
            "QIODevice::ReadOnly"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isTestModeEnabled",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "isTestModeEnabled",
          "container": "QStandardPaths",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths.cpp",
          "lines": "351-354",
          "snippet": "bool QStandardPaths::isTestModeEnabled()\n{\n    return qsp_testMode;\n}",
          "includes": [
            "#include <qcoreapplication.h>",
            "#include <qobject.h>",
            "#include <qhash.h>",
            "#include <qfileinfo.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qcoreapplication.h>\n#include <qobject.h>\n#include <qhash.h>\n#include <qfileinfo.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nQStandardPaths {\n  bool QStandardPaths::isTestModeEnabled()\n  {\n      return qsp_testMode;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/user-dirs.dirs\""
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.config\""
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdgConfigHome.isEmpty",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFile::decodeName",
          "args": [
            "qgetenv(\"XDG_CONFIG_HOME\")"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qgetenv",
          "args": [
            "\"XDG_CONFIG_HOME\""
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qWarning",
          "args": [
            "\"QStandardPaths: wrong permissions on runtime directory %s\"",
            "qPrintable(xdgRuntimeDir)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qPrintable",
          "args": [
            "xdgRuntimeDir"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.setPermissions",
          "args": [
            "wantedPerms"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file.permissions",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qWarning",
          "args": [
            "\"QStandardPaths: wrong ownership on runtime directory %s, %d instead of %d\"",
            "qPrintable(xdgRuntimeDir)",
            "fileInfo.ownerId()",
            "myUid"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileInfo.ownerId",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qPrintable",
          "args": [
            "xdgRuntimeDir"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileInfo.ownerId",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qWarning",
          "args": [
            "\"QStandardPaths: error creating runtime directory %s: %s\"",
            "qPrintable(xdgRuntimeDir)",
            "qPrintable(qt_error_string(errno))"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qPrintable",
          "args": [
            "qt_error_string(errno)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qt_error_string",
          "args": [
            "errno"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qPrintable",
          "args": [
            "xdgRuntimeDir"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir",
          "args": [
            "xdgRuntimeDir"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.exists",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/runtime-\""
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::tempPath",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_resolveUserName",
          "args": [
            "myUid"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "_resolveUserName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
          "lines": "55-79",
          "snippet": "QT_BEGIN_NAMESPACE\n\n//static\nQString _resolveUserName(uint userId)\n{\n#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)\n    int size_max = sysconf(_SC_GETPW_R_SIZE_MAX);\n    if (size_max == -1)\n        size_max = 1024;\n    QVarLengthArray<char, 1024> buf(size_max);\n#endif\n\n    struct passwd *pw = 0;\n#if !defined(Q_OS_INTEGRITY)\n#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)\n    struct passwd entry;\n    getpwuid_r(userId, &entry, buf.data(), buf.size(), &pw);\n#else\n    pw = getpwuid(userId);\n#endif\n#endif\n    if (pw)\n        return QFile::decodeName(QByteArray(pw->pw_name));\n    return QString();\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <qvarlengtharray.h>",
            "#include <qcoreapplication.h>",
            "#include <qtextstream.h>",
            "#include <qhash.h>",
            "#include <qfile.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\"",
            "#include \"qplatformdefs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nQT_BEGIN_NAMESPACE\n\n//static\nQString _resolveUserName(uint userId)\n{\n#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)\n    int size_max = sysconf(_SC_GETPW_R_SIZE_MAX);\n    if (size_max == -1)\n        size_max = 1024;\n    QVarLengthArray<char, 1024> buf(size_max);\n#endif\n\n    struct passwd *pw = 0;\n#if !defined(Q_OS_INTEGRITY)\n#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)\n    struct passwd entry;\n    getpwuid_r(userId, &entry, buf.data(), buf.size(), &pw);\n#else\n    pw = getpwuid(userId);\n#endif\n#endif\n    if (pw)\n        return QFile::decodeName(QByteArray(pw->pw_name));\n    return QString();\n}"
        }
      },
      {
        "call_info": {
          "callee": "xdgRuntimeDir.isEmpty",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFile::decodeName",
          "args": [
            "qgetenv(\"XDG_RUNTIME_DIR\")"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qgetenv",
          "args": [
            "\"XDG_RUNTIME_DIR\""
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.config\""
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdgConfigHome.isEmpty",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.qttest/config\""
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFile::decodeName",
          "args": [
            "qgetenv(\"XDG_CONFIG_HOME\")"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qgetenv",
          "args": [
            "\"XDG_CONFIG_HOME\""
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appendOrganizationAndApp",
          "args": [
            "xdgDataHome"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "appendOrganizationAndApp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
          "lines": "81-89",
          "snippet": "static void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <errno.h>",
            "#include <qvarlengtharray.h>",
            "#include <qcoreapplication.h>",
            "#include <qtextstream.h>",
            "#include <qhash.h>",
            "#include <qfile.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\"",
            "#include \"qplatformdefs.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nstatic void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.local/share\""
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdgDataHome.isEmpty",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.qttest/share\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFile::decodeName",
          "args": [
            "qgetenv(\"XDG_DATA_HOME\")"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qgetenv",
          "args": [
            "\"XDG_DATA_HOME\""
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.cache\""
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xdgCacheHome.isEmpty",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.qttest/cache\""
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFile::decodeName",
          "args": [
            "qgetenv(\"XDG_CACHE_HOME\")"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qgetenv",
          "args": [
            "\"XDG_CACHE_HOME\""
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::tempPath",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nQStandardPaths {\n  QString QStandardPaths::writableLocation(StandardLocation type)\n  {\n      switch (type) {\n      case HomeLocation:\n          return QDir::homePath();\n      case TempLocation:\n          return QDir::tempPath();\n      case CacheLocation:\n      case GenericCacheLocation:\n      {\n          // http://standards.freedesktop.org/basedir-spec/basedir-spec-0.6.html\n          QString xdgCacheHome = QFile::decodeName(qgetenv(\"XDG_CACHE_HOME\"));\n          if (isTestModeEnabled())\n              xdgCacheHome = QDir::homePath() + QLatin1String(\"/.qttest/cache\");\n          if (xdgCacheHome.isEmpty())\n              xdgCacheHome = QDir::homePath() + QLatin1String(\"/.cache\");\n          if (type == QStandardPaths::CacheLocation)\n              appendOrganizationAndApp(xdgCacheHome);\n          return xdgCacheHome;\n      }\n      case DataLocation:\n      case GenericDataLocation:\n      {\n          QString xdgDataHome = QFile::decodeName(qgetenv(\"XDG_DATA_HOME\"));\n          if (isTestModeEnabled())\n              xdgDataHome = QDir::homePath() + QLatin1String(\"/.qttest/share\");\n          if (xdgDataHome.isEmpty())\n              xdgDataHome = QDir::homePath() + QLatin1String(\"/.local/share\");\n          if (type == QStandardPaths::DataLocation)\n              appendOrganizationAndApp(xdgDataHome);\n          return xdgDataHome;\n      }\n      case ConfigLocation:\n      {\n          // http://standards.freedesktop.org/basedir-spec/latest/\n          QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n          if (isTestModeEnabled())\n              xdgConfigHome = QDir::homePath() + QLatin1String(\"/.qttest/config\");\n          if (xdgConfigHome.isEmpty())\n              xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n          return xdgConfigHome;\n      }\n      case RuntimeLocation:\n      {\n          const uid_t myUid = geteuid();\n          // http://standards.freedesktop.org/basedir-spec/latest/\n          QString xdgRuntimeDir = QFile::decodeName(qgetenv(\"XDG_RUNTIME_DIR\"));\n          if (xdgRuntimeDir.isEmpty()) {\n              const QString userName = _resolveUserName(myUid);\n              xdgRuntimeDir = QDir::tempPath() + QLatin1String(\"/runtime-\") + userName;\n              QDir dir(xdgRuntimeDir);\n              if (!dir.exists()) {\n                  if (!QDir().mkdir(xdgRuntimeDir)) {\n                      qWarning(\"QStandardPaths: error creating runtime directory %s: %s\", qPrintable(xdgRuntimeDir), qPrintable(qt_error_string(errno)));\n                      return QString();\n                  }\n              }\n          }\n          // \"The directory MUST be owned by the user\"\n          QFileInfo fileInfo(xdgRuntimeDir);\n          if (fileInfo.ownerId() != myUid) {\n              qWarning(\"QStandardPaths: wrong ownership on runtime directory %s, %d instead of %d\", qPrintable(xdgRuntimeDir),\n                       fileInfo.ownerId(), myUid);\n              return QString();\n          }\n          // \"and he MUST be the only one having read and write access to it. Its Unix access mode MUST be 0700.\"\n          QFile file(xdgRuntimeDir);\n          const QFile::Permissions wantedPerms = QFile::ReadUser | QFile::WriteUser | QFile::ExeUser;\n          if (file.permissions() != wantedPerms && !file.setPermissions(wantedPerms)) {\n              qWarning(\"QStandardPaths: wrong permissions on runtime directory %s\", qPrintable(xdgRuntimeDir));\n              return QString();\n          }\n          return xdgRuntimeDir;\n      }\n      default:\n          break;\n      }\n  \n      // http://www.freedesktop.org/wiki/Software/xdg-user-dirs\n      QString xdgConfigHome = QFile::decodeName(qgetenv(\"XDG_CONFIG_HOME\"));\n      if (xdgConfigHome.isEmpty())\n          xdgConfigHome = QDir::homePath() + QLatin1String(\"/.config\");\n      QFile file(xdgConfigHome + QLatin1String(\"/user-dirs.dirs\"));\n      if (!isTestModeEnabled() && file.open(QIODevice::ReadOnly)) {\n          QHash<QString, QString> lines;\n          QTextStream stream(&file);\n          // Only look for lines like: XDG_DESKTOP_DIR=\"$HOME/Desktop\"\n          QRegExp exp(QLatin1String(\"^XDG_(.*)_DIR=(.*)$\"));\n          while (!stream.atEnd()) {\n              const QString &line = stream.readLine();\n              if (exp.indexIn(line) != -1) {\n                  const QStringList lst = exp.capturedTexts();\n                  const QString key = lst.at(1);\n                  QString value = lst.at(2);\n                  if (value.length() > 2\n                      && value.startsWith(QLatin1Char('\\\"'))\n                      && value.endsWith(QLatin1Char('\\\"')))\n                      value = value.mid(1, value.length() - 2);\n                  // Store the key and value: \"DESKTOP\", \"$HOME/Desktop\"\n                  lines[key] = value;\n              }\n          }\n  \n          QString key;\n          switch (type) {\n          case DesktopLocation:\n              key = QLatin1String(\"DESKTOP\");\n              break;\n          case DocumentsLocation:\n              key = QLatin1String(\"DOCUMENTS\");\n              break;\n          case PicturesLocation:\n              key = QLatin1String(\"PICTURES\");\n              break;\n          case MusicLocation:\n              key = QLatin1String(\"MUSIC\");\n              break;\n          case MoviesLocation:\n              key = QLatin1String(\"VIDEOS\");\n              break;\n          case DownloadLocation:\n              key = QLatin1String(\"DOWNLOAD\");\n              break;\n          default:\n              break;\n          }\n          if (!key.isEmpty()) {\n              QString value = lines.value(key);\n              if (!value.isEmpty()) {\n                  // value can start with $HOME\n                  if (value.startsWith(QLatin1String(\"$HOME\")))\n                      value = QDir::homePath() + value.mid(5);\n                  return value;\n              }\n          }\n      }\n  \n      QString path;\n      switch (type) {\n      case DesktopLocation:\n          path = QDir::homePath() + QLatin1String(\"/Desktop\");\n          break;\n      case DocumentsLocation:\n          path = QDir::homePath() + QLatin1String(\"/Documents\");\n         break;\n      case PicturesLocation:\n          path = QDir::homePath() + QLatin1String(\"/Pictures\");\n          break;\n  \n      case FontsLocation:\n          path = QDir::homePath() + QLatin1String(\"/.fonts\");\n          break;\n  \n      case MusicLocation:\n          path = QDir::homePath() + QLatin1String(\"/Music\");\n          break;\n  \n      case MoviesLocation:\n          path = QDir::homePath() + QLatin1String(\"/Videos\");\n          break;\n      case DownloadLocation:\n          path = QDir::homePath() + QLatin1String(\"/Downloads\");\n          break;\n      case ApplicationsLocation:\n          path = writableLocation(GenericDataLocation) + QLatin1String(\"/applications\");\n          break;\n  \n      default:\n          break;\n      }\n  \n      return path;\n  }\n}"
  },
  {
    "function_name": "appendOrganizationAndApp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
    "lines": "81-89",
    "snippet": "static void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <qvarlengtharray.h>",
      "#include <qcoreapplication.h>",
      "#include <qtextstream.h>",
      "#include <qhash.h>",
      "#include <qfile.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\"",
      "#include \"qplatformdefs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'/'"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appName.isEmpty",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationName",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'/'"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "org.isEmpty",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::organizationName",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nstatic void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}"
  },
  {
    "function_name": "_resolveUserName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_unix.cpp",
    "lines": "55-79",
    "snippet": "QT_BEGIN_NAMESPACE\n\n//static\nQString _resolveUserName(uint userId)\n{\n#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)\n    int size_max = sysconf(_SC_GETPW_R_SIZE_MAX);\n    if (size_max == -1)\n        size_max = 1024;\n    QVarLengthArray<char, 1024> buf(size_max);\n#endif\n\n    struct passwd *pw = 0;\n#if !defined(Q_OS_INTEGRITY)\n#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)\n    struct passwd entry;\n    getpwuid_r(userId, &entry, buf.data(), buf.size(), &pw);\n#else\n    pw = getpwuid(userId);\n#endif\n#endif\n    if (pw)\n        return QFile::decodeName(QByteArray(pw->pw_name));\n    return QString();\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <errno.h>",
      "#include <qvarlengtharray.h>",
      "#include <qcoreapplication.h>",
      "#include <qtextstream.h>",
      "#include <qhash.h>",
      "#include <qfile.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\"",
      "#include \"qplatformdefs.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QFile::decodeName",
          "args": [
            "QByteArray(pw->pw_name)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QByteArray",
          "args": [
            "pw->pw_name"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwuid",
          "args": [
            "userId"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwuid_r",
          "args": [
            "userId",
            "&entry",
            "buf.data()",
            "buf.size()",
            "&pw"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf.size",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf.data",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_GETPW_R_SIZE_MAX"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <errno.h>\n#include <qvarlengtharray.h>\n#include <qcoreapplication.h>\n#include <qtextstream.h>\n#include <qhash.h>\n#include <qfile.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n#include \"qplatformdefs.h\"\n\nQT_BEGIN_NAMESPACE\n\n//static\nQString _resolveUserName(uint userId)\n{\n#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)\n    int size_max = sysconf(_SC_GETPW_R_SIZE_MAX);\n    if (size_max == -1)\n        size_max = 1024;\n    QVarLengthArray<char, 1024> buf(size_max);\n#endif\n\n    struct passwd *pw = 0;\n#if !defined(Q_OS_INTEGRITY)\n#if !defined(QT_NO_THREAD) && defined(_POSIX_THREAD_SAFE_FUNCTIONS) && !defined(Q_OS_OPENBSD)\n    struct passwd entry;\n    getpwuid_r(userId, &entry, buf.data(), buf.size(), &pw);\n#else\n    pw = getpwuid(userId);\n#endif\n#endif\n    if (pw)\n        return QFile::decodeName(QByteArray(pw->pw_name));\n    return QString();\n}"
  }
]