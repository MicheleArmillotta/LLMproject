[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Ubuntu/main.cpp",
    "lines": "33-77",
    "snippet": "int main(int argc, char *argv[])\n{\n\n    QGuiApplication app(argc, argv);\n    QStringList args = app.arguments();\n    if (args.contains(\"-h\") || args.contains(\"--help\")) {\n        qDebug() << \"usage: \" + args.at(0) + \" [-p|--phone] [-t|--tablet] [-h|--help] [-I <path>]\";\n        qDebug() << \"    -p|--phone    If running on Desktop, start in a phone sized window.\";\n        qDebug() << \"    -t|--tablet   If running on Desktop, start in a tablet sized window.\";\n        qDebug() << \"    -h|--help     Print this help.\";\n        return 0;\n    }\n\n    QQuickView viewer;\n    viewer.setResizeMode(QQuickView::SizeRootObjectToView);\n\n    viewer.engine()->rootContext()->setContextProperty(\"tablet\", QVariant(false));\n    viewer.engine()->rootContext()->setContextProperty(\"phone\", QVariant(false));\n    if (args.contains(\"-t\") || args.contains(\"--tablet\")) {\n        qDebug() << \"running in tablet mode\";\n        viewer.engine()->rootContext()->setContextProperty(\"tablet\", QVariant(true));\n    } else if (args.contains(\"-p\") || args.contains(\"--phone\")){\n        qDebug() << \"running in phone mode\";\n        viewer.engine()->rootContext()->setContextProperty(\"phone\", QVariant(true));\n    } else if (qgetenv(\"QT_QPA_PLATFORM\") != \"ubuntumirclient\") {\n        // Default to tablet size on X11\n        viewer.engine()->rootContext()->setContextProperty(\"tablet\", QVariant(true));\n    }\n\n    Common::registerMetaTypes();\n    Common::Application::name = QString::fromLatin1(\"trojita\");\n    AppVersion::setGitVersion();\n    AppVersion::setCoreApplicationData();\n\n\n    QSettings s;\n    Imap::ImapAccess imapAccess(0, &s, QLatin1String(\"defaultAccount\"));\n    viewer.engine()->rootContext()->setContextProperty(QLatin1String(\"imapAccess\"), &imapAccess);\n\n    qDebug() << \"App Dir: \" << QCoreApplication::applicationDirPath();\n    viewer.setTitle(\"Trojita\");\n    viewer.setSource(QUrl::fromLocalFile(\"qml/trojita/main.qml\"));\n    viewer.show();\n    return app.exec();\n}",
    "includes": [
      "#include \"Imap/Model/ImapAccess.h\"",
      "#include \"Common/MetaTypes.h\"",
      "#include \"Common/Application.h\"",
      "#include \"AppVersion/SetCoreApplication.h\"",
      "#include <QSettings>",
      "#include <QDebug>",
      "#include <QQmlContext>",
      "#include <QtQml/QtQml>",
      "#include <QtQuick/QQuickView>",
      "#include <QtGui/QGuiApplication>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "app.exec",
          "args": [],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "exec",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "217-242",
          "snippet": "bool XSqlQuery::exec()\n{\n  bool returnValue = false;\n\n  if(_data && _data->_emulatePrepare)\n  {\n// In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n// caused several problems with all our code and the way it worked so this is a modified copy\n// of their code to use the implemented prepare if we have that option set so we can use the method\n// that works best in the case we are using it for.\n    if (lastError().isValid())\n      ((XSqlResultHelper*)result())->setLastError(QSqlError());\n\n    returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n  }\n  else\n    returnValue = QSqlQuery::exec();\n\n  if (_data)\n    _data->_currRecord = record();\n\n  if(false == returnValue)\n    notifyErrorListeners(this);\n\n  return returnValue;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::exec()\n  {\n    bool returnValue = false;\n  \n    if(_data && _data->_emulatePrepare)\n    {\n  // In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n  // caused several problems with all our code and the way it worked so this is a modified copy\n  // of their code to use the implemented prepare if we have that option set so we can use the method\n  // that works best in the case we are using it for.\n      if (lastError().isValid())\n        ((XSqlResultHelper*)result())->setLastError(QSqlError());\n  \n      returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n    }\n    else\n      returnValue = QSqlQuery::exec();\n  \n    if (_data)\n      _data->_currRecord = record();\n  \n    if(false == returnValue)\n      notifyErrorListeners(this);\n  \n    return returnValue;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "viewer.show",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.setSource",
          "args": [
            "QUrl::fromLocalFile(\"qml/trojita/main.qml\")"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUrl::fromLocalFile",
          "args": [
            "\"qml/trojita/main.qml\""
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.setTitle",
          "args": [
            "\"Trojita\""
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationDirPath",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [
            "QLatin1String(\"imapAccess\")",
            "&imapAccess"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"imapAccess\""
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"defaultAccount\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AppVersion::setCoreApplicationData",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AppVersion::setGitVersion",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromLatin1",
          "args": [
            "\"trojita\""
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Common::registerMetaTypes",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [
            "\"tablet\"",
            "QVariant(true)"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "true"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "ddresListToQVariant(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "40-47",
          "snippet": "VariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nVariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qgetenv",
          "args": [
            "\"QT_QPA_PLATFORM\""
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [
            "\"phone\"",
            "QVariant(true)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.contains",
          "args": [
            "\"--phone\""
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.contains",
          "args": [
            "\"-p\""
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [
            "\"tablet\"",
            "QVariant(true)"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.contains",
          "args": [
            "\"--tablet\""
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.contains",
          "args": [
            "\"-t\""
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [
            "\"phone\"",
            "QVariant(false)"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [
            "\"tablet\"",
            "QVariant(false)"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.engine",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "viewer.setResizeMode",
          "args": [
            "QQuickView::SizeRootObjectToView"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.at",
          "args": [
            "0"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.contains",
          "args": [
            "\"--help\""
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.contains",
          "args": [
            "\"-h\""
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "app.arguments",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Imap/Model/ImapAccess.h\"\n#include \"Common/MetaTypes.h\"\n#include \"Common/Application.h\"\n#include \"AppVersion/SetCoreApplication.h\"\n#include <QSettings>\n#include <QDebug>\n#include <QQmlContext>\n#include <QtQml/QtQml>\n#include <QtQuick/QQuickView>\n#include <QtGui/QGuiApplication>\n\nint main(int argc, char *argv[])\n{\n\n    QGuiApplication app(argc, argv);\n    QStringList args = app.arguments();\n    if (args.contains(\"-h\") || args.contains(\"--help\")) {\n        qDebug() << \"usage: \" + args.at(0) + \" [-p|--phone] [-t|--tablet] [-h|--help] [-I <path>]\";\n        qDebug() << \"    -p|--phone    If running on Desktop, start in a phone sized window.\";\n        qDebug() << \"    -t|--tablet   If running on Desktop, start in a tablet sized window.\";\n        qDebug() << \"    -h|--help     Print this help.\";\n        return 0;\n    }\n\n    QQuickView viewer;\n    viewer.setResizeMode(QQuickView::SizeRootObjectToView);\n\n    viewer.engine()->rootContext()->setContextProperty(\"tablet\", QVariant(false));\n    viewer.engine()->rootContext()->setContextProperty(\"phone\", QVariant(false));\n    if (args.contains(\"-t\") || args.contains(\"--tablet\")) {\n        qDebug() << \"running in tablet mode\";\n        viewer.engine()->rootContext()->setContextProperty(\"tablet\", QVariant(true));\n    } else if (args.contains(\"-p\") || args.contains(\"--phone\")){\n        qDebug() << \"running in phone mode\";\n        viewer.engine()->rootContext()->setContextProperty(\"phone\", QVariant(true));\n    } else if (qgetenv(\"QT_QPA_PLATFORM\") != \"ubuntumirclient\") {\n        // Default to tablet size on X11\n        viewer.engine()->rootContext()->setContextProperty(\"tablet\", QVariant(true));\n    }\n\n    Common::registerMetaTypes();\n    Common::Application::name = QString::fromLatin1(\"trojita\");\n    AppVersion::setGitVersion();\n    AppVersion::setCoreApplicationData();\n\n\n    QSettings s;\n    Imap::ImapAccess imapAccess(0, &s, QLatin1String(\"defaultAccount\"));\n    viewer.engine()->rootContext()->setContextProperty(QLatin1String(\"imapAccess\"), &imapAccess);\n\n    qDebug() << \"App Dir: \" << QCoreApplication::applicationDirPath();\n    viewer.setTitle(\"Trojita\");\n    viewer.setSource(QUrl::fromLocalFile(\"qml/trojita/main.qml\"));\n    viewer.show();\n    return app.exec();\n}"
  }
]