[
  {
    "function_name": "taskData(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "148-152",
    "snippet": "Variant UnSelectTask::taskData(const int role) const\n{\n    Q_UNUSED(role);\n    return QVariant();\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Variant(",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "ole)"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  Variant UnSelectTask::taskData(const int role) const\n  {\n      Q_UNUSED(role);\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "handleFetch(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "140-145",
    "snippet": "ool UnSelectTask::handleFetch(const Imap::Responses::Fetch *const resp)\n{\n    Q_UNUSED(resp);\n    log(\"UnSelectTask: ignoring FETCH response\", Common::LOG_MAILBOX_SYNC);\n    return true;\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "og(",
          "args": [
            "UnSelectTask: ignoring FETCH response\",",
            "ommon::LOG_MAILBOX_SYNC)"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "log(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "301-310",
          "snippet": "oid ImapTask::log(const QString &message, const Common::LogKind kind)\n{\n    Q_ASSERT(model);\n    QString dbg = debugIdentification();\n    if (!dbg.isEmpty()) {\n        dbg.prepend(QLatin1Char(' '));\n    }\n    model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n    model->m_taskModel->slotTaskMighHaveChanged(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::log(const QString &message, const Common::LogKind kind)\n  {\n      Q_ASSERT(model);\n      QString dbg = debugIdentification();\n      if (!dbg.isEmpty()) {\n          dbg.prepend(QLatin1Char(' '));\n      }\n      model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n      model->m_taskModel->slotTaskMighHaveChanged(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "esp)"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  ool UnSelectTask::handleFetch(const Imap::Responses::Fetch *const resp)\n  {\n      Q_UNUSED(resp);\n      log(\"UnSelectTask: ignoring FETCH response\", Common::LOG_MAILBOX_SYNC);\n      return true;\n  }\n}"
  },
  {
    "function_name": "handleSearch(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "133-138",
    "snippet": "ool UnSelectTask::handleSearch(const Imap::Responses::Search *const resp)\n{\n    Q_UNUSED(resp);\n    log(\"UnSelectTask: ignoring SEARCH response\", Common::LOG_MAILBOX_SYNC);\n    return true;\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "og(",
          "args": [
            "UnSelectTask: ignoring SEARCH response\",",
            "ommon::LOG_MAILBOX_SYNC)"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "log(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "301-310",
          "snippet": "oid ImapTask::log(const QString &message, const Common::LogKind kind)\n{\n    Q_ASSERT(model);\n    QString dbg = debugIdentification();\n    if (!dbg.isEmpty()) {\n        dbg.prepend(QLatin1Char(' '));\n    }\n    model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n    model->m_taskModel->slotTaskMighHaveChanged(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::log(const QString &message, const Common::LogKind kind)\n  {\n      Q_ASSERT(model);\n      QString dbg = debugIdentification();\n      if (!dbg.isEmpty()) {\n          dbg.prepend(QLatin1Char(' '));\n      }\n      model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n      model->m_taskModel->slotTaskMighHaveChanged(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "esp)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  ool UnSelectTask::handleSearch(const Imap::Responses::Search *const resp)\n  {\n      Q_UNUSED(resp);\n      log(\"UnSelectTask: ignoring SEARCH response\", Common::LOG_MAILBOX_SYNC);\n      return true;\n  }\n}"
  },
  {
    "function_name": "handleFlags(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "126-131",
    "snippet": "ool UnSelectTask::handleFlags(const Imap::Responses::Flags *const resp)\n{\n    Q_UNUSED(resp);\n    log(\"UnSelectTask: ignoring FLAGS response\", Common::LOG_MAILBOX_SYNC);\n    return true;\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "og(",
          "args": [
            "UnSelectTask: ignoring FLAGS response\",",
            "ommon::LOG_MAILBOX_SYNC)"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "log(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "301-310",
          "snippet": "oid ImapTask::log(const QString &message, const Common::LogKind kind)\n{\n    Q_ASSERT(model);\n    QString dbg = debugIdentification();\n    if (!dbg.isEmpty()) {\n        dbg.prepend(QLatin1Char(' '));\n    }\n    model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n    model->m_taskModel->slotTaskMighHaveChanged(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::log(const QString &message, const Common::LogKind kind)\n  {\n      Q_ASSERT(model);\n      QString dbg = debugIdentification();\n      if (!dbg.isEmpty()) {\n          dbg.prepend(QLatin1Char(' '));\n      }\n      model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n      model->m_taskModel->slotTaskMighHaveChanged(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "esp)"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  ool UnSelectTask::handleFlags(const Imap::Responses::Flags *const resp)\n  {\n      Q_UNUSED(resp);\n      log(\"UnSelectTask: ignoring FLAGS response\", Common::LOG_MAILBOX_SYNC);\n      return true;\n  }\n}"
  },
  {
    "function_name": "handleNumberResponse(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "119-124",
    "snippet": "ool UnSelectTask::handleNumberResponse(const Imap::Responses::NumberResponse *const resp)\n{\n    Q_UNUSED(resp);\n    log(\"UnSelectTask: ignoring numeric response\", Common::LOG_MAILBOX_SYNC);\n    return true;\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "og(",
          "args": [
            "UnSelectTask: ignoring numeric response\",",
            "ommon::LOG_MAILBOX_SYNC)"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "log(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "301-310",
          "snippet": "oid ImapTask::log(const QString &message, const Common::LogKind kind)\n{\n    Q_ASSERT(model);\n    QString dbg = debugIdentification();\n    if (!dbg.isEmpty()) {\n        dbg.prepend(QLatin1Char(' '));\n    }\n    model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n    model->m_taskModel->slotTaskMighHaveChanged(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::log(const QString &message, const Common::LogKind kind)\n  {\n      Q_ASSERT(model);\n      QString dbg = debugIdentification();\n      if (!dbg.isEmpty()) {\n          dbg.prepend(QLatin1Char(' '));\n      }\n      model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n      model->m_taskModel->slotTaskMighHaveChanged(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "esp)"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  ool UnSelectTask::handleNumberResponse(const Imap::Responses::NumberResponse *const resp)\n  {\n      Q_UNUSED(resp);\n      log(\"UnSelectTask: ignoring numeric response\", Common::LOG_MAILBOX_SYNC);\n      return true;\n  }\n}"
  },
  {
    "function_name": "handleStateHelper(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "78-117",
    "snippet": "ool UnSelectTask::handleStateHelper(const Imap::Responses::State *const resp)\n{\n    if (resp->tag.isEmpty()) {\n        switch (resp->respCode) {\n        case Responses::UNSEEN:\n        case Responses::PERMANENTFLAGS:\n        case Responses::UIDNEXT:\n        case Responses::UIDVALIDITY:\n        case Responses::NOMODSEQ:\n        case Responses::HIGHESTMODSEQ:\n        case Responses::CLOSED:\n            return true;\n        default:\n            break;\n        }\n    }\n    if (!resp->tag.isEmpty()) {\n        if (resp->tag == unSelectTag) {\n            if (resp->kind == Responses::OK) {\n                // nothing should be needed here\n                _completed();\n            } else {\n                // This is really bad.\n                throw MailboxException(\"Attempted to unselect current mailbox, but the server denied our request. \"\n                                       \"Can't continue, to avoid possible data corruption.\", *resp);\n            }\n            return true;\n        } else if (resp->tag == selectMissingTag) {\n            if (resp->kind == Responses::OK) {\n                QTimer::singleShot(0, this, SLOT(doFakeSelect()));\n                log(QLatin1String(\"The emergency EXAMINE command has unexpectedly succeeded, trying to get out of here...\"), Common::LOG_MAILBOX_SYNC);\n            } else {\n                // This is very good :)\n                _completed();\n            }\n            return true;\n        }\n    }\n    return false;\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "completed(",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "_completed(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "224-233",
          "snippet": "oid ImapTask::_completed()\n{\n    _finished = true;\n    log(\"Completed\");\n    Q_FOREACH(ImapTask* task, dependentTasks) {\n        if (!task->isFinished())\n            task->perform();\n    }\n    emit completed(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::_completed()\n  {\n      _finished = true;\n      log(\"Completed\");\n      Q_FOREACH(ImapTask* task, dependentTasks) {\n          if (!task->isFinished())\n              task->perform();\n      }\n      emit completed(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "og(",
          "args": [
            "Latin1String(\"The emergency EXAMINE command has unexpectedly succeeded, trying to get out of here...\"),",
            "ommon::LOG_MAILBOX_SYNC)"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "log(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "301-310",
          "snippet": "oid ImapTask::log(const QString &message, const Common::LogKind kind)\n{\n    Q_ASSERT(model);\n    QString dbg = debugIdentification();\n    if (!dbg.isEmpty()) {\n        dbg.prepend(QLatin1Char(' '));\n    }\n    model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n    model->m_taskModel->slotTaskMighHaveChanged(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::log(const QString &message, const Common::LogKind kind)\n  {\n      Q_ASSERT(model);\n      QString dbg = debugIdentification();\n      if (!dbg.isEmpty()) {\n          dbg.prepend(QLatin1Char(' '));\n      }\n      model->logTrace(parser ? parser->parserId() : 0, kind, metaObject()->className() + dbg, message);\n      model->m_taskModel->slotTaskMighHaveChanged(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "The emergency EXAMINE command has unexpectedly succeeded, trying to get out of here...\")"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Timer::singleShot(",
          "args": [
            ",",
            "his,",
            "LOT(doFakeSelect()))"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "oFakeSelect())"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oFakeSelect(",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "doFakeSelect(",
          "container": "nSelectTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
          "lines": "63-76",
          "snippet": "oid UnSelectTask::doFakeSelect()\n{\n    if (_dead) {\n        _failed(\"Asked to die\");\n        return;\n    }\n    // Again, ignoring abort()\n\n    if (model->accessParser(parser).maintainingTask) {\n        model->accessParser(parser).maintainingTask->breakOrCancelPossibleIdle();\n    }\n    // The server does not support UNSELECT. Let's construct an unlikely-to-exist mailbox, then.\n    selectMissingTag = parser->examine(QString(\"trojita non existing %1\").arg(QUuid::createUuid().toString()));\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include <QUuid>\n#",
            "include \"UnSelectTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  oid UnSelectTask::doFakeSelect()\n  {\n      if (_dead) {\n          _failed(\"Asked to die\");\n          return;\n      }\n      // Again, ignoring abort()\n  \n      if (model->accessParser(parser).maintainingTask) {\n          model->accessParser(parser).maintainingTask->breakOrCancelPossibleIdle();\n      }\n      // The server does not support UNSELECT. Let's construct an unlikely-to-exist mailbox, then.\n      selectMissingTag = parser->examine(QString(\"trojita non existing %1\").arg(QUuid::createUuid().toString()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ailboxException(",
          "args": [
            "Attempted to unselect current mailbox, but the server denied our request. \"\n                                       \"Can't continue, to avoid possible data corruption.\",",
            "resp)"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "MailboxException(",
          "container": "ailboxException",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Exceptions.cpp",
          "lines": "45-54",
          "snippet": "ailboxException::MailboxException(const char *const msg,\n                                   const Imap::Responses::AbstractResponse &response)\n{\n    QByteArray buf;\n    QTextStream s(&buf);\n    s << msg << \"\\r\\n\" << response;\n    s.flush();\n    m_msg = buf.constData();\n    m_exceptionClass = \"MailboxException\";\n}",
          "includes": [
            "include \"Parser/Response.h\"",
            "include <QTextStream>\n#",
            "include \"Exceptions.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Parser/Response.h\"\ninclude <QTextStream>\n#\ninclude \"Exceptions.h\"\n\nailboxException {\n  ailboxException::MailboxException(const char *const msg,\n                                     const Imap::Responses::AbstractResponse &response)\n  {\n      QByteArray buf;\n      QTextStream s(&buf);\n      s << msg << \"\\r\\n\" << response;\n      s.flush();\n      m_msg = buf.constData();\n      m_exceptionClass = \"MailboxException\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "esp->tag.isEmpty",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esp->tag.isEmpty",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  ool UnSelectTask::handleStateHelper(const Imap::Responses::State *const resp)\n  {\n      if (resp->tag.isEmpty()) {\n          switch (resp->respCode) {\n          case Responses::UNSEEN:\n          case Responses::PERMANENTFLAGS:\n          case Responses::UIDNEXT:\n          case Responses::UIDVALIDITY:\n          case Responses::NOMODSEQ:\n          case Responses::HIGHESTMODSEQ:\n          case Responses::CLOSED:\n              return true;\n          default:\n              break;\n          }\n      }\n      if (!resp->tag.isEmpty()) {\n          if (resp->tag == unSelectTag) {\n              if (resp->kind == Responses::OK) {\n                  // nothing should be needed here\n                  _completed();\n              } else {\n                  // This is really bad.\n                  throw MailboxException(\"Attempted to unselect current mailbox, but the server denied our request. \"\n                                         \"Can't continue, to avoid possible data corruption.\", *resp);\n              }\n              return true;\n          } else if (resp->tag == selectMissingTag) {\n              if (resp->kind == Responses::OK) {\n                  QTimer::singleShot(0, this, SLOT(doFakeSelect()));\n                  log(QLatin1String(\"The emergency EXAMINE command has unexpectedly succeeded, trying to get out of here...\"), Common::LOG_MAILBOX_SYNC);\n              } else {\n                  // This is very good :)\n                  _completed();\n              }\n              return true;\n          }\n      }\n      return false;\n  }\n}"
  },
  {
    "function_name": "doFakeSelect(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "63-76",
    "snippet": "oid UnSelectTask::doFakeSelect()\n{\n    if (_dead) {\n        _failed(\"Asked to die\");\n        return;\n    }\n    // Again, ignoring abort()\n\n    if (model->accessParser(parser).maintainingTask) {\n        model->accessParser(parser).maintainingTask->breakOrCancelPossibleIdle();\n    }\n    // The server does not support UNSELECT. Let's construct an unlikely-to-exist mailbox, then.\n    selectMissingTag = parser->examine(QString(\"trojita non existing %1\").arg(QUuid::createUuid().toString()));\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arser->examine",
          "args": [
            "String(\"trojita non existing %1\").arg(QUuid::createUuid().toString()))"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String",
          "args": [
            "Uuid::createUuid().toString())"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessageFileNameRequested(QString",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1702-1706",
          "snippet": "Window::slotDownloadMessageFileNameRequested(QString *fileName)\n{\n    *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Message\"), *fileName, QString(), 0,\n                                             QFileDialog::HideNameFilterDetails);\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotDownloadMessageFileNameRequested(QString *fileName)\n  {\n      *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Message\"), *fileName, QString(), 0,\n                                               QFileDialog::HideNameFilterDetails);\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "Uuid::createUuid",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Uuid::createUuid(",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "trojita non existing %1\")"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "ecodeRFC2047String(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Encoders.cpp",
          "lines": "372-375",
          "snippet": "String decodeRFC2047String( const QByteArray& raw )\n{\n    return ::decodeWordSequence( raw );\n}",
          "includes": [
            "include \"Parser/3rdparty/kcodecs.h\"",
            "include \"Parser/3rdparty/rfccodecs.h\"\n#",
            "include \"Encoders.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Parser/3rdparty/kcodecs.h\"\ninclude \"Parser/3rdparty/rfccodecs.h\"\n#\ninclude \"Encoders.h\"\n#\n\nString decodeRFC2047String( const QByteArray& raw )\n{\n    return ::decodeWordSequence( raw );\n}"
        }
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [
            "arser)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [
            "arser)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "failed(",
          "args": [
            "Asked to die\")"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "_failed(",
          "container": "hreadTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ThreadTask.cpp",
          "lines": "112-117",
          "snippet": "oid ThreadTask::_failed(const QString &errorMessage)\n{\n    // FIXME: show this in the GUI\n    emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n    ImapTask::_failed(errorMessage);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"ThreadTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"ThreadTask.h\"\n#\n\nhreadTask {\n  oid ThreadTask::_failed(const QString &errorMessage)\n  {\n      // FIXME: show this in the GUI\n      emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n      ImapTask::_failed(errorMessage);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  oid UnSelectTask::doFakeSelect()\n  {\n      if (_dead) {\n          _failed(\"Asked to die\");\n          return;\n      }\n      // Again, ignoring abort()\n  \n      if (model->accessParser(parser).maintainingTask) {\n          model->accessParser(parser).maintainingTask->breakOrCancelPossibleIdle();\n      }\n      // The server does not support UNSELECT. Let's construct an unlikely-to-exist mailbox, then.\n      selectMissingTag = parser->examine(QString(\"trojita non existing %1\").arg(QUuid::createUuid().toString()));\n  }\n}"
  },
  {
    "function_name": "perform(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "43-61",
    "snippet": "oid UnSelectTask::perform()\n{\n    markAsActiveTask(TASK_PREPEND);\n\n    if (_dead) {\n        _failed(\"Asked to die\");\n        return;\n    }\n    // We really should ignore abort() -- we're a very important task\n\n    if (model->accessParser(parser).maintainingTask) {\n        model->accessParser(parser).maintainingTask->breakOrCancelPossibleIdle();\n    }\n    if (model->accessParser(parser).capabilities.contains(\"UNSELECT\")) {\n        unSelectTag = parser->unSelect();\n    } else {\n        doFakeSelect();\n    }\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "oFakeSelect(",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "doFakeSelect(",
          "container": "nSelectTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
          "lines": "63-76",
          "snippet": "oid UnSelectTask::doFakeSelect()\n{\n    if (_dead) {\n        _failed(\"Asked to die\");\n        return;\n    }\n    // Again, ignoring abort()\n\n    if (model->accessParser(parser).maintainingTask) {\n        model->accessParser(parser).maintainingTask->breakOrCancelPossibleIdle();\n    }\n    // The server does not support UNSELECT. Let's construct an unlikely-to-exist mailbox, then.\n    selectMissingTag = parser->examine(QString(\"trojita non existing %1\").arg(QUuid::createUuid().toString()));\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include <QUuid>\n#",
            "include \"UnSelectTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  oid UnSelectTask::doFakeSelect()\n  {\n      if (_dead) {\n          _failed(\"Asked to die\");\n          return;\n      }\n      // Again, ignoring abort()\n  \n      if (model->accessParser(parser).maintainingTask) {\n          model->accessParser(parser).maintainingTask->breakOrCancelPossibleIdle();\n      }\n      // The server does not support UNSELECT. Let's construct an unlikely-to-exist mailbox, then.\n      selectMissingTag = parser->examine(QString(\"trojita non existing %1\").arg(QUuid::createUuid().toString()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arser->unSelect",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "unSelect(",
          "container": "arser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Parser.cpp",
          "lines": "500-503",
          "snippet": "ommandHandle Parser::unSelect()\n{\n    return queueCommand(Commands::ATOM, \"UNSELECT\");\n}",
          "includes": [
            "include \"../Model/Utils.h\"",
            "include \"../../Streams/IODeviceSocket.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Parser.h\"\n#",
            "include <QTimer>\n#",
            "include <QTime>\n#",
            "include <QSslError>\n#",
            "include <QProcess>\n#",
            "include <QMutexLocker>\n#",
            "include <QStringList>\n#",
            "include <QDebug>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Model/Utils.h\"\ninclude \"../../Streams/IODeviceSocket.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Parser.h\"\n#\ninclude <QTimer>\n#\ninclude <QTime>\n#\ninclude <QSslError>\n#\ninclude <QProcess>\n#\ninclude <QMutexLocker>\n#\ninclude <QStringList>\n#\ninclude <QDebug>\n#\ninclude <algorithm>\n#\n\narser {\n  ommandHandle Parser::unSelect()\n  {\n      return queueCommand(Commands::ATOM, \"UNSELECT\");\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [
            "UNSELECT\")"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [
            "arser)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [
            "arser)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [
            "arser)"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "failed(",
          "args": [
            "Asked to die\")"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "_failed(",
          "container": "hreadTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ThreadTask.cpp",
          "lines": "112-117",
          "snippet": "oid ThreadTask::_failed(const QString &errorMessage)\n{\n    // FIXME: show this in the GUI\n    emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n    ImapTask::_failed(errorMessage);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"ThreadTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"ThreadTask.h\"\n#\n\nhreadTask {\n  oid ThreadTask::_failed(const QString &errorMessage)\n  {\n      // FIXME: show this in the GUI\n      emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n      ImapTask::_failed(errorMessage);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arkAsActiveTask(",
          "args": [
            "ASK_PREPEND)"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "markAsActiveTask(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "76-102",
          "snippet": "oid ImapTask::markAsActiveTask(const TaskActivatingPosition place)\n{\n    CHECK_TASK_TREE\n    Q_ASSERT(parser);\n    switch (place) {\n    case TASK_APPEND:\n        model->accessParser(parser).activeTasks.append(this);\n        break;\n    case TASK_PREPEND:\n        model->accessParser(parser).activeTasks.prepend(this);\n        break;\n    }\n    if (parentTask) {\n        parentTask->dependentTasks.removeAll(this);\n    }\n    // As we're an active task, we no longer have a parent task\n    parentTask = 0;\n    model->m_taskModel->slotTaskGotReparented(this);\n\n    if (model->accessParser(parser).maintainingTask && model->accessParser(parser).maintainingTask != this) {\n        // Got to inform the currently responsible maintaining task about our demise\n        connect(this, SIGNAL(destroyed(QObject*)), model->accessParser(parser).maintainingTask, SLOT(slotTaskDeleted(QObject*)));\n    }\n\n    log(QLatin1String(\"Activated\"));\n    CHECK_TASK_TREE\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::markAsActiveTask(const TaskActivatingPosition place)\n  {\n      CHECK_TASK_TREE\n      Q_ASSERT(parser);\n      switch (place) {\n      case TASK_APPEND:\n          model->accessParser(parser).activeTasks.append(this);\n          break;\n      case TASK_PREPEND:\n          model->accessParser(parser).activeTasks.prepend(this);\n          break;\n      }\n      if (parentTask) {\n          parentTask->dependentTasks.removeAll(this);\n      }\n      // As we're an active task, we no longer have a parent task\n      parentTask = 0;\n      model->m_taskModel->slotTaskGotReparented(this);\n  \n      if (model->accessParser(parser).maintainingTask && model->accessParser(parser).maintainingTask != this) {\n          // Got to inform the currently responsible maintaining task about our demise\n          connect(this, SIGNAL(destroyed(QObject*)), model->accessParser(parser).maintainingTask, SLOT(slotTaskDeleted(QObject*)));\n      }\n  \n      log(QLatin1String(\"Activated\"));\n      CHECK_TASK_TREE\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  oid UnSelectTask::perform()\n  {\n      markAsActiveTask(TASK_PREPEND);\n  \n      if (_dead) {\n          _failed(\"Asked to die\");\n          return;\n      }\n      // We really should ignore abort() -- we're a very important task\n  \n      if (model->accessParser(parser).maintainingTask) {\n          model->accessParser(parser).maintainingTask->breakOrCancelPossibleIdle();\n      }\n      if (model->accessParser(parser).capabilities.contains(\"UNSELECT\")) {\n          unSelectTag = parser->unSelect();\n      } else {\n          doFakeSelect();\n      }\n  }\n}"
  },
  {
    "function_name": "UnSelectTask(",
    "container": "nSelectTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/UnSelectTask.cpp",
    "lines": "35-41",
    "snippet": "nSelectTask::UnSelectTask(Model *model, ImapTask *parentTask) :\n    ImapTask(model)\n{\n    conn = parentTask;\n    parser = conn->parser;\n    Q_ASSERT(parser);\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include <QUuid>\n#",
      "include \"UnSelectTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "arser)"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude <QUuid>\n#\ninclude \"UnSelectTask.h\"\n#\n\nnSelectTask {\n  nSelectTask::UnSelectTask(Model *model, ImapTask *parentTask) :\n      ImapTask(model)\n  {\n      conn = parentTask;\n      parser = conn->parser;\n      Q_ASSERT(parser);\n  }\n}"
  }
]