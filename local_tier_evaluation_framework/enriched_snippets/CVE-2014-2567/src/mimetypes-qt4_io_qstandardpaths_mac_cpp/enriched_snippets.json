[
  {
    "function_name": "standardLocations",
    "container": "QStandardPaths",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
    "lines": "169-182",
    "snippet": "QStringList QStandardPaths::standardLocations(StandardLocation type)\n{\n    QStringList dirs;\n\n    if (type == GenericDataLocation || type == DataLocation || type == GenericCacheLocation || type == CacheLocation) {\n        const QString path = macLocation(type, kOnAppropriateDisk);\n        if (!path.isEmpty())\n            dirs.append(path);\n    }\n\n    const QString localDir = writableLocation(type);\n    dirs.prepend(localDir);\n    return dirs;\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <qcoreapplication.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dirs.prepend",
          "args": [
            "localDir"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writableLocation",
          "args": [
            "type"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "writableLocation",
          "container": "QStandardPaths",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
          "lines": "128-167",
          "snippet": "QString QStandardPaths::writableLocation(StandardLocation type)\n{\n    if (isTestModeEnabled()) {\n        const QString qttestDir = QDir::homePath() + QLatin1String(\"/.qttest\");\n        QString path;\n        switch (type) {\n        case GenericDataLocation:\n        case DataLocation:\n            path = qttestDir + QLatin1String(\"/Application Support\");\n            if (type == DataLocation)\n                appendOrganizationAndApp(path);\n            return path;\n        case GenericCacheLocation:\n        case CacheLocation:\n            path = qttestDir + QLatin1String(\"/Cache\");\n            if (type == CacheLocation)\n                appendOrganizationAndApp(path);\n            return path;\n        case ConfigLocation:\n            return qttestDir + QLatin1String(\"/Preferences\");\n        default:\n            break;\n        }\n    }\n\n    switch (type) {\n    case HomeLocation:\n        return QDir::homePath();\n    case TempLocation:\n        return QDir::tempPath();\n    case GenericDataLocation:\n    case DataLocation:\n    case GenericCacheLocation:\n    case CacheLocation:\n    case RuntimeLocation:\n        return macLocation(type, kUserDomain);\n    default:\n        return macLocation(type, kOnAppropriateDisk);\n    }\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <qcoreapplication.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nQStandardPaths {\n  QString QStandardPaths::writableLocation(StandardLocation type)\n  {\n      if (isTestModeEnabled()) {\n          const QString qttestDir = QDir::homePath() + QLatin1String(\"/.qttest\");\n          QString path;\n          switch (type) {\n          case GenericDataLocation:\n          case DataLocation:\n              path = qttestDir + QLatin1String(\"/Application Support\");\n              if (type == DataLocation)\n                  appendOrganizationAndApp(path);\n              return path;\n          case GenericCacheLocation:\n          case CacheLocation:\n              path = qttestDir + QLatin1String(\"/Cache\");\n              if (type == CacheLocation)\n                  appendOrganizationAndApp(path);\n              return path;\n          case ConfigLocation:\n              return qttestDir + QLatin1String(\"/Preferences\");\n          default:\n              break;\n          }\n      }\n  \n      switch (type) {\n      case HomeLocation:\n          return QDir::homePath();\n      case TempLocation:\n          return QDir::tempPath();\n      case GenericDataLocation:\n      case DataLocation:\n      case GenericCacheLocation:\n      case CacheLocation:\n      case RuntimeLocation:\n          return macLocation(type, kUserDomain);\n      default:\n          return macLocation(type, kOnAppropriateDisk);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dirs.append",
          "args": [
            "path"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.isEmpty",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "macLocation",
          "args": [
            "type",
            "kOnAppropriateDisk"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "macLocation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
          "lines": "113-126",
          "snippet": "static QString macLocation(QStandardPaths::StandardLocation type, short domain)\n{\n    // http://developer.apple.com/documentation/Carbon/Reference/Folder_Manager/Reference/reference.html\n    FSRef ref;\n    OSErr err = FSFindFolder(domain, translateLocation(type), false, &ref);\n    if (err)\n       return QString();\n\n   QString path = getFullPath(ref);\n\n    if (type == QStandardPaths::DataLocation || type == QStandardPaths::CacheLocation)\n        appendOrganizationAndApp(path);\n    return path;\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <qcoreapplication.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nstatic QString macLocation(QStandardPaths::StandardLocation type, short domain)\n{\n    // http://developer.apple.com/documentation/Carbon/Reference/Folder_Manager/Reference/reference.html\n    FSRef ref;\n    OSErr err = FSFindFolder(domain, translateLocation(type), false, &ref);\n    if (err)\n       return QString();\n\n   QString path = getFullPath(ref);\n\n    if (type == QStandardPaths::DataLocation || type == QStandardPaths::CacheLocation)\n        appendOrganizationAndApp(path);\n    return path;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nQStandardPaths {\n  QStringList QStandardPaths::standardLocations(StandardLocation type)\n  {\n      QStringList dirs;\n  \n      if (type == GenericDataLocation || type == DataLocation || type == GenericCacheLocation || type == CacheLocation) {\n          const QString path = macLocation(type, kOnAppropriateDisk);\n          if (!path.isEmpty())\n              dirs.append(path);\n      }\n  \n      const QString localDir = writableLocation(type);\n      dirs.prepend(localDir);\n      return dirs;\n  }\n}"
  },
  {
    "function_name": "writableLocation",
    "container": "QStandardPaths",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
    "lines": "128-167",
    "snippet": "QString QStandardPaths::writableLocation(StandardLocation type)\n{\n    if (isTestModeEnabled()) {\n        const QString qttestDir = QDir::homePath() + QLatin1String(\"/.qttest\");\n        QString path;\n        switch (type) {\n        case GenericDataLocation:\n        case DataLocation:\n            path = qttestDir + QLatin1String(\"/Application Support\");\n            if (type == DataLocation)\n                appendOrganizationAndApp(path);\n            return path;\n        case GenericCacheLocation:\n        case CacheLocation:\n            path = qttestDir + QLatin1String(\"/Cache\");\n            if (type == CacheLocation)\n                appendOrganizationAndApp(path);\n            return path;\n        case ConfigLocation:\n            return qttestDir + QLatin1String(\"/Preferences\");\n        default:\n            break;\n        }\n    }\n\n    switch (type) {\n    case HomeLocation:\n        return QDir::homePath();\n    case TempLocation:\n        return QDir::tempPath();\n    case GenericDataLocation:\n    case DataLocation:\n    case GenericCacheLocation:\n    case CacheLocation:\n    case RuntimeLocation:\n        return macLocation(type, kUserDomain);\n    default:\n        return macLocation(type, kOnAppropriateDisk);\n    }\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <qcoreapplication.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "macLocation",
          "args": [
            "type",
            "kOnAppropriateDisk"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "macLocation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
          "lines": "113-126",
          "snippet": "static QString macLocation(QStandardPaths::StandardLocation type, short domain)\n{\n    // http://developer.apple.com/documentation/Carbon/Reference/Folder_Manager/Reference/reference.html\n    FSRef ref;\n    OSErr err = FSFindFolder(domain, translateLocation(type), false, &ref);\n    if (err)\n       return QString();\n\n   QString path = getFullPath(ref);\n\n    if (type == QStandardPaths::DataLocation || type == QStandardPaths::CacheLocation)\n        appendOrganizationAndApp(path);\n    return path;\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <qcoreapplication.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nstatic QString macLocation(QStandardPaths::StandardLocation type, short domain)\n{\n    // http://developer.apple.com/documentation/Carbon/Reference/Folder_Manager/Reference/reference.html\n    FSRef ref;\n    OSErr err = FSFindFolder(domain, translateLocation(type), false, &ref);\n    if (err)\n       return QString();\n\n   QString path = getFullPath(ref);\n\n    if (type == QStandardPaths::DataLocation || type == QStandardPaths::CacheLocation)\n        appendOrganizationAndApp(path);\n    return path;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QDir::tempPath",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Preferences\""
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appendOrganizationAndApp",
          "args": [
            "path"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "appendOrganizationAndApp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
          "lines": "103-111",
          "snippet": "static void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <qcoreapplication.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nstatic void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Cache\""
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/Application Support\""
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/.qttest\""
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isTestModeEnabled",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "isTestModeEnabled",
          "container": "QStandardPaths",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths.cpp",
          "lines": "351-354",
          "snippet": "bool QStandardPaths::isTestModeEnabled()\n{\n    return qsp_testMode;\n}",
          "includes": [
            "#include <qcoreapplication.h>",
            "#include <qobject.h>",
            "#include <qhash.h>",
            "#include <qfileinfo.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qcoreapplication.h>\n#include <qobject.h>\n#include <qhash.h>\n#include <qfileinfo.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nQStandardPaths {\n  bool QStandardPaths::isTestModeEnabled()\n  {\n      return qsp_testMode;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nQStandardPaths {\n  QString QStandardPaths::writableLocation(StandardLocation type)\n  {\n      if (isTestModeEnabled()) {\n          const QString qttestDir = QDir::homePath() + QLatin1String(\"/.qttest\");\n          QString path;\n          switch (type) {\n          case GenericDataLocation:\n          case DataLocation:\n              path = qttestDir + QLatin1String(\"/Application Support\");\n              if (type == DataLocation)\n                  appendOrganizationAndApp(path);\n              return path;\n          case GenericCacheLocation:\n          case CacheLocation:\n              path = qttestDir + QLatin1String(\"/Cache\");\n              if (type == CacheLocation)\n                  appendOrganizationAndApp(path);\n              return path;\n          case ConfigLocation:\n              return qttestDir + QLatin1String(\"/Preferences\");\n          default:\n              break;\n          }\n      }\n  \n      switch (type) {\n      case HomeLocation:\n          return QDir::homePath();\n      case TempLocation:\n          return QDir::tempPath();\n      case GenericDataLocation:\n      case DataLocation:\n      case GenericCacheLocation:\n      case CacheLocation:\n      case RuntimeLocation:\n          return macLocation(type, kUserDomain);\n      default:\n          return macLocation(type, kOnAppropriateDisk);\n      }\n  }\n}"
  },
  {
    "function_name": "macLocation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
    "lines": "113-126",
    "snippet": "static QString macLocation(QStandardPaths::StandardLocation type, short domain)\n{\n    // http://developer.apple.com/documentation/Carbon/Reference/Folder_Manager/Reference/reference.html\n    FSRef ref;\n    OSErr err = FSFindFolder(domain, translateLocation(type), false, &ref);\n    if (err)\n       return QString();\n\n   QString path = getFullPath(ref);\n\n    if (type == QStandardPaths::DataLocation || type == QStandardPaths::CacheLocation)\n        appendOrganizationAndApp(path);\n    return path;\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <qcoreapplication.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "appendOrganizationAndApp",
          "args": [
            "path"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "appendOrganizationAndApp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
          "lines": "103-111",
          "snippet": "static void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <qcoreapplication.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nstatic void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}"
        }
      },
      {
        "call_info": {
          "callee": "getFullPath",
          "args": [
            "ref"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "getFullPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
          "lines": "95-101",
          "snippet": "static QString getFullPath(const FSRef &ref)\n{\n    QByteArray ba(2048, 0);\n    if (FSRefMakePath(&ref, reinterpret_cast<UInt8 *>(ba.data()), ba.size()) == noErr)\n        return QString::fromUtf8(ba.constData()).normalized(QString::NormalizationForm_C);\n    return QString();\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <qcoreapplication.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nstatic QString getFullPath(const FSRef &ref)\n{\n    QByteArray ba(2048, 0);\n    if (FSRefMakePath(&ref, reinterpret_cast<UInt8 *>(ba.data()), ba.size()) == noErr)\n        return QString::fromUtf8(ba.constData()).normalized(QString::NormalizationForm_C);\n    return QString();\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FSFindFolder",
          "args": [
            "domain",
            "translateLocation(type)",
            "false",
            "&ref"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "translateLocation",
          "args": [
            "type"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "translateLocation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
          "lines": "50-90",
          "snippet": "QT_BEGIN_NAMESPACE\n\n/*\n    Translates a QStandardPaths::StandardLocation into the mac equivalent.\n*/\nOSType translateLocation(QStandardPaths::StandardLocation type)\n{\n    switch (type) {\n    case QStandardPaths::ConfigLocation:\n        return kPreferencesFolderType;\n    case QStandardPaths::DesktopLocation:\n        return kDesktopFolderType;\n    case QStandardPaths::DownloadLocation: // needs NSSearchPathForDirectoriesInDomains with NSDownloadsDirectory\n                                           // which needs an objective-C *.mm file...\n    case QStandardPaths::DocumentsLocation:\n        return kDocumentsFolderType;\n    case QStandardPaths::FontsLocation:\n        // There are at least two different font directories on the mac: /Library/Fonts and ~/Library/Fonts.\n        // To select a specific one we have to specify a different first parameter when calling FSFindFolder.\n        return kFontsFolderType;\n    case QStandardPaths::ApplicationsLocation:\n        return kApplicationsFolderType;\n    case QStandardPaths::MusicLocation:\n        return kMusicDocumentsFolderType;\n    case QStandardPaths::MoviesLocation:\n        return kMovieDocumentsFolderType;\n    case QStandardPaths::PicturesLocation:\n        return kPictureDocumentsFolderType;\n    case QStandardPaths::TempLocation:\n        return kTemporaryFolderType;\n    case QStandardPaths::GenericDataLocation:\n    case QStandardPaths::RuntimeLocation:\n    case QStandardPaths::DataLocation:\n        return kApplicationSupportFolderType;\n    case QStandardPaths::GenericCacheLocation:\n    case QStandardPaths::CacheLocation:\n        return kCachedDataFolderType;\n    default:\n        return kDesktopFolderType;\n    }\n}",
          "includes": [
            "#include <ApplicationServices/ApplicationServices.h>",
            "#include <qcoreapplication.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nQT_BEGIN_NAMESPACE\n\n/*\n    Translates a QStandardPaths::StandardLocation into the mac equivalent.\n*/\nOSType translateLocation(QStandardPaths::StandardLocation type)\n{\n    switch (type) {\n    case QStandardPaths::ConfigLocation:\n        return kPreferencesFolderType;\n    case QStandardPaths::DesktopLocation:\n        return kDesktopFolderType;\n    case QStandardPaths::DownloadLocation: // needs NSSearchPathForDirectoriesInDomains with NSDownloadsDirectory\n                                           // which needs an objective-C *.mm file...\n    case QStandardPaths::DocumentsLocation:\n        return kDocumentsFolderType;\n    case QStandardPaths::FontsLocation:\n        // There are at least two different font directories on the mac: /Library/Fonts and ~/Library/Fonts.\n        // To select a specific one we have to specify a different first parameter when calling FSFindFolder.\n        return kFontsFolderType;\n    case QStandardPaths::ApplicationsLocation:\n        return kApplicationsFolderType;\n    case QStandardPaths::MusicLocation:\n        return kMusicDocumentsFolderType;\n    case QStandardPaths::MoviesLocation:\n        return kMovieDocumentsFolderType;\n    case QStandardPaths::PicturesLocation:\n        return kPictureDocumentsFolderType;\n    case QStandardPaths::TempLocation:\n        return kTemporaryFolderType;\n    case QStandardPaths::GenericDataLocation:\n    case QStandardPaths::RuntimeLocation:\n    case QStandardPaths::DataLocation:\n        return kApplicationSupportFolderType;\n    case QStandardPaths::GenericCacheLocation:\n    case QStandardPaths::CacheLocation:\n        return kCachedDataFolderType;\n    default:\n        return kDesktopFolderType;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nstatic QString macLocation(QStandardPaths::StandardLocation type, short domain)\n{\n    // http://developer.apple.com/documentation/Carbon/Reference/Folder_Manager/Reference/reference.html\n    FSRef ref;\n    OSErr err = FSFindFolder(domain, translateLocation(type), false, &ref);\n    if (err)\n       return QString();\n\n   QString path = getFullPath(ref);\n\n    if (type == QStandardPaths::DataLocation || type == QStandardPaths::CacheLocation)\n        appendOrganizationAndApp(path);\n    return path;\n}"
  },
  {
    "function_name": "appendOrganizationAndApp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
    "lines": "103-111",
    "snippet": "static void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <qcoreapplication.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'/'"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "appName.isEmpty",
          "args": [],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationName",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'/'"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "org.isEmpty",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::organizationName",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nstatic void appendOrganizationAndApp(QString &path)\n{\n    const QString org = QCoreApplication::organizationName();\n    if (!org.isEmpty())\n        path += QLatin1Char('/') + org;\n    const QString appName = QCoreApplication::applicationName();\n    if (!appName.isEmpty())\n        path += QLatin1Char('/') + appName;\n}"
  },
  {
    "function_name": "getFullPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
    "lines": "95-101",
    "snippet": "static QString getFullPath(const FSRef &ref)\n{\n    QByteArray ba(2048, 0);\n    if (FSRefMakePath(&ref, reinterpret_cast<UInt8 *>(ba.data()), ba.size()) == noErr)\n        return QString::fromUtf8(ba.constData()).normalized(QString::NormalizationForm_C);\n    return QString();\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <qcoreapplication.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromUtf8",
          "args": [
            "QString::NormalizationForm_C"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromUtf8",
          "args": [
            "ba.constData()"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ba.constData",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FSRefMakePath",
          "args": [
            "&ref",
            "reinterpret_cast<UInt8 *>(ba.data())",
            "ba.size()"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ba.size",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<UInt8 *>",
          "args": [
            "ba.data()"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ba.data",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nstatic QString getFullPath(const FSRef &ref)\n{\n    QByteArray ba(2048, 0);\n    if (FSRefMakePath(&ref, reinterpret_cast<UInt8 *>(ba.data()), ba.size()) == noErr)\n        return QString::fromUtf8(ba.constData()).normalized(QString::NormalizationForm_C);\n    return QString();\n}"
  },
  {
    "function_name": "translateLocation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_mac.cpp",
    "lines": "50-90",
    "snippet": "QT_BEGIN_NAMESPACE\n\n/*\n    Translates a QStandardPaths::StandardLocation into the mac equivalent.\n*/\nOSType translateLocation(QStandardPaths::StandardLocation type)\n{\n    switch (type) {\n    case QStandardPaths::ConfigLocation:\n        return kPreferencesFolderType;\n    case QStandardPaths::DesktopLocation:\n        return kDesktopFolderType;\n    case QStandardPaths::DownloadLocation: // needs NSSearchPathForDirectoriesInDomains with NSDownloadsDirectory\n                                           // which needs an objective-C *.mm file...\n    case QStandardPaths::DocumentsLocation:\n        return kDocumentsFolderType;\n    case QStandardPaths::FontsLocation:\n        // There are at least two different font directories on the mac: /Library/Fonts and ~/Library/Fonts.\n        // To select a specific one we have to specify a different first parameter when calling FSFindFolder.\n        return kFontsFolderType;\n    case QStandardPaths::ApplicationsLocation:\n        return kApplicationsFolderType;\n    case QStandardPaths::MusicLocation:\n        return kMusicDocumentsFolderType;\n    case QStandardPaths::MoviesLocation:\n        return kMovieDocumentsFolderType;\n    case QStandardPaths::PicturesLocation:\n        return kPictureDocumentsFolderType;\n    case QStandardPaths::TempLocation:\n        return kTemporaryFolderType;\n    case QStandardPaths::GenericDataLocation:\n    case QStandardPaths::RuntimeLocation:\n    case QStandardPaths::DataLocation:\n        return kApplicationSupportFolderType;\n    case QStandardPaths::GenericCacheLocation:\n    case QStandardPaths::CacheLocation:\n        return kCachedDataFolderType;\n    default:\n        return kDesktopFolderType;\n    }\n}",
    "includes": [
      "#include <ApplicationServices/ApplicationServices.h>",
      "#include <qcoreapplication.h>",
      "#include <qdir.h>",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <ApplicationServices/ApplicationServices.h>\n#include <qcoreapplication.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nQT_BEGIN_NAMESPACE\n\n/*\n    Translates a QStandardPaths::StandardLocation into the mac equivalent.\n*/\nOSType translateLocation(QStandardPaths::StandardLocation type)\n{\n    switch (type) {\n    case QStandardPaths::ConfigLocation:\n        return kPreferencesFolderType;\n    case QStandardPaths::DesktopLocation:\n        return kDesktopFolderType;\n    case QStandardPaths::DownloadLocation: // needs NSSearchPathForDirectoriesInDomains with NSDownloadsDirectory\n                                           // which needs an objective-C *.mm file...\n    case QStandardPaths::DocumentsLocation:\n        return kDocumentsFolderType;\n    case QStandardPaths::FontsLocation:\n        // There are at least two different font directories on the mac: /Library/Fonts and ~/Library/Fonts.\n        // To select a specific one we have to specify a different first parameter when calling FSFindFolder.\n        return kFontsFolderType;\n    case QStandardPaths::ApplicationsLocation:\n        return kApplicationsFolderType;\n    case QStandardPaths::MusicLocation:\n        return kMusicDocumentsFolderType;\n    case QStandardPaths::MoviesLocation:\n        return kMovieDocumentsFolderType;\n    case QStandardPaths::PicturesLocation:\n        return kPictureDocumentsFolderType;\n    case QStandardPaths::TempLocation:\n        return kTemporaryFolderType;\n    case QStandardPaths::GenericDataLocation:\n    case QStandardPaths::RuntimeLocation:\n    case QStandardPaths::DataLocation:\n        return kApplicationSupportFolderType;\n    case QStandardPaths::GenericCacheLocation:\n    case QStandardPaths::CacheLocation:\n        return kCachedDataFolderType;\n    default:\n        return kDesktopFolderType;\n    }\n}"
  }
]