[
  {
    "function_name": "keyPressEvent(",
    "container": "ompleteMessageWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/CompleteMessageWidget.cpp",
    "lines": "66-77",
    "snippet": "oid CompleteMessageWidget::keyPressEvent(QKeyEvent *ke)\n{\n    if (ke->key() == Qt::Key_Home) {\n        animator->setEndValue(area->verticalScrollBar()->minimum());\n        animator->start();\n    } else if (ke->key() == Qt::Key_End) {\n        animator->setEndValue(area->verticalScrollBar()->maximum());\n        animator->start();\n    } else { // noop, but hey.\n        QWidget::keyPressEvent(ke);\n    }\n}",
    "includes": [
      "include \"Gui/MessageView.h\"",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FindBar.h\"\n#",
      "include <QVBoxLayout>\n#",
      "include <QScrollBar>\n#",
      "include <QScrollArea>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QKeyEvent>\n#",
      "include \"CompleteMessageWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Widget::keyPressEvent(",
          "args": [
            "e)"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "keyPressEvent(",
          "container": "ompleteMessageWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/CompleteMessageWidget.cpp",
          "lines": "66-77",
          "snippet": "oid CompleteMessageWidget::keyPressEvent(QKeyEvent *ke)\n{\n    if (ke->key() == Qt::Key_Home) {\n        animator->setEndValue(area->verticalScrollBar()->minimum());\n        animator->start();\n    } else if (ke->key() == Qt::Key_End) {\n        animator->setEndValue(area->verticalScrollBar()->maximum());\n        animator->start();\n    } else { // noop, but hey.\n        QWidget::keyPressEvent(ke);\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "nimator->start",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimator->setEndValue",
          "args": [
            "rea->verticalScrollBar()->maximum())"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rea->verticalScrollBar",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rea->verticalScrollBar",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimator->start",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimator->setEndValue",
          "args": [
            "rea->verticalScrollBar()->minimum())"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rea->verticalScrollBar",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rea->verticalScrollBar",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Gui/MessageView.h\"\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FindBar.h\"\n#\ninclude <QVBoxLayout>\n#\ninclude <QScrollBar>\n#\ninclude <QScrollArea>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QKeyEvent>\n#\ninclude \"CompleteMessageWidget.h\"\n#\n\nompleteMessageWidget {\n  oid CompleteMessageWidget::keyPressEvent(QKeyEvent *ke)\n  {\n      if (ke->key() == Qt::Key_Home) {\n          animator->setEndValue(area->verticalScrollBar()->minimum());\n          animator->start();\n      } else if (ke->key() == Qt::Key_End) {\n          animator->setEndValue(area->verticalScrollBar()->maximum());\n          animator->start();\n      } else { // noop, but hey.\n          QWidget::keyPressEvent(ke);\n      }\n  }\n}"
  },
  {
    "function_name": "searchRequestedBy(",
    "container": "ompleteMessageWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/CompleteMessageWidget.cpp",
    "lines": "55-64",
    "snippet": "oid CompleteMessageWidget::searchRequestedBy(QWebView *webView)\n{\n    if (m_findBar->isVisible() || !webView) {\n        m_findBar->setAssociatedWebView(0);\n        m_findBar->hide();\n    } else {\n        m_findBar->setAssociatedWebView(webView);\n        m_findBar->show();\n    }\n}",
    "includes": [
      "include \"Gui/MessageView.h\"",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FindBar.h\"\n#",
      "include <QVBoxLayout>\n#",
      "include <QScrollBar>\n#",
      "include <QScrollArea>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QKeyEvent>\n#",
      "include \"CompleteMessageWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_findBar->show",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_findBar->setAssociatedWebView",
          "args": [
            "ebView)"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "setAssociatedWebView",
          "container": "FindBar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FindBar.cpp",
          "lines": "261-269",
          "snippet": "void FindBar::setAssociatedWebView(QWebView *webView)\n{\n    if (m_associatedWebView)\n        disconnect(m_associatedWebView, 0, this, 0);\n    m_associatedWebView = webView;\n\n    // Automatically hide this FindBar widget when the underlying webview goes away\n    connect(m_associatedWebView, SIGNAL(destroyed(QObject*)), this, SLOT(hide()));\n}",
          "includes": [
            "#include \"Gui/Util.h\"",
            "#include \"LineEdit.h\"",
            "#include <QWebView>",
            "#include <QWebFrame>",
            "#include <QToolButton>",
            "#include <QPushButton>",
            "#include <QLabel>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCheckBox>",
            "#include \"FindBar.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Gui/Util.h\"\n#include \"LineEdit.h\"\n#include <QWebView>\n#include <QWebFrame>\n#include <QToolButton>\n#include <QPushButton>\n#include <QLabel>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCheckBox>\n#include \"FindBar.h\"\n\nFindBar {\n  void FindBar::setAssociatedWebView(QWebView *webView)\n  {\n      if (m_associatedWebView)\n          disconnect(m_associatedWebView, 0, this, 0);\n      m_associatedWebView = webView;\n  \n      // Automatically hide this FindBar widget when the underlying webview goes away\n      connect(m_associatedWebView, SIGNAL(destroyed(QObject*)), this, SLOT(hide()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_findBar->hide",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_findBar->isVisible",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Gui/MessageView.h\"\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FindBar.h\"\n#\ninclude <QVBoxLayout>\n#\ninclude <QScrollBar>\n#\ninclude <QScrollArea>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QKeyEvent>\n#\ninclude \"CompleteMessageWidget.h\"\n#\n\nompleteMessageWidget {\n  oid CompleteMessageWidget::searchRequestedBy(QWebView *webView)\n  {\n      if (m_findBar->isVisible() || !webView) {\n          m_findBar->setAssociatedWebView(0);\n          m_findBar->hide();\n      } else {\n          m_findBar->setAssociatedWebView(webView);\n          m_findBar->show();\n      }\n  }\n}"
  },
  {
    "function_name": "CompleteMessageWidget(",
    "container": "ompleteMessageWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/CompleteMessageWidget.cpp",
    "lines": "35-53",
    "snippet": "ompleteMessageWidget::CompleteMessageWidget(QWidget *parent, QSettings *settings): QWidget(parent)\n{\n    setWindowIcon(loadIcon(QLatin1String(\"mail-mark-read\")));\n    messageView = new MessageView(this, settings);\n    area = new QScrollArea();\n    area->setWidget(messageView);\n    area->setWidgetResizable(true);\n    QVBoxLayout *layout = new QVBoxLayout(this);\n    layout->setContentsMargins(0, 0, 0, 0);\n    layout->addWidget(area);\n    animator = new QPropertyAnimation(area->verticalScrollBar(), \"value\", this);\n    animator->setDuration(250); // the default, maybe play with values\n    animator->setEasingCurve(QEasingCurve::InOutCubic); // InOutQuad?\n\n    m_findBar = new FindBar(this);\n    layout->addWidget(m_findBar);\n\n    connect(messageView, SIGNAL(searchRequestedBy(QWebView*)), this, SLOT(searchRequestedBy(QWebView*)));\n}",
    "includes": [
      "include \"Gui/MessageView.h\"",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FindBar.h\"\n#",
      "include <QVBoxLayout>\n#",
      "include <QScrollBar>\n#",
      "include <QScrollArea>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QKeyEvent>\n#",
      "include \"CompleteMessageWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "_findBar)"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimator->setEasingCurve",
          "args": [
            "EasingCurve::InOutCubic)"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimator->setDuration",
          "args": [
            "50)"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rea->verticalScrollBar",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "rea)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->setContentsMargins",
          "args": [
            ",",
            ",",
            ",",
            ")"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rea->setWidgetResizable",
          "args": [
            "rue)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rea->setWidget",
          "args": [
            "essageView)"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etWindowIcon(",
          "args": [
            "oadIcon(QLatin1String(\"mail-mark-read\")))"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadIcon(",
          "args": [
            "Latin1String(\"mail-mark-read\"))"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mail-mark-read\")"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Gui/MessageView.h\"\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FindBar.h\"\n#\ninclude <QVBoxLayout>\n#\ninclude <QScrollBar>\n#\ninclude <QScrollArea>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QKeyEvent>\n#\ninclude \"CompleteMessageWidget.h\"\n#\n\nompleteMessageWidget {\n  ompleteMessageWidget::CompleteMessageWidget(QWidget *parent, QSettings *settings): QWidget(parent)\n  {\n      setWindowIcon(loadIcon(QLatin1String(\"mail-mark-read\")));\n      messageView = new MessageView(this, settings);\n      area = new QScrollArea();\n      area->setWidget(messageView);\n      area->setWidgetResizable(true);\n      QVBoxLayout *layout = new QVBoxLayout(this);\n      layout->setContentsMargins(0, 0, 0, 0);\n      layout->addWidget(area);\n      animator = new QPropertyAnimation(area->verticalScrollBar(), \"value\", this);\n      animator->setDuration(250); // the default, maybe play with values\n      animator->setEasingCurve(QEasingCurve::InOutCubic); // InOutQuad?\n  \n      m_findBar = new FindBar(this);\n      layout->addWidget(m_findBar);\n  \n      connect(messageView, SIGNAL(searchRequestedBy(QWebView*)), this, SLOT(searchRequestedBy(QWebView*)));\n  }\n}"
  }
]