[
  {
    "function_name": "handleStateHelper(",
    "container": "ake_ListChildMailboxesTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/Fake_ListChildMailboxesTask.cpp",
    "lines": "69-74",
    "snippet": "ool Fake_ListChildMailboxesTask::handleStateHelper(const Imap::Responses::State *const resp)\n{\n    // This is a fake task inheriting from the \"real one\", so we have to reimplement functions which do real work with stubs\n    Q_UNUSED(resp);\n    return false;\n}",
    "includes": [
      "include \"GetAnyConnectionTask.h\"",
      "include \"Imap/Model/TaskFactory.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Fake_ListChildMailboxesTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "esp)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/TaskFactory.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Fake_ListChildMailboxesTask.h\"\n#\n\nake_ListChildMailboxesTask {\n  ool Fake_ListChildMailboxesTask::handleStateHelper(const Imap::Responses::State *const resp)\n  {\n      // This is a fake task inheriting from the \"real one\", so we have to reimplement functions which do real work with stubs\n      Q_UNUSED(resp);\n      return false;\n  }\n}"
  },
  {
    "function_name": "perform(",
    "container": "ake_ListChildMailboxesTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/Fake_ListChildMailboxesTask.cpp",
    "lines": "42-67",
    "snippet": "oid Fake_ListChildMailboxesTask::perform()\n{\n    parser = conn->parser;\n    markAsActiveTask();\n\n    IMAP_TASK_CHECK_ABORT_DIE;\n\n    TreeItemMailbox *mailbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(mailboxIndex.internalPointer()));\n    Q_ASSERT(mailbox);\n    parser = conn->parser;\n    QList<Responses::List> &listResponses = model->accessParser(parser).listResponses;\n    Q_ASSERT(listResponses.isEmpty());\n    TestingTaskFactory *factory = dynamic_cast<TestingTaskFactory *>(model->m_taskFactory.get());\n    Q_ASSERT(factory);\n    for (QMap<QString, QStringList>::const_iterator it = factory->fakeListChildMailboxesMap.constBegin();\n         it != factory->fakeListChildMailboxesMap.constEnd(); ++it) {\n        if (it.key() != mailbox->mailbox())\n            continue;\n        for (QStringList::const_iterator childIt = it->begin(); childIt != it->end(); ++childIt) {\n            QString childMailbox = mailbox->mailbox().isEmpty() ? *childIt : QString::fromUtf8(\"%1^%2\").arg(mailbox->mailbox(), *childIt);\n            listResponses.append(Responses::List(Responses::LIST, QStringList(), QLatin1String(\"^\"), childMailbox, QMap<QByteArray, QVariant>()));\n        }\n    }\n    model->finalizeList(parser, mailbox);\n    _completed();\n}",
    "includes": [
      "include \"GetAnyConnectionTask.h\"",
      "include \"Imap/Model/TaskFactory.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Fake_ListChildMailboxesTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "completed(",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "_completed(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "224-233",
          "snippet": "oid ImapTask::_completed()\n{\n    _finished = true;\n    log(\"Completed\");\n    Q_FOREACH(ImapTask* task, dependentTasks) {\n        if (!task->isFinished())\n            task->perform();\n    }\n    emit completed(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::_completed()\n  {\n      _finished = true;\n      log(\"Completed\");\n      Q_FOREACH(ImapTask* task, dependentTasks) {\n          if (!task->isFinished())\n              task->perform();\n      }\n      emit completed(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "odel->finalizeList",
          "args": [
            "arser,",
            "ailbox)"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "finalizeList(",
          "container": "odel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Model.cpp",
          "lines": "334-385",
          "snippet": "oid Model::finalizeList(Parser *parser, TreeItemMailbox *mailboxPtr)\n{\n    TreeItemChildrenList mailboxes;\n\n    QList<Responses::List> &listResponses = accessParser(parser).listResponses;\n    const QString prefix = mailboxPtr->mailbox() + mailboxPtr->separator();\n    for (QList<Responses::List>::iterator it = listResponses.begin(); it != listResponses.end(); /* nothing */) {\n        if (it->mailbox == mailboxPtr->mailbox() || it->mailbox == prefix) {\n            // rubbish, ignore\n            it = listResponses.erase(it);\n        } else if (it->mailbox.startsWith(prefix)) {\n            mailboxes << new TreeItemMailbox(mailboxPtr, *it);\n            it = listResponses.erase(it);\n        } else {\n            // it clearly is someone else's LIST response\n            ++it;\n        }\n    }\n    qSort(mailboxes.begin(), mailboxes.end(), MailboxNameComparator);\n\n    // Remove duplicates; would be great if this could be done in a STLish way,\n    // but unfortunately std::unique won't help here (the \"duped\" part of the\n    // sequence contains undefined items)\n    if (mailboxes.size() > 1) {\n        auto it = mailboxes.begin();\n        // We've got to ignore the first one, that's the message list\n        ++it;\n        while (it != mailboxes.end()) {\n            if (MailboxNamesEqual(it[-1], *it)) {\n                delete *it;\n                it = mailboxes.erase(it);\n            } else {\n                ++it;\n            }\n        }\n    }\n\n    QList<MailboxMetadata> metadataToCache;\n    TreeItemChildrenList mailboxesWithoutChildren;\n    for (auto it = mailboxes.constBegin(); it != mailboxes.constEnd(); ++it) {\n        TreeItemMailbox *mailbox = dynamic_cast<TreeItemMailbox *>(*it);\n        Q_ASSERT(mailbox);\n        metadataToCache.append(mailbox->mailboxMetadata());\n        if (mailbox->hasNoChildMailboxesAlreadyKnown()) {\n            mailboxesWithoutChildren << mailbox;\n        }\n    }\n    cache()->setChildMailboxes(mailboxPtr->mailbox(), metadataToCache);\n    for (auto it = mailboxesWithoutChildren.constBegin(); it != mailboxesWithoutChildren.constEnd(); ++it)\n        cache()->setChildMailboxes(static_cast<TreeItemMailbox *>(*it)->mailbox(), QList<MailboxMetadata>());\n    replaceChildMailboxes(mailboxPtr, mailboxes);\n}",
          "includes": [
            "include \"Streams/SocketFactory.h\"",
            "include \"Imap/Tasks/UpdateFlagsTask.h\"\n#",
            "include \"Imap/Tasks/OpenConnectionTask.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Tasks/GetAnyConnectionTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include \"TaskPresentationModel.h\"\n#",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"QAIM_reset.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"Model.h\"\n#",
            "include <QtAlgorithms>\n#",
            "include <QDebug>\n#",
            "include <QCoreApplication>\n#",
            "include <QAuthenticator>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Streams/SocketFactory.h\"\ninclude \"Imap/Tasks/UpdateFlagsTask.h\"\n#\ninclude \"Imap/Tasks/OpenConnectionTask.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Tasks/GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude \"TaskPresentationModel.h\"\n#\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"QAIM_reset.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"Model.h\"\n#\ninclude <QtAlgorithms>\n#\ninclude <QDebug>\n#\ninclude <QCoreApplication>\n#\ninclude <QAuthenticator>\n#\ninclude <QAbstractProxyModel>\n#\n\nodel {\n  oid Model::finalizeList(Parser *parser, TreeItemMailbox *mailboxPtr)\n  {\n      TreeItemChildrenList mailboxes;\n  \n      QList<Responses::List> &listResponses = accessParser(parser).listResponses;\n      const QString prefix = mailboxPtr->mailbox() + mailboxPtr->separator();\n      for (QList<Responses::List>::iterator it = listResponses.begin(); it != listResponses.end(); /* nothing */) {\n          if (it->mailbox == mailboxPtr->mailbox() || it->mailbox == prefix) {\n              // rubbish, ignore\n              it = listResponses.erase(it);\n          } else if (it->mailbox.startsWith(prefix)) {\n              mailboxes << new TreeItemMailbox(mailboxPtr, *it);\n              it = listResponses.erase(it);\n          } else {\n              // it clearly is someone else's LIST response\n              ++it;\n          }\n      }\n      qSort(mailboxes.begin(), mailboxes.end(), MailboxNameComparator);\n  \n      // Remove duplicates; would be great if this could be done in a STLish way,\n      // but unfortunately std::unique won't help here (the \"duped\" part of the\n      // sequence contains undefined items)\n      if (mailboxes.size() > 1) {\n          auto it = mailboxes.begin();\n          // We've got to ignore the first one, that's the message list\n          ++it;\n          while (it != mailboxes.end()) {\n              if (MailboxNamesEqual(it[-1], *it)) {\n                  delete *it;\n                  it = mailboxes.erase(it);\n              } else {\n                  ++it;\n              }\n          }\n      }\n  \n      QList<MailboxMetadata> metadataToCache;\n      TreeItemChildrenList mailboxesWithoutChildren;\n      for (auto it = mailboxes.constBegin(); it != mailboxes.constEnd(); ++it) {\n          TreeItemMailbox *mailbox = dynamic_cast<TreeItemMailbox *>(*it);\n          Q_ASSERT(mailbox);\n          metadataToCache.append(mailbox->mailboxMetadata());\n          if (mailbox->hasNoChildMailboxesAlreadyKnown()) {\n              mailboxesWithoutChildren << mailbox;\n          }\n      }\n      cache()->setChildMailboxes(mailboxPtr->mailbox(), metadataToCache);\n      for (auto it = mailboxesWithoutChildren.constBegin(); it != mailboxesWithoutChildren.constEnd(); ++it)\n          cache()->setChildMailboxes(static_cast<TreeItemMailbox *>(*it)->mailbox(), QList<MailboxMetadata>());\n      replaceChildMailboxes(mailboxPtr, mailboxes);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "istResponses.append",
          "args": [
            "esponses::List(Responses::LIST, QStringList(), QLatin1String(\"^\"), childMailbox, QMap<QByteArray, QVariant>()))"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esponses::List(",
          "args": [
            "esponses::LIST,",
            "StringList(),",
            "Latin1String(\"^\"),",
            "hildMailbox,",
            "Map<QByteArray, QVariant>())"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Map<QByteArray, QVariant>",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "Hash2Map(",
          "container": "Hash2Map ",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/kdeui-itemviews/kbihash_p.h",
          "lines": "528-532",
          "snippet": "Hash2Map()\n    : KBiAssociativeContainer<QHash<T, U>, QMap<U, T> > ()\n  {\n\n  }",
          "includes": [
            "include <QtCore/QDebug>",
            "include <QtCore/QMap>",
            "include <QtCore/QHash>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtCore/QDebug>\ninclude <QtCore/QMap>\ninclude <QtCore/QHash>\n#\n\nHash2Map  {\n  Hash2Map()\n      : KBiAssociativeContainer<QHash<T, U>, QMap<U, T> > ()\n    {\n  \n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "^\")"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringList(",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "ailbox->mailbox(),",
            "childIt)"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailbox->mailbox",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "%1^%2\")"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailbox->mailbox",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailbox->mailbox",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->end",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->begin",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailbox->mailbox",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t.key",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "actory->fakeListChildMailboxesMap.constEnd",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "actory->fakeListChildMailboxesMap.constBegin",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "actory)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TestingTaskFactory *>",
          "args": [
            "odel->m_taskFactory.get())"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->m_taskFactory.get",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "istResponses.isEmpty())"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "istResponses.isEmpty",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->accessParser",
          "args": [
            "arser)"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ailbox)"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(mailboxIndex.internalPointer()))"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "ailboxIndex.internalPointer())"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailboxIndex.internalPointer",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arkAsActiveTask(",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/TaskFactory.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Fake_ListChildMailboxesTask.h\"\n#\n\nake_ListChildMailboxesTask {\n  oid Fake_ListChildMailboxesTask::perform()\n  {\n      parser = conn->parser;\n      markAsActiveTask();\n  \n      IMAP_TASK_CHECK_ABORT_DIE;\n  \n      TreeItemMailbox *mailbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(mailboxIndex.internalPointer()));\n      Q_ASSERT(mailbox);\n      parser = conn->parser;\n      QList<Responses::List> &listResponses = model->accessParser(parser).listResponses;\n      Q_ASSERT(listResponses.isEmpty());\n      TestingTaskFactory *factory = dynamic_cast<TestingTaskFactory *>(model->m_taskFactory.get());\n      Q_ASSERT(factory);\n      for (QMap<QString, QStringList>::const_iterator it = factory->fakeListChildMailboxesMap.constBegin();\n           it != factory->fakeListChildMailboxesMap.constEnd(); ++it) {\n          if (it.key() != mailbox->mailbox())\n              continue;\n          for (QStringList::const_iterator childIt = it->begin(); childIt != it->end(); ++childIt) {\n              QString childMailbox = mailbox->mailbox().isEmpty() ? *childIt : QString::fromUtf8(\"%1^%2\").arg(mailbox->mailbox(), *childIt);\n              listResponses.append(Responses::List(Responses::LIST, QStringList(), QLatin1String(\"^\"), childMailbox, QMap<QByteArray, QVariant>()));\n          }\n      }\n      model->finalizeList(parser, mailbox);\n      _completed();\n  }\n}"
  },
  {
    "function_name": "Fake_ListChildMailboxesTask(",
    "container": "ake_ListChildMailboxesTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/Fake_ListChildMailboxesTask.cpp",
    "lines": "36-40",
    "snippet": "ake_ListChildMailboxesTask::Fake_ListChildMailboxesTask(Model *model, const QModelIndex &mailbox):\n    ListChildMailboxesTask(model, mailbox)\n{\n    Q_ASSERT(dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(mailbox.internalPointer())));\n}",
    "includes": [
      "include \"GetAnyConnectionTask.h\"",
      "include \"Imap/Model/TaskFactory.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Fake_ListChildMailboxesTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(mailbox.internalPointer())))"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(mailbox.internalPointer()))"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "ailbox.internalPointer())"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailbox.internalPointer",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/TaskFactory.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Fake_ListChildMailboxesTask.h\"\n#\n\nake_ListChildMailboxesTask {\n  ake_ListChildMailboxesTask::Fake_ListChildMailboxesTask(Model *model, const QModelIndex &mailbox):\n      ListChildMailboxesTask(model, mailbox)\n  {\n      Q_ASSERT(dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(mailbox.internalPointer())));\n  }\n}"
  }
]