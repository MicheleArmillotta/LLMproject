[
  {
    "function_name": "createTreeItems(",
    "container": "ultiMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "798-809",
    "snippet": "ailbox::TreeItemChildrenList MultiMessage::createTreeItems(Mailbox::TreeItem *parent) const\n{\n    Mailbox::TreeItemChildrenList list, list2;\n    Mailbox::TreeItemPart *part = new Mailbox::TreeItemPart(parent, QString(\"multipart/%1\").arg(mediaSubType));\n    for (QList<QSharedPointer<AbstractMessage> >::const_iterator it = bodies.begin(); it != bodies.end(); ++it) {\n        list2 << (*it)->createTreeItems(part);\n    }\n    part->setChildren(list2);   // always returns an empty list -> no need to qDeleteAll()\n    storeInterestingFields(part);\n    list << part;\n    return list;\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toreInterestingFields(",
          "args": [
            "art)"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "storeInterestingFields(",
          "container": "ultiMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "757-768",
          "snippet": "oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    AbstractMessage::storeInterestingFields(p);\n\n    // The multipart/related can specify the root part to show\n    if (mediaSubType == QLatin1String(\"related\")) {\n        bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n        if (it != bodyFldParam.end()) {\n            p->setMultipartRelatedStartPart(*it);\n        }\n    }\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nultiMessage {\n  oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      AbstractMessage::storeInterestingFields(p);\n  \n      // The multipart/related can specify the root part to show\n      if (mediaSubType == QLatin1String(\"related\")) {\n          bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n          if (it != bodyFldParam.end()) {\n              p->setMultipartRelatedStartPart(*it);\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "art->setChildren",
          "args": [
            "ist2)"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "setChildren(",
          "container": "reeItemPart",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1330-1336",
          "snippet": "reeItemChildrenList TreeItemPart::setChildren(const TreeItemChildrenList &items)\n{\n    FetchingState fetchStatus = accessFetchStatus();\n    auto res = TreeItem::setChildren(items);\n    setFetchStatus(fetchStatus);\n    return res;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemPart {\n  reeItemChildrenList TreeItemPart::setChildren(const TreeItemChildrenList &items)\n  {\n      FetchingState fetchStatus = accessFetchStatus();\n      auto res = TreeItem::setChildren(items);\n      setFetchStatus(fetchStatus);\n      return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "*it)->createTreeItems",
          "args": [
            "art)"
          ],
          "line": 803
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odies.end",
          "args": [],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odies.begin",
          "args": [],
          "line": 802
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String",
          "args": [
            "ediaSubType)"
          ],
          "line": 801
        },
        "resolved": true,
        "details": {
          "function_name": "indFromString(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Response.cpp",
          "lines": "191-244",
          "snippet": "ind kindFromString(QByteArray str) throw(UnrecognizedResponseKind)\n{\n    str = str.toUpper();\n\n    if (str == \"OK\")\n        return OK;\n    if (str == \"NO\")\n        return NO;\n    if (str == \"BAD\")\n        return BAD;\n    if (str == \"BYE\")\n        return BYE;\n    if (str == \"PREAUTH\")\n        return PREAUTH;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXPUNGE\")\n        return EXPUNGE;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXISTS\")\n        return EXISTS;\n    if (str == \"RECENT\")\n        return RECENT;\n    if (str == \"CAPABILITY\")\n        return CAPABILITY;\n    if (str == \"LIST\")\n        return LIST;\n    if (str == \"LSUB\")\n        return LSUB;\n    if (str == \"FLAGS\")\n        return FLAGS;\n    if (str == \"SEARCH\" || str == \"SEARCH\\r\\n\")\n        return SEARCH;\n    if (str == \"ESEARCH\")\n        return ESEARCH;\n    if (str == \"STATUS\")\n        return STATUS;\n    if (str == \"NAMESPACE\")\n        return NAMESPACE;\n    if (str == \"SORT\")\n        return SORT;\n    if (str == \"THREAD\")\n        return THREAD;\n    if (str == \"ID\")\n        return ID;\n    if (str == \"ENABLED\")\n        return ENABLED;\n    if (str == \"VANISHED\")\n        return VANISHED;\n    if (str == \"GENURLAUTH\")\n        return GENURLAUTH;\n    throw UnrecognizedResponseKind(str.constData());\n}",
          "includes": [
            "include \"../Tasks/ImapTask.h\"",
            "include \"../Model/Model.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Message.h\"\n#",
            "include \"Response.h\"\n#",
            "include <QSslError>\n#",
            "include <typeinfo>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Tasks/ImapTask.h\"\ninclude \"../Model/Model.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Message.h\"\n#\ninclude \"Response.h\"\n#\ninclude <QSslError>\n#\ninclude <typeinfo>\n#\n\nind kindFromString(QByteArray str) throw(UnrecognizedResponseKind)\n{\n    str = str.toUpper();\n\n    if (str == \"OK\")\n        return OK;\n    if (str == \"NO\")\n        return NO;\n    if (str == \"BAD\")\n        return BAD;\n    if (str == \"BYE\")\n        return BYE;\n    if (str == \"PREAUTH\")\n        return PREAUTH;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXPUNGE\")\n        return EXPUNGE;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXISTS\")\n        return EXISTS;\n    if (str == \"RECENT\")\n        return RECENT;\n    if (str == \"CAPABILITY\")\n        return CAPABILITY;\n    if (str == \"LIST\")\n        return LIST;\n    if (str == \"LSUB\")\n        return LSUB;\n    if (str == \"FLAGS\")\n        return FLAGS;\n    if (str == \"SEARCH\" || str == \"SEARCH\\r\\n\")\n        return SEARCH;\n    if (str == \"ESEARCH\")\n        return ESEARCH;\n    if (str == \"STATUS\")\n        return STATUS;\n    if (str == \"NAMESPACE\")\n        return NAMESPACE;\n    if (str == \"SORT\")\n        return SORT;\n    if (str == \"THREAD\")\n        return THREAD;\n    if (str == \"ID\")\n        return ID;\n    if (str == \"ENABLED\")\n        return ENABLED;\n    if (str == \"VANISHED\")\n        return VANISHED;\n    if (str == \"GENURLAUTH\")\n        return GENURLAUTH;\n    throw UnrecognizedResponseKind(str.constData());\n}"
        }
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nultiMessage {\n  ailbox::TreeItemChildrenList MultiMessage::createTreeItems(Mailbox::TreeItem *parent) const\n  {\n      Mailbox::TreeItemChildrenList list, list2;\n      Mailbox::TreeItemPart *part = new Mailbox::TreeItemPart(parent, QString(\"multipart/%1\").arg(mediaSubType));\n      for (QList<QSharedPointer<AbstractMessage> >::const_iterator it = bodies.begin(); it != bodies.end(); ++it) {\n          list2 << (*it)->createTreeItems(part);\n      }\n      part->setChildren(list2);   // always returns an empty list -> no need to qDeleteAll()\n      storeInterestingFields(part);\n      list << part;\n      return list;\n  }\n}"
  },
  {
    "function_name": "createTreeItems(",
    "container": "sgMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "788-796",
    "snippet": "ailbox::TreeItemChildrenList MsgMessage::createTreeItems(Mailbox::TreeItem *parent) const\n{\n    Mailbox::TreeItemChildrenList list;\n    Mailbox::TreeItemPart *part = new Mailbox::TreeItemPartMultipartMessage(parent, envelope);\n    part->setChildren(body->createTreeItems(part));     // always returns an empty list -> no need to qDeleteAll()\n    storeInterestingFields(part);\n    list << part;\n    return list;\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toreInterestingFields(",
          "args": [
            "art)"
          ],
          "line": 793
        },
        "resolved": true,
        "details": {
          "function_name": "storeInterestingFields(",
          "container": "ultiMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "757-768",
          "snippet": "oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    AbstractMessage::storeInterestingFields(p);\n\n    // The multipart/related can specify the root part to show\n    if (mediaSubType == QLatin1String(\"related\")) {\n        bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n        if (it != bodyFldParam.end()) {\n            p->setMultipartRelatedStartPart(*it);\n        }\n    }\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nultiMessage {\n  oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      AbstractMessage::storeInterestingFields(p);\n  \n      // The multipart/related can specify the root part to show\n      if (mediaSubType == QLatin1String(\"related\")) {\n          bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n          if (it != bodyFldParam.end()) {\n              p->setMultipartRelatedStartPart(*it);\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "art->setChildren",
          "args": [
            "ody->createTreeItems(part))"
          ],
          "line": 792
        },
        "resolved": true,
        "details": {
          "function_name": "setChildren(",
          "container": "reeItemPart",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1330-1336",
          "snippet": "reeItemChildrenList TreeItemPart::setChildren(const TreeItemChildrenList &items)\n{\n    FetchingState fetchStatus = accessFetchStatus();\n    auto res = TreeItem::setChildren(items);\n    setFetchStatus(fetchStatus);\n    return res;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemPart {\n  reeItemChildrenList TreeItemPart::setChildren(const TreeItemChildrenList &items)\n  {\n      FetchingState fetchStatus = accessFetchStatus();\n      auto res = TreeItem::setChildren(items);\n      setFetchStatus(fetchStatus);\n      return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ody->createTreeItems",
          "args": [
            "art)"
          ],
          "line": 792
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nsgMessage {\n  ailbox::TreeItemChildrenList MsgMessage::createTreeItems(Mailbox::TreeItem *parent) const\n  {\n      Mailbox::TreeItemChildrenList list;\n      Mailbox::TreeItemPart *part = new Mailbox::TreeItemPartMultipartMessage(parent, envelope);\n      part->setChildren(body->createTreeItems(part));     // always returns an empty list -> no need to qDeleteAll()\n      storeInterestingFields(part);\n      list << part;\n      return list;\n  }\n}"
  },
  {
    "function_name": "createTreeItems(",
    "container": "asicMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "779-786",
    "snippet": "ailbox::TreeItemChildrenList BasicMessage::createTreeItems(Mailbox::TreeItem *parent) const\n{\n    Mailbox::TreeItemChildrenList list;\n    Mailbox::TreeItemPart *p = new Mailbox::TreeItemPart(parent, QString(\"%1/%2\").arg(mediaType, mediaSubType));\n    storeInterestingFields(p);\n    list << p;\n    return list;\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toreInterestingFields(",
          "args": [
            ")"
          ],
          "line": 783
        },
        "resolved": true,
        "details": {
          "function_name": "storeInterestingFields(",
          "container": "ultiMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "757-768",
          "snippet": "oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    AbstractMessage::storeInterestingFields(p);\n\n    // The multipart/related can specify the root part to show\n    if (mediaSubType == QLatin1String(\"related\")) {\n        bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n        if (it != bodyFldParam.end()) {\n            p->setMultipartRelatedStartPart(*it);\n        }\n    }\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nultiMessage {\n  oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      AbstractMessage::storeInterestingFields(p);\n  \n      // The multipart/related can specify the root part to show\n      if (mediaSubType == QLatin1String(\"related\")) {\n          bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n          if (it != bodyFldParam.end()) {\n              p->setMultipartRelatedStartPart(*it);\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String",
          "args": [
            "ediaType,",
            "ediaSubType)"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "fromPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "41-52",
          "snippet": "ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n{\n    int offset = 0;\n\n    if (!parseOneAddress(into, address, offset))\n        return false;\n\n    if (offset < address.size())\n        return false;\n\n    return true;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n  {\n      int offset = 0;\n  \n      if (!parseOneAddress(into, address, offset))\n          return false;\n  \n      if (offset < address.size())\n          return false;\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "%1/%2\")"
          ],
          "line": 782
        },
        "resolved": true,
        "details": {
          "function_name": "indFromString(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Response.cpp",
          "lines": "191-244",
          "snippet": "ind kindFromString(QByteArray str) throw(UnrecognizedResponseKind)\n{\n    str = str.toUpper();\n\n    if (str == \"OK\")\n        return OK;\n    if (str == \"NO\")\n        return NO;\n    if (str == \"BAD\")\n        return BAD;\n    if (str == \"BYE\")\n        return BYE;\n    if (str == \"PREAUTH\")\n        return PREAUTH;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXPUNGE\")\n        return EXPUNGE;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXISTS\")\n        return EXISTS;\n    if (str == \"RECENT\")\n        return RECENT;\n    if (str == \"CAPABILITY\")\n        return CAPABILITY;\n    if (str == \"LIST\")\n        return LIST;\n    if (str == \"LSUB\")\n        return LSUB;\n    if (str == \"FLAGS\")\n        return FLAGS;\n    if (str == \"SEARCH\" || str == \"SEARCH\\r\\n\")\n        return SEARCH;\n    if (str == \"ESEARCH\")\n        return ESEARCH;\n    if (str == \"STATUS\")\n        return STATUS;\n    if (str == \"NAMESPACE\")\n        return NAMESPACE;\n    if (str == \"SORT\")\n        return SORT;\n    if (str == \"THREAD\")\n        return THREAD;\n    if (str == \"ID\")\n        return ID;\n    if (str == \"ENABLED\")\n        return ENABLED;\n    if (str == \"VANISHED\")\n        return VANISHED;\n    if (str == \"GENURLAUTH\")\n        return GENURLAUTH;\n    throw UnrecognizedResponseKind(str.constData());\n}",
          "includes": [
            "include \"../Tasks/ImapTask.h\"",
            "include \"../Model/Model.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Message.h\"\n#",
            "include \"Response.h\"\n#",
            "include <QSslError>\n#",
            "include <typeinfo>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Tasks/ImapTask.h\"\ninclude \"../Model/Model.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Message.h\"\n#\ninclude \"Response.h\"\n#\ninclude <QSslError>\n#\ninclude <typeinfo>\n#\n\nind kindFromString(QByteArray str) throw(UnrecognizedResponseKind)\n{\n    str = str.toUpper();\n\n    if (str == \"OK\")\n        return OK;\n    if (str == \"NO\")\n        return NO;\n    if (str == \"BAD\")\n        return BAD;\n    if (str == \"BYE\")\n        return BYE;\n    if (str == \"PREAUTH\")\n        return PREAUTH;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXPUNGE\")\n        return EXPUNGE;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXISTS\")\n        return EXISTS;\n    if (str == \"RECENT\")\n        return RECENT;\n    if (str == \"CAPABILITY\")\n        return CAPABILITY;\n    if (str == \"LIST\")\n        return LIST;\n    if (str == \"LSUB\")\n        return LSUB;\n    if (str == \"FLAGS\")\n        return FLAGS;\n    if (str == \"SEARCH\" || str == \"SEARCH\\r\\n\")\n        return SEARCH;\n    if (str == \"ESEARCH\")\n        return ESEARCH;\n    if (str == \"STATUS\")\n        return STATUS;\n    if (str == \"NAMESPACE\")\n        return NAMESPACE;\n    if (str == \"SORT\")\n        return SORT;\n    if (str == \"THREAD\")\n        return THREAD;\n    if (str == \"ID\")\n        return ID;\n    if (str == \"ENABLED\")\n        return ENABLED;\n    if (str == \"VANISHED\")\n        return VANISHED;\n    if (str == \"GENURLAUTH\")\n        return GENURLAUTH;\n    throw UnrecognizedResponseKind(str.constData());\n}"
        }
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nasicMessage {\n  ailbox::TreeItemChildrenList BasicMessage::createTreeItems(Mailbox::TreeItem *parent) const\n  {\n      Mailbox::TreeItemChildrenList list;\n      Mailbox::TreeItemPart *p = new Mailbox::TreeItemPart(parent, QString(\"%1/%2\").arg(mediaType, mediaSubType));\n      storeInterestingFields(p);\n      list << p;\n      return list;\n  }\n}"
  },
  {
    "function_name": "createTreeItems(",
    "container": "extMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "770-777",
    "snippet": "ailbox::TreeItemChildrenList TextMessage::createTreeItems(Mailbox::TreeItem *parent) const\n{\n    Mailbox::TreeItemChildrenList list;\n    Mailbox::TreeItemPart *p = new Mailbox::TreeItemPart(parent, QString(\"%1/%2\").arg(mediaType, mediaSubType));\n    storeInterestingFields(p);\n    list << p;\n    return list;\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "toreInterestingFields(",
          "args": [
            ")"
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "storeInterestingFields(",
          "container": "ultiMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "757-768",
          "snippet": "oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    AbstractMessage::storeInterestingFields(p);\n\n    // The multipart/related can specify the root part to show\n    if (mediaSubType == QLatin1String(\"related\")) {\n        bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n        if (it != bodyFldParam.end()) {\n            p->setMultipartRelatedStartPart(*it);\n        }\n    }\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nultiMessage {\n  oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      AbstractMessage::storeInterestingFields(p);\n  \n      // The multipart/related can specify the root part to show\n      if (mediaSubType == QLatin1String(\"related\")) {\n          bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n          if (it != bodyFldParam.end()) {\n              p->setMultipartRelatedStartPart(*it);\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String",
          "args": [
            "ediaType,",
            "ediaSubType)"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "fromPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "41-52",
          "snippet": "ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n{\n    int offset = 0;\n\n    if (!parseOneAddress(into, address, offset))\n        return false;\n\n    if (offset < address.size())\n        return false;\n\n    return true;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n  {\n      int offset = 0;\n  \n      if (!parseOneAddress(into, address, offset))\n          return false;\n  \n      if (offset < address.size())\n          return false;\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "%1/%2\")"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "indFromString(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Response.cpp",
          "lines": "191-244",
          "snippet": "ind kindFromString(QByteArray str) throw(UnrecognizedResponseKind)\n{\n    str = str.toUpper();\n\n    if (str == \"OK\")\n        return OK;\n    if (str == \"NO\")\n        return NO;\n    if (str == \"BAD\")\n        return BAD;\n    if (str == \"BYE\")\n        return BYE;\n    if (str == \"PREAUTH\")\n        return PREAUTH;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXPUNGE\")\n        return EXPUNGE;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXISTS\")\n        return EXISTS;\n    if (str == \"RECENT\")\n        return RECENT;\n    if (str == \"CAPABILITY\")\n        return CAPABILITY;\n    if (str == \"LIST\")\n        return LIST;\n    if (str == \"LSUB\")\n        return LSUB;\n    if (str == \"FLAGS\")\n        return FLAGS;\n    if (str == \"SEARCH\" || str == \"SEARCH\\r\\n\")\n        return SEARCH;\n    if (str == \"ESEARCH\")\n        return ESEARCH;\n    if (str == \"STATUS\")\n        return STATUS;\n    if (str == \"NAMESPACE\")\n        return NAMESPACE;\n    if (str == \"SORT\")\n        return SORT;\n    if (str == \"THREAD\")\n        return THREAD;\n    if (str == \"ID\")\n        return ID;\n    if (str == \"ENABLED\")\n        return ENABLED;\n    if (str == \"VANISHED\")\n        return VANISHED;\n    if (str == \"GENURLAUTH\")\n        return GENURLAUTH;\n    throw UnrecognizedResponseKind(str.constData());\n}",
          "includes": [
            "include \"../Tasks/ImapTask.h\"",
            "include \"../Model/Model.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Message.h\"\n#",
            "include \"Response.h\"\n#",
            "include <QSslError>\n#",
            "include <typeinfo>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Tasks/ImapTask.h\"\ninclude \"../Model/Model.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Message.h\"\n#\ninclude \"Response.h\"\n#\ninclude <QSslError>\n#\ninclude <typeinfo>\n#\n\nind kindFromString(QByteArray str) throw(UnrecognizedResponseKind)\n{\n    str = str.toUpper();\n\n    if (str == \"OK\")\n        return OK;\n    if (str == \"NO\")\n        return NO;\n    if (str == \"BAD\")\n        return BAD;\n    if (str == \"BYE\")\n        return BYE;\n    if (str == \"PREAUTH\")\n        return PREAUTH;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXPUNGE\")\n        return EXPUNGE;\n    if (str == \"FETCH\")\n        return FETCH;\n    if (str == \"EXISTS\")\n        return EXISTS;\n    if (str == \"RECENT\")\n        return RECENT;\n    if (str == \"CAPABILITY\")\n        return CAPABILITY;\n    if (str == \"LIST\")\n        return LIST;\n    if (str == \"LSUB\")\n        return LSUB;\n    if (str == \"FLAGS\")\n        return FLAGS;\n    if (str == \"SEARCH\" || str == \"SEARCH\\r\\n\")\n        return SEARCH;\n    if (str == \"ESEARCH\")\n        return ESEARCH;\n    if (str == \"STATUS\")\n        return STATUS;\n    if (str == \"NAMESPACE\")\n        return NAMESPACE;\n    if (str == \"SORT\")\n        return SORT;\n    if (str == \"THREAD\")\n        return THREAD;\n    if (str == \"ID\")\n        return ID;\n    if (str == \"ENABLED\")\n        return ENABLED;\n    if (str == \"VANISHED\")\n        return VANISHED;\n    if (str == \"GENURLAUTH\")\n        return GENURLAUTH;\n    throw UnrecognizedResponseKind(str.constData());\n}"
        }
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nextMessage {\n  ailbox::TreeItemChildrenList TextMessage::createTreeItems(Mailbox::TreeItem *parent) const\n  {\n      Mailbox::TreeItemChildrenList list;\n      Mailbox::TreeItemPart *p = new Mailbox::TreeItemPart(parent, QString(\"%1/%2\").arg(mediaType, mediaSubType));\n      storeInterestingFields(p);\n      list << p;\n      return list;\n  }\n}"
  },
  {
    "function_name": "storeInterestingFields(",
    "container": "ultiMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "757-768",
    "snippet": "oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    AbstractMessage::storeInterestingFields(p);\n\n    // The multipart/related can specify the root part to show\n    if (mediaSubType == QLatin1String(\"related\")) {\n        bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n        if (it != bodyFldParam.end()) {\n            p->setMultipartRelatedStartPart(*it);\n        }\n    }\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "->setMultipartRelatedStartPart",
          "args": [
            "it)"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odyFldParam.end",
          "args": [],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odyFldParam.find",
          "args": [
            "START\")"
          ],
          "line": 763
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "FindBar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FindBar.cpp",
          "lines": "180-186",
          "snippet": "void FindBar::find(const QString & search)\n{\n    _lastStringSearched = search;\n\n    updateHighlight();\n    findNext();\n}",
          "includes": [
            "#include \"Gui/Util.h\"",
            "#include \"LineEdit.h\"",
            "#include <QWebView>",
            "#include <QWebFrame>",
            "#include <QToolButton>",
            "#include <QPushButton>",
            "#include <QLabel>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCheckBox>",
            "#include \"FindBar.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Gui/Util.h\"\n#include \"LineEdit.h\"\n#include <QWebView>\n#include <QWebFrame>\n#include <QToolButton>\n#include <QPushButton>\n#include <QLabel>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCheckBox>\n#include \"FindBar.h\"\n\nFindBar {\n  void FindBar::find(const QString & search)\n  {\n      _lastStringSearched = search;\n  \n      updateHighlight();\n      findNext();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "related\")"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bstractMessage::storeInterestingFields(",
          "args": [
            ")"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "storeInterestingFields(",
          "container": "bstractMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "719-747",
          "snippet": "oid AbstractMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    // Charset\n    bodyFldParam_t::const_iterator it = bodyFldParam.find(\"CHARSET\");\n    if (it != bodyFldParam.end()) {\n        p->setCharset(*it);\n    }\n\n    // Support for format=flowed, RFC3676\n    it = bodyFldParam.find(\"FORMAT\");\n    if (it != bodyFldParam.end()) {\n        p->setContentFormat(*it);\n\n        it = bodyFldParam.find(\"DELSP\");\n        if (it != bodyFldParam.end()) {\n            p->setContentDelSp(*it);\n        }\n    }\n\n    // Filename and content-disposition\n    if (!bodyFldDsp.first.isNull()) {\n        p->setBodyDisposition(bodyFldDsp.first);\n        QString filename = Imap::extractRfc2231Param(bodyFldDsp.second, \"FILENAME\");\n        if (filename.isEmpty()) {\n            filename = Imap::extractRfc2231Param(bodyFldParam, \"NAME\");\n        }\n        p->setFileName(filename);\n    }\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  oid AbstractMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      // Charset\n      bodyFldParam_t::const_iterator it = bodyFldParam.find(\"CHARSET\");\n      if (it != bodyFldParam.end()) {\n          p->setCharset(*it);\n      }\n  \n      // Support for format=flowed, RFC3676\n      it = bodyFldParam.find(\"FORMAT\");\n      if (it != bodyFldParam.end()) {\n          p->setContentFormat(*it);\n  \n          it = bodyFldParam.find(\"DELSP\");\n          if (it != bodyFldParam.end()) {\n              p->setContentDelSp(*it);\n          }\n      }\n  \n      // Filename and content-disposition\n      if (!bodyFldDsp.first.isNull()) {\n          p->setBodyDisposition(bodyFldDsp.first);\n          QString filename = Imap::extractRfc2231Param(bodyFldDsp.second, \"FILENAME\");\n          if (filename.isEmpty()) {\n              filename = Imap::extractRfc2231Param(bodyFldParam, \"NAME\");\n          }\n          p->setFileName(filename);\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nultiMessage {\n  oid MultiMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      AbstractMessage::storeInterestingFields(p);\n  \n      // The multipart/related can specify the root part to show\n      if (mediaSubType == QLatin1String(\"related\")) {\n          bodyFldParam_t::const_iterator it = bodyFldParam.find(\"START\");\n          if (it != bodyFldParam.end()) {\n              p->setMultipartRelatedStartPart(*it);\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "storeInterestingFields(",
    "container": "neMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "749-755",
    "snippet": "oid OneMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    AbstractMessage::storeInterestingFields(p);\n    p->setEncoding(bodyFldEnc.toLower());\n    p->setOctets(bodyFldOctets);\n    p->setBodyFldId(bodyFldId);\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "->setBodyFldId",
          "args": [
            "odyFldId)"
          ],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setOctets",
          "args": [
            "odyFldOctets)"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setEncoding",
          "args": [
            "odyFldEnc.toLower())"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odyFldEnc.toLower",
          "args": [],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bstractMessage::storeInterestingFields(",
          "args": [
            ")"
          ],
          "line": 751
        },
        "resolved": true,
        "details": {
          "function_name": "storeInterestingFields(",
          "container": "bstractMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "719-747",
          "snippet": "oid AbstractMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    // Charset\n    bodyFldParam_t::const_iterator it = bodyFldParam.find(\"CHARSET\");\n    if (it != bodyFldParam.end()) {\n        p->setCharset(*it);\n    }\n\n    // Support for format=flowed, RFC3676\n    it = bodyFldParam.find(\"FORMAT\");\n    if (it != bodyFldParam.end()) {\n        p->setContentFormat(*it);\n\n        it = bodyFldParam.find(\"DELSP\");\n        if (it != bodyFldParam.end()) {\n            p->setContentDelSp(*it);\n        }\n    }\n\n    // Filename and content-disposition\n    if (!bodyFldDsp.first.isNull()) {\n        p->setBodyDisposition(bodyFldDsp.first);\n        QString filename = Imap::extractRfc2231Param(bodyFldDsp.second, \"FILENAME\");\n        if (filename.isEmpty()) {\n            filename = Imap::extractRfc2231Param(bodyFldParam, \"NAME\");\n        }\n        p->setFileName(filename);\n    }\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  oid AbstractMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      // Charset\n      bodyFldParam_t::const_iterator it = bodyFldParam.find(\"CHARSET\");\n      if (it != bodyFldParam.end()) {\n          p->setCharset(*it);\n      }\n  \n      // Support for format=flowed, RFC3676\n      it = bodyFldParam.find(\"FORMAT\");\n      if (it != bodyFldParam.end()) {\n          p->setContentFormat(*it);\n  \n          it = bodyFldParam.find(\"DELSP\");\n          if (it != bodyFldParam.end()) {\n              p->setContentDelSp(*it);\n          }\n      }\n  \n      // Filename and content-disposition\n      if (!bodyFldDsp.first.isNull()) {\n          p->setBodyDisposition(bodyFldDsp.first);\n          QString filename = Imap::extractRfc2231Param(bodyFldDsp.second, \"FILENAME\");\n          if (filename.isEmpty()) {\n              filename = Imap::extractRfc2231Param(bodyFldParam, \"NAME\");\n          }\n          p->setFileName(filename);\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nneMessage {\n  oid OneMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      AbstractMessage::storeInterestingFields(p);\n      p->setEncoding(bodyFldEnc.toLower());\n      p->setOctets(bodyFldOctets);\n      p->setBodyFldId(bodyFldId);\n  }\n}"
  },
  {
    "function_name": "storeInterestingFields(",
    "container": "bstractMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "719-747",
    "snippet": "oid AbstractMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n{\n    // Charset\n    bodyFldParam_t::const_iterator it = bodyFldParam.find(\"CHARSET\");\n    if (it != bodyFldParam.end()) {\n        p->setCharset(*it);\n    }\n\n    // Support for format=flowed, RFC3676\n    it = bodyFldParam.find(\"FORMAT\");\n    if (it != bodyFldParam.end()) {\n        p->setContentFormat(*it);\n\n        it = bodyFldParam.find(\"DELSP\");\n        if (it != bodyFldParam.end()) {\n            p->setContentDelSp(*it);\n        }\n    }\n\n    // Filename and content-disposition\n    if (!bodyFldDsp.first.isNull()) {\n        p->setBodyDisposition(bodyFldDsp.first);\n        QString filename = Imap::extractRfc2231Param(bodyFldDsp.second, \"FILENAME\");\n        if (filename.isEmpty()) {\n            filename = Imap::extractRfc2231Param(bodyFldParam, \"NAME\");\n        }\n        p->setFileName(filename);\n    }\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "->setFileName",
          "args": [
            "ilename)"
          ],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::extractRfc2231Param(",
          "args": [
            "odyFldParam,",
            "NAME\")"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ilename.isEmpty",
          "args": [],
          "line": 742
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::extractRfc2231Param(",
          "args": [
            "odyFldDsp.second,",
            "FILENAME\")"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setBodyDisposition",
          "args": [
            "odyFldDsp.first)"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odyFldDsp.first.isNull",
          "args": [],
          "line": 739
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setContentDelSp",
          "args": [
            "it)"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odyFldParam.end",
          "args": [],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odyFldParam.find",
          "args": [
            "DELSP\")"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "FindBar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FindBar.cpp",
          "lines": "180-186",
          "snippet": "void FindBar::find(const QString & search)\n{\n    _lastStringSearched = search;\n\n    updateHighlight();\n    findNext();\n}",
          "includes": [
            "#include \"Gui/Util.h\"",
            "#include \"LineEdit.h\"",
            "#include <QWebView>",
            "#include <QWebFrame>",
            "#include <QToolButton>",
            "#include <QPushButton>",
            "#include <QLabel>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCheckBox>",
            "#include \"FindBar.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Gui/Util.h\"\n#include \"LineEdit.h\"\n#include <QWebView>\n#include <QWebFrame>\n#include <QToolButton>\n#include <QPushButton>\n#include <QLabel>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCheckBox>\n#include \"FindBar.h\"\n\nFindBar {\n  void FindBar::find(const QString & search)\n  {\n      _lastStringSearched = search;\n  \n      updateHighlight();\n      findNext();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "->setContentFormat",
          "args": [
            "it)"
          ],
          "line": 730
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odyFldParam.end",
          "args": [],
          "line": 729
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setCharset",
          "args": [
            "it)"
          ],
          "line": 724
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odyFldParam.end",
          "args": [],
          "line": 723
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  oid AbstractMessage::storeInterestingFields(Mailbox::TreeItemPart *p) const\n  {\n      // Charset\n      bodyFldParam_t::const_iterator it = bodyFldParam.find(\"CHARSET\");\n      if (it != bodyFldParam.end()) {\n          p->setCharset(*it);\n      }\n  \n      // Support for format=flowed, RFC3676\n      it = bodyFldParam.find(\"FORMAT\");\n      if (it != bodyFldParam.end()) {\n          p->setContentFormat(*it);\n  \n          it = bodyFldParam.find(\"DELSP\");\n          if (it != bodyFldParam.end()) {\n              p->setContentDelSp(*it);\n          }\n      }\n  \n      // Filename and content-disposition\n      if (!bodyFldDsp.first.isNull()) {\n          p->setBodyDisposition(bodyFldDsp.first);\n          QString filename = Imap::extractRfc2231Param(bodyFldDsp.second, \"FILENAME\");\n          if (filename.isEmpty()) {\n              filename = Imap::extractRfc2231Param(bodyFldParam, \"NAME\");\n          }\n          p->setFileName(filename);\n      }\n  }\n}"
  },
  {
    "function_name": "umpListOfAddresses(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "640-658",
    "snippet": "oid dumpListOfAddresses(QTextStream &stream, const QList<MailAddress> &list, const int indent)\n{\n    QByteArray lf(\"\\n\");\n    switch (list.size()) {\n    case 0:\n        stream << \"[ ]\" << lf;\n        break;\n    case 1:\n        stream << \"[ \" << list.front() << \" ]\" << lf;\n        break;\n    default: {\n        QByteArray i(indent + 1, ' ');\n        stream << \"[\" << lf;\n        for (QList<MailAddress>::const_iterator it = list.begin(); it != list.end(); ++it)\n            stream << i << *it << lf;\n        stream << QByteArray(indent, ' ') << \"]\" << lf;\n    }\n    }\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ByteArray(",
          "args": [
            "ndent,",
            "')"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "ecodeByteArray(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Encoders.cpp",
          "lines": "334-340",
          "snippet": "String decodeByteArray(const QByteArray &encoded, const QString &charset)\n{\n    if (QTextCodec *codec = codecForName(charset.toLatin1())) {\n        return codec->toUnicode(encoded);\n    }\n    return QString::fromUtf8(encoded, encoded.size());\n}",
          "includes": [
            "include \"Parser/3rdparty/kcodecs.h\"",
            "include \"Parser/3rdparty/rfccodecs.h\"\n#",
            "include \"Encoders.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Parser/3rdparty/kcodecs.h\"\ninclude \"Parser/3rdparty/rfccodecs.h\"\n#\ninclude \"Encoders.h\"\n#\n\nString decodeByteArray(const QByteArray &encoded, const QString &charset)\n{\n    if (QTextCodec *codec = codecForName(charset.toLatin1())) {\n        return codec->toUnicode(encoded);\n    }\n    return QString::fromUtf8(encoded, encoded.size());\n}"
        }
      },
      {
        "call_info": {
          "callee": "ist.end",
          "args": [],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist.begin",
          "args": [],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist.front",
          "args": [],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist.size",
          "args": [],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\noid dumpListOfAddresses(QTextStream &stream, const QList<MailAddress> &list, const int indent)\n{\n    QByteArray lf(\"\\n\");\n    switch (list.size()) {\n    case 0:\n        stream << \"[ ]\" << lf;\n        break;\n    case 1:\n        stream << \"[ \" << list.front() << \" ]\" << lf;\n        break;\n    default: {\n        QByteArray i(indent + 1, ' ');\n        stream << \"[\" << lf;\n        for (QList<MailAddress>::const_iterator it = list.begin(); it != list.end(); ++it)\n            stream << i << *it << lf;\n        stream << QByteArray(indent, ' ') << \"]\" << lf;\n    }\n    }\n}"
  },
  {
    "function_name": "fromList(",
    "container": "bstractMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "394-638",
    "snippet": "SharedPointer<AbstractMessage> AbstractMessage::fromList(const QVariantList &items, const QByteArray &line, const int start)\n{\n    if (items.size() < 2)\n        throw NoData(\"AbstractMessage::fromList: no data\", line, start);\n\n    if (items[0].type() == QVariant::ByteArray) {\n        // it's a single-part message, hurray\n\n        int i = 0;\n        QString mediaType = items[i].toString().toLower();\n        ++i;\n        QString mediaSubType = items[i].toString().toLower();\n        ++i;\n\n        if (items.size() < 7) {\n            qDebug() << \"AbstractMessage::fromList(): body-type-basic(?): yuck, too few items, using what we've got\";\n        }\n\n        bodyFldParam_t bodyFldParam;\n        if (i < items.size()) {\n            bodyFldParam = makeBodyFldParam(items[i], line, start);\n            ++i;\n        }\n\n        QByteArray bodyFldId;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-id not recognized as a ByteArray\", line, start);\n            bodyFldId = items[i].toByteArray();\n            ++i;\n        }\n\n        QByteArray bodyFldDesc;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-desc not recognized as a ByteArray\", line, start);\n            bodyFldDesc = items[i].toByteArray();\n            ++i;\n        }\n\n        QByteArray bodyFldEnc;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-enc not recognized as a ByteArray\", line, start);\n            bodyFldEnc = items[i].toByteArray();\n            ++i;\n        }\n\n        uint bodyFldOctets = 0;\n        if (i < items.size()) {\n            bodyFldOctets = extractUInt(items[i], line, start);\n            ++i;\n        }\n\n        uint bodyFldLines = 0;\n        Envelope envelope;\n        QSharedPointer<AbstractMessage> body;\n\n        enum { MESSAGE, TEXT, BASIC} kind;\n\n        if (mediaType == QLatin1String(\"message\") && mediaSubType == QLatin1String(\"rfc822\")) {\n            // extract envelope, body, body-fld-lines\n\n            if (items.size() < 10)\n                throw NoData(\"too few fields for a Message-message\", line, start);\n\n            kind = MESSAGE;\n            if (items[i].type() == QVariant::ByteArray && items[i].toByteArray().isEmpty()) {\n                // ENVELOPE is NIL, this shouldn't really happen\n                qDebug() << \"AbstractMessage::fromList(): message/rfc822: yuck, got NIL for envelope\";\n            } else if (items[i].type() != QVariant::List) {\n                throw UnexpectedHere(\"message/rfc822: envelope not a list\", line, start);\n            } else {\n                envelope = Envelope::fromList(items[i].toList(), line, start);\n            }\n            ++i;\n\n            if (items[i].type() != QVariant::List)\n                throw UnexpectedHere(\"message/rfc822: body not recognized as a list\", line, start);\n            body = AbstractMessage::fromList(items[i].toList(), line, start);\n            ++i;\n\n            try {\n                bodyFldLines = extractUInt(items[i], line, start);\n            } catch (const UnexpectedHere &) {\n                qDebug() << \"AbstractMessage::fromList(): message/rfc822: yuck, invalid body-fld-lines\";\n            }\n            ++i;\n\n        } else if (mediaType == QLatin1String(\"text\")) {\n            kind = TEXT;\n            if (i < items.size()) {\n                // extract body-fld-lines\n                bodyFldLines = extractUInt(items[i], line, start);\n                ++i;\n            }\n        } else {\n            // don't extract anything as we're done here\n            kind = BASIC;\n        }\n\n        // extract body-ext-1part\n\n        // body-fld-md5\n        QByteArray bodyFldMd5;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-md5 not a ByteArray\", line, start);\n            bodyFldMd5 = items[i].toByteArray();\n            ++i;\n        }\n\n        // body-fld-dsp\n        bodyFldDsp_t bodyFldDsp;\n        if (i < items.size()) {\n            bodyFldDsp = makeBodyFldDsp(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-lang\n        QList<QByteArray> bodyFldLang;\n        if (i < items.size()) {\n            bodyFldLang = makeBodyFldLang(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-loc\n        QByteArray bodyFldLoc;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-loc not found\", line, start);\n            bodyFldLoc = items[i].toByteArray();\n            ++i;\n        }\n\n        // body-extension\n        QVariant bodyExtension;\n        if (i < items.size()) {\n            if (i == items.size() - 1) {\n                bodyExtension = items[i];\n                ++i;\n            } else {\n                QVariantList list;\n                for (; i < items.size(); ++i)\n                    list << items[i];\n                bodyExtension = list;\n            }\n        }\n\n        switch (kind) {\n        case MESSAGE:\n            return QSharedPointer<AbstractMessage>(\n                       new MsgMessage(mediaType, mediaSubType, bodyFldParam,\n                                      bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                      bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                      bodyExtension, envelope, body, bodyFldLines)\n                   );\n        case TEXT:\n            return QSharedPointer<AbstractMessage>(\n                       new TextMessage(mediaType, mediaSubType, bodyFldParam,\n                                       bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                       bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                       bodyExtension, bodyFldLines)\n                   );\n        case BASIC:\n        default:\n            return QSharedPointer<AbstractMessage>(\n                       new BasicMessage(mediaType, mediaSubType, bodyFldParam,\n                                        bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                        bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                        bodyExtension)\n                   );\n        }\n\n    } else if (items[0].type() == QVariant::List) {\n\n        if (items.size() < 2)\n            throw ParseError(\"body-type-mpart: structure should be \\\"body* string\\\"\", line, start);\n\n        int i = 0;\n\n        QList<QSharedPointer<AbstractMessage> > bodies;\n        while (items[i].type() == QVariant::List) {\n            bodies << fromList(items[i].toList(), line, start);\n            ++i;\n        }\n\n        if (items[i].type() != QVariant::ByteArray)\n            throw UnexpectedHere(\"body-type-mpart: media-subtype not recognized\", line, start);\n        QString mediaSubType = items[i].toString().toLower();\n        ++i;\n\n        // body-ext-mpart\n\n        // body-fld-param\n        bodyFldParam_t bodyFldParam;\n        if (i < items.size()) {\n            bodyFldParam = makeBodyFldParam(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-dsp\n        bodyFldDsp_t bodyFldDsp;\n        if (i < items.size()) {\n            bodyFldDsp = makeBodyFldDsp(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-lang\n        QList<QByteArray> bodyFldLang;\n        if (i < items.size()) {\n            bodyFldLang = makeBodyFldLang(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-loc\n        QByteArray bodyFldLoc;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-loc not found\", line, start);\n            bodyFldLoc = items[i].toByteArray();\n            ++i;\n        }\n\n        // body-extension\n        QVariant bodyExtension;\n        if (i < items.size()) {\n            if (i == items.size() - 1) {\n                bodyExtension = items[i];\n                ++i;\n            } else {\n                QVariantList list;\n                for (; i < items.size(); ++i)\n                    list << items[i];\n                bodyExtension = list;\n            }\n        }\n\n        return QSharedPointer<AbstractMessage>(\n                   new MultiMessage(bodies, mediaSubType, bodyFldParam,\n                                    bodyFldDsp, bodyFldLang, bodyFldLoc, bodyExtension));\n    } else {\n        throw UnexpectedHere(\"AbstractMessage::fromList: invalid data type of first item\", line, start);\n    }\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "AbstractMessage::fromList: invalid data type of first item\",",
            "ine,",
            "tart)"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SharedPointer<AbstractMessage>",
          "args": [
            "ew MultiMessage(bodies, mediaSubType, bodyFldParam,\n                                    bodyFldDsp, bodyFldLang, bodyFldLoc, bodyExtension))"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 620
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toByteArray",
          "args": [],
          "line": 614
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-loc not found\",",
            "ine,",
            "tart)"
          ],
          "line": 613
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].type",
          "args": [],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 611
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "akeBodyFldLang(",
          "args": [
            "tems[i],",
            "ine,",
            "tart)"
          ],
          "line": 605
        },
        "resolved": true,
        "details": {
          "function_name": "makeBodyFldLang(",
          "container": "bstractMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "350-367",
          "snippet": "List<QByteArray> AbstractMessage::makeBodyFldLang(const QVariant &input, const QByteArray &line, const int start)\n{\n    QList<QByteArray> res;\n    if (input.type() == QVariant::ByteArray) {\n        if (input.toByteArray().isNull())   // handle NIL\n            return res;\n        res << input.toByteArray();\n    } else if (input.type() == QVariant::List) {\n        QVariantList list = input.toList();\n        for (QVariantList::const_iterator it = list.constBegin(); it != list.constEnd(); ++it)\n            if (it->type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-lang has wrong structure\", line, start);\n            else\n                res << it->toByteArray();\n    } else\n        throw UnexpectedHere(\"body-fld-lang not found\", line, start);\n    return res;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  List<QByteArray> AbstractMessage::makeBodyFldLang(const QVariant &input, const QByteArray &line, const int start)\n  {\n      QList<QByteArray> res;\n      if (input.type() == QVariant::ByteArray) {\n          if (input.toByteArray().isNull())   // handle NIL\n              return res;\n          res << input.toByteArray();\n      } else if (input.type() == QVariant::List) {\n          QVariantList list = input.toList();\n          for (QVariantList::const_iterator it = list.constBegin(); it != list.constEnd(); ++it)\n              if (it->type() != QVariant::ByteArray)\n                  throw UnexpectedHere(\"body-fld-lang has wrong structure\", line, start);\n              else\n                  res << it->toByteArray();\n      } else\n          throw UnexpectedHere(\"body-fld-lang not found\", line, start);\n      return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 604
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "akeBodyFldDsp(",
          "args": [
            "tems[i],",
            "ine,",
            "tart)"
          ],
          "line": 598
        },
        "resolved": true,
        "details": {
          "function_name": "makeBodyFldDsp(",
          "container": "bstractMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "331-348",
          "snippet": "bstractMessage::bodyFldDsp_t AbstractMessage::makeBodyFldDsp(const QVariant &input, const QByteArray &line, const int start)\n{\n    bodyFldDsp_t res;\n\n    if (input.type() != QVariant::List) {\n        if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n            return res;\n        throw UnexpectedHere(\"body-fld-dsp: not a list / nil\", line, start);\n    }\n    QVariantList list = input.toList();\n    if (list.size() != 2)\n        throw ParseError(\"body-fld-dsp: wrong number of entries in the list\", line, start);\n    if (list[0].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"body-fld-dsp: first item is not a string\", line, start);\n    res.first = list[0].toByteArray();\n    res.second = makeBodyFldParam(list[1], line, start);\n    return res;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  bstractMessage::bodyFldDsp_t AbstractMessage::makeBodyFldDsp(const QVariant &input, const QByteArray &line, const int start)\n  {\n      bodyFldDsp_t res;\n  \n      if (input.type() != QVariant::List) {\n          if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n              return res;\n          throw UnexpectedHere(\"body-fld-dsp: not a list / nil\", line, start);\n      }\n      QVariantList list = input.toList();\n      if (list.size() != 2)\n          throw ParseError(\"body-fld-dsp: wrong number of entries in the list\", line, start);\n      if (list[0].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"body-fld-dsp: first item is not a string\", line, start);\n      res.first = list[0].toByteArray();\n      res.second = makeBodyFldParam(list[1], line, start);\n      return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 597
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "akeBodyFldParam(",
          "args": [
            "tems[i],",
            "ine,",
            "tart)"
          ],
          "line": 591
        },
        "resolved": true,
        "details": {
          "function_name": "makeBodyFldParam(",
          "container": "bstractMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "312-329",
          "snippet": "bstractMessage::bodyFldParam_t AbstractMessage::makeBodyFldParam(const QVariant &input, const QByteArray &line, const int start)\n{\n    bodyFldParam_t map;\n    if (input.type() != QVariant::List) {\n        if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n            return map;\n        throw UnexpectedHere(\"body-fld-param: not a list / nil\", line, start);\n    }\n    QVariantList list = input.toList();\n    if (list.size() % 2)\n        throw UnexpectedHere(\"body-fld-param: wrong number of entries\", line, start);\n    for (int j = 0; j < list.size(); j += 2)\n        if (list[j].type() != QVariant::ByteArray || list[j+1].type() != QVariant::ByteArray)\n            throw UnexpectedHere(\"body-fld-param: string not found\", line, start);\n        else\n            map[ list[j].toByteArray().toUpper() ] = list[j+1].toByteArray();\n    return map;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  bstractMessage::bodyFldParam_t AbstractMessage::makeBodyFldParam(const QVariant &input, const QByteArray &line, const int start)\n  {\n      bodyFldParam_t map;\n      if (input.type() != QVariant::List) {\n          if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n              return map;\n          throw UnexpectedHere(\"body-fld-param: not a list / nil\", line, start);\n      }\n      QVariantList list = input.toList();\n      if (list.size() % 2)\n          throw UnexpectedHere(\"body-fld-param: wrong number of entries\", line, start);\n      for (int j = 0; j < list.size(); j += 2)\n          if (list[j].type() != QVariant::ByteArray || list[j+1].type() != QVariant::ByteArray)\n              throw UnexpectedHere(\"body-fld-param: string not found\", line, start);\n          else\n              map[ list[j].toByteArray().toUpper() ] = list[j+1].toByteArray();\n      return map;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toString",
          "args": [],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toString",
          "args": [],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-type-mpart: media-subtype not recognized\",",
            "ine,",
            "tart)"
          ],
          "line": 582
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "romList(",
          "args": [
            "tems[i].toList(),",
            "ine,",
            "tart)"
          ],
          "line": 577
        },
        "resolved": true,
        "details": {
          "function_name": "fromList(",
          "container": "bstractMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "394-638",
          "snippet": "SharedPointer<AbstractMessage> AbstractMessage::fromList(const QVariantList &items, const QByteArray &line, const int start)\n{\n    if (items.size() < 2)\n        throw NoData(\"AbstractMessage::fromList: no data\", line, start);\n\n    if (items[0].type() == QVariant::ByteArray) {\n        // it's a single-part message, hurray\n\n        int i = 0;\n        QString mediaType = items[i].toString().toLower();\n        ++i;\n        QString mediaSubType = items[i].toString().toLower();\n        ++i;\n\n        if (items.size() < 7) {\n            qDebug() << \"AbstractMessage::fromList(): body-type-basic(?): yuck, too few items, using what we've got\";\n        }\n\n        bodyFldParam_t bodyFldParam;\n        if (i < items.size()) {\n            bodyFldParam = makeBodyFldParam(items[i], line, start);\n            ++i;\n        }\n\n        QByteArray bodyFldId;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-id not recognized as a ByteArray\", line, start);\n            bodyFldId = items[i].toByteArray();\n            ++i;\n        }\n\n        QByteArray bodyFldDesc;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-desc not recognized as a ByteArray\", line, start);\n            bodyFldDesc = items[i].toByteArray();\n            ++i;\n        }\n\n        QByteArray bodyFldEnc;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-enc not recognized as a ByteArray\", line, start);\n            bodyFldEnc = items[i].toByteArray();\n            ++i;\n        }\n\n        uint bodyFldOctets = 0;\n        if (i < items.size()) {\n            bodyFldOctets = extractUInt(items[i], line, start);\n            ++i;\n        }\n\n        uint bodyFldLines = 0;\n        Envelope envelope;\n        QSharedPointer<AbstractMessage> body;\n\n        enum { MESSAGE, TEXT, BASIC} kind;\n\n        if (mediaType == QLatin1String(\"message\") && mediaSubType == QLatin1String(\"rfc822\")) {\n            // extract envelope, body, body-fld-lines\n\n            if (items.size() < 10)\n                throw NoData(\"too few fields for a Message-message\", line, start);\n\n            kind = MESSAGE;\n            if (items[i].type() == QVariant::ByteArray && items[i].toByteArray().isEmpty()) {\n                // ENVELOPE is NIL, this shouldn't really happen\n                qDebug() << \"AbstractMessage::fromList(): message/rfc822: yuck, got NIL for envelope\";\n            } else if (items[i].type() != QVariant::List) {\n                throw UnexpectedHere(\"message/rfc822: envelope not a list\", line, start);\n            } else {\n                envelope = Envelope::fromList(items[i].toList(), line, start);\n            }\n            ++i;\n\n            if (items[i].type() != QVariant::List)\n                throw UnexpectedHere(\"message/rfc822: body not recognized as a list\", line, start);\n            body = AbstractMessage::fromList(items[i].toList(), line, start);\n            ++i;\n\n            try {\n                bodyFldLines = extractUInt(items[i], line, start);\n            } catch (const UnexpectedHere &) {\n                qDebug() << \"AbstractMessage::fromList(): message/rfc822: yuck, invalid body-fld-lines\";\n            }\n            ++i;\n\n        } else if (mediaType == QLatin1String(\"text\")) {\n            kind = TEXT;\n            if (i < items.size()) {\n                // extract body-fld-lines\n                bodyFldLines = extractUInt(items[i], line, start);\n                ++i;\n            }\n        } else {\n            // don't extract anything as we're done here\n            kind = BASIC;\n        }\n\n        // extract body-ext-1part\n\n        // body-fld-md5\n        QByteArray bodyFldMd5;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-md5 not a ByteArray\", line, start);\n            bodyFldMd5 = items[i].toByteArray();\n            ++i;\n        }\n\n        // body-fld-dsp\n        bodyFldDsp_t bodyFldDsp;\n        if (i < items.size()) {\n            bodyFldDsp = makeBodyFldDsp(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-lang\n        QList<QByteArray> bodyFldLang;\n        if (i < items.size()) {\n            bodyFldLang = makeBodyFldLang(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-loc\n        QByteArray bodyFldLoc;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-loc not found\", line, start);\n            bodyFldLoc = items[i].toByteArray();\n            ++i;\n        }\n\n        // body-extension\n        QVariant bodyExtension;\n        if (i < items.size()) {\n            if (i == items.size() - 1) {\n                bodyExtension = items[i];\n                ++i;\n            } else {\n                QVariantList list;\n                for (; i < items.size(); ++i)\n                    list << items[i];\n                bodyExtension = list;\n            }\n        }\n\n        switch (kind) {\n        case MESSAGE:\n            return QSharedPointer<AbstractMessage>(\n                       new MsgMessage(mediaType, mediaSubType, bodyFldParam,\n                                      bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                      bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                      bodyExtension, envelope, body, bodyFldLines)\n                   );\n        case TEXT:\n            return QSharedPointer<AbstractMessage>(\n                       new TextMessage(mediaType, mediaSubType, bodyFldParam,\n                                       bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                       bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                       bodyExtension, bodyFldLines)\n                   );\n        case BASIC:\n        default:\n            return QSharedPointer<AbstractMessage>(\n                       new BasicMessage(mediaType, mediaSubType, bodyFldParam,\n                                        bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                        bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                        bodyExtension)\n                   );\n        }\n\n    } else if (items[0].type() == QVariant::List) {\n\n        if (items.size() < 2)\n            throw ParseError(\"body-type-mpart: structure should be \\\"body* string\\\"\", line, start);\n\n        int i = 0;\n\n        QList<QSharedPointer<AbstractMessage> > bodies;\n        while (items[i].type() == QVariant::List) {\n            bodies << fromList(items[i].toList(), line, start);\n            ++i;\n        }\n\n        if (items[i].type() != QVariant::ByteArray)\n            throw UnexpectedHere(\"body-type-mpart: media-subtype not recognized\", line, start);\n        QString mediaSubType = items[i].toString().toLower();\n        ++i;\n\n        // body-ext-mpart\n\n        // body-fld-param\n        bodyFldParam_t bodyFldParam;\n        if (i < items.size()) {\n            bodyFldParam = makeBodyFldParam(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-dsp\n        bodyFldDsp_t bodyFldDsp;\n        if (i < items.size()) {\n            bodyFldDsp = makeBodyFldDsp(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-lang\n        QList<QByteArray> bodyFldLang;\n        if (i < items.size()) {\n            bodyFldLang = makeBodyFldLang(items[i], line, start);\n            ++i;\n        }\n\n        // body-fld-loc\n        QByteArray bodyFldLoc;\n        if (i < items.size()) {\n            if (items[i].type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-loc not found\", line, start);\n            bodyFldLoc = items[i].toByteArray();\n            ++i;\n        }\n\n        // body-extension\n        QVariant bodyExtension;\n        if (i < items.size()) {\n            if (i == items.size() - 1) {\n                bodyExtension = items[i];\n                ++i;\n            } else {\n                QVariantList list;\n                for (; i < items.size(); ++i)\n                    list << items[i];\n                bodyExtension = list;\n            }\n        }\n\n        return QSharedPointer<AbstractMessage>(\n                   new MultiMessage(bodies, mediaSubType, bodyFldParam,\n                                    bodyFldDsp, bodyFldLang, bodyFldLoc, bodyExtension));\n    } else {\n        throw UnexpectedHere(\"AbstractMessage::fromList: invalid data type of first item\", line, start);\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "tems[i].toList",
          "args": [],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arseError(",
          "args": [
            "body-type-mpart: structure should be \\\"body* string\\\"\",",
            "ine,",
            "tart)"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SharedPointer<AbstractMessage>",
          "args": [
            "ew BasicMessage(mediaType, mediaSubType, bodyFldParam,\n                                        bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                        bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                        bodyExtension)"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SharedPointer<AbstractMessage>",
          "args": [
            "ew TextMessage(mediaType, mediaSubType, bodyFldParam,\n                                       bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                       bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                       bodyExtension, bodyFldLines)"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SharedPointer<AbstractMessage>",
          "args": [
            "ew MsgMessage(mediaType, mediaSubType, bodyFldParam,\n                                      bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                      bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                      bodyExtension, envelope, body, bodyFldLines)"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toByteArray",
          "args": [],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-loc not found\",",
            "ine,",
            "tart)"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toByteArray",
          "args": [],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-md5 not a ByteArray\",",
            "ine,",
            "tart)"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xtractUInt(",
          "args": [
            "tems[i],",
            "ine,",
            "tart)"
          ],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "extractUInt(",
          "container": "bstractMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "369-391",
          "snippet": "int AbstractMessage::extractUInt(const QVariant &var, const QByteArray &line, const int start)\n{\n    if (var.type() == QVariant::UInt)\n        return var.toUInt();\n    if (var.type() == QVariant::ByteArray) {\n        bool ok = false;\n        int number = var.toInt(&ok);\n        if (ok) {\n            if (number >= 0) {\n                return number;\n            } else {\n                qDebug() << \"Parser warning:\" << number << \"is not an unsigned int\";\n                return 0;\n            }\n        } else if (var.toByteArray().isEmpty()) {\n            qDebug() << \"Parser warning: expected unsigned int, but got NIL or an empty string instead, yuck\";\n            return 0;\n        } else {\n            throw UnexpectedHere(\"extractUInt: not a number\", line, start);\n        }\n    }\n    throw UnexpectedHere(\"extractUInt: weird data type\", line, start);\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  int AbstractMessage::extractUInt(const QVariant &var, const QByteArray &line, const int start)\n  {\n      if (var.type() == QVariant::UInt)\n          return var.toUInt();\n      if (var.type() == QVariant::ByteArray) {\n          bool ok = false;\n          int number = var.toInt(&ok);\n          if (ok) {\n              if (number >= 0) {\n                  return number;\n              } else {\n                  qDebug() << \"Parser warning:\" << number << \"is not an unsigned int\";\n                  return 0;\n              }\n          } else if (var.toByteArray().isEmpty()) {\n              qDebug() << \"Parser warning: expected unsigned int, but got NIL or an empty string instead, yuck\";\n              return 0;\n          } else {\n              throw UnexpectedHere(\"extractUInt: not a number\", line, start);\n          }\n      }\n      throw UnexpectedHere(\"extractUInt: weird data type\", line, start);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 485
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "text\")"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toList",
          "args": [],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "message/rfc822: body not recognized as a list\",",
            "ine,",
            "tart)"
          ],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nvelope::fromList(",
          "args": [
            "tems[i].toList(),",
            "ine,",
            "tart)"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "fromList(",
          "container": "nvelope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "65-121",
          "snippet": "nvelope Envelope::fromList(const QVariantList &items, const QByteArray &line, const int start)\n{\n    if (items.size() != 10)\n        throw ParseError(\"Envelope::fromList: size != 10\", line, start);   // FIXME: wrong offset\n\n    // date\n    QDateTime date;\n    if (items[0].type() == QVariant::ByteArray) {\n        QByteArray dateStr = items[0].toByteArray();\n        if (! dateStr.isEmpty()) {\n            try {\n                date = LowLevelParser::parseRFC2822DateTime(dateStr);\n            } catch (ParseError &) {\n                // FIXME: log this\n                //throw ParseError( e.what(), line, start );\n            }\n        }\n    }\n    // Otherwise it's \"invalid\", null.\n\n    QString subject = Imap::decodeRFC2047String(items[1].toByteArray());\n\n    QList<MailAddress> from, sender, replyTo, to, cc, bcc;\n    from = Envelope::getListOfAddresses(items[2], line, start);\n    sender = Envelope::getListOfAddresses(items[3], line, start);\n    replyTo = Envelope::getListOfAddresses(items[4], line, start);\n    to = Envelope::getListOfAddresses(items[5], line, start);\n    cc = Envelope::getListOfAddresses(items[6], line, start);\n    bcc = Envelope::getListOfAddresses(items[7], line, start);\n\n    LowLevelParser::Rfc5322HeaderParser headerParser;\n\n    if (items[8].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"Envelope::fromList: inReplyTo not a QByteArray\", line, start);\n    QByteArray inReplyTo = items[8].toByteArray();\n\n    if (items[9].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"Envelope::fromList: messageId not a QByteArray\", line, start);\n    QByteArray messageId = items[9].toByteArray();\n\n    QByteArray buf;\n    if (!messageId.isEmpty())\n        buf += \"Message-Id: \" + messageId + \"\\r\\n\";\n    if (!inReplyTo.isEmpty())\n        buf += \"In-Reply-To: \" + inReplyTo + \"\\r\\n\";\n    if (!buf.isEmpty()) {\n        bool ok = headerParser.parse(buf);\n        if (!ok) {\n            qDebug() << \"Envelope::fromList: malformed headers\";\n        }\n    }\n    // If the Message-Id fails to parse, well, bad luck. This enforced sanitizaion is hopefully better than\n    // generating garbage in outgoing e-mails.\n    messageId = headerParser.messageId.size() == 1 ? headerParser.messageId.front() : QByteArray();\n\n    return Envelope(date, subject, from, sender, replyTo, to, cc, bcc, headerParser.inReplyTo, messageId);\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nnvelope {\n  nvelope Envelope::fromList(const QVariantList &items, const QByteArray &line, const int start)\n  {\n      if (items.size() != 10)\n          throw ParseError(\"Envelope::fromList: size != 10\", line, start);   // FIXME: wrong offset\n  \n      // date\n      QDateTime date;\n      if (items[0].type() == QVariant::ByteArray) {\n          QByteArray dateStr = items[0].toByteArray();\n          if (! dateStr.isEmpty()) {\n              try {\n                  date = LowLevelParser::parseRFC2822DateTime(dateStr);\n              } catch (ParseError &) {\n                  // FIXME: log this\n                  //throw ParseError( e.what(), line, start );\n              }\n          }\n      }\n      // Otherwise it's \"invalid\", null.\n  \n      QString subject = Imap::decodeRFC2047String(items[1].toByteArray());\n  \n      QList<MailAddress> from, sender, replyTo, to, cc, bcc;\n      from = Envelope::getListOfAddresses(items[2], line, start);\n      sender = Envelope::getListOfAddresses(items[3], line, start);\n      replyTo = Envelope::getListOfAddresses(items[4], line, start);\n      to = Envelope::getListOfAddresses(items[5], line, start);\n      cc = Envelope::getListOfAddresses(items[6], line, start);\n      bcc = Envelope::getListOfAddresses(items[7], line, start);\n  \n      LowLevelParser::Rfc5322HeaderParser headerParser;\n  \n      if (items[8].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"Envelope::fromList: inReplyTo not a QByteArray\", line, start);\n      QByteArray inReplyTo = items[8].toByteArray();\n  \n      if (items[9].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"Envelope::fromList: messageId not a QByteArray\", line, start);\n      QByteArray messageId = items[9].toByteArray();\n  \n      QByteArray buf;\n      if (!messageId.isEmpty())\n          buf += \"Message-Id: \" + messageId + \"\\r\\n\";\n      if (!inReplyTo.isEmpty())\n          buf += \"In-Reply-To: \" + inReplyTo + \"\\r\\n\";\n      if (!buf.isEmpty()) {\n          bool ok = headerParser.parse(buf);\n          if (!ok) {\n              qDebug() << \"Envelope::fromList: malformed headers\";\n          }\n      }\n      // If the Message-Id fails to parse, well, bad luck. This enforced sanitizaion is hopefully better than\n      // generating garbage in outgoing e-mails.\n      messageId = headerParser.messageId.size() == 1 ? headerParser.messageId.front() : QByteArray();\n  \n      return Envelope(date, subject, from, sender, replyTo, to, cc, bcc, headerParser.inReplyTo, messageId);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems[i].toList",
          "args": [],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "message/rfc822: envelope not a list\",",
            "ine,",
            "tart)"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toByteArray",
          "args": [],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toByteArray",
          "args": [],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oData(",
          "args": [
            "too few fields for a Message-message\",",
            "ine,",
            "tart)"
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "rfc822\")"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "message\")"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toByteArray",
          "args": [],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-enc not recognized as a ByteArray\",",
            "ine,",
            "tart)"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toByteArray",
          "args": [],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-desc not recognized as a ByteArray\",",
            "ine,",
            "tart)"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toByteArray",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-id not recognized as a ByteArray\",",
            "ine,",
            "tart)"
          ],
          "line": 421
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toString",
          "args": [],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toString",
          "args": [],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toString",
          "args": [],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].toString",
          "args": [],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oData(",
          "args": [
            "AbstractMessage::fromList: no data\",",
            "ine,",
            "tart)"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  SharedPointer<AbstractMessage> AbstractMessage::fromList(const QVariantList &items, const QByteArray &line, const int start)\n  {\n      if (items.size() < 2)\n          throw NoData(\"AbstractMessage::fromList: no data\", line, start);\n  \n      if (items[0].type() == QVariant::ByteArray) {\n          // it's a single-part message, hurray\n  \n          int i = 0;\n          QString mediaType = items[i].toString().toLower();\n          ++i;\n          QString mediaSubType = items[i].toString().toLower();\n          ++i;\n  \n          if (items.size() < 7) {\n              qDebug() << \"AbstractMessage::fromList(): body-type-basic(?): yuck, too few items, using what we've got\";\n          }\n  \n          bodyFldParam_t bodyFldParam;\n          if (i < items.size()) {\n              bodyFldParam = makeBodyFldParam(items[i], line, start);\n              ++i;\n          }\n  \n          QByteArray bodyFldId;\n          if (i < items.size()) {\n              if (items[i].type() != QVariant::ByteArray)\n                  throw UnexpectedHere(\"body-fld-id not recognized as a ByteArray\", line, start);\n              bodyFldId = items[i].toByteArray();\n              ++i;\n          }\n  \n          QByteArray bodyFldDesc;\n          if (i < items.size()) {\n              if (items[i].type() != QVariant::ByteArray)\n                  throw UnexpectedHere(\"body-fld-desc not recognized as a ByteArray\", line, start);\n              bodyFldDesc = items[i].toByteArray();\n              ++i;\n          }\n  \n          QByteArray bodyFldEnc;\n          if (i < items.size()) {\n              if (items[i].type() != QVariant::ByteArray)\n                  throw UnexpectedHere(\"body-fld-enc not recognized as a ByteArray\", line, start);\n              bodyFldEnc = items[i].toByteArray();\n              ++i;\n          }\n  \n          uint bodyFldOctets = 0;\n          if (i < items.size()) {\n              bodyFldOctets = extractUInt(items[i], line, start);\n              ++i;\n          }\n  \n          uint bodyFldLines = 0;\n          Envelope envelope;\n          QSharedPointer<AbstractMessage> body;\n  \n          enum { MESSAGE, TEXT, BASIC} kind;\n  \n          if (mediaType == QLatin1String(\"message\") && mediaSubType == QLatin1String(\"rfc822\")) {\n              // extract envelope, body, body-fld-lines\n  \n              if (items.size() < 10)\n                  throw NoData(\"too few fields for a Message-message\", line, start);\n  \n              kind = MESSAGE;\n              if (items[i].type() == QVariant::ByteArray && items[i].toByteArray().isEmpty()) {\n                  // ENVELOPE is NIL, this shouldn't really happen\n                  qDebug() << \"AbstractMessage::fromList(): message/rfc822: yuck, got NIL for envelope\";\n              } else if (items[i].type() != QVariant::List) {\n                  throw UnexpectedHere(\"message/rfc822: envelope not a list\", line, start);\n              } else {\n                  envelope = Envelope::fromList(items[i].toList(), line, start);\n              }\n              ++i;\n  \n              if (items[i].type() != QVariant::List)\n                  throw UnexpectedHere(\"message/rfc822: body not recognized as a list\", line, start);\n              body = AbstractMessage::fromList(items[i].toList(), line, start);\n              ++i;\n  \n              try {\n                  bodyFldLines = extractUInt(items[i], line, start);\n              } catch (const UnexpectedHere &) {\n                  qDebug() << \"AbstractMessage::fromList(): message/rfc822: yuck, invalid body-fld-lines\";\n              }\n              ++i;\n  \n          } else if (mediaType == QLatin1String(\"text\")) {\n              kind = TEXT;\n              if (i < items.size()) {\n                  // extract body-fld-lines\n                  bodyFldLines = extractUInt(items[i], line, start);\n                  ++i;\n              }\n          } else {\n              // don't extract anything as we're done here\n              kind = BASIC;\n          }\n  \n          // extract body-ext-1part\n  \n          // body-fld-md5\n          QByteArray bodyFldMd5;\n          if (i < items.size()) {\n              if (items[i].type() != QVariant::ByteArray)\n                  throw UnexpectedHere(\"body-fld-md5 not a ByteArray\", line, start);\n              bodyFldMd5 = items[i].toByteArray();\n              ++i;\n          }\n  \n          // body-fld-dsp\n          bodyFldDsp_t bodyFldDsp;\n          if (i < items.size()) {\n              bodyFldDsp = makeBodyFldDsp(items[i], line, start);\n              ++i;\n          }\n  \n          // body-fld-lang\n          QList<QByteArray> bodyFldLang;\n          if (i < items.size()) {\n              bodyFldLang = makeBodyFldLang(items[i], line, start);\n              ++i;\n          }\n  \n          // body-fld-loc\n          QByteArray bodyFldLoc;\n          if (i < items.size()) {\n              if (items[i].type() != QVariant::ByteArray)\n                  throw UnexpectedHere(\"body-fld-loc not found\", line, start);\n              bodyFldLoc = items[i].toByteArray();\n              ++i;\n          }\n  \n          // body-extension\n          QVariant bodyExtension;\n          if (i < items.size()) {\n              if (i == items.size() - 1) {\n                  bodyExtension = items[i];\n                  ++i;\n              } else {\n                  QVariantList list;\n                  for (; i < items.size(); ++i)\n                      list << items[i];\n                  bodyExtension = list;\n              }\n          }\n  \n          switch (kind) {\n          case MESSAGE:\n              return QSharedPointer<AbstractMessage>(\n                         new MsgMessage(mediaType, mediaSubType, bodyFldParam,\n                                        bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                        bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                        bodyExtension, envelope, body, bodyFldLines)\n                     );\n          case TEXT:\n              return QSharedPointer<AbstractMessage>(\n                         new TextMessage(mediaType, mediaSubType, bodyFldParam,\n                                         bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                         bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                         bodyExtension, bodyFldLines)\n                     );\n          case BASIC:\n          default:\n              return QSharedPointer<AbstractMessage>(\n                         new BasicMessage(mediaType, mediaSubType, bodyFldParam,\n                                          bodyFldId, bodyFldDesc, bodyFldEnc, bodyFldOctets,\n                                          bodyFldMd5, bodyFldDsp, bodyFldLang, bodyFldLoc,\n                                          bodyExtension)\n                     );\n          }\n  \n      } else if (items[0].type() == QVariant::List) {\n  \n          if (items.size() < 2)\n              throw ParseError(\"body-type-mpart: structure should be \\\"body* string\\\"\", line, start);\n  \n          int i = 0;\n  \n          QList<QSharedPointer<AbstractMessage> > bodies;\n          while (items[i].type() == QVariant::List) {\n              bodies << fromList(items[i].toList(), line, start);\n              ++i;\n          }\n  \n          if (items[i].type() != QVariant::ByteArray)\n              throw UnexpectedHere(\"body-type-mpart: media-subtype not recognized\", line, start);\n          QString mediaSubType = items[i].toString().toLower();\n          ++i;\n  \n          // body-ext-mpart\n  \n          // body-fld-param\n          bodyFldParam_t bodyFldParam;\n          if (i < items.size()) {\n              bodyFldParam = makeBodyFldParam(items[i], line, start);\n              ++i;\n          }\n  \n          // body-fld-dsp\n          bodyFldDsp_t bodyFldDsp;\n          if (i < items.size()) {\n              bodyFldDsp = makeBodyFldDsp(items[i], line, start);\n              ++i;\n          }\n  \n          // body-fld-lang\n          QList<QByteArray> bodyFldLang;\n          if (i < items.size()) {\n              bodyFldLang = makeBodyFldLang(items[i], line, start);\n              ++i;\n          }\n  \n          // body-fld-loc\n          QByteArray bodyFldLoc;\n          if (i < items.size()) {\n              if (items[i].type() != QVariant::ByteArray)\n                  throw UnexpectedHere(\"body-fld-loc not found\", line, start);\n              bodyFldLoc = items[i].toByteArray();\n              ++i;\n          }\n  \n          // body-extension\n          QVariant bodyExtension;\n          if (i < items.size()) {\n              if (i == items.size() - 1) {\n                  bodyExtension = items[i];\n                  ++i;\n              } else {\n                  QVariantList list;\n                  for (; i < items.size(); ++i)\n                      list << items[i];\n                  bodyExtension = list;\n              }\n          }\n  \n          return QSharedPointer<AbstractMessage>(\n                     new MultiMessage(bodies, mediaSubType, bodyFldParam,\n                                      bodyFldDsp, bodyFldLang, bodyFldLoc, bodyExtension));\n      } else {\n          throw UnexpectedHere(\"AbstractMessage::fromList: invalid data type of first item\", line, start);\n      }\n  }\n}"
  },
  {
    "function_name": "extractUInt(",
    "container": "bstractMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "369-391",
    "snippet": "int AbstractMessage::extractUInt(const QVariant &var, const QByteArray &line, const int start)\n{\n    if (var.type() == QVariant::UInt)\n        return var.toUInt();\n    if (var.type() == QVariant::ByteArray) {\n        bool ok = false;\n        int number = var.toInt(&ok);\n        if (ok) {\n            if (number >= 0) {\n                return number;\n            } else {\n                qDebug() << \"Parser warning:\" << number << \"is not an unsigned int\";\n                return 0;\n            }\n        } else if (var.toByteArray().isEmpty()) {\n            qDebug() << \"Parser warning: expected unsigned int, but got NIL or an empty string instead, yuck\";\n            return 0;\n        } else {\n            throw UnexpectedHere(\"extractUInt: not a number\", line, start);\n        }\n    }\n    throw UnexpectedHere(\"extractUInt: weird data type\", line, start);\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "extractUInt: weird data type\",",
            "ine,",
            "tart)"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "extractUInt: not a number\",",
            "ine,",
            "tart)"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ar.toByteArray",
          "args": [],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ar.toByteArray",
          "args": [],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ar.toInt",
          "args": [
            "ok)"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ar.type",
          "args": [],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ar.toUInt",
          "args": [],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  int AbstractMessage::extractUInt(const QVariant &var, const QByteArray &line, const int start)\n  {\n      if (var.type() == QVariant::UInt)\n          return var.toUInt();\n      if (var.type() == QVariant::ByteArray) {\n          bool ok = false;\n          int number = var.toInt(&ok);\n          if (ok) {\n              if (number >= 0) {\n                  return number;\n              } else {\n                  qDebug() << \"Parser warning:\" << number << \"is not an unsigned int\";\n                  return 0;\n              }\n          } else if (var.toByteArray().isEmpty()) {\n              qDebug() << \"Parser warning: expected unsigned int, but got NIL or an empty string instead, yuck\";\n              return 0;\n          } else {\n              throw UnexpectedHere(\"extractUInt: not a number\", line, start);\n          }\n      }\n      throw UnexpectedHere(\"extractUInt: weird data type\", line, start);\n  }\n}"
  },
  {
    "function_name": "makeBodyFldLang(",
    "container": "bstractMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "350-367",
    "snippet": "List<QByteArray> AbstractMessage::makeBodyFldLang(const QVariant &input, const QByteArray &line, const int start)\n{\n    QList<QByteArray> res;\n    if (input.type() == QVariant::ByteArray) {\n        if (input.toByteArray().isNull())   // handle NIL\n            return res;\n        res << input.toByteArray();\n    } else if (input.type() == QVariant::List) {\n        QVariantList list = input.toList();\n        for (QVariantList::const_iterator it = list.constBegin(); it != list.constEnd(); ++it)\n            if (it->type() != QVariant::ByteArray)\n                throw UnexpectedHere(\"body-fld-lang has wrong structure\", line, start);\n            else\n                res << it->toByteArray();\n    } else\n        throw UnexpectedHere(\"body-fld-lang not found\", line, start);\n    return res;\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-lang not found\",",
            "ine,",
            "tart)"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->toByteArray",
          "args": [],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-lang has wrong structure\",",
            "ine,",
            "tart)"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->type",
          "args": [],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ist.constEnd",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist.constBegin",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toList",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toByteArray",
          "args": [],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toByteArray",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toByteArray",
          "args": [],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  List<QByteArray> AbstractMessage::makeBodyFldLang(const QVariant &input, const QByteArray &line, const int start)\n  {\n      QList<QByteArray> res;\n      if (input.type() == QVariant::ByteArray) {\n          if (input.toByteArray().isNull())   // handle NIL\n              return res;\n          res << input.toByteArray();\n      } else if (input.type() == QVariant::List) {\n          QVariantList list = input.toList();\n          for (QVariantList::const_iterator it = list.constBegin(); it != list.constEnd(); ++it)\n              if (it->type() != QVariant::ByteArray)\n                  throw UnexpectedHere(\"body-fld-lang has wrong structure\", line, start);\n              else\n                  res << it->toByteArray();\n      } else\n          throw UnexpectedHere(\"body-fld-lang not found\", line, start);\n      return res;\n  }\n}"
  },
  {
    "function_name": "makeBodyFldDsp(",
    "container": "bstractMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "331-348",
    "snippet": "bstractMessage::bodyFldDsp_t AbstractMessage::makeBodyFldDsp(const QVariant &input, const QByteArray &line, const int start)\n{\n    bodyFldDsp_t res;\n\n    if (input.type() != QVariant::List) {\n        if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n            return res;\n        throw UnexpectedHere(\"body-fld-dsp: not a list / nil\", line, start);\n    }\n    QVariantList list = input.toList();\n    if (list.size() != 2)\n        throw ParseError(\"body-fld-dsp: wrong number of entries in the list\", line, start);\n    if (list[0].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"body-fld-dsp: first item is not a string\", line, start);\n    res.first = list[0].toByteArray();\n    res.second = makeBodyFldParam(list[1], line, start);\n    return res;\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "akeBodyFldParam(",
          "args": [
            "ist[1],",
            "ine,",
            "tart)"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "makeBodyFldParam(",
          "container": "bstractMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "312-329",
          "snippet": "bstractMessage::bodyFldParam_t AbstractMessage::makeBodyFldParam(const QVariant &input, const QByteArray &line, const int start)\n{\n    bodyFldParam_t map;\n    if (input.type() != QVariant::List) {\n        if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n            return map;\n        throw UnexpectedHere(\"body-fld-param: not a list / nil\", line, start);\n    }\n    QVariantList list = input.toList();\n    if (list.size() % 2)\n        throw UnexpectedHere(\"body-fld-param: wrong number of entries\", line, start);\n    for (int j = 0; j < list.size(); j += 2)\n        if (list[j].type() != QVariant::ByteArray || list[j+1].type() != QVariant::ByteArray)\n            throw UnexpectedHere(\"body-fld-param: string not found\", line, start);\n        else\n            map[ list[j].toByteArray().toUpper() ] = list[j+1].toByteArray();\n    return map;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  bstractMessage::bodyFldParam_t AbstractMessage::makeBodyFldParam(const QVariant &input, const QByteArray &line, const int start)\n  {\n      bodyFldParam_t map;\n      if (input.type() != QVariant::List) {\n          if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n              return map;\n          throw UnexpectedHere(\"body-fld-param: not a list / nil\", line, start);\n      }\n      QVariantList list = input.toList();\n      if (list.size() % 2)\n          throw UnexpectedHere(\"body-fld-param: wrong number of entries\", line, start);\n      for (int j = 0; j < list.size(); j += 2)\n          if (list[j].type() != QVariant::ByteArray || list[j+1].type() != QVariant::ByteArray)\n              throw UnexpectedHere(\"body-fld-param: string not found\", line, start);\n          else\n              map[ list[j].toByteArray().toUpper() ] = list[j+1].toByteArray();\n      return map;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ist[0].toByteArray",
          "args": [],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-dsp: first item is not a string\",",
            "ine,",
            "tart)"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist[0].type",
          "args": [],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arseError(",
          "args": [
            "body-fld-dsp: wrong number of entries in the list\",",
            "ine,",
            "tart)"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist.size",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toList",
          "args": [],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-dsp: not a list / nil\",",
            "ine,",
            "tart)"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toByteArray",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toByteArray",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  bstractMessage::bodyFldDsp_t AbstractMessage::makeBodyFldDsp(const QVariant &input, const QByteArray &line, const int start)\n  {\n      bodyFldDsp_t res;\n  \n      if (input.type() != QVariant::List) {\n          if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n              return res;\n          throw UnexpectedHere(\"body-fld-dsp: not a list / nil\", line, start);\n      }\n      QVariantList list = input.toList();\n      if (list.size() != 2)\n          throw ParseError(\"body-fld-dsp: wrong number of entries in the list\", line, start);\n      if (list[0].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"body-fld-dsp: first item is not a string\", line, start);\n      res.first = list[0].toByteArray();\n      res.second = makeBodyFldParam(list[1], line, start);\n      return res;\n  }\n}"
  },
  {
    "function_name": "makeBodyFldParam(",
    "container": "bstractMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "312-329",
    "snippet": "bstractMessage::bodyFldParam_t AbstractMessage::makeBodyFldParam(const QVariant &input, const QByteArray &line, const int start)\n{\n    bodyFldParam_t map;\n    if (input.type() != QVariant::List) {\n        if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n            return map;\n        throw UnexpectedHere(\"body-fld-param: not a list / nil\", line, start);\n    }\n    QVariantList list = input.toList();\n    if (list.size() % 2)\n        throw UnexpectedHere(\"body-fld-param: wrong number of entries\", line, start);\n    for (int j = 0; j < list.size(); j += 2)\n        if (list[j].type() != QVariant::ByteArray || list[j+1].type() != QVariant::ByteArray)\n            throw UnexpectedHere(\"body-fld-param: string not found\", line, start);\n        else\n            map[ list[j].toByteArray().toUpper() ] = list[j+1].toByteArray();\n    return map;\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ist[j+1].toByteArray",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist[j].toByteArray",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist[j].toByteArray",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-param: string not found\",",
            "ine,",
            "tart)"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist[j+1].type",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ist.size",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-param: wrong number of entries\",",
            "ine,",
            "tart)"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist.size",
          "args": [],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toList",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "body-fld-param: not a list / nil\",",
            "ine,",
            "tart)"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toByteArray",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput.toByteArray",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nbstractMessage {\n  bstractMessage::bodyFldParam_t AbstractMessage::makeBodyFldParam(const QVariant &input, const QByteArray &line, const int start)\n  {\n      bodyFldParam_t map;\n      if (input.type() != QVariant::List) {\n          if (input.type() == QVariant::ByteArray && input.toByteArray().isNull())\n              return map;\n          throw UnexpectedHere(\"body-fld-param: not a list / nil\", line, start);\n      }\n      QVariantList list = input.toList();\n      if (list.size() % 2)\n          throw UnexpectedHere(\"body-fld-param: wrong number of entries\", line, start);\n      for (int j = 0; j < list.size(); j += 2)\n          if (list[j].type() != QVariant::ByteArray || list[j+1].type() != QVariant::ByteArray)\n              throw UnexpectedHere(\"body-fld-param: string not found\", line, start);\n          else\n              map[ list[j].toByteArray().toUpper() ] = list[j+1].toByteArray();\n      return map;\n  }\n}"
  },
  {
    "function_name": "eq(",
    "container": "ultiMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "257-287",
    "snippet": "ool MultiMessage::eq(const AbstractData &other) const\n{\n    try {\n        const MultiMessage &o = dynamic_cast<const MultiMessage &>(other);\n\n        if (bodies.count() != o.bodies.count()) {\n            return false;\n        }\n\n        for (int i = 0; i < bodies.count(); ++i) {\n            if (bodies[i]) {\n                if (o.bodies[i]) {\n                    if (*bodies[i] != *o.bodies[i]) {\n                        return false;\n                    }\n                } else {\n                    return false;\n                }\n            } else if (! o.bodies[i]) {\n                return false;\n            }\n        }\n\n        return mediaSubType == o.mediaSubType && bodyFldParam == o.bodyFldParam &&\n               bodyFldDsp == o.bodyFldDsp && bodyFldLang == o.bodyFldLang &&\n               bodyFldLoc == o.bodyFldLoc && bodyExtension == o.bodyExtension;\n\n    } catch (std::bad_cast &) {\n        return false;\n    }\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "odies.count",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ynamic_cast<const MultiMessage &>",
          "args": [
            "ther)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nultiMessage {\n  ool MultiMessage::eq(const AbstractData &other) const\n  {\n      try {\n          const MultiMessage &o = dynamic_cast<const MultiMessage &>(other);\n  \n          if (bodies.count() != o.bodies.count()) {\n              return false;\n          }\n  \n          for (int i = 0; i < bodies.count(); ++i) {\n              if (bodies[i]) {\n                  if (o.bodies[i]) {\n                      if (*bodies[i] != *o.bodies[i]) {\n                          return false;\n                      }\n                  } else {\n                      return false;\n                  }\n              } else if (! o.bodies[i]) {\n                  return false;\n              }\n          }\n  \n          return mediaSubType == o.mediaSubType && bodyFldParam == o.bodyFldParam &&\n                 bodyFldDsp == o.bodyFldDsp && bodyFldLang == o.bodyFldLang &&\n                 bodyFldLoc == o.bodyFldLoc && bodyExtension == o.bodyExtension;\n  \n      } catch (std::bad_cast &) {\n          return false;\n      }\n  }\n}"
  },
  {
    "function_name": "eq(",
    "container": "sgMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "183-205",
    "snippet": "ool MsgMessage::eq(const AbstractData &other) const\n{\n    try {\n        const MsgMessage &o = dynamic_cast<const MsgMessage &>(other);\n        if (o.body) {\n            if (body) {\n                if (*body != *o.body) {\n                    return false;\n                }\n            } else {\n                return false;\n            }\n        } else if (body) {\n            return false;\n        }\n\n        return OneMessage::eq(o) && bodyFldLines == o.bodyFldLines &&\n               envelope == o.envelope;\n\n    } catch (std::bad_cast &) {\n        return false;\n    }\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "neMessage::eq(",
          "args": [
            ")"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "eq(",
          "container": "neMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "137-150",
          "snippet": "ool OneMessage::eq(const AbstractData &other) const\n{\n    try {\n        const OneMessage &o = dynamic_cast<const OneMessage &>(other);\n        return o.mediaType == mediaType && mediaSubType == o.mediaSubType &&\n               bodyFldParam == o.bodyFldParam && bodyFldId == o.bodyFldId &&\n               bodyFldDesc == o.bodyFldDesc && bodyFldEnc == o.bodyFldEnc &&\n               bodyFldOctets == o.bodyFldOctets && bodyFldMd5 == o.bodyFldMd5 &&\n               bodyFldDsp == o.bodyFldDsp && bodyFldLang == o.bodyFldLang &&\n               bodyFldLoc == o.bodyFldLoc && bodyExtension == o.bodyExtension;\n    } catch (std::bad_cast &) {\n        return false;\n    }\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nneMessage {\n  ool OneMessage::eq(const AbstractData &other) const\n  {\n      try {\n          const OneMessage &o = dynamic_cast<const OneMessage &>(other);\n          return o.mediaType == mediaType && mediaSubType == o.mediaSubType &&\n                 bodyFldParam == o.bodyFldParam && bodyFldId == o.bodyFldId &&\n                 bodyFldDesc == o.bodyFldDesc && bodyFldEnc == o.bodyFldEnc &&\n                 bodyFldOctets == o.bodyFldOctets && bodyFldMd5 == o.bodyFldMd5 &&\n                 bodyFldDsp == o.bodyFldDsp && bodyFldLang == o.bodyFldLang &&\n                 bodyFldLoc == o.bodyFldLoc && bodyExtension == o.bodyExtension;\n      } catch (std::bad_cast &) {\n          return false;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ynamic_cast<const MsgMessage &>",
          "args": [
            "ther)"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nsgMessage {\n  ool MsgMessage::eq(const AbstractData &other) const\n  {\n      try {\n          const MsgMessage &o = dynamic_cast<const MsgMessage &>(other);\n          if (o.body) {\n              if (body) {\n                  if (*body != *o.body) {\n                      return false;\n                  }\n              } else {\n                  return false;\n              }\n          } else if (body) {\n              return false;\n          }\n  \n          return OneMessage::eq(o) && bodyFldLines == o.bodyFldLines &&\n                 envelope == o.envelope;\n  \n      } catch (std::bad_cast &) {\n          return false;\n      }\n  }\n}"
  },
  {
    "function_name": "eq(",
    "container": "extMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "152-160",
    "snippet": "ool TextMessage::eq(const AbstractData &other) const\n{\n    try {\n        const TextMessage &o = dynamic_cast<const TextMessage &>(other);\n        return OneMessage::eq(o) && bodyFldLines == o.bodyFldLines;\n    } catch (std::bad_cast &) {\n        return false;\n    }\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "neMessage::eq(",
          "args": [
            ")"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "eq(",
          "container": "neMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "137-150",
          "snippet": "ool OneMessage::eq(const AbstractData &other) const\n{\n    try {\n        const OneMessage &o = dynamic_cast<const OneMessage &>(other);\n        return o.mediaType == mediaType && mediaSubType == o.mediaSubType &&\n               bodyFldParam == o.bodyFldParam && bodyFldId == o.bodyFldId &&\n               bodyFldDesc == o.bodyFldDesc && bodyFldEnc == o.bodyFldEnc &&\n               bodyFldOctets == o.bodyFldOctets && bodyFldMd5 == o.bodyFldMd5 &&\n               bodyFldDsp == o.bodyFldDsp && bodyFldLang == o.bodyFldLang &&\n               bodyFldLoc == o.bodyFldLoc && bodyExtension == o.bodyExtension;\n    } catch (std::bad_cast &) {\n        return false;\n    }\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nneMessage {\n  ool OneMessage::eq(const AbstractData &other) const\n  {\n      try {\n          const OneMessage &o = dynamic_cast<const OneMessage &>(other);\n          return o.mediaType == mediaType && mediaSubType == o.mediaSubType &&\n                 bodyFldParam == o.bodyFldParam && bodyFldId == o.bodyFldId &&\n                 bodyFldDesc == o.bodyFldDesc && bodyFldEnc == o.bodyFldEnc &&\n                 bodyFldOctets == o.bodyFldOctets && bodyFldMd5 == o.bodyFldMd5 &&\n                 bodyFldDsp == o.bodyFldDsp && bodyFldLang == o.bodyFldLang &&\n                 bodyFldLoc == o.bodyFldLoc && bodyExtension == o.bodyExtension;\n      } catch (std::bad_cast &) {\n          return false;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ynamic_cast<const TextMessage &>",
          "args": [
            "ther)"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nextMessage {\n  ool TextMessage::eq(const AbstractData &other) const\n  {\n      try {\n          const TextMessage &o = dynamic_cast<const TextMessage &>(other);\n          return OneMessage::eq(o) && bodyFldLines == o.bodyFldLines;\n      } catch (std::bad_cast &) {\n          return false;\n      }\n  }\n}"
  },
  {
    "function_name": "eq(",
    "container": "neMessage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "137-150",
    "snippet": "ool OneMessage::eq(const AbstractData &other) const\n{\n    try {\n        const OneMessage &o = dynamic_cast<const OneMessage &>(other);\n        return o.mediaType == mediaType && mediaSubType == o.mediaSubType &&\n               bodyFldParam == o.bodyFldParam && bodyFldId == o.bodyFldId &&\n               bodyFldDesc == o.bodyFldDesc && bodyFldEnc == o.bodyFldEnc &&\n               bodyFldOctets == o.bodyFldOctets && bodyFldMd5 == o.bodyFldMd5 &&\n               bodyFldDsp == o.bodyFldDsp && bodyFldLang == o.bodyFldLang &&\n               bodyFldLoc == o.bodyFldLoc && bodyExtension == o.bodyExtension;\n    } catch (std::bad_cast &) {\n        return false;\n    }\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ynamic_cast<const OneMessage &>",
          "args": [
            "ther)"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nneMessage {\n  ool OneMessage::eq(const AbstractData &other) const\n  {\n      try {\n          const OneMessage &o = dynamic_cast<const OneMessage &>(other);\n          return o.mediaType == mediaType && mediaSubType == o.mediaSubType &&\n                 bodyFldParam == o.bodyFldParam && bodyFldId == o.bodyFldId &&\n                 bodyFldDesc == o.bodyFldDesc && bodyFldEnc == o.bodyFldEnc &&\n                 bodyFldOctets == o.bodyFldOctets && bodyFldMd5 == o.bodyFldMd5 &&\n                 bodyFldDsp == o.bodyFldDsp && bodyFldLang == o.bodyFldLang &&\n                 bodyFldLoc == o.bodyFldLoc && bodyExtension == o.bodyExtension;\n      } catch (std::bad_cast &) {\n          return false;\n      }\n  }\n}"
  },
  {
    "function_name": "clear(",
    "container": "nvelope",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "123-135",
    "snippet": "oid Envelope::clear()\n{\n    date = QDateTime();\n    subject.clear();\n    from.clear();\n    sender.clear();\n    replyTo.clear();\n    to.clear();\n    cc.clear();\n    bcc.clear();\n    inReplyTo.clear();\n    messageId.clear();\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "essageId.clear",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "o.clear",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeAllGlobPatterns",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "233-238",
          "snippet": "void QMimeAllGlobPatterns::clear()\n{\n    m_fastPatterns.clear();\n    m_highWeightGlobs.clear();\n    m_lowWeightGlobs.clear();\n}",
          "includes": [
            "#include <QDebug>",
            "#include <QStringList>",
            "#include <QRegExp>",
            "#include \"qmimeglobpattern_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeAllGlobPatterns {\n  void QMimeAllGlobPatterns::clear()\n  {\n      m_fastPatterns.clear();\n      m_highWeightGlobs.clear();\n      m_lowWeightGlobs.clear();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "DateTime(",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nnvelope {\n  oid Envelope::clear()\n  {\n      date = QDateTime();\n      subject.clear();\n      from.clear();\n      sender.clear();\n      replyTo.clear();\n      to.clear();\n      cc.clear();\n      bcc.clear();\n      inReplyTo.clear();\n      messageId.clear();\n  }\n}"
  },
  {
    "function_name": "fromList(",
    "container": "nvelope",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "65-121",
    "snippet": "nvelope Envelope::fromList(const QVariantList &items, const QByteArray &line, const int start)\n{\n    if (items.size() != 10)\n        throw ParseError(\"Envelope::fromList: size != 10\", line, start);   // FIXME: wrong offset\n\n    // date\n    QDateTime date;\n    if (items[0].type() == QVariant::ByteArray) {\n        QByteArray dateStr = items[0].toByteArray();\n        if (! dateStr.isEmpty()) {\n            try {\n                date = LowLevelParser::parseRFC2822DateTime(dateStr);\n            } catch (ParseError &) {\n                // FIXME: log this\n                //throw ParseError( e.what(), line, start );\n            }\n        }\n    }\n    // Otherwise it's \"invalid\", null.\n\n    QString subject = Imap::decodeRFC2047String(items[1].toByteArray());\n\n    QList<MailAddress> from, sender, replyTo, to, cc, bcc;\n    from = Envelope::getListOfAddresses(items[2], line, start);\n    sender = Envelope::getListOfAddresses(items[3], line, start);\n    replyTo = Envelope::getListOfAddresses(items[4], line, start);\n    to = Envelope::getListOfAddresses(items[5], line, start);\n    cc = Envelope::getListOfAddresses(items[6], line, start);\n    bcc = Envelope::getListOfAddresses(items[7], line, start);\n\n    LowLevelParser::Rfc5322HeaderParser headerParser;\n\n    if (items[8].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"Envelope::fromList: inReplyTo not a QByteArray\", line, start);\n    QByteArray inReplyTo = items[8].toByteArray();\n\n    if (items[9].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"Envelope::fromList: messageId not a QByteArray\", line, start);\n    QByteArray messageId = items[9].toByteArray();\n\n    QByteArray buf;\n    if (!messageId.isEmpty())\n        buf += \"Message-Id: \" + messageId + \"\\r\\n\";\n    if (!inReplyTo.isEmpty())\n        buf += \"In-Reply-To: \" + inReplyTo + \"\\r\\n\";\n    if (!buf.isEmpty()) {\n        bool ok = headerParser.parse(buf);\n        if (!ok) {\n            qDebug() << \"Envelope::fromList: malformed headers\";\n        }\n    }\n    // If the Message-Id fails to parse, well, bad luck. This enforced sanitizaion is hopefully better than\n    // generating garbage in outgoing e-mails.\n    messageId = headerParser.messageId.size() == 1 ? headerParser.messageId.front() : QByteArray();\n\n    return Envelope(date, subject, from, sender, replyTo, to, cc, bcc, headerParser.inReplyTo, messageId);\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nvelope(",
          "args": [
            "ate,",
            "ubject,",
            "rom,",
            "ender,",
            "eplyTo,",
            "o,",
            "c,",
            "cc,",
            "eaderParser.inReplyTo,",
            "essageId)"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "nvelope(",
          "container": "nvelope ",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.h",
          "lines": "67-73",
          "snippet": "nvelope(const QDateTime &_date, const QString &_subject, const QList<MailAddress> &_from,\n             const QList<MailAddress> &_sender, const QList<MailAddress> &_replyTo,\n             const QList<MailAddress> &_to, const QList<MailAddress> &_cc,\n             const QList<MailAddress> &_bcc, const QList<QByteArray> &_inReplyTo,\n             const QByteArray &_messageId):\n        date(_date), subject(_subject), from(_from), sender(_sender), replyTo(_replyTo),\n        to(_to), cc(_cc), bcc(_bcc), inReplyTo(_inReplyTo), messageId(_messageId) {}",
          "includes": [
            "include \"../Model/MailboxTreeFwd.h\"",
            "include \"MailAddress.h\"\n#",
            "include \"../Exceptions.h\"\n#",
            "include \"Data.h\"\n#",
            "include <QPair>\n#",
            "include <QString>\n#",
            "include <QDateTime>\n#",
            "include <QVariant>\n#",
            "include <QDebug>\n#",
            "include <QByteArray>\n#",
            "include <QSharedPointer>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Model/MailboxTreeFwd.h\"\ninclude \"MailAddress.h\"\n#\ninclude \"../Exceptions.h\"\n#\ninclude \"Data.h\"\n#\ninclude <QPair>\n#\ninclude <QString>\n#\ninclude <QDateTime>\n#\ninclude <QVariant>\n#\ninclude <QDebug>\n#\ninclude <QByteArray>\n#\ninclude <QSharedPointer>\n#\n\nnvelope  {\n  nvelope(const QDateTime &_date, const QString &_subject, const QList<MailAddress> &_from,\n               const QList<MailAddress> &_sender, const QList<MailAddress> &_replyTo,\n               const QList<MailAddress> &_to, const QList<MailAddress> &_cc,\n               const QList<MailAddress> &_bcc, const QList<QByteArray> &_inReplyTo,\n               const QByteArray &_messageId):\n          date(_date), subject(_subject), from(_from), sender(_sender), replyTo(_replyTo),\n          to(_to), cc(_cc), bcc(_bcc), inReplyTo(_inReplyTo), messageId(_messageId) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ByteArray(",
          "args": [],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "toByteArray(",
          "container": "equence",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Sequence.cpp",
          "lines": "43-79",
          "snippet": "ByteArray Sequence::toByteArray() const\n{\n    switch (kind) {\n    case DISTINCT:\n    {\n        Q_ASSERT(! list.isEmpty());\n\n        QStringList res;\n        int i = 0;\n        while (i < list.size()) {\n            int old = i;\n            while (i < list.size() - 1 &&\n                   list[i] == list[ i + 1 ] - 1)\n                ++i;\n            if (old != i) {\n                // we've found a sequence\n                res << QString::number(list[old]) + QLatin1Char(':') + QString::number(list[i]);\n            } else {\n                res << QString::number(list[i]);\n            }\n            ++i;\n        }\n        return res.join(QLatin1String(\",\")).toLocal8Bit();\n    }\n    case RANGE:\n        Q_ASSERT(lo <= hi);\n        if (lo == hi)\n            return QByteArray::number(lo);\n        else\n            return QByteArray::number(lo) + ':' + QByteArray::number(hi);\n    case UNLIMITED:\n        return QByteArray::number(lo) + \":*\";\n    }\n    // fix gcc warning\n    Q_ASSERT(false);\n    return QByteArray();\n}",
          "includes": [
            "include <QTextStream>",
            "include <QStringList>\n#",
            "include \"Sequence.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QTextStream>\ninclude <QStringList>\n#\ninclude \"Sequence.h\"\n#\n\nequence {\n  ByteArray Sequence::toByteArray() const\n  {\n      switch (kind) {\n      case DISTINCT:\n      {\n          Q_ASSERT(! list.isEmpty());\n  \n          QStringList res;\n          int i = 0;\n          while (i < list.size()) {\n              int old = i;\n              while (i < list.size() - 1 &&\n                     list[i] == list[ i + 1 ] - 1)\n                  ++i;\n              if (old != i) {\n                  // we've found a sequence\n                  res << QString::number(list[old]) + QLatin1Char(':') + QString::number(list[i]);\n              } else {\n                  res << QString::number(list[i]);\n              }\n              ++i;\n          }\n          return res.join(QLatin1String(\",\")).toLocal8Bit();\n      }\n      case RANGE:\n          Q_ASSERT(lo <= hi);\n          if (lo == hi)\n              return QByteArray::number(lo);\n          else\n              return QByteArray::number(lo) + ':' + QByteArray::number(hi);\n      case UNLIMITED:\n          return QByteArray::number(lo) + \":*\";\n      }\n      // fix gcc warning\n      Q_ASSERT(false);\n      return QByteArray();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eaderParser.messageId.front",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderParser.messageId.size",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderParser.parse",
          "args": [
            "uf)"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "parse(",
          "container": "fc5322HeaderParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Rfc5322HeaderParser.cpp",
          "lines": "159-175",
          "snippet": "ool Rfc5322HeaderParser::parse(const QByteArray &data)\n{\n    clear();\n\n    const char *p = data.constData();\n    const char *pe = p + data.length();\n    const char *eof = pe;\n    int cs;\n\n    QByteArray str;\n    QList<QByteArray> list;\n\n    %% write init;\n    %% write exec;\n\n    return !m_error;\n}",
          "includes": [
            "include <iostream>\ni",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <iostream>\ni\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\ninclude <QDebug>\n#\n\nfc5322HeaderParser {\n  ool Rfc5322HeaderParser::parse(const QByteArray &data)\n  {\n      clear();\n  \n      const char *p = data.constData();\n      const char *pe = p + data.length();\n      const char *eof = pe;\n      int cs;\n  \n      QByteArray str;\n      QList<QByteArray> list;\n  \n      %% write init;\n      %% write exec;\n  \n      return !m_error;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "uf.isEmpty",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nReplyTo.isEmpty",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essageId.isEmpty",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[9].toByteArray",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "Envelope::fromList: messageId not a QByteArray\",",
            "ine,",
            "tart)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[9].type",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems[8].toByteArray",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "Envelope::fromList: inReplyTo not a QByteArray\",",
            "ine,",
            "tart)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nvelope::getListOfAddresses(",
          "args": [
            "tems[7],",
            "ine,",
            "tart)"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "getListOfAddresses(",
          "container": "nvelope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
          "lines": "46-63",
          "snippet": "List<MailAddress> Envelope::getListOfAddresses(const QVariant &in, const QByteArray &line, const int start)\n{\n    if (in.type() == QVariant::ByteArray) {\n        if (! in.toByteArray().isNull())\n            throw UnexpectedHere(\"getListOfAddresses: byte array not null\", line, start);\n    } else if (in.type() != QVariant::List) {\n        throw ParseError(\"getListOfAddresses: not a list\", line, start);\n    }\n\n    QVariantList list = in.toList();\n    QList<MailAddress> res;\n    for (QVariantList::const_iterator it = list.constBegin(); it != list.constEnd(); ++it) {\n        if (it->type() != QVariant::List)\n            throw UnexpectedHere(\"getListOfAddresses: split item not a list\", line, start);   // FIXME: wrong offset\n        res.append(MailAddress(it->toList(), line, start));\n    }\n    return res;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include \"Message.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nnvelope {\n  List<MailAddress> Envelope::getListOfAddresses(const QVariant &in, const QByteArray &line, const int start)\n  {\n      if (in.type() == QVariant::ByteArray) {\n          if (! in.toByteArray().isNull())\n              throw UnexpectedHere(\"getListOfAddresses: byte array not null\", line, start);\n      } else if (in.type() != QVariant::List) {\n          throw ParseError(\"getListOfAddresses: not a list\", line, start);\n      }\n  \n      QVariantList list = in.toList();\n      QList<MailAddress> res;\n      for (QVariantList::const_iterator it = list.constBegin(); it != list.constEnd(); ++it) {\n          if (it->type() != QVariant::List)\n              throw UnexpectedHere(\"getListOfAddresses: split item not a list\", line, start);   // FIXME: wrong offset\n          res.append(MailAddress(it->toList(), line, start));\n      }\n      return res;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "map::decodeRFC2047String(",
          "args": [
            "tems[1].toByteArray())"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[1].toByteArray",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "owLevelParser::parseRFC2822DateTime(",
          "args": [
            "ateStr)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ateStr.isEmpty",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[0].toByteArray",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arseError(",
          "args": [
            "Envelope::fromList: size != 10\",",
            "ine,",
            "tart)"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nnvelope {\n  nvelope Envelope::fromList(const QVariantList &items, const QByteArray &line, const int start)\n  {\n      if (items.size() != 10)\n          throw ParseError(\"Envelope::fromList: size != 10\", line, start);   // FIXME: wrong offset\n  \n      // date\n      QDateTime date;\n      if (items[0].type() == QVariant::ByteArray) {\n          QByteArray dateStr = items[0].toByteArray();\n          if (! dateStr.isEmpty()) {\n              try {\n                  date = LowLevelParser::parseRFC2822DateTime(dateStr);\n              } catch (ParseError &) {\n                  // FIXME: log this\n                  //throw ParseError( e.what(), line, start );\n              }\n          }\n      }\n      // Otherwise it's \"invalid\", null.\n  \n      QString subject = Imap::decodeRFC2047String(items[1].toByteArray());\n  \n      QList<MailAddress> from, sender, replyTo, to, cc, bcc;\n      from = Envelope::getListOfAddresses(items[2], line, start);\n      sender = Envelope::getListOfAddresses(items[3], line, start);\n      replyTo = Envelope::getListOfAddresses(items[4], line, start);\n      to = Envelope::getListOfAddresses(items[5], line, start);\n      cc = Envelope::getListOfAddresses(items[6], line, start);\n      bcc = Envelope::getListOfAddresses(items[7], line, start);\n  \n      LowLevelParser::Rfc5322HeaderParser headerParser;\n  \n      if (items[8].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"Envelope::fromList: inReplyTo not a QByteArray\", line, start);\n      QByteArray inReplyTo = items[8].toByteArray();\n  \n      if (items[9].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"Envelope::fromList: messageId not a QByteArray\", line, start);\n      QByteArray messageId = items[9].toByteArray();\n  \n      QByteArray buf;\n      if (!messageId.isEmpty())\n          buf += \"Message-Id: \" + messageId + \"\\r\\n\";\n      if (!inReplyTo.isEmpty())\n          buf += \"In-Reply-To: \" + inReplyTo + \"\\r\\n\";\n      if (!buf.isEmpty()) {\n          bool ok = headerParser.parse(buf);\n          if (!ok) {\n              qDebug() << \"Envelope::fromList: malformed headers\";\n          }\n      }\n      // If the Message-Id fails to parse, well, bad luck. This enforced sanitizaion is hopefully better than\n      // generating garbage in outgoing e-mails.\n      messageId = headerParser.messageId.size() == 1 ? headerParser.messageId.front() : QByteArray();\n  \n      return Envelope(date, subject, from, sender, replyTo, to, cc, bcc, headerParser.inReplyTo, messageId);\n  }\n}"
  },
  {
    "function_name": "getListOfAddresses(",
    "container": "nvelope",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Message.cpp",
    "lines": "46-63",
    "snippet": "List<MailAddress> Envelope::getListOfAddresses(const QVariant &in, const QByteArray &line, const int start)\n{\n    if (in.type() == QVariant::ByteArray) {\n        if (! in.toByteArray().isNull())\n            throw UnexpectedHere(\"getListOfAddresses: byte array not null\", line, start);\n    } else if (in.type() != QVariant::List) {\n        throw ParseError(\"getListOfAddresses: not a list\", line, start);\n    }\n\n    QVariantList list = in.toList();\n    QList<MailAddress> res;\n    for (QVariantList::const_iterator it = list.constBegin(); it != list.constEnd(); ++it) {\n        if (it->type() != QVariant::List)\n            throw UnexpectedHere(\"getListOfAddresses: split item not a list\", line, start);   // FIXME: wrong offset\n        res.append(MailAddress(it->toList(), line, start));\n    }\n    return res;\n}",
    "includes": [
      "include \"../Parser/Rfc5322HeaderParser.h\"",
      "include \"../Encoders.h\"\n#",
      "include \"../Model/MailboxTree.h\"\n#",
      "include \"LowLevelParser.h\"\n#",
      "include \"MailAddress.h\"\n#",
      "include \"Message.h\"\n#",
      "include <QTextCodec>\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QTextDocument>\n#",
      "include <typeinfo>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "es.append",
          "args": [
            "ailAddress(it->toList(), line, start))"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailAddress(",
          "args": [
            "t->toList(),",
            "ine,",
            "tart)"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "MailAddress(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "95-114",
          "snippet": "ailAddress::MailAddress(const QVariantList &input, const QByteArray &line, const int start)\n{\n    // FIXME: all offsets are wrong here\n    if (input.size() != 4)\n        throw ParseError(\"MailAddress: not four items\", line, start);\n\n    if (input[0].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"MailAddress: item#1 not a QByteArray\", line, start);\n    if (input[1].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"MailAddress: item#2 not a QByteArray\", line, start);\n    if (input[2].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"MailAddress: item#3 not a QByteArray\", line, start);\n    if (input[3].type() != QVariant::ByteArray)\n        throw UnexpectedHere(\"MailAddress: item#4 not a QByteArray\", line, start);\n\n    name = Imap::decodeRFC2047String(input[0].toByteArray());\n    adl = Imap::decodeRFC2047String(input[1].toByteArray());\n    mailbox = Imap::decodeRFC2047String(input[2].toByteArray());\n    host = Imap::decodeRFC2047String(input[3].toByteArray());\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ailAddress::MailAddress(const QVariantList &input, const QByteArray &line, const int start)\n  {\n      // FIXME: all offsets are wrong here\n      if (input.size() != 4)\n          throw ParseError(\"MailAddress: not four items\", line, start);\n  \n      if (input[0].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"MailAddress: item#1 not a QByteArray\", line, start);\n      if (input[1].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"MailAddress: item#2 not a QByteArray\", line, start);\n      if (input[2].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"MailAddress: item#3 not a QByteArray\", line, start);\n      if (input[3].type() != QVariant::ByteArray)\n          throw UnexpectedHere(\"MailAddress: item#4 not a QByteArray\", line, start);\n  \n      name = Imap::decodeRFC2047String(input[0].toByteArray());\n      adl = Imap::decodeRFC2047String(input[1].toByteArray());\n      mailbox = Imap::decodeRFC2047String(input[2].toByteArray());\n      host = Imap::decodeRFC2047String(input[3].toByteArray());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "t->toList",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "getListOfAddresses: split item not a list\",",
            "ine,",
            "tart)"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->type",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ist.constEnd",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist.constBegin",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "n.toList",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arseError(",
          "args": [
            "getListOfAddresses: not a list\",",
            "ine,",
            "tart)"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nexpectedHere(",
          "args": [
            "getListOfAddresses: byte array not null\",",
            "ine,",
            "tart)"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "n.toByteArray",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "n.toByteArray",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude \"Message.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nnvelope {\n  List<MailAddress> Envelope::getListOfAddresses(const QVariant &in, const QByteArray &line, const int start)\n  {\n      if (in.type() == QVariant::ByteArray) {\n          if (! in.toByteArray().isNull())\n              throw UnexpectedHere(\"getListOfAddresses: byte array not null\", line, start);\n      } else if (in.type() != QVariant::List) {\n          throw ParseError(\"getListOfAddresses: not a list\", line, start);\n      }\n  \n      QVariantList list = in.toList();\n      QList<MailAddress> res;\n      for (QVariantList::const_iterator it = list.constBegin(); it != list.constEnd(); ++it) {\n          if (it->type() != QVariant::List)\n              throw UnexpectedHere(\"getListOfAddresses: split item not a list\", line, start);   // FIXME: wrong offset\n          res.append(MailAddress(it->toList(), line, start));\n      }\n      return res;\n  }\n}"
  }
]