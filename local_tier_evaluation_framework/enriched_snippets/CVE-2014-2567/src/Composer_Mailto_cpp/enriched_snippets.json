[
  {
    "function_name": "arseRFC6068Mailto(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Mailto.cpp",
    "lines": "73-121",
    "snippet": "oid parseRFC6068Mailto(const QUrl &url, QString &subject, QString &body,\n                        QList<QPair<Composer::RecipientKind, QString>> &recipients,\n                        QList<QByteArray> &inReplyTo, QList<QByteArray> &references)\n{\n    if (url.isEmpty() || url.scheme() != QLatin1String(\"mailto\"))\n        return;\n\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    const QByteArray &encodedPath = url.encodedPath();\n#else\n    const QByteArray &encodedPath = url.path(QUrl::FullyEncoded).toUtf8();\n#endif\n\n    Q_FOREACH(const QString &addr, stringListFromRFC2047PercentEncoding(encodedPath)) {\n        recipients << qMakePair(Composer::ADDRESS_TO, addr);\n    }\n\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    const QList<QPair<QByteArray,QByteArray>> &items = url.encodedQueryItems();\n#else\n    const QList<QPair<QString,QString>> &stringItems = QUrlQuery(url).queryItems(QUrl::FullyEncoded);\n    QList<QPair<QByteArray,QByteArray>> items;\n    for (int i = 0; i < stringItems.size(); ++i) {\n        items << qMakePair(stringItems[i].first.toUtf8(), stringItems[i].second.toUtf8());\n    }\n#endif\n\n    for (int i = 0; i < items.size(); ++i) {\n        if (items[i].first.toLower() == \"to\") {\n            Q_FOREACH(const QString &addr, stringListFromRFC2047PercentEncoding(items[i].second))\n                recipients << qMakePair(Composer::ADDRESS_TO, addr);\n        } else if (items[i].first.toLower() == \"cc\") {\n            Q_FOREACH(const QString &addr, stringListFromRFC2047PercentEncoding(items[i].second))\n                recipients << qMakePair(Composer::ADDRESS_CC, addr);\n        } else if (items[i].first.toLower() == \"bcc\") {\n            Q_FOREACH(const QString &addr, stringListFromRFC2047PercentEncoding(items[i].second))\n                recipients << qMakePair(Composer::ADDRESS_BCC, addr);\n        } else if (items[i].first.toLower() == \"subject\") {\n            subject = fromRFC2047PercentEncoding(items[i].second);\n        } else if (items[i].first.toLower() == \"body\") {\n            // RFC 6080: Body does not contain MIME encoded words\n            body = QUrl::fromPercentEncoding(items[i].second);\n        } else if (items[i].first.toLower() == \"in-reply-to\") {\n            inReplyTo << arrayListFromPercentEncoding(items[i].second);\n        } else if (items[i].first.toLower() == \"references\") {\n            references << arrayListFromPercentEncoding(items[i].second);\n        }\n    }\n}",
    "includes": [
      "include \"Imap/Encoders.h\"",
      "include \"Recipients.h\"",
      "include \"Mailto.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QStringList>\n#",
      "include <QString>\n#",
      "include <QPair>\n#",
      "include <QList>\n#",
      "include <QByteArray>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rrayListFromPercentEncoding(",
          "args": [
            "tems[i].second)"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "rrayListFromPercentEncoding(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Mailto.cpp",
          "lines": "57-67",
          "snippet": "List<QByteArray> arrayListFromPercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QList<QByteArray> ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << QByteArray::fromPercentEncoding(a);\n    }\n    return ret;\n}",
          "includes": [
            "include \"Imap/Encoders.h\"",
            "include \"Recipients.h\"",
            "include \"Mailto.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QStringList>\n#",
            "include <QString>\n#",
            "include <QPair>\n#",
            "include <QList>\n#",
            "include <QByteArray>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Encoders.h\"\ninclude \"Recipients.h\"\ninclude \"Mailto.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QStringList>\n#\ninclude <QString>\n#\ninclude <QPair>\n#\ninclude <QList>\n#\ninclude <QByteArray>\n#\n\nList<QByteArray> arrayListFromPercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QList<QByteArray> ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << QByteArray::fromPercentEncoding(a);\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems[i].first.toLower",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].first.toLower",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Url::fromPercentEncoding(",
          "args": [
            "tems[i].second)"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].first.toLower",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "romRFC2047PercentEncoding(",
          "args": [
            "tems[i].second)"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "tringListFromRFC2047PercentEncoding(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Mailto.cpp",
          "lines": "45-55",
          "snippet": "StringList stringListFromRFC2047PercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QStringList ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << fromRFC2047PercentEncoding(a);\n    }\n    return ret;\n}",
          "includes": [
            "include \"Imap/Encoders.h\"",
            "include \"Recipients.h\"",
            "include \"Mailto.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QStringList>\n#",
            "include <QString>\n#",
            "include <QPair>\n#",
            "include <QList>\n#",
            "include <QByteArray>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Encoders.h\"\ninclude \"Recipients.h\"\ninclude \"Mailto.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QStringList>\n#\ninclude <QString>\n#\ninclude <QPair>\n#\ninclude <QList>\n#\ninclude <QByteArray>\n#\n\nStringList stringListFromRFC2047PercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QStringList ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << fromRFC2047PercentEncoding(a);\n    }\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "tems[i].first.toLower",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakePair(",
          "args": [
            "omposer::ADDRESS_BCC,",
            "ddr)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].first.toLower",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakePair(",
          "args": [
            "omposer::ADDRESS_CC,",
            "ddr)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].first.toLower",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakePair(",
          "args": [
            "omposer::ADDRESS_TO,",
            "ddr)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems[i].first.toLower",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tems.size",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakePair(",
          "args": [
            "tringItems[i].first.toUtf8(),",
            "tringItems[i].second.toUtf8())"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tringItems[i].second.toUtf8",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tringItems[i].first.toUtf8",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tringItems.size",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UrlQuery",
          "args": [
            "Url::FullyEncoded)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UrlQuery(",
          "args": [
            "rl)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.encodedQueryItems",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakePair(",
          "args": [
            "omposer::ADDRESS_TO,",
            "ddr)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.path",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.path",
          "args": [
            "Url::FullyEncoded)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.encodedPath",
          "args": [],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mailto\")"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.isEmpty",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Encoders.h\"\ninclude \"Recipients.h\"\ninclude \"Mailto.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QStringList>\n#\ninclude <QString>\n#\ninclude <QPair>\n#\ninclude <QList>\n#\ninclude <QByteArray>\n#\n\noid parseRFC6068Mailto(const QUrl &url, QString &subject, QString &body,\n                        QList<QPair<Composer::RecipientKind, QString>> &recipients,\n                        QList<QByteArray> &inReplyTo, QList<QByteArray> &references)\n{\n    if (url.isEmpty() || url.scheme() != QLatin1String(\"mailto\"))\n        return;\n\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    const QByteArray &encodedPath = url.encodedPath();\n#else\n    const QByteArray &encodedPath = url.path(QUrl::FullyEncoded).toUtf8();\n#endif\n\n    Q_FOREACH(const QString &addr, stringListFromRFC2047PercentEncoding(encodedPath)) {\n        recipients << qMakePair(Composer::ADDRESS_TO, addr);\n    }\n\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    const QList<QPair<QByteArray,QByteArray>> &items = url.encodedQueryItems();\n#else\n    const QList<QPair<QString,QString>> &stringItems = QUrlQuery(url).queryItems(QUrl::FullyEncoded);\n    QList<QPair<QByteArray,QByteArray>> items;\n    for (int i = 0; i < stringItems.size(); ++i) {\n        items << qMakePair(stringItems[i].first.toUtf8(), stringItems[i].second.toUtf8());\n    }\n#endif\n\n    for (int i = 0; i < items.size(); ++i) {\n        if (items[i].first.toLower() == \"to\") {\n            Q_FOREACH(const QString &addr, stringListFromRFC2047PercentEncoding(items[i].second))\n                recipients << qMakePair(Composer::ADDRESS_TO, addr);\n        } else if (items[i].first.toLower() == \"cc\") {\n            Q_FOREACH(const QString &addr, stringListFromRFC2047PercentEncoding(items[i].second))\n                recipients << qMakePair(Composer::ADDRESS_CC, addr);\n        } else if (items[i].first.toLower() == \"bcc\") {\n            Q_FOREACH(const QString &addr, stringListFromRFC2047PercentEncoding(items[i].second))\n                recipients << qMakePair(Composer::ADDRESS_BCC, addr);\n        } else if (items[i].first.toLower() == \"subject\") {\n            subject = fromRFC2047PercentEncoding(items[i].second);\n        } else if (items[i].first.toLower() == \"body\") {\n            // RFC 6080: Body does not contain MIME encoded words\n            body = QUrl::fromPercentEncoding(items[i].second);\n        } else if (items[i].first.toLower() == \"in-reply-to\") {\n            inReplyTo << arrayListFromPercentEncoding(items[i].second);\n        } else if (items[i].first.toLower() == \"references\") {\n            references << arrayListFromPercentEncoding(items[i].second);\n        }\n    }\n}"
  },
  {
    "function_name": "rrayListFromPercentEncoding(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Mailto.cpp",
    "lines": "57-67",
    "snippet": "List<QByteArray> arrayListFromPercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QList<QByteArray> ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << QByteArray::fromPercentEncoding(a);\n    }\n    return ret;\n}",
    "includes": [
      "include \"Imap/Encoders.h\"",
      "include \"Recipients.h\"",
      "include \"Mailto.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QStringList>\n#",
      "include <QString>\n#",
      "include <QPair>\n#",
      "include <QList>\n#",
      "include <QByteArray>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ByteArray::fromPercentEncoding(",
          "args": [
            ")"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".isEmpty",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr.split",
          "args": [
            ",')"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Encoders.h\"\ninclude \"Recipients.h\"\ninclude \"Mailto.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QStringList>\n#\ninclude <QString>\n#\ninclude <QPair>\n#\ninclude <QList>\n#\ninclude <QByteArray>\n#\n\nList<QByteArray> arrayListFromPercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QList<QByteArray> ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << QByteArray::fromPercentEncoding(a);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "tringListFromRFC2047PercentEncoding(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Mailto.cpp",
    "lines": "45-55",
    "snippet": "StringList stringListFromRFC2047PercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QStringList ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << fromRFC2047PercentEncoding(a);\n    }\n    return ret;\n}",
    "includes": [
      "include \"Imap/Encoders.h\"",
      "include \"Recipients.h\"",
      "include \"Mailto.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QStringList>\n#",
      "include <QString>\n#",
      "include <QPair>\n#",
      "include <QList>\n#",
      "include <QByteArray>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "romRFC2047PercentEncoding(",
          "args": [
            ")"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "tringListFromRFC2047PercentEncoding(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Mailto.cpp",
          "lines": "45-55",
          "snippet": "StringList stringListFromRFC2047PercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QStringList ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << fromRFC2047PercentEncoding(a);\n    }\n    return ret;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": ".isEmpty",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr.split",
          "args": [
            ",')"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Encoders.h\"\ninclude \"Recipients.h\"\ninclude \"Mailto.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QStringList>\n#\ninclude <QString>\n#\ninclude <QPair>\n#\ninclude <QList>\n#\ninclude <QByteArray>\n#\n\nStringList stringListFromRFC2047PercentEncoding(const QByteArray &str)\n{\n    const QList<QByteArray> &list = str.split(',');\n    QStringList ret;\n    Q_FOREACH(const QByteArray &a, list) {\n        if (a.isEmpty())\n            continue;\n        ret << fromRFC2047PercentEncoding(a);\n    }\n    return ret;\n}"
  },
  {
    "function_name": "romRFC2047PercentEncoding(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Mailto.cpp",
    "lines": "40-43",
    "snippet": "String fromRFC2047PercentEncoding(const QByteArray &str)\n{\n    return Imap::decodeRFC2047String(QByteArray::fromPercentEncoding(str));\n}",
    "includes": [
      "include \"Imap/Encoders.h\"",
      "include \"Recipients.h\"",
      "include \"Mailto.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QUrl>\n#",
      "include <QStringList>\n#",
      "include <QString>\n#",
      "include <QPair>\n#",
      "include <QList>\n#",
      "include <QByteArray>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "map::decodeRFC2047String(",
          "args": [
            "ByteArray::fromPercentEncoding(str))"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ByteArray::fromPercentEncoding(",
          "args": [
            "tr)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Encoders.h\"\ninclude \"Recipients.h\"\ninclude \"Mailto.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QStringList>\n#\ninclude <QString>\n#\ninclude <QPair>\n#\ninclude <QList>\n#\ninclude <QByteArray>\n#\n\nString fromRFC2047PercentEncoding(const QByteArray &str)\n{\n    return Imap::decodeRFC2047String(QByteArray::fromPercentEncoding(str));\n}"
  }
]