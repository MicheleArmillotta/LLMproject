[
  {
    "function_name": "standardLocations",
    "container": "QStandardPaths",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
    "lines": "175-209",
    "snippet": "QStringList QStandardPaths::standardLocations(StandardLocation type)\n{\n    QStringList dirs;\n\n    // type-specific handling goes here\n\n#ifndef Q_OS_WINCE\n    static GetSpecialFolderPath SHGetSpecialFolderPath = resolveGetSpecialFolderPath();\n    if (SHGetSpecialFolderPath) {\n        wchar_t path[MAX_PATH];\n        switch (type) {\n        case ConfigLocation: // same as DataLocation, on Windows\n        case DataLocation:\n        case GenericDataLocation:\n            if (SHGetSpecialFolderPath(0, path, CSIDL_COMMON_APPDATA, FALSE)) {\n                QString result = convertCharArray(path);\n                if (type != GenericDataLocation) {\n                    if (!QCoreApplication::organizationName().isEmpty())\n                        result += QLatin1Char('/') + QCoreApplication::organizationName();\n                    if (!QCoreApplication::applicationName().isEmpty())\n                        result += QLatin1Char('/') + QCoreApplication::applicationName();\n                }\n                dirs.append(result);\n            }\n            break;\n        default:\n            break;\n        }\n    }\n#endif\n\n    const QString localDir = writableLocation(type);\n    dirs.prepend(localDir);\n    return dirs;\n}",
    "includes": [
      "#    include <winx.h>",
      "#  include <intshcut.h>",
      "#include <shlobj.h>",
      "#include <qt_windows.h>",
      "#include <qcoreapplication.h>",
      "#include <qstringlist.h>",
      "#include <qdir.h>",
      "#include \"qsystemlibrary_p.h\"",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dirs.prepend",
          "args": [
            "localDir"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writableLocation",
          "args": [
            "type"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "writableLocation",
          "container": "QStandardPaths",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
          "lines": "88-173",
          "snippet": "QString QStandardPaths::writableLocation(StandardLocation type)\n{\n    QString result;\n\n    static GetSpecialFolderPath SHGetSpecialFolderPath = resolveGetSpecialFolderPath();\n    if (!SHGetSpecialFolderPath)\n        return QString();\n\n    wchar_t path[MAX_PATH];\n\n    switch (type) {\n    case ConfigLocation: // same as DataLocation, on Windows\n    case DataLocation:\n    case GenericDataLocation:\n#if defined Q_OS_WINCE\n        if (SHGetSpecialFolderPath(0, path, CSIDL_APPDATA, FALSE))\n#else\n        if (SHGetSpecialFolderPath(0, path, CSIDL_LOCAL_APPDATA, FALSE))\n#endif\n            result = convertCharArray(path);\n        if (isTestModeEnabled())\n            result += QLatin1String(\"/qttest\");\n        if (type != GenericDataLocation) {\n            if (!QCoreApplication::organizationName().isEmpty())\n                result += QLatin1Char('/') + QCoreApplication::organizationName();\n            if (!QCoreApplication::applicationName().isEmpty())\n                result += QLatin1Char('/') + QCoreApplication::applicationName();\n        }\n        break;\n\n    case DesktopLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_DESKTOPDIRECTORY, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case DownloadLocation: // TODO implement with SHGetKnownFolderPath(FOLDERID_Downloads) (starting from Vista)\n    case DocumentsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_PERSONAL, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case FontsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_FONTS, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case ApplicationsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_PROGRAMS, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case MusicLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYMUSIC, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case MoviesLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYVIDEO, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case PicturesLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYPICTURES, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case CacheLocation:\n        // Although Microsoft has a Cache key it is a pointer to IE's cache, not a cache\n        // location for everyone.  Most applications seem to be using a\n        // cache directory located in their AppData directory\n        return writableLocation(DataLocation) + QLatin1String(\"\\\\cache\");\n\n    case GenericCacheLocation:\n        return writableLocation(GenericDataLocation) + QLatin1String(\"\\\\cache\");\n\n    case RuntimeLocation:\n    case HomeLocation:\n        result = QDir::homePath();\n        break;\n\n    case TempLocation:\n        result = QDir::tempPath();\n        break;\n    }\n    return result;\n}",
          "includes": [
            "#    include <winx.h>",
            "#  include <intshcut.h>",
            "#include <shlobj.h>",
            "#include <qt_windows.h>",
            "#include <qcoreapplication.h>",
            "#include <qstringlist.h>",
            "#include <qdir.h>",
            "#include \"qsystemlibrary_p.h\"",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [
            "#define CSIDL_MYVIDEO 14",
            "#define CSIDL_MYMUSIC 13"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\n#define CSIDL_MYVIDEO 14\n#define CSIDL_MYMUSIC 13\n\nQStandardPaths {\n  QString QStandardPaths::writableLocation(StandardLocation type)\n  {\n      QString result;\n  \n      static GetSpecialFolderPath SHGetSpecialFolderPath = resolveGetSpecialFolderPath();\n      if (!SHGetSpecialFolderPath)\n          return QString();\n  \n      wchar_t path[MAX_PATH];\n  \n      switch (type) {\n      case ConfigLocation: // same as DataLocation, on Windows\n      case DataLocation:\n      case GenericDataLocation:\n  #if defined Q_OS_WINCE\n          if (SHGetSpecialFolderPath(0, path, CSIDL_APPDATA, FALSE))\n  #else\n          if (SHGetSpecialFolderPath(0, path, CSIDL_LOCAL_APPDATA, FALSE))\n  #endif\n              result = convertCharArray(path);\n          if (isTestModeEnabled())\n              result += QLatin1String(\"/qttest\");\n          if (type != GenericDataLocation) {\n              if (!QCoreApplication::organizationName().isEmpty())\n                  result += QLatin1Char('/') + QCoreApplication::organizationName();\n              if (!QCoreApplication::applicationName().isEmpty())\n                  result += QLatin1Char('/') + QCoreApplication::applicationName();\n          }\n          break;\n  \n      case DesktopLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_DESKTOPDIRECTORY, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case DownloadLocation: // TODO implement with SHGetKnownFolderPath(FOLDERID_Downloads) (starting from Vista)\n      case DocumentsLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_PERSONAL, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case FontsLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_FONTS, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case ApplicationsLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_PROGRAMS, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case MusicLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_MYMUSIC, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case MoviesLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_MYVIDEO, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case PicturesLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_MYPICTURES, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case CacheLocation:\n          // Although Microsoft has a Cache key it is a pointer to IE's cache, not a cache\n          // location for everyone.  Most applications seem to be using a\n          // cache directory located in their AppData directory\n          return writableLocation(DataLocation) + QLatin1String(\"\\\\cache\");\n  \n      case GenericCacheLocation:\n          return writableLocation(GenericDataLocation) + QLatin1String(\"\\\\cache\");\n  \n      case RuntimeLocation:\n      case HomeLocation:\n          result = QDir::homePath();\n          break;\n  \n      case TempLocation:\n          result = QDir::tempPath();\n          break;\n      }\n      return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dirs.append",
          "args": [
            "result"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationName",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'/'"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationName",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationName",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::organizationName",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'/'"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::organizationName",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::organizationName",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convertCharArray",
          "args": [
            "path"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "convertCharArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
          "lines": "83-86",
          "snippet": "static QString convertCharArray(const wchar_t *path)\n{\n    return QDir::fromNativeSeparators(QString::fromWCharArray(path));\n}",
          "includes": [
            "#    include <winx.h>",
            "#  include <intshcut.h>",
            "#include <shlobj.h>",
            "#include <qt_windows.h>",
            "#include <qcoreapplication.h>",
            "#include <qstringlist.h>",
            "#include <qdir.h>",
            "#include \"qsystemlibrary_p.h\"",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\nstatic QString convertCharArray(const wchar_t *path)\n{\n    return QDir::fromNativeSeparators(QString::fromWCharArray(path));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_COMMON_APPDATA",
            "FALSE"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resolveGetSpecialFolderPath",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "resolveGetSpecialFolderPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
          "lines": "69-81",
          "snippet": "static GetSpecialFolderPath resolveGetSpecialFolderPath()\n{\n    static GetSpecialFolderPath gsfp = 0;\n    if (!gsfp) {\n#ifndef Q_OS_WINCE\n        QSystemLibrary library(QLatin1String(\"shell32\"));\n#else\n        QSystemLibrary library(QLatin1String(\"coredll\"));\n#endif // Q_OS_WINCE\n        gsfp = (GetSpecialFolderPath)library.resolve(\"SHGetSpecialFolderPathW\");\n    }\n    return gsfp;\n}",
          "includes": [
            "#    include <winx.h>",
            "#  include <intshcut.h>",
            "#include <shlobj.h>",
            "#include <qt_windows.h>",
            "#include <qcoreapplication.h>",
            "#include <qstringlist.h>",
            "#include <qdir.h>",
            "#include \"qsystemlibrary_p.h\"",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\nstatic GetSpecialFolderPath resolveGetSpecialFolderPath()\n{\n    static GetSpecialFolderPath gsfp = 0;\n    if (!gsfp) {\n#ifndef Q_OS_WINCE\n        QSystemLibrary library(QLatin1String(\"shell32\"));\n#else\n        QSystemLibrary library(QLatin1String(\"coredll\"));\n#endif // Q_OS_WINCE\n        gsfp = (GetSpecialFolderPath)library.resolve(\"SHGetSpecialFolderPathW\");\n    }\n    return gsfp;\n}"
        }
      }
    ],
    "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\nQStandardPaths {\n  QStringList QStandardPaths::standardLocations(StandardLocation type)\n  {\n      QStringList dirs;\n  \n      // type-specific handling goes here\n  \n  #ifndef Q_OS_WINCE\n      static GetSpecialFolderPath SHGetSpecialFolderPath = resolveGetSpecialFolderPath();\n      if (SHGetSpecialFolderPath) {\n          wchar_t path[MAX_PATH];\n          switch (type) {\n          case ConfigLocation: // same as DataLocation, on Windows\n          case DataLocation:\n          case GenericDataLocation:\n              if (SHGetSpecialFolderPath(0, path, CSIDL_COMMON_APPDATA, FALSE)) {\n                  QString result = convertCharArray(path);\n                  if (type != GenericDataLocation) {\n                      if (!QCoreApplication::organizationName().isEmpty())\n                          result += QLatin1Char('/') + QCoreApplication::organizationName();\n                      if (!QCoreApplication::applicationName().isEmpty())\n                          result += QLatin1Char('/') + QCoreApplication::applicationName();\n                  }\n                  dirs.append(result);\n              }\n              break;\n          default:\n              break;\n          }\n      }\n  #endif\n  \n      const QString localDir = writableLocation(type);\n      dirs.prepend(localDir);\n      return dirs;\n  }\n}"
  },
  {
    "function_name": "writableLocation",
    "container": "QStandardPaths",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
    "lines": "88-173",
    "snippet": "QString QStandardPaths::writableLocation(StandardLocation type)\n{\n    QString result;\n\n    static GetSpecialFolderPath SHGetSpecialFolderPath = resolveGetSpecialFolderPath();\n    if (!SHGetSpecialFolderPath)\n        return QString();\n\n    wchar_t path[MAX_PATH];\n\n    switch (type) {\n    case ConfigLocation: // same as DataLocation, on Windows\n    case DataLocation:\n    case GenericDataLocation:\n#if defined Q_OS_WINCE\n        if (SHGetSpecialFolderPath(0, path, CSIDL_APPDATA, FALSE))\n#else\n        if (SHGetSpecialFolderPath(0, path, CSIDL_LOCAL_APPDATA, FALSE))\n#endif\n            result = convertCharArray(path);\n        if (isTestModeEnabled())\n            result += QLatin1String(\"/qttest\");\n        if (type != GenericDataLocation) {\n            if (!QCoreApplication::organizationName().isEmpty())\n                result += QLatin1Char('/') + QCoreApplication::organizationName();\n            if (!QCoreApplication::applicationName().isEmpty())\n                result += QLatin1Char('/') + QCoreApplication::applicationName();\n        }\n        break;\n\n    case DesktopLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_DESKTOPDIRECTORY, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case DownloadLocation: // TODO implement with SHGetKnownFolderPath(FOLDERID_Downloads) (starting from Vista)\n    case DocumentsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_PERSONAL, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case FontsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_FONTS, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case ApplicationsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_PROGRAMS, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case MusicLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYMUSIC, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case MoviesLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYVIDEO, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case PicturesLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYPICTURES, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case CacheLocation:\n        // Although Microsoft has a Cache key it is a pointer to IE's cache, not a cache\n        // location for everyone.  Most applications seem to be using a\n        // cache directory located in their AppData directory\n        return writableLocation(DataLocation) + QLatin1String(\"\\\\cache\");\n\n    case GenericCacheLocation:\n        return writableLocation(GenericDataLocation) + QLatin1String(\"\\\\cache\");\n\n    case RuntimeLocation:\n    case HomeLocation:\n        result = QDir::homePath();\n        break;\n\n    case TempLocation:\n        result = QDir::tempPath();\n        break;\n    }\n    return result;\n}",
    "includes": [
      "#    include <winx.h>",
      "#  include <intshcut.h>",
      "#include <shlobj.h>",
      "#include <qt_windows.h>",
      "#include <qcoreapplication.h>",
      "#include <qstringlist.h>",
      "#include <qdir.h>",
      "#include \"qsystemlibrary_p.h\"",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [
      "#define CSIDL_MYVIDEO 14",
      "#define CSIDL_MYMUSIC 13"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDir::tempPath",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QDir::homePath",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"\\\\cache\""
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writableLocation",
          "args": [
            "GenericDataLocation"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "writableLocation",
          "container": "QStandardPaths",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
          "lines": "88-173",
          "snippet": "QString QStandardPaths::writableLocation(StandardLocation type)\n{\n    QString result;\n\n    static GetSpecialFolderPath SHGetSpecialFolderPath = resolveGetSpecialFolderPath();\n    if (!SHGetSpecialFolderPath)\n        return QString();\n\n    wchar_t path[MAX_PATH];\n\n    switch (type) {\n    case ConfigLocation: // same as DataLocation, on Windows\n    case DataLocation:\n    case GenericDataLocation:\n#if defined Q_OS_WINCE\n        if (SHGetSpecialFolderPath(0, path, CSIDL_APPDATA, FALSE))\n#else\n        if (SHGetSpecialFolderPath(0, path, CSIDL_LOCAL_APPDATA, FALSE))\n#endif\n            result = convertCharArray(path);\n        if (isTestModeEnabled())\n            result += QLatin1String(\"/qttest\");\n        if (type != GenericDataLocation) {\n            if (!QCoreApplication::organizationName().isEmpty())\n                result += QLatin1Char('/') + QCoreApplication::organizationName();\n            if (!QCoreApplication::applicationName().isEmpty())\n                result += QLatin1Char('/') + QCoreApplication::applicationName();\n        }\n        break;\n\n    case DesktopLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_DESKTOPDIRECTORY, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case DownloadLocation: // TODO implement with SHGetKnownFolderPath(FOLDERID_Downloads) (starting from Vista)\n    case DocumentsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_PERSONAL, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case FontsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_FONTS, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case ApplicationsLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_PROGRAMS, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case MusicLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYMUSIC, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case MoviesLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYVIDEO, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case PicturesLocation:\n        if (SHGetSpecialFolderPath(0, path, CSIDL_MYPICTURES, FALSE))\n            result = convertCharArray(path);\n        break;\n\n    case CacheLocation:\n        // Although Microsoft has a Cache key it is a pointer to IE's cache, not a cache\n        // location for everyone.  Most applications seem to be using a\n        // cache directory located in their AppData directory\n        return writableLocation(DataLocation) + QLatin1String(\"\\\\cache\");\n\n    case GenericCacheLocation:\n        return writableLocation(GenericDataLocation) + QLatin1String(\"\\\\cache\");\n\n    case RuntimeLocation:\n    case HomeLocation:\n        result = QDir::homePath();\n        break;\n\n    case TempLocation:\n        result = QDir::tempPath();\n        break;\n    }\n    return result;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"\\\\cache\""
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convertCharArray",
          "args": [
            "path"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "convertCharArray",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
          "lines": "83-86",
          "snippet": "static QString convertCharArray(const wchar_t *path)\n{\n    return QDir::fromNativeSeparators(QString::fromWCharArray(path));\n}",
          "includes": [
            "#    include <winx.h>",
            "#  include <intshcut.h>",
            "#include <shlobj.h>",
            "#include <qt_windows.h>",
            "#include <qcoreapplication.h>",
            "#include <qstringlist.h>",
            "#include <qdir.h>",
            "#include \"qsystemlibrary_p.h\"",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\nstatic QString convertCharArray(const wchar_t *path)\n{\n    return QDir::fromNativeSeparators(QString::fromWCharArray(path));\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_MYPICTURES",
            "FALSE"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_MYVIDEO",
            "FALSE"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_MYMUSIC",
            "FALSE"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_PROGRAMS",
            "FALSE"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_FONTS",
            "FALSE"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_PERSONAL",
            "FALSE"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_DESKTOPDIRECTORY",
            "FALSE"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationName",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'/'"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationName",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::applicationName",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::organizationName",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'/'"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::organizationName",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QCoreApplication::organizationName",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"/qttest\""
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isTestModeEnabled",
          "args": [],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "isTestModeEnabled",
          "container": "QStandardPaths",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths.cpp",
          "lines": "351-354",
          "snippet": "bool QStandardPaths::isTestModeEnabled()\n{\n    return qsp_testMode;\n}",
          "includes": [
            "#include <qcoreapplication.h>",
            "#include <qobject.h>",
            "#include <qhash.h>",
            "#include <qfileinfo.h>",
            "#include <qdir.h>",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qcoreapplication.h>\n#include <qobject.h>\n#include <qhash.h>\n#include <qfileinfo.h>\n#include <qdir.h>\n#include \"qstandardpaths.h\"\n\nQStandardPaths {\n  bool QStandardPaths::isTestModeEnabled()\n  {\n      return qsp_testMode;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_LOCAL_APPDATA",
            "FALSE"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SHGetSpecialFolderPath",
          "args": [
            "0",
            "path",
            "CSIDL_APPDATA",
            "FALSE"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "resolveGetSpecialFolderPath",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "resolveGetSpecialFolderPath",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
          "lines": "69-81",
          "snippet": "static GetSpecialFolderPath resolveGetSpecialFolderPath()\n{\n    static GetSpecialFolderPath gsfp = 0;\n    if (!gsfp) {\n#ifndef Q_OS_WINCE\n        QSystemLibrary library(QLatin1String(\"shell32\"));\n#else\n        QSystemLibrary library(QLatin1String(\"coredll\"));\n#endif // Q_OS_WINCE\n        gsfp = (GetSpecialFolderPath)library.resolve(\"SHGetSpecialFolderPathW\");\n    }\n    return gsfp;\n}",
          "includes": [
            "#    include <winx.h>",
            "#  include <intshcut.h>",
            "#include <shlobj.h>",
            "#include <qt_windows.h>",
            "#include <qcoreapplication.h>",
            "#include <qstringlist.h>",
            "#include <qdir.h>",
            "#include \"qsystemlibrary_p.h\"",
            "#include \"qstandardpaths.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\nstatic GetSpecialFolderPath resolveGetSpecialFolderPath()\n{\n    static GetSpecialFolderPath gsfp = 0;\n    if (!gsfp) {\n#ifndef Q_OS_WINCE\n        QSystemLibrary library(QLatin1String(\"shell32\"));\n#else\n        QSystemLibrary library(QLatin1String(\"coredll\"));\n#endif // Q_OS_WINCE\n        gsfp = (GetSpecialFolderPath)library.resolve(\"SHGetSpecialFolderPathW\");\n    }\n    return gsfp;\n}"
        }
      }
    ],
    "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\n#define CSIDL_MYVIDEO 14\n#define CSIDL_MYMUSIC 13\n\nQStandardPaths {\n  QString QStandardPaths::writableLocation(StandardLocation type)\n  {\n      QString result;\n  \n      static GetSpecialFolderPath SHGetSpecialFolderPath = resolveGetSpecialFolderPath();\n      if (!SHGetSpecialFolderPath)\n          return QString();\n  \n      wchar_t path[MAX_PATH];\n  \n      switch (type) {\n      case ConfigLocation: // same as DataLocation, on Windows\n      case DataLocation:\n      case GenericDataLocation:\n  #if defined Q_OS_WINCE\n          if (SHGetSpecialFolderPath(0, path, CSIDL_APPDATA, FALSE))\n  #else\n          if (SHGetSpecialFolderPath(0, path, CSIDL_LOCAL_APPDATA, FALSE))\n  #endif\n              result = convertCharArray(path);\n          if (isTestModeEnabled())\n              result += QLatin1String(\"/qttest\");\n          if (type != GenericDataLocation) {\n              if (!QCoreApplication::organizationName().isEmpty())\n                  result += QLatin1Char('/') + QCoreApplication::organizationName();\n              if (!QCoreApplication::applicationName().isEmpty())\n                  result += QLatin1Char('/') + QCoreApplication::applicationName();\n          }\n          break;\n  \n      case DesktopLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_DESKTOPDIRECTORY, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case DownloadLocation: // TODO implement with SHGetKnownFolderPath(FOLDERID_Downloads) (starting from Vista)\n      case DocumentsLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_PERSONAL, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case FontsLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_FONTS, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case ApplicationsLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_PROGRAMS, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case MusicLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_MYMUSIC, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case MoviesLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_MYVIDEO, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case PicturesLocation:\n          if (SHGetSpecialFolderPath(0, path, CSIDL_MYPICTURES, FALSE))\n              result = convertCharArray(path);\n          break;\n  \n      case CacheLocation:\n          // Although Microsoft has a Cache key it is a pointer to IE's cache, not a cache\n          // location for everyone.  Most applications seem to be using a\n          // cache directory located in their AppData directory\n          return writableLocation(DataLocation) + QLatin1String(\"\\\\cache\");\n  \n      case GenericCacheLocation:\n          return writableLocation(GenericDataLocation) + QLatin1String(\"\\\\cache\");\n  \n      case RuntimeLocation:\n      case HomeLocation:\n          result = QDir::homePath();\n          break;\n  \n      case TempLocation:\n          result = QDir::tempPath();\n          break;\n      }\n      return result;\n  }\n}"
  },
  {
    "function_name": "convertCharArray",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
    "lines": "83-86",
    "snippet": "static QString convertCharArray(const wchar_t *path)\n{\n    return QDir::fromNativeSeparators(QString::fromWCharArray(path));\n}",
    "includes": [
      "#    include <winx.h>",
      "#  include <intshcut.h>",
      "#include <shlobj.h>",
      "#include <qt_windows.h>",
      "#include <qcoreapplication.h>",
      "#include <qstringlist.h>",
      "#include <qdir.h>",
      "#include \"qsystemlibrary_p.h\"",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDir::fromNativeSeparators",
          "args": [
            "QString::fromWCharArray(path)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromWCharArray",
          "args": [
            "path"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\nstatic QString convertCharArray(const wchar_t *path)\n{\n    return QDir::fromNativeSeparators(QString::fromWCharArray(path));\n}"
  },
  {
    "function_name": "resolveGetSpecialFolderPath",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qstandardpaths_win.cpp",
    "lines": "69-81",
    "snippet": "static GetSpecialFolderPath resolveGetSpecialFolderPath()\n{\n    static GetSpecialFolderPath gsfp = 0;\n    if (!gsfp) {\n#ifndef Q_OS_WINCE\n        QSystemLibrary library(QLatin1String(\"shell32\"));\n#else\n        QSystemLibrary library(QLatin1String(\"coredll\"));\n#endif // Q_OS_WINCE\n        gsfp = (GetSpecialFolderPath)library.resolve(\"SHGetSpecialFolderPathW\");\n    }\n    return gsfp;\n}",
    "includes": [
      "#    include <winx.h>",
      "#  include <intshcut.h>",
      "#include <shlobj.h>",
      "#include <qt_windows.h>",
      "#include <qcoreapplication.h>",
      "#include <qstringlist.h>",
      "#include <qdir.h>",
      "#include \"qsystemlibrary_p.h\"",
      "#include \"qstandardpaths.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "library.resolve",
          "args": [
            "\"SHGetSpecialFolderPathW\""
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"coredll\""
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"shell32\""
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#    include <winx.h>\n#  include <intshcut.h>\n#include <shlobj.h>\n#include <qt_windows.h>\n#include <qcoreapplication.h>\n#include <qstringlist.h>\n#include <qdir.h>\n#include \"qsystemlibrary_p.h\"\n#include \"qstandardpaths.h\"\n\nstatic GetSpecialFolderPath resolveGetSpecialFolderPath()\n{\n    static GetSpecialFolderPath gsfp = 0;\n    if (!gsfp) {\n#ifndef Q_OS_WINCE\n        QSystemLibrary library(QLatin1String(\"shell32\"));\n#else\n        QSystemLibrary library(QLatin1String(\"coredll\"));\n#endif // Q_OS_WINCE\n        gsfp = (GetSpecialFolderPath)library.resolve(\"SHGetSpecialFolderPathW\");\n    }\n    return gsfp;\n}"
  }
]