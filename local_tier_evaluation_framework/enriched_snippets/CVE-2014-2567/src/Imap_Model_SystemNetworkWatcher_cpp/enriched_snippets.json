[
  {
    "function_name": "networkSessionError(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "244-246",
    "snippet": "oid SystemNetworkWatcher::networkSessionError()\n{\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::networkSessionError()\n  {\n  }\n}"
  },
  {
    "function_name": "networkConfigurationChanged(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "239-242",
    "snippet": "oid SystemNetworkWatcher::networkConfigurationChanged(const QNetworkConfiguration &)\n{\n    // We have to implement this, otherwise MOC complains loudly. Yes, even if the actual slot is #ifdef-ed out.\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::networkConfigurationChanged(const QNetworkConfiguration &)\n  {\n      // We have to implement this, otherwise MOC complains loudly. Yes, even if the actual slot is #ifdef-ed out.\n  }\n}"
  },
  {
    "function_name": "networkSessionError(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "233-237",
    "snippet": "oid SystemNetworkWatcher::networkSessionError()\n{\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                      QString::fromUtf8(\"Session error: %1\").arg(m_session->errorString()));\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "String::fromUtf8(\"Session error: %1\").arg(m_session->errorString()))"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "_session->errorString())"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->errorString",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "errorString",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "712-714",
          "snippet": "QString QwwSmtpClient::errorString() const{\n    return d->errorString;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QString QwwSmtpClient::errorString() const{\n      return d->errorString;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "Session error: %1\")"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::networkSessionError()\n  {\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                        QString::fromUtf8(\"Session error: %1\").arg(m_session->errorString()));\n  }\n}"
  },
  {
    "function_name": "sessionsActiveConfiguration(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "221-231",
    "snippet": "NetworkConfiguration SystemNetworkWatcher::sessionsActiveConfiguration() const\n{\n    auto conf = m_session->configuration();\n    if (m_session->configuration().type() == QNetworkConfiguration::InternetAccessPoint) {\n        return conf;\n    } else {\n        QString activeConfId = m_session->sessionProperty(QLatin1String(\"ActiveConfiguration\")).toString();\n        // yes, this can return an invalid session\n        return m_netConfManager->configurationFromIdentifier(activeConfId);\n    }\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_netConfManager->configurationFromIdentifier",
          "args": [
            "ctiveConfId)"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->sessionProperty",
          "args": [],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->sessionProperty",
          "args": [
            "Latin1String(\"ActiveConfiguration\"))"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "ActiveConfiguration\")"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  NetworkConfiguration SystemNetworkWatcher::sessionsActiveConfiguration() const\n  {\n      auto conf = m_session->configuration();\n      if (m_session->configuration().type() == QNetworkConfiguration::InternetAccessPoint) {\n          return conf;\n      } else {\n          QString activeConfId = m_session->sessionProperty(QLatin1String(\"ActiveConfiguration\")).toString();\n          // yes, this can return an invalid session\n          return m_netConfManager->configurationFromIdentifier(activeConfId);\n      }\n  }\n}"
  },
  {
    "function_name": "resetSession(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "205-219",
    "snippet": "oid SystemNetworkWatcher::resetSession()\n{\n    delete m_session;\n    const auto conf = m_netConfManager->defaultConfiguration();\n    m_session = new QNetworkSession(conf, this);\n\n    QString buf;\n    QTextStream ss(&buf);\n    ss << \"Switched to network configuration \" << conf.name() << \" (\" << conf.bearerTypeName() << \", \" << conf.identifier() << \")\";\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), buf);\n    connect(m_session, SIGNAL(opened()), this, SLOT(reconnectModelNetwork()));\n    // We cannot pass the argument here because one cannot really have #ifdef-ed slots with MOC, and QNetworkSession::SessionError\n    // is not available on Qt 4.6 (RHEL6).\n    connect(m_session, SIGNAL(error(QNetworkSession::SessionError)), this, SLOT(networkSessionError()));\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_session,",
            "IGNAL(error(QNetworkSession::SessionError)),",
            "his,",
            "LOT(networkSessionError()))"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "etworkSessionError())"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etworkSessionError(",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "networkSessionError(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "244-246",
          "snippet": "oid SystemNetworkWatcher::networkSessionError()\n{\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::networkSessionError()\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "rror(QNetworkSession::SessionError))"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rror(",
          "args": [
            "NetworkSession::SessionError)"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "emitError(",
          "container": "QLCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SQLCache.cpp",
          "lines": "462-466",
          "snippet": "oid SQLCache::emitError(const QString &message) const\n{\n    qDebug() << message;\n    emit error(message);\n}",
          "includes": [
            "include \"Common/SqlTransactionAutoAborter.h\"",
            "include <QTimer>\n#",
            "include <QSqlRecord>\n#",
            "include <QSqlError>\n#",
            "include \"SQLCache.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Common/SqlTransactionAutoAborter.h\"\ninclude <QTimer>\n#\ninclude <QSqlRecord>\n#\ninclude <QSqlError>\n#\ninclude \"SQLCache.h\"\n#\n\nQLCache {\n  oid SQLCache::emitError(const QString &message) const\n  {\n      qDebug() << message;\n      emit error(message);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_session,",
            "IGNAL(opened()),",
            "his,",
            "LOT(reconnectModelNetwork()))"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "econnectModelNetwork())"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "econnectModelNetwork(",
          "args": [],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "reconnectModelNetwork(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "119-135",
          "snippet": "oid SystemNetworkWatcher::reconnectModelNetwork()\n{\n#ifdef TROJITA_HAS_QNETWORKSESSION\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                      QString::fromUtf8(\"Session is %1 (configuration %2), online state: %3\").arg(\n                          QLatin1String(m_session->isOpen() ? \"open\" : \"not open\"),\n                          m_session->configuration().name(),\n                          QLatin1String(m_netConfManager->isOnline() ? \"online\" : \"offline\")\n                          ));\n#endif\n    if (!isOnline()) {\n        m_model->setNetworkPolicy(NETWORK_OFFLINE);\n        return;\n    }\n\n    m_model->setNetworkPolicy(m_desiredPolicy);\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::reconnectModelNetwork()\n  {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                        QString::fromUtf8(\"Session is %1 (configuration %2), online state: %3\").arg(\n                            QLatin1String(m_session->isOpen() ? \"open\" : \"not open\"),\n                            m_session->configuration().name(),\n                            QLatin1String(m_netConfManager->isOnline() ? \"online\" : \"offline\")\n                            ));\n  #endif\n      if (!isOnline()) {\n          m_model->setNetworkPolicy(NETWORK_OFFLINE);\n          return;\n      }\n  \n      m_model->setNetworkPolicy(m_desiredPolicy);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "pened())"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pened(",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "uf)"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onf.identifier",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onf.bearerTypeName",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onf.name",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "name",
          "container": "QMimeType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "208-211",
          "snippet": "QString QMimeType::name() const\n{\n    return d->name;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQMimeType {\n  QString QMimeType::name() const\n  {\n      return d->name;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_netConfManager->defaultConfiguration",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::resetSession()\n  {\n      delete m_session;\n      const auto conf = m_netConfManager->defaultConfiguration();\n      m_session = new QNetworkSession(conf, this);\n  \n      QString buf;\n      QTextStream ss(&buf);\n      ss << \"Switched to network configuration \" << conf.name() << \" (\" << conf.bearerTypeName() << \", \" << conf.identifier() << \")\";\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), buf);\n      connect(m_session, SIGNAL(opened()), this, SLOT(reconnectModelNetwork()));\n      // We cannot pass the argument here because one cannot really have #ifdef-ed slots with MOC, and QNetworkSession::SessionError\n      // is not available on Qt 4.6 (RHEL6).\n      connect(m_session, SIGNAL(error(QNetworkSession::SessionError)), this, SLOT(networkSessionError()));\n  }\n}"
  },
  {
    "function_name": "networkConfigurationChanged(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "163-202",
    "snippet": "oid SystemNetworkWatcher::networkConfigurationChanged(const QNetworkConfiguration &conf)\n{\n    bool reconnect = false;\n\n    if (conf == sessionsActiveConfiguration() && !conf.state().testFlag(QNetworkConfiguration::Active)) {\n        // Change of the \"session's own configuration\" -- perhaps it is no longer available\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                          QString::fromUtf8(\"Change of configuration of the current session\"));\n        reconnect = true;\n    } else if (conf.state().testFlag(QNetworkConfiguration::Active) && conf.type() == QNetworkConfiguration::InternetAccessPoint &&\n               conf != sessionsActiveConfiguration()) {\n        // We are going to interpret this as a subtle hint for switching to another session\n\n        if (m_session->configuration().type() == QNetworkConfiguration::UserChoice && !sessionsActiveConfiguration().isValid()) {\n            // No configuration has been assigned yet, just ignore this event. This happens on Harmattan when we get a change\n            // of e.g. an office WiFi connection in reply to us trying to open a session with the system's default configuration.\n            return;\n        }\n\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                          m_session->configuration().type() == QNetworkConfiguration::InternetAccessPoint ?\n                              QString::fromUtf8(\"Change of system's default configuration: %1. Currently using %2.\")\n                              .arg(conf.name(), m_session->configuration().name())\n                            :\n                              QString::fromUtf8(\"Change of system's default configuration: %1. Currently using %2 (active: %3).\")\n                              .arg(conf.name(), m_session->configuration().name(), sessionsActiveConfiguration().name()));\n        reconnect = true;\n    }\n\n    if (reconnect) {\n        m_model->setNetworkPolicy(NETWORK_OFFLINE);\n        resetSession();\n        if (m_session->configuration().isValid()) {\n            m_session->open();\n        } else {\n            m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                              QLatin1String(\"Waiting for network to become available...\"));\n        }\n    }\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "Latin1String(\"Waiting for network to become available...\"))"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Waiting for network to become available...\")"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->open",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esetSession(",
          "args": [],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "resetSession(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "205-219",
          "snippet": "oid SystemNetworkWatcher::resetSession()\n{\n    delete m_session;\n    const auto conf = m_netConfManager->defaultConfiguration();\n    m_session = new QNetworkSession(conf, this);\n\n    QString buf;\n    QTextStream ss(&buf);\n    ss << \"Switched to network configuration \" << conf.name() << \" (\" << conf.bearerTypeName() << \", \" << conf.identifier() << \")\";\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), buf);\n    connect(m_session, SIGNAL(opened()), this, SLOT(reconnectModelNetwork()));\n    // We cannot pass the argument here because one cannot really have #ifdef-ed slots with MOC, and QNetworkSession::SessionError\n    // is not available on Qt 4.6 (RHEL6).\n    connect(m_session, SIGNAL(error(QNetworkSession::SessionError)), this, SLOT(networkSessionError()));\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::resetSession()\n  {\n      delete m_session;\n      const auto conf = m_netConfManager->defaultConfiguration();\n      m_session = new QNetworkSession(conf, this);\n  \n      QString buf;\n      QTextStream ss(&buf);\n      ss << \"Switched to network configuration \" << conf.name() << \" (\" << conf.bearerTypeName() << \", \" << conf.identifier() << \")\";\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), buf);\n      connect(m_session, SIGNAL(opened()), this, SLOT(reconnectModelNetwork()));\n      // We cannot pass the argument here because one cannot really have #ifdef-ed slots with MOC, and QNetworkSession::SessionError\n      // is not available on Qt 4.6 (RHEL6).\n      connect(m_session, SIGNAL(error(QNetworkSession::SessionError)), this, SLOT(networkSessionError()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->setNetworkPolicy",
          "args": [
            "ETWORK_OFFLINE)"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "_session->configuration().type() == QNetworkConfiguration::InternetAccessPoint ?\n                              QString::fromUtf8(\"Change of system's default configuration: %1. Currently using %2.\")\n                              .arg(conf.name(), m_session->configuration().name())\n                            :\n                              QString::fromUtf8(\"Change of system's default configuration: %1. Currently using %2 (active: %3).\")\n                              .arg(conf.name(), m_session->configuration().name(), sessionsActiveConfiguration().name()))"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "onf.name(),",
            "_session->configuration().name(),",
            "essionsActiveConfiguration().name())"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essionsActiveConfiguration",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "sessionsActiveConfiguration(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "221-231",
          "snippet": "NetworkConfiguration SystemNetworkWatcher::sessionsActiveConfiguration() const\n{\n    auto conf = m_session->configuration();\n    if (m_session->configuration().type() == QNetworkConfiguration::InternetAccessPoint) {\n        return conf;\n    } else {\n        QString activeConfId = m_session->sessionProperty(QLatin1String(\"ActiveConfiguration\")).toString();\n        // yes, this can return an invalid session\n        return m_netConfManager->configurationFromIdentifier(activeConfId);\n    }\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  NetworkConfiguration SystemNetworkWatcher::sessionsActiveConfiguration() const\n  {\n      auto conf = m_session->configuration();\n      if (m_session->configuration().type() == QNetworkConfiguration::InternetAccessPoint) {\n          return conf;\n      } else {\n          QString activeConfId = m_session->sessionProperty(QLatin1String(\"ActiveConfiguration\")).toString();\n          // yes, this can return an invalid session\n          return m_netConfManager->configurationFromIdentifier(activeConfId);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onf.name",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "name",
          "container": "QMimeType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "208-211",
          "snippet": "QString QMimeType::name() const\n{\n    return d->name;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQMimeType {\n  QString QMimeType::name() const\n  {\n      return d->name;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "Change of system's default configuration: %1. Currently using %2 (active: %3).\")"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "onf.name(),",
            "_session->configuration().name())"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "Change of system's default configuration: %1. Currently using %2.\")"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onf.type",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onf.state",
          "args": [
            "NetworkConfiguration::Active)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onf.state",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "String::fromUtf8(\"Change of configuration of the current session\"))"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "Change of configuration of the current session\")"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onf.state",
          "args": [
            "NetworkConfiguration::Active)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onf.state",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::networkConfigurationChanged(const QNetworkConfiguration &conf)\n  {\n      bool reconnect = false;\n  \n      if (conf == sessionsActiveConfiguration() && !conf.state().testFlag(QNetworkConfiguration::Active)) {\n          // Change of the \"session's own configuration\" -- perhaps it is no longer available\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                            QString::fromUtf8(\"Change of configuration of the current session\"));\n          reconnect = true;\n      } else if (conf.state().testFlag(QNetworkConfiguration::Active) && conf.type() == QNetworkConfiguration::InternetAccessPoint &&\n                 conf != sessionsActiveConfiguration()) {\n          // We are going to interpret this as a subtle hint for switching to another session\n  \n          if (m_session->configuration().type() == QNetworkConfiguration::UserChoice && !sessionsActiveConfiguration().isValid()) {\n              // No configuration has been assigned yet, just ignore this event. This happens on Harmattan when we get a change\n              // of e.g. an office WiFi connection in reply to us trying to open a session with the system's default configuration.\n              return;\n          }\n  \n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                            m_session->configuration().type() == QNetworkConfiguration::InternetAccessPoint ?\n                                QString::fromUtf8(\"Change of system's default configuration: %1. Currently using %2.\")\n                                .arg(conf.name(), m_session->configuration().name())\n                              :\n                                QString::fromUtf8(\"Change of system's default configuration: %1. Currently using %2 (active: %3).\")\n                                .arg(conf.name(), m_session->configuration().name(), sessionsActiveConfiguration().name()));\n          reconnect = true;\n      }\n  \n      if (reconnect) {\n          m_model->setNetworkPolicy(NETWORK_OFFLINE);\n          resetSession();\n          if (m_session->configuration().isValid()) {\n              m_session->open();\n          } else {\n              m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                                QLatin1String(\"Waiting for network to become available...\"));\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "isOnline(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "137-151",
    "snippet": "ool SystemNetworkWatcher::isOnline() const\n{\n#ifdef TROJITA_HAS_QNETWORKSESSION\n    if (m_netConfManager->allConfigurations().isEmpty()) {\n        // This means that Qt has no idea about the network. Let's pretend that we are connected.\n        // This happens e.g. when users do not have the qt-bearer package installed.\n        return true;\n    }\n\n    return m_netConfManager->isOnline() && m_session->isOpen();\n#else\n    // We actually don't know, so let's pretend that the network is here. The alternative is that we would never connect :).\n    return true;\n#endif\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_session->isOpen",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_netConfManager->isOnline",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_netConfManager->allConfigurations",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_netConfManager->allConfigurations",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  ool SystemNetworkWatcher::isOnline() const\n  {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n      if (m_netConfManager->allConfigurations().isEmpty()) {\n          // This means that Qt has no idea about the network. Let's pretend that we are connected.\n          // This happens e.g. when users do not have the qt-bearer package installed.\n          return true;\n      }\n  \n      return m_netConfManager->isOnline() && m_session->isOpen();\n  #else\n      // We actually don't know, so let's pretend that the network is here. The alternative is that we would never connect :).\n      return true;\n  #endif\n  }\n}"
  },
  {
    "function_name": "reconnectModelNetwork(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "119-135",
    "snippet": "oid SystemNetworkWatcher::reconnectModelNetwork()\n{\n#ifdef TROJITA_HAS_QNETWORKSESSION\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                      QString::fromUtf8(\"Session is %1 (configuration %2), online state: %3\").arg(\n                          QLatin1String(m_session->isOpen() ? \"open\" : \"not open\"),\n                          m_session->configuration().name(),\n                          QLatin1String(m_netConfManager->isOnline() ? \"online\" : \"offline\")\n                          ));\n#endif\n    if (!isOnline()) {\n        m_model->setNetworkPolicy(NETWORK_OFFLINE);\n        return;\n    }\n\n    m_model->setNetworkPolicy(m_desiredPolicy);\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_model->setNetworkPolicy",
          "args": [
            "_desiredPolicy)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->setNetworkPolicy",
          "args": [
            "ETWORK_OFFLINE)"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sOnline(",
          "args": [],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "isOnline(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "137-151",
          "snippet": "ool SystemNetworkWatcher::isOnline() const\n{\n#ifdef TROJITA_HAS_QNETWORKSESSION\n    if (m_netConfManager->allConfigurations().isEmpty()) {\n        // This means that Qt has no idea about the network. Let's pretend that we are connected.\n        // This happens e.g. when users do not have the qt-bearer package installed.\n        return true;\n    }\n\n    return m_netConfManager->isOnline() && m_session->isOpen();\n#else\n    // We actually don't know, so let's pretend that the network is here. The alternative is that we would never connect :).\n    return true;\n#endif\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  ool SystemNetworkWatcher::isOnline() const\n  {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n      if (m_netConfManager->allConfigurations().isEmpty()) {\n          // This means that Qt has no idea about the network. Let's pretend that we are connected.\n          // This happens e.g. when users do not have the qt-bearer package installed.\n          return true;\n      }\n  \n      return m_netConfManager->isOnline() && m_session->isOpen();\n  #else\n      // We actually don't know, so let's pretend that the network is here. The alternative is that we would never connect :).\n      return true;\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "String::fromUtf8(\"Session is %1 (configuration %2), online state: %3\").arg(\n                          QLatin1String(m_session->isOpen() ? \"open\" : \"not open\"),\n                          m_session->configuration().name(),\n                          QLatin1String(m_netConfManager->isOnline() ? \"online\" : \"offline\")\n                          ))"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "Latin1String(m_session->isOpen() ? \"open\" : \"not open\"),",
            "_session->configuration().name(),",
            "Latin1String(m_netConfManager->isOnline() ? \"online\" : \"offline\")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "_netConfManager->isOnline() ? \"online\" : \"offline\")"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_netConfManager->isOnline",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->configuration",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "_session->isOpen() ? \"open\" : \"not open\")"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->isOpen",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "Session is %1 (configuration %2), online state: %3\")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::reconnectModelNetwork()\n  {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                        QString::fromUtf8(\"Session is %1 (configuration %2), online state: %3\").arg(\n                            QLatin1String(m_session->isOpen() ? \"open\" : \"not open\"),\n                            m_session->configuration().name(),\n                            QLatin1String(m_netConfManager->isOnline() ? \"online\" : \"offline\")\n                            ));\n  #endif\n      if (!isOnline()) {\n          m_model->setNetworkPolicy(NETWORK_OFFLINE);\n          return;\n      }\n  \n      m_model->setNetworkPolicy(m_desiredPolicy);\n  }\n}"
  },
  {
    "function_name": "setDesiredNetworkPolicy(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "76-117",
    "snippet": "oid SystemNetworkWatcher::setDesiredNetworkPolicy(const NetworkPolicy policy)\n{\n    if (policy != m_desiredPolicy) {\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                          QString::fromUtf8(\"User's preference changed: %1\").arg(policyToString(policy)));\n        m_desiredPolicy = policy;\n    }\n    if (m_model->networkPolicy() == NETWORK_OFFLINE && policy != NETWORK_OFFLINE) {\n        // We are asked to connect, the model is not connected yet\n        if (isOnline()) {\n#ifdef TROJITA_HAS_QNETWORKSESSION\n            if (m_netConfManager->allConfigurations().isEmpty()) {\n                m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                                  // Yes, this is quite deliberate call to tr(). We absolutely want users to be able to read this\n                                  // (but no so much as to bother them with a popup for now, I guess -- or not?)\n                                  tr(\"Qt does not recognize any network session. Please be sure that qtbearer package \"\n                                     \"(or similar) is installed. Assuming that network is actually already available.\"));\n            }\n#endif\n\n            m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Network is online -> connecting\"));\n            reconnectModelNetwork();\n        } else {\n            // We aren't online yet, but we will become online at some point. When that happens, reconnectModelNetwork() will\n            // be called, so there is nothing to do from this place.\n            m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Opening network session\"));\n#ifdef TROJITA_HAS_QNETWORKSESSION\n            m_session->open();\n#endif\n        }\n    } else if (m_model->networkPolicy() != NETWORK_OFFLINE && policy == NETWORK_OFFLINE) {\n        // This is pretty easy -- just disconnect the model\n        m_model->setNetworkPolicy(NETWORK_OFFLINE);\n#ifdef TROJITA_HAS_QNETWORKSESSION\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Closing network session\"));\n        m_session->close();\n#endif\n    } else {\n        // No need to connect/disconnect/reconnect, yay!\n        m_model->setNetworkPolicy(m_desiredPolicy);\n    }\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_model->setNetworkPolicy",
          "args": [
            "_desiredPolicy)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->close",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "Latin1String(\"Closing network session\"))"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Closing network session\")"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->setNetworkPolicy",
          "args": [
            "ETWORK_OFFLINE)"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->networkPolicy",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_session->open",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "Latin1String(\"Opening network session\"))"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Opening network session\")"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "econnectModelNetwork(",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "reconnectModelNetwork(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "119-135",
          "snippet": "oid SystemNetworkWatcher::reconnectModelNetwork()\n{\n#ifdef TROJITA_HAS_QNETWORKSESSION\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                      QString::fromUtf8(\"Session is %1 (configuration %2), online state: %3\").arg(\n                          QLatin1String(m_session->isOpen() ? \"open\" : \"not open\"),\n                          m_session->configuration().name(),\n                          QLatin1String(m_netConfManager->isOnline() ? \"online\" : \"offline\")\n                          ));\n#endif\n    if (!isOnline()) {\n        m_model->setNetworkPolicy(NETWORK_OFFLINE);\n        return;\n    }\n\n    m_model->setNetworkPolicy(m_desiredPolicy);\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::reconnectModelNetwork()\n  {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                        QString::fromUtf8(\"Session is %1 (configuration %2), online state: %3\").arg(\n                            QLatin1String(m_session->isOpen() ? \"open\" : \"not open\"),\n                            m_session->configuration().name(),\n                            QLatin1String(m_netConfManager->isOnline() ? \"online\" : \"offline\")\n                            ));\n  #endif\n      if (!isOnline()) {\n          m_model->setNetworkPolicy(NETWORK_OFFLINE);\n          return;\n      }\n  \n      m_model->setNetworkPolicy(m_desiredPolicy);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "Latin1String(\"Network is online -> connecting\"))"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network is online -> connecting\")"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "/ Yes, this is quite deliberate call to tr(). We absolutely want users to be able to read this\n/ (but no so much as to bother them with a popup for now, I guess -- or not?)\nr(\"Qt does not recognize any network session. Please be sure that qtbearer package \"\n                                     \"(or similar) is installed. Assuming that network is actually already available.\"))"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Qt does not recognize any network session. Please be sure that qtbearer package \"\n                                     \"(or similar) is installed. Assuming that network is actually already available.\")"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "emitError(",
          "container": "QLCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SQLCache.cpp",
          "lines": "462-466",
          "snippet": "oid SQLCache::emitError(const QString &message) const\n{\n    qDebug() << message;\n    emit error(message);\n}",
          "includes": [
            "include \"Common/SqlTransactionAutoAborter.h\"",
            "include <QTimer>\n#",
            "include <QSqlRecord>\n#",
            "include <QSqlError>\n#",
            "include \"SQLCache.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Common/SqlTransactionAutoAborter.h\"\ninclude <QTimer>\n#\ninclude <QSqlRecord>\n#\ninclude <QSqlError>\n#\ninclude \"SQLCache.h\"\n#\n\nQLCache {\n  oid SQLCache::emitError(const QString &message) const\n  {\n      qDebug() << message;\n      emit error(message);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_netConfManager->allConfigurations",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_netConfManager->allConfigurations",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sOnline(",
          "args": [],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "isOnline(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "137-151",
          "snippet": "ool SystemNetworkWatcher::isOnline() const\n{\n#ifdef TROJITA_HAS_QNETWORKSESSION\n    if (m_netConfManager->allConfigurations().isEmpty()) {\n        // This means that Qt has no idea about the network. Let's pretend that we are connected.\n        // This happens e.g. when users do not have the qt-bearer package installed.\n        return true;\n    }\n\n    return m_netConfManager->isOnline() && m_session->isOpen();\n#else\n    // We actually don't know, so let's pretend that the network is here. The alternative is that we would never connect :).\n    return true;\n#endif\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  ool SystemNetworkWatcher::isOnline() const\n  {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n      if (m_netConfManager->allConfigurations().isEmpty()) {\n          // This means that Qt has no idea about the network. Let's pretend that we are connected.\n          // This happens e.g. when users do not have the qt-bearer package installed.\n          return true;\n      }\n  \n      return m_netConfManager->isOnline() && m_session->isOpen();\n  #else\n      // We actually don't know, so let's pretend that the network is here. The alternative is that we would never connect :).\n      return true;\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->networkPolicy",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "String::fromUtf8(\"User's preference changed: %1\").arg(policyToString(policy)))"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "olicyToString(policy))"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "olicyToString(",
          "args": [
            "olicy)"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "olicyToString(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "33-45",
          "snippet": "String policyToString(const NetworkPolicy policy)\n{\n    switch (policy) {\n    case NETWORK_OFFLINE:\n        return QLatin1String(\"NETWORK_OFFLINE\");\n    case NETWORK_EXPENSIVE:\n        return QLatin1String(\"NETWORK_EXPENSIVE\");\n    case NETWORK_ONLINE:\n        return QLatin1String(\"NETWORK_ONLINE\");\n    }\n    Q_ASSERT(false);\n    return QString();\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nString policyToString(const NetworkPolicy policy)\n{\n    switch (policy) {\n    case NETWORK_OFFLINE:\n        return QLatin1String(\"NETWORK_OFFLINE\");\n    case NETWORK_EXPENSIVE:\n        return QLatin1String(\"NETWORK_EXPENSIVE\");\n    case NETWORK_ONLINE:\n        return QLatin1String(\"NETWORK_ONLINE\");\n    }\n    Q_ASSERT(false);\n    return QString();\n}"
        }
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "User's preference changed: %1\")"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::setDesiredNetworkPolicy(const NetworkPolicy policy)\n  {\n      if (policy != m_desiredPolicy) {\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                            QString::fromUtf8(\"User's preference changed: %1\").arg(policyToString(policy)));\n          m_desiredPolicy = policy;\n      }\n      if (m_model->networkPolicy() == NETWORK_OFFLINE && policy != NETWORK_OFFLINE) {\n          // We are asked to connect, the model is not connected yet\n          if (isOnline()) {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n              if (m_netConfManager->allConfigurations().isEmpty()) {\n                  m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                                    // Yes, this is quite deliberate call to tr(). We absolutely want users to be able to read this\n                                    // (but no so much as to bother them with a popup for now, I guess -- or not?)\n                                    tr(\"Qt does not recognize any network session. Please be sure that qtbearer package \"\n                                       \"(or similar) is installed. Assuming that network is actually already available.\"));\n              }\n  #endif\n  \n              m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Network is online -> connecting\"));\n              reconnectModelNetwork();\n          } else {\n              // We aren't online yet, but we will become online at some point. When that happens, reconnectModelNetwork() will\n              // be called, so there is nothing to do from this place.\n              m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Opening network session\"));\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n              m_session->open();\n  #endif\n          }\n      } else if (m_model->networkPolicy() != NETWORK_OFFLINE && policy == NETWORK_OFFLINE) {\n          // This is pretty easy -- just disconnect the model\n          m_model->setNetworkPolicy(NETWORK_OFFLINE);\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Closing network session\"));\n          m_session->close();\n  #endif\n      } else {\n          // No need to connect/disconnect/reconnect, yay!\n          m_model->setNetworkPolicy(m_desiredPolicy);\n      }\n  }\n}"
  },
  {
    "function_name": "effectiveNetworkPolicy(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "71-74",
    "snippet": "etworkPolicy SystemNetworkWatcher::effectiveNetworkPolicy() const\n{\n    return m_model->networkPolicy();\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_model->networkPolicy",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  etworkPolicy SystemNetworkWatcher::effectiveNetworkPolicy() const\n  {\n      return m_model->networkPolicy();\n  }\n}"
  },
  {
    "function_name": "onGlobalOnlineStateChanged(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "59-69",
    "snippet": "oid SystemNetworkWatcher::onGlobalOnlineStateChanged(const bool online)\n{\n    if (online) {\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"System is back online\"));\n        setDesiredNetworkPolicy(m_desiredPolicy);\n    } else {\n        m_model->setNetworkPolicy(NETWORK_OFFLINE);\n        // The session remains open, so that we indicate our intention to reconnect after the connectivity is restored\n        // (or when a configured AP comes back to range, etc).\n    }\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_model->setNetworkPolicy",
          "args": [
            "ETWORK_OFFLINE)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etDesiredNetworkPolicy(",
          "args": [
            "_desiredPolicy)"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "setDesiredNetworkPolicy(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "76-117",
          "snippet": "oid SystemNetworkWatcher::setDesiredNetworkPolicy(const NetworkPolicy policy)\n{\n    if (policy != m_desiredPolicy) {\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                          QString::fromUtf8(\"User's preference changed: %1\").arg(policyToString(policy)));\n        m_desiredPolicy = policy;\n    }\n    if (m_model->networkPolicy() == NETWORK_OFFLINE && policy != NETWORK_OFFLINE) {\n        // We are asked to connect, the model is not connected yet\n        if (isOnline()) {\n#ifdef TROJITA_HAS_QNETWORKSESSION\n            if (m_netConfManager->allConfigurations().isEmpty()) {\n                m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                                  // Yes, this is quite deliberate call to tr(). We absolutely want users to be able to read this\n                                  // (but no so much as to bother them with a popup for now, I guess -- or not?)\n                                  tr(\"Qt does not recognize any network session. Please be sure that qtbearer package \"\n                                     \"(or similar) is installed. Assuming that network is actually already available.\"));\n            }\n#endif\n\n            m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Network is online -> connecting\"));\n            reconnectModelNetwork();\n        } else {\n            // We aren't online yet, but we will become online at some point. When that happens, reconnectModelNetwork() will\n            // be called, so there is nothing to do from this place.\n            m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Opening network session\"));\n#ifdef TROJITA_HAS_QNETWORKSESSION\n            m_session->open();\n#endif\n        }\n    } else if (m_model->networkPolicy() != NETWORK_OFFLINE && policy == NETWORK_OFFLINE) {\n        // This is pretty easy -- just disconnect the model\n        m_model->setNetworkPolicy(NETWORK_OFFLINE);\n#ifdef TROJITA_HAS_QNETWORKSESSION\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Closing network session\"));\n        m_session->close();\n#endif\n    } else {\n        // No need to connect/disconnect/reconnect, yay!\n        m_model->setNetworkPolicy(m_desiredPolicy);\n    }\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::setDesiredNetworkPolicy(const NetworkPolicy policy)\n  {\n      if (policy != m_desiredPolicy) {\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                            QString::fromUtf8(\"User's preference changed: %1\").arg(policyToString(policy)));\n          m_desiredPolicy = policy;\n      }\n      if (m_model->networkPolicy() == NETWORK_OFFLINE && policy != NETWORK_OFFLINE) {\n          // We are asked to connect, the model is not connected yet\n          if (isOnline()) {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n              if (m_netConfManager->allConfigurations().isEmpty()) {\n                  m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"),\n                                    // Yes, this is quite deliberate call to tr(). We absolutely want users to be able to read this\n                                    // (but no so much as to bother them with a popup for now, I guess -- or not?)\n                                    tr(\"Qt does not recognize any network session. Please be sure that qtbearer package \"\n                                       \"(or similar) is installed. Assuming that network is actually already available.\"));\n              }\n  #endif\n  \n              m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Network is online -> connecting\"));\n              reconnectModelNetwork();\n          } else {\n              // We aren't online yet, but we will become online at some point. When that happens, reconnectModelNetwork() will\n              // be called, so there is nothing to do from this place.\n              m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Opening network session\"));\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n              m_session->open();\n  #endif\n          }\n      } else if (m_model->networkPolicy() != NETWORK_OFFLINE && policy == NETWORK_OFFLINE) {\n          // This is pretty easy -- just disconnect the model\n          m_model->setNetworkPolicy(NETWORK_OFFLINE);\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"Closing network session\"));\n          m_session->close();\n  #endif\n      } else {\n          // No need to connect/disconnect/reconnect, yay!\n          m_model->setNetworkPolicy(m_desiredPolicy);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Network Session\"),",
            "Latin1String(\"System is back online\"))"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "System is back online\")"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Network Session\")"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::onGlobalOnlineStateChanged(const bool online)\n  {\n      if (online) {\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), QLatin1String(\"System is back online\"));\n          setDesiredNetworkPolicy(m_desiredPolicy);\n      } else {\n          m_model->setNetworkPolicy(NETWORK_OFFLINE);\n          // The session remains open, so that we indicate our intention to reconnect after the connectivity is restored\n          // (or when a configured AP comes back to range, etc).\n      }\n  }\n}"
  },
  {
    "function_name": "SystemNetworkWatcher(",
    "container": "ystemNetworkWatcher",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "47-57",
    "snippet": "ystemNetworkWatcher::SystemNetworkWatcher(QObject *parent, Model *model):\n    NetworkWatcher(parent, model), m_netConfManager(0), m_session(0)\n{\n#ifdef TROJITA_HAS_QNETWORKSESSION\n    m_netConfManager = new QNetworkConfigurationManager(this);\n    resetSession();\n    connect(m_netConfManager, SIGNAL(onlineStateChanged(bool)), this, SLOT(onGlobalOnlineStateChanged(bool)));\n    connect(m_netConfManager, SIGNAL(configurationChanged(QNetworkConfiguration)),\n            this, SLOT(networkConfigurationChanged(QNetworkConfiguration)));\n#endif\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_netConfManager,",
            "IGNAL(configurationChanged(QNetworkConfiguration)),",
            "his,",
            "LOT(networkConfigurationChanged(QNetworkConfiguration)))"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "etworkConfigurationChanged(QNetworkConfiguration))"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etworkConfigurationChanged(",
          "args": [
            "NetworkConfiguration)"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "networkConfigurationChanged(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "239-242",
          "snippet": "oid SystemNetworkWatcher::networkConfigurationChanged(const QNetworkConfiguration &)\n{\n    // We have to implement this, otherwise MOC complains loudly. Yes, even if the actual slot is #ifdef-ed out.\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::networkConfigurationChanged(const QNetworkConfiguration &)\n  {\n      // We have to implement this, otherwise MOC complains loudly. Yes, even if the actual slot is #ifdef-ed out.\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "onfigurationChanged(QNetworkConfiguration))"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esetSession(",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "resetSession(",
          "container": "ystemNetworkWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
          "lines": "205-219",
          "snippet": "oid SystemNetworkWatcher::resetSession()\n{\n    delete m_session;\n    const auto conf = m_netConfManager->defaultConfiguration();\n    m_session = new QNetworkSession(conf, this);\n\n    QString buf;\n    QTextStream ss(&buf);\n    ss << \"Switched to network configuration \" << conf.name() << \" (\" << conf.bearerTypeName() << \", \" << conf.identifier() << \")\";\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), buf);\n    connect(m_session, SIGNAL(opened()), this, SLOT(reconnectModelNetwork()));\n    // We cannot pass the argument here because one cannot really have #ifdef-ed slots with MOC, and QNetworkSession::SessionError\n    // is not available on Qt 4.6 (RHEL6).\n    connect(m_session, SIGNAL(error(QNetworkSession::SessionError)), this, SLOT(networkSessionError()));\n}",
          "includes": [
            "include \"Model.h\"",
            "include <QNetworkSession>\n#",
            "include <QNetworkConfigurationManager>\n#",
            "include \"SystemNetworkWatcher.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  oid SystemNetworkWatcher::resetSession()\n  {\n      delete m_session;\n      const auto conf = m_netConfManager->defaultConfiguration();\n      m_session = new QNetworkSession(conf, this);\n  \n      QString buf;\n      QTextStream ss(&buf);\n      ss << \"Switched to network configuration \" << conf.name() << \" (\" << conf.bearerTypeName() << \", \" << conf.identifier() << \")\";\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Network Session\"), buf);\n      connect(m_session, SIGNAL(opened()), this, SLOT(reconnectModelNetwork()));\n      // We cannot pass the argument here because one cannot really have #ifdef-ed slots with MOC, and QNetworkSession::SessionError\n      // is not available on Qt 4.6 (RHEL6).\n      connect(m_session, SIGNAL(error(QNetworkSession::SessionError)), this, SLOT(networkSessionError()));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nystemNetworkWatcher {\n  ystemNetworkWatcher::SystemNetworkWatcher(QObject *parent, Model *model):\n      NetworkWatcher(parent, model), m_netConfManager(0), m_session(0)\n  {\n  #ifdef TROJITA_HAS_QNETWORKSESSION\n      m_netConfManager = new QNetworkConfigurationManager(this);\n      resetSession();\n      connect(m_netConfManager, SIGNAL(onlineStateChanged(bool)), this, SLOT(onGlobalOnlineStateChanged(bool)));\n      connect(m_netConfManager, SIGNAL(configurationChanged(QNetworkConfiguration)),\n              this, SLOT(networkConfigurationChanged(QNetworkConfiguration)));\n  #endif\n  }\n}"
  },
  {
    "function_name": "olicyToString(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SystemNetworkWatcher.cpp",
    "lines": "33-45",
    "snippet": "String policyToString(const NetworkPolicy policy)\n{\n    switch (policy) {\n    case NETWORK_OFFLINE:\n        return QLatin1String(\"NETWORK_OFFLINE\");\n    case NETWORK_EXPENSIVE:\n        return QLatin1String(\"NETWORK_EXPENSIVE\");\n    case NETWORK_ONLINE:\n        return QLatin1String(\"NETWORK_ONLINE\");\n    }\n    Q_ASSERT(false);\n    return QString();\n}",
    "includes": [
      "include \"Model.h\"",
      "include <QNetworkSession>\n#",
      "include <QNetworkConfigurationManager>\n#",
      "include \"SystemNetworkWatcher.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "modifierToString(",
          "container": "reeItemModifiedPart",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1624-1640",
          "snippet": "String TreeItemModifiedPart::modifierToString() const\n{\n    switch (m_modifier) {\n    case OFFSET_HEADER:\n        return QLatin1String(\"HEADER\");\n    case OFFSET_TEXT:\n        return QLatin1String(\"TEXT\");\n    case OFFSET_MIME:\n        return QLatin1String(\"MIME\");\n    case OFFSET_RAW_CONTENTS:\n        Q_ASSERT(!\"Cannot get the fetch modifier for an OFFSET_RAW_CONTENTS item\");\n        // fall through\n    default:\n        Q_ASSERT(false);\n        return QString();\n    }\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemModifiedPart {\n  String TreeItemModifiedPart::modifierToString() const\n  {\n      switch (m_modifier) {\n      case OFFSET_HEADER:\n          return QLatin1String(\"HEADER\");\n      case OFFSET_TEXT:\n          return QLatin1String(\"TEXT\");\n      case OFFSET_MIME:\n          return QLatin1String(\"MIME\");\n      case OFFSET_RAW_CONTENTS:\n          Q_ASSERT(!\"Cannot get the fetch modifier for an OFFSET_RAW_CONTENTS item\");\n          // fall through\n      default:\n          Q_ASSERT(false);\n          return QString();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "alse)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "NETWORK_ONLINE\")"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "NETWORK_EXPENSIVE\")"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "NETWORK_OFFLINE\")"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Model.h\"\ninclude <QNetworkSession>\n#\ninclude <QNetworkConfigurationManager>\n#\ninclude \"SystemNetworkWatcher.h\"\n#\n\nString policyToString(const NetworkPolicy policy)\n{\n    switch (policy) {\n    case NETWORK_OFFLINE:\n        return QLatin1String(\"NETWORK_OFFLINE\");\n    case NETWORK_EXPENSIVE:\n        return QLatin1String(\"NETWORK_EXPENSIVE\");\n    case NETWORK_ONLINE:\n        return QLatin1String(\"NETWORK_ONLINE\");\n    }\n    Q_ASSERT(false);\n    return QString();\n}"
  }
]