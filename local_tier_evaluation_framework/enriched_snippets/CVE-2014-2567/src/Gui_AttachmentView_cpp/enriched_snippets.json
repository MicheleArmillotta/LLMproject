[
  {
    "function_name": "reloadContents(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "352-356",
    "snippet": "oid AttachmentView::reloadContents()\n{\n    if (AbstractPartWidget *w = dynamic_cast<AbstractPartWidget*>(m_contentWidget))\n        w->reloadContents();\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "->reloadContents",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "reloadContents(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "352-356",
          "snippet": "oid AttachmentView::reloadContents()\n{\n    if (AbstractPartWidget *w = dynamic_cast<AbstractPartWidget*>(m_contentWidget))\n        w->reloadContents();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ynamic_cast<AbstractPartWidget*>",
          "args": [
            "_contentWidget)"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::reloadContents()\n  {\n      if (AbstractPartWidget *w = dynamic_cast<AbstractPartWidget*>(m_contentWidget))\n          w->reloadContents();\n  }\n}"
  },
  {
    "function_name": "quoteMe(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "346-350",
    "snippet": "String AttachmentView::quoteMe() const\n{\n    const AbstractPartWidget *widget = dynamic_cast<const AbstractPartWidget *>(m_contentWidget);\n    return widget && !m_contentWidget->isHidden() ? widget->quoteMe() : QString();\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "idget->quoteMe",
          "args": [],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "quoteMe(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "76-80",
          "snippet": "String LoadablePartWidget::quoteMe() const\n{\n    AbstractPartWidget *part = dynamic_cast<AbstractPartWidget*>(realPart);\n    return part ? part->quoteMe() : QString();\n}",
          "includes": [
            "include <QPushButton>",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"LoadablePartWidget.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  String LoadablePartWidget::quoteMe() const\n  {\n      AbstractPartWidget *part = dynamic_cast<AbstractPartWidget*>(realPart);\n      return part ? part->quoteMe() : QString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_contentWidget->isHidden",
          "args": [],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<const AbstractPartWidget *>",
          "args": [
            "_contentWidget)"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  String AttachmentView::quoteMe() const\n  {\n      const AbstractPartWidget *widget = dynamic_cast<const AbstractPartWidget *>(m_contentWidget);\n      return widget && !m_contentWidget->isHidden() ? widget->quoteMe() : QString();\n  }\n}"
  },
  {
    "function_name": "paintEvent(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "327-344",
    "snippet": "oid AttachmentView::paintEvent(QPaintEvent *event)\n{\n    QFrame::paintEvent(event);\n    QPainter p(this);\n    const int x = m_icon->geometry().width() + m_fileName->sizeHint().width() + 32;\n    if (x >= rect().width())\n        return;\n    QLinearGradient grad(x, 0, rect().right(), 0);\n    const QColor c = testAttribute(Qt::WA_UnderMouse) ? palette().color(QPalette::Highlight) :\n                                                        palette().color(backgroundRole()).darker(120);\n    grad.setColorAt(0, palette().color(backgroundRole()));\n    grad.setColorAt(0.5, c);\n    grad.setColorAt(1, palette().color(backgroundRole()));\n    p.setBrush(grad);\n    p.setPen(Qt::NoPen);\n    p.drawRect(x, m_fileName->geometry().center().y(), width(), 1);\n    p.end();\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": ".end",
          "args": [],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "send(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "338-370",
          "snippet": "oid ComposeWidget::send()\n{\n    // Well, Trojita is of course rock solid and will never ever crash :), but experience has shown that every now and then,\n    // there is a subtle issue $somewhere. This means that it's probably a good idea to save the draft explicitly -- better\n    // than losing some work. It's cheap anyway.\n    saveDraft(m_autoSavePath);\n\n    if (!buildMessageData())\n        return;\n\n    m_submission->setImapOptions(m_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),\n                                 m_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),\n                                 m_settings->value(Common::SettingsNames::imapHostKey).toString(),\n                                 m_settings->value(Common::SettingsNames::imapUserKey).toString(),\n                                 m_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail);\n    m_submission->setSmtpOptions(m_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),\n                                 m_settings->value(Common::SettingsNames::smtpUserKey).toString());\n\n\n    ProgressPopUp *progress = new ProgressPopUp();\n    OverlayWidget *overlay = new OverlayWidget(progress, this);\n    overlay->show();\n    setUiWidgetsEnabled(false);\n\n    connect(m_submission, SIGNAL(progressMin(int)), progress, SLOT(setMinimum(int)));\n    connect(m_submission, SIGNAL(progressMax(int)), progress, SLOT(setMaximum(int)));\n    connect(m_submission, SIGNAL(progress(int)), progress, SLOT(setValue(int)));\n    connect(m_submission, SIGNAL(updateStatusMessage(QString)), progress, SLOT(setLabelText(QString)));\n    connect(m_submission, SIGNAL(succeeded()), overlay, SLOT(deleteLater()));\n    connect(m_submission, SIGNAL(failed(QString)), overlay, SLOT(deleteLater()));\n\n    m_submission->send();\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::send()\n  {\n      // Well, Trojita is of course rock solid and will never ever crash :), but experience has shown that every now and then,\n      // there is a subtle issue $somewhere. This means that it's probably a good idea to save the draft explicitly -- better\n      // than losing some work. It's cheap anyway.\n      saveDraft(m_autoSavePath);\n  \n      if (!buildMessageData())\n          return;\n  \n      m_submission->setImapOptions(m_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),\n                                   m_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),\n                                   m_settings->value(Common::SettingsNames::imapHostKey).toString(),\n                                   m_settings->value(Common::SettingsNames::imapUserKey).toString(),\n                                   m_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail);\n      m_submission->setSmtpOptions(m_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),\n                                   m_settings->value(Common::SettingsNames::smtpUserKey).toString());\n  \n  \n      ProgressPopUp *progress = new ProgressPopUp();\n      OverlayWidget *overlay = new OverlayWidget(progress, this);\n      overlay->show();\n      setUiWidgetsEnabled(false);\n  \n      connect(m_submission, SIGNAL(progressMin(int)), progress, SLOT(setMinimum(int)));\n      connect(m_submission, SIGNAL(progressMax(int)), progress, SLOT(setMaximum(int)));\n      connect(m_submission, SIGNAL(progress(int)), progress, SLOT(setValue(int)));\n      connect(m_submission, SIGNAL(updateStatusMessage(QString)), progress, SLOT(setLabelText(QString)));\n      connect(m_submission, SIGNAL(succeeded()), overlay, SLOT(deleteLater()));\n      connect(m_submission, SIGNAL(failed(QString)), overlay, SLOT(deleteLater()));\n  \n      m_submission->send();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": ".drawRect",
          "args": [
            ",",
            "_fileName->geometry().center().y(),",
            "idth(),",
            ")"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idth(",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileName->geometry",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileName->geometry",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileName->geometry",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".setPen",
          "args": [
            "t::NoPen)"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".setBrush",
          "args": [
            "rad)"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rad.setColorAt",
          "args": [
            ",",
            "alette().color(backgroundRole()))"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "ackgroundRole())"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rad.setColorAt",
          "args": [
            ".5,",
            ")"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rad.setColorAt",
          "args": [
            ",",
            "alette().color(backgroundRole()))"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "ackgroundRole())"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "20)"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "ackgroundRole())"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "Palette::Highlight)"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "estAttribute(",
          "args": [
            "t::WA_UnderMouse)"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ect",
          "args": [],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "expandingDirections",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "109-112",
          "snippet": "Qt::Orientations FlowLayout::expandingDirections() const\n{\n    return 0;\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  Qt::Orientations FlowLayout::expandingDirections() const\n  {\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ect(",
          "args": [],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "runXtConnect()",
          "container": "onnectPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SettingsDialog.cpp",
          "lines": "860-901",
          "snippet": "d XtConnectPage::runXtConnect()\n{\n    // First of all, let's save the XTuple-specific configuration to save useless debugging\n    saveXtConfig();\n\n    QString path = QCoreApplication::applicationFilePath();\n    QStringList args;\n\n#ifdef Q_OS_WIN\n    path = path.replace(\n               QLatin1String(\"Gui/debug/trojita\"),\n               QLatin1String(\"XtConnect/debug/xtconnect-trojita\")).replace(\n               QLatin1String(\"Gui/release/trojita\"),\n               QLatin1String(\"XtConnect/release/xtconnect-trojita\"));\n    QString cmd = path;\n#else\n    path = path.replace(QLatin1String(\"src/Gui/trojita\"),\n                        QLatin1String(\"src/XtConnect/xtconnect-trojita\"));\n    args << QLatin1String(\"-e\") << path;\n    QString cmd = QLatin1String(\"xterm\");\n#endif\n\n    if (! hostName->text().isEmpty())\n        args << QLatin1String(\"-h\") << hostName->text();\n\n    if (port->value() != 5432)\n        args << QLatin1String(\"-p\") << QString::number(port->value());\n\n    if (! dbName->text().isEmpty())\n        args << QLatin1String(\"-d\") << dbName->text();\n\n    if (! username->text().isEmpty())\n        args << QLatin1String(\"-U\") << username->text();\n\n    QString password = QInputDialog::getText(this, tr(\"Database Connection\"), tr(\"Password\"), QLineEdit::Password);\n    args << QLatin1String(\"-w\") << password;\n\n    if (debugLog->isChecked())\n        args << QLatin1String(\"--log\") << cacheDir->text() + QLatin1String(\"/xt-trojita-log\");\n\n    QProcess::startDetached(cmd, args);\n}\n\nv",
          "includes": [
            "include \"Gui/Util.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include <QDataWidgetMapper>\n#",
            "include <QMessageBox>\n#",
            "include <QToolTip>\n#",
            "include <QStandardItemModel>\n#",
            "include <QDebug>\n#",
            "include <QResizeEvent>\n#",
            "include <QPushButton>\n#",
            "include <QProcess>\n#",
            "include <QVBoxLayout>\n#",
            "include <QTabWidget>\n#",
            "include <QSpinBox>\n#",
            "include <QRadioButton>\n#",
            "include <QListWidget>\n#",
            "include <QLineEdit>\n#",
            "include <QInputDialog>\n#",
            "include <QGroupBox>\n#",
            "include <QFormLayout>\n#",
            "include <QDir>\n#",
            "include <QDialogButtonBox>\n#",
            "include <QComboBox>\n#",
            "include <QCheckBox>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Gui/Util.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude <QDataWidgetMapper>\n#\ninclude <QMessageBox>\n#\ninclude <QToolTip>\n#\ninclude <QStandardItemModel>\n#\ninclude <QDebug>\n#\ninclude <QResizeEvent>\n#\ninclude <QPushButton>\n#\ninclude <QProcess>\n#\ninclude <QVBoxLayout>\n#\ninclude <QTabWidget>\n#\ninclude <QSpinBox>\n#\ninclude <QRadioButton>\n#\ninclude <QListWidget>\n#\ninclude <QLineEdit>\n#\ninclude <QInputDialog>\n#\ninclude <QGroupBox>\n#\ninclude <QFormLayout>\n#\ninclude <QDir>\n#\ninclude <QDialogButtonBox>\n#\ninclude <QComboBox>\n#\ninclude <QCheckBox>\n#\n\nonnectPage {\n  d XtConnectPage::runXtConnect()\n  {\n      // First of all, let's save the XTuple-specific configuration to save useless debugging\n      saveXtConfig();\n  \n      QString path = QCoreApplication::applicationFilePath();\n      QStringList args;\n  \n  #ifdef Q_OS_WIN\n      path = path.replace(\n                 QLatin1String(\"Gui/debug/trojita\"),\n                 QLatin1String(\"XtConnect/debug/xtconnect-trojita\")).replace(\n                 QLatin1String(\"Gui/release/trojita\"),\n                 QLatin1String(\"XtConnect/release/xtconnect-trojita\"));\n      QString cmd = path;\n  #else\n      path = path.replace(QLatin1String(\"src/Gui/trojita\"),\n                          QLatin1String(\"src/XtConnect/xtconnect-trojita\"));\n      args << QLatin1String(\"-e\") << path;\n      QString cmd = QLatin1String(\"xterm\");\n  #endif\n  \n      if (! hostName->text().isEmpty())\n          args << QLatin1String(\"-h\") << hostName->text();\n  \n      if (port->value() != 5432)\n          args << QLatin1String(\"-p\") << QString::number(port->value());\n  \n      if (! dbName->text().isEmpty())\n          args << QLatin1String(\"-d\") << dbName->text();\n  \n      if (! username->text().isEmpty())\n          args << QLatin1String(\"-U\") << username->text();\n  \n      QString password = QInputDialog::getText(this, tr(\"Database Connection\"), tr(\"Password\"), QLineEdit::Password);\n      args << QLatin1String(\"-w\") << password;\n  \n      if (debugLog->isChecked())\n          args << QLatin1String(\"--log\") << cacheDir->text() + QLatin1String(\"/xt-trojita-log\");\n  \n      QProcess::startDetached(cmd, args);\n  }\n  \n  v\n}"
        }
      },
      {
        "call_info": {
          "callee": "_fileName->sizeHint",
          "args": [],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "sizeHint",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "131-134",
          "snippet": "QSize FlowLayout::sizeHint() const\n{\n    return minimumSize();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  QSize FlowLayout::sizeHint() const\n  {\n      return minimumSize();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_icon->geometry",
          "args": [],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->geometry",
          "args": [],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Frame::paintEvent(",
          "args": [
            "vent)"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "paintEvent(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "327-344",
          "snippet": "oid AttachmentView::paintEvent(QPaintEvent *event)\n{\n    QFrame::paintEvent(event);\n    QPainter p(this);\n    const int x = m_icon->geometry().width() + m_fileName->sizeHint().width() + 32;\n    if (x >= rect().width())\n        return;\n    QLinearGradient grad(x, 0, rect().right(), 0);\n    const QColor c = testAttribute(Qt::WA_UnderMouse) ? palette().color(QPalette::Highlight) :\n                                                        palette().color(backgroundRole()).darker(120);\n    grad.setColorAt(0, palette().color(backgroundRole()));\n    grad.setColorAt(0.5, c);\n    grad.setColorAt(1, palette().color(backgroundRole()));\n    p.setBrush(grad);\n    p.setPen(Qt::NoPen);\n    p.drawRect(x, m_fileName->geometry().center().y(), width(), 1);\n    p.end();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::paintEvent(QPaintEvent *event)\n  {\n      QFrame::paintEvent(event);\n      QPainter p(this);\n      const int x = m_icon->geometry().width() + m_fileName->sizeHint().width() + 32;\n      if (x >= rect().width())\n          return;\n      QLinearGradient grad(x, 0, rect().right(), 0);\n      const QColor c = testAttribute(Qt::WA_UnderMouse) ? palette().color(QPalette::Highlight) :\n                                                          palette().color(backgroundRole()).darker(120);\n      grad.setColorAt(0, palette().color(backgroundRole()));\n      grad.setColorAt(0.5, c);\n      grad.setColorAt(1, palette().color(backgroundRole()));\n      p.setBrush(grad);\n      p.setPen(Qt::NoPen);\n      p.drawRect(x, m_fileName->geometry().center().y(), width(), 1);\n      p.end();\n  }\n}"
  },
  {
    "function_name": "mouseMoveEvent(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "306-325",
    "snippet": "oid AttachmentView::mouseMoveEvent(QMouseEvent *event)\n{\n    QFrame::mouseMoveEvent(event);\n\n    if (!(event->buttons() & Qt::LeftButton)) {\n        return;\n    }\n\n    if ((m_dragStartPos - event->pos()).manhattanLength() <  QApplication::startDragDistance())\n        return;\n\n    QMimeData *mimeData = Imap::Mailbox::mimeDataForDragAndDrop(m_partIndex);\n    if (!mimeData)\n        return;\n    event->accept();\n    QDrag *drag = new QDrag(this);\n    drag->setMimeData(mimeData);\n    drag->setHotSpot(event->pos());\n    drag->exec(Qt::CopyAction, Qt::CopyAction);\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rag->exec",
          "args": [
            "t::CopyAction,",
            "t::CopyAction)"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rag->setHotSpot",
          "args": [
            "vent->pos())"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vent->pos",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rag->setMimeData",
          "args": [
            "imeData)"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vent->accept",
          "args": [],
          "line": 320
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "ShortcutHandler",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
          "lines": "175-178",
          "snippet": "void ShortcutHandler::accept()\n{\n    m_shortcutConfigWidget->accept();\n}",
          "includes": [
            "#include \"Common/SettingsCategoryGuard.h\"",
            "#include \"ShortcutConfigWidget.h\"",
            "#include \"ShortcutConfigDialog.h\"",
            "#include \"IconLoader.h\"",
            "#include <QSettings>",
            "#include <QAction>",
            "#include \"ShortcutHandler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::accept()\n  {\n      m_shortcutConfigWidget->accept();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "map::Mailbox::mimeDataForDragAndDrop(",
          "args": [
            "_partIndex)"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::startDragDistance(",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_dragStartPos - event->pos",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vent->pos",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vent->buttons",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Frame::mouseMoveEvent(",
          "args": [
            "vent)"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "mouseMoveEvent(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "306-325",
          "snippet": "oid AttachmentView::mouseMoveEvent(QMouseEvent *event)\n{\n    QFrame::mouseMoveEvent(event);\n\n    if (!(event->buttons() & Qt::LeftButton)) {\n        return;\n    }\n\n    if ((m_dragStartPos - event->pos()).manhattanLength() <  QApplication::startDragDistance())\n        return;\n\n    QMimeData *mimeData = Imap::Mailbox::mimeDataForDragAndDrop(m_partIndex);\n    if (!mimeData)\n        return;\n    event->accept();\n    QDrag *drag = new QDrag(this);\n    drag->setMimeData(mimeData);\n    drag->setHotSpot(event->pos());\n    drag->exec(Qt::CopyAction, Qt::CopyAction);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::mouseMoveEvent(QMouseEvent *event)\n  {\n      QFrame::mouseMoveEvent(event);\n  \n      if (!(event->buttons() & Qt::LeftButton)) {\n          return;\n      }\n  \n      if ((m_dragStartPos - event->pos()).manhattanLength() <  QApplication::startDragDistance())\n          return;\n  \n      QMimeData *mimeData = Imap::Mailbox::mimeDataForDragAndDrop(m_partIndex);\n      if (!mimeData)\n          return;\n      event->accept();\n      QDrag *drag = new QDrag(this);\n      drag->setMimeData(mimeData);\n      drag->setHotSpot(event->pos());\n      drag->exec(Qt::CopyAction, Qt::CopyAction);\n  }\n}"
  },
  {
    "function_name": "mousePressEvent(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "295-304",
    "snippet": "oid AttachmentView::mousePressEvent(QMouseEvent *event)\n{\n    event->accept();\n    if (event->button() == Qt::RightButton) {\n        showMenu();\n        return;\n    }\n    m_dragStartPos = event->pos();\n    QFrame::mousePressEvent(event);\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Frame::mousePressEvent(",
          "args": [
            "vent)"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "mousePressEvent(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "295-304",
          "snippet": "oid AttachmentView::mousePressEvent(QMouseEvent *event)\n{\n    event->accept();\n    if (event->button() == Qt::RightButton) {\n        showMenu();\n        return;\n    }\n    m_dragStartPos = event->pos();\n    QFrame::mousePressEvent(event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "vent->pos",
          "args": [],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "howMenu(",
          "args": [],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "showMenu(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "257-265",
          "snippet": "oid AttachmentView::showMenu()\n{\n    if (QToolButton *btn = qobject_cast<QToolButton*>(sender())) {\n        btn->setDown(false);\n    }\n    QPoint p = QCursor::pos();\n    p.rx() -= m_menu->width()/2;\n    m_menu->popup(p);\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::showMenu()\n  {\n      if (QToolButton *btn = qobject_cast<QToolButton*>(sender())) {\n          btn->setDown(false);\n      }\n      QPoint p = QCursor::pos();\n      p.rx() -= m_menu->width()/2;\n      m_menu->popup(p);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vent->button",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vent->accept",
          "args": [],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "ShortcutHandler",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
          "lines": "175-178",
          "snippet": "void ShortcutHandler::accept()\n{\n    m_shortcutConfigWidget->accept();\n}",
          "includes": [
            "#include \"Common/SettingsCategoryGuard.h\"",
            "#include \"ShortcutConfigWidget.h\"",
            "#include \"ShortcutConfigDialog.h\"",
            "#include \"IconLoader.h\"",
            "#include <QSettings>",
            "#include <QAction>",
            "#include \"ShortcutHandler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::accept()\n  {\n      m_shortcutConfigWidget->accept();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::mousePressEvent(QMouseEvent *event)\n  {\n      event->accept();\n      if (event->button() == Qt::RightButton) {\n          showMenu();\n          return;\n      }\n      m_dragStartPos = event->pos();\n      QFrame::mousePressEvent(event);\n  }\n}"
  },
  {
    "function_name": "indicateHover(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "275-293",
    "snippet": "oid AttachmentView::indicateHover()\n{\n    if (m_menu->isVisible() || rect().contains(mapFromGlobal(QCursor::pos()))) { // WA_UnderMouse is wrong\n        if (!autoFillBackground()) {\n            setAutoFillBackground(true);\n            QPalette pal(palette());\n            QLinearGradient grad(0,0,0,height());\n            grad.setColorAt(0, pal.color(backgroundRole()));\n            grad.setColorAt(0.15, pal.color(backgroundRole()).lighter(110));\n            grad.setColorAt(0.8, pal.color(backgroundRole()).darker(110));\n            grad.setColorAt(1, pal.color(backgroundRole()));\n            pal.setBrush(backgroundRole(), grad);\n            setPalette(pal);\n        }\n    } else {\n        setAutoFillBackground(false);\n        setPalette(QPalette());\n    }\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etPalette(",
          "args": [
            "Palette())"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Palette(",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etAutoFillBackground(",
          "args": [
            "alse)"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etPalette(",
          "args": [
            "al)"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.setBrush",
          "args": [
            "ackgroundRole(),",
            "rad)"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rad.setColorAt",
          "args": [
            ",",
            "al.color(backgroundRole()))"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.color",
          "args": [
            "ackgroundRole())"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rad.setColorAt",
          "args": [
            ".8,",
            "al.color(backgroundRole()).darker(110))"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.color",
          "args": [
            "10)"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.color",
          "args": [
            "ackgroundRole())"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rad.setColorAt",
          "args": [
            ".15,",
            "al.color(backgroundRole()).lighter(110))"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.color",
          "args": [
            "10)"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.color",
          "args": [
            "ackgroundRole())"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rad.setColorAt",
          "args": [
            ",",
            "al.color(backgroundRole()))"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.color",
          "args": [
            "ackgroundRole())"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eight(",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etAutoFillBackground(",
          "args": [
            "rue)"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utoFillBackground(",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ect",
          "args": [
            "apFromGlobal(QCursor::pos()))"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "slotHeaderSectionVisibilityToggled(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "336-349",
          "snippet": "oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n{\n    QList<QAction *> actions = header()->actions();\n    if (section >= actions.size() || section < 0)\n        return;\n    bool hide = ! actions[section]->isChecked();\n\n    if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n        // This would hide the very last section, which would hide the whole header view\n        actions[section]->setChecked(true);\n    } else {\n        header()->setSectionHidden(section, hide);\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n  {\n      QList<QAction *> actions = header()->actions();\n      if (section >= actions.size() || section < 0)\n          return;\n      bool hide = ! actions[section]->isChecked();\n  \n      if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n          // This would hide the very last section, which would hide the whole header view\n          actions[section]->setChecked(true);\n      } else {\n          header()->setSectionHidden(section, hide);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "apFromGlobal(",
          "args": [
            "Cursor::pos())"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Cursor::pos(",
          "args": [],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ect(",
          "args": [],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "runXtConnect()",
          "container": "onnectPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SettingsDialog.cpp",
          "lines": "860-901",
          "snippet": "d XtConnectPage::runXtConnect()\n{\n    // First of all, let's save the XTuple-specific configuration to save useless debugging\n    saveXtConfig();\n\n    QString path = QCoreApplication::applicationFilePath();\n    QStringList args;\n\n#ifdef Q_OS_WIN\n    path = path.replace(\n               QLatin1String(\"Gui/debug/trojita\"),\n               QLatin1String(\"XtConnect/debug/xtconnect-trojita\")).replace(\n               QLatin1String(\"Gui/release/trojita\"),\n               QLatin1String(\"XtConnect/release/xtconnect-trojita\"));\n    QString cmd = path;\n#else\n    path = path.replace(QLatin1String(\"src/Gui/trojita\"),\n                        QLatin1String(\"src/XtConnect/xtconnect-trojita\"));\n    args << QLatin1String(\"-e\") << path;\n    QString cmd = QLatin1String(\"xterm\");\n#endif\n\n    if (! hostName->text().isEmpty())\n        args << QLatin1String(\"-h\") << hostName->text();\n\n    if (port->value() != 5432)\n        args << QLatin1String(\"-p\") << QString::number(port->value());\n\n    if (! dbName->text().isEmpty())\n        args << QLatin1String(\"-d\") << dbName->text();\n\n    if (! username->text().isEmpty())\n        args << QLatin1String(\"-U\") << username->text();\n\n    QString password = QInputDialog::getText(this, tr(\"Database Connection\"), tr(\"Password\"), QLineEdit::Password);\n    args << QLatin1String(\"-w\") << password;\n\n    if (debugLog->isChecked())\n        args << QLatin1String(\"--log\") << cacheDir->text() + QLatin1String(\"/xt-trojita-log\");\n\n    QProcess::startDetached(cmd, args);\n}\n\nv",
          "includes": [
            "include \"Gui/Util.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include <QDataWidgetMapper>\n#",
            "include <QMessageBox>\n#",
            "include <QToolTip>\n#",
            "include <QStandardItemModel>\n#",
            "include <QDebug>\n#",
            "include <QResizeEvent>\n#",
            "include <QPushButton>\n#",
            "include <QProcess>\n#",
            "include <QVBoxLayout>\n#",
            "include <QTabWidget>\n#",
            "include <QSpinBox>\n#",
            "include <QRadioButton>\n#",
            "include <QListWidget>\n#",
            "include <QLineEdit>\n#",
            "include <QInputDialog>\n#",
            "include <QGroupBox>\n#",
            "include <QFormLayout>\n#",
            "include <QDir>\n#",
            "include <QDialogButtonBox>\n#",
            "include <QComboBox>\n#",
            "include <QCheckBox>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Gui/Util.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude <QDataWidgetMapper>\n#\ninclude <QMessageBox>\n#\ninclude <QToolTip>\n#\ninclude <QStandardItemModel>\n#\ninclude <QDebug>\n#\ninclude <QResizeEvent>\n#\ninclude <QPushButton>\n#\ninclude <QProcess>\n#\ninclude <QVBoxLayout>\n#\ninclude <QTabWidget>\n#\ninclude <QSpinBox>\n#\ninclude <QRadioButton>\n#\ninclude <QListWidget>\n#\ninclude <QLineEdit>\n#\ninclude <QInputDialog>\n#\ninclude <QGroupBox>\n#\ninclude <QFormLayout>\n#\ninclude <QDir>\n#\ninclude <QDialogButtonBox>\n#\ninclude <QComboBox>\n#\ninclude <QCheckBox>\n#\n\nonnectPage {\n  d XtConnectPage::runXtConnect()\n  {\n      // First of all, let's save the XTuple-specific configuration to save useless debugging\n      saveXtConfig();\n  \n      QString path = QCoreApplication::applicationFilePath();\n      QStringList args;\n  \n  #ifdef Q_OS_WIN\n      path = path.replace(\n                 QLatin1String(\"Gui/debug/trojita\"),\n                 QLatin1String(\"XtConnect/debug/xtconnect-trojita\")).replace(\n                 QLatin1String(\"Gui/release/trojita\"),\n                 QLatin1String(\"XtConnect/release/xtconnect-trojita\"));\n      QString cmd = path;\n  #else\n      path = path.replace(QLatin1String(\"src/Gui/trojita\"),\n                          QLatin1String(\"src/XtConnect/xtconnect-trojita\"));\n      args << QLatin1String(\"-e\") << path;\n      QString cmd = QLatin1String(\"xterm\");\n  #endif\n  \n      if (! hostName->text().isEmpty())\n          args << QLatin1String(\"-h\") << hostName->text();\n  \n      if (port->value() != 5432)\n          args << QLatin1String(\"-p\") << QString::number(port->value());\n  \n      if (! dbName->text().isEmpty())\n          args << QLatin1String(\"-d\") << dbName->text();\n  \n      if (! username->text().isEmpty())\n          args << QLatin1String(\"-U\") << username->text();\n  \n      QString password = QInputDialog::getText(this, tr(\"Database Connection\"), tr(\"Password\"), QLineEdit::Password);\n      args << QLatin1String(\"-w\") << password;\n  \n      if (debugLog->isChecked())\n          args << QLatin1String(\"--log\") << cacheDir->text() + QLatin1String(\"/xt-trojita-log\");\n  \n      QProcess::startDetached(cmd, args);\n  }\n  \n  v\n}"
        }
      },
      {
        "call_info": {
          "callee": "_menu->isVisible",
          "args": [],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::indicateHover()\n  {\n      if (m_menu->isVisible() || rect().contains(mapFromGlobal(QCursor::pos()))) { // WA_UnderMouse is wrong\n          if (!autoFillBackground()) {\n              setAutoFillBackground(true);\n              QPalette pal(palette());\n              QLinearGradient grad(0,0,0,height());\n              grad.setColorAt(0, pal.color(backgroundRole()));\n              grad.setColorAt(0.15, pal.color(backgroundRole()).lighter(110));\n              grad.setColorAt(0.8, pal.color(backgroundRole()).darker(110));\n              grad.setColorAt(1, pal.color(backgroundRole()));\n              pal.setBrush(backgroundRole(), grad);\n              setPalette(pal);\n          }\n      } else {\n          setAutoFillBackground(false);\n          setPalette(QPalette());\n      }\n  }\n}"
  },
  {
    "function_name": "toggleIconCursor(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "267-273",
    "snippet": "oid AttachmentView::toggleIconCursor()\n{\n    if (m_icon->isDown())\n        m_icon->setCursor(Qt::OpenHandCursor);\n    else\n        m_icon->setCursor(Qt::ArrowCursor);\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_icon->setCursor",
          "args": [
            "t::ArrowCursor)"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setCursor",
          "args": [
            "t::OpenHandCursor)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->isDown",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::toggleIconCursor()\n  {\n      if (m_icon->isDown())\n          m_icon->setCursor(Qt::OpenHandCursor);\n      else\n          m_icon->setCursor(Qt::ArrowCursor);\n  }\n}"
  },
  {
    "function_name": "showMenu(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "257-265",
    "snippet": "oid AttachmentView::showMenu()\n{\n    if (QToolButton *btn = qobject_cast<QToolButton*>(sender())) {\n        btn->setDown(false);\n    }\n    QPoint p = QCursor::pos();\n    p.rx() -= m_menu->width()/2;\n    m_menu->popup(p);\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_menu->popup",
          "args": [
            ")"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_menu->width",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".rx",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Cursor::pos(",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tn->setDown",
          "args": [
            "alse)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object_cast<QToolButton*>",
          "args": [
            "ender())"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ender(",
          "args": [],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "sender(",
          "container": "neMessageModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/OneMessageModel.cpp",
          "lines": "134-137",
          "snippet": "VariantList OneMessageModel::sender() const\n{\n    return m_message.data(RoleMessageSender).toList();\n}",
          "includes": [
            "include \"SubtreeModel.h\"",
            "include \"Model.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"FindInterestingPart.h\"\n#",
            "include \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#",
            "include \"OneMessageModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SubtreeModel.h\"\ninclude \"Model.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"FindInterestingPart.h\"\n#\ninclude \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#\ninclude \"OneMessageModel.h\"\n#\n\nneMessageModel {\n  VariantList OneMessageModel::sender() const\n  {\n      return m_message.data(RoleMessageSender).toList();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::showMenu()\n  {\n      if (QToolButton *btn = qobject_cast<QToolButton*>(sender())) {\n          btn->setDown(false);\n      }\n      QPoint p = QCursor::pos();\n      p.rx() -= m_menu->width()/2;\n      m_menu->popup(p);\n  }\n}"
  },
  {
    "function_name": "updateShowHideAttachmentState(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "251-255",
    "snippet": "oid AttachmentView::updateShowHideAttachmentState()\n{\n    if (m_showHideAttachment)\n        m_showHideAttachment->setChecked(m_contentWidget && m_contentWidget->isVisibleTo(this));\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_showHideAttachment->setChecked",
          "args": [
            "_contentWidget && m_contentWidget->isVisibleTo(this))"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_contentWidget->isVisibleTo",
          "args": [
            "his)"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::updateShowHideAttachmentState()\n  {\n      if (m_showHideAttachment)\n          m_showHideAttachment->setChecked(m_contentWidget && m_contentWidget->isVisibleTo(this));\n  }\n}"
  },
  {
    "function_name": "openDownloadedAttachment(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "235-249",
    "snippet": "oid AttachmentView::openDownloadedAttachment()\n{\n    Q_ASSERT(m_tmpFile);\n\n    // Make sure that the file is read-only so that the launched application does not attempt to modify it\n    m_tmpFile->setPermissions(QFile::ReadOwner);\n\n    QDesktopServices::openUrl(QUrl::fromLocalFile(m_tmpFile->fileName()));\n\n    // This will delete the temporary file in ten seconds. It should give the application plenty of time to start and also prevent\n    // leaving cruft behind.\n    new Common::DeleteAfter(m_tmpFile, 10000);\n    m_tmpFile = 0;\n    m_openAttachment->setEnabled(true);\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_openAttachment->setEnabled",
          "args": [
            "rue)"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DesktopServices::openUrl(",
          "args": [
            "Url::fromLocalFile(m_tmpFile->fileName()))"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Url::fromLocalFile(",
          "args": [
            "_tmpFile->fileName())"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_tmpFile->fileName",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_tmpFile->setPermissions",
          "args": [
            "File::ReadOwner)"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_tmpFile)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::openDownloadedAttachment()\n  {\n      Q_ASSERT(m_tmpFile);\n  \n      // Make sure that the file is read-only so that the launched application does not attempt to modify it\n      m_tmpFile->setPermissions(QFile::ReadOwner);\n  \n      QDesktopServices::openUrl(QUrl::fromLocalFile(m_tmpFile->fileName()));\n  \n      // This will delete the temporary file in ten seconds. It should give the application plenty of time to start and also prevent\n      // leaving cruft behind.\n      new Common::DeleteAfter(m_tmpFile, 10000);\n      m_tmpFile = 0;\n      m_openAttachment->setEnabled(true);\n  }\n}"
  },
  {
    "function_name": "onOpenFailed(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "228-233",
    "snippet": "oid AttachmentView::onOpenFailed()\n{\n    delete m_tmpFile;\n    m_tmpFile = 0;\n    m_openAttachment->setEnabled(true);\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_openAttachment->setEnabled",
          "args": [
            "rue)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::onOpenFailed()\n  {\n      delete m_tmpFile;\n      m_tmpFile = 0;\n      m_openAttachment->setEnabled(true);\n  }\n}"
  },
  {
    "function_name": "enableDownloadAgain(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "223-226",
    "snippet": "oid AttachmentView::enableDownloadAgain()\n{\n    m_downloadAttachment->setEnabled(true);\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_downloadAttachment->setEnabled",
          "args": [
            "rue)"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::enableDownloadAgain()\n  {\n      m_downloadAttachment->setEnabled(true);\n  }\n}"
  },
  {
    "function_name": "slotFileNameRequested(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "217-221",
    "snippet": "oid AttachmentView::slotFileNameRequested(QString *fileName)\n{\n    QString fileLocation = QDir(Common::writablePath(Common::LOCATION_DOWNLOAD)).filePath(*fileName);\n    *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Attachment\"), fileLocation, QString(), 0, QFileDialog::HideNameFilterDetails);\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FileDialog::getSaveFileName(",
          "args": [
            "his,",
            "r(\"Save Attachment\"),",
            "ileLocation,",
            "String(),",
            ",",
            "FileDialog::HideNameFilterDetails)"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Save Attachment\")"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Dir",
          "args": [
            "fileName)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Dir(",
          "args": [
            "ommon::writablePath(Common::LOCATION_DOWNLOAD))"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ommon::writablePath(",
          "args": [
            "ommon::LOCATION_DOWNLOAD)"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::slotFileNameRequested(QString *fileName)\n  {\n      QString fileLocation = QDir(Common::writablePath(Common::LOCATION_DOWNLOAD)).filePath(*fileName);\n      *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Attachment\"), fileLocation, QString(), 0, QFileDialog::HideNameFilterDetails);\n  }\n}"
  },
  {
    "function_name": "slotFileNameRequestedOnOpen(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "208-215",
    "snippet": "oid AttachmentView::slotFileNameRequestedOnOpen(QString *fileName)\n{\n    Q_ASSERT(!m_tmpFile);\n    m_tmpFile = new QTemporaryFile(QDir::tempPath() + QLatin1String(\"/trojita-attachment-XXXXXX-\") +\n                                   fileName->replace(QLatin1Char('/'), QLatin1Char('_')));\n    m_tmpFile->open();\n    *fileName = m_tmpFile->fileName();\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_tmpFile->fileName",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_tmpFile->open",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ileName->replace",
          "args": [
            "Latin1Char('/'),",
            "Latin1Char('_'))"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "_')"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "/')"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "/trojita-attachment-XXXXXX-\")"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Dir::tempPath(",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "m_tmpFile)"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::slotFileNameRequestedOnOpen(QString *fileName)\n  {\n      Q_ASSERT(!m_tmpFile);\n      m_tmpFile = new QTemporaryFile(QDir::tempPath() + QLatin1String(\"/trojita-attachment-XXXXXX-\") +\n                                     fileName->replace(QLatin1Char('/'), QLatin1Char('_')));\n      m_tmpFile->open();\n      *fileName = m_tmpFile->fileName();\n  }\n}"
  },
  {
    "function_name": "slotOpenAttachment(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "193-206",
    "snippet": "oid AttachmentView::slotOpenAttachment()\n{\n    m_openAttachment->setEnabled(false);\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccess, m_partIndex);\n    connect(manager, SIGNAL(fileNameRequested(QString*)), this, SLOT(slotFileNameRequestedOnOpen(QString*)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), this, SLOT(onOpenFailed()));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    // we aren't connecting to cancelled() as it cannot really happen -- the filename is never empty\n    connect(manager, SIGNAL(succeeded()), this, SLOT(openDownloadedAttachment()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadPart();\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "anager->downloadPart",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "downloadPart(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "57-83",
          "snippet": "oid FileDownloadManager::downloadPart()\n{\n    if (!partIndex.isValid()) {\n        emit transferError(tr(\"FileDownloadManager::downloadPart(): part has disappeared\"));\n        return;\n    }\n    QString saveFileName = toRealFileName(partIndex);\n    emit fileNameRequested(&saveFileName);\n    if (saveFileName.isEmpty()) {\n        emit cancelled();\n        return;\n    }\n\n    saving.setFileName(saveFileName);\n    saved = false;\n\n    QNetworkRequest request;\n    QUrl url;\n    url.setScheme(QLatin1String(\"trojita-imap\"));\n    url.setHost(QLatin1String(\"msg\"));\n    url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n    request.setUrl(url);\n    reply = manager->get(request);\n    connect(reply, SIGNAL(finished()), this, SLOT(onPartDataTransfered()));\n    connect(reply, SIGNAL(error(QNetworkReply::NetworkError)), this, SLOT(onReplyTransferError()));\n    connect(manager, SIGNAL(finished(QNetworkReply *)), this, SLOT(deleteReply(QNetworkReply *)));\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::downloadPart()\n  {\n      if (!partIndex.isValid()) {\n          emit transferError(tr(\"FileDownloadManager::downloadPart(): part has disappeared\"));\n          return;\n      }\n      QString saveFileName = toRealFileName(partIndex);\n      emit fileNameRequested(&saveFileName);\n      if (saveFileName.isEmpty()) {\n          emit cancelled();\n          return;\n      }\n  \n      saving.setFileName(saveFileName);\n      saved = false;\n  \n      QNetworkRequest request;\n      QUrl url;\n      url.setScheme(QLatin1String(\"trojita-imap\"));\n      url.setHost(QLatin1String(\"msg\"));\n      url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n      request.setUrl(url);\n      reply = manager->get(request);\n      connect(reply, SIGNAL(finished()), this, SLOT(onPartDataTransfered()));\n      connect(reply, SIGNAL(error(QNetworkReply::NetworkError)), this, SLOT(onReplyTransferError()));\n      connect(manager, SIGNAL(finished(QNetworkReply *)), this, SLOT(deleteReply(QNetworkReply *)));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(succeeded()),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ucceeded())"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ucceeded(",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendSucceeded(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "347-364",
          "snippet": "oid Submission::slotAppendSucceeded()\n{\n    if (m_appendUid && m_appendUidValidity) {\n        // Only ever consider valid UIDVALIDITY/UID pair\n        m_appendUidReceived = true;\n\n        if (m_useBurl) {\n            slotAskForUrl();\n        } else {\n            slotInvokeMsaNow();\n        }\n    } else {\n        m_useBurl = false;\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                          QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n        slotInvokeMsaNow();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendSucceeded()\n  {\n      if (m_appendUid && m_appendUidValidity) {\n          // Only ever consider valid UIDVALIDITY/UID pair\n          m_appendUidReceived = true;\n  \n          if (m_useBurl) {\n              slotAskForUrl();\n          } else {\n              slotInvokeMsaNow();\n          }\n      } else {\n          m_useBurl = false;\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                            QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n          slotInvokeMsaNow();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(succeeded()),",
            "his,",
            "LOT(openDownloadedAttachment()))"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "penDownloadedAttachment())"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "penDownloadedAttachment(",
          "args": [],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "openDownloadedAttachment(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "235-249",
          "snippet": "oid AttachmentView::openDownloadedAttachment()\n{\n    Q_ASSERT(m_tmpFile);\n\n    // Make sure that the file is read-only so that the launched application does not attempt to modify it\n    m_tmpFile->setPermissions(QFile::ReadOwner);\n\n    QDesktopServices::openUrl(QUrl::fromLocalFile(m_tmpFile->fileName()));\n\n    // This will delete the temporary file in ten seconds. It should give the application plenty of time to start and also prevent\n    // leaving cruft behind.\n    new Common::DeleteAfter(m_tmpFile, 10000);\n    m_tmpFile = 0;\n    m_openAttachment->setEnabled(true);\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::openDownloadedAttachment()\n  {\n      Q_ASSERT(m_tmpFile);\n  \n      // Make sure that the file is read-only so that the launched application does not attempt to modify it\n      m_tmpFile->setPermissions(QFile::ReadOwner);\n  \n      QDesktopServices::openUrl(QUrl::fromLocalFile(m_tmpFile->fileName()));\n  \n      // This will delete the temporary file in ten seconds. It should give the application plenty of time to start and also prevent\n      // leaving cruft behind.\n      new Common::DeleteAfter(m_tmpFile, 10000);\n      m_tmpFile = 0;\n      m_openAttachment->setEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ucceeded())"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ransferError(",
          "args": [
            "String)"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadTransferError(const QS",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1696-1700",
          "snippet": "Window::slotDownloadTransferError(const QString &errorString)\n{\n    QMessageBox::critical(this, tr(\"Can't save into file\"),\n                          tr(\"Unable to save into file. Error:\\n%1\").arg(errorString));\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotDownloadTransferError(const QString &errorString)\n  {\n      QMessageBox::critical(this, tr(\"Can't save into file\"),\n                            tr(\"Unable to save into file. Error:\\n%1\").arg(errorString));\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "his,",
            "LOT(onOpenFailed()))"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nOpenFailed())"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nOpenFailed(",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "onOpenFailed(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "228-233",
          "snippet": "oid AttachmentView::onOpenFailed()\n{\n    delete m_tmpFile;\n    m_tmpFile = 0;\n    m_openAttachment->setEnabled(true);\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::onOpenFailed()\n  {\n      delete m_tmpFile;\n      m_tmpFile = 0;\n      m_openAttachment->setEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "_messageView,",
            "IGNAL(transferError(QString)))"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_openAttachment->setEnabled",
          "args": [
            "alse)"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::slotOpenAttachment()\n  {\n      m_openAttachment->setEnabled(false);\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccess, m_partIndex);\n      connect(manager, SIGNAL(fileNameRequested(QString*)), this, SLOT(slotFileNameRequestedOnOpen(QString*)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), this, SLOT(onOpenFailed()));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      // we aren't connecting to cancelled() as it cannot really happen -- the filename is never empty\n      connect(manager, SIGNAL(succeeded()), this, SLOT(openDownloadedAttachment()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadPart();\n  }\n}"
  },
  {
    "function_name": "slotDownloadAttachment(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "177-191",
    "snippet": "oid AttachmentView::slotDownloadAttachment()\n{\n    m_downloadAttachment->setEnabled(false);\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccess, m_partIndex);\n    connect(manager, SIGNAL(fileNameRequested(QString*)), this, SLOT(slotFileNameRequested(QString*)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), this, SLOT(enableDownloadAgain()));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(cancelled()), this, SLOT(enableDownloadAgain()));\n    connect(manager, SIGNAL(cancelled()), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), this, SLOT(enableDownloadAgain()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadPart();\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "anager->downloadPart",
          "args": [],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "downloadPart(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "57-83",
          "snippet": "oid FileDownloadManager::downloadPart()\n{\n    if (!partIndex.isValid()) {\n        emit transferError(tr(\"FileDownloadManager::downloadPart(): part has disappeared\"));\n        return;\n    }\n    QString saveFileName = toRealFileName(partIndex);\n    emit fileNameRequested(&saveFileName);\n    if (saveFileName.isEmpty()) {\n        emit cancelled();\n        return;\n    }\n\n    saving.setFileName(saveFileName);\n    saved = false;\n\n    QNetworkRequest request;\n    QUrl url;\n    url.setScheme(QLatin1String(\"trojita-imap\"));\n    url.setHost(QLatin1String(\"msg\"));\n    url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n    request.setUrl(url);\n    reply = manager->get(request);\n    connect(reply, SIGNAL(finished()), this, SLOT(onPartDataTransfered()));\n    connect(reply, SIGNAL(error(QNetworkReply::NetworkError)), this, SLOT(onReplyTransferError()));\n    connect(manager, SIGNAL(finished(QNetworkReply *)), this, SLOT(deleteReply(QNetworkReply *)));\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::downloadPart()\n  {\n      if (!partIndex.isValid()) {\n          emit transferError(tr(\"FileDownloadManager::downloadPart(): part has disappeared\"));\n          return;\n      }\n      QString saveFileName = toRealFileName(partIndex);\n      emit fileNameRequested(&saveFileName);\n      if (saveFileName.isEmpty()) {\n          emit cancelled();\n          return;\n      }\n  \n      saving.setFileName(saveFileName);\n      saved = false;\n  \n      QNetworkRequest request;\n      QUrl url;\n      url.setScheme(QLatin1String(\"trojita-imap\"));\n      url.setHost(QLatin1String(\"msg\"));\n      url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n      request.setUrl(url);\n      reply = manager->get(request);\n      connect(reply, SIGNAL(finished()), this, SLOT(onPartDataTransfered()));\n      connect(reply, SIGNAL(error(QNetworkReply::NetworkError)), this, SLOT(onReplyTransferError()));\n      connect(manager, SIGNAL(finished(QNetworkReply *)), this, SLOT(deleteReply(QNetworkReply *)));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(succeeded()),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ucceeded())"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ucceeded(",
          "args": [],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendSucceeded(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "347-364",
          "snippet": "oid Submission::slotAppendSucceeded()\n{\n    if (m_appendUid && m_appendUidValidity) {\n        // Only ever consider valid UIDVALIDITY/UID pair\n        m_appendUidReceived = true;\n\n        if (m_useBurl) {\n            slotAskForUrl();\n        } else {\n            slotInvokeMsaNow();\n        }\n    } else {\n        m_useBurl = false;\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                          QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n        slotInvokeMsaNow();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendSucceeded()\n  {\n      if (m_appendUid && m_appendUidValidity) {\n          // Only ever consider valid UIDVALIDITY/UID pair\n          m_appendUidReceived = true;\n  \n          if (m_useBurl) {\n              slotAskForUrl();\n          } else {\n              slotInvokeMsaNow();\n          }\n      } else {\n          m_useBurl = false;\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                            QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n          slotInvokeMsaNow();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(succeeded()),",
            "his,",
            "LOT(enableDownloadAgain()))"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nableDownloadAgain())"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nableDownloadAgain(",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "enableDownloadAgain(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "223-226",
          "snippet": "oid AttachmentView::enableDownloadAgain()\n{\n    m_downloadAttachment->setEnabled(true);\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::enableDownloadAgain()\n  {\n      m_downloadAttachment->setEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ucceeded())"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(cancelled()),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ancelled())"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ancelled(",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(cancelled()),",
            "his,",
            "LOT(enableDownloadAgain()))"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nableDownloadAgain())"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ancelled())"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ancelled(",
          "args": [],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ransferError(",
          "args": [
            "String)"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadTransferError(const QS",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1696-1700",
          "snippet": "Window::slotDownloadTransferError(const QString &errorString)\n{\n    QMessageBox::critical(this, tr(\"Can't save into file\"),\n                          tr(\"Unable to save into file. Error:\\n%1\").arg(errorString));\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotDownloadTransferError(const QString &errorString)\n  {\n      QMessageBox::critical(this, tr(\"Can't save into file\"),\n                            tr(\"Unable to save into file. Error:\\n%1\").arg(errorString));\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "his,",
            "LOT(enableDownloadAgain()))"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nableDownloadAgain())"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "_messageView,",
            "IGNAL(transferError(QString)))"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_downloadAttachment->setEnabled",
          "args": [
            "alse)"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::slotDownloadAttachment()\n  {\n      m_downloadAttachment->setEnabled(false);\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccess, m_partIndex);\n      connect(manager, SIGNAL(fileNameRequested(QString*)), this, SLOT(slotFileNameRequested(QString*)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), this, SLOT(enableDownloadAgain()));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(cancelled()), this, SLOT(enableDownloadAgain()));\n      connect(manager, SIGNAL(cancelled()), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), this, SLOT(enableDownloadAgain()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadPart();\n  }\n}"
  },
  {
    "function_name": "AttachmentView(",
    "container": "ttachmentView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
    "lines": "59-175",
    "snippet": "ttachmentView::AttachmentView(QWidget *parent, Imap::Network::MsgPartNetAccessManager *manager,\n                               const QModelIndex &partIndex, MessageView *messageView, QWidget *contentWidget):\n    QFrame(parent), m_partIndex(partIndex), m_messageView(messageView), m_downloadAttachment(0),\n    m_openAttachment(0), m_showHideAttachment(0), m_netAccess(manager), m_tmpFile(0),\n    m_contentWidget(contentWidget)\n{\n    setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Fixed);\n    setFrameStyle(QFrame::NoFrame);\n    setCursor(Qt::OpenHandCursor);\n    setAttribute(Qt::WA_Hover);\n\n    // not actually required, but styles may assume the parameter and segfault on nullptr deref\n    QStyleOption opt;\n    opt.initFrom(this);\n\n    const int padding = style()->pixelMetric(QStyle::PM_DefaultFrameWidth, &opt, this);\n    setContentsMargins(padding, 0, padding, 0);\n\n    QHBoxLayout *layout = new QHBoxLayout();\n    layout->setContentsMargins(0,0,0,0);\n\n    // should be PM_LayoutHorizontalSpacing, but is not implemented by many Qt4 styles -including oxygen- for other conflicts\n    int spacing = style()->pixelMetric(QStyle::PM_LayoutHorizontalSpacing, &opt, this);\n    if (spacing < 0)\n        spacing = style()->pixelMetric(QStyle::PM_DefaultLayoutSpacing, &opt, this);\n    layout->setSpacing(0);\n\n    m_menu = new QMenu(this);\n    m_downloadAttachment = m_menu->addAction(loadIcon(QLatin1String(\"document-save-as\")), tr(\"Download\"));\n    m_openAttachment = m_menu->addAction(tr(\"Open Directly\"));\n    connect(m_downloadAttachment, SIGNAL(triggered()), this, SLOT(slotDownloadAttachment()));\n    connect(m_openAttachment, SIGNAL(triggered()), this, SLOT(slotOpenAttachment()));\n    connect(m_menu, SIGNAL(aboutToShow()), this, SLOT(updateShowHideAttachmentState()));\n    if (m_contentWidget) {\n        m_showHideAttachment = m_menu->addAction(loadIcon(QLatin1String(\"view-preview\")), tr(\"Show Preview\"));\n        m_showHideAttachment->setCheckable(true);\n        m_showHideAttachment->setChecked(!m_contentWidget->isHidden());\n        connect(m_showHideAttachment, SIGNAL(triggered(bool)), m_contentWidget, SLOT(setVisible(bool)));\n    }\n\n    // Icon on the left\n    m_icon = new QToolButton(this);\n    m_icon->setAttribute(Qt::WA_NoMousePropagation, false); // inform us for DnD\n    m_icon->setAutoRaise(true);\n    m_icon->setIconSize(QSize(22,22));\n    m_icon->setToolButtonStyle(Qt::ToolButtonIconOnly);\n    m_icon->setPopupMode(QToolButton::MenuButtonPopup);\n    m_icon->setMenu(m_menu);\n    connect(m_icon, SIGNAL(pressed()), SLOT(toggleIconCursor()));\n    connect(m_icon, SIGNAL(clicked()), m_icon, SLOT(showMenu()));\n    connect(m_icon, SIGNAL(released()), SLOT(toggleIconCursor()));\n    m_icon->setCursor(Qt::ArrowCursor);\n\n    QString mimeDescription = partIndex.data(Imap::Mailbox::RolePartMimeType).toString();\n    QString rawMime = mimeDescription;\n    QMimeType mimeType = QMimeDatabase().mimeTypeForName(mimeDescription);\n    if (mimeType.isValid() && !mimeType.isDefault()) {\n        mimeDescription = mimeType.comment();\n        QIcon icon;\n        if (rawMime == QLatin1String(\"message/rfc822\")) {\n            // Special case for plain e-mail messages. Motivation for this is that most of the OSes ship these icons\n            // with a pixmap which shows something like a sheet of paper as the background. I find it rather dumb\n            // to do this in the context of a MUA where attached messages are pretty common, which is why this special\n            // case is in place. Comments welcome.\n            icon = loadIcon(QLatin1String(\"trojita\"));\n        } else {\n            icon = QIcon::fromTheme(mimeType.iconName(),\n                                    QIcon::fromTheme(mimeType.genericIconName(), loadIcon(QLatin1String(\"mail-attachment\")))\n                                    );\n        }\n        m_icon->setIcon(icon);\n    } else {\n        m_icon->setIcon(loadIcon(QLatin1String(\"mail-attachment\")));\n    }\n\n    layout->addWidget(m_icon);\n\n    // space between icon and label\n    layout->addSpacing(spacing);\n\n    QVBoxLayout *subLayout = new QVBoxLayout;\n    subLayout->setContentsMargins(0,0,0,0);\n    // The file name shall be mouse-selectable\n    m_fileName = new QLabel(this);\n    m_fileName->setTextFormat(Qt::PlainText);\n    m_fileName->setText(partIndex.data(Imap::Mailbox::RolePartFileName).toString());\n    m_fileName->setTextInteractionFlags(Qt::TextSelectableByMouse);\n    m_fileName->setCursor(Qt::IBeamCursor);\n    m_fileName->setSizePolicy(QSizePolicy::Fixed, QSizePolicy::Fixed);\n    subLayout->addWidget(m_fileName);\n\n    // Some metainformation -- the MIME type and the file size\n    QLabel *lbl = new QLabel(tr(\"%2, %3\").arg(mimeDescription,\n                                      Imap::Mailbox::PrettySize::prettySize(partIndex.data(Imap::Mailbox::RolePartOctets).toUInt(),\n                                                                            Imap::Mailbox::PrettySize::WITH_BYTES_SUFFIX)));\n    if (rawMime != mimeDescription) {\n        lbl->setToolTip(rawMime);\n    }\n    QFont f(lbl->font());\n    f.setItalic(true);\n    if (f.pointSize() > -1) // don't try the below on pixel fonts ever.\n        f.setPointSizeF(f.pointSizeF() * 0.8);\n    lbl->setFont(f);\n    subLayout->addWidget(lbl);\n    layout->addLayout(subLayout);\n\n    // space between label and arrow\n    layout->addSpacing(spacing);\n\n    layout->addStretch(100);\n\n    QVBoxLayout *contentLayout = new QVBoxLayout(this);\n    contentLayout->addLayout(layout);\n    if (m_contentWidget) {\n        contentLayout->addWidget(m_contentWidget);\n    }\n}",
    "includes": [
      "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
      "include <QMimeDatabase>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QTemporaryFile>\n#",
      "include <QStyleOption>\n#",
      "include <QStyle>\n#",
      "include <QLabel>\n#",
      "include <QPushButton>\n#",
      "include <QPainter>\n#",
      "include <QMouseEvent>\n#",
      "include <QMimeData>\n#",
      "include <QMenu>\n#",
      "include <QHBoxLayout>\n#",
      "include <QFileDialog>\n#",
      "include <QDrag>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/DragAndDrop.h\"\n#",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/DeleteAfter.h\"\n#",
      "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
      "include \"IconLoader.h\"\n#",
      "include \"AttachmentView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ontentLayout->addWidget",
          "args": [
            "_contentWidget)"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ontentLayout->addLayout",
          "args": [
            "ayout)"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addStretch",
          "args": [
            "00)"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addSpacing",
          "args": [
            "pacing)"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addLayout",
          "args": [
            "ubLayout)"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubLayout->addWidget",
          "args": [
            "bl)"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bl->setFont",
          "args": [
            ")"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".setPointSizeF",
          "args": [
            ".pointSizeF() * 0.8)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".pointSizeF",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".pointSize",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".setItalic",
          "args": [
            "rue)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bl->font",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bl->setToolTip",
          "args": [
            "awMime)"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "imeDescription,",
            "map::Mailbox::PrettySize::prettySize(partIndex.data(Imap::Mailbox::RolePartOctets).toUInt(),\n                                                                            Imap::Mailbox::PrettySize::WITH_BYTES_SUFFIX))"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "MessageSourceWidget",
          "container": "MessageSourceWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageSourceWidget.cpp",
          "lines": "32-48",
          "snippet": "MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n    QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n{\n    setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n    Q_ASSERT(messageIndex.isValid());\n    page()->setNetworkAccessManager(0);\n\n    m_loadingSpinner = new Spinner(this);\n    m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n    m_loadingSpinner->setType(Spinner::Sun);\n    m_loadingSpinner->start(250);\n\n    m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n    connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n    connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n    m_combiner->load();\n}",
          "includes": [
            "#include \"Imap/Model/FullMessageCombiner.h\"",
            "#include \"Gui/Spinner.h\"",
            "#include \"Gui/IconLoader.h\"",
            "#include <QModelIndex>",
            "#include \"MessageSourceWidget.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Imap/Model/FullMessageCombiner.h\"\n#include \"Gui/Spinner.h\"\n#include \"Gui/IconLoader.h\"\n#include <QModelIndex>\n#include \"MessageSourceWidget.h\"\n\nMessageSourceWidget {\n  MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n      QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n  {\n      setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n      Q_ASSERT(messageIndex.isValid());\n      page()->setNetworkAccessManager(0);\n  \n      m_loadingSpinner = new Spinner(this);\n      m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n      m_loadingSpinner->setType(Spinner::Sun);\n      m_loadingSpinner->start(250);\n  \n      m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n      connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n      connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n      m_combiner->load();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "map::Mailbox::PrettySize::prettySize(",
          "args": [
            "artIndex.data(Imap::Mailbox::RolePartOctets).toUInt(),",
            "map::Mailbox::PrettySize::WITH_BYTES_SUFFIX)"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "prettySize(",
          "container": "rettySize",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Utils.cpp",
          "lines": "50-76",
          "snippet": "String PrettySize::prettySize(uint bytes, const ShowBytesSuffix compactUnitFormat)\n{\n    if (bytes == 0) {\n        return tr(\"0\");\n    }\n    int order = std::log(static_cast<double>(bytes)) / std::log(1024.0);\n    double number = bytes / std::pow(1024.0, order);\n\n    QString suffix;\n    if (order <= 0) {\n        if (compactUnitFormat == COMPACT_FORM)\n            return QString::number(bytes);\n        else\n            return tr(\"%1 bytes\").arg(QString::number(bytes));\n    } else if (order == 1) {\n        suffix = tr(\"kB\");\n    } else if (order == 2) {\n        suffix = tr(\"MB\");\n    } else if (order == 3) {\n        suffix = tr(\"GB\");\n    } else {\n        // make sure not to show wrong size for those that have > 1024 TB e-mail messages\n        order = 4;\n        suffix = tr(\"TB\"); // shame on you for such mails\n    }\n    return tr(\"%1 %2\").arg(QString::number(number, 'f', number < 100 ? 1 : 0), suffix);\n}",
          "includes": [
            "include <QSystemDeviceInfo>\n#",
            "include \"Imap/Model/Model.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include <QTextDocument>",
            "include <QSysInfo>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSettings>\n#",
            "include <QProcess>\n#",
            "include <QLocale>\n#",
            "include <QGuiApplication>\n#",
            "include <QDir>\n#",
            "include <QDateTime>\n#",
            "include <cmath>\n#",
            "include \"Utils.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QSystemDeviceInfo>\n#\ninclude \"Imap/Model/Model.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude <QTextDocument>\ninclude <QSysInfo>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSettings>\n#\ninclude <QProcess>\n#\ninclude <QLocale>\n#\ninclude <QGuiApplication>\n#\ninclude <QDir>\n#\ninclude <QDateTime>\n#\ninclude <cmath>\n#\ninclude \"Utils.h\"\n#\n\nrettySize {\n  String PrettySize::prettySize(uint bytes, const ShowBytesSuffix compactUnitFormat)\n  {\n      if (bytes == 0) {\n          return tr(\"0\");\n      }\n      int order = std::log(static_cast<double>(bytes)) / std::log(1024.0);\n      double number = bytes / std::pow(1024.0, order);\n  \n      QString suffix;\n      if (order <= 0) {\n          if (compactUnitFormat == COMPACT_FORM)\n              return QString::number(bytes);\n          else\n              return tr(\"%1 bytes\").arg(QString::number(bytes));\n      } else if (order == 1) {\n          suffix = tr(\"kB\");\n      } else if (order == 2) {\n          suffix = tr(\"MB\");\n      } else if (order == 3) {\n          suffix = tr(\"GB\");\n      } else {\n          // make sure not to show wrong size for those that have > 1024 TB e-mail messages\n          order = 4;\n          suffix = tr(\"TB\"); // shame on you for such mails\n      }\n      return tr(\"%1 %2\").arg(QString::number(number, 'f', number < 100 ? 1 : 0), suffix);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartOctets)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "%2, %3\")"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ubLayout->addWidget",
          "args": [
            "_fileName)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileName->setSizePolicy",
          "args": [
            "SizePolicy::Fixed,",
            "SizePolicy::Fixed)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileName->setCursor",
          "args": [
            "t::IBeamCursor)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileName->setTextInteractionFlags",
          "args": [
            "t::TextSelectableByMouse)"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileName->setText",
          "args": [
            "artIndex.data(Imap::Mailbox::RolePartFileName).toString())"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartFileName)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileName->setTextFormat",
          "args": [
            "t::PlainText)"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubLayout->setContentsMargins",
          "args": [
            ",",
            ",",
            ",",
            ")"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addSpacing",
          "args": [
            "pacing)"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "_icon)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setIcon",
          "args": [
            "oadIcon(QLatin1String(\"mail-attachment\")))"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadIcon(",
          "args": [
            "Latin1String(\"mail-attachment\"))"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mail-attachment\")"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setIcon",
          "args": [
            "con)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Icon::fromTheme(",
          "args": [
            "imeType.iconName(),",
            "Icon::fromTheme(mimeType.genericIconName(), loadIcon(QLatin1String(\"mail-attachment\")))"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Icon::fromTheme(",
          "args": [
            "imeType.genericIconName(),",
            "oadIcon(QLatin1String(\"mail-attachment\")))"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadIcon(",
          "args": [
            "Latin1String(\"mail-attachment\"))"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mail-attachment\")"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "imeType.genericIconName",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "genericIconName",
          "container": "QMimeType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "257-273",
          "snippet": "QString QMimeType::genericIconName() const\n{\n    QMimeDatabasePrivate::instance()->provider()->loadGenericIcon(*d);\n    if (d->genericIconName.isEmpty()) {\n        // From the spec:\n        // If the generic icon name is empty (not specified by the mimetype definition)\n        // then the mimetype is used to generate the generic icon by using the top-level\n        // media type (e.g.  \"video\" in \"video/ogg\") and appending \"-x-generic\"\n        // (i.e. \"video-x-generic\" in the previous example).\n        QString group = name();\n        const int slashindex = group.indexOf(QLatin1Char('/'));\n        if (slashindex != -1)\n            group = group.left(slashindex);\n        return group + QLatin1String(\"-x-generic\");\n    }\n    return d->genericIconName;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQMimeType {\n  QString QMimeType::genericIconName() const\n  {\n      QMimeDatabasePrivate::instance()->provider()->loadGenericIcon(*d);\n      if (d->genericIconName.isEmpty()) {\n          // From the spec:\n          // If the generic icon name is empty (not specified by the mimetype definition)\n          // then the mimetype is used to generate the generic icon by using the top-level\n          // media type (e.g.  \"video\" in \"video/ogg\") and appending \"-x-generic\"\n          // (i.e. \"video-x-generic\" in the previous example).\n          QString group = name();\n          const int slashindex = group.indexOf(QLatin1Char('/'));\n          if (slashindex != -1)\n              group = group.left(slashindex);\n          return group + QLatin1String(\"-x-generic\");\n      }\n      return d->genericIconName;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "imeType.iconName",
          "args": [],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "iconName",
          "container": "QMimeType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "281-292",
          "snippet": "QString QMimeType::iconName() const\n{\n    QMimeDatabasePrivate::instance()->provider()->loadIcon(*d);\n    if (d->iconName.isEmpty()) {\n        // Make default icon name from the mimetype name\n        d->iconName = name();\n        const int slashindex = d->iconName.indexOf(QLatin1Char('/'));\n        if (slashindex != -1)\n            d->iconName[slashindex] = QLatin1Char('-');\n    }\n    return d->iconName;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQMimeType {\n  QString QMimeType::iconName() const\n  {\n      QMimeDatabasePrivate::instance()->provider()->loadIcon(*d);\n      if (d->iconName.isEmpty()) {\n          // Make default icon name from the mimetype name\n          d->iconName = name();\n          const int slashindex = d->iconName.indexOf(QLatin1Char('/'));\n          if (slashindex != -1)\n              d->iconName[slashindex] = QLatin1Char('-');\n      }\n      return d->iconName;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "oadIcon(",
          "args": [
            "Latin1String(\"trojita\"))"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "trojita\")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "message/rfc822\")"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "imeType.comment",
          "args": [],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "comment",
          "container": "QMimeType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "218-244",
          "snippet": "QString QMimeType::comment() const\n{\n    QMimeDatabasePrivate::instance()->provider()->loadMimeTypePrivate(*d);\n\n    QStringList languageList;\n    languageList << QLocale::system().name();\n#if QT_VERSION >= 0x040800\n    languageList << QLocale::system().uiLanguages();\n#endif\n    Q_FOREACH (const QString &language, languageList) {\n        const QString lang = language == QLatin1String(\"C\") ? QLatin1String(\"en_US\") : language;\n        const QString comm = d->localeComments.value(lang);\n        if (!comm.isEmpty())\n            return comm;\n        const int pos = lang.indexOf(QLatin1Char('_'));\n        if (pos != -1) {\n            // \"pt_BR\" not found? try just \"pt\"\n            const QString shortLang = lang.left(pos);\n            const QString commShort = d->localeComments.value(shortLang);\n            if (!commShort.isEmpty())\n                return commShort;\n        }\n    }\n\n    // Use the mimetype name as fallback\n    return d->name;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQMimeType {\n  QString QMimeType::comment() const\n  {\n      QMimeDatabasePrivate::instance()->provider()->loadMimeTypePrivate(*d);\n  \n      QStringList languageList;\n      languageList << QLocale::system().name();\n  #if QT_VERSION >= 0x040800\n      languageList << QLocale::system().uiLanguages();\n  #endif\n      Q_FOREACH (const QString &language, languageList) {\n          const QString lang = language == QLatin1String(\"C\") ? QLatin1String(\"en_US\") : language;\n          const QString comm = d->localeComments.value(lang);\n          if (!comm.isEmpty())\n              return comm;\n          const int pos = lang.indexOf(QLatin1Char('_'));\n          if (pos != -1) {\n              // \"pt_BR\" not found? try just \"pt\"\n              const QString shortLang = lang.left(pos);\n              const QString commShort = d->localeComments.value(shortLang);\n              if (!commShort.isEmpty())\n                  return commShort;\n          }\n      }\n  \n      // Use the mimetype name as fallback\n      return d->name;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "imeType.isDefault",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "isDefault",
          "container": "QMimeType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "199-202",
          "snippet": "bool QMimeType::isDefault() const\n{\n    return d->name == QMimeDatabasePrivate::instance()->defaultMimeType();\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQMimeType {\n  bool QMimeType::isDefault() const\n  {\n      return d->name == QMimeDatabasePrivate::instance()->defaultMimeType();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "imeType.isValid",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeType",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "189-192",
          "snippet": "bool QMimeType::isValid() const\n{\n    return !d->name.isEmpty();\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQMimeType {\n  bool QMimeType::isValid() const\n  {\n      return !d->name.isEmpty();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MimeDatabase",
          "args": [
            "imeDescription)"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "mimeTypeForUrl",
          "container": "QMimeDatabase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimedatabase.cpp",
          "lines": "510-524",
          "snippet": "QMimeType QMimeDatabase::mimeTypeForUrl(const QUrl &url) const\n{\n#if QT_VERSION >= 0x040800\n    if (url.isLocalFile())\n#else\n    if (url.scheme().isEmpty())\n#endif\n        return mimeTypeForFile(url.toLocalFile());\n\n    const QString scheme = url.scheme();\n    if (scheme.startsWith(QLatin1String(\"http\")))\n        return mimeTypeForName(d->defaultMimeType());\n\n    return mimeTypeForFile(url.path());\n}",
          "includes": [
            "#include <functional>",
            "#include <algorithm>",
            "#include <QDebug>",
            "#include <QStack>",
            "#include <QUrl>",
            "#include <QBuffer>",
            "#include <QSet>",
            "#include <QFileInfo>",
            "#include <QFile>",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimedatabase.h\"",
            "#include <qplatformdefs.h> // always first"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <algorithm>\n#include <QDebug>\n#include <QStack>\n#include <QUrl>\n#include <QBuffer>\n#include <QSet>\n#include <QFileInfo>\n#include <QFile>\n#include \"qmimetype_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimedatabase.h\"\n#include <qplatformdefs.h> // always first\n\nQMimeDatabase {\n  QMimeType QMimeDatabase::mimeTypeForUrl(const QUrl &url) const\n  {\n  #if QT_VERSION >= 0x040800\n      if (url.isLocalFile())\n  #else\n      if (url.scheme().isEmpty())\n  #endif\n          return mimeTypeForFile(url.toLocalFile());\n  \n      const QString scheme = url.scheme();\n      if (scheme.startsWith(QLatin1String(\"http\")))\n          return mimeTypeForName(d->defaultMimeType());\n  \n      return mimeTypeForFile(url.path());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MimeDatabase(",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartMimeType)"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setCursor",
          "args": [
            "t::ArrowCursor)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_icon,",
            "IGNAL(released()),",
            "LOT(toggleIconCursor()))"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "oggleIconCursor())"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oggleIconCursor(",
          "args": [],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "toggleIconCursor(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "267-273",
          "snippet": "oid AttachmentView::toggleIconCursor()\n{\n    if (m_icon->isDown())\n        m_icon->setCursor(Qt::OpenHandCursor);\n    else\n        m_icon->setCursor(Qt::ArrowCursor);\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::toggleIconCursor()\n  {\n      if (m_icon->isDown())\n          m_icon->setCursor(Qt::OpenHandCursor);\n      else\n          m_icon->setCursor(Qt::ArrowCursor);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "eleased())"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleased(",
          "args": [],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_icon,",
            "IGNAL(clicked()),",
            "_icon,",
            "LOT(showMenu()))"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "howMenu())"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "howMenu(",
          "args": [],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "showMenu(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "257-265",
          "snippet": "oid AttachmentView::showMenu()\n{\n    if (QToolButton *btn = qobject_cast<QToolButton*>(sender())) {\n        btn->setDown(false);\n    }\n    QPoint p = QCursor::pos();\n    p.rx() -= m_menu->width()/2;\n    m_menu->popup(p);\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::showMenu()\n  {\n      if (QToolButton *btn = qobject_cast<QToolButton*>(sender())) {\n          btn->setDown(false);\n      }\n      QPoint p = QCursor::pos();\n      p.rx() -= m_menu->width()/2;\n      m_menu->popup(p);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "licked())"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "licked(",
          "args": [],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "loadClicked(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "55-74",
          "snippet": "oid LoadablePartWidget::loadClicked()\n{\n    if (!partIndex.isValid()) {\n        if (loadButton) {\n            loadButton->setEnabled(false);\n        }\n        return;\n    }\n    if (loadButton) {\n        loadButton->deleteLater();\n        loadButton = 0;\n    }\n\n    // We have to disable any flags which might cause recursion here\n    realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                 (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                  | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n    addWidget(realPart);\n    setCurrentIndex(1);\n}",
          "includes": [
            "include <QPushButton>",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"LoadablePartWidget.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oid LoadablePartWidget::loadClicked()\n  {\n      if (!partIndex.isValid()) {\n          if (loadButton) {\n              loadButton->setEnabled(false);\n          }\n          return;\n      }\n      if (loadButton) {\n          loadButton->deleteLater();\n          loadButton = 0;\n      }\n  \n      // We have to disable any flags which might cause recursion here\n      realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                   (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                    | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n      addWidget(realPart);\n      setCurrentIndex(1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_icon,",
            "IGNAL(pressed()),",
            "LOT(toggleIconCursor()))"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "oggleIconCursor())"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ressed())"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ressed(",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setMenu",
          "args": [
            "_menu)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setPopupMode",
          "args": [
            "ToolButton::MenuButtonPopup)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setToolButtonStyle",
          "args": [
            "t::ToolButtonIconOnly)"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setIconSize",
          "args": [
            "Size(22,22))"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setAutoRaise",
          "args": [
            "rue)"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_icon->setAttribute",
          "args": [
            "t::WA_NoMousePropagation,",
            "alse)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_showHideAttachment->setChecked",
          "args": [
            "m_contentWidget->isHidden())"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_contentWidget->isHidden",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_showHideAttachment->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_menu->addAction",
          "args": [
            "oadIcon(QLatin1String(\"view-preview\")),",
            "r(\"Show Preview\"))"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadIcon(",
          "args": [
            "Latin1String(\"view-preview\"))"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "view-preview\")"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_menu,",
            "IGNAL(aboutToShow()),",
            "his,",
            "LOT(updateShowHideAttachmentState()))"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "pdateShowHideAttachmentState())"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdateShowHideAttachmentState(",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "updateShowHideAttachmentState(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "251-255",
          "snippet": "oid AttachmentView::updateShowHideAttachmentState()\n{\n    if (m_showHideAttachment)\n        m_showHideAttachment->setChecked(m_contentWidget && m_contentWidget->isVisibleTo(this));\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::updateShowHideAttachmentState()\n  {\n      if (m_showHideAttachment)\n          m_showHideAttachment->setChecked(m_contentWidget && m_contentWidget->isVisibleTo(this));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "boutToShow())"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boutToShow(",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_openAttachment,",
            "IGNAL(triggered()),",
            "his,",
            "LOT(slotOpenAttachment()))"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotOpenAttachment())"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotOpenAttachment(",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "slotOpenAttachment(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "193-206",
          "snippet": "oid AttachmentView::slotOpenAttachment()\n{\n    m_openAttachment->setEnabled(false);\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccess, m_partIndex);\n    connect(manager, SIGNAL(fileNameRequested(QString*)), this, SLOT(slotFileNameRequestedOnOpen(QString*)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), this, SLOT(onOpenFailed()));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    // we aren't connecting to cancelled() as it cannot really happen -- the filename is never empty\n    connect(manager, SIGNAL(succeeded()), this, SLOT(openDownloadedAttachment()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadPart();\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::slotOpenAttachment()\n  {\n      m_openAttachment->setEnabled(false);\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccess, m_partIndex);\n      connect(manager, SIGNAL(fileNameRequested(QString*)), this, SLOT(slotFileNameRequestedOnOpen(QString*)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), this, SLOT(onOpenFailed()));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      // we aren't connecting to cancelled() as it cannot really happen -- the filename is never empty\n      connect(manager, SIGNAL(succeeded()), this, SLOT(openDownloadedAttachment()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadPart();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "riggered())"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "riggered(",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_downloadAttachment,",
            "IGNAL(triggered()),",
            "his,",
            "LOT(slotDownloadAttachment()))"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotDownloadAttachment())"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotDownloadAttachment(",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadAttachment(",
          "container": "ttachmentView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/AttachmentView.cpp",
          "lines": "177-191",
          "snippet": "oid AttachmentView::slotDownloadAttachment()\n{\n    m_downloadAttachment->setEnabled(false);\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccess, m_partIndex);\n    connect(manager, SIGNAL(fileNameRequested(QString*)), this, SLOT(slotFileNameRequested(QString*)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), this, SLOT(enableDownloadAgain()));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(cancelled()), this, SLOT(enableDownloadAgain()));\n    connect(manager, SIGNAL(cancelled()), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), this, SLOT(enableDownloadAgain()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadPart();\n}",
          "includes": [
            "include \"mimetypes-qt4/include/QMimeDatabase\"\n#",
            "include <QMimeDatabase>\n#",
            "include <QToolButton>\n#",
            "include <QTimer>\n#",
            "include <QTemporaryFile>\n#",
            "include <QStyleOption>\n#",
            "include <QStyle>\n#",
            "include <QLabel>\n#",
            "include <QPushButton>\n#",
            "include <QPainter>\n#",
            "include <QMouseEvent>\n#",
            "include <QMimeData>\n#",
            "include <QMenu>\n#",
            "include <QHBoxLayout>\n#",
            "include <QFileDialog>\n#",
            "include <QDrag>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/DragAndDrop.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/DeleteAfter.h\"\n#",
            "include \"MessageView.h\" // so that the compiler knows it's a QObject\n#",
            "include \"IconLoader.h\"\n#",
            "include \"AttachmentView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  oid AttachmentView::slotDownloadAttachment()\n  {\n      m_downloadAttachment->setEnabled(false);\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccess, m_partIndex);\n      connect(manager, SIGNAL(fileNameRequested(QString*)), this, SLOT(slotFileNameRequested(QString*)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), this, SLOT(enableDownloadAgain()));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(cancelled()), this, SLOT(enableDownloadAgain()));\n      connect(manager, SIGNAL(cancelled()), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), this, SLOT(enableDownloadAgain()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadPart();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "riggered())"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "riggered(",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_menu->addAction",
          "args": [
            "r(\"Open Directly\"))"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_menu->addAction",
          "args": [
            "oadIcon(QLatin1String(\"document-save-as\")),",
            "r(\"Download\"))"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadIcon(",
          "args": [
            "Latin1String(\"document-save-as\"))"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "document-save-as\")"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->setSpacing",
          "args": [
            ")"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle",
          "args": [
            "Style::PM_DefaultLayoutSpacing,",
            "opt,",
            "his)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle(",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle",
          "args": [
            "Style::PM_LayoutHorizontalSpacing,",
            "opt,",
            "his)"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle(",
          "args": [],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->setContentsMargins",
          "args": [
            ",",
            ",",
            ",",
            ")"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etContentsMargins(",
          "args": [
            "adding,",
            ",",
            "adding,",
            ")"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle",
          "args": [
            "Style::PM_DefaultFrameWidth,",
            "opt,",
            "his)"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle(",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pt.initFrom",
          "args": [
            "his)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etAttribute(",
          "args": [
            "t::WA_Hover)"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etCursor(",
          "args": [
            "t::OpenHandCursor)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etFrameStyle(",
          "args": [
            "Frame::NoFrame)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etSizePolicy(",
          "args": [
            "SizePolicy::Preferred,",
            "SizePolicy::Fixed)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"mimetypes-qt4/include/QMimeDatabase\"\n#\ninclude <QMimeDatabase>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QTemporaryFile>\n#\ninclude <QStyleOption>\n#\ninclude <QStyle>\n#\ninclude <QLabel>\n#\ninclude <QPushButton>\n#\ninclude <QPainter>\n#\ninclude <QMouseEvent>\n#\ninclude <QMimeData>\n#\ninclude <QMenu>\n#\ninclude <QHBoxLayout>\n#\ninclude <QFileDialog>\n#\ninclude <QDrag>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/DragAndDrop.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/DeleteAfter.h\"\n#\ninclude \"MessageView.h\" // so that the compiler knows it's a QObject\n#\ninclude \"IconLoader.h\"\n#\ninclude \"AttachmentView.h\"\n#\n\nttachmentView {\n  ttachmentView::AttachmentView(QWidget *parent, Imap::Network::MsgPartNetAccessManager *manager,\n                                 const QModelIndex &partIndex, MessageView *messageView, QWidget *contentWidget):\n      QFrame(parent), m_partIndex(partIndex), m_messageView(messageView), m_downloadAttachment(0),\n      m_openAttachment(0), m_showHideAttachment(0), m_netAccess(manager), m_tmpFile(0),\n      m_contentWidget(contentWidget)\n  {\n      setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Fixed);\n      setFrameStyle(QFrame::NoFrame);\n      setCursor(Qt::OpenHandCursor);\n      setAttribute(Qt::WA_Hover);\n  \n      // not actually required, but styles may assume the parameter and segfault on nullptr deref\n      QStyleOption opt;\n      opt.initFrom(this);\n  \n      const int padding = style()->pixelMetric(QStyle::PM_DefaultFrameWidth, &opt, this);\n      setContentsMargins(padding, 0, padding, 0);\n  \n      QHBoxLayout *layout = new QHBoxLayout();\n      layout->setContentsMargins(0,0,0,0);\n  \n      // should be PM_LayoutHorizontalSpacing, but is not implemented by many Qt4 styles -including oxygen- for other conflicts\n      int spacing = style()->pixelMetric(QStyle::PM_LayoutHorizontalSpacing, &opt, this);\n      if (spacing < 0)\n          spacing = style()->pixelMetric(QStyle::PM_DefaultLayoutSpacing, &opt, this);\n      layout->setSpacing(0);\n  \n      m_menu = new QMenu(this);\n      m_downloadAttachment = m_menu->addAction(loadIcon(QLatin1String(\"document-save-as\")), tr(\"Download\"));\n      m_openAttachment = m_menu->addAction(tr(\"Open Directly\"));\n      connect(m_downloadAttachment, SIGNAL(triggered()), this, SLOT(slotDownloadAttachment()));\n      connect(m_openAttachment, SIGNAL(triggered()), this, SLOT(slotOpenAttachment()));\n      connect(m_menu, SIGNAL(aboutToShow()), this, SLOT(updateShowHideAttachmentState()));\n      if (m_contentWidget) {\n          m_showHideAttachment = m_menu->addAction(loadIcon(QLatin1String(\"view-preview\")), tr(\"Show Preview\"));\n          m_showHideAttachment->setCheckable(true);\n          m_showHideAttachment->setChecked(!m_contentWidget->isHidden());\n          connect(m_showHideAttachment, SIGNAL(triggered(bool)), m_contentWidget, SLOT(setVisible(bool)));\n      }\n  \n      // Icon on the left\n      m_icon = new QToolButton(this);\n      m_icon->setAttribute(Qt::WA_NoMousePropagation, false); // inform us for DnD\n      m_icon->setAutoRaise(true);\n      m_icon->setIconSize(QSize(22,22));\n      m_icon->setToolButtonStyle(Qt::ToolButtonIconOnly);\n      m_icon->setPopupMode(QToolButton::MenuButtonPopup);\n      m_icon->setMenu(m_menu);\n      connect(m_icon, SIGNAL(pressed()), SLOT(toggleIconCursor()));\n      connect(m_icon, SIGNAL(clicked()), m_icon, SLOT(showMenu()));\n      connect(m_icon, SIGNAL(released()), SLOT(toggleIconCursor()));\n      m_icon->setCursor(Qt::ArrowCursor);\n  \n      QString mimeDescription = partIndex.data(Imap::Mailbox::RolePartMimeType).toString();\n      QString rawMime = mimeDescription;\n      QMimeType mimeType = QMimeDatabase().mimeTypeForName(mimeDescription);\n      if (mimeType.isValid() && !mimeType.isDefault()) {\n          mimeDescription = mimeType.comment();\n          QIcon icon;\n          if (rawMime == QLatin1String(\"message/rfc822\")) {\n              // Special case for plain e-mail messages. Motivation for this is that most of the OSes ship these icons\n              // with a pixmap which shows something like a sheet of paper as the background. I find it rather dumb\n              // to do this in the context of a MUA where attached messages are pretty common, which is why this special\n              // case is in place. Comments welcome.\n              icon = loadIcon(QLatin1String(\"trojita\"));\n          } else {\n              icon = QIcon::fromTheme(mimeType.iconName(),\n                                      QIcon::fromTheme(mimeType.genericIconName(), loadIcon(QLatin1String(\"mail-attachment\")))\n                                      );\n          }\n          m_icon->setIcon(icon);\n      } else {\n          m_icon->setIcon(loadIcon(QLatin1String(\"mail-attachment\")));\n      }\n  \n      layout->addWidget(m_icon);\n  \n      // space between icon and label\n      layout->addSpacing(spacing);\n  \n      QVBoxLayout *subLayout = new QVBoxLayout;\n      subLayout->setContentsMargins(0,0,0,0);\n      // The file name shall be mouse-selectable\n      m_fileName = new QLabel(this);\n      m_fileName->setTextFormat(Qt::PlainText);\n      m_fileName->setText(partIndex.data(Imap::Mailbox::RolePartFileName).toString());\n      m_fileName->setTextInteractionFlags(Qt::TextSelectableByMouse);\n      m_fileName->setCursor(Qt::IBeamCursor);\n      m_fileName->setSizePolicy(QSizePolicy::Fixed, QSizePolicy::Fixed);\n      subLayout->addWidget(m_fileName);\n  \n      // Some metainformation -- the MIME type and the file size\n      QLabel *lbl = new QLabel(tr(\"%2, %3\").arg(mimeDescription,\n                                        Imap::Mailbox::PrettySize::prettySize(partIndex.data(Imap::Mailbox::RolePartOctets).toUInt(),\n                                                                              Imap::Mailbox::PrettySize::WITH_BYTES_SUFFIX)));\n      if (rawMime != mimeDescription) {\n          lbl->setToolTip(rawMime);\n      }\n      QFont f(lbl->font());\n      f.setItalic(true);\n      if (f.pointSize() > -1) // don't try the below on pixel fonts ever.\n          f.setPointSizeF(f.pointSizeF() * 0.8);\n      lbl->setFont(f);\n      subLayout->addWidget(lbl);\n      layout->addLayout(subLayout);\n  \n      // space between label and arrow\n      layout->addSpacing(spacing);\n  \n      layout->addStretch(100);\n  \n      QVBoxLayout *contentLayout = new QVBoxLayout(this);\n      contentLayout->addLayout(layout);\n      if (m_contentWidget) {\n          contentLayout->addWidget(m_contentWidget);\n      }\n  }\n}"
  }
]