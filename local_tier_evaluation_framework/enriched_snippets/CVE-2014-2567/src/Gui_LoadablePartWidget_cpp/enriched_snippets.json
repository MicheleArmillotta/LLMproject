[
  {
    "function_name": "reloadContents(",
    "container": "oadablePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
    "lines": "91-95",
    "snippet": "oid LoadablePartWidget::reloadContents()\n{\n    if (AbstractPartWidget *w = dynamic_cast<AbstractPartWidget*>(realPart))\n        w->reloadContents();\n}",
    "includes": [
      "include <QPushButton>",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"LoadablePartWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "->reloadContents",
          "args": [],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "reloadContents(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "91-95",
          "snippet": "oid LoadablePartWidget::reloadContents()\n{\n    if (AbstractPartWidget *w = dynamic_cast<AbstractPartWidget*>(realPart))\n        w->reloadContents();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ynamic_cast<AbstractPartWidget*>",
          "args": [
            "ealPart)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oid LoadablePartWidget::reloadContents()\n  {\n      if (AbstractPartWidget *w = dynamic_cast<AbstractPartWidget*>(realPart))\n          w->reloadContents();\n  }\n}"
  },
  {
    "function_name": "showEvent(",
    "container": "oadablePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
    "lines": "82-89",
    "snippet": "oid LoadablePartWidget::showEvent(QShowEvent *event)\n{\n    QStackedWidget::showEvent(event);\n    if (m_loadOnShow) {\n        m_loadOnShow = false;\n        loadClicked();\n    }\n}",
    "includes": [
      "include <QPushButton>",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"LoadablePartWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "oadClicked(",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "loadClicked(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "55-74",
          "snippet": "oid LoadablePartWidget::loadClicked()\n{\n    if (!partIndex.isValid()) {\n        if (loadButton) {\n            loadButton->setEnabled(false);\n        }\n        return;\n    }\n    if (loadButton) {\n        loadButton->deleteLater();\n        loadButton = 0;\n    }\n\n    // We have to disable any flags which might cause recursion here\n    realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                 (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                  | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n    addWidget(realPart);\n    setCurrentIndex(1);\n}",
          "includes": [
            "include <QPushButton>",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"LoadablePartWidget.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oid LoadablePartWidget::loadClicked()\n  {\n      if (!partIndex.isValid()) {\n          if (loadButton) {\n              loadButton->setEnabled(false);\n          }\n          return;\n      }\n      if (loadButton) {\n          loadButton->deleteLater();\n          loadButton = 0;\n      }\n  \n      // We have to disable any flags which might cause recursion here\n      realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                   (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                    | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n      addWidget(realPart);\n      setCurrentIndex(1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "StackedWidget::showEvent(",
          "args": [
            "vent)"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "showEvent(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "82-89",
          "snippet": "oid LoadablePartWidget::showEvent(QShowEvent *event)\n{\n    QStackedWidget::showEvent(event);\n    if (m_loadOnShow) {\n        m_loadOnShow = false;\n        loadClicked();\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oid LoadablePartWidget::showEvent(QShowEvent *event)\n  {\n      QStackedWidget::showEvent(event);\n      if (m_loadOnShow) {\n          m_loadOnShow = false;\n          loadClicked();\n      }\n  }\n}"
  },
  {
    "function_name": "quoteMe(",
    "container": "oadablePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
    "lines": "76-80",
    "snippet": "String LoadablePartWidget::quoteMe() const\n{\n    AbstractPartWidget *part = dynamic_cast<AbstractPartWidget*>(realPart);\n    return part ? part->quoteMe() : QString();\n}",
    "includes": [
      "include <QPushButton>",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"LoadablePartWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "art->quoteMe",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<AbstractPartWidget*>",
          "args": [
            "ealPart)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  String LoadablePartWidget::quoteMe() const\n  {\n      AbstractPartWidget *part = dynamic_cast<AbstractPartWidget*>(realPart);\n      return part ? part->quoteMe() : QString();\n  }\n}"
  },
  {
    "function_name": "loadClicked(",
    "container": "oadablePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
    "lines": "55-74",
    "snippet": "oid LoadablePartWidget::loadClicked()\n{\n    if (!partIndex.isValid()) {\n        if (loadButton) {\n            loadButton->setEnabled(false);\n        }\n        return;\n    }\n    if (loadButton) {\n        loadButton->deleteLater();\n        loadButton = 0;\n    }\n\n    // We have to disable any flags which might cause recursion here\n    realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                 (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                  | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n    addWidget(realPart);\n    setCurrentIndex(1);\n}",
    "includes": [
      "include <QPushButton>",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"LoadablePartWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etCurrentIndex(",
          "args": [
            ")"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddWidget(",
          "args": [
            "ealPart)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_factory->create",
          "args": [
            "artIndex,",
            "_recursionDepth + 1,",
            "m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                  | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadButton->deleteLater",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadButton->setEnabled",
          "args": [
            "alse)"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.isValid",
          "args": [],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oid LoadablePartWidget::loadClicked()\n  {\n      if (!partIndex.isValid()) {\n          if (loadButton) {\n              loadButton->setEnabled(false);\n          }\n          return;\n      }\n      if (loadButton) {\n          loadButton->deleteLater();\n          loadButton = 0;\n      }\n  \n      // We have to disable any flags which might cause recursion here\n      realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                   (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                    | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n      addWidget(realPart);\n      setCurrentIndex(1);\n  }\n}"
  },
  {
    "function_name": "LoadablePartWidget(",
    "container": "oadablePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
    "lines": "32-53",
    "snippet": "oadablePartWidget::LoadablePartWidget(QWidget *parent, Imap::Network::MsgPartNetAccessManager *manager, const QModelIndex &part,\n                                       MessageView *messageView, PartWidgetFactory *factory, int recursionDepth,\n                                       const PartWidgetFactory::PartLoadingOptions loadingMode):\n    QStackedWidget(parent), manager(manager), partIndex(part), m_messageView(messageView), m_factory(factory),\n    m_recursionDepth(recursionDepth), m_loadingMode(loadingMode), realPart(0), loadButton(0), m_loadOnShow(false)\n{\n    Q_ASSERT(partIndex.isValid());\n\n    QString mimeType = partIndex.data(Imap::Mailbox::RolePartMimeType).toString().toLower();\n\n    if ((loadingMode & PartWidgetFactory::PART_IS_HIDDEN) ||\n            (loadingMode & PartWidgetFactory::PART_IGNORE_CLICKTHROUGH) ||\n            partIndex.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n        m_loadOnShow = true;\n    } else {\n        loadButton = new QPushButton(tr(\"Load %1 (%2)\").arg(partIndex.data(Imap::Mailbox::RolePartMimeType).toString(),\n                                     Imap::Mailbox::PrettySize::prettySize(partIndex.data(Imap::Mailbox::RolePartOctets).toUInt())),\n                                     this);\n        connect(loadButton, SIGNAL(clicked()), this, SLOT(loadClicked()));\n        addWidget(loadButton);\n    }\n}",
    "includes": [
      "include <QPushButton>",
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"LoadablePartWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ddWidget(",
          "args": [
            "oadButton)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "oadButton,",
            "IGNAL(clicked()),",
            "his,",
            "LOT(loadClicked()))"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "oadClicked())"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadClicked(",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "loadClicked(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "55-74",
          "snippet": "oid LoadablePartWidget::loadClicked()\n{\n    if (!partIndex.isValid()) {\n        if (loadButton) {\n            loadButton->setEnabled(false);\n        }\n        return;\n    }\n    if (loadButton) {\n        loadButton->deleteLater();\n        loadButton = 0;\n    }\n\n    // We have to disable any flags which might cause recursion here\n    realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                 (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                  | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n    addWidget(realPart);\n    setCurrentIndex(1);\n}",
          "includes": [
            "include <QPushButton>",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"LoadablePartWidget.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oid LoadablePartWidget::loadClicked()\n  {\n      if (!partIndex.isValid()) {\n          if (loadButton) {\n              loadButton->setEnabled(false);\n          }\n          return;\n      }\n      if (loadButton) {\n          loadButton->deleteLater();\n          loadButton = 0;\n      }\n  \n      // We have to disable any flags which might cause recursion here\n      realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                   (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                    | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n      addWidget(realPart);\n      setCurrentIndex(1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "licked())"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "artIndex.data(Imap::Mailbox::RolePartMimeType).toString(),",
            "map::Mailbox::PrettySize::prettySize(partIndex.data(Imap::Mailbox::RolePartOctets).toUInt()))"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "MessageSourceWidget",
          "container": "MessageSourceWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageSourceWidget.cpp",
          "lines": "32-48",
          "snippet": "MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n    QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n{\n    setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n    Q_ASSERT(messageIndex.isValid());\n    page()->setNetworkAccessManager(0);\n\n    m_loadingSpinner = new Spinner(this);\n    m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n    m_loadingSpinner->setType(Spinner::Sun);\n    m_loadingSpinner->start(250);\n\n    m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n    connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n    connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n    m_combiner->load();\n}",
          "includes": [
            "#include \"Imap/Model/FullMessageCombiner.h\"",
            "#include \"Gui/Spinner.h\"",
            "#include \"Gui/IconLoader.h\"",
            "#include <QModelIndex>",
            "#include \"MessageSourceWidget.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Imap/Model/FullMessageCombiner.h\"\n#include \"Gui/Spinner.h\"\n#include \"Gui/IconLoader.h\"\n#include <QModelIndex>\n#include \"MessageSourceWidget.h\"\n\nMessageSourceWidget {\n  MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n      QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n  {\n      setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n      Q_ASSERT(messageIndex.isValid());\n      page()->setNetworkAccessManager(0);\n  \n      m_loadingSpinner = new Spinner(this);\n      m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n      m_loadingSpinner->setType(Spinner::Sun);\n      m_loadingSpinner->start(250);\n  \n      m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n      connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n      connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n      m_combiner->load();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "map::Mailbox::PrettySize::prettySize(",
          "args": [
            "artIndex.data(Imap::Mailbox::RolePartOctets).toUInt())"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "prettySize(",
          "container": "mapAccess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ImapAccess.cpp",
          "lines": "382-385",
          "snippet": "String ImapAccess::prettySize(const uint bytes) const\n{\n    return Imap::Mailbox::PrettySize::prettySize(bytes, Imap::Mailbox::PrettySize::WITH_BYTES_SUFFIX);\n}",
          "includes": [
            "include \"Streams/SocketFactory.h\"",
            "include \"Imap/Network/MsgPartNetAccessManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/SystemNetworkWatcher.h\"\n#",
            "include \"Imap/Model/MemoryCache.h\"\n#",
            "include \"Imap/Model/DummyNetworkWatcher.h\"\n#",
            "include \"Imap/Model/CombinedCache.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include <QSettings>\n#",
            "include <QSslKey>\n#",
            "include <QFileInfo>\n#",
            "include <QDir>\n#",
            "include \"ImapAccess.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Streams/SocketFactory.h\"\ninclude \"Imap/Network/MsgPartNetAccessManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/SystemNetworkWatcher.h\"\n#\ninclude \"Imap/Model/MemoryCache.h\"\n#\ninclude \"Imap/Model/DummyNetworkWatcher.h\"\n#\ninclude \"Imap/Model/CombinedCache.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude <QSettings>\n#\ninclude <QSslKey>\n#\ninclude <QFileInfo>\n#\ninclude <QDir>\n#\ninclude \"ImapAccess.h\"\n#\n\nmapAccess {\n  String ImapAccess::prettySize(const uint bytes) const\n  {\n      return Imap::Mailbox::PrettySize::prettySize(bytes, Imap::Mailbox::PrettySize::WITH_BYTES_SUFFIX);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartOctets)"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartMimeType)"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Load %1 (%2)\")"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RoleIsFetched)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartMimeType)"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "artIndex.isValid())"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.isValid",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oadablePartWidget::LoadablePartWidget(QWidget *parent, Imap::Network::MsgPartNetAccessManager *manager, const QModelIndex &part,\n                                         MessageView *messageView, PartWidgetFactory *factory, int recursionDepth,\n                                         const PartWidgetFactory::PartLoadingOptions loadingMode):\n      QStackedWidget(parent), manager(manager), partIndex(part), m_messageView(messageView), m_factory(factory),\n      m_recursionDepth(recursionDepth), m_loadingMode(loadingMode), realPart(0), loadButton(0), m_loadOnShow(false)\n  {\n      Q_ASSERT(partIndex.isValid());\n  \n      QString mimeType = partIndex.data(Imap::Mailbox::RolePartMimeType).toString().toLower();\n  \n      if ((loadingMode & PartWidgetFactory::PART_IS_HIDDEN) ||\n              (loadingMode & PartWidgetFactory::PART_IGNORE_CLICKTHROUGH) ||\n              partIndex.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n          m_loadOnShow = true;\n      } else {\n          loadButton = new QPushButton(tr(\"Load %1 (%2)\").arg(partIndex.data(Imap::Mailbox::RolePartMimeType).toString(),\n                                       Imap::Mailbox::PrettySize::prettySize(partIndex.data(Imap::Mailbox::RolePartOctets).toUInt())),\n                                       this);\n          connect(loadButton, SIGNAL(clicked()), this, SLOT(loadClicked()));\n          addWidget(loadButton);\n      }\n  }\n}"
  }
]