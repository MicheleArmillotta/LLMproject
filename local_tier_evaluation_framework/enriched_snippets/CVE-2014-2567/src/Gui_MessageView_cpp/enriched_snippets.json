[
  {
    "function_name": "onWebViewLoadFinished()",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "534-541",
    "snippet": "id MessageView::onWebViewLoadFinished()\n{\n    QWebView *wv = qobject_cast<QWebView*>(sender());\n    Q_ASSERT(wv);\n    m_loadingItems.remove(wv);\n    if (m_loadingItems.isEmpty())\n        m_loadingSpinner->stop();\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "loadingSpinner->stop",
          "args": [],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loadingItems.isEmpty",
          "args": [],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loadingItems.remove",
          "args": [
            ");"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT(w",
          "args": [
            ");"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bject_cast<QWebView*>",
          "args": [
            "nder());"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nder()",
          "args": [],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::onWebViewLoadFinished()\n  {\n      QWebView *wv = qobject_cast<QWebView*>(sender());\n      Q_ASSERT(wv);\n      m_loadingItems.remove(wv);\n      if (m_loadingItems.isEmpty())\n          m_loadingSpinner->stop();\n  }\n}"
  },
  {
    "function_name": "onWebViewLoadStarted()",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "521-532",
    "snippet": "id MessageView::onWebViewLoadStarted()\n{\n    QWebView *wv = qobject_cast<QWebView*>(sender());\n    Q_ASSERT(wv);\n    QModelIndex messageIndex;\n    const Imap::Mailbox::Model *constModel = 0;\n    Imap::Mailbox::Model::realTreeItem(message, &constModel, &messageIndex);\n    if (constModel && constModel->isNetworkAvailable()) {\n        m_loadingItems << wv;\n        m_loadingSpinner->start(250);\n    }\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "loadingSpinner->start",
          "args": [
            "0);"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nstModel->isNetworkAvailable",
          "args": [],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ap::Mailbox::Model::realTreeItem(m",
          "args": [
            "ssage,",
            "onstModel,",
            "essageIndex);"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT(w",
          "args": [
            ");"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bject_cast<QWebView*>",
          "args": [
            "nder());"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nder()",
          "args": [],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::onWebViewLoadStarted()\n  {\n      QWebView *wv = qobject_cast<QWebView*>(sender());\n      Q_ASSERT(wv);\n      QModelIndex messageIndex;\n      const Imap::Mailbox::Model *constModel = 0;\n      Imap::Mailbox::Model::realTreeItem(message, &constModel, &messageIndex);\n      if (constModel && constModel->isNetworkAvailable()) {\n          m_loadingItems << wv;\n          m_loadingSpinner->start(250);\n      }\n  }\n}"
  },
  {
    "function_name": "currentMessage()",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "516-519",
    "snippet": "odelIndex MessageView::currentMessage() const\n{\n    return message;\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  odelIndex MessageView::currentMessage() const\n  {\n      return message;\n  }\n}"
  },
  {
    "function_name": "triggerSearchDialog()",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "511-514",
    "snippet": "id MessageView::triggerSearchDialog()\n{\n    emit searchRequestedBy(qobject_cast<QWebView*>(sender()));\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::triggerSearchDialog()\n  {\n      emit searchRequestedBy(qobject_cast<QWebView*>(sender()));\n  }\n}"
  },
  {
    "function_name": "partLinkHovered(c",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "504-509",
    "snippet": "id MessageView::partLinkHovered(const QString &link, const QString &title, const QString &textContent)\n{\n    Q_UNUSED(title);\n    Q_UNUSED(textContent);\n    emit linkHovered(link);\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UNUSED(t",
          "args": [
            "xtContent);"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UNUSED(t",
          "args": [
            "tle);"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::partLinkHovered(const QString &link, const QString &title, const QString &textContent)\n  {\n      Q_UNUSED(title);\n      Q_UNUSED(textContent);\n      emit linkHovered(link);\n  }\n}"
  },
  {
    "function_name": "partContextMenuRequested(c",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "489-502",
    "snippet": "id MessageView::partContextMenuRequested(const QPoint &point)\n{\n    if (SimplePartWidget *w = qobject_cast<SimplePartWidget *>(sender())) {\n        QMenu menu(w);\n        Q_FOREACH(QAction *action, w->contextMenuSpecificActions())\n            menu.addAction(action);\n        menu.addAction(w->pageAction(QWebPage::SelectAll));\n        if (!w->page()->mainFrame()->hitTestContent(point).linkUrl().isEmpty()) {\n            menu.addSeparator();\n            menu.addAction(w->pageAction(QWebPage::CopyLinkToClipboard));\n        }\n        menu.exec(w->mapToGlobal(point));\n    }\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nu.exec",
          "args": [
            ">mapToGlobal(point));"
          ],
          "line": 500
        },
        "resolved": true,
        "details": {
          "function_name": "exec",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "244-255",
          "snippet": "bool XSqlQuery::exec(const QString &pSql)\n{\n  bool returnValue = QSqlQuery::exec(pSql);\n\n  if (_data)\n    _data->_currRecord = record();\n\n  if(false == returnValue)\n    notifyErrorListeners(this);\n\n  return returnValue;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::exec(const QString &pSql)\n  {\n    bool returnValue = QSqlQuery::exec(pSql);\n  \n    if (_data)\n      _data->_currRecord = record();\n  \n    if(false == returnValue)\n      notifyErrorListeners(this);\n  \n    return returnValue;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": ">mapToGlobal",
          "args": [
            "int))"
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nu.addAction",
          "args": [
            ">pageAction(QWebPage::CopyLinkToClipboard));"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">pageAction",
          "args": [
            "ebPage::CopyLinkToClipboard))"
          ],
          "line": 498
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nu.addSeparator",
          "args": [],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">page",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">page",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">page",
          "args": [
            "int)."
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">page",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">page",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nu.addAction",
          "args": [
            ">pageAction(QWebPage::SelectAll));"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">pageAction",
          "args": [
            "ebPage::SelectAll))"
          ],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FOREACH",
          "args": [
            "tion);"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FOREACH(Q",
          "args": [
            "ction *action,",
            ">contextMenuSpecificActions())"
          ],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">contextMenuSpecificActions",
          "args": [],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bject_cast<SimplePartWidget *>",
          "args": [
            "nder()))"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nder()",
          "args": [],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::partContextMenuRequested(const QPoint &point)\n  {\n      if (SimplePartWidget *w = qobject_cast<SimplePartWidget *>(sender())) {\n          QMenu menu(w);\n          Q_FOREACH(QAction *action, w->contextMenuSpecificActions())\n              menu.addAction(action);\n          menu.addAction(w->pageAction(QWebPage::SelectAll));\n          if (!w->page()->mainFrame()->hitTestContent(point).linkUrl().isEmpty()) {\n              menu.addSeparator();\n              menu.addAction(w->pageAction(QWebPage::CopyLinkToClipboard));\n          }\n          menu.exec(w->mapToGlobal(point));\n      }\n  }\n}"
  },
  {
    "function_name": "headerLinkActivated(Q",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "483-487",
    "snippet": "id MessageView::headerLinkActivated(QString s)\n{\n    // Trojita is registered to handle any mailto: URL\n    QDesktopServices::openUrl(QUrl(s));\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esktopServices::openUrl(Q",
          "args": [
            "rl(s));"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl(s",
          "args": [
            ")"
          ],
          "line": 486
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::headerLinkActivated(QString s)\n  {\n      // Trojita is registered to handle any mailto: URL\n      QDesktopServices::openUrl(QUrl(s));\n  }\n}"
  },
  {
    "function_name": "showEvent(Q",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "475-481",
    "snippet": "id MessageView::showEvent(QShowEvent *se)\n{\n    QWidget::showEvent(se);\n    // The Oxygen style reset the attribute - since we're gonna cause an update() here anyway, it's\n    // a good moment to stress that \"we know better, Hugo ;-)\" -- Thomas\n    setAutoFillBackground(true);\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tAutoFillBackground(t",
          "args": [
            "ue);"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "idget::showEvent(s",
          "args": [
            ");"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::showEvent(QShowEvent *se)\n  {\n      QWidget::showEvent(se);\n      // The Oxygen style reset the attribute - since we're gonna cause an update() here anyway, it's\n      // a good moment to stress that \"we know better, Hugo ;-)\" -- Thomas\n      setAutoFillBackground(true);\n  }\n}"
  },
  {
    "function_name": "setHomepageUrl(c",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "470-473",
    "snippet": "id MessageView::setHomepageUrl(const QUrl &homepage)\n{\n    emptyView->load(homepage);\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ptyView->load",
          "args": [
            "mepage);"
          ],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "load",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "761-766",
          "snippet": "void QMimeXMLProvider::load(const QString &fileName)\n{\n    QString errorMessage;\n    if (!load(fileName, &errorMessage))\n        qWarning(\"QMimeDatabase: Error loading %s\\n%s\", qPrintable(fileName), qPrintable(errorMessage));\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  void QMimeXMLProvider::load(const QString &fileName)\n  {\n      QString errorMessage;\n      if (!load(fileName, &errorMessage))\n          qWarning(\"QMimeDatabase: Error loading %s\\n%s\", qPrintable(fileName), qPrintable(errorMessage));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::setHomepageUrl(const QUrl &homepage)\n  {\n      emptyView->load(homepage);\n  }\n}"
  },
  {
    "function_name": "handleDataChanged(c",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "457-468",
    "snippet": "id MessageView::handleDataChanged(const QModelIndex &topLeft, const QModelIndex &bottomRight)\n{\n    Q_ASSERT(topLeft.row() == bottomRight.row() && topLeft.parent() == bottomRight.parent());\n    if (topLeft == message) {\n        if (viewer == emptyView && message.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n            qDebug() << \"MessageView: message which was previously not loaded has just became available\";\n            setEmpty();\n            setMessage(topLeft);\n        }\n        tags->setTagList(message.data(Imap::Mailbox::RoleMessageFlags).toStringList());\n    }\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gs->setTagList",
          "args": [
            "ssage.data(Imap::Mailbox::RoleMessageFlags).toStringList());"
          ],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "setTagList",
          "container": "TagListWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/TagListWidget.cpp",
          "lines": "50-66",
          "snippet": "void TagListWidget::setTagList(QStringList list)\n{\n    empty();\n    parentLayout->removeWidget(addButton);\n\n    foreach(const QString &tagName, list) {\n        if (m_ignoredFlags.contains(tagName.toLower()))\n            continue;\n        TagWidget *lbl = new TagWidget(tagName, \"x\");\n        parentLayout->addWidget(lbl);\n        connect(lbl, SIGNAL(removeClicked(QString)), this, SIGNAL(tagRemoved(QString)));\n\n        children << lbl;\n    }\n\n    parentLayout->addWidget(addButton);\n}",
          "includes": [
            "#include \"TagWidget.h\"",
            "#include \"FlowLayout.h\"",
            "#include \"TagListWidget.h\"",
            "#include <QPushButton>",
            "#include <QMessageBox>",
            "#include <QLabel>",
            "#include <QInputDialog>",
            "#include <QHBoxLayout>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"TagWidget.h\"\n#include \"FlowLayout.h\"\n#include \"TagListWidget.h\"\n#include <QPushButton>\n#include <QMessageBox>\n#include <QLabel>\n#include <QInputDialog>\n#include <QHBoxLayout>\n\nTagListWidget {\n  void TagListWidget::setTagList(QStringList list)\n  {\n      empty();\n      parentLayout->removeWidget(addButton);\n  \n      foreach(const QString &tagName, list) {\n          if (m_ignoredFlags.contains(tagName.toLower()))\n              continue;\n          TagWidget *lbl = new TagWidget(tagName, \"x\");\n          parentLayout->addWidget(lbl);\n          connect(lbl, SIGNAL(removeClicked(QString)), this, SIGNAL(tagRemoved(QString)));\n  \n          children << lbl;\n      }\n  \n      parentLayout->addWidget(addButton);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssage.data",
          "args": [],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ssage.data",
          "args": [
            "ap::Mailbox::RoleMessageFlags)."
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tMessage(t",
          "args": [
            "pLeft);"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tEmpty()",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ebug()",
          "args": [],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssage.data",
          "args": [
            "ap::Mailbox::RoleIsFetched)."
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT(t",
          "args": [
            "pLeft.row() == bottomRight.row() && topLeft.parent() == bottomRight.parent());"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ttomRight.parent",
          "args": [],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "229-268",
          "snippet": "void ModelTest::parent()\n{\n    // Make sure the model wont crash and will return an invalid QModelIndex\n    // when asked for the parent of an invalid index.\n    Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // Column 0                | Column 1    |\n    // QModelIndex()           |             |\n    //    \\- topIndex          | topIndex1   |\n    //         \\- childIndex   | childIndex1 |\n\n    // Common error test #1, make sure that a top level index has a parent\n    // that is a invalid QModelIndex.\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    Q_ASSERT(model->parent(topIndex) == QModelIndex());\n\n    // Common error test #2, make sure that a second level index has a parent\n    // that is the first level index.\n    if (model->rowCount(topIndex) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        Q_ASSERT(model->parent(childIndex) == topIndex);\n    }\n\n    // Common error test #3, the second column should NOT have the same children\n    // as the first column in a row.\n    // Usually the second column shouldn't have children.\n    QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n    if (model->rowCount(topIndex1) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n        Q_ASSERT(childIndex != childIndex1);\n    }\n\n    // Full test, walk n levels deep through the model making sure that all\n    // parent's children correctly specify their parent.\n    checkChildren(QModelIndex());\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::parent()\n  {\n      // Make sure the model wont crash and will return an invalid QModelIndex\n      // when asked for the parent of an invalid index.\n      Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // Column 0                | Column 1    |\n      // QModelIndex()           |             |\n      //    \\- topIndex          | topIndex1   |\n      //         \\- childIndex   | childIndex1 |\n  \n      // Common error test #1, make sure that a top level index has a parent\n      // that is a invalid QModelIndex.\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      Q_ASSERT(model->parent(topIndex) == QModelIndex());\n  \n      // Common error test #2, make sure that a second level index has a parent\n      // that is the first level index.\n      if (model->rowCount(topIndex) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          Q_ASSERT(model->parent(childIndex) == topIndex);\n      }\n  \n      // Common error test #3, the second column should NOT have the same children\n      // as the first column in a row.\n      // Usually the second column shouldn't have children.\n      QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n      if (model->rowCount(topIndex1) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n          Q_ASSERT(childIndex != childIndex1);\n      }\n  \n      // Full test, walk n levels deep through the model making sure that all\n      // parent's children correctly specify their parent.\n      checkChildren(QModelIndex());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ttomRight.row",
          "args": [],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pLeft.row",
          "args": [],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::handleDataChanged(const QModelIndex &topLeft, const QModelIndex &bottomRight)\n  {\n      Q_ASSERT(topLeft.row() == bottomRight.row() && topLeft.parent() == bottomRight.parent());\n      if (topLeft == message) {\n          if (viewer == emptyView && message.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n              qDebug() << \"MessageView: message which was previously not loaded has just became available\";\n              setEmpty();\n              setMessage(topLeft);\n          }\n          tags->setTagList(message.data(Imap::Mailbox::RoleMessageFlags).toStringList());\n      }\n  }\n}"
  },
  {
    "function_name": "deleteLabelAction(c",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "448-455",
    "snippet": "id MessageView::deleteLabelAction(const QString &tag)\n{\n    if (!message.isValid())\n        return;\n\n    Imap::Mailbox::Model *model = dynamic_cast<Imap::Mailbox::Model *>(const_cast<QAbstractItemModel *>(message.model()));\n    model->setMessageFlags(QModelIndexList() << message, tag, Imap::Mailbox::FLAG_REMOVE);\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "del->setMessageFlags",
          "args": [
            "odelIndexList() << message,",
            "g,",
            "ap::Mailbox::FLAG_REMOVE);"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odelIndexList()",
          "args": [],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "namic_cast<Imap::Mailbox::Model *>",
          "args": [
            "nst_cast<QAbstractItemModel *>(message.model()));"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nst_cast<QAbstractItemModel *>",
          "args": [
            "ssage.model()))"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssage.model",
          "args": [],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssage.isValid",
          "args": [],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::deleteLabelAction(const QString &tag)\n  {\n      if (!message.isValid())\n          return;\n  \n      Imap::Mailbox::Model *model = dynamic_cast<Imap::Mailbox::Model *>(const_cast<QAbstractItemModel *>(message.model()));\n      model->setMessageFlags(QModelIndexList() << message, tag, Imap::Mailbox::FLAG_REMOVE);\n  }\n}"
  },
  {
    "function_name": "newLabelAction(c",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "439-446",
    "snippet": "id MessageView::newLabelAction(const QString &tag)\n{\n    if (!message.isValid())\n        return;\n\n    Imap::Mailbox::Model *model = dynamic_cast<Imap::Mailbox::Model *>(const_cast<QAbstractItemModel *>(message.model()));\n    model->setMessageFlags(QModelIndexList() << message, tag, Imap::Mailbox::FLAG_ADD);\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "del->setMessageFlags",
          "args": [
            "odelIndexList() << message,",
            "g,",
            "ap::Mailbox::FLAG_ADD);"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odelIndexList()",
          "args": [],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "namic_cast<Imap::Mailbox::Model *>",
          "args": [
            "nst_cast<QAbstractItemModel *>(message.model()));"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nst_cast<QAbstractItemModel *>",
          "args": [
            "ssage.model()))"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssage.model",
          "args": [],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ssage.isValid",
          "args": [],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::newLabelAction(const QString &tag)\n  {\n      if (!message.isValid())\n          return;\n  \n      Imap::Mailbox::Model *model = dynamic_cast<Imap::Mailbox::Model *>(const_cast<QAbstractItemModel *>(message.model()));\n      model->setMessageFlags(QModelIndexList() << message, tag, Imap::Mailbox::FLAG_ADD);\n  }\n}"
  },
  {
    "function_name": "externalsEnabled()",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "430-437",
    "snippet": "id MessageView::externalsEnabled()\n{\n    netAccess->setExternalsEnabled(true);\n    externalElements->hide();\n    AbstractPartWidget *w = dynamic_cast<AbstractPartWidget *>(viewer);\n    if (w)\n        w->reloadContents();\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": ">reloadContents",
          "args": [],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "namic_cast<AbstractPartWidget *>",
          "args": [
            "ewer);"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ternalElements->hide",
          "args": [],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tAccess->setExternalsEnabled",
          "args": [
            "ue);"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::externalsEnabled()\n  {\n      netAccess->setExternalsEnabled(true);\n      externalElements->hide();\n      AbstractPartWidget *w = dynamic_cast<AbstractPartWidget *>(viewer);\n      if (w)\n          w->reloadContents();\n  }\n}"
  },
  {
    "function_name": "externalsRequested(c",
    "container": "ssageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "424-428",
    "snippet": "id MessageView::externalsRequested(const QUrl &url)\n{\n    Q_UNUSED(url);\n    externalElements->show();\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ternalElements->show",
          "args": [],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UNUSED(u",
          "args": [
            "l);"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::externalsRequested(const QUrl &url)\n  {\n      Q_UNUSED(url);\n      externalElements->show();\n  }\n}"
  },
  {
    "function_name": "reply(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "381-422",
    "snippet": "oid MessageView::reply(MainWindow *mainWindow, Composer::ReplyMode mode)\n{\n    if (!message.isValid())\n        return;\n\n    // The Message-Id of the original message might have been empty; be sure we can handle that\n    QByteArray messageId = message.data(Imap::Mailbox::RoleMessageMessageId).toByteArray();\n    QList<QByteArray> messageIdList;\n    if (!messageId.isEmpty()) {\n        messageIdList.append(messageId);\n    }\n\n    ComposeWidget *w = mainWindow->invokeComposeDialog(\n                Composer::Util::replySubject(message.data(Imap::Mailbox::RoleMessageSubject).toString()), quoteText(),\n                QList<QPair<Composer::RecipientKind,QString> >(),\n                messageIdList,\n                message.data(Imap::Mailbox::RoleMessageHeaderReferences).value<QList<QByteArray> >() + messageIdList,\n                message\n                );\n    if (!w)\n        return;\n\n    bool ok = w->setReplyMode(mode);\n    if (!ok) {\n        QString err;\n        switch (mode) {\n        case Composer::REPLY_ALL:\n        case Composer::REPLY_ALL_BUT_ME:\n            // do nothing\n            break;\n        case Composer::REPLY_LIST:\n            err = tr(\"It doesn't look like this is a message to the mailing list. Please fill in the recipients manually.\");\n            break;\n        case Composer::REPLY_PRIVATE:\n            err = trUtf8(\"Trojit was unable to safely determine the real e-mail address of the author of the message. \"\n                         \"You might want to use the \\\"Reply All\\\" function and trim the list of addresses manually.\");\n            break;\n        }\n        if (!err.isEmpty())\n            QMessageBox::warning(w, tr(\"Cannot Determine Recipients\"), err);\n    }\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "essageBox::warning(w",
          "args": [
            "(\"Cannot Determine Recipients\"),",
            "r);"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(\"",
          "args": [
            "annot Determine Recipients\"),"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.isEmpty",
          "args": [],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rUtf8(",
          "args": [
            "Trojit was unable to safely determine the real e-mail address of the author of the message. \"\n                         \"You might want to use the \\\"Reply All\\\" function and trim the list of addresses manually.\");"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "It doesn't look like this is a message to the mailing list. Please fill in the recipients manually.\")"
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "->setReplyMode",
          "args": [
            "ode)"
          ],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ainWindow->invokeComposeDialog",
          "args": [
            "omposer::Util::replySubject(message.data(Imap::Mailbox::RoleMessageSubject).toString()),",
            "uoteText(),",
            "List<QPair<Composer::RecipientKind,QString> >(),",
            "essageIdList,",
            "essage.data(Imap::Mailbox::RoleMessageHeaderReferences).value<QList<QByteArray> >() + messageIdList,",
            "essage"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [],
          "line": 397
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageHeaderReferences)"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "List<QPair<Composer::RecipientKind,QString> >",
          "args": [],
          "line": 395
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uoteText(",
          "args": [],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "quoteText(",
          "container": "essageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "311-379",
          "snippet": "String MessageView::quoteText() const\n{\n    if (const AbstractPartWidget *w = dynamic_cast<const AbstractPartWidget *>(viewer)) {\n        QStringList quote;\n        QStringList lines = w->quoteMe().split('\\n');\n        for (QStringList::iterator line = lines.begin(); line != lines.end(); ++line) {\n            if (Composer::Util::signatureSeparator().exactMatch(*line)) {\n                // This is the signature separator, we should not include anything below that in the quote\n                break;\n            }\n            // rewrap - we need to keep the quotes at < 79 chars, yet the grow with every level\n            if (line->length() < 79-2) {\n                // this line is short enough, prepend quote mark and continue\n                if (line->isEmpty() || line->at(0) == '>')\n                    line->prepend(\">\");\n                else\n                    line->prepend(\"> \");\n                quote << *line;\n                continue;\n            }\n            // long line -> needs to be wrapped\n            // 1st, detect the quote depth and eventually stript the quotes from the line\n            int quoteLevel = 0;\n            int contentStart = 0;\n            if (line->at(0) == '>') {\n                quoteLevel = 1;\n                while (quoteLevel < line->length() && line->at(quoteLevel) == '>')\n                    ++quoteLevel;\n                contentStart = quoteLevel;\n                if (quoteLevel < line->length() && line->at(quoteLevel) == ' ')\n                    ++contentStart;\n            }\n\n            // 2nd, build a qute string\n            QString quotemarks;\n            for (int i = 0; i < quoteLevel; ++i)\n                quotemarks += \">\";\n            quotemarks += \"> \";\n\n            // 3rd, wrap the line, prepend the quotemarks to each line and add it to the quote text\n            int space(contentStart), lastSpace(contentStart), pos(contentStart), length(0);\n            while (pos < line->length()) {\n                if (line->at(pos) == ' ')\n                    space = pos+1;\n                ++length;\n                if (length > 65-quotemarks.length() && space != lastSpace) {\n                    // wrap\n                    quote << quotemarks + line->mid(lastSpace, space - lastSpace);\n                    lastSpace = space;\n                    length = pos - space;\n                }\n                ++pos;\n            }\n            quote << quotemarks + line->mid(lastSpace);\n        }\n        const Imap::Message::Envelope &e = message.data(Imap::Mailbox::RoleMessageEnvelope).value<Imap::Message::Envelope>();\n        QString sender;\n        if (!e.from.isEmpty())\n            sender = e.from[0].prettyName(Imap::Message::MailAddress::FORMAT_JUST_NAME);\n        if (e.from.isEmpty())\n            sender = tr(\"you\");\n\n        // One extra newline at the end of the quoted text to separate the response\n        quote << QString();\n\n        return tr(\"On %1, %2 wrote:\\n\").arg(e.date.toLocalTime().toString(Qt::SystemLocaleLongDate)).arg(sender) + quote.join(\"\\n\");\n    }\n    return QString();\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  String MessageView::quoteText() const\n  {\n      if (const AbstractPartWidget *w = dynamic_cast<const AbstractPartWidget *>(viewer)) {\n          QStringList quote;\n          QStringList lines = w->quoteMe().split('\\n');\n          for (QStringList::iterator line = lines.begin(); line != lines.end(); ++line) {\n              if (Composer::Util::signatureSeparator().exactMatch(*line)) {\n                  // This is the signature separator, we should not include anything below that in the quote\n                  break;\n              }\n              // rewrap - we need to keep the quotes at < 79 chars, yet the grow with every level\n              if (line->length() < 79-2) {\n                  // this line is short enough, prepend quote mark and continue\n                  if (line->isEmpty() || line->at(0) == '>')\n                      line->prepend(\">\");\n                  else\n                      line->prepend(\"> \");\n                  quote << *line;\n                  continue;\n              }\n              // long line -> needs to be wrapped\n              // 1st, detect the quote depth and eventually stript the quotes from the line\n              int quoteLevel = 0;\n              int contentStart = 0;\n              if (line->at(0) == '>') {\n                  quoteLevel = 1;\n                  while (quoteLevel < line->length() && line->at(quoteLevel) == '>')\n                      ++quoteLevel;\n                  contentStart = quoteLevel;\n                  if (quoteLevel < line->length() && line->at(quoteLevel) == ' ')\n                      ++contentStart;\n              }\n  \n              // 2nd, build a qute string\n              QString quotemarks;\n              for (int i = 0; i < quoteLevel; ++i)\n                  quotemarks += \">\";\n              quotemarks += \"> \";\n  \n              // 3rd, wrap the line, prepend the quotemarks to each line and add it to the quote text\n              int space(contentStart), lastSpace(contentStart), pos(contentStart), length(0);\n              while (pos < line->length()) {\n                  if (line->at(pos) == ' ')\n                      space = pos+1;\n                  ++length;\n                  if (length > 65-quotemarks.length() && space != lastSpace) {\n                      // wrap\n                      quote << quotemarks + line->mid(lastSpace, space - lastSpace);\n                      lastSpace = space;\n                      length = pos - space;\n                  }\n                  ++pos;\n              }\n              quote << quotemarks + line->mid(lastSpace);\n          }\n          const Imap::Message::Envelope &e = message.data(Imap::Mailbox::RoleMessageEnvelope).value<Imap::Message::Envelope>();\n          QString sender;\n          if (!e.from.isEmpty())\n              sender = e.from[0].prettyName(Imap::Message::MailAddress::FORMAT_JUST_NAME);\n          if (e.from.isEmpty())\n              sender = tr(\"you\");\n  \n          // One extra newline at the end of the quoted text to separate the response\n          quote << QString();\n  \n          return tr(\"On %1, %2 wrote:\\n\").arg(e.date.toLocalTime().toString(Qt::SystemLocaleLongDate)).arg(sender) + quote.join(\"\\n\");\n      }\n      return QString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "omposer::Util::replySubject(",
          "args": [
            "essage.data(Imap::Mailbox::RoleMessageSubject).toString())"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageSubject)"
          ],
          "line": 394
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essageIdList.append",
          "args": [
            "essageId)"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essageId.isEmpty",
          "args": [],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageMessageId)"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.isValid",
          "args": [],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  oid MessageView::reply(MainWindow *mainWindow, Composer::ReplyMode mode)\n  {\n      if (!message.isValid())\n          return;\n  \n      // The Message-Id of the original message might have been empty; be sure we can handle that\n      QByteArray messageId = message.data(Imap::Mailbox::RoleMessageMessageId).toByteArray();\n      QList<QByteArray> messageIdList;\n      if (!messageId.isEmpty()) {\n          messageIdList.append(messageId);\n      }\n  \n      ComposeWidget *w = mainWindow->invokeComposeDialog(\n                  Composer::Util::replySubject(message.data(Imap::Mailbox::RoleMessageSubject).toString()), quoteText(),\n                  QList<QPair<Composer::RecipientKind,QString> >(),\n                  messageIdList,\n                  message.data(Imap::Mailbox::RoleMessageHeaderReferences).value<QList<QByteArray> >() + messageIdList,\n                  message\n                  );\n      if (!w)\n          return;\n  \n      bool ok = w->setReplyMode(mode);\n      if (!ok) {\n          QString err;\n          switch (mode) {\n          case Composer::REPLY_ALL:\n          case Composer::REPLY_ALL_BUT_ME:\n              // do nothing\n              break;\n          case Composer::REPLY_LIST:\n              err = tr(\"It doesn't look like this is a message to the mailing list. Please fill in the recipients manually.\");\n              break;\n          case Composer::REPLY_PRIVATE:\n              err = trUtf8(\"Trojit was unable to safely determine the real e-mail address of the author of the message. \"\n                           \"You might want to use the \\\"Reply All\\\" function and trim the list of addresses manually.\");\n              break;\n          }\n          if (!err.isEmpty())\n              QMessageBox::warning(w, tr(\"Cannot Determine Recipients\"), err);\n      }\n  }\n}"
  },
  {
    "function_name": "quoteText(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "311-379",
    "snippet": "String MessageView::quoteText() const\n{\n    if (const AbstractPartWidget *w = dynamic_cast<const AbstractPartWidget *>(viewer)) {\n        QStringList quote;\n        QStringList lines = w->quoteMe().split('\\n');\n        for (QStringList::iterator line = lines.begin(); line != lines.end(); ++line) {\n            if (Composer::Util::signatureSeparator().exactMatch(*line)) {\n                // This is the signature separator, we should not include anything below that in the quote\n                break;\n            }\n            // rewrap - we need to keep the quotes at < 79 chars, yet the grow with every level\n            if (line->length() < 79-2) {\n                // this line is short enough, prepend quote mark and continue\n                if (line->isEmpty() || line->at(0) == '>')\n                    line->prepend(\">\");\n                else\n                    line->prepend(\"> \");\n                quote << *line;\n                continue;\n            }\n            // long line -> needs to be wrapped\n            // 1st, detect the quote depth and eventually stript the quotes from the line\n            int quoteLevel = 0;\n            int contentStart = 0;\n            if (line->at(0) == '>') {\n                quoteLevel = 1;\n                while (quoteLevel < line->length() && line->at(quoteLevel) == '>')\n                    ++quoteLevel;\n                contentStart = quoteLevel;\n                if (quoteLevel < line->length() && line->at(quoteLevel) == ' ')\n                    ++contentStart;\n            }\n\n            // 2nd, build a qute string\n            QString quotemarks;\n            for (int i = 0; i < quoteLevel; ++i)\n                quotemarks += \">\";\n            quotemarks += \"> \";\n\n            // 3rd, wrap the line, prepend the quotemarks to each line and add it to the quote text\n            int space(contentStart), lastSpace(contentStart), pos(contentStart), length(0);\n            while (pos < line->length()) {\n                if (line->at(pos) == ' ')\n                    space = pos+1;\n                ++length;\n                if (length > 65-quotemarks.length() && space != lastSpace) {\n                    // wrap\n                    quote << quotemarks + line->mid(lastSpace, space - lastSpace);\n                    lastSpace = space;\n                    length = pos - space;\n                }\n                ++pos;\n            }\n            quote << quotemarks + line->mid(lastSpace);\n        }\n        const Imap::Message::Envelope &e = message.data(Imap::Mailbox::RoleMessageEnvelope).value<Imap::Message::Envelope>();\n        QString sender;\n        if (!e.from.isEmpty())\n            sender = e.from[0].prettyName(Imap::Message::MailAddress::FORMAT_JUST_NAME);\n        if (e.from.isEmpty())\n            sender = tr(\"you\");\n\n        // One extra newline at the end of the quoted text to separate the response\n        quote << QString();\n\n        return tr(\"On %1, %2 wrote:\\n\").arg(e.date.toLocalTime().toString(Qt::SystemLocaleLongDate)).arg(sender) + quote.join(\"\\n\");\n    }\n    return QString();\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "uote.join",
          "args": [
            "\\n\")"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "ender)"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "partContextMenuRequested(c",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "489-502",
          "snippet": "id MessageView::partContextMenuRequested(const QPoint &point)\n{\n    if (SimplePartWidget *w = qobject_cast<SimplePartWidget *>(sender())) {\n        QMenu menu(w);\n        Q_FOREACH(QAction *action, w->contextMenuSpecificActions())\n            menu.addAction(action);\n        menu.addAction(w->pageAction(QWebPage::SelectAll));\n        if (!w->page()->mainFrame()->hitTestContent(point).linkUrl().isEmpty()) {\n            menu.addSeparator();\n            menu.addAction(w->pageAction(QWebPage::CopyLinkToClipboard));\n        }\n        menu.exec(w->mapToGlobal(point));\n    }\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::partContextMenuRequested(const QPoint &point)\n  {\n      if (SimplePartWidget *w = qobject_cast<SimplePartWidget *>(sender())) {\n          QMenu menu(w);\n          Q_FOREACH(QAction *action, w->contextMenuSpecificActions())\n              menu.addAction(action);\n          menu.addAction(w->pageAction(QWebPage::SelectAll));\n          if (!w->page()->mainFrame()->hitTestContent(point).linkUrl().isEmpty()) {\n              menu.addSeparator();\n              menu.addAction(w->pageAction(QWebPage::CopyLinkToClipboard));\n          }\n          menu.exec(w->mapToGlobal(point));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": ".date.toLocalTime",
          "args": [
            "t::SystemLocaleLongDate)"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".date.toLocalTime",
          "args": [],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "On %1, %2 wrote:\\n\")"
          ],
          "line": 376
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": ".from.isEmpty",
          "args": [],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".from[0].prettyName",
          "args": [
            "map::Message::MailAddress::FORMAT_JUST_NAME)"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".from.isEmpty",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageEnvelope)"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->mid",
          "args": [
            "astSpace)"
          ],
          "line": 364
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->mid",
          "args": [
            "astSpace,",
            "pace - lastSpace)"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uotemarks.length",
          "args": [],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->at",
          "args": [
            "os)"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->length",
          "args": [],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->at",
          "args": [
            "uoteLevel)"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->length",
          "args": [],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->at",
          "args": [
            "uoteLevel)"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->length",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->at",
          "args": [
            ")"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->prepend",
          "args": [
            "> \")"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->prepend",
          "args": [
            ">\")"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->at",
          "args": [
            ")"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->isEmpty",
          "args": [],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ine->length",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omposer::Util::signatureSeparator",
          "args": [
            "line)"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omposer::Util::signatureSeparator(",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ines.end",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ines.begin",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->quoteMe",
          "args": [
            "\\n')"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->quoteMe",
          "args": [],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "quoteMe(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "76-80",
          "snippet": "String LoadablePartWidget::quoteMe() const\n{\n    AbstractPartWidget *part = dynamic_cast<AbstractPartWidget*>(realPart);\n    return part ? part->quoteMe() : QString();\n}",
          "includes": [
            "include <QPushButton>",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"LoadablePartWidget.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  String LoadablePartWidget::quoteMe() const\n  {\n      AbstractPartWidget *part = dynamic_cast<AbstractPartWidget*>(realPart);\n      return part ? part->quoteMe() : QString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ynamic_cast<const AbstractPartWidget *>",
          "args": [
            "iewer)"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  String MessageView::quoteText() const\n  {\n      if (const AbstractPartWidget *w = dynamic_cast<const AbstractPartWidget *>(viewer)) {\n          QStringList quote;\n          QStringList lines = w->quoteMe().split('\\n');\n          for (QStringList::iterator line = lines.begin(); line != lines.end(); ++line) {\n              if (Composer::Util::signatureSeparator().exactMatch(*line)) {\n                  // This is the signature separator, we should not include anything below that in the quote\n                  break;\n              }\n              // rewrap - we need to keep the quotes at < 79 chars, yet the grow with every level\n              if (line->length() < 79-2) {\n                  // this line is short enough, prepend quote mark and continue\n                  if (line->isEmpty() || line->at(0) == '>')\n                      line->prepend(\">\");\n                  else\n                      line->prepend(\"> \");\n                  quote << *line;\n                  continue;\n              }\n              // long line -> needs to be wrapped\n              // 1st, detect the quote depth and eventually stript the quotes from the line\n              int quoteLevel = 0;\n              int contentStart = 0;\n              if (line->at(0) == '>') {\n                  quoteLevel = 1;\n                  while (quoteLevel < line->length() && line->at(quoteLevel) == '>')\n                      ++quoteLevel;\n                  contentStart = quoteLevel;\n                  if (quoteLevel < line->length() && line->at(quoteLevel) == ' ')\n                      ++contentStart;\n              }\n  \n              // 2nd, build a qute string\n              QString quotemarks;\n              for (int i = 0; i < quoteLevel; ++i)\n                  quotemarks += \">\";\n              quotemarks += \"> \";\n  \n              // 3rd, wrap the line, prepend the quotemarks to each line and add it to the quote text\n              int space(contentStart), lastSpace(contentStart), pos(contentStart), length(0);\n              while (pos < line->length()) {\n                  if (line->at(pos) == ' ')\n                      space = pos+1;\n                  ++length;\n                  if (length > 65-quotemarks.length() && space != lastSpace) {\n                      // wrap\n                      quote << quotemarks + line->mid(lastSpace, space - lastSpace);\n                      lastSpace = space;\n                      length = pos - space;\n                  }\n                  ++pos;\n              }\n              quote << quotemarks + line->mid(lastSpace);\n          }\n          const Imap::Message::Envelope &e = message.data(Imap::Mailbox::RoleMessageEnvelope).value<Imap::Message::Envelope>();\n          QString sender;\n          if (!e.from.isEmpty())\n              sender = e.from[0].prettyName(Imap::Message::MailAddress::FORMAT_JUST_NAME);\n          if (e.from.isEmpty())\n              sender = tr(\"you\");\n  \n          // One extra newline at the end of the quoted text to separate the response\n          quote << QString();\n  \n          return tr(\"On %1, %2 wrote:\\n\").arg(e.date.toLocalTime().toString(Qt::SystemLocaleLongDate)).arg(sender) + quote.join(\"\\n\");\n      }\n      return QString();\n  }\n}"
  },
  {
    "function_name": "eventFilter(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "279-309",
    "snippet": "ool MessageView::eventFilter(QObject *object, QEvent *event)\n{\n    if (event->type() == QEvent::Wheel) {\n        // while the containing scrollview has Qt::StrongFocus, the event forwarding breaks that\n        // -> completely disable focus for the following wheel event ...\n        parentWidget()->setFocusPolicy(Qt::NoFocus);\n        MessageView::event(event);\n        // ... set reset it\n        parentWidget()->setFocusPolicy(Qt::StrongFocus);\n        return true;\n    } else if (event->type() == QEvent::KeyPress || event->type() == QEvent::KeyRelease) {\n        QKeyEvent *keyEvent = static_cast<QKeyEvent *>(event);\n        switch (keyEvent->key()) {\n        case Qt::Key_Left:\n        case Qt::Key_Right:\n        case Qt::Key_Up:\n        case Qt::Key_Down:\n        case Qt::Key_PageUp:\n        case Qt::Key_PageDown:\n            MessageView::event(event);\n            return true;\n        case Qt::Key_Home:\n        case Qt::Key_End:\n            return false;\n        default:\n            return QObject::eventFilter(object, event);\n        }\n    } else {\n        return QObject::eventFilter(object, event);\n    }\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Object::eventFilter(",
          "args": [
            "bject,",
            "vent)"
          ],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "eventFilter(",
          "container": "essageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "279-309",
          "snippet": "ool MessageView::eventFilter(QObject *object, QEvent *event)\n{\n    if (event->type() == QEvent::Wheel) {\n        // while the containing scrollview has Qt::StrongFocus, the event forwarding breaks that\n        // -> completely disable focus for the following wheel event ...\n        parentWidget()->setFocusPolicy(Qt::NoFocus);\n        MessageView::event(event);\n        // ... set reset it\n        parentWidget()->setFocusPolicy(Qt::StrongFocus);\n        return true;\n    } else if (event->type() == QEvent::KeyPress || event->type() == QEvent::KeyRelease) {\n        QKeyEvent *keyEvent = static_cast<QKeyEvent *>(event);\n        switch (keyEvent->key()) {\n        case Qt::Key_Left:\n        case Qt::Key_Right:\n        case Qt::Key_Up:\n        case Qt::Key_Down:\n        case Qt::Key_PageUp:\n        case Qt::Key_PageDown:\n            MessageView::event(event);\n            return true;\n        case Qt::Key_Home:\n        case Qt::Key_End:\n            return false;\n        default:\n            return QObject::eventFilter(object, event);\n        }\n    } else {\n        return QObject::eventFilter(object, event);\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "essageView::event(",
          "args": [
            "vent)"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "event(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "115-123",
          "snippet": "ool Spinner::event(QEvent *e)\n{\n    if (e->type() == QEvent::Show && m_geometryDirty) {\n        updateGeometry();\n    } else if (e->type() == QEvent::ParentChange) {\n        updateAncestors();\n    }\n    return QWidget::event(e);\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  ool Spinner::event(QEvent *e)\n  {\n      if (e->type() == QEvent::Show && m_geometryDirty) {\n          updateGeometry();\n      } else if (e->type() == QEvent::ParentChange) {\n          updateAncestors();\n      }\n      return QWidget::event(e);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eyEvent->key",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QKeyEvent *>",
          "args": [
            "vent)"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vent->type",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arentWidget",
          "args": [
            "t::StrongFocus)"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arentWidget(",
          "args": [],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arentWidget",
          "args": [
            "t::NoFocus)"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arentWidget(",
          "args": [],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  ool MessageView::eventFilter(QObject *object, QEvent *event)\n  {\n      if (event->type() == QEvent::Wheel) {\n          // while the containing scrollview has Qt::StrongFocus, the event forwarding breaks that\n          // -> completely disable focus for the following wheel event ...\n          parentWidget()->setFocusPolicy(Qt::NoFocus);\n          MessageView::event(event);\n          // ... set reset it\n          parentWidget()->setFocusPolicy(Qt::StrongFocus);\n          return true;\n      } else if (event->type() == QEvent::KeyPress || event->type() == QEvent::KeyRelease) {\n          QKeyEvent *keyEvent = static_cast<QKeyEvent *>(event);\n          switch (keyEvent->key()) {\n          case Qt::Key_Left:\n          case Qt::Key_Right:\n          case Qt::Key_Up:\n          case Qt::Key_Down:\n          case Qt::Key_PageUp:\n          case Qt::Key_PageDown:\n              MessageView::event(event);\n              return true;\n          case Qt::Key_Home:\n          case Qt::Key_End:\n              return false;\n          default:\n              return QObject::eventFilter(object, event);\n          }\n      } else {\n          return QObject::eventFilter(object, event);\n      }\n  }\n}"
  },
  {
    "function_name": "stopAutoMarkAsRead(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "274-277",
    "snippet": "oid MessageView::stopAutoMarkAsRead()\n{\n    markAsReadTimer->stop();\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arkAsReadTimer->stop",
          "args": [],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  oid MessageView::stopAutoMarkAsRead()\n  {\n      markAsReadTimer->stop();\n  }\n}"
  },
  {
    "function_name": "markAsRead(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "256-266",
    "snippet": "oid MessageView::markAsRead()\n{\n    if (!message.isValid())\n        return;\n    Imap::Mailbox::Model *model = const_cast<Imap::Mailbox::Model *>(dynamic_cast<const Imap::Mailbox::Model *>(message.model()));\n    Q_ASSERT(model);\n    if (!model->isNetworkAvailable())\n        return;\n    if (!message.data(Imap::Mailbox::RoleMessageIsMarkedRead).toBool())\n        model->markMessagesRead(QModelIndexList() << message, Imap::Mailbox::FLAG_ADD);\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "odel->markMessagesRead",
          "args": [
            "ModelIndexList() << message,",
            "map::Mailbox::FLAG_ADD)"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndexList(",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageIsMarkedRead)"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->isNetworkAvailable",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "odel)"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onst_cast<Imap::Mailbox::Model *>",
          "args": [
            "ynamic_cast<const Imap::Mailbox::Model *>(message.model()))"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<const Imap::Mailbox::Model *>",
          "args": [
            "essage.model())"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.model",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.isValid",
          "args": [],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  oid MessageView::markAsRead()\n  {\n      if (!message.isValid())\n          return;\n      Imap::Mailbox::Model *model = const_cast<Imap::Mailbox::Model *>(dynamic_cast<const Imap::Mailbox::Model *>(message.model()));\n      Q_ASSERT(model);\n      if (!model->isNetworkAvailable())\n          return;\n      if (!message.data(Imap::Mailbox::RoleMessageIsMarkedRead).toBool())\n          model->markMessagesRead(QModelIndexList() << message, Imap::Mailbox::FLAG_ADD);\n  }\n}"
  },
  {
    "function_name": "setMessage(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "189-254",
    "snippet": "oid MessageView::setMessage(const QModelIndex &index)\n{\n    // first, let's get a real model\n    QModelIndex messageIndex;\n    const Imap::Mailbox::Model *constModel = 0;\n    Imap::Mailbox::TreeItem *item = Imap::Mailbox::Model::realTreeItem(index, &constModel, &messageIndex);\n    Q_ASSERT(item); // Make sure it's a message\n    Q_ASSERT(messageIndex.isValid());\n    Imap::Mailbox::Model *realModel = const_cast<Imap::Mailbox::Model *>(constModel);\n    Q_ASSERT(realModel);\n\n    // The data might be available from the local cache, so let's try to save a possible roundtrip here\n    item->fetch(realModel);\n\n    if (!messageIndex.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n        // This happens when the message placeholder is already available in the GUI, but the actual message data haven't been\n        // loaded yet. This is especially common with the threading model.\n        // Note that the data might be already available in the cache, it's just that it isn't in the mailbox tree yet.\n        setEmpty();\n        connect(realModel, SIGNAL(dataChanged(QModelIndex,QModelIndex)), this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n        message = messageIndex;\n        return;\n    }\n\n    QModelIndex rootPartIndex = messageIndex.child(0, 0);\n\n    headerSection->show();\n    if (message != messageIndex) {\n        emptyView->hide();\n        layout->removeWidget(viewer);\n        if (viewer != emptyView) {\n            viewer->setParent(0);\n            viewer->deleteLater();\n        }\n        message = messageIndex;\n        netAccess->setExternalsEnabled(false);\n        externalElements->hide();\n\n        netAccess->setModelMessage(message);\n\n        m_loadingItems.clear();\n        m_loadingSpinner->stop();\n\n        PartWidgetFactory::PartLoadingOptions loadingMode;\n        if (m_settings->value(Common::SettingsNames::guiPreferPlaintextRendering, QVariant(true)).toBool())\n            loadingMode |= PartWidgetFactory::PART_PREFER_PLAINTEXT_OVER_HTML;\n        viewer = factory->create(rootPartIndex, 0, loadingMode);\n        viewer->setParent(this);\n        layout->addWidget(viewer);\n        viewer->show();\n        m_envelope->setMessage(message);\n\n        tags->show();\n        tags->setTagList(messageIndex.data(Imap::Mailbox::RoleMessageFlags).toStringList());\n        disconnect(this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n        connect(realModel, SIGNAL(dataChanged(QModelIndex,QModelIndex)), this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n\n        emit messageChanged();\n\n        // We want to propagate the QWheelEvent to upper layers\n        viewer->installEventFilter(this);\n    }\n\n    if (realModel->isNetworkAvailable())\n        markAsReadTimer->start(200); // FIXME: make this configurable\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arkAsReadTimer->start",
          "args": [
            "00)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ealModel->isNetworkAvailable",
          "args": [],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iewer->installEventFilter",
          "args": [
            "his)"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "ealModel,",
            "IGNAL(dataChanged(QModelIndex,QModelIndex)),",
            "his,",
            "LOT(handleDataChanged(QModelIndex,QModelIndex)))"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "andleDataChanged(QModelIndex,QModelIndex))"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "andleDataChanged(",
          "args": [
            "ModelIndex,",
            "ModelIndex)"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "handleDataChanged(c",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "457-468",
          "snippet": "id MessageView::handleDataChanged(const QModelIndex &topLeft, const QModelIndex &bottomRight)\n{\n    Q_ASSERT(topLeft.row() == bottomRight.row() && topLeft.parent() == bottomRight.parent());\n    if (topLeft == message) {\n        if (viewer == emptyView && message.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n            qDebug() << \"MessageView: message which was previously not loaded has just became available\";\n            setEmpty();\n            setMessage(topLeft);\n        }\n        tags->setTagList(message.data(Imap::Mailbox::RoleMessageFlags).toStringList());\n    }\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::handleDataChanged(const QModelIndex &topLeft, const QModelIndex &bottomRight)\n  {\n      Q_ASSERT(topLeft.row() == bottomRight.row() && topLeft.parent() == bottomRight.parent());\n      if (topLeft == message) {\n          if (viewer == emptyView && message.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n              qDebug() << \"MessageView: message which was previously not loaded has just became available\";\n              setEmpty();\n              setMessage(topLeft);\n          }\n          tags->setTagList(message.data(Imap::Mailbox::RoleMessageFlags).toStringList());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ataChanged(QModelIndex,QModelIndex))"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isconnect(",
          "args": [
            "his,",
            "LOT(handleDataChanged(QModelIndex,QModelIndex)))"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "andleDataChanged(QModelIndex,QModelIndex))"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ags->setTagList",
          "args": [
            "essageIndex.data(Imap::Mailbox::RoleMessageFlags).toStringList())"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "setTagList",
          "container": "TagListWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/TagListWidget.cpp",
          "lines": "50-66",
          "snippet": "void TagListWidget::setTagList(QStringList list)\n{\n    empty();\n    parentLayout->removeWidget(addButton);\n\n    foreach(const QString &tagName, list) {\n        if (m_ignoredFlags.contains(tagName.toLower()))\n            continue;\n        TagWidget *lbl = new TagWidget(tagName, \"x\");\n        parentLayout->addWidget(lbl);\n        connect(lbl, SIGNAL(removeClicked(QString)), this, SIGNAL(tagRemoved(QString)));\n\n        children << lbl;\n    }\n\n    parentLayout->addWidget(addButton);\n}",
          "includes": [
            "#include \"TagWidget.h\"",
            "#include \"FlowLayout.h\"",
            "#include \"TagListWidget.h\"",
            "#include <QPushButton>",
            "#include <QMessageBox>",
            "#include <QLabel>",
            "#include <QInputDialog>",
            "#include <QHBoxLayout>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"TagWidget.h\"\n#include \"FlowLayout.h\"\n#include \"TagListWidget.h\"\n#include <QPushButton>\n#include <QMessageBox>\n#include <QLabel>\n#include <QInputDialog>\n#include <QHBoxLayout>\n\nTagListWidget {\n  void TagListWidget::setTagList(QStringList list)\n  {\n      empty();\n      parentLayout->removeWidget(addButton);\n  \n      foreach(const QString &tagName, list) {\n          if (m_ignoredFlags.contains(tagName.toLower()))\n              continue;\n          TagWidget *lbl = new TagWidget(tagName, \"x\");\n          parentLayout->addWidget(lbl);\n          connect(lbl, SIGNAL(removeClicked(QString)), this, SIGNAL(tagRemoved(QString)));\n  \n          children << lbl;\n      }\n  \n      parentLayout->addWidget(addButton);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essageIndex.data",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essageIndex.data",
          "args": [
            "map::Mailbox::RoleMessageFlags)"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ags->show",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_envelope->setMessage",
          "args": [
            "essage)"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iewer->show",
          "args": [],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "showExpanded",
          "container": "QmlApplicationViewer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Harmattan/qmlapplicationviewer/qmlapplicationviewer.cpp",
          "lines": "159-168",
          "snippet": "void QmlApplicationViewer::showExpanded()\n{\n#if defined(MEEGO_EDITION_HARMATTAN) || defined(Q_WS_SIMULATOR) || defined(Q_OS_QNX)\n    showFullScreen();\n#elif defined(Q_WS_MAEMO_5)\n    showMaximized();\n#else\n    show();\n#endif\n}",
          "includes": [
            "#include <qdeclarativeviewobserver.h>",
            "#include <jsdebuggeragent.h>",
            "#include <qt_private/qdeclarativedebughelper_p.h>",
            "#include <MDeclarativeCache>",
            "#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN",
            "#include <QDeclarativeContext>",
            "#include <QDeclarativeEngine>",
            "#include <QDeclarativeComponent>",
            "#include <QApplication>",
            "#include <QFileInfo>",
            "#include <QDir>",
            "#include \"qmlapplicationviewer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qdeclarativeviewobserver.h>\n#include <jsdebuggeragent.h>\n#include <qt_private/qdeclarativedebughelper_p.h>\n#include <MDeclarativeCache>\n#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN\n#include <QDeclarativeContext>\n#include <QDeclarativeEngine>\n#include <QDeclarativeComponent>\n#include <QApplication>\n#include <QFileInfo>\n#include <QDir>\n#include \"qmlapplicationviewer.h\"\n\nQmlApplicationViewer {\n  void QmlApplicationViewer::showExpanded()\n  {\n  #if defined(MEEGO_EDITION_HARMATTAN) || defined(Q_WS_SIMULATOR) || defined(Q_OS_QNX)\n      showFullScreen();\n  #elif defined(Q_WS_MAEMO_5)\n      showMaximized();\n  #else\n      show();\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "iewer)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iewer->setParent",
          "args": [
            "his)"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "actory->create",
          "args": [
            "ootPartIndex,",
            ",",
            "oadingMode)"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_settings->value",
          "args": [],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "333-336",
          "snippet": "QByteArray QMimeMagicRule::value() const\n{\n    return d->value;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QByteArray QMimeMagicRule::value() const\n  {\n      return d->value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_settings->value",
          "args": [
            "ommon::SettingsNames::guiPreferPlaintextRendering,",
            "Variant(true))"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [
            "rue)"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "ddresListToQVariant(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "40-47",
          "snippet": "VariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nVariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_loadingSpinner->stop",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_loadingItems.clear",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "etAccess->setModelMessage",
          "args": [
            "essage)"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xternalElements->hide",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etAccess->setExternalsEnabled",
          "args": [
            "alse)"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iewer->deleteLater",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iewer->setParent",
          "args": [
            ")"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->removeWidget",
          "args": [
            "iewer)"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mptyView->hide",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderSection->show",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essageIndex.child",
          "args": [
            ",",
            ")"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "ealModel,",
            "IGNAL(dataChanged(QModelIndex,QModelIndex)),",
            "his,",
            "LOT(handleDataChanged(QModelIndex,QModelIndex)))"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "andleDataChanged(QModelIndex,QModelIndex))"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ataChanged(QModelIndex,QModelIndex))"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etEmpty(",
          "args": [],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "setEmpty(",
          "container": "essageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "169-187",
          "snippet": "oid MessageView::setEmpty()\n{\n    markAsReadTimer->stop();\n    m_envelope->setMessage(QModelIndex());\n    headerSection->hide();\n    message = QModelIndex();\n    disconnect(this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n    tags->hide();\n    if (viewer != emptyView) {\n        layout->removeWidget(viewer);\n        viewer->deleteLater();\n        viewer = emptyView;\n        viewer->show();\n        layout->addWidget(viewer);\n        emit messageChanged();\n        m_loadingItems.clear();\n        m_loadingSpinner->stop();\n    }\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  oid MessageView::setEmpty()\n  {\n      markAsReadTimer->stop();\n      m_envelope->setMessage(QModelIndex());\n      headerSection->hide();\n      message = QModelIndex();\n      disconnect(this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n      tags->hide();\n      if (viewer != emptyView) {\n          layout->removeWidget(viewer);\n          viewer->deleteLater();\n          viewer = emptyView;\n          viewer->show();\n          layout->addWidget(viewer);\n          emit messageChanged();\n          m_loadingItems.clear();\n          m_loadingSpinner->stop();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essageIndex.data",
          "args": [
            "map::Mailbox::RoleIsFetched)"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem->fetch",
          "args": [
            "ealModel)"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ealModel)"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onst_cast<Imap::Mailbox::Model *>",
          "args": [
            "onstModel)"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "essageIndex.isValid())"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essageIndex.isValid",
          "args": [],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "tem)"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::Mailbox::Model::realTreeItem(",
          "args": [
            "ndex,",
            "constModel,",
            "messageIndex)"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  oid MessageView::setMessage(const QModelIndex &index)\n  {\n      // first, let's get a real model\n      QModelIndex messageIndex;\n      const Imap::Mailbox::Model *constModel = 0;\n      Imap::Mailbox::TreeItem *item = Imap::Mailbox::Model::realTreeItem(index, &constModel, &messageIndex);\n      Q_ASSERT(item); // Make sure it's a message\n      Q_ASSERT(messageIndex.isValid());\n      Imap::Mailbox::Model *realModel = const_cast<Imap::Mailbox::Model *>(constModel);\n      Q_ASSERT(realModel);\n  \n      // The data might be available from the local cache, so let's try to save a possible roundtrip here\n      item->fetch(realModel);\n  \n      if (!messageIndex.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n          // This happens when the message placeholder is already available in the GUI, but the actual message data haven't been\n          // loaded yet. This is especially common with the threading model.\n          // Note that the data might be already available in the cache, it's just that it isn't in the mailbox tree yet.\n          setEmpty();\n          connect(realModel, SIGNAL(dataChanged(QModelIndex,QModelIndex)), this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n          message = messageIndex;\n          return;\n      }\n  \n      QModelIndex rootPartIndex = messageIndex.child(0, 0);\n  \n      headerSection->show();\n      if (message != messageIndex) {\n          emptyView->hide();\n          layout->removeWidget(viewer);\n          if (viewer != emptyView) {\n              viewer->setParent(0);\n              viewer->deleteLater();\n          }\n          message = messageIndex;\n          netAccess->setExternalsEnabled(false);\n          externalElements->hide();\n  \n          netAccess->setModelMessage(message);\n  \n          m_loadingItems.clear();\n          m_loadingSpinner->stop();\n  \n          PartWidgetFactory::PartLoadingOptions loadingMode;\n          if (m_settings->value(Common::SettingsNames::guiPreferPlaintextRendering, QVariant(true)).toBool())\n              loadingMode |= PartWidgetFactory::PART_PREFER_PLAINTEXT_OVER_HTML;\n          viewer = factory->create(rootPartIndex, 0, loadingMode);\n          viewer->setParent(this);\n          layout->addWidget(viewer);\n          viewer->show();\n          m_envelope->setMessage(message);\n  \n          tags->show();\n          tags->setTagList(messageIndex.data(Imap::Mailbox::RoleMessageFlags).toStringList());\n          disconnect(this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n          connect(realModel, SIGNAL(dataChanged(QModelIndex,QModelIndex)), this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n  \n          emit messageChanged();\n  \n          // We want to propagate the QWheelEvent to upper layers\n          viewer->installEventFilter(this);\n      }\n  \n      if (realModel->isNetworkAvailable())\n          markAsReadTimer->start(200); // FIXME: make this configurable\n  }\n}"
  },
  {
    "function_name": "setEmpty(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "169-187",
    "snippet": "oid MessageView::setEmpty()\n{\n    markAsReadTimer->stop();\n    m_envelope->setMessage(QModelIndex());\n    headerSection->hide();\n    message = QModelIndex();\n    disconnect(this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n    tags->hide();\n    if (viewer != emptyView) {\n        layout->removeWidget(viewer);\n        viewer->deleteLater();\n        viewer = emptyView;\n        viewer->show();\n        layout->addWidget(viewer);\n        emit messageChanged();\n        m_loadingItems.clear();\n        m_loadingSpinner->stop();\n    }\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_loadingSpinner->stop",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_loadingItems.clear",
          "args": [],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "iewer)"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iewer->show",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "showExpanded",
          "container": "QmlApplicationViewer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Harmattan/qmlapplicationviewer/qmlapplicationviewer.cpp",
          "lines": "159-168",
          "snippet": "void QmlApplicationViewer::showExpanded()\n{\n#if defined(MEEGO_EDITION_HARMATTAN) || defined(Q_WS_SIMULATOR) || defined(Q_OS_QNX)\n    showFullScreen();\n#elif defined(Q_WS_MAEMO_5)\n    showMaximized();\n#else\n    show();\n#endif\n}",
          "includes": [
            "#include <qdeclarativeviewobserver.h>",
            "#include <jsdebuggeragent.h>",
            "#include <qt_private/qdeclarativedebughelper_p.h>",
            "#include <MDeclarativeCache>",
            "#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN",
            "#include <QDeclarativeContext>",
            "#include <QDeclarativeEngine>",
            "#include <QDeclarativeComponent>",
            "#include <QApplication>",
            "#include <QFileInfo>",
            "#include <QDir>",
            "#include \"qmlapplicationviewer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qdeclarativeviewobserver.h>\n#include <jsdebuggeragent.h>\n#include <qt_private/qdeclarativedebughelper_p.h>\n#include <MDeclarativeCache>\n#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN\n#include <QDeclarativeContext>\n#include <QDeclarativeEngine>\n#include <QDeclarativeComponent>\n#include <QApplication>\n#include <QFileInfo>\n#include <QDir>\n#include \"qmlapplicationviewer.h\"\n\nQmlApplicationViewer {\n  void QmlApplicationViewer::showExpanded()\n  {\n  #if defined(MEEGO_EDITION_HARMATTAN) || defined(Q_WS_SIMULATOR) || defined(Q_OS_QNX)\n      showFullScreen();\n  #elif defined(Q_WS_MAEMO_5)\n      showMaximized();\n  #else\n      show();\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iewer->deleteLater",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->removeWidget",
          "args": [
            "iewer)"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ags->hide",
          "args": [],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isconnect(",
          "args": [
            "his,",
            "LOT(handleDataChanged(QModelIndex,QModelIndex)))"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "andleDataChanged(QModelIndex,QModelIndex))"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "andleDataChanged(",
          "args": [
            "ModelIndex,",
            "ModelIndex)"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "handleDataChanged(c",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "457-468",
          "snippet": "id MessageView::handleDataChanged(const QModelIndex &topLeft, const QModelIndex &bottomRight)\n{\n    Q_ASSERT(topLeft.row() == bottomRight.row() && topLeft.parent() == bottomRight.parent());\n    if (topLeft == message) {\n        if (viewer == emptyView && message.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n            qDebug() << \"MessageView: message which was previously not loaded has just became available\";\n            setEmpty();\n            setMessage(topLeft);\n        }\n        tags->setTagList(message.data(Imap::Mailbox::RoleMessageFlags).toStringList());\n    }\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::handleDataChanged(const QModelIndex &topLeft, const QModelIndex &bottomRight)\n  {\n      Q_ASSERT(topLeft.row() == bottomRight.row() && topLeft.parent() == bottomRight.parent());\n      if (topLeft == message) {\n          if (viewer == emptyView && message.data(Imap::Mailbox::RoleIsFetched).toBool()) {\n              qDebug() << \"MessageView: message which was previously not loaded has just became available\";\n              setEmpty();\n              setMessage(topLeft);\n          }\n          tags->setTagList(message.data(Imap::Mailbox::RoleMessageFlags).toStringList());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderSection->hide",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_envelope->setMessage",
          "args": [
            "ModelIndex())"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arkAsReadTimer->stop",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  oid MessageView::setEmpty()\n  {\n      markAsReadTimer->stop();\n      m_envelope->setMessage(QModelIndex());\n      headerSection->hide();\n      message = QModelIndex();\n      disconnect(this, SLOT(handleDataChanged(QModelIndex,QModelIndex)));\n      tags->hide();\n      if (viewer != emptyView) {\n          layout->removeWidget(viewer);\n          viewer->deleteLater();\n          viewer = emptyView;\n          viewer->show();\n          layout->addWidget(viewer);\n          emit messageChanged();\n          m_loadingItems.clear();\n          m_loadingSpinner->stop();\n      }\n  }\n}"
  },
  {
    "function_name": "~MessageView(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "155-167",
    "snippet": "essageView::~MessageView()\n{\n    // Redmine #496 -- the default order of destruction starts with our QNAM subclass which in turn takes care of all pending\n    // QNetworkReply instances created by that manager. When the destruction goes to the WebKit objects, they try to disconnect\n    // from the network replies which are however gone already. We can mitigate that by simply making sure that the destruction\n    // starts with the QWebView subclasses and only after that proceeds to the QNAM. Qt's default order leads to segfaults here.\n    if (viewer != emptyView) {\n        delete viewer;\n    }\n    delete emptyView;\n\n    delete factory;\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  essageView::~MessageView()\n  {\n      // Redmine #496 -- the default order of destruction starts with our QNAM subclass which in turn takes care of all pending\n      // QNetworkReply instances created by that manager. When the destruction goes to the WebKit objects, they try to disconnect\n      // from the network replies which are however gone already. We can mitigate that by simply making sure that the destruction\n      // starts with the QWebView subclasses and only after that proceeds to the QNAM. Qt's default order leads to segfaults here.\n      if (viewer != emptyView) {\n          delete viewer;\n      }\n      delete emptyView;\n  \n      delete factory;\n  }\n}"
  },
  {
    "function_name": "MessageView(",
    "container": "essageView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
    "lines": "62-153",
    "snippet": "essageView::MessageView(QWidget *parent, QSettings *settings): QWidget(parent), m_settings(settings)\n{\n    QPalette pal = palette();\n    pal.setColor(backgroundRole(), palette().color(QPalette::Active, QPalette::Base));\n    pal.setColor(foregroundRole(), palette().color(QPalette::Active, QPalette::Text));\n    setPalette(pal);\n    setAutoFillBackground(true);\n    setFocusPolicy(Qt::StrongFocus); // not by the wheel\n    netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n    connect(netAccess, SIGNAL(requestingExternal(QUrl)), this, SLOT(externalsRequested(QUrl)));\n    factory = new PartWidgetFactory(netAccess, this);\n\n    emptyView = new EmbeddedWebView(this, new QNetworkAccessManager(this));\n    emptyView->setFixedSize(450,300);\n    CALL_LATER_NOARG(emptyView, handlePageLoadFinished);\n    emptyView->setPage(new UserAgentWebPage(emptyView));\n    emptyView->installEventFilter(this);\n    emptyView->setAutoFillBackground(false);\n\n    viewer = emptyView;\n\n    //BEGIN create header section\n\n    headerSection = new QWidget(this);\n\n    // we create a dummy header, pass it through the style and the use it's color roles so we\n    // know what headers in general look like in the system\n    QHeaderView helpingHeader(Qt::Horizontal);\n    helpingHeader.ensurePolished();\n    pal = headerSection->palette();\n    pal.setColor(headerSection->backgroundRole(), palette().color(QPalette::Active, helpingHeader.backgroundRole()));\n    pal.setColor(headerSection->foregroundRole(), palette().color(QPalette::Active, helpingHeader.foregroundRole()));\n    headerSection->setPalette(pal);\n    headerSection->setAutoFillBackground(true);\n\n    // the actual mail header\n    m_envelope = new EnvelopeView(headerSection, this);\n\n    // the tag bar\n    tags = new TagListWidget(headerSection);\n    tags->setBackgroundRole(helpingHeader.backgroundRole());\n    tags->setForegroundRole(helpingHeader.foregroundRole());\n    tags->hide();\n    connect(tags, SIGNAL(tagAdded(QString)), this, SLOT(newLabelAction(QString)));\n    connect(tags, SIGNAL(tagRemoved(QString)), this, SLOT(deleteLabelAction(QString)));\n\n    // whether we allow to load external elements\n    externalElements = new ExternalElementsWidget(this);\n    externalElements->hide();\n    connect(externalElements, SIGNAL(loadingEnabled()), this, SLOT(externalsEnabled()));\n\n    // layout the header\n    layout = new QVBoxLayout(headerSection);\n    layout->addWidget(m_envelope, 1);\n    layout->addWidget(tags, 3);\n    layout->addWidget(externalElements, 1);\n\n    //END create header section\n\n    //BEGIN layout the message\n\n    layout = new QVBoxLayout(this);\n    layout->setSpacing(0);\n    layout->setContentsMargins(0,0,0,0);\n\n    layout->addWidget(headerSection, 1);\n\n    headerSection->hide();\n\n    // put the actual messages into an extra horizontal view\n    // this allows us easy usage of the trailing stretch and also to indent the message a bit\n    QHBoxLayout *hLayout = new QHBoxLayout;\n    hLayout->setContentsMargins(6,6,6,0);\n    hLayout->addWidget(viewer);\n    static_cast<QVBoxLayout*>(layout)->addLayout(hLayout, 1);\n    // add a strong stretch to squeeze header and message to the top\n    // possibly passing a large stretch factor to the message could be enough...\n    layout->addStretch(1000);\n\n    //END layout the message\n\n    // make the layout used to add messages our new horizontal layout\n    layout = hLayout;\n\n    markAsReadTimer = new QTimer(this);\n    markAsReadTimer->setSingleShot(true);\n    connect(markAsReadTimer, SIGNAL(timeout()), this, SLOT(markAsRead()));\n\n    m_loadingSpinner = new Spinner(this);\n    m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n    m_loadingSpinner->setType(Spinner::Sun);\n}",
    "includes": [
      "include \"Imap/Network/MsgPartNetAccessManager.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Composer/SubjectMangling.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Window.h\"\n#",
      "include \"UserAgentWebPage.h\"\n#",
      "include \"TagListWidget.h\"\n#",
      "include \"Spinner.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include \"PartWidgetFactory.h\"\n#",
      "include \"OverlayWidget.h\"\n#",
      "include \"ExternalElementsWidget.h\"\n#",
      "include \"EnvelopeView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#",
      "include \"ComposeWidget.h\"\n#",
      "include \"AbstractPartWidget.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QWebPage>",
      "include <QWebHitTestResult>\n#",
      "include <QWebHistory>\n#",
      "include <QWebFrame>\n#",
      "include <QVBoxLayout>\n#",
      "include <QUrl>\n#",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QProgressBar>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QDesktopServices>\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_loadingSpinner->setType",
          "args": [
            "pinner::Sun)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_loadingSpinner->setText",
          "args": [
            "r(\"Fetching\\nMessage\"))"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Fetching\\nMessage\")"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "arkAsReadTimer,",
            "IGNAL(timeout()),",
            "his,",
            "LOT(markAsRead()))"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "arkAsRead())"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arkAsRead(",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "stopAutoMarkAsRead(",
          "container": "essageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "274-277",
          "snippet": "oid MessageView::stopAutoMarkAsRead()\n{\n    markAsReadTimer->stop();\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  oid MessageView::stopAutoMarkAsRead()\n  {\n      markAsReadTimer->stop();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "imeout())"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "imeout(",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arkAsReadTimer->setSingleShot",
          "args": [
            "rue)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addStretch",
          "args": [
            "000)"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QVBoxLayout*>",
          "args": [
            "Layout,",
            ")"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QVBoxLayout*>",
          "args": [
            "ayout)"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Layout->addWidget",
          "args": [
            "iewer)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Layout->setContentsMargins",
          "args": [
            ",",
            ",",
            ",",
            ")"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderSection->hide",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "eaderSection,",
            ")"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->setContentsMargins",
          "args": [
            ",",
            ",",
            ",",
            ")"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->setSpacing",
          "args": [
            ")"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "xternalElements,",
            ")"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "ags,",
            ")"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "_envelope,",
            ")"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "xternalElements,",
            "IGNAL(loadingEnabled()),",
            "his,",
            "LOT(externalsEnabled()))"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "xternalsEnabled())"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xternalsEnabled(",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "externalsEnabled()",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "430-437",
          "snippet": "id MessageView::externalsEnabled()\n{\n    netAccess->setExternalsEnabled(true);\n    externalElements->hide();\n    AbstractPartWidget *w = dynamic_cast<AbstractPartWidget *>(viewer);\n    if (w)\n        w->reloadContents();\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::externalsEnabled()\n  {\n      netAccess->setExternalsEnabled(true);\n      externalElements->hide();\n      AbstractPartWidget *w = dynamic_cast<AbstractPartWidget *>(viewer);\n      if (w)\n          w->reloadContents();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "oadingEnabled())"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadingEnabled(",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xternalElements->hide",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "ags,",
            "IGNAL(tagRemoved(QString)),",
            "his,",
            "LOT(deleteLabelAction(QString)))"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLabelAction(QString))"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLabelAction(",
          "args": [
            "String)"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "deleteLabelAction(c",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "448-455",
          "snippet": "id MessageView::deleteLabelAction(const QString &tag)\n{\n    if (!message.isValid())\n        return;\n\n    Imap::Mailbox::Model *model = dynamic_cast<Imap::Mailbox::Model *>(const_cast<QAbstractItemModel *>(message.model()));\n    model->setMessageFlags(QModelIndexList() << message, tag, Imap::Mailbox::FLAG_REMOVE);\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::deleteLabelAction(const QString &tag)\n  {\n      if (!message.isValid())\n          return;\n  \n      Imap::Mailbox::Model *model = dynamic_cast<Imap::Mailbox::Model *>(const_cast<QAbstractItemModel *>(message.model()));\n      model->setMessageFlags(QModelIndexList() << message, tag, Imap::Mailbox::FLAG_REMOVE);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "agRemoved(QString))"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agRemoved(",
          "args": [
            "String)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "ags,",
            "IGNAL(tagAdded(QString)),",
            "his,",
            "LOT(newLabelAction(QString)))"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "ewLabelAction(QString))"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ewLabelAction(",
          "args": [
            "String)"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "newLabelAction(c",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "439-446",
          "snippet": "id MessageView::newLabelAction(const QString &tag)\n{\n    if (!message.isValid())\n        return;\n\n    Imap::Mailbox::Model *model = dynamic_cast<Imap::Mailbox::Model *>(const_cast<QAbstractItemModel *>(message.model()));\n    model->setMessageFlags(QModelIndexList() << message, tag, Imap::Mailbox::FLAG_ADD);\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::newLabelAction(const QString &tag)\n  {\n      if (!message.isValid())\n          return;\n  \n      Imap::Mailbox::Model *model = dynamic_cast<Imap::Mailbox::Model *>(const_cast<QAbstractItemModel *>(message.model()));\n      model->setMessageFlags(QModelIndexList() << message, tag, Imap::Mailbox::FLAG_ADD);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "agAdded(QString))"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "agAdded(",
          "args": [
            "String)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ags->hide",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ags->setForegroundRole",
          "args": [
            "elpingHeader.foregroundRole())"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elpingHeader.foregroundRole",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ags->setBackgroundRole",
          "args": [
            "elpingHeader.backgroundRole())"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elpingHeader.backgroundRole",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderSection->setAutoFillBackground",
          "args": [
            "rue)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderSection->setPalette",
          "args": [
            "al)"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.setColor",
          "args": [
            "eaderSection->foregroundRole(),",
            "alette().color(QPalette::Active, helpingHeader.foregroundRole()))"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "Palette::Active,",
            "elpingHeader.foregroundRole())"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elpingHeader.foregroundRole",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderSection->foregroundRole",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.setColor",
          "args": [
            "eaderSection->backgroundRole(),",
            "alette().color(QPalette::Active, helpingHeader.backgroundRole()))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "Palette::Active,",
            "elpingHeader.backgroundRole())"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elpingHeader.backgroundRole",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderSection->backgroundRole",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderSection->palette",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elpingHeader.ensurePolished",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mptyView->setAutoFillBackground",
          "args": [
            "alse)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mptyView->installEventFilter",
          "args": [
            "his)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mptyView->setPage",
          "args": [
            "ew UserAgentWebPage(emptyView))"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "setPage",
          "container": "TrojitaQNAMDeclarativeWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/QmlSupport/QNAMWebView/qdeclarativewebview.cpp",
          "lines": "765-789",
          "snippet": "void TrojitaQNAMDeclarativeWebView::setPage(QWebPage* page)\n{\n    if (d->view->page() == page)\n        return;\n\n    d->view->setPage(page);\n    updateContentsSize();\n    page->mainFrame()->setScrollBarPolicy(Qt::Horizontal, Qt::ScrollBarAlwaysOff);\n    page->mainFrame()->setScrollBarPolicy(Qt::Vertical, Qt::ScrollBarAlwaysOff);\n    connect(page->mainFrame(), SIGNAL(urlChanged(QUrl)), this, SLOT(pageUrlChanged()));\n    connect(page->mainFrame(), SIGNAL(titleChanged(QString)), this, SIGNAL(titleChanged(QString)));\n    connect(page->mainFrame(), SIGNAL(titleChanged(QString)), this, SIGNAL(iconChanged()));\n    connect(page->mainFrame(), SIGNAL(iconChanged()), this, SIGNAL(iconChanged()));\n    connect(page->mainFrame(), SIGNAL(initialLayoutCompleted()), this, SLOT(initialLayout()));\n    connect(page->mainFrame(), SIGNAL(contentsSizeChanged(QSize)), this, SIGNAL(contentsSizeChanged(QSize)));\n\n    connect(page, SIGNAL(loadStarted()), this, SLOT(doLoadStarted()));\n    connect(page, SIGNAL(loadProgress(int)), this, SLOT(doLoadProgress(int)));\n    connect(page, SIGNAL(loadFinished(bool)), this, SLOT(doLoadFinished(bool)));\n    connect(page, SIGNAL(statusBarMessage(QString)), this, SLOT(setStatusText(QString)));\n\n    connect(page->mainFrame(), SIGNAL(javaScriptWindowObjectCleared()), this, SLOT(windowObjectCleared()));\n\n    page->settings()->setAttribute(QWebSettings::TiledBackingStoreEnabled, true);\n}",
          "includes": [
            "#include \"qwebsettings.h\"",
            "#include \"qwebpage.h\"",
            "#include \"qwebframe.h\"",
            "#include \"qwebelement.h\"",
            "#include <QtGui/QPen>",
            "#include <QtGui/QMouseEvent>",
            "#include <QtGui/QKeyEvent>",
            "#include <QtGui/QGraphicsSceneMouseEvent>",
            "#include <QtGui/QApplication>",
            "#include <QtDeclarative/qdeclarative.h>",
            "#include <QtDeclarative/QDeclarativeEngine>",
            "#include <QtDeclarative/QDeclarativeContext>",
            "#include <QtCore/QFile>",
            "#include <QtCore/QEvent>",
            "#include <QtCore/QDebug>",
            "#include \"qdeclarativewebview_p.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nclass TrojitaQNAMDeclarativeWebViewPrivate {\npublic:\n    TrojitaQNAMDeclarativeWebViewPrivate(TrojitaQNAMDeclarativeWebView* qq)\n      : q(qq)\n      , preferredwidth(0)\n      , preferredheight(0)\n      , progress(1.0)\n      , status(TrojitaQNAMDeclarativeWebView::Null)\n      , pending(PendingNone)\n      , newWindowComponent(0)\n      , newWindowParent(0)\n      , networkAccessManager(0)\n      , rendering(true)\n    {\n    }",
            "TrojitaQNAMGraphicsWebView* view;",
            "mutable TrojitaDeclarativeWebSettings settings;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qwebsettings.h\"\n#include \"qwebpage.h\"\n#include \"qwebframe.h\"\n#include \"qwebelement.h\"\n#include <QtGui/QPen>\n#include <QtGui/QMouseEvent>\n#include <QtGui/QKeyEvent>\n#include <QtGui/QGraphicsSceneMouseEvent>\n#include <QtGui/QApplication>\n#include <QtDeclarative/qdeclarative.h>\n#include <QtDeclarative/QDeclarativeEngine>\n#include <QtDeclarative/QDeclarativeContext>\n#include <QtCore/QFile>\n#include <QtCore/QEvent>\n#include <QtCore/QDebug>\n#include \"qdeclarativewebview_p.h\"\n\nQT_BEGIN_NAMESPACE\n\nclass TrojitaQNAMDeclarativeWebViewPrivate {\npublic:\n    TrojitaQNAMDeclarativeWebViewPrivate(TrojitaQNAMDeclarativeWebView* qq)\n      : q(qq)\n      , preferredwidth(0)\n      , preferredheight(0)\n      , progress(1.0)\n      , status(TrojitaQNAMDeclarativeWebView::Null)\n      , pending(PendingNone)\n      , newWindowComponent(0)\n      , newWindowParent(0)\n      , networkAccessManager(0)\n      , rendering(true)\n    {\n    };\nTrojitaQNAMGraphicsWebView* view;\nmutable TrojitaDeclarativeWebSettings settings;\n\nTrojitaQNAMDeclarativeWebView {\n  void TrojitaQNAMDeclarativeWebView::setPage(QWebPage* page)\n  {\n      if (d->view->page() == page)\n          return;\n  \n      d->view->setPage(page);\n      updateContentsSize();\n      page->mainFrame()->setScrollBarPolicy(Qt::Horizontal, Qt::ScrollBarAlwaysOff);\n      page->mainFrame()->setScrollBarPolicy(Qt::Vertical, Qt::ScrollBarAlwaysOff);\n      connect(page->mainFrame(), SIGNAL(urlChanged(QUrl)), this, SLOT(pageUrlChanged()));\n      connect(page->mainFrame(), SIGNAL(titleChanged(QString)), this, SIGNAL(titleChanged(QString)));\n      connect(page->mainFrame(), SIGNAL(titleChanged(QString)), this, SIGNAL(iconChanged()));\n      connect(page->mainFrame(), SIGNAL(iconChanged()), this, SIGNAL(iconChanged()));\n      connect(page->mainFrame(), SIGNAL(initialLayoutCompleted()), this, SLOT(initialLayout()));\n      connect(page->mainFrame(), SIGNAL(contentsSizeChanged(QSize)), this, SIGNAL(contentsSizeChanged(QSize)));\n  \n      connect(page, SIGNAL(loadStarted()), this, SLOT(doLoadStarted()));\n      connect(page, SIGNAL(loadProgress(int)), this, SLOT(doLoadProgress(int)));\n      connect(page, SIGNAL(loadFinished(bool)), this, SLOT(doLoadFinished(bool)));\n      connect(page, SIGNAL(statusBarMessage(QString)), this, SLOT(setStatusText(QString)));\n  \n      connect(page->mainFrame(), SIGNAL(javaScriptWindowObjectCleared()), this, SLOT(windowObjectCleared()));\n  \n      page->settings()->setAttribute(QWebSettings::TiledBackingStoreEnabled, true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ALL_LATER_NOARG(",
          "args": [
            "mptyView,",
            "andlePageLoadFinished)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mptyView->setFixedSize",
          "args": [
            "50,",
            "00)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "etAccess,",
            "IGNAL(requestingExternal(QUrl)),",
            "his,",
            "LOT(externalsRequested(QUrl)))"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "xternalsRequested(QUrl))"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xternalsRequested(",
          "args": [
            "Url)"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "externalsRequested(c",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "424-428",
          "snippet": "id MessageView::externalsRequested(const QUrl &url)\n{\n    Q_UNUSED(url);\n    externalElements->show();\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::externalsRequested(const QUrl &url)\n  {\n      Q_UNUSED(url);\n      externalElements->show();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "equestingExternal(QUrl))"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "equestingExternal(",
          "args": [
            "Url)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etFocusPolicy(",
          "args": [
            "t::StrongFocus)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etAutoFillBackground(",
          "args": [
            "rue)"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etPalette(",
          "args": [
            "al)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.setColor",
          "args": [
            "oregroundRole(),",
            "alette().color(QPalette::Active, QPalette::Text))"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "Palette::Active,",
            "Palette::Text)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oregroundRole(",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.setColor",
          "args": [
            "ackgroundRole(),",
            "alette().color(QPalette::Active, QPalette::Base))"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "Palette::Active,",
            "Palette::Base)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ackgroundRole(",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nessageView {\n  essageView::MessageView(QWidget *parent, QSettings *settings): QWidget(parent), m_settings(settings)\n  {\n      QPalette pal = palette();\n      pal.setColor(backgroundRole(), palette().color(QPalette::Active, QPalette::Base));\n      pal.setColor(foregroundRole(), palette().color(QPalette::Active, QPalette::Text));\n      setPalette(pal);\n      setAutoFillBackground(true);\n      setFocusPolicy(Qt::StrongFocus); // not by the wheel\n      netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n      connect(netAccess, SIGNAL(requestingExternal(QUrl)), this, SLOT(externalsRequested(QUrl)));\n      factory = new PartWidgetFactory(netAccess, this);\n  \n      emptyView = new EmbeddedWebView(this, new QNetworkAccessManager(this));\n      emptyView->setFixedSize(450,300);\n      CALL_LATER_NOARG(emptyView, handlePageLoadFinished);\n      emptyView->setPage(new UserAgentWebPage(emptyView));\n      emptyView->installEventFilter(this);\n      emptyView->setAutoFillBackground(false);\n  \n      viewer = emptyView;\n  \n      //BEGIN create header section\n  \n      headerSection = new QWidget(this);\n  \n      // we create a dummy header, pass it through the style and the use it's color roles so we\n      // know what headers in general look like in the system\n      QHeaderView helpingHeader(Qt::Horizontal);\n      helpingHeader.ensurePolished();\n      pal = headerSection->palette();\n      pal.setColor(headerSection->backgroundRole(), palette().color(QPalette::Active, helpingHeader.backgroundRole()));\n      pal.setColor(headerSection->foregroundRole(), palette().color(QPalette::Active, helpingHeader.foregroundRole()));\n      headerSection->setPalette(pal);\n      headerSection->setAutoFillBackground(true);\n  \n      // the actual mail header\n      m_envelope = new EnvelopeView(headerSection, this);\n  \n      // the tag bar\n      tags = new TagListWidget(headerSection);\n      tags->setBackgroundRole(helpingHeader.backgroundRole());\n      tags->setForegroundRole(helpingHeader.foregroundRole());\n      tags->hide();\n      connect(tags, SIGNAL(tagAdded(QString)), this, SLOT(newLabelAction(QString)));\n      connect(tags, SIGNAL(tagRemoved(QString)), this, SLOT(deleteLabelAction(QString)));\n  \n      // whether we allow to load external elements\n      externalElements = new ExternalElementsWidget(this);\n      externalElements->hide();\n      connect(externalElements, SIGNAL(loadingEnabled()), this, SLOT(externalsEnabled()));\n  \n      // layout the header\n      layout = new QVBoxLayout(headerSection);\n      layout->addWidget(m_envelope, 1);\n      layout->addWidget(tags, 3);\n      layout->addWidget(externalElements, 1);\n  \n      //END create header section\n  \n      //BEGIN layout the message\n  \n      layout = new QVBoxLayout(this);\n      layout->setSpacing(0);\n      layout->setContentsMargins(0,0,0,0);\n  \n      layout->addWidget(headerSection, 1);\n  \n      headerSection->hide();\n  \n      // put the actual messages into an extra horizontal view\n      // this allows us easy usage of the trailing stretch and also to indent the message a bit\n      QHBoxLayout *hLayout = new QHBoxLayout;\n      hLayout->setContentsMargins(6,6,6,0);\n      hLayout->addWidget(viewer);\n      static_cast<QVBoxLayout*>(layout)->addLayout(hLayout, 1);\n      // add a strong stretch to squeeze header and message to the top\n      // possibly passing a large stretch factor to the message could be enough...\n      layout->addStretch(1000);\n  \n      //END layout the message\n  \n      // make the layout used to add messages our new horizontal layout\n      layout = hLayout;\n  \n      markAsReadTimer = new QTimer(this);\n      markAsReadTimer->setSingleShot(true);\n      connect(markAsReadTimer, SIGNAL(timeout()), this, SLOT(markAsRead()));\n  \n      m_loadingSpinner = new Spinner(this);\n      m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n      m_loadingSpinner->setType(Spinner::Sun);\n  }\n}"
  }
]