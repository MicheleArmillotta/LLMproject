[
  {
    "function_name": "taskData(",
    "container": "fflineConnectionTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/OfflineConnectionTask.cpp",
    "lines": "70-74",
    "snippet": "Variant OfflineConnectionTask::taskData(const int role) const\n{\n    Q_UNUSED(role);\n    return QVariant();\n}",
    "includes": [
      "include \"Streams/FakeSocket.h\"",
      "include \"Imap/Model/TaskPresentationModel.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/ConnectionId.h\"\n#",
      "include <QTimer>\n#",
      "include \"OfflineConnectionTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Variant(",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "ole)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Streams/FakeSocket.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/ConnectionId.h\"\n#\ninclude <QTimer>\n#\ninclude \"OfflineConnectionTask.h\"\n#\n\nfflineConnectionTask {\n  Variant OfflineConnectionTask::taskData(const int role) const\n  {\n      Q_UNUSED(role);\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "slotDie(",
    "container": "fflineConnectionTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/OfflineConnectionTask.cpp",
    "lines": "60-67",
    "snippet": "oid OfflineConnectionTask::slotDie()\n{\n    die(tr(\"Offline\"));\n    deleteLater();\n    model->killParser(parser, Model::PARSER_KILL_EXPECTED);\n    model->m_parsers.remove(parser);\n    model->m_taskModel->slotParserDeleted(parser);\n}",
    "includes": [
      "include \"Streams/FakeSocket.h\"",
      "include \"Imap/Model/TaskPresentationModel.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/ConnectionId.h\"\n#",
      "include <QTimer>\n#",
      "include \"OfflineConnectionTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "odel->m_taskModel->slotParserDeleted",
          "args": [
            "arser)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->m_parsers.remove",
          "args": [
            "arser)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->killParser",
          "args": [
            "arser,",
            "odel::PARSER_KILL_EXPECTED)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ie(",
          "args": [
            "r(\"Offline\"))"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "die(",
          "container": "eepMailboxOpenTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/KeepMailboxOpenTask.cpp",
          "lines": "619-630",
          "snippet": "oid KeepMailboxOpenTask::die(const QString &message)\n{\n    if (shouldExit) {\n        // OK, we're done, and getting killed. This is fine; just don't emit failed()\n        // because we aren't actually failing.\n        // This is a speciality of the KeepMailboxOpenTask because it's the only task\n        // this has a very long life.\n        _finished = true;\n    }\n    ImapTask::die(message);\n    detachFromMailbox();\n}",
          "includes": [
            "include \"UnSelectTask.h\"",
            "include \"NoopTask.h\"\n#",
            "include \"SortTask.h\"\n#",
            "include \"OfflineConnectionTask.h\"\n#",
            "include \"ObtainSynchronizedMailboxTask.h\"\n#",
            "include \"OpenConnectionTask.h\"\n#",
            "include \"IdleLauncher.h\"\n#",
            "include \"FetchMsgPartTask.h\"\n#",
            "include \"FetchMsgMetadataTask.h\"\n#",
            "include \"DeleteMailboxTask.h\"\n#",
            "include \"Imap/Model/TaskFactory.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"KeepMailboxOpenTask.h\"\n#",
            "include <sstream>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"UnSelectTask.h\"\ninclude \"NoopTask.h\"\n#\ninclude \"SortTask.h\"\n#\ninclude \"OfflineConnectionTask.h\"\n#\ninclude \"ObtainSynchronizedMailboxTask.h\"\n#\ninclude \"OpenConnectionTask.h\"\n#\ninclude \"IdleLauncher.h\"\n#\ninclude \"FetchMsgPartTask.h\"\n#\ninclude \"FetchMsgMetadataTask.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\ninclude \"Imap/Model/TaskFactory.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"KeepMailboxOpenTask.h\"\n#\ninclude <sstream>\n#\n\neepMailboxOpenTask {\n  oid KeepMailboxOpenTask::die(const QString &message)\n  {\n      if (shouldExit) {\n          // OK, we're done, and getting killed. This is fine; just don't emit failed()\n          // because we aren't actually failing.\n          // This is a speciality of the KeepMailboxOpenTask because it's the only task\n          // this has a very long life.\n          _finished = true;\n      }\n      ImapTask::die(message);\n      detachFromMailbox();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Offline\")"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "handleStateHelper(",
          "container": "xpungeMessagesTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ExpungeMessagesTask.cpp",
          "lines": "86-101",
          "snippet": "ool ExpungeMessagesTask::handleStateHelper(const Imap::Responses::State *const resp)\n{\n    if (resp->tag.isEmpty())\n        return false;\n\n    if (resp->tag == tag) {\n        if (resp->kind == Responses::OK) {\n            _completed();\n        } else {\n            _failed(\"UID EXPUNGE failed\");\n        }\n        return true;\n    } else {\n        return false;\n    }\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"ExpungeMessagesTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"ExpungeMessagesTask.h\"\n#\n\nxpungeMessagesTask {\n  ool ExpungeMessagesTask::handleStateHelper(const Imap::Responses::State *const resp)\n  {\n      if (resp->tag.isEmpty())\n          return false;\n  \n      if (resp->tag == tag) {\n          if (resp->kind == Responses::OK) {\n              _completed();\n          } else {\n              _failed(\"UID EXPUNGE failed\");\n          }\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Streams/FakeSocket.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/ConnectionId.h\"\n#\ninclude <QTimer>\n#\ninclude \"OfflineConnectionTask.h\"\n#\n\nfflineConnectionTask {\n  oid OfflineConnectionTask::slotDie()\n  {\n      die(tr(\"Offline\"));\n      deleteLater();\n      model->killParser(parser, Model::PARSER_KILL_EXPECTED);\n      model->m_parsers.remove(parser);\n      model->m_taskModel->slotParserDeleted(parser);\n  }\n}"
  },
  {
    "function_name": "perform(",
    "container": "fflineConnectionTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/OfflineConnectionTask.cpp",
    "lines": "52-57",
    "snippet": "oid OfflineConnectionTask::perform()\n{\n    model->runReadyTasks();\n    _failed(\"We're offline\");\n    QTimer::singleShot(0, this, SLOT(slotDie()));\n}",
    "includes": [
      "include \"Streams/FakeSocket.h\"",
      "include \"Imap/Model/TaskPresentationModel.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/ConnectionId.h\"\n#",
      "include <QTimer>\n#",
      "include \"OfflineConnectionTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Timer::singleShot(",
          "args": [
            ",",
            "his,",
            "LOT(slotDie()))"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotDie())"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotDie(",
          "args": [],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "slotDie(",
          "container": "fflineConnectionTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/OfflineConnectionTask.cpp",
          "lines": "60-67",
          "snippet": "oid OfflineConnectionTask::slotDie()\n{\n    die(tr(\"Offline\"));\n    deleteLater();\n    model->killParser(parser, Model::PARSER_KILL_EXPECTED);\n    model->m_parsers.remove(parser);\n    model->m_taskModel->slotParserDeleted(parser);\n}",
          "includes": [
            "include \"Streams/FakeSocket.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Common/ConnectionId.h\"\n#",
            "include <QTimer>\n#",
            "include \"OfflineConnectionTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Streams/FakeSocket.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/ConnectionId.h\"\n#\ninclude <QTimer>\n#\ninclude \"OfflineConnectionTask.h\"\n#\n\nfflineConnectionTask {\n  oid OfflineConnectionTask::slotDie()\n  {\n      die(tr(\"Offline\"));\n      deleteLater();\n      model->killParser(parser, Model::PARSER_KILL_EXPECTED);\n      model->m_parsers.remove(parser);\n      model->m_taskModel->slotParserDeleted(parser);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "failed(",
          "args": [
            "We're offline\")"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "_failed(",
          "container": "hreadTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ThreadTask.cpp",
          "lines": "112-117",
          "snippet": "oid ThreadTask::_failed(const QString &errorMessage)\n{\n    // FIXME: show this in the GUI\n    emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n    ImapTask::_failed(errorMessage);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"ThreadTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"ThreadTask.h\"\n#\n\nhreadTask {\n  oid ThreadTask::_failed(const QString &errorMessage)\n  {\n      // FIXME: show this in the GUI\n      emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n      ImapTask::_failed(errorMessage);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "odel->runReadyTasks",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Streams/FakeSocket.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/ConnectionId.h\"\n#\ninclude <QTimer>\n#\ninclude \"OfflineConnectionTask.h\"\n#\n\nfflineConnectionTask {\n  oid OfflineConnectionTask::perform()\n  {\n      model->runReadyTasks();\n      _failed(\"We're offline\");\n      QTimer::singleShot(0, this, SLOT(slotDie()));\n  }\n}"
  },
  {
    "function_name": "slotPerform(",
    "container": "fflineConnectionTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/OfflineConnectionTask.cpp",
    "lines": "47-50",
    "snippet": "oid OfflineConnectionTask::slotPerform()\n{\n    perform();\n}",
    "includes": [
      "include \"Streams/FakeSocket.h\"",
      "include \"Imap/Model/TaskPresentationModel.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/ConnectionId.h\"\n#",
      "include <QTimer>\n#",
      "include \"OfflineConnectionTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "erform(",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "perform(",
          "container": "fflineConnectionTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/OfflineConnectionTask.cpp",
          "lines": "52-57",
          "snippet": "oid OfflineConnectionTask::perform()\n{\n    model->runReadyTasks();\n    _failed(\"We're offline\");\n    QTimer::singleShot(0, this, SLOT(slotDie()));\n}",
          "includes": [
            "include \"Streams/FakeSocket.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Common/ConnectionId.h\"\n#",
            "include <QTimer>\n#",
            "include \"OfflineConnectionTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Streams/FakeSocket.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/ConnectionId.h\"\n#\ninclude <QTimer>\n#\ninclude \"OfflineConnectionTask.h\"\n#\n\nfflineConnectionTask {\n  oid OfflineConnectionTask::perform()\n  {\n      model->runReadyTasks();\n      _failed(\"We're offline\");\n      QTimer::singleShot(0, this, SLOT(slotDie()));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Streams/FakeSocket.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/ConnectionId.h\"\n#\ninclude <QTimer>\n#\ninclude \"OfflineConnectionTask.h\"\n#\n\nfflineConnectionTask {\n  oid OfflineConnectionTask::slotPerform()\n  {\n      perform();\n  }\n}"
  },
  {
    "function_name": "OfflineConnectionTask(",
    "container": "fflineConnectionTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/OfflineConnectionTask.cpp",
    "lines": "35-44",
    "snippet": "fflineConnectionTask::OfflineConnectionTask(Model *model) : ImapTask(model)\n{\n    parser = new Parser(model, new Streams::FakeSocket(CONN_STATE_CONNECTED_PRETLS_PRECAPS), Common::ConnectionId::next());\n    ParserState parserState(parser);\n    parserState.connState = CONN_STATE_LOGOUT;\n    model->m_parsers[parser] = parserState;\n    model->m_taskModel->slotParserCreated(parser);\n    markAsActiveTask();\n    QTimer::singleShot(0, this, SLOT(slotPerform()));\n}",
    "includes": [
      "include \"Streams/FakeSocket.h\"",
      "include \"Imap/Model/TaskPresentationModel.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/ConnectionId.h\"\n#",
      "include <QTimer>\n#",
      "include \"OfflineConnectionTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Timer::singleShot(",
          "args": [
            ",",
            "his,",
            "LOT(slotPerform()))"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotPerform())"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotPerform(",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "slotPerform(",
          "container": "fflineConnectionTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/OfflineConnectionTask.cpp",
          "lines": "47-50",
          "snippet": "oid OfflineConnectionTask::slotPerform()\n{\n    perform();\n}",
          "includes": [
            "include \"Streams/FakeSocket.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Common/ConnectionId.h\"\n#",
            "include <QTimer>\n#",
            "include \"OfflineConnectionTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Streams/FakeSocket.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/ConnectionId.h\"\n#\ninclude <QTimer>\n#\ninclude \"OfflineConnectionTask.h\"\n#\n\nfflineConnectionTask {\n  oid OfflineConnectionTask::slotPerform()\n  {\n      perform();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arkAsActiveTask(",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->m_taskModel->slotParserCreated",
          "args": [
            "arser)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ommon::ConnectionId::next(",
          "args": [],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "next(",
          "container": "ommon::ConnectionId",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/ConnectionId.cpp",
          "lines": "26-26",
          "snippet": "nsigned int Common::ConnectionId::next() { return ++s_id; }",
          "includes": [
            "include \"ConnectionId.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "nsigned int Common::ConnectionId::s_id = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "include \"ConnectionId.h\"\n\nnsigned int Common::ConnectionId::s_id = 0;\n\nommon {\n  ConnectionId {\n    nsigned int Common::ConnectionId::next() { return ++s_id; }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Streams/FakeSocket.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/ConnectionId.h\"\n#\ninclude <QTimer>\n#\ninclude \"OfflineConnectionTask.h\"\n#\n\nfflineConnectionTask {\n  fflineConnectionTask::OfflineConnectionTask(Model *model) : ImapTask(model)\n  {\n      parser = new Parser(model, new Streams::FakeSocket(CONN_STATE_CONNECTED_PRETLS_PRECAPS), Common::ConnectionId::next());\n      ParserState parserState(parser);\n      parserState.connState = CONN_STATE_LOGOUT;\n      model->m_parsers[parser] = parserState;\n      model->m_taskModel->slotParserCreated(parser);\n      markAsActiveTask();\n      QTimer::singleShot(0, this, SLOT(slotPerform()));\n  }\n}"
  }
]