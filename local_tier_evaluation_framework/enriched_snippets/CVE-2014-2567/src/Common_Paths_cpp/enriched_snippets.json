[
  {
    "function_name": "itablePath(c",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/Paths.cpp",
    "lines": "40-90",
    "snippet": "tring writablePath(const LocationType location)\n{\n    static QMap<LocationType, QString> map;\n\n    if (map.isEmpty()) {\n\n        const QString &origApplicationName = QCoreApplication::applicationName();\n        const QString &origOrganizationDomain = QCoreApplication::organizationDomain();\n        const QString &origOrganizationName = QCoreApplication::organizationName();\n\n        QCoreApplication::setApplicationName(Common::Application::name);\n        QCoreApplication::setOrganizationDomain(Common::Application::organization);\n        QCoreApplication::setOrganizationName(Common::Application::organization);\n\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n        map[LOCATION_CACHE] = QStandardPaths::writableLocation(QStandardPaths::CacheLocation);\n        map[LOCATION_DATA] = QStandardPaths::writableLocation(QStandardPaths::DataLocation);\n        map[LOCATION_DOWNLOAD] = QStandardPaths::writableLocation(QStandardPaths::DownloadLocation);\n#else\n        map[LOCATION_CACHE] = QDesktopServices::storageLocation(QDesktopServices::CacheLocation);\n        map[LOCATION_DATA] = QDesktopServices::storageLocation(QDesktopServices::DataLocation);\n        map[LOCATION_DOWNLOAD] = QDesktopServices::storageLocation(QDesktopServices::DocumentsLocation);\n#endif\n\n        if (map[LOCATION_CACHE].isEmpty())\n            map[LOCATION_CACHE] = QDir::homePath() + QLatin1String(\"/.cache\");\n\n        if (map[LOCATION_DATA].isEmpty())\n            map[LOCATION_DATA] = QDir::homePath() + QLatin1String(\"/.data\");\n\n        if (map[LOCATION_DOWNLOAD].isEmpty())\n            map[LOCATION_DOWNLOAD] = QDir::homePath();\n\n\n        for (QMap<LocationType, QString>::iterator it = map.begin(); it != map.end(); ++it) {\n            if (!it->endsWith(QLatin1Char('/')))\n                *it += QLatin1Char('/');\n        }\n\n        QString profileName = QString::fromUtf8(qgetenv(\"TROJITA_PROFILE\"));\n        if (!profileName.isEmpty())\n            map[LOCATION_CACHE] += profileName + QLatin1Char('/');\n\n        QCoreApplication::setApplicationName(origApplicationName);\n        QCoreApplication::setOrganizationDomain(origOrganizationDomain);\n        QCoreApplication::setOrganizationName(origOrganizationName);\n\n    }\n\n    return map[location];\n}",
    "includes": [
      "nclude \"Paths.h\"\n\nn",
      "nclude \"Application.h\"\n#i",
      "nclude <QDesktopServices>\n#e",
      "nclude <QStandardPaths>\n#e",
      "nclude <QMap>\n\n#",
      "nclude <QDir>\n#i",
      "nclude <QCoreApplication>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "oreApplication::setOrganizationName(o",
          "args": [
            "igOrganizationName);"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oreApplication::setOrganizationDomain(o",
          "args": [
            "igOrganizationDomain);"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oreApplication::setApplicationName(o",
          "args": [
            "igApplicationName);"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atin1Char('",
          "args": [
            "');"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ofileName.isEmpty",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tring::fromUtf8(q",
          "args": [
            "etenv(\"TROJITA_PROFILE\"));"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etenv(\"",
          "args": [
            "ROJITA_PROFILE\"))"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atin1Char('",
          "args": [
            "');"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->endsWith",
          "args": [
            "atin1Char('/')))"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atin1Char('",
          "args": [
            "'))"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p.end",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p.begin",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ir::homePath()",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p[LOCATION_DOWNLOAD].isEmpty",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atin1String(\"",
          "args": [
            ".data\");"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ir::homePath()",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p[LOCATION_DATA].isEmpty",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atin1String(\"",
          "args": [
            ".cache\");"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ir::homePath()",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p[LOCATION_CACHE].isEmpty",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esktopServices::storageLocation(Q",
          "args": [
            "esktopServices::DocumentsLocation);"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esktopServices::storageLocation(Q",
          "args": [
            "esktopServices::DataLocation);"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esktopServices::storageLocation(Q",
          "args": [
            "esktopServices::CacheLocation);"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tandardPaths::writableLocation(Q",
          "args": [
            "tandardPaths::DownloadLocation);"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tandardPaths::writableLocation(Q",
          "args": [
            "tandardPaths::DataLocation);"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tandardPaths::writableLocation(Q",
          "args": [
            "tandardPaths::CacheLocation);"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_VERSION_CHECK(5",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oreApplication::setOrganizationName(C",
          "args": [
            "mmon::Application::organization);"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oreApplication::setOrganizationDomain(C",
          "args": [
            "mmon::Application::organization);"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oreApplication::setApplicationName(C",
          "args": [
            "mmon::Application::name);"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oreApplication::organizationName()",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oreApplication::organizationDomain()",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oreApplication::applicationName()",
          "args": [],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p.isEmpty",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"Paths.h\"\n\nn\nnclude \"Application.h\"\n#i\nnclude <QDesktopServices>\n#e\nnclude <QStandardPaths>\n#e\nnclude <QMap>\n\n#\nnclude <QDir>\n#i\nnclude <QCoreApplication>\n#i\n\ntring writablePath(const LocationType location)\n{\n    static QMap<LocationType, QString> map;\n\n    if (map.isEmpty()) {\n\n        const QString &origApplicationName = QCoreApplication::applicationName();\n        const QString &origOrganizationDomain = QCoreApplication::organizationDomain();\n        const QString &origOrganizationName = QCoreApplication::organizationName();\n\n        QCoreApplication::setApplicationName(Common::Application::name);\n        QCoreApplication::setOrganizationDomain(Common::Application::organization);\n        QCoreApplication::setOrganizationName(Common::Application::organization);\n\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n        map[LOCATION_CACHE] = QStandardPaths::writableLocation(QStandardPaths::CacheLocation);\n        map[LOCATION_DATA] = QStandardPaths::writableLocation(QStandardPaths::DataLocation);\n        map[LOCATION_DOWNLOAD] = QStandardPaths::writableLocation(QStandardPaths::DownloadLocation);\n#else\n        map[LOCATION_CACHE] = QDesktopServices::storageLocation(QDesktopServices::CacheLocation);\n        map[LOCATION_DATA] = QDesktopServices::storageLocation(QDesktopServices::DataLocation);\n        map[LOCATION_DOWNLOAD] = QDesktopServices::storageLocation(QDesktopServices::DocumentsLocation);\n#endif\n\n        if (map[LOCATION_CACHE].isEmpty())\n            map[LOCATION_CACHE] = QDir::homePath() + QLatin1String(\"/.cache\");\n\n        if (map[LOCATION_DATA].isEmpty())\n            map[LOCATION_DATA] = QDir::homePath() + QLatin1String(\"/.data\");\n\n        if (map[LOCATION_DOWNLOAD].isEmpty())\n            map[LOCATION_DOWNLOAD] = QDir::homePath();\n\n\n        for (QMap<LocationType, QString>::iterator it = map.begin(); it != map.end(); ++it) {\n            if (!it->endsWith(QLatin1Char('/')))\n                *it += QLatin1Char('/');\n        }\n\n        QString profileName = QString::fromUtf8(qgetenv(\"TROJITA_PROFILE\"));\n        if (!profileName.isEmpty())\n            map[LOCATION_CACHE] += profileName + QLatin1Char('/');\n\n        QCoreApplication::setApplicationName(origApplicationName);\n        QCoreApplication::setOrganizationDomain(origOrganizationDomain);\n        QCoreApplication::setOrganizationName(origOrganizationName);\n\n    }\n\n    return map[location];\n}"
  }
]