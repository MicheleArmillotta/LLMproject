[
  {
    "function_name": "onMsaProgressMaxChanged(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "422-425",
    "snippet": "oid Submission::onMsaProgressMaxChanged(const int max)\n{\n    m_msaMaximalProgress = max;\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::onMsaProgressMaxChanged(const int max)\n  {\n      m_msaMaximalProgress = max;\n  }\n}"
  },
  {
    "function_name": "onMsaProgressCurrentChanged(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "412-420",
    "snippet": "oid Submission::onMsaProgressCurrentChanged(const int value)\n{\n    if (m_msaMaximalProgress > 0) {\n        // prevent division by zero or performing operations which do not make any sense\n        int low = m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING;\n        int high = PROGRESS_DELIVERY_DONE;\n        emit progress(1.0 * value / m_msaMaximalProgress * (high - low) + low);\n    }\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::onMsaProgressCurrentChanged(const int value)\n  {\n      if (m_msaMaximalProgress > 0) {\n          // prevent division by zero or performing operations which do not make any sense\n          int low = m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING;\n          int high = PROGRESS_DELIVERY_DONE;\n          emit progress(1.0 * value / m_msaMaximalProgress * (high - low) + low);\n      }\n  }\n}"
  },
  {
    "function_name": "onUpdatingFlagsOfReplyingToFailed(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "403-410",
    "snippet": "oid Submission::onUpdatingFlagsOfReplyingToFailed()\n{\n    m_updateReplyingToMessageFlagsTask = 0;\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                      QLatin1String(\"Cannot update flags of the message we replied to -- interesting, but we cannot do anything at this point anyway\"));\n    changeConnectionState(STATE_SENT);\n    emit succeeded();\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hangeConnectionState(",
          "args": [
            "TATE_SENT)"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "changeConnectionState(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "92-144",
          "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Submission\"),",
            "Latin1String(\"Cannot update flags of the message we replied to -- interesting, but we cannot do anything at this point anyway\"))"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Cannot update flags of the message we replied to -- interesting, but we cannot do anything at this point anyway\")"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Submission\")"
          ],
          "line": 406
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::onUpdatingFlagsOfReplyingToFailed()\n  {\n      m_updateReplyingToMessageFlagsTask = 0;\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                        QLatin1String(\"Cannot update flags of the message we replied to -- interesting, but we cannot do anything at this point anyway\"));\n      changeConnectionState(STATE_SENT);\n      emit succeeded();\n  }\n}"
  },
  {
    "function_name": "onUpdatingFlagsOfReplyingToSucceded(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "396-401",
    "snippet": "oid Submission::onUpdatingFlagsOfReplyingToSucceded()\n{\n    m_updateReplyingToMessageFlagsTask = 0;\n    changeConnectionState(STATE_SENT);\n    emit succeeded();\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hangeConnectionState(",
          "args": [
            "TATE_SENT)"
          ],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "changeConnectionState(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "92-144",
          "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::onUpdatingFlagsOfReplyingToSucceded()\n  {\n      m_updateReplyingToMessageFlagsTask = 0;\n      changeConnectionState(STATE_SENT);\n      emit succeeded();\n  }\n}"
  },
  {
    "function_name": "shouldBuildMessageLocally(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "385-394",
    "snippet": "ool Submission::shouldBuildMessageLocally() const\n{\n    if (!m_useImapSubmit) {\n        // sending via SMTP or Sendmail\n        // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n        return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n    } else {\n        return ! m_model->isCatenateSupported();\n    }\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_model->isCatenateSupported",
          "args": [],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->isGenUrlAuthSupported",
          "args": [],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->isCatenateSupported",
          "args": [],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  ool Submission::shouldBuildMessageLocally() const\n  {\n      if (!m_useImapSubmit) {\n          // sending via SMTP or Sendmail\n          // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n          return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n      } else {\n          return ! m_model->isCatenateSupported();\n      }\n  }\n}"
  },
  {
    "function_name": "killDomainPartFromString(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "379-382",
    "snippet": "String Submission::killDomainPartFromString(const QString &s)\n{\n    return s.split(QLatin1Char('@'))[0];\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": ".split",
          "args": [
            "Latin1Char('@'))"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "@')"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  String Submission::killDomainPartFromString(const QString &s)\n  {\n      return s.split(QLatin1Char('@'))[0];\n  }\n}"
  },
  {
    "function_name": "slotGenUrlAuthReceived(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "367-376",
    "snippet": "oid Submission::slotGenUrlAuthReceived(const QString &url)\n{\n    m_urlauth = url;\n    if (!m_urlauth.isEmpty()) {\n        m_genUrlAuthReceived = true;\n        slotInvokeMsaNow();\n    } else {\n        gotError(tr(\"The URLAUTH response does not contain a proper URL\"));\n    }\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "otError(",
          "args": [
            "r(\"The URLAUTH response does not contain a proper URL\"))"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "297-303",
          "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lotInvokeMsaNow(",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "slotInvokeMsaNow(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "261-285",
          "snippet": "oid Submission::slotInvokeMsaNow()\n{\n    changeConnectionState(STATE_SUBMITTING);\n    MSA::AbstractMSA *msa = m_msaFactory->create(this);\n    connect(msa, SIGNAL(progressMax(int)), this, SLOT(onMsaProgressMaxChanged(int)));\n    connect(msa, SIGNAL(progress(int)), this, SLOT(onMsaProgressCurrentChanged(int)));\n    connect(msa, SIGNAL(sent()), this, SLOT(sent()));\n    connect(msa, SIGNAL(error(QString)), this, SLOT(gotError(QString)));\n    connect(msa, SIGNAL(passwordRequested(QString,QString)), this, SIGNAL(passwordRequested(QString,QString)));\n    connect(this, SIGNAL(gotPassword(QString)), msa, SLOT(setPassword(QString)));\n    connect(this, SIGNAL(canceled()), msa, SLOT(cancel()));\n\n    if (m_useImapSubmit && msa->supportsImapSending() && m_appendUidReceived) {\n        Imap::Mailbox::UidSubmitOptionsList options;\n        options.append(qMakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()));\n        Q_FOREACH(const QByteArray &recipient, m_composer->rawRecipientAddresses()) {\n            options.append(qMakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient));\n        }\n        msa->sendImap(m_sentFolderName, m_appendUidValidity, m_appendUid, options);\n    } else if (m_genUrlAuthReceived && m_useBurl) {\n        msa->sendBurl(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_urlauth.toUtf8());\n    } else {\n        msa->sendMail(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_rawMessageData);\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotInvokeMsaNow()\n  {\n      changeConnectionState(STATE_SUBMITTING);\n      MSA::AbstractMSA *msa = m_msaFactory->create(this);\n      connect(msa, SIGNAL(progressMax(int)), this, SLOT(onMsaProgressMaxChanged(int)));\n      connect(msa, SIGNAL(progress(int)), this, SLOT(onMsaProgressCurrentChanged(int)));\n      connect(msa, SIGNAL(sent()), this, SLOT(sent()));\n      connect(msa, SIGNAL(error(QString)), this, SLOT(gotError(QString)));\n      connect(msa, SIGNAL(passwordRequested(QString,QString)), this, SIGNAL(passwordRequested(QString,QString)));\n      connect(this, SIGNAL(gotPassword(QString)), msa, SLOT(setPassword(QString)));\n      connect(this, SIGNAL(canceled()), msa, SLOT(cancel()));\n  \n      if (m_useImapSubmit && msa->supportsImapSending() && m_appendUidReceived) {\n          Imap::Mailbox::UidSubmitOptionsList options;\n          options.append(qMakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()));\n          Q_FOREACH(const QByteArray &recipient, m_composer->rawRecipientAddresses()) {\n              options.append(qMakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient));\n          }\n          msa->sendImap(m_sentFolderName, m_appendUidValidity, m_appendUid, options);\n      } else if (m_genUrlAuthReceived && m_useBurl) {\n          msa->sendBurl(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_urlauth.toUtf8());\n      } else {\n          msa->sendMail(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_rawMessageData);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_urlauth.isEmpty",
          "args": [],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotGenUrlAuthReceived(const QString &url)\n  {\n      m_urlauth = url;\n      if (!m_urlauth.isEmpty()) {\n          m_genUrlAuthReceived = true;\n          slotInvokeMsaNow();\n      } else {\n          gotError(tr(\"The URLAUTH response does not contain a proper URL\"));\n      }\n  }\n}"
  },
  {
    "function_name": "slotAppendSucceeded(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "347-364",
    "snippet": "oid Submission::slotAppendSucceeded()\n{\n    if (m_appendUid && m_appendUidValidity) {\n        // Only ever consider valid UIDVALIDITY/UID pair\n        m_appendUidReceived = true;\n\n        if (m_useBurl) {\n            slotAskForUrl();\n        } else {\n            slotInvokeMsaNow();\n        }\n    } else {\n        m_useBurl = false;\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                          QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n        slotInvokeMsaNow();\n    }\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lotInvokeMsaNow(",
          "args": [],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "slotInvokeMsaNow(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "261-285",
          "snippet": "oid Submission::slotInvokeMsaNow()\n{\n    changeConnectionState(STATE_SUBMITTING);\n    MSA::AbstractMSA *msa = m_msaFactory->create(this);\n    connect(msa, SIGNAL(progressMax(int)), this, SLOT(onMsaProgressMaxChanged(int)));\n    connect(msa, SIGNAL(progress(int)), this, SLOT(onMsaProgressCurrentChanged(int)));\n    connect(msa, SIGNAL(sent()), this, SLOT(sent()));\n    connect(msa, SIGNAL(error(QString)), this, SLOT(gotError(QString)));\n    connect(msa, SIGNAL(passwordRequested(QString,QString)), this, SIGNAL(passwordRequested(QString,QString)));\n    connect(this, SIGNAL(gotPassword(QString)), msa, SLOT(setPassword(QString)));\n    connect(this, SIGNAL(canceled()), msa, SLOT(cancel()));\n\n    if (m_useImapSubmit && msa->supportsImapSending() && m_appendUidReceived) {\n        Imap::Mailbox::UidSubmitOptionsList options;\n        options.append(qMakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()));\n        Q_FOREACH(const QByteArray &recipient, m_composer->rawRecipientAddresses()) {\n            options.append(qMakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient));\n        }\n        msa->sendImap(m_sentFolderName, m_appendUidValidity, m_appendUid, options);\n    } else if (m_genUrlAuthReceived && m_useBurl) {\n        msa->sendBurl(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_urlauth.toUtf8());\n    } else {\n        msa->sendMail(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_rawMessageData);\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotInvokeMsaNow()\n  {\n      changeConnectionState(STATE_SUBMITTING);\n      MSA::AbstractMSA *msa = m_msaFactory->create(this);\n      connect(msa, SIGNAL(progressMax(int)), this, SLOT(onMsaProgressMaxChanged(int)));\n      connect(msa, SIGNAL(progress(int)), this, SLOT(onMsaProgressCurrentChanged(int)));\n      connect(msa, SIGNAL(sent()), this, SLOT(sent()));\n      connect(msa, SIGNAL(error(QString)), this, SLOT(gotError(QString)));\n      connect(msa, SIGNAL(passwordRequested(QString,QString)), this, SIGNAL(passwordRequested(QString,QString)));\n      connect(this, SIGNAL(gotPassword(QString)), msa, SLOT(setPassword(QString)));\n      connect(this, SIGNAL(canceled()), msa, SLOT(cancel()));\n  \n      if (m_useImapSubmit && msa->supportsImapSending() && m_appendUidReceived) {\n          Imap::Mailbox::UidSubmitOptionsList options;\n          options.append(qMakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()));\n          Q_FOREACH(const QByteArray &recipient, m_composer->rawRecipientAddresses()) {\n              options.append(qMakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient));\n          }\n          msa->sendImap(m_sentFolderName, m_appendUidValidity, m_appendUid, options);\n      } else if (m_genUrlAuthReceived && m_useBurl) {\n          msa->sendBurl(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_urlauth.toUtf8());\n      } else {\n          msa->sendMail(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_rawMessageData);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Submission\"),",
            "Latin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"))"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\")"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Submission\")"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotAskForUrl(",
          "args": [],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "slotAskForUrl(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "245-259",
          "snippet": "oid Submission::slotAskForUrl()\n{\n    Q_ASSERT(m_appendUidReceived && m_useBurl);\n    changeConnectionState(STATE_PREPARING_URLAUTH);\n    Imap::Mailbox::GenUrlAuthTask *genUrlAuthTask = QPointer<Imap::Mailbox::GenUrlAuthTask>(\n                m_model->generateUrlAuthForMessage(m_imapHostname,\n                                                   killDomainPartFromString(m_imapUsername),\n                                                   m_sentFolderName,\n                                                   m_appendUidValidity, m_appendUid, QString(),\n                                                   QString::fromUtf8(\"submit+%1\").arg(\n                                                       killDomainPartFromString(m_smtpUsername))\n                                                   ));\n    connect(genUrlAuthTask, SIGNAL(gotAuth(QString)), this, SLOT(slotGenUrlAuthReceived(QString)));\n    connect(genUrlAuthTask, SIGNAL(failed(QString)), this, SLOT(gotError(QString)));\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAskForUrl()\n  {\n      Q_ASSERT(m_appendUidReceived && m_useBurl);\n      changeConnectionState(STATE_PREPARING_URLAUTH);\n      Imap::Mailbox::GenUrlAuthTask *genUrlAuthTask = QPointer<Imap::Mailbox::GenUrlAuthTask>(\n                  m_model->generateUrlAuthForMessage(m_imapHostname,\n                                                     killDomainPartFromString(m_imapUsername),\n                                                     m_sentFolderName,\n                                                     m_appendUidValidity, m_appendUid, QString(),\n                                                     QString::fromUtf8(\"submit+%1\").arg(\n                                                         killDomainPartFromString(m_smtpUsername))\n                                                     ));\n      connect(genUrlAuthTask, SIGNAL(gotAuth(QString)), this, SLOT(slotGenUrlAuthReceived(QString)));\n      connect(genUrlAuthTask, SIGNAL(failed(QString)), this, SLOT(gotError(QString)));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendSucceeded()\n  {\n      if (m_appendUid && m_appendUidValidity) {\n          // Only ever consider valid UIDVALIDITY/UID pair\n          m_appendUidReceived = true;\n  \n          if (m_useBurl) {\n              slotAskForUrl();\n          } else {\n              slotInvokeMsaNow();\n          }\n      } else {\n          m_useBurl = false;\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                            QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n          slotInvokeMsaNow();\n      }\n  }\n}"
  },
  {
    "function_name": "slotAppendFailed(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "342-345",
    "snippet": "oid Submission::slotAppendFailed(const QString &error)\n{\n    gotError(tr(\"APPEND failed: %1\").arg(error));\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "otError(",
          "args": [
            "r(\"APPEND failed: %1\").arg(error))"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "297-303",
          "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "rror)"
          ],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "onMsaProgressMaxChanged(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "422-425",
          "snippet": "oid Submission::onMsaProgressMaxChanged(const int max)\n{\n    m_msaMaximalProgress = max;\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::onMsaProgressMaxChanged(const int max)\n  {\n      m_msaMaximalProgress = max;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendFailed(const QString &error)\n  {\n      gotError(tr(\"APPEND failed: %1\").arg(error));\n  }\n}"
  },
  {
    "function_name": "slotAppendUidKnown(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "336-340",
    "snippet": "oid Submission::slotAppendUidKnown(const uint uidValidity, const uint uid)\n{\n    m_appendUidValidity = uidValidity;\n    m_appendUid = uid;\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendUidKnown(const uint uidValidity, const uint uid)\n  {\n      m_appendUidValidity = uidValidity;\n      m_appendUid = uid;\n  }\n}"
  },
  {
    "function_name": "sent(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "305-333",
    "snippet": "oid Submission::sent()\n{\n    if (m_composer->replyingToMessage().isValid()) {\n        m_updateReplyingToMessageFlagsTask = m_model->setMessageFlags(QModelIndexList() << m_composer->replyingToMessage(),\n                                                                      QLatin1String(\"\\\\Answered\"), Imap::Mailbox::FLAG_ADD);\n        connect(m_updateReplyingToMessageFlagsTask, SIGNAL(completed(Imap::Mailbox::ImapTask*)),\n                this, SLOT(onUpdatingFlagsOfReplyingToSucceded()));\n        connect(m_updateReplyingToMessageFlagsTask, SIGNAL(failed(QString)),\n                this, SLOT(onUpdatingFlagsOfReplyingToFailed()));\n        changeConnectionState(STATE_UPDATING_FLAGS);\n    } else {\n        changeConnectionState(STATE_SENT);\n        emit succeeded();\n    }\n#if 0\n    if (m_appendUidReceived) {\n        // FIXME: check the UIDVALIDITY!!!\n        // FIXME: doesn't work at all; the messageIndexByUid() only works on already selected mailboxes\n        QModelIndex message = m_mainWindow->imapModel()->\n                messageIndexByUid(QSettings().value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(), m_appendUid);\n        if (message.isValid()) {\n            m_mainWindow->imapModel()->setMessageFlags(QModelIndexList() << message,\n                                                       QLatin1String(\"\\\\Seen $Submitted\"), Imap::Mailbox::FLAG_USE_THESE);\n        }\n    }\n#endif\n\n    // FIXME: move back to the currently selected mailbox\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_mainWindow->imapModel",
          "args": [
            "ModelIndexList() << message,",
            "Latin1String(\"\\\\Seen $Submitted\"),",
            "map::Mailbox::FLAG_USE_THESE)"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "\\\\Seen $Submitted\")"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndexList(",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mainWindow->imapModel",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.isValid",
          "args": [],
          "line": 325
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_mainWindow->imapModel",
          "args": [
            "Settings().value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),",
            "_appendUid)"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Settings",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "slotShowSettings()\n{",
          "container": "ow",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1055-1074",
          "snippet": "nWindow::slotShowSettings()\n{\n    SettingsDialog *dialog = new SettingsDialog(this, m_senderIdentities, m_settings);\n    if (dialog->exec() == QDialog::Accepted) {\n        // FIXME: wipe cache in case we're moving between servers\n        nukeModels();\n        setupModels();\n        connectModelActions();\n        // The systray is still connected to the old model -- got to make sure it's getting updated\n        removeSysTray();\n        slotToggleSysTray();\n    }\n    QString method = m_settings->value(Common::SettingsNames::imapMethodKey).toString();\n    if (method != Common::SettingsNames::methodTCP && method != Common::SettingsNames::methodSSL &&\n            method != Common::SettingsNames::methodProcess ) {\n        QMessageBox::critical(this, tr(\"No Configuration\"),\n                              trUtf8(\"No IMAP account is configured. Trojit cannot do much without one.\"));\n    }\n    applySizesAndState();\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\now {\n  nWindow::slotShowSettings()\n  {\n      SettingsDialog *dialog = new SettingsDialog(this, m_senderIdentities, m_settings);\n      if (dialog->exec() == QDialog::Accepted) {\n          // FIXME: wipe cache in case we're moving between servers\n          nukeModels();\n          setupModels();\n          connectModelActions();\n          // The systray is still connected to the old model -- got to make sure it's getting updated\n          removeSysTray();\n          slotToggleSysTray();\n      }\n      QString method = m_settings->value(Common::SettingsNames::imapMethodKey).toString();\n      if (method != Common::SettingsNames::methodTCP && method != Common::SettingsNames::methodSSL &&\n              method != Common::SettingsNames::methodProcess ) {\n          QMessageBox::critical(this, tr(\"No Configuration\"),\n                                trUtf8(\"No IMAP account is configured. Trojit cannot do much without one.\"));\n      }\n      applySizesAndState();\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "Settings",
          "args": [
            "ommon::SettingsNames::composerImapSentKey,",
            "r(\"Sent\"))"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "setProxySettings(",
          "container": "akeSocketFactory",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Streams/SocketFactory.cpp",
          "lines": "123-126",
          "snippet": "oid FakeSocketFactory::setProxySettings(const ProxySettings proxySettings, const QString &protocolTag)\n{\n    throw std::invalid_argument(\"This socket factory doesn't manufacture network sockets and therefore doesn't support proxy settings\");\n}",
          "includes": [
            "include \"FakeSocket.h\"",
            "include \"IODeviceSocket.h\"\n#",
            "include <QSslSocket>\n#",
            "include <QProcess>\n#",
            "include <stdexcept>\n#",
            "include \"SocketFactory.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"FakeSocket.h\"\ninclude \"IODeviceSocket.h\"\n#\ninclude <QSslSocket>\n#\ninclude <QProcess>\n#\ninclude <stdexcept>\n#\ninclude \"SocketFactory.h\"\n#\n\nakeSocketFactory {\n  oid FakeSocketFactory::setProxySettings(const ProxySettings proxySettings, const QString &protocolTag)\n  {\n      throw std::invalid_argument(\"This socket factory doesn't manufacture network sockets and therefore doesn't support proxy settings\");\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Sent\")"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "297-303",
          "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_mainWindow->imapModel",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hangeConnectionState(",
          "args": [
            "TATE_SENT)"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "changeConnectionState(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "92-144",
          "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_updateReplyingToMessageFlagsTask,",
            "IGNAL(failed(QString)),",
            "his,",
            "LOT(onUpdatingFlagsOfReplyingToFailed()))"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nUpdatingFlagsOfReplyingToFailed())"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nUpdatingFlagsOfReplyingToFailed(",
          "args": [],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "onUpdatingFlagsOfReplyingToFailed(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "403-410",
          "snippet": "oid Submission::onUpdatingFlagsOfReplyingToFailed()\n{\n    m_updateReplyingToMessageFlagsTask = 0;\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                      QLatin1String(\"Cannot update flags of the message we replied to -- interesting, but we cannot do anything at this point anyway\"));\n    changeConnectionState(STATE_SENT);\n    emit succeeded();\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::onUpdatingFlagsOfReplyingToFailed()\n  {\n      m_updateReplyingToMessageFlagsTask = 0;\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                        QLatin1String(\"Cannot update flags of the message we replied to -- interesting, but we cannot do anything at this point anyway\"));\n      changeConnectionState(STATE_SENT);\n      emit succeeded();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ailed(QString))"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailed(",
          "args": [
            "String)"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendFailed(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "342-345",
          "snippet": "oid Submission::slotAppendFailed(const QString &error)\n{\n    gotError(tr(\"APPEND failed: %1\").arg(error));\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendFailed(const QString &error)\n  {\n      gotError(tr(\"APPEND failed: %1\").arg(error));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->setMessageFlags",
          "args": [
            "ModelIndexList() << m_composer->replyingToMessage(),",
            "Latin1String(\"\\\\Answered\"),",
            "map::Mailbox::FLAG_ADD)"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "\\\\Answered\")"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->replyingToMessage",
          "args": [],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndexList(",
          "args": [],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->replyingToMessage",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->replyingToMessage",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::sent()\n  {\n      if (m_composer->replyingToMessage().isValid()) {\n          m_updateReplyingToMessageFlagsTask = m_model->setMessageFlags(QModelIndexList() << m_composer->replyingToMessage(),\n                                                                        QLatin1String(\"\\\\Answered\"), Imap::Mailbox::FLAG_ADD);\n          connect(m_updateReplyingToMessageFlagsTask, SIGNAL(completed(Imap::Mailbox::ImapTask*)),\n                  this, SLOT(onUpdatingFlagsOfReplyingToSucceded()));\n          connect(m_updateReplyingToMessageFlagsTask, SIGNAL(failed(QString)),\n                  this, SLOT(onUpdatingFlagsOfReplyingToFailed()));\n          changeConnectionState(STATE_UPDATING_FLAGS);\n      } else {\n          changeConnectionState(STATE_SENT);\n          emit succeeded();\n      }\n  #if 0\n      if (m_appendUidReceived) {\n          // FIXME: check the UIDVALIDITY!!!\n          // FIXME: doesn't work at all; the messageIndexByUid() only works on already selected mailboxes\n          QModelIndex message = m_mainWindow->imapModel()->\n                  messageIndexByUid(QSettings().value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(), m_appendUid);\n          if (message.isValid()) {\n              m_mainWindow->imapModel()->setMessageFlags(QModelIndexList() << message,\n                                                         QLatin1String(\"\\\\Seen $Submitted\"), Imap::Mailbox::FLAG_USE_THESE);\n          }\n      }\n  #endif\n  \n      // FIXME: move back to the currently selected mailbox\n  }\n}"
  },
  {
    "function_name": "gotError(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "297-303",
    "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hangeConnectionState(",
          "args": [
            "TATE_FAILED)"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "changeConnectionState(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "92-144",
          "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Submission\"),",
            "String::fromUtf8(\"gotError: %1\").arg(error))"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "rror)"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "gotError: %1\")"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Submission\")"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
  },
  {
    "function_name": "cancelPassword(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "292-295",
    "snippet": "oid Submission::cancelPassword()\n{\n    emit canceled();\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::cancelPassword()\n  {\n      emit canceled();\n  }\n}"
  },
  {
    "function_name": "setPassword(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "287-290",
    "snippet": "oid Submission::setPassword(const QString &password)\n{\n    emit gotPassword(password);\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::setPassword(const QString &password)\n  {\n      emit gotPassword(password);\n  }\n}"
  },
  {
    "function_name": "slotInvokeMsaNow(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "261-285",
    "snippet": "oid Submission::slotInvokeMsaNow()\n{\n    changeConnectionState(STATE_SUBMITTING);\n    MSA::AbstractMSA *msa = m_msaFactory->create(this);\n    connect(msa, SIGNAL(progressMax(int)), this, SLOT(onMsaProgressMaxChanged(int)));\n    connect(msa, SIGNAL(progress(int)), this, SLOT(onMsaProgressCurrentChanged(int)));\n    connect(msa, SIGNAL(sent()), this, SLOT(sent()));\n    connect(msa, SIGNAL(error(QString)), this, SLOT(gotError(QString)));\n    connect(msa, SIGNAL(passwordRequested(QString,QString)), this, SIGNAL(passwordRequested(QString,QString)));\n    connect(this, SIGNAL(gotPassword(QString)), msa, SLOT(setPassword(QString)));\n    connect(this, SIGNAL(canceled()), msa, SLOT(cancel()));\n\n    if (m_useImapSubmit && msa->supportsImapSending() && m_appendUidReceived) {\n        Imap::Mailbox::UidSubmitOptionsList options;\n        options.append(qMakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()));\n        Q_FOREACH(const QByteArray &recipient, m_composer->rawRecipientAddresses()) {\n            options.append(qMakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient));\n        }\n        msa->sendImap(m_sentFolderName, m_appendUidValidity, m_appendUid, options);\n    } else if (m_genUrlAuthReceived && m_useBurl) {\n        msa->sendBurl(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_urlauth.toUtf8());\n    } else {\n        msa->sendMail(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_rawMessageData);\n    }\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sa->sendMail",
          "args": [
            "_composer->rawFromAddress(),",
            "_composer->rawRecipientAddresses(),",
            "_rawMessageData)"
          ],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "sendMail",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "650-664",
          "snippet": "int QwwSmtpClient::sendMail(const QByteArray &from, const QList<QByteArray> &to, const QString &content)\n{\n    QList<QVariant> rcpts;\n    for(QList<QByteArray>::const_iterator it = to.begin(); it != to.end(); it ++) {\n        rcpts.append(QVariant(*it));\n    }\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Mail;\n    cmd.data = QVariantList() << from << QVariant(rcpts) << content;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::sendMail(const QByteArray &from, const QList<QByteArray> &to, const QString &content)\n  {\n      QList<QVariant> rcpts;\n      for(QList<QByteArray>::const_iterator it = to.begin(); it != to.end(); it ++) {\n          rcpts.append(QVariant(*it));\n      }\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Mail;\n      cmd.data = QVariantList() << from << QVariant(rcpts) << content;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_composer->rawRecipientAddresses",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->rawFromAddress",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sa->sendBurl",
          "args": [
            "_composer->rawFromAddress(),",
            "_composer->rawRecipientAddresses(),",
            "_urlauth.toUtf8())"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_urlauth.toUtf8",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->rawRecipientAddresses",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->rawFromAddress",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sa->sendImap",
          "args": [
            "_sentFolderName,",
            "_appendUidValidity,",
            "_appendUid,",
            "ptions)"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptions.append",
          "args": [
            "MakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient))"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakePair<QByteArray,QVariant>",
          "args": [
            "RECIPIENT\",",
            "ecipient)"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptions.append",
          "args": [
            "MakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()))"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakePair<QByteArray,QVariant>",
          "args": [
            "FROM\",",
            "_composer->rawFromAddress())"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->rawFromAddress",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sa->supportsImapSending",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(canceled()),",
            "sa,",
            "LOT(cancel()))"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "ancel())"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ancel(",
          "args": [],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "cancel(",
          "container": "mapSubmit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/MSA/ImapSubmit.cpp",
          "lines": "34-38",
          "snippet": "oid ImapSubmit::cancel()\n{\n    emit error(QLatin1String(\"MSA::ImapSubmit::cancel() is not implemented; this is a bug in Trojita.\"));\n    Q_ASSERT(false);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"ImapSubmit.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"ImapSubmit.h\"\n#\n\nmapSubmit {\n  oid ImapSubmit::cancel()\n  {\n      emit error(QLatin1String(\"MSA::ImapSubmit::cancel() is not implemented; this is a bug in Trojita.\"));\n      Q_ASSERT(false);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "anceled())"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "anceled(",
          "args": [],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(gotPassword(QString)),",
            "sa,",
            "LOT(setPassword(QString)))"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "etPassword(QString))"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etPassword(",
          "args": [
            "String)"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "setPassword(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "287-290",
          "snippet": "oid Submission::setPassword(const QString &password)\n{\n    emit gotPassword(password);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::setPassword(const QString &password)\n  {\n      emit gotPassword(password);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "otPassword(QString))"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "otPassword(",
          "args": [
            "String)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "sa,",
            "IGNAL(passwordRequested(QString,QString)),",
            "his,",
            "IGNAL(passwordRequested(QString,QString)))"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "asswordRequested(QString,QString))"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asswordRequested(",
          "args": [
            "String,",
            "String)"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "passwordRequested(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "191-280",
          "snippet": "oid ComposeWidget::passwordRequested(const QString &user, const QString &host)\n{\n    bool ok;\n    const QString &password = Gui::PasswordDialog::getPassword(this, tr(\"Authentication Required\"),\n                                           tr(\"<p>Please provide SMTP password for user <b>%1</b> on <b>%2</b>:</p>\").arg(\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                                               Qt::escape(user),\n                                               Qt::escape(host)\n#else\n                                               user.toHtmlEscaped(),\n                                               host.toHtmlEscaped()\n#endif\n                                               ),\n                                           QString(), &ok);\n    if (ok)\n        m_submission->setPassword(password);\n    else\n        m_submission->cancelPassword();\n}\n\nvoid ComposeWidget::changeEvent(QEvent *e)\n{\n    QWidget::changeEvent(e);\n    switch (e->type()) {\n    case QEvent::LanguageChange:\n        ui->retranslateUi(this);\n        break;\n    default:\n        break;\n    }\n}\n\n/**\n * We capture the close event and check whether there's something to save\n * (not sent, not up-to-date or persistent autostore)\n * The offer the user to store or omit the message or not close at all\n */\n\nvoid ComposeWidget::closeEvent(QCloseEvent *ce)\n{\n    const bool noSaveRequired = m_sentMail || ui->mailText->document()->isEmpty() || !m_messageEverEdited ||\n                                (m_explicitDraft && !m_messageUpdated); // autosave to permanent draft and no update\n    if (!noSaveRequired) {  // save is required\n        QMessageBox msgBox(this);\n        msgBox.setWindowModality(Qt::WindowModal);\n        msgBox.setWindowTitle(tr(\"Save Draft?\"));\n        QString message(tr(\"The mail has not been sent.<br>Do you want to save the draft?\"));\n        if (ui->attachmentsView->model()->rowCount() > 0)\n            message += tr(\"<br><span style=\\\"color:red\\\">Warning: Attachments are <b>not</b> saved with the draft!</span>\");\n        msgBox.setText(message);\n        msgBox.setStandardButtons(QMessageBox::Save | QMessageBox::Discard | QMessageBox::Cancel);\n        msgBox.setDefaultButton(QMessageBox::Save);\n        int ret = msgBox.exec();\n        if (ret == QMessageBox::Save) {\n            if (m_explicitDraft) { // editing a present draft - override it\n                saveDraft(m_autoSavePath);\n            } else {\n                // Explicitly stored drafts should be saved in a location with proper i18n support, so let's make sure both main\n                // window and this code uses the same tr() calls\n                QString path(Common::writablePath(Common::LOCATION_DATA) + Gui::MainWindow::tr(\"Drafts\"));\n                QDir().mkpath(path);\n                QString filename = ui->subject->text();\n                if (filename.isEmpty()) {\n                    filename = QDateTime::currentDateTime().toString(Qt::ISODate);\n                }\n                // Some characters are best avoided in file names. This is probably not a definitive list, but the hope is that\n                // it's going to be more readable than an unformatted hash or similar stuff.  The list of characters was taken\n                // from http://en.wikipedia.org/wiki/Filename#Reserved_characters_and_words .\n                filename.replace(QRegExp(QLatin1String(\"[/\\\\\\\\:\\\"|<>*?]\")), QLatin1String(\"_\"));\n                path = QFileDialog::getSaveFileName(this, tr(\"Save as\"), path + QLatin1Char('/') + filename + QLatin1String(\".draft\"),\n                                                    tr(\"Drafts\") + QLatin1String(\" (*.draft)\"));\n                if (path.isEmpty()) { // cancelled save\n                    ret = QMessageBox::Cancel;\n                } else {\n                    m_explicitDraft = true;\n                    saveDraft(path);\n                    if (path != m_autoSavePath) // we can remove the temp save\n                        QFile::remove(m_autoSavePath);\n                }\n            }\n        }\n        if (ret == QMessageBox::Cancel) {\n            ce->ignore(); // don't close the window\n            return;\n        }\n    }\n    if (m_sentMail || !m_explicitDraft) // is the mail has been sent or the user does not want to store it\n        QFile::remove(m_autoSavePath); // get rid of draft\n    ce->accept(); // ultimately close the window\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::passwordRequested(const QString &user, const QString &host)\n  {\n      bool ok;\n      const QString &password = Gui::PasswordDialog::getPassword(this, tr(\"Authentication Required\"),\n                                             tr(\"<p>Please provide SMTP password for user <b>%1</b> on <b>%2</b>:</p>\").arg(\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                                                 Qt::escape(user),\n                                                 Qt::escape(host)\n  #else\n                                                 user.toHtmlEscaped(),\n                                                 host.toHtmlEscaped()\n  #endif\n                                                 ),\n                                             QString(), &ok);\n      if (ok)\n          m_submission->setPassword(password);\n      else\n          m_submission->cancelPassword();\n  }\n  \n  void ComposeWidget::changeEvent(QEvent *e)\n  {\n      QWidget::changeEvent(e);\n      switch (e->type()) {\n      case QEvent::LanguageChange:\n          ui->retranslateUi(this);\n          break;\n      default:\n          break;\n      }\n  }\n  \n  /**\n   * We capture the close event and check whether there's something to save\n   * (not sent, not up-to-date or persistent autostore)\n   * The offer the user to store or omit the message or not close at all\n   */\n  \n  void ComposeWidget::closeEvent(QCloseEvent *ce)\n  {\n      const bool noSaveRequired = m_sentMail || ui->mailText->document()->isEmpty() || !m_messageEverEdited ||\n                                  (m_explicitDraft && !m_messageUpdated); // autosave to permanent draft and no update\n      if (!noSaveRequired) {  // save is required\n          QMessageBox msgBox(this);\n          msgBox.setWindowModality(Qt::WindowModal);\n          msgBox.setWindowTitle(tr(\"Save Draft?\"));\n          QString message(tr(\"The mail has not been sent.<br>Do you want to save the draft?\"));\n          if (ui->attachmentsView->model()->rowCount() > 0)\n              message += tr(\"<br><span style=\\\"color:red\\\">Warning: Attachments are <b>not</b> saved with the draft!</span>\");\n          msgBox.setText(message);\n          msgBox.setStandardButtons(QMessageBox::Save | QMessageBox::Discard | QMessageBox::Cancel);\n          msgBox.setDefaultButton(QMessageBox::Save);\n          int ret = msgBox.exec();\n          if (ret == QMessageBox::Save) {\n              if (m_explicitDraft) { // editing a present draft - override it\n                  saveDraft(m_autoSavePath);\n              } else {\n                  // Explicitly stored drafts should be saved in a location with proper i18n support, so let's make sure both main\n                  // window and this code uses the same tr() calls\n                  QString path(Common::writablePath(Common::LOCATION_DATA) + Gui::MainWindow::tr(\"Drafts\"));\n                  QDir().mkpath(path);\n                  QString filename = ui->subject->text();\n                  if (filename.isEmpty()) {\n                      filename = QDateTime::currentDateTime().toString(Qt::ISODate);\n                  }\n                  // Some characters are best avoided in file names. This is probably not a definitive list, but the hope is that\n                  // it's going to be more readable than an unformatted hash or similar stuff.  The list of characters was taken\n                  // from http://en.wikipedia.org/wiki/Filename#Reserved_characters_and_words .\n                  filename.replace(QRegExp(QLatin1String(\"[/\\\\\\\\:\\\"|<>*?]\")), QLatin1String(\"_\"));\n                  path = QFileDialog::getSaveFileName(this, tr(\"Save as\"), path + QLatin1Char('/') + filename + QLatin1String(\".draft\"),\n                                                      tr(\"Drafts\") + QLatin1String(\" (*.draft)\"));\n                  if (path.isEmpty()) { // cancelled save\n                      ret = QMessageBox::Cancel;\n                  } else {\n                      m_explicitDraft = true;\n                      saveDraft(path);\n                      if (path != m_autoSavePath) // we can remove the temp save\n                          QFile::remove(m_autoSavePath);\n                  }\n              }\n          }\n          if (ret == QMessageBox::Cancel) {\n              ce->ignore(); // don't close the window\n              return;\n          }\n      }\n      if (m_sentMail || !m_explicitDraft) // is the mail has been sent or the user does not want to store it\n          QFile::remove(m_autoSavePath); // get rid of draft\n      ce->accept(); // ultimately close the window\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "asswordRequested(QString,QString))"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "sa,",
            "IGNAL(error(QString)),",
            "his,",
            "LOT(gotError(QString)))"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "otError(QString))"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "otError(",
          "args": [
            "String)"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "297-303",
          "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "rror(QString))"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "sa,",
            "IGNAL(sent()),",
            "his,",
            "LOT(sent()))"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "ent())"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ent(",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "sent(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "305-333",
          "snippet": "oid Submission::sent()\n{\n    if (m_composer->replyingToMessage().isValid()) {\n        m_updateReplyingToMessageFlagsTask = m_model->setMessageFlags(QModelIndexList() << m_composer->replyingToMessage(),\n                                                                      QLatin1String(\"\\\\Answered\"), Imap::Mailbox::FLAG_ADD);\n        connect(m_updateReplyingToMessageFlagsTask, SIGNAL(completed(Imap::Mailbox::ImapTask*)),\n                this, SLOT(onUpdatingFlagsOfReplyingToSucceded()));\n        connect(m_updateReplyingToMessageFlagsTask, SIGNAL(failed(QString)),\n                this, SLOT(onUpdatingFlagsOfReplyingToFailed()));\n        changeConnectionState(STATE_UPDATING_FLAGS);\n    } else {\n        changeConnectionState(STATE_SENT);\n        emit succeeded();\n    }\n#if 0\n    if (m_appendUidReceived) {\n        // FIXME: check the UIDVALIDITY!!!\n        // FIXME: doesn't work at all; the messageIndexByUid() only works on already selected mailboxes\n        QModelIndex message = m_mainWindow->imapModel()->\n                messageIndexByUid(QSettings().value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(), m_appendUid);\n        if (message.isValid()) {\n            m_mainWindow->imapModel()->setMessageFlags(QModelIndexList() << message,\n                                                       QLatin1String(\"\\\\Seen $Submitted\"), Imap::Mailbox::FLAG_USE_THESE);\n        }\n    }\n#endif\n\n    // FIXME: move back to the currently selected mailbox\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::sent()\n  {\n      if (m_composer->replyingToMessage().isValid()) {\n          m_updateReplyingToMessageFlagsTask = m_model->setMessageFlags(QModelIndexList() << m_composer->replyingToMessage(),\n                                                                        QLatin1String(\"\\\\Answered\"), Imap::Mailbox::FLAG_ADD);\n          connect(m_updateReplyingToMessageFlagsTask, SIGNAL(completed(Imap::Mailbox::ImapTask*)),\n                  this, SLOT(onUpdatingFlagsOfReplyingToSucceded()));\n          connect(m_updateReplyingToMessageFlagsTask, SIGNAL(failed(QString)),\n                  this, SLOT(onUpdatingFlagsOfReplyingToFailed()));\n          changeConnectionState(STATE_UPDATING_FLAGS);\n      } else {\n          changeConnectionState(STATE_SENT);\n          emit succeeded();\n      }\n  #if 0\n      if (m_appendUidReceived) {\n          // FIXME: check the UIDVALIDITY!!!\n          // FIXME: doesn't work at all; the messageIndexByUid() only works on already selected mailboxes\n          QModelIndex message = m_mainWindow->imapModel()->\n                  messageIndexByUid(QSettings().value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(), m_appendUid);\n          if (message.isValid()) {\n              m_mainWindow->imapModel()->setMessageFlags(QModelIndexList() << message,\n                                                         QLatin1String(\"\\\\Seen $Submitted\"), Imap::Mailbox::FLAG_USE_THESE);\n          }\n      }\n  #endif\n  \n      // FIXME: move back to the currently selected mailbox\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ent())"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_msaFactory->create",
          "args": [
            "his)"
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hangeConnectionState(",
          "args": [
            "TATE_SUBMITTING)"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "changeConnectionState(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "92-144",
          "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotInvokeMsaNow()\n  {\n      changeConnectionState(STATE_SUBMITTING);\n      MSA::AbstractMSA *msa = m_msaFactory->create(this);\n      connect(msa, SIGNAL(progressMax(int)), this, SLOT(onMsaProgressMaxChanged(int)));\n      connect(msa, SIGNAL(progress(int)), this, SLOT(onMsaProgressCurrentChanged(int)));\n      connect(msa, SIGNAL(sent()), this, SLOT(sent()));\n      connect(msa, SIGNAL(error(QString)), this, SLOT(gotError(QString)));\n      connect(msa, SIGNAL(passwordRequested(QString,QString)), this, SIGNAL(passwordRequested(QString,QString)));\n      connect(this, SIGNAL(gotPassword(QString)), msa, SLOT(setPassword(QString)));\n      connect(this, SIGNAL(canceled()), msa, SLOT(cancel()));\n  \n      if (m_useImapSubmit && msa->supportsImapSending() && m_appendUidReceived) {\n          Imap::Mailbox::UidSubmitOptionsList options;\n          options.append(qMakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()));\n          Q_FOREACH(const QByteArray &recipient, m_composer->rawRecipientAddresses()) {\n              options.append(qMakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient));\n          }\n          msa->sendImap(m_sentFolderName, m_appendUidValidity, m_appendUid, options);\n      } else if (m_genUrlAuthReceived && m_useBurl) {\n          msa->sendBurl(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_urlauth.toUtf8());\n      } else {\n          msa->sendMail(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_rawMessageData);\n      }\n  }\n}"
  },
  {
    "function_name": "slotAskForUrl(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "245-259",
    "snippet": "oid Submission::slotAskForUrl()\n{\n    Q_ASSERT(m_appendUidReceived && m_useBurl);\n    changeConnectionState(STATE_PREPARING_URLAUTH);\n    Imap::Mailbox::GenUrlAuthTask *genUrlAuthTask = QPointer<Imap::Mailbox::GenUrlAuthTask>(\n                m_model->generateUrlAuthForMessage(m_imapHostname,\n                                                   killDomainPartFromString(m_imapUsername),\n                                                   m_sentFolderName,\n                                                   m_appendUidValidity, m_appendUid, QString(),\n                                                   QString::fromUtf8(\"submit+%1\").arg(\n                                                       killDomainPartFromString(m_smtpUsername))\n                                                   ));\n    connect(genUrlAuthTask, SIGNAL(gotAuth(QString)), this, SLOT(slotGenUrlAuthReceived(QString)));\n    connect(genUrlAuthTask, SIGNAL(failed(QString)), this, SLOT(gotError(QString)));\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "enUrlAuthTask,",
            "IGNAL(failed(QString)),",
            "his,",
            "LOT(gotError(QString)))"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "otError(QString))"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "otError(",
          "args": [
            "String)"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "297-303",
          "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ailed(QString))"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailed(",
          "args": [
            "String)"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendFailed(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "342-345",
          "snippet": "oid Submission::slotAppendFailed(const QString &error)\n{\n    gotError(tr(\"APPEND failed: %1\").arg(error));\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendFailed(const QString &error)\n  {\n      gotError(tr(\"APPEND failed: %1\").arg(error));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "enUrlAuthTask,",
            "IGNAL(gotAuth(QString)),",
            "his,",
            "LOT(slotGenUrlAuthReceived(QString)))"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotGenUrlAuthReceived(QString))"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotGenUrlAuthReceived(",
          "args": [
            "String)"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "slotGenUrlAuthReceived(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "367-376",
          "snippet": "oid Submission::slotGenUrlAuthReceived(const QString &url)\n{\n    m_urlauth = url;\n    if (!m_urlauth.isEmpty()) {\n        m_genUrlAuthReceived = true;\n        slotInvokeMsaNow();\n    } else {\n        gotError(tr(\"The URLAUTH response does not contain a proper URL\"));\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotGenUrlAuthReceived(const QString &url)\n  {\n      m_urlauth = url;\n      if (!m_urlauth.isEmpty()) {\n          m_genUrlAuthReceived = true;\n          slotInvokeMsaNow();\n      } else {\n          gotError(tr(\"The URLAUTH response does not contain a proper URL\"));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "otAuth(QString))"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "otAuth(",
          "args": [
            "String)"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Pointer<Imap::Mailbox::GenUrlAuthTask>",
          "args": [
            "_model->generateUrlAuthForMessage(m_imapHostname,\n                                                   killDomainPartFromString(m_imapUsername),\n                                                   m_sentFolderName,\n                                                   m_appendUidValidity, m_appendUid, QString(),\n                                                   QString::fromUtf8(\"submit+%1\").arg(\n                                                       killDomainPartFromString(m_smtpUsername))\n                                                   ))"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->generateUrlAuthForMessage",
          "args": [
            "_imapHostname,",
            "illDomainPartFromString(m_imapUsername),",
            "_sentFolderName,",
            "_appendUidValidity,",
            "_appendUid,",
            "String(),",
            "String::fromUtf8(\"submit+%1\").arg(\n                                                       killDomainPartFromString(m_smtpUsername))"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "illDomainPartFromString(m_smtpUsername))"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "illDomainPartFromString(",
          "args": [
            "_smtpUsername)"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "killDomainPartFromString(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "379-382",
          "snippet": "String Submission::killDomainPartFromString(const QString &s)\n{\n    return s.split(QLatin1Char('@'))[0];\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  String Submission::killDomainPartFromString(const QString &s)\n  {\n      return s.split(QLatin1Char('@'))[0];\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "submit+%1\")"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hangeConnectionState(",
          "args": [
            "TATE_PREPARING_URLAUTH)"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "changeConnectionState(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "92-144",
          "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_appendUidReceived && m_useBurl)"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAskForUrl()\n  {\n      Q_ASSERT(m_appendUidReceived && m_useBurl);\n      changeConnectionState(STATE_PREPARING_URLAUTH);\n      Imap::Mailbox::GenUrlAuthTask *genUrlAuthTask = QPointer<Imap::Mailbox::GenUrlAuthTask>(\n                  m_model->generateUrlAuthForMessage(m_imapHostname,\n                                                     killDomainPartFromString(m_imapUsername),\n                                                     m_sentFolderName,\n                                                     m_appendUidValidity, m_appendUid, QString(),\n                                                     QString::fromUtf8(\"submit+%1\").arg(\n                                                         killDomainPartFromString(m_smtpUsername))\n                                                     ));\n      connect(genUrlAuthTask, SIGNAL(gotAuth(QString)), this, SLOT(slotGenUrlAuthReceived(QString)));\n      connect(genUrlAuthTask, SIGNAL(failed(QString)), this, SLOT(gotError(QString)));\n  }\n}"
  },
  {
    "function_name": "slotMessageDataAvailable(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "193-243",
    "snippet": "oid Submission::slotMessageDataAvailable()\n{\n    m_rawMessageData.clear();\n    QBuffer buf(&m_rawMessageData);\n    buf.open(QIODevice::WriteOnly);\n    QString errorMessage;\n    QList<Imap::Mailbox::CatenatePair> catenateable;\n\n    if (shouldBuildMessageLocally() && !m_composer->asRawMessage(&buf, &errorMessage)) {\n        gotError(tr(\"Cannot send right now -- saving failed:\\n %1\").arg(errorMessage));\n        return;\n    }\n    if (m_model->isCatenateSupported() && !m_composer->asCatenateData(catenateable, &errorMessage)) {\n        gotError(tr(\"Cannot send right now -- saving (CATENATE) failed:\\n %1\").arg(errorMessage));\n        return;\n    }\n\n    if (m_saveToSentFolder) {\n        Q_ASSERT(m_model);\n        m_appendUidReceived = false;\n        m_genUrlAuthReceived = false;\n\n        changeConnectionState(STATE_SAVING);\n        QPointer<Imap::Mailbox::AppendTask> appendTask = 0;\n\n        if (m_model->isCatenateSupported()) {\n            // FIXME: without UIDPLUS, there isn't much point in $SubmitPending...\n            appendTask = QPointer<Imap::Mailbox::AppendTask>(\n                        m_model->appendIntoMailbox(\n                            m_sentFolderName,\n                            catenateable,\n                            QStringList() << QLatin1String(\"\\\\Seen\"),\n                            m_composer->timestamp()));\n        } else {\n            // FIXME: without UIDPLUS, there isn't much point in $SubmitPending...\n            appendTask = QPointer<Imap::Mailbox::AppendTask>(\n                        m_model->appendIntoMailbox(\n                            m_sentFolderName,\n                            m_rawMessageData,\n                            QStringList() << QLatin1String(\"\\\\Seen\"),\n                            m_composer->timestamp()));\n        }\n\n        Q_ASSERT(appendTask);\n        connect(appendTask.data(), SIGNAL(appendUid(uint,uint)), this, SLOT(slotAppendUidKnown(uint,uint)));\n        connect(appendTask.data(), SIGNAL(completed(Imap::Mailbox::ImapTask*)), this, SLOT(slotAppendSucceeded()));\n        connect(appendTask.data(), SIGNAL(failed(QString)), this, SLOT(slotAppendFailed(QString)));\n    } else {\n        slotInvokeMsaNow();\n    }\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lotInvokeMsaNow(",
          "args": [],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "slotInvokeMsaNow(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "261-285",
          "snippet": "oid Submission::slotInvokeMsaNow()\n{\n    changeConnectionState(STATE_SUBMITTING);\n    MSA::AbstractMSA *msa = m_msaFactory->create(this);\n    connect(msa, SIGNAL(progressMax(int)), this, SLOT(onMsaProgressMaxChanged(int)));\n    connect(msa, SIGNAL(progress(int)), this, SLOT(onMsaProgressCurrentChanged(int)));\n    connect(msa, SIGNAL(sent()), this, SLOT(sent()));\n    connect(msa, SIGNAL(error(QString)), this, SLOT(gotError(QString)));\n    connect(msa, SIGNAL(passwordRequested(QString,QString)), this, SIGNAL(passwordRequested(QString,QString)));\n    connect(this, SIGNAL(gotPassword(QString)), msa, SLOT(setPassword(QString)));\n    connect(this, SIGNAL(canceled()), msa, SLOT(cancel()));\n\n    if (m_useImapSubmit && msa->supportsImapSending() && m_appendUidReceived) {\n        Imap::Mailbox::UidSubmitOptionsList options;\n        options.append(qMakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()));\n        Q_FOREACH(const QByteArray &recipient, m_composer->rawRecipientAddresses()) {\n            options.append(qMakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient));\n        }\n        msa->sendImap(m_sentFolderName, m_appendUidValidity, m_appendUid, options);\n    } else if (m_genUrlAuthReceived && m_useBurl) {\n        msa->sendBurl(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_urlauth.toUtf8());\n    } else {\n        msa->sendMail(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_rawMessageData);\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotInvokeMsaNow()\n  {\n      changeConnectionState(STATE_SUBMITTING);\n      MSA::AbstractMSA *msa = m_msaFactory->create(this);\n      connect(msa, SIGNAL(progressMax(int)), this, SLOT(onMsaProgressMaxChanged(int)));\n      connect(msa, SIGNAL(progress(int)), this, SLOT(onMsaProgressCurrentChanged(int)));\n      connect(msa, SIGNAL(sent()), this, SLOT(sent()));\n      connect(msa, SIGNAL(error(QString)), this, SLOT(gotError(QString)));\n      connect(msa, SIGNAL(passwordRequested(QString,QString)), this, SIGNAL(passwordRequested(QString,QString)));\n      connect(this, SIGNAL(gotPassword(QString)), msa, SLOT(setPassword(QString)));\n      connect(this, SIGNAL(canceled()), msa, SLOT(cancel()));\n  \n      if (m_useImapSubmit && msa->supportsImapSending() && m_appendUidReceived) {\n          Imap::Mailbox::UidSubmitOptionsList options;\n          options.append(qMakePair<QByteArray,QVariant>(\"FROM\", m_composer->rawFromAddress()));\n          Q_FOREACH(const QByteArray &recipient, m_composer->rawRecipientAddresses()) {\n              options.append(qMakePair<QByteArray,QVariant>(\"RECIPIENT\", recipient));\n          }\n          msa->sendImap(m_sentFolderName, m_appendUidValidity, m_appendUid, options);\n      } else if (m_genUrlAuthReceived && m_useBurl) {\n          msa->sendBurl(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_urlauth.toUtf8());\n      } else {\n          msa->sendMail(m_composer->rawFromAddress(), m_composer->rawRecipientAddresses(), m_rawMessageData);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "ppendTask.data(),",
            "IGNAL(failed(QString)),",
            "his,",
            "LOT(slotAppendFailed(QString)))"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotAppendFailed(QString))"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotAppendFailed(",
          "args": [
            "String)"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendFailed(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "342-345",
          "snippet": "oid Submission::slotAppendFailed(const QString &error)\n{\n    gotError(tr(\"APPEND failed: %1\").arg(error));\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendFailed(const QString &error)\n  {\n      gotError(tr(\"APPEND failed: %1\").arg(error));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ailed(QString))"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppendTask.data",
          "args": [],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "ppendTask.data(),",
            "IGNAL(completed(Imap::Mailbox::ImapTask*)),",
            "his,",
            "LOT(slotAppendSucceeded()))"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotAppendSucceeded())"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotAppendSucceeded(",
          "args": [],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendSucceeded(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "347-364",
          "snippet": "oid Submission::slotAppendSucceeded()\n{\n    if (m_appendUid && m_appendUidValidity) {\n        // Only ever consider valid UIDVALIDITY/UID pair\n        m_appendUidReceived = true;\n\n        if (m_useBurl) {\n            slotAskForUrl();\n        } else {\n            slotInvokeMsaNow();\n        }\n    } else {\n        m_useBurl = false;\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                          QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n        slotInvokeMsaNow();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendSucceeded()\n  {\n      if (m_appendUid && m_appendUidValidity) {\n          // Only ever consider valid UIDVALIDITY/UID pair\n          m_appendUidReceived = true;\n  \n          if (m_useBurl) {\n              slotAskForUrl();\n          } else {\n              slotInvokeMsaNow();\n          }\n      } else {\n          m_useBurl = false;\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                            QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n          slotInvokeMsaNow();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ompleted(Imap::Mailbox::ImapTask*))"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ompleted(",
          "args": [
            "map::Mailbox::ImapTask*)"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "ppendTask.data(),",
            "IGNAL(appendUid(uint,uint)),",
            "his,",
            "LOT(slotAppendUidKnown(uint,uint)))"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotAppendUidKnown(uint,uint))"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotAppendUidKnown(",
          "args": [
            "int,",
            "int)"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendUidKnown(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "336-340",
          "snippet": "oid Submission::slotAppendUidKnown(const uint uidValidity, const uint uid)\n{\n    m_appendUidValidity = uidValidity;\n    m_appendUid = uid;\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendUidKnown(const uint uidValidity, const uint uid)\n  {\n      m_appendUidValidity = uidValidity;\n      m_appendUid = uid;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ppendUid(uint,uint))"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppendUid(",
          "args": [
            "int,",
            "int)"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ppendTask)"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Pointer<Imap::Mailbox::AppendTask>",
          "args": [
            "_model->appendIntoMailbox(\n                            m_sentFolderName,\n                            m_rawMessageData,\n                            QStringList() << QLatin1String(\"\\\\Seen\"),\n                            m_composer->timestamp()))"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->appendIntoMailbox",
          "args": [
            "_sentFolderName,",
            "_rawMessageData,",
            "StringList() << QLatin1String(\"\\\\Seen\"),",
            "_composer->timestamp())"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->timestamp",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "\\\\Seen\")"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringList(",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Pointer<Imap::Mailbox::AppendTask>",
          "args": [
            "_model->appendIntoMailbox(\n                            m_sentFolderName,\n                            catenateable,\n                            QStringList() << QLatin1String(\"\\\\Seen\"),\n                            m_composer->timestamp()))"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->appendIntoMailbox",
          "args": [
            "_sentFolderName,",
            "atenateable,",
            "StringList() << QLatin1String(\"\\\\Seen\"),",
            "_composer->timestamp())"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->timestamp",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "\\\\Seen\")"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringList(",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->isCatenateSupported",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hangeConnectionState(",
          "args": [
            "TATE_SAVING)"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "changeConnectionState(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "92-144",
          "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_model)"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "otError(",
          "args": [
            "r(\"Cannot send right now -- saving (CATENATE) failed:\\n %1\").arg(errorMessage))"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "297-303",
          "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "rrorMessage)"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "onMsaProgressMaxChanged(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "422-425",
          "snippet": "oid Submission::onMsaProgressMaxChanged(const int max)\n{\n    m_msaMaximalProgress = max;\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::onMsaProgressMaxChanged(const int max)\n  {\n      m_msaMaximalProgress = max;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_composer->asCatenateData",
          "args": [
            "atenateable,",
            "errorMessage)"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->isCatenateSupported",
          "args": [],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_composer->asRawMessage",
          "args": [
            "buf,",
            "errorMessage)"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "houldBuildMessageLocally(",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "shouldBuildMessageLocally(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "385-394",
          "snippet": "ool Submission::shouldBuildMessageLocally() const\n{\n    if (!m_useImapSubmit) {\n        // sending via SMTP or Sendmail\n        // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n        return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n    } else {\n        return ! m_model->isCatenateSupported();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  ool Submission::shouldBuildMessageLocally() const\n  {\n      if (!m_useImapSubmit) {\n          // sending via SMTP or Sendmail\n          // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n          return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n      } else {\n          return ! m_model->isCatenateSupported();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "uf.open",
          "args": [
            "IODevice::WriteOnly)"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_rawMessageData.clear",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotMessageDataAvailable()\n  {\n      m_rawMessageData.clear();\n      QBuffer buf(&m_rawMessageData);\n      buf.open(QIODevice::WriteOnly);\n      QString errorMessage;\n      QList<Imap::Mailbox::CatenatePair> catenateable;\n  \n      if (shouldBuildMessageLocally() && !m_composer->asRawMessage(&buf, &errorMessage)) {\n          gotError(tr(\"Cannot send right now -- saving failed:\\n %1\").arg(errorMessage));\n          return;\n      }\n      if (m_model->isCatenateSupported() && !m_composer->asCatenateData(catenateable, &errorMessage)) {\n          gotError(tr(\"Cannot send right now -- saving (CATENATE) failed:\\n %1\").arg(errorMessage));\n          return;\n      }\n  \n      if (m_saveToSentFolder) {\n          Q_ASSERT(m_model);\n          m_appendUidReceived = false;\n          m_genUrlAuthReceived = false;\n  \n          changeConnectionState(STATE_SAVING);\n          QPointer<Imap::Mailbox::AppendTask> appendTask = 0;\n  \n          if (m_model->isCatenateSupported()) {\n              // FIXME: without UIDPLUS, there isn't much point in $SubmitPending...\n              appendTask = QPointer<Imap::Mailbox::AppendTask>(\n                          m_model->appendIntoMailbox(\n                              m_sentFolderName,\n                              catenateable,\n                              QStringList() << QLatin1String(\"\\\\Seen\"),\n                              m_composer->timestamp()));\n          } else {\n              // FIXME: without UIDPLUS, there isn't much point in $SubmitPending...\n              appendTask = QPointer<Imap::Mailbox::AppendTask>(\n                          m_model->appendIntoMailbox(\n                              m_sentFolderName,\n                              m_rawMessageData,\n                              QStringList() << QLatin1String(\"\\\\Seen\"),\n                              m_composer->timestamp()));\n          }\n  \n          Q_ASSERT(appendTask);\n          connect(appendTask.data(), SIGNAL(appendUid(uint,uint)), this, SLOT(slotAppendUidKnown(uint,uint)));\n          connect(appendTask.data(), SIGNAL(completed(Imap::Mailbox::ImapTask*)), this, SLOT(slotAppendSucceeded()));\n          connect(appendTask.data(), SIGNAL(failed(QString)), this, SLOT(slotAppendFailed(QString)));\n      } else {\n          slotInvokeMsaNow();\n      }\n  }\n}"
  },
  {
    "function_name": "send(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "168-190",
    "snippet": "oid Submission::send()\n{\n    if (!m_model) {\n        gotError(tr(\"The IMAP connection has disappeared. \"\n                    \"You'll have close the composer, save the draft and re-open it later. \"\n                    \"The attachments will have to be added later. Sorry for the trouble, \"\n                    \"please see <a href=\\\"https://projects.flaska.net/issues/640\\\">https://projects.flaska.net/issues/640</a> \"\n                    \"for details.\"));\n        return;\n    }\n\n    // this double-updating is needed in case the same Submission attempts to send a message more than once\n    changeConnectionState(STATE_INIT);\n    changeConnectionState(STATE_BUILDING_MESSAGE);\n\n    if (shouldBuildMessageLocally() && !m_composer->isReadyForSerialization()) {\n        // we have to wait until the data arrive\n        // FIXME: relax this to wait here\n        gotError(tr(\"Some data are not available yet\"));\n    } else {\n        slotMessageDataAvailable();\n    }\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lotMessageDataAvailable(",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "slotMessageDataAvailable(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "193-243",
          "snippet": "oid Submission::slotMessageDataAvailable()\n{\n    m_rawMessageData.clear();\n    QBuffer buf(&m_rawMessageData);\n    buf.open(QIODevice::WriteOnly);\n    QString errorMessage;\n    QList<Imap::Mailbox::CatenatePair> catenateable;\n\n    if (shouldBuildMessageLocally() && !m_composer->asRawMessage(&buf, &errorMessage)) {\n        gotError(tr(\"Cannot send right now -- saving failed:\\n %1\").arg(errorMessage));\n        return;\n    }\n    if (m_model->isCatenateSupported() && !m_composer->asCatenateData(catenateable, &errorMessage)) {\n        gotError(tr(\"Cannot send right now -- saving (CATENATE) failed:\\n %1\").arg(errorMessage));\n        return;\n    }\n\n    if (m_saveToSentFolder) {\n        Q_ASSERT(m_model);\n        m_appendUidReceived = false;\n        m_genUrlAuthReceived = false;\n\n        changeConnectionState(STATE_SAVING);\n        QPointer<Imap::Mailbox::AppendTask> appendTask = 0;\n\n        if (m_model->isCatenateSupported()) {\n            // FIXME: without UIDPLUS, there isn't much point in $SubmitPending...\n            appendTask = QPointer<Imap::Mailbox::AppendTask>(\n                        m_model->appendIntoMailbox(\n                            m_sentFolderName,\n                            catenateable,\n                            QStringList() << QLatin1String(\"\\\\Seen\"),\n                            m_composer->timestamp()));\n        } else {\n            // FIXME: without UIDPLUS, there isn't much point in $SubmitPending...\n            appendTask = QPointer<Imap::Mailbox::AppendTask>(\n                        m_model->appendIntoMailbox(\n                            m_sentFolderName,\n                            m_rawMessageData,\n                            QStringList() << QLatin1String(\"\\\\Seen\"),\n                            m_composer->timestamp()));\n        }\n\n        Q_ASSERT(appendTask);\n        connect(appendTask.data(), SIGNAL(appendUid(uint,uint)), this, SLOT(slotAppendUidKnown(uint,uint)));\n        connect(appendTask.data(), SIGNAL(completed(Imap::Mailbox::ImapTask*)), this, SLOT(slotAppendSucceeded()));\n        connect(appendTask.data(), SIGNAL(failed(QString)), this, SLOT(slotAppendFailed(QString)));\n    } else {\n        slotInvokeMsaNow();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotMessageDataAvailable()\n  {\n      m_rawMessageData.clear();\n      QBuffer buf(&m_rawMessageData);\n      buf.open(QIODevice::WriteOnly);\n      QString errorMessage;\n      QList<Imap::Mailbox::CatenatePair> catenateable;\n  \n      if (shouldBuildMessageLocally() && !m_composer->asRawMessage(&buf, &errorMessage)) {\n          gotError(tr(\"Cannot send right now -- saving failed:\\n %1\").arg(errorMessage));\n          return;\n      }\n      if (m_model->isCatenateSupported() && !m_composer->asCatenateData(catenateable, &errorMessage)) {\n          gotError(tr(\"Cannot send right now -- saving (CATENATE) failed:\\n %1\").arg(errorMessage));\n          return;\n      }\n  \n      if (m_saveToSentFolder) {\n          Q_ASSERT(m_model);\n          m_appendUidReceived = false;\n          m_genUrlAuthReceived = false;\n  \n          changeConnectionState(STATE_SAVING);\n          QPointer<Imap::Mailbox::AppendTask> appendTask = 0;\n  \n          if (m_model->isCatenateSupported()) {\n              // FIXME: without UIDPLUS, there isn't much point in $SubmitPending...\n              appendTask = QPointer<Imap::Mailbox::AppendTask>(\n                          m_model->appendIntoMailbox(\n                              m_sentFolderName,\n                              catenateable,\n                              QStringList() << QLatin1String(\"\\\\Seen\"),\n                              m_composer->timestamp()));\n          } else {\n              // FIXME: without UIDPLUS, there isn't much point in $SubmitPending...\n              appendTask = QPointer<Imap::Mailbox::AppendTask>(\n                          m_model->appendIntoMailbox(\n                              m_sentFolderName,\n                              m_rawMessageData,\n                              QStringList() << QLatin1String(\"\\\\Seen\"),\n                              m_composer->timestamp()));\n          }\n  \n          Q_ASSERT(appendTask);\n          connect(appendTask.data(), SIGNAL(appendUid(uint,uint)), this, SLOT(slotAppendUidKnown(uint,uint)));\n          connect(appendTask.data(), SIGNAL(completed(Imap::Mailbox::ImapTask*)), this, SLOT(slotAppendSucceeded()));\n          connect(appendTask.data(), SIGNAL(failed(QString)), this, SLOT(slotAppendFailed(QString)));\n      } else {\n          slotInvokeMsaNow();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "otError(",
          "args": [
            "r(\"Some data are not available yet\"))"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "297-303",
          "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_composer->isReadyForSerialization",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "houldBuildMessageLocally(",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "shouldBuildMessageLocally(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "385-394",
          "snippet": "ool Submission::shouldBuildMessageLocally() const\n{\n    if (!m_useImapSubmit) {\n        // sending via SMTP or Sendmail\n        // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n        return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n    } else {\n        return ! m_model->isCatenateSupported();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  ool Submission::shouldBuildMessageLocally() const\n  {\n      if (!m_useImapSubmit) {\n          // sending via SMTP or Sendmail\n          // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n          return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n      } else {\n          return ! m_model->isCatenateSupported();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "hangeConnectionState(",
          "args": [
            "TATE_BUILDING_MESSAGE)"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "changeConnectionState(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "92-144",
          "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::send()\n  {\n      if (!m_model) {\n          gotError(tr(\"The IMAP connection has disappeared. \"\n                      \"You'll have close the composer, save the draft and re-open it later. \"\n                      \"The attachments will have to be added later. Sorry for the trouble, \"\n                      \"please see <a href=\\\"https://projects.flaska.net/issues/640\\\">https://projects.flaska.net/issues/640</a> \"\n                      \"for details.\"));\n          return;\n      }\n  \n      // this double-updating is needed in case the same Submission attempts to send a message more than once\n      changeConnectionState(STATE_INIT);\n      changeConnectionState(STATE_BUILDING_MESSAGE);\n  \n      if (shouldBuildMessageLocally() && !m_composer->isReadyForSerialization()) {\n          // we have to wait until the data arrive\n          // FIXME: relax this to wait here\n          gotError(tr(\"Some data are not available yet\"));\n      } else {\n          slotMessageDataAvailable();\n      }\n  }\n}"
  },
  {
    "function_name": "setSmtpOptions(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "157-166",
    "snippet": "oid Submission::setSmtpOptions(const bool useBurl, const QString &smtpUsername)\n{\n    m_useBurl = useBurl;\n    if (m_useBurl && !m_model->isGenUrlAuthSupported()) {\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QLatin1String(\"Cannot BURL without the URLAUTH extension\"));\n        m_useBurl = false;\n    }\n    m_smtpUsername = smtpUsername;\n    m_composer->setPreloadEnabled(shouldBuildMessageLocally());\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_composer->setPreloadEnabled",
          "args": [
            "houldBuildMessageLocally())"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "houldBuildMessageLocally(",
          "args": [],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "shouldBuildMessageLocally(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "385-394",
          "snippet": "ool Submission::shouldBuildMessageLocally() const\n{\n    if (!m_useImapSubmit) {\n        // sending via SMTP or Sendmail\n        // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n        return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n    } else {\n        return ! m_model->isCatenateSupported();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  ool Submission::shouldBuildMessageLocally() const\n  {\n      if (!m_useImapSubmit) {\n          // sending via SMTP or Sendmail\n          // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n          return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n      } else {\n          return ! m_model->isCatenateSupported();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Submission\"),",
            "Latin1String(\"Cannot BURL without the URLAUTH extension\"))"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Cannot BURL without the URLAUTH extension\")"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Submission\")"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->isGenUrlAuthSupported",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::setSmtpOptions(const bool useBurl, const QString &smtpUsername)\n  {\n      m_useBurl = useBurl;\n      if (m_useBurl && !m_model->isGenUrlAuthSupported()) {\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QLatin1String(\"Cannot BURL without the URLAUTH extension\"));\n          m_useBurl = false;\n      }\n      m_smtpUsername = smtpUsername;\n      m_composer->setPreloadEnabled(shouldBuildMessageLocally());\n  }\n}"
  },
  {
    "function_name": "setImapOptions(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "146-155",
    "snippet": "oid Submission::setImapOptions(const bool saveToSentFolder, const QString &sentFolderName,\n                                const QString &hostname, const QString &username, const bool useImapSubmit)\n{\n    m_saveToSentFolder = saveToSentFolder;\n    m_sentFolderName = sentFolderName;\n    m_imapHostname = hostname;\n    m_imapUsername = username;\n    m_useImapSubmit = useImapSubmit;\n    m_composer->setPreloadEnabled(shouldBuildMessageLocally());\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_composer->setPreloadEnabled",
          "args": [
            "houldBuildMessageLocally())"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "houldBuildMessageLocally(",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "shouldBuildMessageLocally(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "385-394",
          "snippet": "ool Submission::shouldBuildMessageLocally() const\n{\n    if (!m_useImapSubmit) {\n        // sending via SMTP or Sendmail\n        // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n        return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n    } else {\n        return ! m_model->isCatenateSupported();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  ool Submission::shouldBuildMessageLocally() const\n  {\n      if (!m_useImapSubmit) {\n          // sending via SMTP or Sendmail\n          // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n          return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n      } else {\n          return ! m_model->isCatenateSupported();\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::setImapOptions(const bool saveToSentFolder, const QString &sentFolderName,\n                                  const QString &hostname, const QString &username, const bool useImapSubmit)\n  {\n      m_saveToSentFolder = saveToSentFolder;\n      m_sentFolderName = sentFolderName;\n      m_imapHostname = hostname;\n      m_imapUsername = username;\n      m_useImapSubmit = useImapSubmit;\n      m_composer->setPreloadEnabled(shouldBuildMessageLocally());\n  }\n}"
  },
  {
    "function_name": "changeConnectionState(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "92-144",
    "snippet": "oid Submission::changeConnectionState(const SubmissionProgress state)\n{\n    m_state = state;\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n\n    // Now broadcast a human-readable message and update the progress dialog\n    switch (state) {\n    case STATE_INIT:\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Preparing to send\"));\n        break;\n    case STATE_BUILDING_MESSAGE:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Creating message\"));\n        break;\n    case STATE_SAVING:\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n        break;\n    case STATE_PREPARING_URLAUTH:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_SAVING_DONE);\n        emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n        break;\n    case STATE_SUBMITTING:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n        emit updateStatusMessage(tr(\"Submitting message\"));\n        break;\n    case STATE_UPDATING_FLAGS:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_DELIVERY_DONE);\n        emit updateStatusMessage(tr(\"Updating message keywords\"));\n        break;\n    case STATE_SENT:\n        emit progressMax(PROGRESS_MAX);\n        emit progress(PROGRESS_MAX);\n        emit updateStatusMessage(tr(\"Message sent\"));\n        break;\n    case STATE_FAILED:\n        // revert to the busy indicator\n        emit progressMin(0);\n        emit progressMax(0);\n        emit progress(0);\n        emit updateStatusMessage(tr(\"Sending failed\"));\n        break;\n    }\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Sending failed\")"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "297-303",
          "snippet": "oid Submission::gotError(const QString &error)\n{\n    if (m_model)\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n    changeConnectionState(STATE_FAILED);\n    emit failed(error);\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::gotError(const QString &error)\n  {\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), QString::fromUtf8(\"gotError: %1\").arg(error));\n      changeConnectionState(STATE_FAILED);\n      emit failed(error);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"Submission\"),",
            "ubmissionProgressToString(m_state))"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubmissionProgressToString(",
          "args": [
            "_state)"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "ubmissionProgressToString(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "49-70",
          "snippet": "String submissionProgressToString(const Submission::SubmissionProgress progress)\n{\n    switch (progress) {\n    case Submission::STATE_INIT:\n        return QLatin1String(\"STATE_INIT\");\n    case Submission::STATE_BUILDING_MESSAGE:\n        return QLatin1String(\"STATE_BUILDING_MESSAGE\");\n    case Submission::STATE_SAVING:\n        return QLatin1String(\"STATE_SAVING\");\n    case Submission::STATE_PREPARING_URLAUTH:\n        return QLatin1String(\"STATE_PREPARING_URLAUTH\");\n    case Submission::STATE_SUBMITTING:\n        return QLatin1String(\"STATE_SUBMITTING\");\n    case Submission::STATE_UPDATING_FLAGS:\n        return QLatin1String(\"STATE_UPDATING_FLAGS\");\n    case Submission::STATE_SENT:\n        return QLatin1String(\"STATE_SENT\");\n    case Submission::STATE_FAILED:\n        return QLatin1String(\"STATE_FAILED\");\n    }\n    return QString::fromUtf8(\"[unknown: %1]\").arg(QString::number(static_cast<int>(progress)));\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nString submissionProgressToString(const Submission::SubmissionProgress progress)\n{\n    switch (progress) {\n    case Submission::STATE_INIT:\n        return QLatin1String(\"STATE_INIT\");\n    case Submission::STATE_BUILDING_MESSAGE:\n        return QLatin1String(\"STATE_BUILDING_MESSAGE\");\n    case Submission::STATE_SAVING:\n        return QLatin1String(\"STATE_SAVING\");\n    case Submission::STATE_PREPARING_URLAUTH:\n        return QLatin1String(\"STATE_PREPARING_URLAUTH\");\n    case Submission::STATE_SUBMITTING:\n        return QLatin1String(\"STATE_SUBMITTING\");\n    case Submission::STATE_UPDATING_FLAGS:\n        return QLatin1String(\"STATE_UPDATING_FLAGS\");\n    case Submission::STATE_SENT:\n        return QLatin1String(\"STATE_SENT\");\n    case Submission::STATE_FAILED:\n        return QLatin1String(\"STATE_FAILED\");\n    }\n    return QString::fromUtf8(\"[unknown: %1]\").arg(QString::number(static_cast<int>(progress)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Submission\")"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::changeConnectionState(const SubmissionProgress state)\n  {\n      m_state = state;\n      if (m_model)\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"), submissionProgressToString(m_state));\n  \n      // Now broadcast a human-readable message and update the progress dialog\n      switch (state) {\n      case STATE_INIT:\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Preparing to send\"));\n          break;\n      case STATE_BUILDING_MESSAGE:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Creating message\"));\n          break;\n      case STATE_SAVING:\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Saving to the sent folder\"));\n          break;\n      case STATE_PREPARING_URLAUTH:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_SAVING_DONE);\n          emit updateStatusMessage(tr(\"Preparing message for delivery\"));\n          break;\n      case STATE_SUBMITTING:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(m_saveToSentFolder ? PROGRESS_DELIVERY_START_WITH_SAVING : PROGRESS_DELIVERY_START_WITHOUT_SAVING);\n          emit updateStatusMessage(tr(\"Submitting message\"));\n          break;\n      case STATE_UPDATING_FLAGS:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_DELIVERY_DONE);\n          emit updateStatusMessage(tr(\"Updating message keywords\"));\n          break;\n      case STATE_SENT:\n          emit progressMax(PROGRESS_MAX);\n          emit progress(PROGRESS_MAX);\n          emit updateStatusMessage(tr(\"Message sent\"));\n          break;\n      case STATE_FAILED:\n          // revert to the busy indicator\n          emit progressMin(0);\n          emit progressMax(0);\n          emit progress(0);\n          emit updateStatusMessage(tr(\"Sending failed\"));\n          break;\n      }\n  }\n}"
  },
  {
    "function_name": "~Submission(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "88-90",
    "snippet": "ubmission::~Submission()\n{\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  ubmission::~Submission()\n  {\n  }\n}"
  },
  {
    "function_name": "Submission(",
    "container": "ubmission",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "72-81",
    "snippet": "ubmission::Submission(QObject *parent, Imap::Mailbox::Model *model, MSA::MSAFactory *msaFactory) :\n    QObject(parent),\n    m_appendUidReceived(false), m_appendUidValidity(0), m_appendUid(0), m_genUrlAuthReceived(false),\n    m_saveToSentFolder(false), m_useBurl(false), m_useImapSubmit(false), m_state(STATE_INIT),\n    m_msaMaximalProgress(0),\n    m_composer(0), m_model(model), m_msaFactory(msaFactory), m_updateReplyingToMessageFlagsTask(0)\n{\n    m_composer = new Composer::MessageComposer(model, this);\n    m_composer->setPreloadEnabled(shouldBuildMessageLocally());\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_composer->setPreloadEnabled",
          "args": [
            "houldBuildMessageLocally())"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "houldBuildMessageLocally(",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "shouldBuildMessageLocally(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "385-394",
          "snippet": "ool Submission::shouldBuildMessageLocally() const\n{\n    if (!m_useImapSubmit) {\n        // sending via SMTP or Sendmail\n        // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n        return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n    } else {\n        return ! m_model->isCatenateSupported();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  ool Submission::shouldBuildMessageLocally() const\n  {\n      if (!m_useImapSubmit) {\n          // sending via SMTP or Sendmail\n          // Unless all of URLAUTH, CATENATE and BURL is present and enabled, we will still have to download the data in the end\n          return ! (m_useBurl && m_model->isCatenateSupported() && m_model->isGenUrlAuthSupported());\n      } else {\n          return ! m_model->isCatenateSupported();\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  ubmission::Submission(QObject *parent, Imap::Mailbox::Model *model, MSA::MSAFactory *msaFactory) :\n      QObject(parent),\n      m_appendUidReceived(false), m_appendUidValidity(0), m_appendUid(0), m_genUrlAuthReceived(false),\n      m_saveToSentFolder(false), m_useBurl(false), m_useImapSubmit(false), m_state(STATE_INIT),\n      m_msaMaximalProgress(0),\n      m_composer(0), m_model(model), m_msaFactory(msaFactory), m_updateReplyingToMessageFlagsTask(0)\n  {\n      m_composer = new Composer::MessageComposer(model, this);\n      m_composer->setPreloadEnabled(shouldBuildMessageLocally());\n  }\n}"
  },
  {
    "function_name": "ubmissionProgressToString(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
    "lines": "49-70",
    "snippet": "String submissionProgressToString(const Submission::SubmissionProgress progress)\n{\n    switch (progress) {\n    case Submission::STATE_INIT:\n        return QLatin1String(\"STATE_INIT\");\n    case Submission::STATE_BUILDING_MESSAGE:\n        return QLatin1String(\"STATE_BUILDING_MESSAGE\");\n    case Submission::STATE_SAVING:\n        return QLatin1String(\"STATE_SAVING\");\n    case Submission::STATE_PREPARING_URLAUTH:\n        return QLatin1String(\"STATE_PREPARING_URLAUTH\");\n    case Submission::STATE_SUBMITTING:\n        return QLatin1String(\"STATE_SUBMITTING\");\n    case Submission::STATE_UPDATING_FLAGS:\n        return QLatin1String(\"STATE_UPDATING_FLAGS\");\n    case Submission::STATE_SENT:\n        return QLatin1String(\"STATE_SENT\");\n    case Submission::STATE_FAILED:\n        return QLatin1String(\"STATE_FAILED\");\n    }\n    return QString::fromUtf8(\"[unknown: %1]\").arg(QString::number(static_cast<int>(progress)));\n}",
    "includes": [
      "include \"MSA/SMTP.h\"",
      "include \"MSA/Sendmail.h\"\n#",
      "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include <QSettings>\n#",
      "include <QBuffer>\n#",
      "include <QCoreApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "String::number(static_cast<int>(progress)))"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::number(",
          "args": [
            "tatic_cast<int>(progress))"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<int>",
          "args": [
            "rogress)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "[unknown: %1]\")"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "STATE_FAILED\")"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "STATE_SENT\")"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "STATE_UPDATING_FLAGS\")"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "STATE_SUBMITTING\")"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "STATE_PREPARING_URLAUTH\")"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "STATE_SAVING\")"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "STATE_BUILDING_MESSAGE\")"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "STATE_INIT\")"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nString submissionProgressToString(const Submission::SubmissionProgress progress)\n{\n    switch (progress) {\n    case Submission::STATE_INIT:\n        return QLatin1String(\"STATE_INIT\");\n    case Submission::STATE_BUILDING_MESSAGE:\n        return QLatin1String(\"STATE_BUILDING_MESSAGE\");\n    case Submission::STATE_SAVING:\n        return QLatin1String(\"STATE_SAVING\");\n    case Submission::STATE_PREPARING_URLAUTH:\n        return QLatin1String(\"STATE_PREPARING_URLAUTH\");\n    case Submission::STATE_SUBMITTING:\n        return QLatin1String(\"STATE_SUBMITTING\");\n    case Submission::STATE_UPDATING_FLAGS:\n        return QLatin1String(\"STATE_UPDATING_FLAGS\");\n    case Submission::STATE_SENT:\n        return QLatin1String(\"STATE_SENT\");\n    case Submission::STATE_FAILED:\n        return QLatin1String(\"STATE_FAILED\");\n    }\n    return QString::fromUtf8(\"[unknown: %1]\").arg(QString::number(static_cast<int>(progress)));\n}"
  }
]