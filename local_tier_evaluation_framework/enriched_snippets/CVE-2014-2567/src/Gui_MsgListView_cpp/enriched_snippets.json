[
  {
    "function_name": "setAutoActivateAfterKeyNavigation(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "401-404",
    "snippet": "oid MsgListView::setAutoActivateAfterKeyNavigation(bool enabled)\n{\n    m_autoActivateAfterKeyNavigation = enabled;\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::setAutoActivateAfterKeyNavigation(bool enabled)\n  {\n      m_autoActivateAfterKeyNavigation = enabled;\n  }\n}"
  },
  {
    "function_name": "slotHandleSortCriteriaChanged(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "380-386",
    "snippet": "oid MsgListView::slotHandleSortCriteriaChanged(int column, Qt::SortOrder order)\n{\n    // The if-clause is needed to prevent infinite recursion\n    if (header()->sortIndicatorSection() != column || header()->sortIndicatorOrder() != order) {\n        header()->setSortIndicator(column, order);\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eader",
          "args": [
            "olumn,",
            "rder)"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "processAdditionalHeaders(",
          "container": "reeItemMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1272-1291",
          "snippet": "oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n{\n    Imap::LowLevelParser::Rfc5322HeaderParser parser;\n    bool ok = parser.parse(rawHeaders);\n    if (!ok) {\n        model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                        QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n    }\n\n    data()->m_hdrReferences = parser.references;\n    if (!parser.listPost.isEmpty()) {\n        data()->m_hdrListPost.clear();\n        Q_FOREACH(const QByteArray &item, parser.listPost)\n            data()->m_hdrListPost << QUrl(item);\n    }\n    // That's right, this can only be set, not ever reset from this context.\n    // This is because we absolutely want to support incremental header arrival.\n    if (parser.listPostNo)\n        data()->m_hdrListPostNo = true;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemMessage {\n  oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n  {\n      Imap::LowLevelParser::Rfc5322HeaderParser parser;\n      bool ok = parser.parse(rawHeaders);\n      if (!ok) {\n          model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                          QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n      }\n  \n      data()->m_hdrReferences = parser.references;\n      if (!parser.listPost.isEmpty()) {\n          data()->m_hdrListPost.clear();\n          Q_FOREACH(const QByteArray &item, parser.listPost)\n              data()->m_hdrListPost << QUrl(item);\n      }\n      // That's right, this can only be set, not ever reset from this context.\n      // This is because we absolutely want to support incremental header arrival.\n      if (parser.listPostNo)\n          data()->m_hdrListPostNo = true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader(",
          "args": [],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "asMailHeader(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "246-258",
          "snippet": "ByteArray MailAddress::asMailHeader() const\n{\n    QByteArray result = Imap::encodeRFC2047Phrase(name);\n\n    if (!result.isEmpty())\n        result.append(\" \");\n    \n    result.append(\"<\");\n    result.append(asSMTPMailbox());\n    result.append(\">\");\n\n    return result;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ByteArray MailAddress::asMailHeader() const\n  {\n      QByteArray result = Imap::encodeRFC2047Phrase(name);\n  \n      if (!result.isEmpty())\n          result.append(\" \");\n      \n      result.append(\"<\");\n      result.append(asSMTPMailbox());\n      result.append(\">\");\n  \n      return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "slotViewMsgHeaders()\n{",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1732-1761",
          "snippet": "Window::slotViewMsgHeaders()\n{\n    Q_FOREACH(const QModelIndex &item, msgListWidget->tree->selectionModel()->selectedIndexes()) {\n        Q_ASSERT(item.isValid());\n        if (item.column() != 0)\n            continue;\n        if (! item.data(Imap::Mailbox::RoleMessageUid).isValid())\n            continue;\n        QModelIndex messageIndex = Imap::deproxifiedIndex(item);\n\n        Imap::Network::MsgPartNetAccessManager *netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n        netAccess->setModelMessage(messageIndex);\n\n        SimplePartWidget *headers = new SimplePartWidget(0, netAccess,\n                                        messageIndex.model()->index(0, Imap::Mailbox::TreeItem::OFFSET_HEADER, messageIndex),\n                                                         0);\n        headers->setAttribute(Qt::WA_DeleteOnClose);\n        connect(headers, SIGNAL(destroyed()), netAccess, SLOT(deleteLater()));\n        QAction *close = new QAction(loadIcon(QLatin1String(\"window-close\")), tr(\"Close\"), headers);\n        headers->addAction(close);\n        close->setShortcut(tr(\"Ctrl+W\"));\n        connect(close, SIGNAL(triggered()), headers, SLOT(close()));\n        headers->setWindowTitle(tr(\"Message headers of UID %1 in %2\").arg(\n                                    QString::number(messageIndex.data(Imap::Mailbox::RoleMessageUid).toUInt()),\n                                    messageIndex.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()\n                                    ));\n        headers->setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n        headers->show();\n    }\n}\n\n#ifdef",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotViewMsgHeaders()\n  {\n      Q_FOREACH(const QModelIndex &item, msgListWidget->tree->selectionModel()->selectedIndexes()) {\n          Q_ASSERT(item.isValid());\n          if (item.column() != 0)\n              continue;\n          if (! item.data(Imap::Mailbox::RoleMessageUid).isValid())\n              continue;\n          QModelIndex messageIndex = Imap::deproxifiedIndex(item);\n  \n          Imap::Network::MsgPartNetAccessManager *netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n          netAccess->setModelMessage(messageIndex);\n  \n          SimplePartWidget *headers = new SimplePartWidget(0, netAccess,\n                                          messageIndex.model()->index(0, Imap::Mailbox::TreeItem::OFFSET_HEADER, messageIndex),\n                                                           0);\n          headers->setAttribute(Qt::WA_DeleteOnClose);\n          connect(headers, SIGNAL(destroyed()), netAccess, SLOT(deleteLater()));\n          QAction *close = new QAction(loadIcon(QLatin1String(\"window-close\")), tr(\"Close\"), headers);\n          headers->addAction(close);\n          close->setShortcut(tr(\"Ctrl+W\"));\n          connect(close, SIGNAL(triggered()), headers, SLOT(close()));\n          headers->setWindowTitle(tr(\"Message headers of UID %1 in %2\").arg(\n                                      QString::number(messageIndex.data(Imap::Mailbox::RoleMessageUid).toUInt()),\n                                      messageIndex.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()\n                                      ));\n          headers->setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n          headers->show();\n      }\n  }\n  \n  #ifdef\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotHandleSortCriteriaChanged(int column, Qt::SortOrder order)\n  {\n      // The if-clause is needed to prevent infinite recursion\n      if (header()->sortIndicatorSection() != column || header()->sortIndicatorOrder() != order) {\n          header()->setSortIndicator(column, order);\n      }\n  }\n}"
  },
  {
    "function_name": "setModel(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "365-378",
    "snippet": "oid MsgListView::setModel(QAbstractItemModel *model)\n{\n    if (this->model()) {\n        if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(this->model())) {\n            disconnect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                       this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n        }\n    }\n    QTreeView::setModel(model);\n    if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(model)) {\n        connect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "indPrettyMsgListModel(",
          "args": [
            "odel)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TreeView::setModel(",
          "args": [
            "odel)"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "setModel(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "365-378",
          "snippet": "oid MsgListView::setModel(QAbstractItemModel *model)\n{\n    if (this->model()) {\n        if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(this->model())) {\n            disconnect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                       this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n        }\n    }\n    QTreeView::setModel(model);\n    if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(model)) {\n        connect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "indPrettyMsgListModel(",
          "args": [
            "his->model())"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "his->model",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "his->model",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::setModel(QAbstractItemModel *model)\n  {\n      if (this->model()) {\n          if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(this->model())) {\n              disconnect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                         this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n          }\n      }\n      QTreeView::setModel(model);\n      if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(model)) {\n          connect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                  this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n      }\n  }\n}"
  },
  {
    "function_name": "updateActionsAfterRestoredState(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "351-358",
    "snippet": "oid MsgListView::updateActionsAfterRestoredState()\n{\n    m_autoResizeSections = false;\n    QList<QAction *> actions = header()->actions();\n    for (int i = 0; i < actions.size(); ++i) {\n        actions[i]->setChecked(!header()->isSectionHidden(i));\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ctions[i]->setChecked",
          "args": [
            "header()->isSectionHidden(i))"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [
            ")"
          ],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "slotHeaderSectionVisibilityToggled(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "336-349",
          "snippet": "oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n{\n    QList<QAction *> actions = header()->actions();\n    if (section >= actions.size() || section < 0)\n        return;\n    bool hide = ! actions[section]->isChecked();\n\n    if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n        // This would hide the very last section, which would hide the whole header view\n        actions[section]->setChecked(true);\n    } else {\n        header()->setSectionHidden(section, hide);\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n  {\n      QList<QAction *> actions = header()->actions();\n      if (section >= actions.size() || section < 0)\n          return;\n      bool hide = ! actions[section]->isChecked();\n  \n      if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n          // This would hide the very last section, which would hide the whole header view\n          actions[section]->setChecked(true);\n      } else {\n          header()->setSectionHidden(section, hide);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader(",
          "args": [],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "asMailHeader(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "246-258",
          "snippet": "ByteArray MailAddress::asMailHeader() const\n{\n    QByteArray result = Imap::encodeRFC2047Phrase(name);\n\n    if (!result.isEmpty())\n        result.append(\" \");\n    \n    result.append(\"<\");\n    result.append(asSMTPMailbox());\n    result.append(\">\");\n\n    return result;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ByteArray MailAddress::asMailHeader() const\n  {\n      QByteArray result = Imap::encodeRFC2047Phrase(name);\n  \n      if (!result.isEmpty())\n          result.append(\" \");\n      \n      result.append(\"<\");\n      result.append(asSMTPMailbox());\n      result.append(\">\");\n  \n      return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctions.size",
          "args": [],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "slotViewMsgHeaders()\n{",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1732-1761",
          "snippet": "Window::slotViewMsgHeaders()\n{\n    Q_FOREACH(const QModelIndex &item, msgListWidget->tree->selectionModel()->selectedIndexes()) {\n        Q_ASSERT(item.isValid());\n        if (item.column() != 0)\n            continue;\n        if (! item.data(Imap::Mailbox::RoleMessageUid).isValid())\n            continue;\n        QModelIndex messageIndex = Imap::deproxifiedIndex(item);\n\n        Imap::Network::MsgPartNetAccessManager *netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n        netAccess->setModelMessage(messageIndex);\n\n        SimplePartWidget *headers = new SimplePartWidget(0, netAccess,\n                                        messageIndex.model()->index(0, Imap::Mailbox::TreeItem::OFFSET_HEADER, messageIndex),\n                                                         0);\n        headers->setAttribute(Qt::WA_DeleteOnClose);\n        connect(headers, SIGNAL(destroyed()), netAccess, SLOT(deleteLater()));\n        QAction *close = new QAction(loadIcon(QLatin1String(\"window-close\")), tr(\"Close\"), headers);\n        headers->addAction(close);\n        close->setShortcut(tr(\"Ctrl+W\"));\n        connect(close, SIGNAL(triggered()), headers, SLOT(close()));\n        headers->setWindowTitle(tr(\"Message headers of UID %1 in %2\").arg(\n                                    QString::number(messageIndex.data(Imap::Mailbox::RoleMessageUid).toUInt()),\n                                    messageIndex.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()\n                                    ));\n        headers->setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n        headers->show();\n    }\n}\n\n#ifdef",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotViewMsgHeaders()\n  {\n      Q_FOREACH(const QModelIndex &item, msgListWidget->tree->selectionModel()->selectedIndexes()) {\n          Q_ASSERT(item.isValid());\n          if (item.column() != 0)\n              continue;\n          if (! item.data(Imap::Mailbox::RoleMessageUid).isValid())\n              continue;\n          QModelIndex messageIndex = Imap::deproxifiedIndex(item);\n  \n          Imap::Network::MsgPartNetAccessManager *netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n          netAccess->setModelMessage(messageIndex);\n  \n          SimplePartWidget *headers = new SimplePartWidget(0, netAccess,\n                                          messageIndex.model()->index(0, Imap::Mailbox::TreeItem::OFFSET_HEADER, messageIndex),\n                                                           0);\n          headers->setAttribute(Qt::WA_DeleteOnClose);\n          connect(headers, SIGNAL(destroyed()), netAccess, SLOT(deleteLater()));\n          QAction *close = new QAction(loadIcon(QLatin1String(\"window-close\")), tr(\"Close\"), headers);\n          headers->addAction(close);\n          close->setShortcut(tr(\"Ctrl+W\"));\n          connect(close, SIGNAL(triggered()), headers, SLOT(close()));\n          headers->setWindowTitle(tr(\"Message headers of UID %1 in %2\").arg(\n                                      QString::number(messageIndex.data(Imap::Mailbox::RoleMessageUid).toUInt()),\n                                      messageIndex.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()\n                                      ));\n          headers->setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n          headers->show();\n      }\n  }\n  \n  #ifdef\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::updateActionsAfterRestoredState()\n  {\n      m_autoResizeSections = false;\n      QList<QAction *> actions = header()->actions();\n      for (int i = 0; i < actions.size(); ++i) {\n          actions[i]->setChecked(!header()->isSectionHidden(i));\n      }\n  }\n}"
  },
  {
    "function_name": "slotHeaderSectionVisibilityToggled(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "336-349",
    "snippet": "oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n{\n    QList<QAction *> actions = header()->actions();\n    if (section >= actions.size() || section < 0)\n        return;\n    bool hide = ! actions[section]->isChecked();\n\n    if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n        // This would hide the very last section, which would hide the whole header view\n        actions[section]->setChecked(true);\n    } else {\n        header()->setSectionHidden(section, hide);\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eader",
          "args": [
            "ection,",
            "ide)"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "processAdditionalHeaders(",
          "container": "reeItemMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1272-1291",
          "snippet": "oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n{\n    Imap::LowLevelParser::Rfc5322HeaderParser parser;\n    bool ok = parser.parse(rawHeaders);\n    if (!ok) {\n        model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                        QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n    }\n\n    data()->m_hdrReferences = parser.references;\n    if (!parser.listPost.isEmpty()) {\n        data()->m_hdrListPost.clear();\n        Q_FOREACH(const QByteArray &item, parser.listPost)\n            data()->m_hdrListPost << QUrl(item);\n    }\n    // That's right, this can only be set, not ever reset from this context.\n    // This is because we absolutely want to support incremental header arrival.\n    if (parser.listPostNo)\n        data()->m_hdrListPostNo = true;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemMessage {\n  oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n  {\n      Imap::LowLevelParser::Rfc5322HeaderParser parser;\n      bool ok = parser.parse(rawHeaders);\n      if (!ok) {\n          model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                          QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n      }\n  \n      data()->m_hdrReferences = parser.references;\n      if (!parser.listPost.isEmpty()) {\n          data()->m_hdrListPost.clear();\n          Q_FOREACH(const QByteArray &item, parser.listPost)\n              data()->m_hdrListPost << QUrl(item);\n      }\n      // That's right, this can only be set, not ever reset from this context.\n      // This is because we absolutely want to support incremental header arrival.\n      if (parser.listPostNo)\n          data()->m_hdrListPostNo = true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader(",
          "args": [],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "asMailHeader(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "246-258",
          "snippet": "ByteArray MailAddress::asMailHeader() const\n{\n    QByteArray result = Imap::encodeRFC2047Phrase(name);\n\n    if (!result.isEmpty())\n        result.append(\" \");\n    \n    result.append(\"<\");\n    result.append(asSMTPMailbox());\n    result.append(\">\");\n\n    return result;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ByteArray MailAddress::asMailHeader() const\n  {\n      QByteArray result = Imap::encodeRFC2047Phrase(name);\n  \n      if (!result.isEmpty())\n          result.append(\" \");\n      \n      result.append(\"<\");\n      result.append(asSMTPMailbox());\n      result.append(\">\");\n  \n      return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctions[section]->setChecked",
          "args": [
            "rue)"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "slotViewMsgHeaders()\n{",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1732-1761",
          "snippet": "Window::slotViewMsgHeaders()\n{\n    Q_FOREACH(const QModelIndex &item, msgListWidget->tree->selectionModel()->selectedIndexes()) {\n        Q_ASSERT(item.isValid());\n        if (item.column() != 0)\n            continue;\n        if (! item.data(Imap::Mailbox::RoleMessageUid).isValid())\n            continue;\n        QModelIndex messageIndex = Imap::deproxifiedIndex(item);\n\n        Imap::Network::MsgPartNetAccessManager *netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n        netAccess->setModelMessage(messageIndex);\n\n        SimplePartWidget *headers = new SimplePartWidget(0, netAccess,\n                                        messageIndex.model()->index(0, Imap::Mailbox::TreeItem::OFFSET_HEADER, messageIndex),\n                                                         0);\n        headers->setAttribute(Qt::WA_DeleteOnClose);\n        connect(headers, SIGNAL(destroyed()), netAccess, SLOT(deleteLater()));\n        QAction *close = new QAction(loadIcon(QLatin1String(\"window-close\")), tr(\"Close\"), headers);\n        headers->addAction(close);\n        close->setShortcut(tr(\"Ctrl+W\"));\n        connect(close, SIGNAL(triggered()), headers, SLOT(close()));\n        headers->setWindowTitle(tr(\"Message headers of UID %1 in %2\").arg(\n                                    QString::number(messageIndex.data(Imap::Mailbox::RoleMessageUid).toUInt()),\n                                    messageIndex.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()\n                                    ));\n        headers->setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n        headers->show();\n    }\n}\n\n#ifdef",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotViewMsgHeaders()\n  {\n      Q_FOREACH(const QModelIndex &item, msgListWidget->tree->selectionModel()->selectedIndexes()) {\n          Q_ASSERT(item.isValid());\n          if (item.column() != 0)\n              continue;\n          if (! item.data(Imap::Mailbox::RoleMessageUid).isValid())\n              continue;\n          QModelIndex messageIndex = Imap::deproxifiedIndex(item);\n  \n          Imap::Network::MsgPartNetAccessManager *netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n          netAccess->setModelMessage(messageIndex);\n  \n          SimplePartWidget *headers = new SimplePartWidget(0, netAccess,\n                                          messageIndex.model()->index(0, Imap::Mailbox::TreeItem::OFFSET_HEADER, messageIndex),\n                                                           0);\n          headers->setAttribute(Qt::WA_DeleteOnClose);\n          connect(headers, SIGNAL(destroyed()), netAccess, SLOT(deleteLater()));\n          QAction *close = new QAction(loadIcon(QLatin1String(\"window-close\")), tr(\"Close\"), headers);\n          headers->addAction(close);\n          close->setShortcut(tr(\"Ctrl+W\"));\n          connect(close, SIGNAL(triggered()), headers, SLOT(close()));\n          headers->setWindowTitle(tr(\"Message headers of UID %1 in %2\").arg(\n                                      QString::number(messageIndex.data(Imap::Mailbox::RoleMessageUid).toUInt()),\n                                      messageIndex.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()\n                                      ));\n          headers->setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n          headers->show();\n      }\n  }\n  \n  #ifdef\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctions[section]->isChecked",
          "args": [],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctions.size",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n  {\n      QList<QAction *> actions = header()->actions();\n      if (section >= actions.size() || section < 0)\n          return;\n      bool hide = ! actions[section]->isChecked();\n  \n      if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n          // This would hide the very last section, which would hide the whole header view\n          actions[section]->setChecked(true);\n      } else {\n          header()->setSectionHidden(section, hide);\n      }\n  }\n}"
  },
  {
    "function_name": "slotSectionCountChanged(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "293-334",
    "snippet": "oid MsgListView::slotSectionCountChanged()\n{\n    Q_ASSERT(header());\n    // At first, remove all actions\n    QList<QAction *> actions = header()->actions();\n    Q_FOREACH(QAction *action, actions) {\n        header()->removeAction(action);\n        headerFieldsMapper->removeMappings(action);\n        action->deleteLater();\n    }\n    actions.clear();\n    // Now add them again\n    for (int i = 0; i < header()->count(); ++i) {\n        QString message = header()->model() ? header()->model()->headerData(i, Qt::Horizontal).toString() : QString::number(i);\n        QAction *action = new QAction(message, this);\n        action->setCheckable(true);\n        action->setChecked(true);\n        connect(action, SIGNAL(toggled(bool)), headerFieldsMapper, SLOT(map()));\n        headerFieldsMapper->setMapping(action, i);\n        header()->addAction(action);\n\n        // Next, add some special handling of certain columns\n        switch (i) {\n        case Imap::Mailbox::MsgListModel::SEEN:\n            // This column doesn't have a textual description\n            action->setText(tr(\"Seen status\"));\n            break;\n        case Imap::Mailbox::MsgListModel::TO:\n        case Imap::Mailbox::MsgListModel::CC:\n        case Imap::Mailbox::MsgListModel::BCC:\n        case Imap::Mailbox::MsgListModel::RECEIVED_DATE:\n            // And these should be hidden by default\n            action->toggle();\n            break;\n        default:\n            break;\n        }\n    }\n\n    // Make sure to kick the header again so that it shows reasonable sizing\n    slotFixSize();\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lotFixSize(",
          "args": [],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "slotFixSize(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "243-263",
          "snippet": "oid MsgListView::slotFixSize()\n{\n    if (!m_autoResizeSections)\n        return;\n\n    if (header()->visualIndex(Imap::Mailbox::MsgListModel::SEEN) == -1) {\n        // calling setResizeMode() would assert()\n        return;\n    }\n\n    header()->setStretchLastSection(false);\n    for (int i = 0; i < Imap::Mailbox::MsgListModel::COLUMN_COUNT; ++i) {\n        QHeaderView::ResizeMode resizeMode = resizeModeForColumn(i);\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n        header()->setSectionResizeMode(i, resizeMode);\n#else\n        header()->setResizeMode(i, resizeMode);\n#endif\n        setColumnWidth(i, sizeHintForColumn(i));\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotFixSize()\n  {\n      if (!m_autoResizeSections)\n          return;\n  \n      if (header()->visualIndex(Imap::Mailbox::MsgListModel::SEEN) == -1) {\n          // calling setResizeMode() would assert()\n          return;\n      }\n  \n      header()->setStretchLastSection(false);\n      for (int i = 0; i < Imap::Mailbox::MsgListModel::COLUMN_COUNT; ++i) {\n          QHeaderView::ResizeMode resizeMode = resizeModeForColumn(i);\n  #if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n          header()->setSectionResizeMode(i, resizeMode);\n  #else\n          header()->setResizeMode(i, resizeMode);\n  #endif\n          setColumnWidth(i, sizeHintForColumn(i));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ction->toggle",
          "args": [],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ction->setText",
          "args": [
            "r(\"Seen status\"))"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Seen status\")"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [
            "ction)"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "slotHeaderSectionVisibilityToggled(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "336-349",
          "snippet": "oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n{\n    QList<QAction *> actions = header()->actions();\n    if (section >= actions.size() || section < 0)\n        return;\n    bool hide = ! actions[section]->isChecked();\n\n    if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n        // This would hide the very last section, which would hide the whole header view\n        actions[section]->setChecked(true);\n    } else {\n        header()->setSectionHidden(section, hide);\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n  {\n      QList<QAction *> actions = header()->actions();\n      if (section >= actions.size() || section < 0)\n          return;\n      bool hide = ! actions[section]->isChecked();\n  \n      if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n          // This would hide the very last section, which would hide the whole header view\n          actions[section]->setChecked(true);\n      } else {\n          header()->setSectionHidden(section, hide);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader(",
          "args": [],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "asMailHeader(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "246-258",
          "snippet": "ByteArray MailAddress::asMailHeader() const\n{\n    QByteArray result = Imap::encodeRFC2047Phrase(name);\n\n    if (!result.isEmpty())\n        result.append(\" \");\n    \n    result.append(\"<\");\n    result.append(asSMTPMailbox());\n    result.append(\">\");\n\n    return result;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ByteArray MailAddress::asMailHeader() const\n  {\n      QByteArray result = Imap::encodeRFC2047Phrase(name);\n  \n      if (!result.isEmpty())\n          result.append(\" \");\n      \n      result.append(\"<\");\n      result.append(asSMTPMailbox());\n      result.append(\">\");\n  \n      return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eaderFieldsMapper->setMapping",
          "args": [
            "ction,",
            ")"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ction->setChecked",
          "args": [
            "rue)"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ction->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::number(",
          "args": [
            ")"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "slotViewMsgHeaders()\n{",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1732-1761",
          "snippet": "Window::slotViewMsgHeaders()\n{\n    Q_FOREACH(const QModelIndex &item, msgListWidget->tree->selectionModel()->selectedIndexes()) {\n        Q_ASSERT(item.isValid());\n        if (item.column() != 0)\n            continue;\n        if (! item.data(Imap::Mailbox::RoleMessageUid).isValid())\n            continue;\n        QModelIndex messageIndex = Imap::deproxifiedIndex(item);\n\n        Imap::Network::MsgPartNetAccessManager *netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n        netAccess->setModelMessage(messageIndex);\n\n        SimplePartWidget *headers = new SimplePartWidget(0, netAccess,\n                                        messageIndex.model()->index(0, Imap::Mailbox::TreeItem::OFFSET_HEADER, messageIndex),\n                                                         0);\n        headers->setAttribute(Qt::WA_DeleteOnClose);\n        connect(headers, SIGNAL(destroyed()), netAccess, SLOT(deleteLater()));\n        QAction *close = new QAction(loadIcon(QLatin1String(\"window-close\")), tr(\"Close\"), headers);\n        headers->addAction(close);\n        close->setShortcut(tr(\"Ctrl+W\"));\n        connect(close, SIGNAL(triggered()), headers, SLOT(close()));\n        headers->setWindowTitle(tr(\"Message headers of UID %1 in %2\").arg(\n                                    QString::number(messageIndex.data(Imap::Mailbox::RoleMessageUid).toUInt()),\n                                    messageIndex.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()\n                                    ));\n        headers->setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n        headers->show();\n    }\n}\n\n#ifdef",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotViewMsgHeaders()\n  {\n      Q_FOREACH(const QModelIndex &item, msgListWidget->tree->selectionModel()->selectedIndexes()) {\n          Q_ASSERT(item.isValid());\n          if (item.column() != 0)\n              continue;\n          if (! item.data(Imap::Mailbox::RoleMessageUid).isValid())\n              continue;\n          QModelIndex messageIndex = Imap::deproxifiedIndex(item);\n  \n          Imap::Network::MsgPartNetAccessManager *netAccess = new Imap::Network::MsgPartNetAccessManager(this);\n          netAccess->setModelMessage(messageIndex);\n  \n          SimplePartWidget *headers = new SimplePartWidget(0, netAccess,\n                                          messageIndex.model()->index(0, Imap::Mailbox::TreeItem::OFFSET_HEADER, messageIndex),\n                                                           0);\n          headers->setAttribute(Qt::WA_DeleteOnClose);\n          connect(headers, SIGNAL(destroyed()), netAccess, SLOT(deleteLater()));\n          QAction *close = new QAction(loadIcon(QLatin1String(\"window-close\")), tr(\"Close\"), headers);\n          headers->addAction(close);\n          close->setShortcut(tr(\"Ctrl+W\"));\n          connect(close, SIGNAL(triggered()), headers, SLOT(close()));\n          headers->setWindowTitle(tr(\"Message headers of UID %1 in %2\").arg(\n                                      QString::number(messageIndex.data(Imap::Mailbox::RoleMessageUid).toUInt()),\n                                      messageIndex.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()\n                                      ));\n          headers->setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n          headers->show();\n      }\n  }\n  \n  #ifdef\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [
            ",",
            "t::Horizontal)"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "processAdditionalHeaders(",
          "container": "reeItemMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1272-1291",
          "snippet": "oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n{\n    Imap::LowLevelParser::Rfc5322HeaderParser parser;\n    bool ok = parser.parse(rawHeaders);\n    if (!ok) {\n        model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                        QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n    }\n\n    data()->m_hdrReferences = parser.references;\n    if (!parser.listPost.isEmpty()) {\n        data()->m_hdrListPost.clear();\n        Q_FOREACH(const QByteArray &item, parser.listPost)\n            data()->m_hdrListPost << QUrl(item);\n    }\n    // That's right, this can only be set, not ever reset from this context.\n    // This is because we absolutely want to support incremental header arrival.\n    if (parser.listPostNo)\n        data()->m_hdrListPostNo = true;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemMessage {\n  oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n  {\n      Imap::LowLevelParser::Rfc5322HeaderParser parser;\n      bool ok = parser.parse(rawHeaders);\n      if (!ok) {\n          model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                          QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n      }\n  \n      data()->m_hdrReferences = parser.references;\n      if (!parser.listPost.isEmpty()) {\n          data()->m_hdrListPost.clear();\n          Q_FOREACH(const QByteArray &item, parser.listPost)\n              data()->m_hdrListPost << QUrl(item);\n      }\n      // That's right, this can only be set, not ever reset from this context.\n      // This is because we absolutely want to support incremental header arrival.\n      if (parser.listPostNo)\n          data()->m_hdrListPostNo = true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ctions.clear",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ction->deleteLater",
          "args": [],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderFieldsMapper->removeMappings",
          "args": [
            "ction)"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "eader())"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotSectionCountChanged()\n  {\n      Q_ASSERT(header());\n      // At first, remove all actions\n      QList<QAction *> actions = header()->actions();\n      Q_FOREACH(QAction *action, actions) {\n          header()->removeAction(action);\n          headerFieldsMapper->removeMappings(action);\n          action->deleteLater();\n      }\n      actions.clear();\n      // Now add them again\n      for (int i = 0; i < header()->count(); ++i) {\n          QString message = header()->model() ? header()->model()->headerData(i, Qt::Horizontal).toString() : QString::number(i);\n          QAction *action = new QAction(message, this);\n          action->setCheckable(true);\n          action->setChecked(true);\n          connect(action, SIGNAL(toggled(bool)), headerFieldsMapper, SLOT(map()));\n          headerFieldsMapper->setMapping(action, i);\n          header()->addAction(action);\n  \n          // Next, add some special handling of certain columns\n          switch (i) {\n          case Imap::Mailbox::MsgListModel::SEEN:\n              // This column doesn't have a textual description\n              action->setText(tr(\"Seen status\"));\n              break;\n          case Imap::Mailbox::MsgListModel::TO:\n          case Imap::Mailbox::MsgListModel::CC:\n          case Imap::Mailbox::MsgListModel::BCC:\n          case Imap::Mailbox::MsgListModel::RECEIVED_DATE:\n              // And these should be hidden by default\n              action->toggle();\n              break;\n          default:\n              break;\n          }\n      }\n  \n      // Make sure to kick the header again so that it shows reasonable sizing\n      slotFixSize();\n  }\n}"
  },
  {
    "function_name": "slotExpandWholeSubtree(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "277-291",
    "snippet": "oid MsgListView::slotExpandWholeSubtree(const QModelIndex &rootIndex)\n{\n    if (rootIndex.parent().isValid())\n        return;\n\n    QVector<QModelIndex> queue(1, rootIndex);\n    for (int i = 0; i < queue.size(); ++i) {\n        const QModelIndex currentIndex = queue[i];\n        // Append all children to the queue...\n        for (int j = 0; j < currentIndex.model()->rowCount(currentIndex); ++j)\n            queue.append(currentIndex.child(j, 0));\n        // ...and expand the current index\n        expand(currentIndex);\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xpand(",
          "args": [
            "urrentIndex)"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ueue.append",
          "args": [
            "urrentIndex.child(j, 0))"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndex.child",
          "args": [
            ",",
            ")"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndex.model",
          "args": [
            "urrentIndex)"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndex.model",
          "args": [],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ueue.size",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ootIndex.parent",
          "args": [],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "229-268",
          "snippet": "void ModelTest::parent()\n{\n    // Make sure the model wont crash and will return an invalid QModelIndex\n    // when asked for the parent of an invalid index.\n    Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // Column 0                | Column 1    |\n    // QModelIndex()           |             |\n    //    \\- topIndex          | topIndex1   |\n    //         \\- childIndex   | childIndex1 |\n\n    // Common error test #1, make sure that a top level index has a parent\n    // that is a invalid QModelIndex.\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    Q_ASSERT(model->parent(topIndex) == QModelIndex());\n\n    // Common error test #2, make sure that a second level index has a parent\n    // that is the first level index.\n    if (model->rowCount(topIndex) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        Q_ASSERT(model->parent(childIndex) == topIndex);\n    }\n\n    // Common error test #3, the second column should NOT have the same children\n    // as the first column in a row.\n    // Usually the second column shouldn't have children.\n    QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n    if (model->rowCount(topIndex1) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n        Q_ASSERT(childIndex != childIndex1);\n    }\n\n    // Full test, walk n levels deep through the model making sure that all\n    // parent's children correctly specify their parent.\n    checkChildren(QModelIndex());\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::parent()\n  {\n      // Make sure the model wont crash and will return an invalid QModelIndex\n      // when asked for the parent of an invalid index.\n      Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // Column 0                | Column 1    |\n      // QModelIndex()           |             |\n      //    \\- topIndex          | topIndex1   |\n      //         \\- childIndex   | childIndex1 |\n  \n      // Common error test #1, make sure that a top level index has a parent\n      // that is a invalid QModelIndex.\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      Q_ASSERT(model->parent(topIndex) == QModelIndex());\n  \n      // Common error test #2, make sure that a second level index has a parent\n      // that is the first level index.\n      if (model->rowCount(topIndex) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          Q_ASSERT(model->parent(childIndex) == topIndex);\n      }\n  \n      // Common error test #3, the second column should NOT have the same children\n      // as the first column in a row.\n      // Usually the second column shouldn't have children.\n      QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n      if (model->rowCount(topIndex1) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n          Q_ASSERT(childIndex != childIndex1);\n      }\n  \n      // Full test, walk n levels deep through the model making sure that all\n      // parent's children correctly specify their parent.\n      checkChildren(QModelIndex());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotExpandWholeSubtree(const QModelIndex &rootIndex)\n  {\n      if (rootIndex.parent().isValid())\n          return;\n  \n      QVector<QModelIndex> queue(1, rootIndex);\n      for (int i = 0; i < queue.size(); ++i) {\n          const QModelIndex currentIndex = queue[i];\n          // Append all children to the queue...\n          for (int j = 0; j < currentIndex.model()->rowCount(currentIndex); ++j)\n              queue.append(currentIndex.child(j, 0));\n          // ...and expand the current index\n          expand(currentIndex);\n      }\n  }\n}"
  },
  {
    "function_name": "resizeModeForColumn(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "265-275",
    "snippet": "HeaderView::ResizeMode MsgListView::resizeModeForColumn(const int column) const\n{\n    switch (column) {\n    case Imap::Mailbox::MsgListModel::SUBJECT:\n        return QHeaderView::Stretch;\n    case Imap::Mailbox::MsgListModel::SEEN:\n        return QHeaderView::Fixed;\n    default:\n        return QHeaderView::Interactive;\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  HeaderView::ResizeMode MsgListView::resizeModeForColumn(const int column) const\n  {\n      switch (column) {\n      case Imap::Mailbox::MsgListModel::SUBJECT:\n          return QHeaderView::Stretch;\n      case Imap::Mailbox::MsgListModel::SEEN:\n          return QHeaderView::Fixed;\n      default:\n          return QHeaderView::Interactive;\n      }\n  }\n}"
  },
  {
    "function_name": "slotFixSize(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "243-263",
    "snippet": "oid MsgListView::slotFixSize()\n{\n    if (!m_autoResizeSections)\n        return;\n\n    if (header()->visualIndex(Imap::Mailbox::MsgListModel::SEEN) == -1) {\n        // calling setResizeMode() would assert()\n        return;\n    }\n\n    header()->setStretchLastSection(false);\n    for (int i = 0; i < Imap::Mailbox::MsgListModel::COLUMN_COUNT; ++i) {\n        QHeaderView::ResizeMode resizeMode = resizeModeForColumn(i);\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n        header()->setSectionResizeMode(i, resizeMode);\n#else\n        header()->setResizeMode(i, resizeMode);\n#endif\n        setColumnWidth(i, sizeHintForColumn(i));\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etColumnWidth(",
          "args": [
            ",",
            "izeHintForColumn(i))"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "izeHintForColumn(",
          "args": [
            ")"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "sizeHintForColumn(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "117-145",
          "snippet": "nt MsgListView::sizeHintForColumn(int column) const\n{\n    QFont boldFont = font();\n    boldFont.setBold(true);\n    QFontMetrics metric(boldFont);\n    switch (column) {\n    case Imap::Mailbox::MsgListModel::SEEN:\n        return 16;\n    case Imap::Mailbox::MsgListModel::SUBJECT:\n        return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita Foo Bar Random Text\")).width();\n    case Imap::Mailbox::MsgListModel::FROM:\n    case Imap::Mailbox::MsgListModel::TO:\n    case Imap::Mailbox::MsgListModel::CC:\n    case Imap::Mailbox::MsgListModel::BCC:\n        return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita\")).width();\n    case Imap::Mailbox::MsgListModel::DATE:\n    case Imap::Mailbox::MsgListModel::RECEIVED_DATE:\n        return metric.size(Qt::TextSingleLine,\n                           //: Translators: use a text which is returned for e-mails older than one day but newer than one week\n                           //: (see Imap::Mailbox::PrettyMsgListModel::prettyFormatDate() for the string formats); the idea here\n                           //: is to have a text which is \"wide enough\" in a typical UI font.\n                           //: The English version uses \"Mon\" because of the M letter; you should use something similar.\n                           tr(\"Mon 10\")).width();\n    case Imap::Mailbox::MsgListModel::SIZE:\n        return metric.size(Qt::TextSingleLine, tr(\"88.8 kB\")).width();\n    default:\n        return QTreeView::sizeHintForColumn(column);\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  nt MsgListView::sizeHintForColumn(int column) const\n  {\n      QFont boldFont = font();\n      boldFont.setBold(true);\n      QFontMetrics metric(boldFont);\n      switch (column) {\n      case Imap::Mailbox::MsgListModel::SEEN:\n          return 16;\n      case Imap::Mailbox::MsgListModel::SUBJECT:\n          return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita Foo Bar Random Text\")).width();\n      case Imap::Mailbox::MsgListModel::FROM:\n      case Imap::Mailbox::MsgListModel::TO:\n      case Imap::Mailbox::MsgListModel::CC:\n      case Imap::Mailbox::MsgListModel::BCC:\n          return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita\")).width();\n      case Imap::Mailbox::MsgListModel::DATE:\n      case Imap::Mailbox::MsgListModel::RECEIVED_DATE:\n          return metric.size(Qt::TextSingleLine,\n                             //: Translators: use a text which is returned for e-mails older than one day but newer than one week\n                             //: (see Imap::Mailbox::PrettyMsgListModel::prettyFormatDate() for the string formats); the idea here\n                             //: is to have a text which is \"wide enough\" in a typical UI font.\n                             //: The English version uses \"Mon\" because of the M letter; you should use something similar.\n                             tr(\"Mon 10\")).width();\n      case Imap::Mailbox::MsgListModel::SIZE:\n          return metric.size(Qt::TextSingleLine, tr(\"88.8 kB\")).width();\n      default:\n          return QTreeView::sizeHintForColumn(column);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [
            ",",
            "esizeMode)"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "processAdditionalHeaders(",
          "container": "reeItemMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1272-1291",
          "snippet": "oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n{\n    Imap::LowLevelParser::Rfc5322HeaderParser parser;\n    bool ok = parser.parse(rawHeaders);\n    if (!ok) {\n        model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                        QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n    }\n\n    data()->m_hdrReferences = parser.references;\n    if (!parser.listPost.isEmpty()) {\n        data()->m_hdrListPost.clear();\n        Q_FOREACH(const QByteArray &item, parser.listPost)\n            data()->m_hdrListPost << QUrl(item);\n    }\n    // That's right, this can only be set, not ever reset from this context.\n    // This is because we absolutely want to support incremental header arrival.\n    if (parser.listPostNo)\n        data()->m_hdrListPostNo = true;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemMessage {\n  oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n  {\n      Imap::LowLevelParser::Rfc5322HeaderParser parser;\n      bool ok = parser.parse(rawHeaders);\n      if (!ok) {\n          model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                          QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n      }\n  \n      data()->m_hdrReferences = parser.references;\n      if (!parser.listPost.isEmpty()) {\n          data()->m_hdrListPost.clear();\n          Q_FOREACH(const QByteArray &item, parser.listPost)\n              data()->m_hdrListPost << QUrl(item);\n      }\n      // That's right, this can only be set, not ever reset from this context.\n      // This is because we absolutely want to support incremental header arrival.\n      if (parser.listPostNo)\n          data()->m_hdrListPostNo = true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader(",
          "args": [],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "asMailHeader(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "246-258",
          "snippet": "ByteArray MailAddress::asMailHeader() const\n{\n    QByteArray result = Imap::encodeRFC2047Phrase(name);\n\n    if (!result.isEmpty())\n        result.append(\" \");\n    \n    result.append(\"<\");\n    result.append(asSMTPMailbox());\n    result.append(\">\");\n\n    return result;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ByteArray MailAddress::asMailHeader() const\n  {\n      QByteArray result = Imap::encodeRFC2047Phrase(name);\n  \n      if (!result.isEmpty())\n          result.append(\" \");\n      \n      result.append(\"<\");\n      result.append(asSMTPMailbox());\n      result.append(\">\");\n  \n      return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esizeModeForColumn(",
          "args": [
            ")"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "resizeModeForColumn(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "265-275",
          "snippet": "HeaderView::ResizeMode MsgListView::resizeModeForColumn(const int column) const\n{\n    switch (column) {\n    case Imap::Mailbox::MsgListModel::SUBJECT:\n        return QHeaderView::Stretch;\n    case Imap::Mailbox::MsgListModel::SEEN:\n        return QHeaderView::Fixed;\n    default:\n        return QHeaderView::Interactive;\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  HeaderView::ResizeMode MsgListView::resizeModeForColumn(const int column) const\n  {\n      switch (column) {\n      case Imap::Mailbox::MsgListModel::SUBJECT:\n          return QHeaderView::Stretch;\n      case Imap::Mailbox::MsgListModel::SEEN:\n          return QHeaderView::Fixed;\n      default:\n          return QHeaderView::Interactive;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [
            "alse)"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "slotHeaderSectionVisibilityToggled(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "336-349",
          "snippet": "oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n{\n    QList<QAction *> actions = header()->actions();\n    if (section >= actions.size() || section < 0)\n        return;\n    bool hide = ! actions[section]->isChecked();\n\n    if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n        // This would hide the very last section, which would hide the whole header view\n        actions[section]->setChecked(true);\n    } else {\n        header()->setSectionHidden(section, hide);\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n  {\n      QList<QAction *> actions = header()->actions();\n      if (section >= actions.size() || section < 0)\n          return;\n      bool hide = ! actions[section]->isChecked();\n  \n      if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n          // This would hide the very last section, which would hide the whole header view\n          actions[section]->setChecked(true);\n      } else {\n          header()->setSectionHidden(section, hide);\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotFixSize()\n  {\n      if (!m_autoResizeSections)\n          return;\n  \n      if (header()->visualIndex(Imap::Mailbox::MsgListModel::SEEN) == -1) {\n          // calling setResizeMode() would assert()\n          return;\n      }\n  \n      header()->setStretchLastSection(false);\n      for (int i = 0; i < Imap::Mailbox::MsgListModel::COLUMN_COUNT; ++i) {\n          QHeaderView::ResizeMode resizeMode = resizeModeForColumn(i);\n  #if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n          header()->setSectionResizeMode(i, resizeMode);\n  #else\n          header()->setResizeMode(i, resizeMode);\n  #endif\n          setColumnWidth(i, sizeHintForColumn(i));\n      }\n  }\n}"
  },
  {
    "function_name": "startDrag(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "153-241",
    "snippet": "oid MsgListView::startDrag(Qt::DropActions supportedActions)\n{\n    // indexes for column 0, i.e. subject\n    QModelIndexList baseIndexes;\n\n    Q_FOREACH(const QModelIndex &index, selectedIndexes()) {\n        if (!(model()->flags(index) & Qt::ItemIsDragEnabled))\n            continue;\n        if (index.column() == Imap::Mailbox::MsgListModel::SUBJECT)\n            baseIndexes << index;\n    }\n\n    if (!baseIndexes.isEmpty()) {\n        QMimeData *data = model()->mimeData(baseIndexes);\n        if (!data)\n            return;\n\n        // use screen width and itemDelegate()->sizeHint() to determine size of the pixmap\n        int screenWidth = QApplication::desktop()->screenGeometry(this).width();\n        int maxWidth = qMax(400, screenWidth / 4);\n        QSize size(maxWidth, 0);\n\n        // Show a \"+ X more items\" text after so many entries\n        const int maxItems = 20;\n\n        QStyleOptionViewItem opt;\n        opt.initFrom(this);\n        opt.rect.setWidth(maxWidth);\n        opt.rect.setHeight(itemDelegate()->sizeHint(opt, baseIndexes.at(0)).height());\n        size.setHeight(qMin(maxItems + 1, baseIndexes.size()) * opt.rect.height());\n        // State_Selected provides for nice background of the items\n        opt.state |= QStyle::State_Selected;\n\n        // paint list of selected items using itemDelegate() to be consistent with style\n        QPixmap pixmap(size);\n        pixmap.fill(Qt::transparent);\n        QPainter p(&pixmap);\n\n        for (int i = 0; i < baseIndexes.size(); ++i) {\n            opt.rect.moveTop(i * opt.rect.height());\n            if (i == maxItems) {\n                p.fillRect(opt.rect, palette().color(QPalette::Disabled, QPalette::Highlight));\n                p.setBrush(palette().color(QPalette::Disabled, QPalette::HighlightedText));\n                p.drawText(opt.rect, Qt::AlignRight, tr(\"+ %n additional item(s)\", 0, baseIndexes.size() - maxItems));\n                break;\n            }\n            itemDelegate()->paint(&p, opt, baseIndexes.at(i));\n        }\n\n        QDrag *drag = new QDrag(this);\n        drag->setPixmap(pixmap);\n        drag->setMimeData(data);\n        drag->setHotSpot(QPoint(0, 0));\n\n        Qt::DropAction dropAction = Qt::IgnoreAction;\n        if (defaultDropAction() != Qt::IgnoreAction && (supportedActions & defaultDropAction()))\n            dropAction = defaultDropAction();\n        else if (supportedActions & Qt::CopyAction && dragDropMode() != QAbstractItemView::InternalMove)\n            dropAction = Qt::CopyAction;\n        if (drag->exec(supportedActions, dropAction) == Qt::MoveAction) {\n            // QAbstractItemView::startDrag calls d->clearOrRemove() here, so\n            // this is a copy of QAbstractItemModelPrivate::clearOrRemove();\n            const QItemSelection selection = selectionModel()->selection();\n            QList<QItemSelectionRange>::const_iterator it = selection.constBegin();\n\n            if (!dragDropOverwriteMode()) {\n                for (; it != selection.constEnd(); ++it) {\n                    QModelIndex parent = it->parent();\n                    if (it->left() != 0)\n                        continue;\n                    if (it->right() != (model()->columnCount(parent) - 1))\n                        continue;\n                    int count = it->bottom() - it->top() + 1;\n                    model()->removeRows(it->top(), count, parent);\n                }\n            } else {\n                // we can't remove the rows so reset the items (i.e. the view is like a table)\n                QModelIndexList list = selection.indexes();\n                for (int i = 0; i < list.size(); ++i) {\n                    QModelIndex index = list.at(i);\n                    QMap<int, QVariant> roles = model()->itemData(index);\n                    for (QMap<int, QVariant>::Iterator it = roles.begin(); it != roles.end(); ++it)\n                        it.value() = QVariant();\n                    model()->setItemData(index, roles);\n                }\n            }\n        }\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "odel",
          "args": [
            "ndex,",
            "oles)"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "data(",
          "container": "romAddressProxyModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FromAddressProxyModel.cpp",
          "lines": "47-60",
          "snippet": "Variant FromAddressProxyModel::data(const QModelIndex &index, int role) const\n{\n    if (!index.isValid())\n        return QVariant();\n    if (role != Qt::DisplayRole && role != Qt::EditRole)\n        return QSortFilterProxyModel::data(index, role);\n    QModelIndex sourceIndex = mapToSource(index);\n    Q_ASSERT(sourceIndex.isValid());\n    QModelIndex nameIndex = sourceIndex.sibling(sourceIndex.row(), Composer::SenderIdentitiesModel::COLUMN_NAME);\n    QModelIndex emailIndex = sourceIndex.sibling(sourceIndex.row(), Composer::SenderIdentitiesModel::COLUMN_EMAIL);\n    Q_ASSERT(nameIndex.isValid());\n    Q_ASSERT(emailIndex.isValid());\n    return QString::fromUtf8(\"%1 <%2>\").arg(nameIndex.data().toString(), emailIndex.data().toString());\n}",
          "includes": [
            "include \"Composer/SenderIdentitiesModel.h\"",
            "include \"FromAddressProxyModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Composer/SenderIdentitiesModel.h\"\ninclude \"FromAddressProxyModel.h\"\n#\n\nromAddressProxyModel {\n  Variant FromAddressProxyModel::data(const QModelIndex &index, int role) const\n  {\n      if (!index.isValid())\n          return QVariant();\n      if (role != Qt::DisplayRole && role != Qt::EditRole)\n          return QSortFilterProxyModel::data(index, role);\n      QModelIndex sourceIndex = mapToSource(index);\n      Q_ASSERT(sourceIndex.isValid());\n      QModelIndex nameIndex = sourceIndex.sibling(sourceIndex.row(), Composer::SenderIdentitiesModel::COLUMN_NAME);\n      QModelIndex emailIndex = sourceIndex.sibling(sourceIndex.row(), Composer::SenderIdentitiesModel::COLUMN_EMAIL);\n      Q_ASSERT(nameIndex.isValid());\n      Q_ASSERT(emailIndex.isValid());\n      return QString::fromUtf8(\"%1 <%2>\").arg(nameIndex.data().toString(), emailIndex.data().toString());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "odel(",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "~SubtreeModel(",
          "container": "ubtreeModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/SubtreeModel.cpp",
          "lines": "73-76",
          "snippet": "ubtreeModel::~SubtreeModel()\n{\n    delete m_classAdaptor;\n}",
          "includes": [
            "include \"QAIM_reset.h\"",
            "include \"Model.h\"\n#",
            "include \"MailboxModel.h\"\n#",
            "include \"SubtreeModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"QAIM_reset.h\"\ninclude \"Model.h\"\n#\ninclude \"MailboxModel.h\"\n#\ninclude \"SubtreeModel.h\"\n#\n\nubtreeModel {\n  ubtreeModel::~SubtreeModel()\n  {\n      delete m_classAdaptor;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t.value",
          "args": [],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "333-336",
          "snippet": "QByteArray QMimeMagicRule::value() const\n{\n    return d->value;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QByteArray QMimeMagicRule::value() const\n  {\n      return d->value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "oles.end",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oles.begin",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel",
          "args": [
            "ndex)"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "setModel(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "365-378",
          "snippet": "oid MsgListView::setModel(QAbstractItemModel *model)\n{\n    if (this->model()) {\n        if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(this->model())) {\n            disconnect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                       this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n        }\n    }\n    QTreeView::setModel(model);\n    if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(model)) {\n        connect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::setModel(QAbstractItemModel *model)\n  {\n      if (this->model()) {\n          if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(this->model())) {\n              disconnect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                         this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n          }\n      }\n      QTreeView::setModel(model);\n      if (Imap::Mailbox::PrettyMsgListModel *prettyModel = findPrettyMsgListModel(model)) {\n          connect(prettyModel, SIGNAL(sortingPreferenceChanged(int,Qt::SortOrder)),\n                  this, SLOT(slotHandleSortCriteriaChanged(int,Qt::SortOrder)));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ist.at",
          "args": [
            ")"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ist.size",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "election.indexes",
          "args": [],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel",
          "args": [
            "t->top(),",
            "ount,",
            "arent)"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "umpModelContents(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/TaskPresentationModel.cpp",
          "lines": "281-292",
          "snippet": "oid dumpModelContents(QAbstractItemModel *model, QModelIndex index, int offset)\n{\n    qDebug() << QByteArray().fill(' ', offset) << index.data(Qt::DisplayRole).toString();\n    for (int i=0; i < model->rowCount(index); ++i) {\n        QModelIndex child = model->index(i, 0, index);\n        if (!child.isValid()) {\n            qDebug() << \"FAIL: \" << index << child << i << model->rowCount(index);\n        }\n        Q_ASSERT(child.isValid());\n        dumpModelContents(model, child, offset + 1);\n    }\n}",
          "includes": [
            "include \"QAIM_reset.h\"",
            "include \"Model.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/UnSelectTask.h\"\n#",
            "include \"Imap/Tasks/SortTask.h\"\n#",
            "include \"Imap/Tasks/OpenConnectionTask.h\"\n#",
            "include \"Imap/Tasks/NoopTask.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Tasks/GetAnyConnectionTask.h\"\n#",
            "include \"TaskPresentationModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"QAIM_reset.h\"\ninclude \"Model.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/UnSelectTask.h\"\n#\ninclude \"Imap/Tasks/SortTask.h\"\n#\ninclude \"Imap/Tasks/OpenConnectionTask.h\"\n#\ninclude \"Imap/Tasks/NoopTask.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Tasks/GetAnyConnectionTask.h\"\n#\ninclude \"TaskPresentationModel.h\"\n#\n\noid dumpModelContents(QAbstractItemModel *model, QModelIndex index, int offset)\n{\n    qDebug() << QByteArray().fill(' ', offset) << index.data(Qt::DisplayRole).toString();\n    for (int i=0; i < model->rowCount(index); ++i) {\n        QModelIndex child = model->index(i, 0, index);\n        if (!child.isValid()) {\n            qDebug() << \"FAIL: \" << index << child << i << model->rowCount(index);\n        }\n        Q_ASSERT(child.isValid());\n        dumpModelContents(model, child, offset + 1);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "t->top",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->top",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->bottom",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->right",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->left",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->parent",
          "args": [],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "229-268",
          "snippet": "void ModelTest::parent()\n{\n    // Make sure the model wont crash and will return an invalid QModelIndex\n    // when asked for the parent of an invalid index.\n    Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // Column 0                | Column 1    |\n    // QModelIndex()           |             |\n    //    \\- topIndex          | topIndex1   |\n    //         \\- childIndex   | childIndex1 |\n\n    // Common error test #1, make sure that a top level index has a parent\n    // that is a invalid QModelIndex.\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    Q_ASSERT(model->parent(topIndex) == QModelIndex());\n\n    // Common error test #2, make sure that a second level index has a parent\n    // that is the first level index.\n    if (model->rowCount(topIndex) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        Q_ASSERT(model->parent(childIndex) == topIndex);\n    }\n\n    // Common error test #3, the second column should NOT have the same children\n    // as the first column in a row.\n    // Usually the second column shouldn't have children.\n    QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n    if (model->rowCount(topIndex1) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n        Q_ASSERT(childIndex != childIndex1);\n    }\n\n    // Full test, walk n levels deep through the model making sure that all\n    // parent's children correctly specify their parent.\n    checkChildren(QModelIndex());\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::parent()\n  {\n      // Make sure the model wont crash and will return an invalid QModelIndex\n      // when asked for the parent of an invalid index.\n      Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // Column 0                | Column 1    |\n      // QModelIndex()           |             |\n      //    \\- topIndex          | topIndex1   |\n      //         \\- childIndex   | childIndex1 |\n  \n      // Common error test #1, make sure that a top level index has a parent\n      // that is a invalid QModelIndex.\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      Q_ASSERT(model->parent(topIndex) == QModelIndex());\n  \n      // Common error test #2, make sure that a second level index has a parent\n      // that is the first level index.\n      if (model->rowCount(topIndex) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          Q_ASSERT(model->parent(childIndex) == topIndex);\n      }\n  \n      // Common error test #3, the second column should NOT have the same children\n      // as the first column in a row.\n      // Usually the second column shouldn't have children.\n      QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n      if (model->rowCount(topIndex1) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n          Q_ASSERT(childIndex != childIndex1);\n      }\n  \n      // Full test, walk n levels deep through the model making sure that all\n      // parent's children correctly specify their parent.\n      checkChildren(QModelIndex());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "election.constEnd",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ragDropOverwriteMode(",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "election.constBegin",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "electionModel",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "electionModel(",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rag->exec",
          "args": [
            "upportedActions,",
            "ropAction)"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ragDropMode(",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efaultDropAction(",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efaultDropAction(",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efaultDropAction(",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rag->setHotSpot",
          "args": [
            "Point(0, 0))"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Point(",
          "args": [
            ",",
            ")"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rag->setMimeData",
          "args": [
            "ata)"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rag->setPixmap",
          "args": [
            "ixmap)"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temDelegate",
          "args": [
            "p,",
            "pt,",
            "aseIndexes.at(i))"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aseIndexes.at",
          "args": [
            ")"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temDelegate(",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".drawText",
          "args": [
            "pt.rect,",
            "t::AlignRight,",
            "r(\"+ %n additional item(s)\", 0, baseIndexes.size() - maxItems))"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "+ %n additional item(s)\",",
            ",",
            "aseIndexes.size() - maxItems)"
          ],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "ReplaceCharValidator(",
          "container": "eplaceCharValidator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ReplaceCharValidator.cpp",
          "lines": "27-30",
          "snippet": "eplaceCharValidator::ReplaceCharValidator(const QChar replaceWhat, const QChar replaceBy, QObject *parent):\n    QValidator(parent), m_replaceWhat(replaceWhat), m_replaceBy(replaceBy)\n{\n}",
          "includes": [
            "include \"ReplaceCharValidator.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"ReplaceCharValidator.h\"\n\neplaceCharValidator {\n  eplaceCharValidator::ReplaceCharValidator(const QChar replaceWhat, const QChar replaceBy, QObject *parent):\n      QValidator(parent), m_replaceWhat(replaceWhat), m_replaceBy(replaceBy)\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "aseIndexes.size",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".setBrush",
          "args": [
            "alette().color(QPalette::Disabled, QPalette::HighlightedText))"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "Palette::Disabled,",
            "Palette::HighlightedText)"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".fillRect",
          "args": [
            "pt.rect,",
            "alette().color(QPalette::Disabled, QPalette::Highlight))"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette",
          "args": [
            "Palette::Disabled,",
            "Palette::Highlight)"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette(",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pt.rect.moveTop",
          "args": [
            "* opt.rect.height())"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pt.rect.height",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aseIndexes.size",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmap.fill",
          "args": [
            "t::transparent)"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ize.setHeight",
          "args": [
            "Min(maxItems + 1, baseIndexes.size()) * opt.rect.height())"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pt.rect.height",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Min(",
          "args": [
            "axItems + 1,",
            "aseIndexes.size())"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aseIndexes.size",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pt.rect.setHeight",
          "args": [
            "temDelegate()->sizeHint(opt, baseIndexes.at(0)).height())"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temDelegate",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temDelegate",
          "args": [
            "pt,",
            "aseIndexes.at(0))"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aseIndexes.at",
          "args": [
            ")"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temDelegate(",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pt.rect.setWidth",
          "args": [
            "axWidth)"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pt.initFrom",
          "args": [
            "his)"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Max(",
          "args": [
            "00,",
            "creenWidth / 4)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::desktop",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::desktop",
          "args": [
            "his)"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::desktop(",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aseIndexes.isEmpty",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.column",
          "args": [],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::startDrag(Qt::DropActions supportedActions)\n  {\n      // indexes for column 0, i.e. subject\n      QModelIndexList baseIndexes;\n  \n      Q_FOREACH(const QModelIndex &index, selectedIndexes()) {\n          if (!(model()->flags(index) & Qt::ItemIsDragEnabled))\n              continue;\n          if (index.column() == Imap::Mailbox::MsgListModel::SUBJECT)\n              baseIndexes << index;\n      }\n  \n      if (!baseIndexes.isEmpty()) {\n          QMimeData *data = model()->mimeData(baseIndexes);\n          if (!data)\n              return;\n  \n          // use screen width and itemDelegate()->sizeHint() to determine size of the pixmap\n          int screenWidth = QApplication::desktop()->screenGeometry(this).width();\n          int maxWidth = qMax(400, screenWidth / 4);\n          QSize size(maxWidth, 0);\n  \n          // Show a \"+ X more items\" text after so many entries\n          const int maxItems = 20;\n  \n          QStyleOptionViewItem opt;\n          opt.initFrom(this);\n          opt.rect.setWidth(maxWidth);\n          opt.rect.setHeight(itemDelegate()->sizeHint(opt, baseIndexes.at(0)).height());\n          size.setHeight(qMin(maxItems + 1, baseIndexes.size()) * opt.rect.height());\n          // State_Selected provides for nice background of the items\n          opt.state |= QStyle::State_Selected;\n  \n          // paint list of selected items using itemDelegate() to be consistent with style\n          QPixmap pixmap(size);\n          pixmap.fill(Qt::transparent);\n          QPainter p(&pixmap);\n  \n          for (int i = 0; i < baseIndexes.size(); ++i) {\n              opt.rect.moveTop(i * opt.rect.height());\n              if (i == maxItems) {\n                  p.fillRect(opt.rect, palette().color(QPalette::Disabled, QPalette::Highlight));\n                  p.setBrush(palette().color(QPalette::Disabled, QPalette::HighlightedText));\n                  p.drawText(opt.rect, Qt::AlignRight, tr(\"+ %n additional item(s)\", 0, baseIndexes.size() - maxItems));\n                  break;\n              }\n              itemDelegate()->paint(&p, opt, baseIndexes.at(i));\n          }\n  \n          QDrag *drag = new QDrag(this);\n          drag->setPixmap(pixmap);\n          drag->setMimeData(data);\n          drag->setHotSpot(QPoint(0, 0));\n  \n          Qt::DropAction dropAction = Qt::IgnoreAction;\n          if (defaultDropAction() != Qt::IgnoreAction && (supportedActions & defaultDropAction()))\n              dropAction = defaultDropAction();\n          else if (supportedActions & Qt::CopyAction && dragDropMode() != QAbstractItemView::InternalMove)\n              dropAction = Qt::CopyAction;\n          if (drag->exec(supportedActions, dropAction) == Qt::MoveAction) {\n              // QAbstractItemView::startDrag calls d->clearOrRemove() here, so\n              // this is a copy of QAbstractItemModelPrivate::clearOrRemove();\n              const QItemSelection selection = selectionModel()->selection();\n              QList<QItemSelectionRange>::const_iterator it = selection.constBegin();\n  \n              if (!dragDropOverwriteMode()) {\n                  for (; it != selection.constEnd(); ++it) {\n                      QModelIndex parent = it->parent();\n                      if (it->left() != 0)\n                          continue;\n                      if (it->right() != (model()->columnCount(parent) - 1))\n                          continue;\n                      int count = it->bottom() - it->top() + 1;\n                      model()->removeRows(it->top(), count, parent);\n                  }\n              } else {\n                  // we can't remove the rows so reset the items (i.e. the view is like a table)\n                  QModelIndexList list = selection.indexes();\n                  for (int i = 0; i < list.size(); ++i) {\n                      QModelIndex index = list.at(i);\n                      QMap<int, QVariant> roles = model()->itemData(index);\n                      for (QMap<int, QVariant>::Iterator it = roles.begin(); it != roles.end(); ++it)\n                          it.value() = QVariant();\n                      model()->setItemData(index, roles);\n                  }\n              }\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "sizeHintForColumn(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "117-145",
    "snippet": "nt MsgListView::sizeHintForColumn(int column) const\n{\n    QFont boldFont = font();\n    boldFont.setBold(true);\n    QFontMetrics metric(boldFont);\n    switch (column) {\n    case Imap::Mailbox::MsgListModel::SEEN:\n        return 16;\n    case Imap::Mailbox::MsgListModel::SUBJECT:\n        return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita Foo Bar Random Text\")).width();\n    case Imap::Mailbox::MsgListModel::FROM:\n    case Imap::Mailbox::MsgListModel::TO:\n    case Imap::Mailbox::MsgListModel::CC:\n    case Imap::Mailbox::MsgListModel::BCC:\n        return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita\")).width();\n    case Imap::Mailbox::MsgListModel::DATE:\n    case Imap::Mailbox::MsgListModel::RECEIVED_DATE:\n        return metric.size(Qt::TextSingleLine,\n                           //: Translators: use a text which is returned for e-mails older than one day but newer than one week\n                           //: (see Imap::Mailbox::PrettyMsgListModel::prettyFormatDate() for the string formats); the idea here\n                           //: is to have a text which is \"wide enough\" in a typical UI font.\n                           //: The English version uses \"Mon\" because of the M letter; you should use something similar.\n                           tr(\"Mon 10\")).width();\n    case Imap::Mailbox::MsgListModel::SIZE:\n        return metric.size(Qt::TextSingleLine, tr(\"88.8 kB\")).width();\n    default:\n        return QTreeView::sizeHintForColumn(column);\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TreeView::sizeHintForColumn(",
          "args": [
            "olumn)"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "sizeHintForColumn(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "117-145",
          "snippet": "nt MsgListView::sizeHintForColumn(int column) const\n{\n    QFont boldFont = font();\n    boldFont.setBold(true);\n    QFontMetrics metric(boldFont);\n    switch (column) {\n    case Imap::Mailbox::MsgListModel::SEEN:\n        return 16;\n    case Imap::Mailbox::MsgListModel::SUBJECT:\n        return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita Foo Bar Random Text\")).width();\n    case Imap::Mailbox::MsgListModel::FROM:\n    case Imap::Mailbox::MsgListModel::TO:\n    case Imap::Mailbox::MsgListModel::CC:\n    case Imap::Mailbox::MsgListModel::BCC:\n        return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita\")).width();\n    case Imap::Mailbox::MsgListModel::DATE:\n    case Imap::Mailbox::MsgListModel::RECEIVED_DATE:\n        return metric.size(Qt::TextSingleLine,\n                           //: Translators: use a text which is returned for e-mails older than one day but newer than one week\n                           //: (see Imap::Mailbox::PrettyMsgListModel::prettyFormatDate() for the string formats); the idea here\n                           //: is to have a text which is \"wide enough\" in a typical UI font.\n                           //: The English version uses \"Mon\" because of the M letter; you should use something similar.\n                           tr(\"Mon 10\")).width();\n    case Imap::Mailbox::MsgListModel::SIZE:\n        return metric.size(Qt::TextSingleLine, tr(\"88.8 kB\")).width();\n    default:\n        return QTreeView::sizeHintForColumn(column);\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "etric.size",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etric.size",
          "args": [
            "t::TextSingleLine,",
            "r(\"88.8 kB\"))"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "88.8 kB\")"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "etric.size",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etric.size",
          "args": [
            "t::TextSingleLine,",
            "/: Translators: use a text which is returned for e-mails older than one day but newer than one week\n/: (see Imap::Mailbox::PrettyMsgListModel::prettyFormatDate() for the string formats); the idea here\n/: is to have a text which is \"wide enough\" in a typical UI font.\n/: The English version uses \"Mon\" because of the M letter; you should use something similar.\nr(\"Mon 10\"))"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etric.size",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etric.size",
          "args": [
            "t::TextSingleLine,",
            "Latin1String(\"Blesmrt Trojita\"))"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Blesmrt Trojita\")"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etric.size",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etric.size",
          "args": [
            "t::TextSingleLine,",
            "Latin1String(\"Blesmrt Trojita Foo Bar Random Text\"))"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Blesmrt Trojita Foo Bar Random Text\")"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oldFont.setBold",
          "args": [
            "rue)"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ont(",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "ystemMonospaceFont(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Util.cpp",
          "lines": "148-214",
          "snippet": "Font systemMonospaceFont()\n{\n    static bool initialized = false;\n    static QFont font;\n\n    if (!initialized) {\n        if (isRunningKde4()) {\n            // This part was shamelessly inspired by Qt4's src/gui/kernel/qapplication_x11.cpp\n            QSettings kdeSettings(::kdeHome() + QLatin1String(\"/share/config/kdeglobals\"), QSettings::IniFormat);\n            QLatin1String confKey(\"fixed\");\n            QString fontDescription = kdeSettings.value(confKey).toStringList().join(QLatin1String(\",\"));\n            if (fontDescription.isEmpty())\n                fontDescription = kdeSettings.value(confKey).toString();\n            initialized = !fontDescription.isEmpty() && font.fromString(fontDescription);\n        } else if (isRunningGnome() || isRunningXfce()) {\n            // Under Gnome and Xfce, we can read the preferred font in yet another format via gconftool-2\n            QByteArray fontDescription;\n            do {\n                QProcess gconf;\n                gconf.start(QLatin1String(\"gconftool-2\"),\n                            QStringList() << QLatin1String(\"--get\") << QLatin1String(\"/desktop/gnome/interface/monospace_font_name\"));\n                if (!gconf.waitForStarted())\n                    break;\n                gconf.closeWriteChannel();\n                if (!gconf.waitForFinished())\n                    break;\n                fontDescription = gconf.readAllStandardOutput();\n                fontDescription = fontDescription.trimmed();\n            } while (0);\n\n            // This value is apparently supposed to be parsed via the pango_font_description_from_string function. We, of course,\n            // do not link with Pango, so we attempt to do a very crude parsing experiment by hand.\n            // This code does *not* handle many fancy options like specifying the font size in pixels, parsing the bold/italics\n            // options etc. It will also very likely break when the user has specified preefrences for more than one font family.\n            // However, I hope it's better to try to do something than ignoring the problem altogether.\n            int lastSpace = fontDescription.lastIndexOf(' ');\n            bool ok;\n            double size = fontDescription.mid(lastSpace).toDouble(&ok);\n            if (lastSpace > 0 && ok) {\n                font = QFont(fontDescription.left(lastSpace), size);\n                initialized = true;\n            }\n        }\n    }\n\n    if (!initialized) {\n        // Ok, that failed, let's create some fallback font.\n        // The problem is that these names wary acros platforms,\n        // but the following works well -- at first, we come up with a made-up name, and then\n        // let the Qt font substitution algorithm do its magic.\n        font = QFont(QLatin1String(\"x-trojita-terminus-like-fixed-width\"));\n        // Using QFont::Monospace results in a proportional font on jkt's system\n        font.setStyleHint(QFont::TypeWriter);\n\n        // Gnome, Mac and perhaps everyone else uses 10pt as the default font size, so let's use that as well\n        int defaultPointSize = 10;\n        if (isRunningKde4()) {\n            // kdeui/kernel/kglobalsettings.cpp from KDELIBS sets default fixed font size to 9 on X11. Let's hope nobody runs\n            // this desktop-GUI-specific code *with KDE* under Harmattan or Mac. Seriously.\n            defaultPointSize = 9;\n\n        }\n        font.setPointSize(defaultPointSize);\n    }\n\n    return font;\n}",
          "includes": [
            "include \"Window.h\"",
            "include \"Util.h\"\n#",
            "include \"configure.cmake.h\"\n#",
            "include <QSettings>",
            "include <QProcess>\n#",
            "include <QIcon>\n#",
            "include <QGridLayout>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget> // for Util::centerWidgetOnScreen\n#",
            "include <QCursor> // for Util::centerWidgetOnScreen\n#",
            "include <QCheckBox>\n#",
            "include <QBuffer>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Window.h\"\ninclude \"Util.h\"\n#\ninclude \"configure.cmake.h\"\n#\ninclude <QSettings>\ninclude <QProcess>\n#\ninclude <QIcon>\n#\ninclude <QGridLayout>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget> // for Util::centerWidgetOnScreen\n#\ninclude <QCursor> // for Util::centerWidgetOnScreen\n#\ninclude <QCheckBox>\n#\ninclude <QBuffer>\n#\ninclude <QApplication>\n#\n\nFont systemMonospaceFont()\n{\n    static bool initialized = false;\n    static QFont font;\n\n    if (!initialized) {\n        if (isRunningKde4()) {\n            // This part was shamelessly inspired by Qt4's src/gui/kernel/qapplication_x11.cpp\n            QSettings kdeSettings(::kdeHome() + QLatin1String(\"/share/config/kdeglobals\"), QSettings::IniFormat);\n            QLatin1String confKey(\"fixed\");\n            QString fontDescription = kdeSettings.value(confKey).toStringList().join(QLatin1String(\",\"));\n            if (fontDescription.isEmpty())\n                fontDescription = kdeSettings.value(confKey).toString();\n            initialized = !fontDescription.isEmpty() && font.fromString(fontDescription);\n        } else if (isRunningGnome() || isRunningXfce()) {\n            // Under Gnome and Xfce, we can read the preferred font in yet another format via gconftool-2\n            QByteArray fontDescription;\n            do {\n                QProcess gconf;\n                gconf.start(QLatin1String(\"gconftool-2\"),\n                            QStringList() << QLatin1String(\"--get\") << QLatin1String(\"/desktop/gnome/interface/monospace_font_name\"));\n                if (!gconf.waitForStarted())\n                    break;\n                gconf.closeWriteChannel();\n                if (!gconf.waitForFinished())\n                    break;\n                fontDescription = gconf.readAllStandardOutput();\n                fontDescription = fontDescription.trimmed();\n            } while (0);\n\n            // This value is apparently supposed to be parsed via the pango_font_description_from_string function. We, of course,\n            // do not link with Pango, so we attempt to do a very crude parsing experiment by hand.\n            // This code does *not* handle many fancy options like specifying the font size in pixels, parsing the bold/italics\n            // options etc. It will also very likely break when the user has specified preefrences for more than one font family.\n            // However, I hope it's better to try to do something than ignoring the problem altogether.\n            int lastSpace = fontDescription.lastIndexOf(' ');\n            bool ok;\n            double size = fontDescription.mid(lastSpace).toDouble(&ok);\n            if (lastSpace > 0 && ok) {\n                font = QFont(fontDescription.left(lastSpace), size);\n                initialized = true;\n            }\n        }\n    }\n\n    if (!initialized) {\n        // Ok, that failed, let's create some fallback font.\n        // The problem is that these names wary acros platforms,\n        // but the following works well -- at first, we come up with a made-up name, and then\n        // let the Qt font substitution algorithm do its magic.\n        font = QFont(QLatin1String(\"x-trojita-terminus-like-fixed-width\"));\n        // Using QFont::Monospace results in a proportional font on jkt's system\n        font.setStyleHint(QFont::TypeWriter);\n\n        // Gnome, Mac and perhaps everyone else uses 10pt as the default font size, so let's use that as well\n        int defaultPointSize = 10;\n        if (isRunningKde4()) {\n            // kdeui/kernel/kglobalsettings.cpp from KDELIBS sets default fixed font size to 9 on X11. Let's hope nobody runs\n            // this desktop-GUI-specific code *with KDE* under Harmattan or Mac. Seriously.\n            defaultPointSize = 9;\n\n        }\n        font.setPointSize(defaultPointSize);\n    }\n\n    return font;\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  nt MsgListView::sizeHintForColumn(int column) const\n  {\n      QFont boldFont = font();\n      boldFont.setBold(true);\n      QFontMetrics metric(boldFont);\n      switch (column) {\n      case Imap::Mailbox::MsgListModel::SEEN:\n          return 16;\n      case Imap::Mailbox::MsgListModel::SUBJECT:\n          return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita Foo Bar Random Text\")).width();\n      case Imap::Mailbox::MsgListModel::FROM:\n      case Imap::Mailbox::MsgListModel::TO:\n      case Imap::Mailbox::MsgListModel::CC:\n      case Imap::Mailbox::MsgListModel::BCC:\n          return metric.size(Qt::TextSingleLine, QLatin1String(\"Blesmrt Trojita\")).width();\n      case Imap::Mailbox::MsgListModel::DATE:\n      case Imap::Mailbox::MsgListModel::RECEIVED_DATE:\n          return metric.size(Qt::TextSingleLine,\n                             //: Translators: use a text which is returned for e-mails older than one day but newer than one week\n                             //: (see Imap::Mailbox::PrettyMsgListModel::prettyFormatDate() for the string formats); the idea here\n                             //: is to have a text which is \"wide enough\" in a typical UI font.\n                             //: The English version uses \"Mon\" because of the M letter; you should use something similar.\n                             tr(\"Mon 10\")).width();\n      case Imap::Mailbox::MsgListModel::SIZE:\n          return metric.size(Qt::TextSingleLine, tr(\"88.8 kB\")).width();\n      default:\n          return QTreeView::sizeHintForColumn(column);\n      }\n  }\n}"
  },
  {
    "function_name": "slotCurrentActivated(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "106-115",
    "snippet": "oid MsgListView::slotCurrentActivated()\n{\n    if (currentIndex().isValid() && m_autoActivateAfterKeyNavigation) {\n        // The \"current index\" is the one with that funny dot which only triggers the read/unread status toggle.\n        // If we don't do anything, subsequent pressing of key_up or key_down will move the cursor up/down one row\n        // while preserving the column which will lead to toggling the read/unread state of *that* message.\n        // That's unexpected; the key shall just move the cursor and change the current message.\n        emit activated(currentIndex().sibling(currentIndex().row(), Imap::Mailbox::MsgListModel::SUBJECT));\n    }\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "urrentIndex",
          "args": [
            "urrentIndex().row(),",
            "map::Mailbox::MsgListModel::SUBJECT)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndex",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndex(",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndex(",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndex",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndex(",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotCurrentActivated()\n  {\n      if (currentIndex().isValid() && m_autoActivateAfterKeyNavigation) {\n          // The \"current index\" is the one with that funny dot which only triggers the read/unread status toggle.\n          // If we don't do anything, subsequent pressing of key_up or key_down will move the cursor up/down one row\n          // while preserving the column which will lead to toggling the read/unread state of *that* message.\n          // That's unexpected; the key shall just move the cursor and change the current message.\n          emit activated(currentIndex().sibling(currentIndex().row(), Imap::Mailbox::MsgListModel::SUBJECT));\n      }\n  }\n}"
  },
  {
    "function_name": "event(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "94-104",
    "snippet": "ool MsgListView::event(QEvent *event)\n{\n    if (event->type() == QEvent::ShortcutOverride\n            && !gs_naviActivationBlockers.contains(static_cast<QKeyEvent*>(event)->key())\n            && m_naviActivationTimer->isActive()) {\n        // Make sure that the delayed timer is broken ASAP when the key looks like something which might possibly be a shortcut\n        m_naviActivationTimer->stop();\n        slotCurrentActivated();\n    }\n    return QTreeView::event(event);\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TreeView::event(",
          "args": [
            "vent)"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "event(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "94-104",
          "snippet": "ool MsgListView::event(QEvent *event)\n{\n    if (event->type() == QEvent::ShortcutOverride\n            && !gs_naviActivationBlockers.contains(static_cast<QKeyEvent*>(event)->key())\n            && m_naviActivationTimer->isActive()) {\n        // Make sure that the delayed timer is broken ASAP when the key looks like something which might possibly be a shortcut\n        m_naviActivationTimer->stop();\n        slotCurrentActivated();\n    }\n    return QTreeView::event(event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "lotCurrentActivated(",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "slotCurrentActivated(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "106-115",
          "snippet": "oid MsgListView::slotCurrentActivated()\n{\n    if (currentIndex().isValid() && m_autoActivateAfterKeyNavigation) {\n        // The \"current index\" is the one with that funny dot which only triggers the read/unread status toggle.\n        // If we don't do anything, subsequent pressing of key_up or key_down will move the cursor up/down one row\n        // while preserving the column which will lead to toggling the read/unread state of *that* message.\n        // That's unexpected; the key shall just move the cursor and change the current message.\n        emit activated(currentIndex().sibling(currentIndex().row(), Imap::Mailbox::MsgListModel::SUBJECT));\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotCurrentActivated()\n  {\n      if (currentIndex().isValid() && m_autoActivateAfterKeyNavigation) {\n          // The \"current index\" is the one with that funny dot which only triggers the read/unread status toggle.\n          // If we don't do anything, subsequent pressing of key_up or key_down will move the cursor up/down one row\n          // while preserving the column which will lead to toggling the read/unread state of *that* message.\n          // That's unexpected; the key shall just move the cursor and change the current message.\n          emit activated(currentIndex().sibling(currentIndex().row(), Imap::Mailbox::MsgListModel::SUBJECT));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_naviActivationTimer->stop",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_naviActivationTimer->isActive",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s_naviActivationBlockers.contains",
          "args": [
            "tatic_cast<QKeyEvent*>(event)->key())"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QKeyEvent*>",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QKeyEvent*>",
          "args": [
            "vent)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vent->type",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  ool MsgListView::event(QEvent *event)\n  {\n      if (event->type() == QEvent::ShortcutOverride\n              && !gs_naviActivationBlockers.contains(static_cast<QKeyEvent*>(event)->key())\n              && m_naviActivationTimer->isActive()) {\n          // Make sure that the delayed timer is broken ASAP when the key looks like something which might possibly be a shortcut\n          m_naviActivationTimer->stop();\n          slotCurrentActivated();\n      }\n      return QTreeView::event(event);\n  }\n}"
  },
  {
    "function_name": "keyReleaseEvent(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "87-92",
    "snippet": "oid MsgListView::keyReleaseEvent(QKeyEvent *ke)\n{\n    if (ke->modifiers() == Qt::NoModifier && gs_naviActivationTriggers.contains(ke->key()))\n        m_naviActivationTimer->start(150); // few ms for the user to re-orientate. 150ms is not much\n    QTreeView::keyReleaseEvent(ke);\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TreeView::keyReleaseEvent(",
          "args": [
            "e)"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "keyReleaseEvent(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "87-92",
          "snippet": "oid MsgListView::keyReleaseEvent(QKeyEvent *ke)\n{\n    if (ke->modifiers() == Qt::NoModifier && gs_naviActivationTriggers.contains(ke->key()))\n        m_naviActivationTimer->start(150); // few ms for the user to re-orientate. 150ms is not much\n    QTreeView::keyReleaseEvent(ke);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "_naviActivationTimer->start",
          "args": [
            "50)"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s_naviActivationTriggers.contains",
          "args": [
            "e->key())"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->modifiers",
          "args": [],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::keyReleaseEvent(QKeyEvent *ke)\n  {\n      if (ke->modifiers() == Qt::NoModifier && gs_naviActivationTriggers.contains(ke->key()))\n          m_naviActivationTimer->start(150); // few ms for the user to re-orientate. 150ms is not much\n      QTreeView::keyReleaseEvent(ke);\n  }\n}"
  },
  {
    "function_name": "keyPressEvent(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "80-85",
    "snippet": "oid MsgListView::keyPressEvent(QKeyEvent *ke)\n{\n    if (gs_naviActivationBlockers.contains(ke->key()))\n        m_naviActivationTimer->stop();\n    QTreeView::keyPressEvent(ke);\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TreeView::keyPressEvent(",
          "args": [
            "e)"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "keyPressEvent(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "80-85",
          "snippet": "oid MsgListView::keyPressEvent(QKeyEvent *ke)\n{\n    if (gs_naviActivationBlockers.contains(ke->key()))\n        m_naviActivationTimer->stop();\n    QTreeView::keyPressEvent(ke);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "_naviActivationTimer->stop",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s_naviActivationBlockers.contains",
          "args": [
            "e->key())"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::keyPressEvent(QKeyEvent *ke)\n  {\n      if (gs_naviActivationBlockers.contains(ke->key()))\n          m_naviActivationTimer->stop();\n      QTreeView::keyPressEvent(ke);\n  }\n}"
  },
  {
    "function_name": "MsgListView(",
    "container": "sgListView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
    "lines": "40-64",
    "snippet": "sgListView::MsgListView(QWidget *parent): QTreeView(parent), m_autoActivateAfterKeyNavigation(true), m_autoResizeSections(true)\n{\n    connect(header(), SIGNAL(geometriesChanged()), this, SLOT(slotFixSize()));\n    connect(this, SIGNAL(expanded(QModelIndex)), this, SLOT(slotExpandWholeSubtree(QModelIndex)));\n    connect(header(), SIGNAL(sectionCountChanged(int,int)), this, SLOT(slotSectionCountChanged()));\n    header()->setContextMenuPolicy(Qt::ActionsContextMenu);\n    headerFieldsMapper = new QSignalMapper(this);\n    connect(headerFieldsMapper, SIGNAL(mapped(int)), this, SLOT(slotHeaderSectionVisibilityToggled(int)));\n\n    setUniformRowHeights(true);\n    setAllColumnsShowFocus(true);\n    setSelectionMode(ExtendedSelection);\n    setDragEnabled(true);\n    setRootIsDecorated(false);\n    // Some subthreads might be huuuuuuuuuuge, so prevent indenting them too heavily\n    setIndentation(15);\n\n    setSortingEnabled(true);\n    // By default, we don't do any sorting\n    header()->setSortIndicator(-1, Qt::AscendingOrder);\n\n    m_naviActivationTimer = new QTimer(this);\n    m_naviActivationTimer->setSingleShot(true);\n    connect(m_naviActivationTimer, SIGNAL(timeout()), SLOT(slotCurrentActivated()));\n}",
    "includes": [
      "include \"Imap/Model/PrettyMsgListModel.h\"",
      "include \"Imap/Model/MsgListModel.h\"\n#",
      "include <QTimer>\n#",
      "include <QSignalMapper>\n#",
      "include <QPainter>\n#",
      "include <QKeyEvent>\n#",
      "include <QHeaderView>\n#",
      "include <QFontMetrics>\n#",
      "include <QDrag>\n#",
      "include <QDesktopWidget>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MsgListView.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_naviActivationTimer,",
            "IGNAL(timeout()),",
            "LOT(slotCurrentActivated()))"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotCurrentActivated())"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotCurrentActivated(",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "slotCurrentActivated(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "106-115",
          "snippet": "oid MsgListView::slotCurrentActivated()\n{\n    if (currentIndex().isValid() && m_autoActivateAfterKeyNavigation) {\n        // The \"current index\" is the one with that funny dot which only triggers the read/unread status toggle.\n        // If we don't do anything, subsequent pressing of key_up or key_down will move the cursor up/down one row\n        // while preserving the column which will lead to toggling the read/unread state of *that* message.\n        // That's unexpected; the key shall just move the cursor and change the current message.\n        emit activated(currentIndex().sibling(currentIndex().row(), Imap::Mailbox::MsgListModel::SUBJECT));\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotCurrentActivated()\n  {\n      if (currentIndex().isValid() && m_autoActivateAfterKeyNavigation) {\n          // The \"current index\" is the one with that funny dot which only triggers the read/unread status toggle.\n          // If we don't do anything, subsequent pressing of key_up or key_down will move the cursor up/down one row\n          // while preserving the column which will lead to toggling the read/unread state of *that* message.\n          // That's unexpected; the key shall just move the cursor and change the current message.\n          emit activated(currentIndex().sibling(currentIndex().row(), Imap::Mailbox::MsgListModel::SUBJECT));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "imeout())"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "imeout(",
          "args": [],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_naviActivationTimer->setSingleShot",
          "args": [
            "rue)"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [
            "1,",
            "t::AscendingOrder)"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "processAdditionalHeaders(",
          "container": "reeItemMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1272-1291",
          "snippet": "oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n{\n    Imap::LowLevelParser::Rfc5322HeaderParser parser;\n    bool ok = parser.parse(rawHeaders);\n    if (!ok) {\n        model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                        QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n    }\n\n    data()->m_hdrReferences = parser.references;\n    if (!parser.listPost.isEmpty()) {\n        data()->m_hdrListPost.clear();\n        Q_FOREACH(const QByteArray &item, parser.listPost)\n            data()->m_hdrListPost << QUrl(item);\n    }\n    // That's right, this can only be set, not ever reset from this context.\n    // This is because we absolutely want to support incremental header arrival.\n    if (parser.listPostNo)\n        data()->m_hdrListPostNo = true;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemMessage {\n  oid TreeItemMessage::processAdditionalHeaders(Model *model, const QByteArray &rawHeaders)\n  {\n      Imap::LowLevelParser::Rfc5322HeaderParser parser;\n      bool ok = parser.parse(rawHeaders);\n      if (!ok) {\n          model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Rfc5322HeaderParser\"),\n                          QLatin1String(\"Unspecified error during RFC5322 header parsing\"));\n      }\n  \n      data()->m_hdrReferences = parser.references;\n      if (!parser.listPost.isEmpty()) {\n          data()->m_hdrListPost.clear();\n          Q_FOREACH(const QByteArray &item, parser.listPost)\n              data()->m_hdrListPost << QUrl(item);\n      }\n      // That's right, this can only be set, not ever reset from this context.\n      // This is because we absolutely want to support incremental header arrival.\n      if (parser.listPostNo)\n          data()->m_hdrListPostNo = true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eader(",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "asMailHeader(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "246-258",
          "snippet": "ByteArray MailAddress::asMailHeader() const\n{\n    QByteArray result = Imap::encodeRFC2047Phrase(name);\n\n    if (!result.isEmpty())\n        result.append(\" \");\n    \n    result.append(\"<\");\n    result.append(asSMTPMailbox());\n    result.append(\">\");\n\n    return result;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ByteArray MailAddress::asMailHeader() const\n  {\n      QByteArray result = Imap::encodeRFC2047Phrase(name);\n  \n      if (!result.isEmpty())\n          result.append(\" \");\n      \n      result.append(\"<\");\n      result.append(asSMTPMailbox());\n      result.append(\">\");\n  \n      return result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "etSortingEnabled(",
          "args": [
            "rue)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etIndentation(",
          "args": [
            "5)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etRootIsDecorated(",
          "args": [
            "alse)"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etDragEnabled(",
          "args": [
            "rue)"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etSelectionMode(",
          "args": [
            "xtendedSelection)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etAllColumnsShowFocus(",
          "args": [
            "rue)"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etUniformRowHeights(",
          "args": [
            "rue)"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eader",
          "args": [
            "t::ActionsContextMenu)"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "slotHeaderSectionVisibilityToggled(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "336-349",
          "snippet": "oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n{\n    QList<QAction *> actions = header()->actions();\n    if (section >= actions.size() || section < 0)\n        return;\n    bool hide = ! actions[section]->isChecked();\n\n    if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n        // This would hide the very last section, which would hide the whole header view\n        actions[section]->setChecked(true);\n    } else {\n        header()->setSectionHidden(section, hide);\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotHeaderSectionVisibilityToggled(int section)\n  {\n      QList<QAction *> actions = header()->actions();\n      if (section >= actions.size() || section < 0)\n          return;\n      bool hide = ! actions[section]->isChecked();\n  \n      if (hide && header()->hiddenSectionCount() == header()->count() - 1) {\n          // This would hide the very last section, which would hide the whole header view\n          actions[section]->setChecked(true);\n      } else {\n          header()->setSectionHidden(section, hide);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(expanded(QModelIndex)),",
            "his,",
            "LOT(slotExpandWholeSubtree(QModelIndex)))"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotExpandWholeSubtree(QModelIndex))"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotExpandWholeSubtree(",
          "args": [
            "ModelIndex)"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "slotExpandWholeSubtree(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "277-291",
          "snippet": "oid MsgListView::slotExpandWholeSubtree(const QModelIndex &rootIndex)\n{\n    if (rootIndex.parent().isValid())\n        return;\n\n    QVector<QModelIndex> queue(1, rootIndex);\n    for (int i = 0; i < queue.size(); ++i) {\n        const QModelIndex currentIndex = queue[i];\n        // Append all children to the queue...\n        for (int j = 0; j < currentIndex.model()->rowCount(currentIndex); ++j)\n            queue.append(currentIndex.child(j, 0));\n        // ...and expand the current index\n        expand(currentIndex);\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotExpandWholeSubtree(const QModelIndex &rootIndex)\n  {\n      if (rootIndex.parent().isValid())\n          return;\n  \n      QVector<QModelIndex> queue(1, rootIndex);\n      for (int i = 0; i < queue.size(); ++i) {\n          const QModelIndex currentIndex = queue[i];\n          // Append all children to the queue...\n          for (int j = 0; j < currentIndex.model()->rowCount(currentIndex); ++j)\n              queue.append(currentIndex.child(j, 0));\n          // ...and expand the current index\n          expand(currentIndex);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "xpanded(QModelIndex))"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xpanded(",
          "args": [
            "ModelIndex)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "eader(),",
            "IGNAL(geometriesChanged()),",
            "his,",
            "LOT(slotFixSize()))"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotFixSize())"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotFixSize(",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "slotFixSize(",
          "container": "sgListView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MsgListView.cpp",
          "lines": "243-263",
          "snippet": "oid MsgListView::slotFixSize()\n{\n    if (!m_autoResizeSections)\n        return;\n\n    if (header()->visualIndex(Imap::Mailbox::MsgListModel::SEEN) == -1) {\n        // calling setResizeMode() would assert()\n        return;\n    }\n\n    header()->setStretchLastSection(false);\n    for (int i = 0; i < Imap::Mailbox::MsgListModel::COLUMN_COUNT; ++i) {\n        QHeaderView::ResizeMode resizeMode = resizeModeForColumn(i);\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n        header()->setSectionResizeMode(i, resizeMode);\n#else\n        header()->setResizeMode(i, resizeMode);\n#endif\n        setColumnWidth(i, sizeHintForColumn(i));\n    }\n}",
          "includes": [
            "include \"Imap/Model/PrettyMsgListModel.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include <QTimer>\n#",
            "include <QSignalMapper>\n#",
            "include <QPainter>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QFontMetrics>\n#",
            "include <QDrag>\n#",
            "include <QDesktopWidget>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include \"MsgListView.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  oid MsgListView::slotFixSize()\n  {\n      if (!m_autoResizeSections)\n          return;\n  \n      if (header()->visualIndex(Imap::Mailbox::MsgListModel::SEEN) == -1) {\n          // calling setResizeMode() would assert()\n          return;\n      }\n  \n      header()->setStretchLastSection(false);\n      for (int i = 0; i < Imap::Mailbox::MsgListModel::COLUMN_COUNT; ++i) {\n          QHeaderView::ResizeMode resizeMode = resizeModeForColumn(i);\n  #if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n          header()->setSectionResizeMode(i, resizeMode);\n  #else\n          header()->setResizeMode(i, resizeMode);\n  #endif\n          setColumnWidth(i, sizeHintForColumn(i));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "eometriesChanged())"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eometriesChanged(",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/PrettyMsgListModel.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude <QTimer>\n#\ninclude <QSignalMapper>\n#\ninclude <QPainter>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QFontMetrics>\n#\ninclude <QDrag>\n#\ninclude <QDesktopWidget>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MsgListView.h\"\n\nsgListView {\n  sgListView::MsgListView(QWidget *parent): QTreeView(parent), m_autoActivateAfterKeyNavigation(true), m_autoResizeSections(true)\n  {\n      connect(header(), SIGNAL(geometriesChanged()), this, SLOT(slotFixSize()));\n      connect(this, SIGNAL(expanded(QModelIndex)), this, SLOT(slotExpandWholeSubtree(QModelIndex)));\n      connect(header(), SIGNAL(sectionCountChanged(int,int)), this, SLOT(slotSectionCountChanged()));\n      header()->setContextMenuPolicy(Qt::ActionsContextMenu);\n      headerFieldsMapper = new QSignalMapper(this);\n      connect(headerFieldsMapper, SIGNAL(mapped(int)), this, SLOT(slotHeaderSectionVisibilityToggled(int)));\n  \n      setUniformRowHeights(true);\n      setAllColumnsShowFocus(true);\n      setSelectionMode(ExtendedSelection);\n      setDragEnabled(true);\n      setRootIsDecorated(false);\n      // Some subthreads might be huuuuuuuuuuge, so prevent indenting them too heavily\n      setIndentation(15);\n  \n      setSortingEnabled(true);\n      // By default, we don't do any sorting\n      header()->setSortIndicator(-1, Qt::AscendingOrder);\n  \n      m_naviActivationTimer = new QTimer(this);\n      m_naviActivationTimer->setSingleShot(true);\n      connect(m_naviActivationTimer, SIGNAL(timeout()), SLOT(slotCurrentActivated()));\n  }\n}"
  }
]