[
  {
    "function_name": "mailboxHasPendingActions(",
    "container": "eleteMailboxTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/DeleteMailboxTask.cpp",
    "lines": "112-117",
    "snippet": "oid DeleteMailboxTask::mailboxHasPendingActions()\n{\n    EMIT_LATER(model, mailboxDeletionFailed, Q_ARG(QString, mailbox),\n               Q_ARG(QString, tr(\"Mailbox %1 has pending activity, so it cannot be deleted now.\").arg(mailbox)));\n    _failed(\"Mailbox has pending activity\");\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"GetAnyConnectionTask.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"DeleteMailboxTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "failed(",
          "args": [
            "Mailbox has pending activity\")"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "_failed(",
          "container": "hreadTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ThreadTask.cpp",
          "lines": "112-117",
          "snippet": "oid ThreadTask::_failed(const QString &errorMessage)\n{\n    // FIXME: show this in the GUI\n    emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n    ImapTask::_failed(errorMessage);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"ThreadTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"ThreadTask.h\"\n#\n\nhreadTask {\n  oid ThreadTask::_failed(const QString &errorMessage)\n  {\n      // FIXME: show this in the GUI\n      emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n      ImapTask::_failed(errorMessage);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIT_LATER(",
          "args": [
            "odel,",
            "ailboxDeletionFailed,",
            "_ARG(QString, mailbox),",
            "_ARG(QString, tr(\"Mailbox %1 has pending activity, so it cannot be deleted now.\").arg(mailbox)))"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ARG(",
          "args": [
            "String,",
            "r(\"Mailbox %1 has pending activity, so it cannot be deleted now.\").arg(mailbox))"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "ailbox)"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "handleStateHelper(",
          "container": "eleteMailboxTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/DeleteMailboxTask.cpp",
          "lines": "71-105",
          "snippet": "ool DeleteMailboxTask::handleStateHelper(const Imap::Responses::State *const resp)\n{\n    if (resp->tag.isEmpty())\n        return false;\n\n    if (resp->tag == tag) {\n\n        if (resp->kind == Responses::OK) {\n            TreeItemMailbox *mailboxPtr = model->findMailboxByName(mailbox);\n            if (mailboxPtr) {\n                TreeItem *parentPtr = mailboxPtr->parent();\n                QModelIndex parentIndex = parentPtr == model->m_mailboxes ? QModelIndex() : parentPtr->toIndex(model);\n                model->beginRemoveRows(parentIndex, mailboxPtr->row(), mailboxPtr->row());\n                mailboxPtr->parent()->m_children.erase(mailboxPtr->parent()->m_children.begin() + mailboxPtr->row());\n                model->endRemoveRows();\n                delete mailboxPtr;\n            } else {\n                QString buf;\n                QDebug dbg(&buf);\n                dbg << \"The IMAP server just told us that it succeeded to delete mailbox named\" <<\n                    mailbox << \", yet we don't know of any such mailbox. Message from the server:\" <<\n                    resp->message;\n                log(buf);\n            }\n            EMIT_LATER(model, mailboxDeletionSucceded, Q_ARG(QString, mailbox));\n            _completed();\n        } else {\n            EMIT_LATER(model, mailboxDeletionFailed, Q_ARG(QString, mailbox), Q_ARG(QString, resp->message));\n            _failed(\"Couldn't delete mailbox\");\n        }\n        return true;\n    } else {\n        return false;\n    }\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"GetAnyConnectionTask.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"DeleteMailboxTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\n\neleteMailboxTask {\n  ool DeleteMailboxTask::handleStateHelper(const Imap::Responses::State *const resp)\n  {\n      if (resp->tag.isEmpty())\n          return false;\n  \n      if (resp->tag == tag) {\n  \n          if (resp->kind == Responses::OK) {\n              TreeItemMailbox *mailboxPtr = model->findMailboxByName(mailbox);\n              if (mailboxPtr) {\n                  TreeItem *parentPtr = mailboxPtr->parent();\n                  QModelIndex parentIndex = parentPtr == model->m_mailboxes ? QModelIndex() : parentPtr->toIndex(model);\n                  model->beginRemoveRows(parentIndex, mailboxPtr->row(), mailboxPtr->row());\n                  mailboxPtr->parent()->m_children.erase(mailboxPtr->parent()->m_children.begin() + mailboxPtr->row());\n                  model->endRemoveRows();\n                  delete mailboxPtr;\n              } else {\n                  QString buf;\n                  QDebug dbg(&buf);\n                  dbg << \"The IMAP server just told us that it succeeded to delete mailbox named\" <<\n                      mailbox << \", yet we don't know of any such mailbox. Message from the server:\" <<\n                      resp->message;\n                  log(buf);\n              }\n              EMIT_LATER(model, mailboxDeletionSucceded, Q_ARG(QString, mailbox));\n              _completed();\n          } else {\n              EMIT_LATER(model, mailboxDeletionFailed, Q_ARG(QString, mailbox), Q_ARG(QString, resp->message));\n              _failed(\"Couldn't delete mailbox\");\n          }\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ARG(",
          "args": [
            "String,",
            "ailbox)"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\n\neleteMailboxTask {\n  oid DeleteMailboxTask::mailboxHasPendingActions()\n  {\n      EMIT_LATER(model, mailboxDeletionFailed, Q_ARG(QString, mailbox),\n                 Q_ARG(QString, tr(\"Mailbox %1 has pending activity, so it cannot be deleted now.\").arg(mailbox)));\n      _failed(\"Mailbox has pending activity\");\n  }\n}"
  },
  {
    "function_name": "taskData(",
    "container": "eleteMailboxTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/DeleteMailboxTask.cpp",
    "lines": "107-110",
    "snippet": "Variant DeleteMailboxTask::taskData(const int role) const\n{\n    return role == RoleTaskCompactName ? QVariant(tr(\"Deleting mailbox\")) : QVariant();\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"GetAnyConnectionTask.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"DeleteMailboxTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Variant(",
          "args": [],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [
            "r(\"Deleting mailbox\"))"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "ddresListToQVariant(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "40-47",
          "snippet": "VariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nVariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Deleting mailbox\")"
          ],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "handleStateHelper(",
          "container": "eleteMailboxTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/DeleteMailboxTask.cpp",
          "lines": "71-105",
          "snippet": "ool DeleteMailboxTask::handleStateHelper(const Imap::Responses::State *const resp)\n{\n    if (resp->tag.isEmpty())\n        return false;\n\n    if (resp->tag == tag) {\n\n        if (resp->kind == Responses::OK) {\n            TreeItemMailbox *mailboxPtr = model->findMailboxByName(mailbox);\n            if (mailboxPtr) {\n                TreeItem *parentPtr = mailboxPtr->parent();\n                QModelIndex parentIndex = parentPtr == model->m_mailboxes ? QModelIndex() : parentPtr->toIndex(model);\n                model->beginRemoveRows(parentIndex, mailboxPtr->row(), mailboxPtr->row());\n                mailboxPtr->parent()->m_children.erase(mailboxPtr->parent()->m_children.begin() + mailboxPtr->row());\n                model->endRemoveRows();\n                delete mailboxPtr;\n            } else {\n                QString buf;\n                QDebug dbg(&buf);\n                dbg << \"The IMAP server just told us that it succeeded to delete mailbox named\" <<\n                    mailbox << \", yet we don't know of any such mailbox. Message from the server:\" <<\n                    resp->message;\n                log(buf);\n            }\n            EMIT_LATER(model, mailboxDeletionSucceded, Q_ARG(QString, mailbox));\n            _completed();\n        } else {\n            EMIT_LATER(model, mailboxDeletionFailed, Q_ARG(QString, mailbox), Q_ARG(QString, resp->message));\n            _failed(\"Couldn't delete mailbox\");\n        }\n        return true;\n    } else {\n        return false;\n    }\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"GetAnyConnectionTask.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"DeleteMailboxTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\n\neleteMailboxTask {\n  ool DeleteMailboxTask::handleStateHelper(const Imap::Responses::State *const resp)\n  {\n      if (resp->tag.isEmpty())\n          return false;\n  \n      if (resp->tag == tag) {\n  \n          if (resp->kind == Responses::OK) {\n              TreeItemMailbox *mailboxPtr = model->findMailboxByName(mailbox);\n              if (mailboxPtr) {\n                  TreeItem *parentPtr = mailboxPtr->parent();\n                  QModelIndex parentIndex = parentPtr == model->m_mailboxes ? QModelIndex() : parentPtr->toIndex(model);\n                  model->beginRemoveRows(parentIndex, mailboxPtr->row(), mailboxPtr->row());\n                  mailboxPtr->parent()->m_children.erase(mailboxPtr->parent()->m_children.begin() + mailboxPtr->row());\n                  model->endRemoveRows();\n                  delete mailboxPtr;\n              } else {\n                  QString buf;\n                  QDebug dbg(&buf);\n                  dbg << \"The IMAP server just told us that it succeeded to delete mailbox named\" <<\n                      mailbox << \", yet we don't know of any such mailbox. Message from the server:\" <<\n                      resp->message;\n                  log(buf);\n              }\n              EMIT_LATER(model, mailboxDeletionSucceded, Q_ARG(QString, mailbox));\n              _completed();\n          } else {\n              EMIT_LATER(model, mailboxDeletionFailed, Q_ARG(QString, mailbox), Q_ARG(QString, resp->message));\n              _failed(\"Couldn't delete mailbox\");\n          }\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\n\neleteMailboxTask {\n  Variant DeleteMailboxTask::taskData(const int role) const\n  {\n      return role == RoleTaskCompactName ? QVariant(tr(\"Deleting mailbox\")) : QVariant();\n  }\n}"
  },
  {
    "function_name": "handleStateHelper(",
    "container": "eleteMailboxTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/DeleteMailboxTask.cpp",
    "lines": "71-105",
    "snippet": "ool DeleteMailboxTask::handleStateHelper(const Imap::Responses::State *const resp)\n{\n    if (resp->tag.isEmpty())\n        return false;\n\n    if (resp->tag == tag) {\n\n        if (resp->kind == Responses::OK) {\n            TreeItemMailbox *mailboxPtr = model->findMailboxByName(mailbox);\n            if (mailboxPtr) {\n                TreeItem *parentPtr = mailboxPtr->parent();\n                QModelIndex parentIndex = parentPtr == model->m_mailboxes ? QModelIndex() : parentPtr->toIndex(model);\n                model->beginRemoveRows(parentIndex, mailboxPtr->row(), mailboxPtr->row());\n                mailboxPtr->parent()->m_children.erase(mailboxPtr->parent()->m_children.begin() + mailboxPtr->row());\n                model->endRemoveRows();\n                delete mailboxPtr;\n            } else {\n                QString buf;\n                QDebug dbg(&buf);\n                dbg << \"The IMAP server just told us that it succeeded to delete mailbox named\" <<\n                    mailbox << \", yet we don't know of any such mailbox. Message from the server:\" <<\n                    resp->message;\n                log(buf);\n            }\n            EMIT_LATER(model, mailboxDeletionSucceded, Q_ARG(QString, mailbox));\n            _completed();\n        } else {\n            EMIT_LATER(model, mailboxDeletionFailed, Q_ARG(QString, mailbox), Q_ARG(QString, resp->message));\n            _failed(\"Couldn't delete mailbox\");\n        }\n        return true;\n    } else {\n        return false;\n    }\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"GetAnyConnectionTask.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"DeleteMailboxTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "failed(",
          "args": [
            "Couldn't delete mailbox\")"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "_failed(",
          "container": "hreadTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ThreadTask.cpp",
          "lines": "112-117",
          "snippet": "oid ThreadTask::_failed(const QString &errorMessage)\n{\n    // FIXME: show this in the GUI\n    emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n    ImapTask::_failed(errorMessage);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"ThreadTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"ThreadTask.h\"\n#\n\nhreadTask {\n  oid ThreadTask::_failed(const QString &errorMessage)\n  {\n      // FIXME: show this in the GUI\n      emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n      ImapTask::_failed(errorMessage);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIT_LATER(",
          "args": [
            "odel,",
            "ailboxDeletionFailed,",
            "_ARG(QString, mailbox),",
            "_ARG(QString, resp->message))"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ARG(",
          "args": [
            "String,",
            "esp->message)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ARG(",
          "args": [
            "String,",
            "ailbox)"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "completed(",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "_completed(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "224-233",
          "snippet": "oid ImapTask::_completed()\n{\n    _finished = true;\n    log(\"Completed\");\n    Q_FOREACH(ImapTask* task, dependentTasks) {\n        if (!task->isFinished())\n            task->perform();\n    }\n    emit completed(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::_completed()\n  {\n      _finished = true;\n      log(\"Completed\");\n      Q_FOREACH(ImapTask* task, dependentTasks) {\n          if (!task->isFinished())\n              task->perform();\n      }\n      emit completed(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MIT_LATER(",
          "args": [
            "odel,",
            "ailboxDeletionSucceded,",
            "_ARG(QString, mailbox))"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ARG(",
          "args": [
            "String,",
            "ailbox)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "og(",
          "args": [
            "uf)"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "log(",
          "container": "essageDownloader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MessageDownloader.cpp",
          "lines": "57-60",
          "snippet": "oid MessageDownloader::log(const QString &message)\n{\n    m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"MessageDownloader\"), message);\n}",
          "includes": [
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FindInterestingPart.h\"\n#",
            "include \"MessageDownloader.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FindInterestingPart.h\"\n#\ninclude \"MessageDownloader.h\"\n#\n\nessageDownloader {\n  oid MessageDownloader::log(const QString &message)\n  {\n      m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"MessageDownloader\"), message);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "odel->endRemoveRows",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailboxPtr->parent",
          "args": [
            "ailboxPtr->parent()->m_children.begin() + mailboxPtr->row())"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailboxPtr->row",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailboxPtr->parent",
          "args": [],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "229-268",
          "snippet": "void ModelTest::parent()\n{\n    // Make sure the model wont crash and will return an invalid QModelIndex\n    // when asked for the parent of an invalid index.\n    Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // Column 0                | Column 1    |\n    // QModelIndex()           |             |\n    //    \\- topIndex          | topIndex1   |\n    //         \\- childIndex   | childIndex1 |\n\n    // Common error test #1, make sure that a top level index has a parent\n    // that is a invalid QModelIndex.\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    Q_ASSERT(model->parent(topIndex) == QModelIndex());\n\n    // Common error test #2, make sure that a second level index has a parent\n    // that is the first level index.\n    if (model->rowCount(topIndex) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        Q_ASSERT(model->parent(childIndex) == topIndex);\n    }\n\n    // Common error test #3, the second column should NOT have the same children\n    // as the first column in a row.\n    // Usually the second column shouldn't have children.\n    QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n    if (model->rowCount(topIndex1) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n        Q_ASSERT(childIndex != childIndex1);\n    }\n\n    // Full test, walk n levels deep through the model making sure that all\n    // parent's children correctly specify their parent.\n    checkChildren(QModelIndex());\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::parent()\n  {\n      // Make sure the model wont crash and will return an invalid QModelIndex\n      // when asked for the parent of an invalid index.\n      Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // Column 0                | Column 1    |\n      // QModelIndex()           |             |\n      //    \\- topIndex          | topIndex1   |\n      //         \\- childIndex   | childIndex1 |\n  \n      // Common error test #1, make sure that a top level index has a parent\n      // that is a invalid QModelIndex.\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      Q_ASSERT(model->parent(topIndex) == QModelIndex());\n  \n      // Common error test #2, make sure that a second level index has a parent\n      // that is the first level index.\n      if (model->rowCount(topIndex) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          Q_ASSERT(model->parent(childIndex) == topIndex);\n      }\n  \n      // Common error test #3, the second column should NOT have the same children\n      // as the first column in a row.\n      // Usually the second column shouldn't have children.\n      QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n      if (model->rowCount(topIndex1) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n          Q_ASSERT(childIndex != childIndex1);\n      }\n  \n      // Full test, walk n levels deep through the model making sure that all\n      // parent's children correctly specify their parent.\n      checkChildren(QModelIndex());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "odel->beginRemoveRows",
          "args": [
            "arentIndex,",
            "ailboxPtr->row(),",
            "ailboxPtr->row())"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailboxPtr->row",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailboxPtr->row",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arentPtr->toIndex",
          "args": [
            "odel)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->findMailboxByName",
          "args": [
            "ailbox)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esp->tag.isEmpty",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\n\neleteMailboxTask {\n  ool DeleteMailboxTask::handleStateHelper(const Imap::Responses::State *const resp)\n  {\n      if (resp->tag.isEmpty())\n          return false;\n  \n      if (resp->tag == tag) {\n  \n          if (resp->kind == Responses::OK) {\n              TreeItemMailbox *mailboxPtr = model->findMailboxByName(mailbox);\n              if (mailboxPtr) {\n                  TreeItem *parentPtr = mailboxPtr->parent();\n                  QModelIndex parentIndex = parentPtr == model->m_mailboxes ? QModelIndex() : parentPtr->toIndex(model);\n                  model->beginRemoveRows(parentIndex, mailboxPtr->row(), mailboxPtr->row());\n                  mailboxPtr->parent()->m_children.erase(mailboxPtr->parent()->m_children.begin() + mailboxPtr->row());\n                  model->endRemoveRows();\n                  delete mailboxPtr;\n              } else {\n                  QString buf;\n                  QDebug dbg(&buf);\n                  dbg << \"The IMAP server just told us that it succeeded to delete mailbox named\" <<\n                      mailbox << \", yet we don't know of any such mailbox. Message from the server:\" <<\n                      resp->message;\n                  log(buf);\n              }\n              EMIT_LATER(model, mailboxDeletionSucceded, Q_ARG(QString, mailbox));\n              _completed();\n          } else {\n              EMIT_LATER(model, mailboxDeletionFailed, Q_ARG(QString, mailbox), Q_ARG(QString, resp->message));\n              _failed(\"Couldn't delete mailbox\");\n          }\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
  },
  {
    "function_name": "perform(",
    "container": "eleteMailboxTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/DeleteMailboxTask.cpp",
    "lines": "61-69",
    "snippet": "oid DeleteMailboxTask::perform()\n{\n    parser = conn->parser;\n    markAsActiveTask();\n\n    IMAP_TASK_CHECK_ABORT_DIE;\n\n    tag = parser->deleteMailbox(mailbox);\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"GetAnyConnectionTask.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"DeleteMailboxTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arser->deleteMailbox",
          "args": [
            "ailbox)"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "deleteMailbox(",
          "container": "arser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Parser.cpp",
          "lines": "203-206",
          "snippet": "ommandHandle Parser::deleteMailbox(const QString &mailbox)\n{\n    return queueCommand(Commands::Command(\"DELETE\") << encodeImapFolderName(mailbox));\n}",
          "includes": [
            "include \"../Model/Utils.h\"",
            "include \"../../Streams/IODeviceSocket.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Parser.h\"\n#",
            "include <QTimer>\n#",
            "include <QTime>\n#",
            "include <QSslError>\n#",
            "include <QProcess>\n#",
            "include <QMutexLocker>\n#",
            "include <QStringList>\n#",
            "include <QDebug>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Model/Utils.h\"\ninclude \"../../Streams/IODeviceSocket.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Parser.h\"\n#\ninclude <QTimer>\n#\ninclude <QTime>\n#\ninclude <QSslError>\n#\ninclude <QProcess>\n#\ninclude <QMutexLocker>\n#\ninclude <QStringList>\n#\ninclude <QDebug>\n#\ninclude <algorithm>\n#\n\narser {\n  ommandHandle Parser::deleteMailbox(const QString &mailbox)\n  {\n      return queueCommand(Commands::Command(\"DELETE\") << encodeImapFolderName(mailbox));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arkAsActiveTask(",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\n\neleteMailboxTask {\n  oid DeleteMailboxTask::perform()\n  {\n      parser = conn->parser;\n      markAsActiveTask();\n  \n      IMAP_TASK_CHECK_ABORT_DIE;\n  \n      tag = parser->deleteMailbox(mailbox);\n  }\n}"
  },
  {
    "function_name": "DeleteMailboxTask(",
    "container": "eleteMailboxTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/DeleteMailboxTask.cpp",
    "lines": "38-59",
    "snippet": "eleteMailboxTask::DeleteMailboxTask(Model *model, const QString &mailbox):\n    ImapTask(model), conn(0), mailbox(mailbox)\n{\n    // If the mailbox we're about to delete is open, or scheduled to be open, let's make\n    // sure that we are going to tell the KeepMailboxOpenTask about us.\n    // The mailbox discovery is lazy; we most definitely do *not* want to trigger an explicit\n    // resynchronization just for that mailbox we're going to immediately delete. That's why\n    // we are *not* calling Model::findTaskResponsibleFor here.\n    if (TreeItemMailbox *mailboxPtr = model->findMailboxByName(mailbox)) {\n        if (mailboxPtr->maintainingTask) {\n            conn = mailboxPtr->maintainingTask;\n        }\n    }\n\n    if (!conn) {\n        // Either the mailbox is not known or converted to an index,\n        // or there's no task associated with the mailbox\n        conn = model->m_taskFactory->createGetAnyConnectionTask(model);\n    }\n\n    conn->addDependentTask(this);\n}",
    "includes": [
      "include \"KeepMailboxOpenTask.h\"",
      "include \"GetAnyConnectionTask.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"DeleteMailboxTask.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onn->addDependentTask",
          "args": [
            "his)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->m_taskFactory->createGetAnyConnectionTask",
          "args": [
            "odel)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->findMailboxByName",
          "args": [
            "ailbox)"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\n\neleteMailboxTask {\n  eleteMailboxTask::DeleteMailboxTask(Model *model, const QString &mailbox):\n      ImapTask(model), conn(0), mailbox(mailbox)\n  {\n      // If the mailbox we're about to delete is open, or scheduled to be open, let's make\n      // sure that we are going to tell the KeepMailboxOpenTask about us.\n      // The mailbox discovery is lazy; we most definitely do *not* want to trigger an explicit\n      // resynchronization just for that mailbox we're going to immediately delete. That's why\n      // we are *not* calling Model::findTaskResponsibleFor here.\n      if (TreeItemMailbox *mailboxPtr = model->findMailboxByName(mailbox)) {\n          if (mailboxPtr->maintainingTask) {\n              conn = mailboxPtr->maintainingTask;\n          }\n      }\n  \n      if (!conn) {\n          // Either the mailbox is not known or converted to an index,\n          // or there's no task associated with the mailbox\n          conn = model->m_taskFactory->createGetAnyConnectionTask(model);\n      }\n  \n      conn->addDependentTask(this);\n  }\n}"
  }
]