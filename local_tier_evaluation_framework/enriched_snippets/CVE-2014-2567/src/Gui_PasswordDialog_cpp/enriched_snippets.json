[
  {
    "function_name": "getPassword",
    "container": "PasswordDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/PasswordDialog.cpp",
    "lines": "53-68",
    "snippet": "QString PasswordDialog::getPassword(QWidget *parent, const QString &windowTitle, const QString &description,\n                                    const QString &password, bool *ok)\n{\n    PasswordDialog dialog(parent);\n    dialog.setWindowTitle(windowTitle);\n    dialog.ui.descriptionLabel->setText(description);\n    dialog.ui.passwordLineEdit->setEchoMode(QLineEdit::Password);\n    dialog.ui.passwordLineEdit->setText(password);\n\n    int ret = dialog.exec();\n    if (ok)\n        *ok = !!ret;\n    if (ret)\n        return dialog.ui.passwordLineEdit->text();\n    return QString();\n}",
    "includes": [
      "#include \"IconLoader.h\"",
      "#include \"PasswordDialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog.ui.passwordLineEdit->text",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog.exec",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "exec",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "217-242",
          "snippet": "bool XSqlQuery::exec()\n{\n  bool returnValue = false;\n\n  if(_data && _data->_emulatePrepare)\n  {\n// In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n// caused several problems with all our code and the way it worked so this is a modified copy\n// of their code to use the implemented prepare if we have that option set so we can use the method\n// that works best in the case we are using it for.\n    if (lastError().isValid())\n      ((XSqlResultHelper*)result())->setLastError(QSqlError());\n\n    returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n  }\n  else\n    returnValue = QSqlQuery::exec();\n\n  if (_data)\n    _data->_currRecord = record();\n\n  if(false == returnValue)\n    notifyErrorListeners(this);\n\n  return returnValue;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::exec()\n  {\n    bool returnValue = false;\n  \n    if(_data && _data->_emulatePrepare)\n    {\n  // In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n  // caused several problems with all our code and the way it worked so this is a modified copy\n  // of their code to use the implemented prepare if we have that option set so we can use the method\n  // that works best in the case we are using it for.\n      if (lastError().isValid())\n        ((XSqlResultHelper*)result())->setLastError(QSqlError());\n  \n      returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n    }\n    else\n      returnValue = QSqlQuery::exec();\n  \n    if (_data)\n      _data->_currRecord = record();\n  \n    if(false == returnValue)\n      notifyErrorListeners(this);\n  \n    return returnValue;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dialog.ui.passwordLineEdit->setText",
          "args": [
            "password"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog.ui.passwordLineEdit->setEchoMode",
          "args": [
            "QLineEdit::Password"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog.ui.descriptionLabel->setText",
          "args": [
            "description"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dialog.setWindowTitle",
          "args": [
            "windowTitle"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"IconLoader.h\"\n#include \"PasswordDialog.h\"\n\nPasswordDialog {\n  QString PasswordDialog::getPassword(QWidget *parent, const QString &windowTitle, const QString &description,\n                                      const QString &password, bool *ok)\n  {\n      PasswordDialog dialog(parent);\n      dialog.setWindowTitle(windowTitle);\n      dialog.ui.descriptionLabel->setText(description);\n      dialog.ui.passwordLineEdit->setEchoMode(QLineEdit::Password);\n      dialog.ui.passwordLineEdit->setText(password);\n  \n      int ret = dialog.exec();\n      if (ok)\n          *ok = !!ret;\n      if (ret)\n          return dialog.ui.passwordLineEdit->text();\n      return QString();\n  }\n}"
  },
  {
    "function_name": "password",
    "container": "PasswordDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/PasswordDialog.cpp",
    "lines": "48-51",
    "snippet": "QString PasswordDialog::password() const\n{\n    return ui.passwordLineEdit->text();\n}",
    "includes": [
      "#include \"IconLoader.h\"",
      "#include \"PasswordDialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui.passwordLineEdit->text",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"IconLoader.h\"\n#include \"PasswordDialog.h\"\n\nPasswordDialog {\n  QString PasswordDialog::password() const\n  {\n      return ui.passwordLineEdit->text();\n  }\n}"
  },
  {
    "function_name": "showEvent",
    "container": "PasswordDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/PasswordDialog.cpp",
    "lines": "40-44",
    "snippet": "void PasswordDialog::showEvent(QShowEvent *event)\n{\n    ui.passwordLineEdit->setFocus();\n    QDialog::showEvent(event);\n}",
    "includes": [
      "#include \"IconLoader.h\"",
      "#include \"PasswordDialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDialog::showEvent",
          "args": [
            "event"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "showEvent",
          "container": "PasswordDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/PasswordDialog.cpp",
          "lines": "40-44",
          "snippet": "void PasswordDialog::showEvent(QShowEvent *event)\n{\n    ui.passwordLineEdit->setFocus();\n    QDialog::showEvent(event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "ui.passwordLineEdit->setFocus",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"IconLoader.h\"\n#include \"PasswordDialog.h\"\n\nPasswordDialog {\n  void PasswordDialog::showEvent(QShowEvent *event)\n  {\n      ui.passwordLineEdit->setFocus();\n      QDialog::showEvent(event);\n  }\n}"
  },
  {
    "function_name": "~PasswordDialog",
    "container": "PasswordDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/PasswordDialog.cpp",
    "lines": "36-38",
    "snippet": "PasswordDialog::~PasswordDialog()\n{\n}",
    "includes": [
      "#include \"IconLoader.h\"",
      "#include \"PasswordDialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"IconLoader.h\"\n#include \"PasswordDialog.h\"\n\nPasswordDialog {\n  PasswordDialog::~PasswordDialog()\n  {\n  }\n}"
  },
  {
    "function_name": "PasswordDialog",
    "container": "PasswordDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/PasswordDialog.cpp",
    "lines": "28-34",
    "snippet": "PasswordDialog::PasswordDialog(QWidget *parent)\n    : QDialog(parent)\n{\n    ui.setupUi(this);\n    setModal(true);\n    ui.iconLabel->setPixmap(loadIcon(\"dialog-password\").pixmap(64, 64));\n}",
    "includes": [
      "#include \"IconLoader.h\"",
      "#include \"PasswordDialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui.iconLabel->setPixmap",
          "args": [
            "loadIcon(\"dialog-password\").pixmap(64, 64)"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loadIcon",
          "args": [
            "64",
            "64"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "loadIcon",
          "args": [
            "\"dialog-password\""
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "loadIcon",
          "container": "QMimeBinaryProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "648-659",
          "snippet": "void QMimeBinaryProvider::loadIcon(QMimeTypePrivate &data)\n{\n    checkCache();\n    const QByteArray inputMime = data.name.toLatin1();\n    foreach (CacheFile *cacheFile, m_cacheFiles) {\n        const QString icon = iconForMime(cacheFile, PosIconsListOffset, inputMime);\n        if (!icon.isEmpty()) {\n            data.iconName = icon;\n            return;\n        }\n    }\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeBinaryProvider {\n  void QMimeBinaryProvider::loadIcon(QMimeTypePrivate &data)\n  {\n      checkCache();\n      const QByteArray inputMime = data.name.toLatin1();\n      foreach (CacheFile *cacheFile, m_cacheFiles) {\n          const QString icon = iconForMime(cacheFile, PosIconsListOffset, inputMime);\n          if (!icon.isEmpty()) {\n              data.iconName = icon;\n              return;\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setModal",
          "args": [
            "true"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui.setupUi",
          "args": [
            "this"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"IconLoader.h\"\n#include \"PasswordDialog.h\"\n\nPasswordDialog {\n  PasswordDialog::PasswordDialog(QWidget *parent)\n      : QDialog(parent)\n  {\n      ui.setupUi(this);\n      setModal(true);\n      ui.iconLabel->setPixmap(loadIcon(\"dialog-password\").pixmap(64, 64));\n  }\n}"
  }
]