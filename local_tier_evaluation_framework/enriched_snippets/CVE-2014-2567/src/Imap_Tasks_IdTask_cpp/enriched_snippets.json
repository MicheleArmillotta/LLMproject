[
  {
    "function_name": "taskData(",
    "container": "dTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/IdTask.cpp",
    "lines": "84-87",
    "snippet": "Variant IdTask::taskData(const int role) const\n{\n    return role == RoleTaskCompactName ? QVariant(tr(\"Identifying server\")) : QVariant();\n}",
    "includes": [
      "include \"GetAnyConnectionTask.h\"",
      "include \"Imap/Model/Utils.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"IdTask.h\"\n#",
      "include \"Common/Application.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Variant(",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [
            "r(\"Identifying server\"))"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "ddresListToQVariant(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "40-47",
          "snippet": "VariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nVariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Identifying server\")"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "handleStateHelper(",
          "container": "dTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/IdTask.cpp",
          "lines": "59-76",
          "snippet": "ool IdTask::handleStateHelper(const Imap::Responses::State *const resp)\n{\n    if (resp->tag.isEmpty())\n        return false;\n\n    if (resp->tag == tag) {\n        if (resp->kind == Responses::OK) {\n            // nothing should be needed here\n            _completed();\n        } else {\n            _failed(\"ID failed, strange\");\n            // But hey, we can just ignore this one\n        }\n        return true;\n    } else {\n        return false;\n    }\n}",
          "includes": [
            "include \"GetAnyConnectionTask.h\"",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"IdTask.h\"\n#",
            "include \"Common/Application.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"IdTask.h\"\n#\ninclude \"Common/Application.h\"\n#\n\ndTask {\n  ool IdTask::handleStateHelper(const Imap::Responses::State *const resp)\n  {\n      if (resp->tag.isEmpty())\n          return false;\n  \n      if (resp->tag == tag) {\n          if (resp->kind == Responses::OK) {\n              // nothing should be needed here\n              _completed();\n          } else {\n              _failed(\"ID failed, strange\");\n              // But hey, we can just ignore this one\n          }\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"IdTask.h\"\n#\ninclude \"Common/Application.h\"\n#\n\ndTask {\n  Variant IdTask::taskData(const int role) const\n  {\n      return role == RoleTaskCompactName ? QVariant(tr(\"Identifying server\")) : QVariant();\n  }\n}"
  },
  {
    "function_name": "handleId(",
    "container": "dTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/IdTask.cpp",
    "lines": "78-82",
    "snippet": "ool IdTask::handleId(const Responses::Id *const resp)\n{\n    model->m_idResult = resp->data;\n    return true;\n}",
    "includes": [
      "include \"GetAnyConnectionTask.h\"",
      "include \"Imap/Model/Utils.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"IdTask.h\"\n#",
      "include \"Common/Application.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"IdTask.h\"\n#\ninclude \"Common/Application.h\"\n#\n\ndTask {\n  ool IdTask::handleId(const Responses::Id *const resp)\n  {\n      model->m_idResult = resp->data;\n      return true;\n  }\n}"
  },
  {
    "function_name": "handleStateHelper(",
    "container": "dTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/IdTask.cpp",
    "lines": "59-76",
    "snippet": "ool IdTask::handleStateHelper(const Imap::Responses::State *const resp)\n{\n    if (resp->tag.isEmpty())\n        return false;\n\n    if (resp->tag == tag) {\n        if (resp->kind == Responses::OK) {\n            // nothing should be needed here\n            _completed();\n        } else {\n            _failed(\"ID failed, strange\");\n            // But hey, we can just ignore this one\n        }\n        return true;\n    } else {\n        return false;\n    }\n}",
    "includes": [
      "include \"GetAnyConnectionTask.h\"",
      "include \"Imap/Model/Utils.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"IdTask.h\"\n#",
      "include \"Common/Application.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "failed(",
          "args": [
            "ID failed, strange\")"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "_failed(",
          "container": "hreadTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ThreadTask.cpp",
          "lines": "112-117",
          "snippet": "oid ThreadTask::_failed(const QString &errorMessage)\n{\n    // FIXME: show this in the GUI\n    emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n    ImapTask::_failed(errorMessage);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"ThreadTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"ThreadTask.h\"\n#\n\nhreadTask {\n  oid ThreadTask::_failed(const QString &errorMessage)\n  {\n      // FIXME: show this in the GUI\n      emit model->threadingFailed(mailboxIndex, algorithm, searchCriteria);\n      ImapTask::_failed(errorMessage);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "completed(",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "_completed(",
          "container": "mapTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/ImapTask.cpp",
          "lines": "224-233",
          "snippet": "oid ImapTask::_completed()\n{\n    _finished = true;\n    log(\"Completed\");\n    Q_FOREACH(ImapTask* task, dependentTasks) {\n        if (!task->isFinished())\n            task->perform();\n    }\n    emit completed(this);\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/TaskPresentationModel.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"ImapTask.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/TaskPresentationModel.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"ImapTask.h\"\n#\n\nmapTask {\n  oid ImapTask::_completed()\n  {\n      _finished = true;\n      log(\"Completed\");\n      Q_FOREACH(ImapTask* task, dependentTasks) {\n          if (!task->isFinished())\n              task->perform();\n      }\n      emit completed(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "esp->tag.isEmpty",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"IdTask.h\"\n#\ninclude \"Common/Application.h\"\n#\n\ndTask {\n  ool IdTask::handleStateHelper(const Imap::Responses::State *const resp)\n  {\n      if (resp->tag.isEmpty())\n          return false;\n  \n      if (resp->tag == tag) {\n          if (resp->kind == Responses::OK) {\n              // nothing should be needed here\n              _completed();\n          } else {\n              _failed(\"ID failed, strange\");\n              // But hey, we can just ignore this one\n          }\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
  },
  {
    "function_name": "perform(",
    "container": "dTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/IdTask.cpp",
    "lines": "42-57",
    "snippet": "oid IdTask::perform()\n{\n    markAsActiveTask();\n\n    IMAP_TASK_CHECK_ABORT_DIE;\n\n    if (model->property(\"trojita-imap-enable-id\").toBool()) {\n        QMap<QByteArray,QByteArray> identification;\n        identification[\"name\"] = \"Trojita\";\n        identification[\"version\"] = Common::Application::version.toUtf8();\n        identification[\"os\"] = systemPlatformVersion().toUtf8();\n        tag = parser->idCommand(identification);\n    } else {\n        tag = parser->idCommand();\n    }\n}",
    "includes": [
      "include \"GetAnyConnectionTask.h\"",
      "include \"Imap/Model/Utils.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"IdTask.h\"\n#",
      "include \"Common/Application.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arser->idCommand",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "idCommand(",
          "container": "arser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Parser.cpp",
          "lines": "540-543",
          "snippet": "ommandHandle Parser::idCommand()\n{\n    return queueCommand(Commands::Command(\"ID NIL\"));\n}",
          "includes": [
            "include \"../Model/Utils.h\"",
            "include \"../../Streams/IODeviceSocket.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Parser.h\"\n#",
            "include <QTimer>\n#",
            "include <QTime>\n#",
            "include <QSslError>\n#",
            "include <QProcess>\n#",
            "include <QMutexLocker>\n#",
            "include <QStringList>\n#",
            "include <QDebug>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Model/Utils.h\"\ninclude \"../../Streams/IODeviceSocket.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Parser.h\"\n#\ninclude <QTimer>\n#\ninclude <QTime>\n#\ninclude <QSslError>\n#\ninclude <QProcess>\n#\ninclude <QMutexLocker>\n#\ninclude <QStringList>\n#\ninclude <QDebug>\n#\ninclude <algorithm>\n#\n\narser {\n  ommandHandle Parser::idCommand()\n  {\n      return queueCommand(Commands::Command(\"ID NIL\"));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ystemPlatformVersion",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "ystemPlatformVersion(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Utils.cpp",
          "lines": "90-318",
          "snippet": "String systemPlatformVersion()\n{\n    QString os = QLatin1String(\"\"\n#ifdef Q_OS_AIX\n                                    \"AIX\"\n#endif\n#ifdef Q_OS_BSD4\n#ifndef Q_OS_MAC\n                                    \"AnyBSD4.4\"\n#endif\n#endif\n#ifdef Q_OS_BSDI\n                                    \"BSD/OS\"\n#endif\n#ifdef Q_OS_CYGWIN\n                                    \"Cygwin\"\n#endif\n#ifdef Q_OS_DGUX\n                                    \"DG/UX\"\n#endif\n#ifdef Q_OS_DYNIX\n                                    \"DYNIX/ptx\"\n#endif\n#ifdef Q_OS_FREEBSD\n                                    \"FreeBSD\"\n#endif\n#ifdef Q_OS_HPUX\n                                    \"HP-UX\"\n#endif\n#ifdef Q_OS_HURD\n                                    \"Hurd\"\n#endif\n#ifdef Q_OS_IRIX\n                                    \"Irix\"\n#endif\n#ifdef Q_OS_LINUX\n                                    \"Linux\"\n#endif\n#ifdef Q_OS_LYNX\n                                    \"LynxOS\"\n#endif\n#ifdef Q_OS_MAC\n                                    \"MacOS\"\n#endif\n#ifdef Q_OS_MSDOS\n                                    \"MSDOS\"\n#endif\n#ifdef Q_OS_NETBSD\n                                    \"NetBSD\"\n#endif\n#ifdef Q_OS_OS2\n                                    \"OS/2\"\n#endif\n#ifdef Q_OS_OPENBSD\n                                    \"OpenBSD\"\n#endif\n#ifdef Q_OS_OS2EMX\n                                    \"OS2EMX\"\n#endif\n#ifdef Q_OS_OSF\n                                    \"HPTru64UNIX\"\n#endif\n#ifdef Q_OS_QNX\n                                    \"QNXNeutrino\"\n#endif\n#ifdef Q_OS_RELIANT\n                                    \"ReliantUNIX\"\n#endif\n#ifdef Q_OS_SCO\n                                    \"SCOOpenServer5\"\n#endif\n#ifdef Q_OS_SOLARIS\n                                    \"Solaris\"\n#endif\n#ifdef Q_OS_SYMBIAN\n                                    \"Symbian\"\n#endif\n#ifdef Q_OS_ULTRIX\n                                    \"Ultrix\"\n#endif\n#ifdef Q_OS_UNIXWARE\n                                    \"Unixware\"\n#endif\n#ifdef Q_OS_WIN32\n                                    \"Windows\"\n#endif\n#ifdef Q_OS_WINCE\n                                    \"WinCE\"\n#endif\n                                   );\n#ifdef Q_OS_UNIX\n    if (os.isEmpty()) {\n        os = \"Unix\";\n    }\n#endif\n\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    QString ws = \"\"\n#ifdef Q_WS_X11\n                 \"X11\"\n#endif\n#ifdef Q_WS_MAC\n                 \"Mac\"\n#endif\n#ifdef Q_WS_QWS\n                 \"QWS\"\n#endif\n#ifdef Q_WS_WIN\n                 \"Win\"\n#endif\n                 ;\n#else\n    QString ws = QGuiApplication::platformName();\n#endif\n\n    static QString platformVersion;\n#ifdef TROJITA_MOBILITY_SYSTEMINFO\n    if (platformVersion.isEmpty()) {\n        QtMobility::QSystemDeviceInfo device;\n        if (device.productName().isEmpty()) {\n            platformVersion = device.manufacturer() + QLatin1String(\" \") + device.model();\n        } else {\n            platformVersion = QString::fromAscii(\"%1 %2 (%3)\").arg(device.manufacturer(), device.productName(), device.model());\n        }\n    }\n#endif\n    if (platformVersion.isEmpty()) {\n#ifdef Q_OS_WIN32\n        switch (QSysInfo::WindowsVersion) {\n        case QSysInfo::WV_32s:\n            platformVersion = \"3.1\";\n            break;\n        case QSysInfo::WV_95:\n            platformVersion = \"95\";\n            break;\n        case QSysInfo::WV_98:\n            platformVersion = \"98\";\n            break;\n        case QSysInfo::WV_Me:\n            platformVersion = \"Me\";\n            break;\n        case QSysInfo::WV_NT:\n            platformVersion = \"NT\";\n            break;\n        case QSysInfo::WV_2000:\n            platformVersion = \"2000\";\n            break;\n        case QSysInfo::WV_XP:\n            platformVersion = \"XP\";\n            break;\n        case QSysInfo::WV_2003:\n            platformVersion = \"2003\";\n            break;\n        case QSysInfo::WV_VISTA:\n            platformVersion = \"Vista\";\n            break;\n        case QSysInfo::WV_WINDOWS7:\n            platformVersion = \"7\";\n            break;\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n        case QSysInfo::WV_WINDOWS8:\n            platformVersion = \"8\";\n            break;\n#endif\n        }\n#endif\n#ifdef Q_OS_WINCE\n        switch (QSysInfo::WindowsVersion) {\n        case QSysInfo::WV_CE:\n            platformVersion = \"CE\";\n            break;\n        case QSysInfo::WV_CENET:\n            platformVersion = \"CE.NET\";\n            break;\n        case QSysInfo::WV_CE_5:\n            platformVersion = \"CE5.x\";\n            break;\n        case QSysInfo::WV_CE_6:\n            platformVersion = \"CE6.x\";\n            break;\n        }\n#endif\n#ifdef Q_OS_MAC\n        switch (QSysInfo::MacintoshVersion) {\n        case QSysInfo::MV_9:\n            platformVersion = \"9.0\";\n            break;\n        case QSysInfo::MV_10_0:\n            platformVersion = \"X 10.0\";\n            break;\n        case QSysInfo::MV_10_1:\n            platformVersion = \"X 10.1\";\n            break;\n        case QSysInfo::MV_10_2:\n            platformVersion = \"X 10.2\";\n            break;\n        case QSysInfo::MV_10_3:\n            platformVersion = \"X 10.3\";\n            break;\n        case QSysInfo::MV_10_4:\n            platformVersion = \"X 10.4\";\n            break;\n        case QSysInfo::MV_10_5:\n            platformVersion = \"X 10.5\";\n            break;\n        case QSysInfo::MV_10_6:\n            platformVersion = \"X 10.6\";\n            break;\n#if QT_VERSION >= 0x040800\n        case QSysInfo::MV_10_7:\n            platformVersion = \"X 10.7\";\n            break;\n        case QSysInfo::MV_10_8:\n            platformVersion = \"X 10.8\";\n            break;\n#endif\n        }\n#endif\n        if (platformVersion.isEmpty()) {\n            // try to call the lsb_release\n            QProcess *proc = new QProcess(0);\n            proc->start(\"lsb_release\", QStringList() << QLatin1String(\"-s\") << QLatin1String(\"-d\"));\n            proc->waitForFinished();\n            platformVersion = QString::fromLocal8Bit(proc->readAll()).trimmed().replace(QLatin1String(\"\\\"\"), QString()).replace(QLatin1String(\";\"), QLatin1String(\",\"));\n            proc->deleteLater();\n        }\n    }\n    return QString::fromUtf8(\"Qt/%1; %2; %3; %4\").arg(qVersion(), ws, os, platformVersion);\n}",
          "includes": [
            "include <QSystemDeviceInfo>\n#",
            "include \"Imap/Model/Model.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include <QTextDocument>",
            "include <QSysInfo>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSettings>\n#",
            "include <QProcess>\n#",
            "include <QLocale>\n#",
            "include <QGuiApplication>\n#",
            "include <QDir>\n#",
            "include <QDateTime>\n#",
            "include <cmath>\n#",
            "include \"Utils.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QSystemDeviceInfo>\n#\ninclude \"Imap/Model/Model.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude <QTextDocument>\ninclude <QSysInfo>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSettings>\n#\ninclude <QProcess>\n#\ninclude <QLocale>\n#\ninclude <QGuiApplication>\n#\ninclude <QDir>\n#\ninclude <QDateTime>\n#\ninclude <cmath>\n#\ninclude \"Utils.h\"\n#\n\nString systemPlatformVersion()\n{\n    QString os = QLatin1String(\"\"\n#ifdef Q_OS_AIX\n                                    \"AIX\"\n#endif\n#ifdef Q_OS_BSD4\n#ifndef Q_OS_MAC\n                                    \"AnyBSD4.4\"\n#endif\n#endif\n#ifdef Q_OS_BSDI\n                                    \"BSD/OS\"\n#endif\n#ifdef Q_OS_CYGWIN\n                                    \"Cygwin\"\n#endif\n#ifdef Q_OS_DGUX\n                                    \"DG/UX\"\n#endif\n#ifdef Q_OS_DYNIX\n                                    \"DYNIX/ptx\"\n#endif\n#ifdef Q_OS_FREEBSD\n                                    \"FreeBSD\"\n#endif\n#ifdef Q_OS_HPUX\n                                    \"HP-UX\"\n#endif\n#ifdef Q_OS_HURD\n                                    \"Hurd\"\n#endif\n#ifdef Q_OS_IRIX\n                                    \"Irix\"\n#endif\n#ifdef Q_OS_LINUX\n                                    \"Linux\"\n#endif\n#ifdef Q_OS_LYNX\n                                    \"LynxOS\"\n#endif\n#ifdef Q_OS_MAC\n                                    \"MacOS\"\n#endif\n#ifdef Q_OS_MSDOS\n                                    \"MSDOS\"\n#endif\n#ifdef Q_OS_NETBSD\n                                    \"NetBSD\"\n#endif\n#ifdef Q_OS_OS2\n                                    \"OS/2\"\n#endif\n#ifdef Q_OS_OPENBSD\n                                    \"OpenBSD\"\n#endif\n#ifdef Q_OS_OS2EMX\n                                    \"OS2EMX\"\n#endif\n#ifdef Q_OS_OSF\n                                    \"HPTru64UNIX\"\n#endif\n#ifdef Q_OS_QNX\n                                    \"QNXNeutrino\"\n#endif\n#ifdef Q_OS_RELIANT\n                                    \"ReliantUNIX\"\n#endif\n#ifdef Q_OS_SCO\n                                    \"SCOOpenServer5\"\n#endif\n#ifdef Q_OS_SOLARIS\n                                    \"Solaris\"\n#endif\n#ifdef Q_OS_SYMBIAN\n                                    \"Symbian\"\n#endif\n#ifdef Q_OS_ULTRIX\n                                    \"Ultrix\"\n#endif\n#ifdef Q_OS_UNIXWARE\n                                    \"Unixware\"\n#endif\n#ifdef Q_OS_WIN32\n                                    \"Windows\"\n#endif\n#ifdef Q_OS_WINCE\n                                    \"WinCE\"\n#endif\n                                   );\n#ifdef Q_OS_UNIX\n    if (os.isEmpty()) {\n        os = \"Unix\";\n    }\n#endif\n\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    QString ws = \"\"\n#ifdef Q_WS_X11\n                 \"X11\"\n#endif\n#ifdef Q_WS_MAC\n                 \"Mac\"\n#endif\n#ifdef Q_WS_QWS\n                 \"QWS\"\n#endif\n#ifdef Q_WS_WIN\n                 \"Win\"\n#endif\n                 ;\n#else\n    QString ws = QGuiApplication::platformName();\n#endif\n\n    static QString platformVersion;\n#ifdef TROJITA_MOBILITY_SYSTEMINFO\n    if (platformVersion.isEmpty()) {\n        QtMobility::QSystemDeviceInfo device;\n        if (device.productName().isEmpty()) {\n            platformVersion = device.manufacturer() + QLatin1String(\" \") + device.model();\n        } else {\n            platformVersion = QString::fromAscii(\"%1 %2 (%3)\").arg(device.manufacturer(), device.productName(), device.model());\n        }\n    }\n#endif\n    if (platformVersion.isEmpty()) {\n#ifdef Q_OS_WIN32\n        switch (QSysInfo::WindowsVersion) {\n        case QSysInfo::WV_32s:\n            platformVersion = \"3.1\";\n            break;\n        case QSysInfo::WV_95:\n            platformVersion = \"95\";\n            break;\n        case QSysInfo::WV_98:\n            platformVersion = \"98\";\n            break;\n        case QSysInfo::WV_Me:\n            platformVersion = \"Me\";\n            break;\n        case QSysInfo::WV_NT:\n            platformVersion = \"NT\";\n            break;\n        case QSysInfo::WV_2000:\n            platformVersion = \"2000\";\n            break;\n        case QSysInfo::WV_XP:\n            platformVersion = \"XP\";\n            break;\n        case QSysInfo::WV_2003:\n            platformVersion = \"2003\";\n            break;\n        case QSysInfo::WV_VISTA:\n            platformVersion = \"Vista\";\n            break;\n        case QSysInfo::WV_WINDOWS7:\n            platformVersion = \"7\";\n            break;\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n        case QSysInfo::WV_WINDOWS8:\n            platformVersion = \"8\";\n            break;\n#endif\n        }\n#endif\n#ifdef Q_OS_WINCE\n        switch (QSysInfo::WindowsVersion) {\n        case QSysInfo::WV_CE:\n            platformVersion = \"CE\";\n            break;\n        case QSysInfo::WV_CENET:\n            platformVersion = \"CE.NET\";\n            break;\n        case QSysInfo::WV_CE_5:\n            platformVersion = \"CE5.x\";\n            break;\n        case QSysInfo::WV_CE_6:\n            platformVersion = \"CE6.x\";\n            break;\n        }\n#endif\n#ifdef Q_OS_MAC\n        switch (QSysInfo::MacintoshVersion) {\n        case QSysInfo::MV_9:\n            platformVersion = \"9.0\";\n            break;\n        case QSysInfo::MV_10_0:\n            platformVersion = \"X 10.0\";\n            break;\n        case QSysInfo::MV_10_1:\n            platformVersion = \"X 10.1\";\n            break;\n        case QSysInfo::MV_10_2:\n            platformVersion = \"X 10.2\";\n            break;\n        case QSysInfo::MV_10_3:\n            platformVersion = \"X 10.3\";\n            break;\n        case QSysInfo::MV_10_4:\n            platformVersion = \"X 10.4\";\n            break;\n        case QSysInfo::MV_10_5:\n            platformVersion = \"X 10.5\";\n            break;\n        case QSysInfo::MV_10_6:\n            platformVersion = \"X 10.6\";\n            break;\n#if QT_VERSION >= 0x040800\n        case QSysInfo::MV_10_7:\n            platformVersion = \"X 10.7\";\n            break;\n        case QSysInfo::MV_10_8:\n            platformVersion = \"X 10.8\";\n            break;\n#endif\n        }\n#endif\n        if (platformVersion.isEmpty()) {\n            // try to call the lsb_release\n            QProcess *proc = new QProcess(0);\n            proc->start(\"lsb_release\", QStringList() << QLatin1String(\"-s\") << QLatin1String(\"-d\"));\n            proc->waitForFinished();\n            platformVersion = QString::fromLocal8Bit(proc->readAll()).trimmed().replace(QLatin1String(\"\\\"\"), QString()).replace(QLatin1String(\";\"), QLatin1String(\",\"));\n            proc->deleteLater();\n        }\n    }\n    return QString::fromUtf8(\"Qt/%1; %2; %3; %4\").arg(qVersion(), ws, os, platformVersion);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ommon::Application::version.toUtf8",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->property",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odel->property",
          "args": [
            "trojita-imap-enable-id\")"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arkAsActiveTask(",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"IdTask.h\"\n#\ninclude \"Common/Application.h\"\n#\n\ndTask {\n  oid IdTask::perform()\n  {\n      markAsActiveTask();\n  \n      IMAP_TASK_CHECK_ABORT_DIE;\n  \n      if (model->property(\"trojita-imap-enable-id\").toBool()) {\n          QMap<QByteArray,QByteArray> identification;\n          identification[\"name\"] = \"Trojita\";\n          identification[\"version\"] = Common::Application::version.toUtf8();\n          identification[\"os\"] = systemPlatformVersion().toUtf8();\n          tag = parser->idCommand(identification);\n      } else {\n          tag = parser->idCommand();\n      }\n  }\n}"
  },
  {
    "function_name": "IdTask(",
    "container": "dTask",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/IdTask.cpp",
    "lines": "36-40",
    "snippet": "dTask::IdTask(Model *_model, ImapTask *dependingTask) : ImapTask(_model)\n{\n    dependingTask->addDependentTask(this);\n    parser = dependingTask->parser;\n}",
    "includes": [
      "include \"GetAnyConnectionTask.h\"",
      "include \"Imap/Model/Utils.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"IdTask.h\"\n#",
      "include \"Common/Application.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ependingTask->addDependentTask",
          "args": [
            "his)"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"GetAnyConnectionTask.h\"\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"IdTask.h\"\n#\ninclude \"Common/Application.h\"\n#\n\ndTask {\n  dTask::IdTask(Model *_model, ImapTask *dependingTask) : ImapTask(_model)\n  {\n      dependingTask->addDependentTask(this);\n      parser = dependingTask->parser;\n  }\n}"
  }
]