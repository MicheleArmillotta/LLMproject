[
  {
    "function_name": "errorString",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "712-714",
    "snippet": "QString QwwSmtpClient::errorString() const{\n    return d->errorString;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QString QwwSmtpClient::errorString() const{\n      return d->errorString;\n  }\n}"
  },
  {
    "function_name": "options",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "708-710",
    "snippet": "QwwSmtpClient::Options QwwSmtpClient::options() const{\n    return d->options;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QwwSmtpClient::Options QwwSmtpClient::options() const{\n      return d->options;\n  }\n}"
  },
  {
    "function_name": "supportedAuthModes",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "704-706",
    "snippet": "QwwSmtpClient::AuthModes QwwSmtpClient::supportedAuthModes() const{\n    return d->authModes;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QwwSmtpClient::AuthModes QwwSmtpClient::supportedAuthModes() const{\n      return d->authModes;\n  }\n}"
  },
  {
    "function_name": "ignoreSslErrors",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "700-702",
    "snippet": "void QwwSmtpClient::ignoreSslErrors()\n{d->socket->ignoreSslErrors();\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->socket->ignoreSslErrors",
          "args": [],
          "line": 701
        },
        "resolved": true,
        "details": {
          "function_name": "ignoreSslErrors",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "700-702",
          "snippet": "void QwwSmtpClient::ignoreSslErrors()\n{d->socket->ignoreSslErrors();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  void QwwSmtpClient::ignoreSslErrors()\n  {d->socket->ignoreSslErrors();\n  }\n}"
  },
  {
    "function_name": "abortDialog",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "694-698",
    "snippet": "void QwwSmtpClientPrivate::abortDialog() {\n    emit q->commandFinished(commandqueue.head().id, true);\n    commandqueue.clear();\n    sendQuit();\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sendQuit",
          "args": [],
          "line": 697
        },
        "resolved": true,
        "details": {
          "function_name": "sendQuit",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "480-486",
          "snippet": "void QwwSmtpClientPrivate::sendQuit() {\n    qDebug() << \"SMTP >>> QUIT\";\n    socket->write(\"QUIT\\r\\n\");\n    socket->waitForBytesWritten(1000);\n    socket->disconnectFromHost();\n    setState(QwwSmtpClient::Disconnecting);\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendQuit() {\n      qDebug() << \"SMTP >>> QUIT\";\n      socket->write(\"QUIT\\r\\n\");\n      socket->waitForBytesWritten(1000);\n      socket->disconnectFromHost();\n      setState(QwwSmtpClient::Disconnecting);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "commandqueue.clear",
          "args": [],
          "line": 696
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::abortDialog() {\n      emit q->commandFinished(commandqueue.head().id, true);\n      commandqueue.clear();\n      sendQuit();\n  }\n}"
  },
  {
    "function_name": "rawCommand",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "682-691",
    "snippet": "int QwwSmtpClient::rawCommand(const QString & raw) {\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::RawCommand;\n    cmd.data = raw;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->processNextCommand",
          "args": [],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d->commandqueue.enqueue",
          "args": [
            "cmd"
          ],
          "line": 687
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::rawCommand(const QString & raw) {\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::RawCommand;\n      cmd.data = raw;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
  },
  {
    "function_name": "sendMailBurl",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "666-680",
    "snippet": "int QwwSmtpClient::sendMailBurl(const QByteArray &from, const QList<QByteArray> &to, const QString &url)\n{\n    QList<QVariant> rcpts;\n    for(QList<QByteArray>::const_iterator it = to.begin(); it != to.end(); it ++) {\n        rcpts.append(QVariant(*it));\n    }\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::MailBurl;\n    cmd.data = QVariantList() << from << QVariant(rcpts) << url;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->processNextCommand",
          "args": [],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d->commandqueue.enqueue",
          "args": [
            "cmd"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "rcpts"
          ],
          "line": 674
        },
        "resolved": true,
        "details": {
          "function_name": "ddresListToQVariant(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "40-47",
          "snippet": "VariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nVariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QVariantList",
          "args": [],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcpts.append",
          "args": [
            "QVariant(*it)"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to.end",
          "args": [],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to.begin",
          "args": [],
          "line": 669
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::sendMailBurl(const QByteArray &from, const QList<QByteArray> &to, const QString &url)\n  {\n      QList<QVariant> rcpts;\n      for(QList<QByteArray>::const_iterator it = to.begin(); it != to.end(); it ++) {\n          rcpts.append(QVariant(*it));\n      }\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::MailBurl;\n      cmd.data = QVariantList() << from << QVariant(rcpts) << url;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
  },
  {
    "function_name": "sendMail",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "650-664",
    "snippet": "int QwwSmtpClient::sendMail(const QByteArray &from, const QList<QByteArray> &to, const QString &content)\n{\n    QList<QVariant> rcpts;\n    for(QList<QByteArray>::const_iterator it = to.begin(); it != to.end(); it ++) {\n        rcpts.append(QVariant(*it));\n    }\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Mail;\n    cmd.data = QVariantList() << from << QVariant(rcpts) << content;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->processNextCommand",
          "args": [],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d->commandqueue.enqueue",
          "args": [
            "cmd"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariant",
          "args": [
            "rcpts"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "ddresListToQVariant(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "40-47",
          "snippet": "VariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nVariantList addresListToQVariant(const QList<Imap::Message::MailAddress> &addressList)\n{\n    QVariantList res;\n    foreach(const Imap::Message::MailAddress& address, addressList) {\n        res.append(QVariant(QStringList() << address.name << address.adl << address.mailbox << address.host));\n    }\n    return res;\n}"
        }
      },
      {
        "call_info": {
          "callee": "QVariantList",
          "args": [],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcpts.append",
          "args": [
            "QVariant(*it)"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to.end",
          "args": [],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to.begin",
          "args": [],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::sendMail(const QByteArray &from, const QList<QByteArray> &to, const QString &content)\n  {\n      QList<QVariant> rcpts;\n      for(QList<QByteArray>::const_iterator it = to.begin(); it != to.end(); it ++) {\n          rcpts.append(QVariant(*it));\n      }\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Mail;\n      cmd.data = QVariantList() << from << QVariant(rcpts) << content;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
  },
  {
    "function_name": "sendMail",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "640-648",
    "snippet": "int QwwSmtpClient::sendMail(const QString & from, const QString & to, const QString & content) {\n    /* Any code sending to addresses that are still character-strings instead of\n       byte strings is probably buggy, but we might as well have a convenience\n       method here for it anyway. This method will frequently not do the right\n       thing, but it will do the wrong thing conveniently. */\n    QList<QByteArray> rcpts;\n    rcpts.append(to.toUtf8());\n    return sendMail(from.toUtf8(), rcpts, content);\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sendMail",
          "args": [
            "from.toUtf8()",
            "rcpts",
            "content"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "sendMailBurl",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "666-680",
          "snippet": "int QwwSmtpClient::sendMailBurl(const QByteArray &from, const QList<QByteArray> &to, const QString &url)\n{\n    QList<QVariant> rcpts;\n    for(QList<QByteArray>::const_iterator it = to.begin(); it != to.end(); it ++) {\n        rcpts.append(QVariant(*it));\n    }\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::MailBurl;\n    cmd.data = QVariantList() << from << QVariant(rcpts) << url;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::sendMailBurl(const QByteArray &from, const QList<QByteArray> &to, const QString &url)\n  {\n      QList<QVariant> rcpts;\n      for(QList<QByteArray>::const_iterator it = to.begin(); it != to.end(); it ++) {\n          rcpts.append(QVariant(*it));\n      }\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::MailBurl;\n      cmd.data = QVariantList() << from << QVariant(rcpts) << url;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "from.toUtf8",
          "args": [],
          "line": 647
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcpts.append",
          "args": [
            "to.toUtf8()"
          ],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "to.toUtf8",
          "args": [],
          "line": 646
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::sendMail(const QString & from, const QString & to, const QString & content) {\n      /* Any code sending to addresses that are still character-strings instead of\n         byte strings is probably buggy, but we might as well have a convenience\n         method here for it anyway. This method will frequently not do the right\n         thing, but it will do the wrong thing conveniently. */\n      QList<QByteArray> rcpts;\n      rcpts.append(to.toUtf8());\n      return sendMail(from.toUtf8(), rcpts, content);\n  }\n}"
  },
  {
    "function_name": "authenticate",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "625-638",
    "snippet": "int QwwSmtpClient::authenticate(const QString &user, const QString &password, AuthMode mode) {\n    if(mode==AuthAny){\n    \t// negotiate\n    \tmode = AuthLogin;\n    }\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Authenticate;\n    cmd.data = QVariantList() << (int)mode << user << password;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->processNextCommand",
          "args": [],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d->commandqueue.enqueue",
          "args": [
            "cmd"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariantList",
          "args": [],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::authenticate(const QString &user, const QString &password, AuthMode mode) {\n      if(mode==AuthAny){\n      \t// negotiate\n      \tmode = AuthLogin;\n      }\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Authenticate;\n      cmd.data = QVariantList() << (int)mode << user << password;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
  },
  {
    "function_name": "setLocalNameEncrypted",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "620-622",
    "snippet": "void QwwSmtpClient::setLocalNameEncrypted(const QString & ln) {\n    d->localNameEncrypted = ln;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  void QwwSmtpClient::setLocalNameEncrypted(const QString & ln) {\n      d->localNameEncrypted = ln;\n  }\n}"
  },
  {
    "function_name": "setLocalName",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "616-618",
    "snippet": "void QwwSmtpClient::setLocalName(const QString & ln) {\n    d->localName = ln;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  void QwwSmtpClient::setLocalName(const QString & ln) {\n      d->localName = ln;\n  }\n}"
  },
  {
    "function_name": "startTls",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "606-614",
    "snippet": "int QwwSmtpClient::startTls() {\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::StartTLS;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->processNextCommand",
          "args": [],
          "line": 612
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d->commandqueue.enqueue",
          "args": [
            "cmd"
          ],
          "line": 610
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::startTls() {\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::StartTLS;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
  },
  {
    "function_name": "disconnectFromHost",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "596-604",
    "snippet": "int QwwSmtpClient::disconnectFromHost() {\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Disconnect;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->processNextCommand",
          "args": [],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d->commandqueue.enqueue",
          "args": [
            "cmd"
          ],
          "line": 600
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::disconnectFromHost() {\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Disconnect;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
  },
  {
    "function_name": "connectToHostEncrypted",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "584-594",
    "snippet": "int QwwSmtpClient::connectToHostEncrypted(const QString & hostName, quint16 port)\n{\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Connect;\n    cmd.data = QVariantList() << hostName << port << true;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if(!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->processNextCommand",
          "args": [],
          "line": 592
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d->commandqueue.enqueue",
          "args": [
            "cmd"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariantList",
          "args": [],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::connectToHostEncrypted(const QString & hostName, quint16 port)\n  {\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Connect;\n      cmd.data = QVariantList() << hostName << port << true;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if(!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
  },
  {
    "function_name": "connectToHost",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "567-576",
    "snippet": "int QwwSmtpClient::connectToHost(const QString & hostName, quint16 port) {\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Connect;\n    cmd.data = QVariantList() << hostName << port << false;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d->processNextCommand",
          "args": [],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "d->commandqueue.enqueue",
          "args": [
            "cmd"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVariantList",
          "args": [],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::connectToHost(const QString & hostName, quint16 port) {\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Connect;\n      cmd.data = QVariantList() << hostName << port << false;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
  },
  {
    "function_name": "~QwwSmtpClient",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "563-565",
    "snippet": "QwwSmtpClient::~QwwSmtpClient() {\n    delete d;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QwwSmtpClient::~QwwSmtpClient() {\n      delete d;\n  }\n}"
  },
  {
    "function_name": "QwwSmtpClient",
    "container": "QwwSmtpClient",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "547-560",
    "snippet": "QwwSmtpClient::QwwSmtpClient(QObject *parent)\n        : QObject(parent), d(new QwwSmtpClientPrivate(this)) {\n    d->state = Disconnected;\n    d->lastId = 0;\n    d->inProgress = false;\n    d->localName = \"localhost\";\n    d->socket = new QSslSocket(this);\n    connect(d->socket, SIGNAL(connected()), this, SLOT(onConnected()));\n    connect(d->socket, SIGNAL(error(QAbstractSocket::SocketError)), this, SLOT(onError(QAbstractSocket::SocketError)) );\n    connect(d->socket, SIGNAL(disconnected()), this, SLOT(onDisconnected()));\n    connect(d->socket, SIGNAL(readyRead()), this, SLOT(_q_readFromSocket()));\n    connect(d->socket, SIGNAL(sslErrors(const QList<QSslError> &)), this, SIGNAL(sslErrors(const QList<QSslError>&)));\n    connect(d->socket, SIGNAL(encrypted()), this, SLOT(_q_encrypted()));\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "d->socket",
            "SIGNAL(encrypted())",
            "this",
            "SLOT(_q_encrypted())"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "_q_encrypted()"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_q_encrypted",
          "args": [],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "_q_encrypted",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "448-453",
          "snippet": "void QwwSmtpClientPrivate::_q_encrypted() {\n        options = QwwSmtpClient::NoOptions;\n    // forget everything, restart ehlo\n//    SMTPCommand &cmd = commandqueue.head();\n    sendEhlo();\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::_q_encrypted() {\n          options = QwwSmtpClient::NoOptions;\n      // forget everything, restart ehlo\n  //    SMTPCommand &cmd = commandqueue.head();\n      sendEhlo();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "encrypted()"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "d->socket",
            "SIGNAL(sslErrors(const QList<QSslError> &))",
            "this",
            "SIGNAL(sslErrors(const QList<QSslError>&))"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "sslErrors(const QList<QSslError>&)"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sslErrors",
          "args": [
            "const QList<QSslError>&"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "sslErrors(const QList<QSslError> &)"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sslErrors",
          "args": [
            "const QList<QSslError> &"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "d->socket",
            "SIGNAL(readyRead())",
            "this",
            "SLOT(_q_readFromSocket())"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "_q_readFromSocket()"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_q_readFromSocket",
          "args": [],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "_q_readFromSocket",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "147-362",
          "snippet": "void QwwSmtpClientPrivate::_q_readFromSocket() {\n    while (socket->canReadLine()) {\n        QString line = socket->readLine();\n        qDebug() << \"SMTP <<<\" << line.toUtf8().constData();\n        QRegExp rx(\"(\\\\d+)-(.*)\\n\");        // multiline response (aka 250-XYZ)\n        QRegExp rxlast(\"(\\\\d+) (.*)\\n\");    // single or last line response (aka 250 XYZ)\n        bool mid = rx.exactMatch(line);\n        bool last = rxlast.exactMatch(line);\n        // multiline\n        if (mid){\n            int status = rx.cap(1).toInt();\n            SMTPCommand &cmd = commandqueue.head();\n            switch (cmd.type) {\n            // trying to connect\n            case SMTPCommand::Connect: {\n                    int stage = cmd.extra.toInt();\n                    // stage 0 completed with success - socket is connected and EHLO was sent\n                    if(stage==1 && status==250){\n                        QString arg = rx.cap(2).trimmed();\n                        parseOption(arg);   // we're probably receiving options\n                    }\n                }\n                break;\n            // trying to establish deferred SSL handshake\n            case SMTPCommand::StartTLS: {\n                    int stage = cmd.extra.toInt();\n                    // stage 0 (negotiation) completed ok\n                    if(stage==1 && status==250){\n                        QString arg = rx.cap(2).trimmed();\n                        parseOption(arg);   // we're probably receiving options\n                    }\n                }\n                default: break;\n            }\n        } else\n        // single line\n        if (last) {\n            int status = rxlast.cap(1).toInt();\n            SMTPCommand &cmd = commandqueue.head();\n            switch (cmd.type) {\n            // trying to connect\n            case SMTPCommand::Connect: {\n                int stage = cmd.extra.toInt();\n                // connection established, server sent its banner\n                if (stage==0 && status==220) {\n                    sendEhlo(); // connect ok, send ehlo\n                }\n                // server responded to EHLO\n                if (stage==1 && status==250){\n                    // success (EHLO)\n                    parseOption(rxlast.cap(2).trimmed()); // we're probably receiving the last option\n                    errorString.clear();\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand();\n                }\n                // server responded to HELO (EHLO failed)\n                if (state==2 && status==250) {\n                    // success (HELO)\n                    errorString.clear();\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand();\n                }\n                // EHLO failed, reason given in errorString\n                if (stage==1 && (status==554 || status==501 || status==502 || status==421)) {\n                    errorString = rxlast.cap(2).trimmed();\n                    sendHelo(); // ehlo failed, send helo\n                    cmd.extra = 2;\n                }\n                //abortDialog();\n            }\n            break;\n            // trying to establish a delayed SSL handshake\n            case SMTPCommand::StartTLS: {\n                int stage = cmd.extra.toInt();\n                // received an invitation from the server to enter TLS mode\n                if (stage==0 && status==220) {\n                    qDebug() << \"SMTP ** startClientEncruption\";\n                    socket->startClientEncryption();\n                }\n                // TLS established, connection is encrypted, EHLO was sent\n                else if (stage==1 && status==250) {\n                    setState(QwwSmtpClient::Connected);\n                    parseOption(rxlast.cap(2).trimmed());   // we're probably receiving options\n                    errorString.clear();\n                    emit q->tlsStarted();\n                    processNextCommand();\n                }\n                // starttls failed\n                else {\n                    qDebug() << \"TLS failed at stage \" << stage << \": \" << line;\n                    errorString = \"TLS failed\";\n                    emit q->done(false);\n                }\n            }\n            break;\n            // trying to authenticate the client to the server\n            case SMTPCommand::Authenticate: {\n                int stage = cmd.extra.toInt();\n                if (stage==0 && status==334) {\n                    // AUTH mode was accepted by the server, 1st challenge sent\n                    QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n                    errorString.clear();\n                    switch (authmode) {\n                    case QwwSmtpClient::AuthPlain:\n                        sendAuthPlain(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString());\n                        break;\n                    case QwwSmtpClient::AuthLogin:\n                        sendAuthLogin(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString(), 1);\n                        break;\n                    default:\n                        qWarning(\"I shouldn't be here\");\n                        setState(QwwSmtpClient::Connected);\n                        processNextCommand();\n                        break;\n                    }\n                    cmd.extra = stage+1;\n                } else if (stage==1 && status==334) {\n                    // AUTH mode and user names were acccepted by the server, 2nd challenge sent\n                    QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n                    errorString.clear();\n                    switch (authmode) {\n                    case QwwSmtpClient::AuthPlain:\n                        // auth failed\n                        setState(QwwSmtpClient::Connected);\n                        processNextCommand();\n                        break;\n                    case QwwSmtpClient::AuthLogin:\n                        sendAuthLogin(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString(), 2);\n                        break;\n                    default:\n                        qWarning(\"I shouldn't be here\");\n                        setState(QwwSmtpClient::Connected);\n                        processNextCommand();\n                        break;\n                    }\n                } else if (stage==2 && status==334) {\n                    // auth failed\n                    errorString = rxlast.cap(2).trimmed();\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand();\n                } else if (status==235) {\n                    // auth ok\n                    errorString.clear();\n                    emit q->authenticated();\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand();\n                } else {\n                    errorString = rxlast.cap(2).trimmed();\n                    setState(QwwSmtpClient::Connected);\n                    emit q->done(false);\n                }\n            }\n            break;\n            // trying to send mail\n            case SMTPCommand::Mail:\n            case SMTPCommand::MailBurl:\n            {\n                int stage = cmd.extra.toInt();\n                // temporary failure upon receiving the sender address (greylisting probably)\n                if (status==421 && stage==0) {\n                    errorString = rxlast.cap(2).trimmed();\n                    // temporary envelope failure (greylisting)\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand(false);\n                }\n                if (status==250 && stage==0) {\n                    // sender accepted\n                    errorString.clear();\n                    sendRcpt();\n                } else if (status==250 && stage==1) {\n                    // all receivers accepted\n                    if (cmd.type == SMTPCommand::MailBurl) {\n                        errorString.clear();\n                        QByteArray url = cmd.data.toList().at(2).toByteArray();\n                        qDebug() << \"SMTP >>> BURL\" << url << \"LAST\";\n                        socket->write(\"BURL \" + url + \" LAST\\r\\n\");\n                        cmd.extra=2;\n                    } else {\n                        errorString.clear();\n                        qDebug() << \"SMTP >>> DATA\";\n                        socket->write(\"DATA\\r\\n\");\n                        cmd.extra=2;\n                    }\n                } else if ((cmd.type == SMTPCommand::Mail && status==354 && stage==2)) {\n                    // DATA command accepted\n                    errorString.clear();\n                    QByteArray toBeWritten = cmd.data.toList().at(2).toString().toUtf8();\n                    qDebug() << \"SMTP >>>\" << toBeWritten << \"\\r\\n.\\r\\n\";\n                    socket->write(toBeWritten); // expecting data to be already escaped (CRLF.CRLF)\n                    socket->write(\"\\r\\n.\\r\\n\"); // termination token - CRLF.CRLF\n                    cmd.extra=3;\n                } else if ((cmd.type == SMTPCommand::MailBurl && status==250 && stage==2)) {\n                    // BURL succeeded\n                    setState(QwwSmtpClient::Connected);\n                    errorString.clear();\n                    processNextCommand();\n                } else if ((cmd.type == SMTPCommand::Mail && status==250 && stage==3)) {\n                    // mail queued\n                    setState(QwwSmtpClient::Connected);\n                    errorString.clear();\n                    processNextCommand();\n                } else {\n                    // something went wrong\n                    errorString = rxlast.cap(2).trimmed();\n                    setState(QwwSmtpClient::Connected);\n                    emit q->done(false);\n                    processNextCommand();\n                }\n            }\n                default: break;\n            }\n        } else {\n            qDebug() << \"None of two regular expressions matched the input\" << line;\n        }\n    }\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::_q_readFromSocket() {\n      while (socket->canReadLine()) {\n          QString line = socket->readLine();\n          qDebug() << \"SMTP <<<\" << line.toUtf8().constData();\n          QRegExp rx(\"(\\\\d+)-(.*)\\n\");        // multiline response (aka 250-XYZ)\n          QRegExp rxlast(\"(\\\\d+) (.*)\\n\");    // single or last line response (aka 250 XYZ)\n          bool mid = rx.exactMatch(line);\n          bool last = rxlast.exactMatch(line);\n          // multiline\n          if (mid){\n              int status = rx.cap(1).toInt();\n              SMTPCommand &cmd = commandqueue.head();\n              switch (cmd.type) {\n              // trying to connect\n              case SMTPCommand::Connect: {\n                      int stage = cmd.extra.toInt();\n                      // stage 0 completed with success - socket is connected and EHLO was sent\n                      if(stage==1 && status==250){\n                          QString arg = rx.cap(2).trimmed();\n                          parseOption(arg);   // we're probably receiving options\n                      }\n                  }\n                  break;\n              // trying to establish deferred SSL handshake\n              case SMTPCommand::StartTLS: {\n                      int stage = cmd.extra.toInt();\n                      // stage 0 (negotiation) completed ok\n                      if(stage==1 && status==250){\n                          QString arg = rx.cap(2).trimmed();\n                          parseOption(arg);   // we're probably receiving options\n                      }\n                  }\n                  default: break;\n              }\n          } else\n          // single line\n          if (last) {\n              int status = rxlast.cap(1).toInt();\n              SMTPCommand &cmd = commandqueue.head();\n              switch (cmd.type) {\n              // trying to connect\n              case SMTPCommand::Connect: {\n                  int stage = cmd.extra.toInt();\n                  // connection established, server sent its banner\n                  if (stage==0 && status==220) {\n                      sendEhlo(); // connect ok, send ehlo\n                  }\n                  // server responded to EHLO\n                  if (stage==1 && status==250){\n                      // success (EHLO)\n                      parseOption(rxlast.cap(2).trimmed()); // we're probably receiving the last option\n                      errorString.clear();\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand();\n                  }\n                  // server responded to HELO (EHLO failed)\n                  if (state==2 && status==250) {\n                      // success (HELO)\n                      errorString.clear();\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand();\n                  }\n                  // EHLO failed, reason given in errorString\n                  if (stage==1 && (status==554 || status==501 || status==502 || status==421)) {\n                      errorString = rxlast.cap(2).trimmed();\n                      sendHelo(); // ehlo failed, send helo\n                      cmd.extra = 2;\n                  }\n                  //abortDialog();\n              }\n              break;\n              // trying to establish a delayed SSL handshake\n              case SMTPCommand::StartTLS: {\n                  int stage = cmd.extra.toInt();\n                  // received an invitation from the server to enter TLS mode\n                  if (stage==0 && status==220) {\n                      qDebug() << \"SMTP ** startClientEncruption\";\n                      socket->startClientEncryption();\n                  }\n                  // TLS established, connection is encrypted, EHLO was sent\n                  else if (stage==1 && status==250) {\n                      setState(QwwSmtpClient::Connected);\n                      parseOption(rxlast.cap(2).trimmed());   // we're probably receiving options\n                      errorString.clear();\n                      emit q->tlsStarted();\n                      processNextCommand();\n                  }\n                  // starttls failed\n                  else {\n                      qDebug() << \"TLS failed at stage \" << stage << \": \" << line;\n                      errorString = \"TLS failed\";\n                      emit q->done(false);\n                  }\n              }\n              break;\n              // trying to authenticate the client to the server\n              case SMTPCommand::Authenticate: {\n                  int stage = cmd.extra.toInt();\n                  if (stage==0 && status==334) {\n                      // AUTH mode was accepted by the server, 1st challenge sent\n                      QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n                      errorString.clear();\n                      switch (authmode) {\n                      case QwwSmtpClient::AuthPlain:\n                          sendAuthPlain(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString());\n                          break;\n                      case QwwSmtpClient::AuthLogin:\n                          sendAuthLogin(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString(), 1);\n                          break;\n                      default:\n                          qWarning(\"I shouldn't be here\");\n                          setState(QwwSmtpClient::Connected);\n                          processNextCommand();\n                          break;\n                      }\n                      cmd.extra = stage+1;\n                  } else if (stage==1 && status==334) {\n                      // AUTH mode and user names were acccepted by the server, 2nd challenge sent\n                      QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n                      errorString.clear();\n                      switch (authmode) {\n                      case QwwSmtpClient::AuthPlain:\n                          // auth failed\n                          setState(QwwSmtpClient::Connected);\n                          processNextCommand();\n                          break;\n                      case QwwSmtpClient::AuthLogin:\n                          sendAuthLogin(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString(), 2);\n                          break;\n                      default:\n                          qWarning(\"I shouldn't be here\");\n                          setState(QwwSmtpClient::Connected);\n                          processNextCommand();\n                          break;\n                      }\n                  } else if (stage==2 && status==334) {\n                      // auth failed\n                      errorString = rxlast.cap(2).trimmed();\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand();\n                  } else if (status==235) {\n                      // auth ok\n                      errorString.clear();\n                      emit q->authenticated();\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand();\n                  } else {\n                      errorString = rxlast.cap(2).trimmed();\n                      setState(QwwSmtpClient::Connected);\n                      emit q->done(false);\n                  }\n              }\n              break;\n              // trying to send mail\n              case SMTPCommand::Mail:\n              case SMTPCommand::MailBurl:\n              {\n                  int stage = cmd.extra.toInt();\n                  // temporary failure upon receiving the sender address (greylisting probably)\n                  if (status==421 && stage==0) {\n                      errorString = rxlast.cap(2).trimmed();\n                      // temporary envelope failure (greylisting)\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand(false);\n                  }\n                  if (status==250 && stage==0) {\n                      // sender accepted\n                      errorString.clear();\n                      sendRcpt();\n                  } else if (status==250 && stage==1) {\n                      // all receivers accepted\n                      if (cmd.type == SMTPCommand::MailBurl) {\n                          errorString.clear();\n                          QByteArray url = cmd.data.toList().at(2).toByteArray();\n                          qDebug() << \"SMTP >>> BURL\" << url << \"LAST\";\n                          socket->write(\"BURL \" + url + \" LAST\\r\\n\");\n                          cmd.extra=2;\n                      } else {\n                          errorString.clear();\n                          qDebug() << \"SMTP >>> DATA\";\n                          socket->write(\"DATA\\r\\n\");\n                          cmd.extra=2;\n                      }\n                  } else if ((cmd.type == SMTPCommand::Mail && status==354 && stage==2)) {\n                      // DATA command accepted\n                      errorString.clear();\n                      QByteArray toBeWritten = cmd.data.toList().at(2).toString().toUtf8();\n                      qDebug() << \"SMTP >>>\" << toBeWritten << \"\\r\\n.\\r\\n\";\n                      socket->write(toBeWritten); // expecting data to be already escaped (CRLF.CRLF)\n                      socket->write(\"\\r\\n.\\r\\n\"); // termination token - CRLF.CRLF\n                      cmd.extra=3;\n                  } else if ((cmd.type == SMTPCommand::MailBurl && status==250 && stage==2)) {\n                      // BURL succeeded\n                      setState(QwwSmtpClient::Connected);\n                      errorString.clear();\n                      processNextCommand();\n                  } else if ((cmd.type == SMTPCommand::Mail && status==250 && stage==3)) {\n                      // mail queued\n                      setState(QwwSmtpClient::Connected);\n                      errorString.clear();\n                      processNextCommand();\n                  } else {\n                      // something went wrong\n                      errorString = rxlast.cap(2).trimmed();\n                      setState(QwwSmtpClient::Connected);\n                      emit q->done(false);\n                      processNextCommand();\n                  }\n              }\n                  default: break;\n              }\n          } else {\n              qDebug() << \"None of two regular expressions matched the input\" << line;\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "readyRead()"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readyRead",
          "args": [],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "d->socket",
            "SIGNAL(disconnected())",
            "this",
            "SLOT(onDisconnected())"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "onDisconnected()"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onDisconnected",
          "args": [],
          "line": 556
        },
        "resolved": true,
        "details": {
          "function_name": "onDisconnected",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "119-137",
          "snippet": "void QwwSmtpClientPrivate::onDisconnected() {\n    setState(QwwSmtpClient::Disconnected);\n    if (commandqueue.isEmpty()) {\n        inProgress = false;\n        emit q->done(true);\n        return;\n    }\n\n    if (commandqueue.head().type == SMTPCommand::Disconnect) {\n        inProgress = false;\n        emit q->done(true);\n        return;\n    }\n\n    emit q->commandFinished(commandqueue.head().id, true);\n    commandqueue.clear();\n    inProgress = false;\n    emit q->done(false);\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::onDisconnected() {\n      setState(QwwSmtpClient::Disconnected);\n      if (commandqueue.isEmpty()) {\n          inProgress = false;\n          emit q->done(true);\n          return;\n      }\n  \n      if (commandqueue.head().type == SMTPCommand::Disconnect) {\n          inProgress = false;\n          emit q->done(true);\n          return;\n      }\n  \n      emit q->commandFinished(commandqueue.head().id, true);\n      commandqueue.clear();\n      inProgress = false;\n      emit q->done(false);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "disconnected()"
          ],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "disconnected",
          "args": [],
          "line": 556
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "d->socket",
            "SIGNAL(error(QAbstractSocket::SocketError))",
            "this",
            "SLOT(onError(QAbstractSocket::SocketError))"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "onError(QAbstractSocket::SocketError)"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onError",
          "args": [
            "QAbstractSocket::SocketError"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "onError",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "139-143",
          "snippet": "void QwwSmtpClientPrivate::onError(QAbstractSocket::SocketError e)\n{\n    emit q->socketError(e, socket->errorString());\n    onDisconnected();\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::onError(QAbstractSocket::SocketError e)\n  {\n      emit q->socketError(e, socket->errorString());\n      onDisconnected();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "error(QAbstractSocket::SocketError)"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "error",
          "args": [
            "QAbstractSocket::SocketError"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "errorsToHtml(",
          "container": "ertificateUtils",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Utils.cpp",
          "lines": "362-375",
          "snippet": "String CertificateUtils::errorsToHtml(const QList<QSslError> &sslErrors)\n{\n    QStringList sslErrorStrings;\n    Q_FOREACH(const QSslError &e, sslErrors) {\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n        sslErrorStrings << tr(\"<li>%1</li>\").arg(e.errorString().toHtmlEscaped());\n#else\n        sslErrorStrings << tr(\"<li>%1</li>\").arg(Qt::escape(e.errorString()));\n#endif\n    }\n    return sslErrors.isEmpty() ?\n                QString(\"<p>According to your system's policy, this connection is secure.</p>\\n\") :\n                tr(\"<p>The connection triggered the following SSL errors:</p>\\n<ul>%1</ul>\\n\").arg(sslErrorStrings.join(tr(\"\\n\")));\n}",
          "includes": [
            "include <QSystemDeviceInfo>\n#",
            "include \"Imap/Model/Model.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include <QTextDocument>",
            "include <QSysInfo>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSettings>\n#",
            "include <QProcess>\n#",
            "include <QLocale>\n#",
            "include <QGuiApplication>\n#",
            "include <QDir>\n#",
            "include <QDateTime>\n#",
            "include <cmath>\n#",
            "include \"Utils.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QSystemDeviceInfo>\n#\ninclude \"Imap/Model/Model.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude <QTextDocument>\ninclude <QSysInfo>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSettings>\n#\ninclude <QProcess>\n#\ninclude <QLocale>\n#\ninclude <QGuiApplication>\n#\ninclude <QDir>\n#\ninclude <QDateTime>\n#\ninclude <cmath>\n#\ninclude \"Utils.h\"\n#\n\nertificateUtils {\n  String CertificateUtils::errorsToHtml(const QList<QSslError> &sslErrors)\n  {\n      QStringList sslErrorStrings;\n      Q_FOREACH(const QSslError &e, sslErrors) {\n  #if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n          sslErrorStrings << tr(\"<li>%1</li>\").arg(e.errorString().toHtmlEscaped());\n  #else\n          sslErrorStrings << tr(\"<li>%1</li>\").arg(Qt::escape(e.errorString()));\n  #endif\n      }\n      return sslErrors.isEmpty() ?\n                  QString(\"<p>According to your system's policy, this connection is secure.</p>\\n\") :\n                  tr(\"<p>The connection triggered the following SSL errors:</p>\\n<ul>%1</ul>\\n\").arg(sslErrorStrings.join(tr(\"\\n\")));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "d->socket",
            "SIGNAL(connected())",
            "this",
            "SLOT(onConnected())"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "onConnected()"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onConnected",
          "args": [],
          "line": 554
        },
        "resolved": true,
        "details": {
          "function_name": "onConnected",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "109-114",
          "snippet": "void QwwSmtpClientPrivate::onConnected() {\n    options = QwwSmtpClient::NoOptions;\n    authModes = QwwSmtpClient::AuthNone;\n    emit q->stateChanged(QwwSmtpClient::Connected);\n    emit q->connected();\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::onConnected() {\n      options = QwwSmtpClient::NoOptions;\n      authModes = QwwSmtpClient::AuthNone;\n      emit q->stateChanged(QwwSmtpClient::Connected);\n      emit q->connected();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "connected()"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QwwSmtpClient::QwwSmtpClient(QObject *parent)\n          : QObject(parent), d(new QwwSmtpClientPrivate(this)) {\n      d->state = Disconnected;\n      d->lastId = 0;\n      d->inProgress = false;\n      d->localName = \"localhost\";\n      d->socket = new QSslSocket(this);\n      connect(d->socket, SIGNAL(connected()), this, SLOT(onConnected()));\n      connect(d->socket, SIGNAL(error(QAbstractSocket::SocketError)), this, SLOT(onError(QAbstractSocket::SocketError)) );\n      connect(d->socket, SIGNAL(disconnected()), this, SLOT(onDisconnected()));\n      connect(d->socket, SIGNAL(readyRead()), this, SLOT(_q_readFromSocket()));\n      connect(d->socket, SIGNAL(sslErrors(const QList<QSslError> &)), this, SIGNAL(sslErrors(const QList<QSslError>&)));\n      connect(d->socket, SIGNAL(encrypted()), this, SLOT(_q_encrypted()));\n  }\n}"
  },
  {
    "function_name": "parseOption",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "528-544",
    "snippet": "void QwwSmtpClientPrivate::parseOption(const QString &buffer){\n    if(buffer.toLower()==\"pipelining\"){                     options |= QwwSmtpClient::PipeliningOption;     }\n    else if(buffer.toLower()==\"starttls\"){                  options |= QwwSmtpClient::StartTlsOption;       }\n    else if(buffer.toLower()==\"8bitmime\"){                  options |= QwwSmtpClient::EightBitMimeOption;   }\n    else if(buffer.toLower().startsWith(\"auth \")){          options |= QwwSmtpClient::AuthOption;\n        // parse auth modes\n        QStringList slist = buffer.mid(5).split(\" \");\n        foreach(const QString &s, slist){\n            if(s.toLower()==\"plain\"){\n                authModes |= QwwSmtpClient::AuthPlain;\n            }\n            if(s.toLower()==\"login\"){\n                authModes |= QwwSmtpClient::AuthLogin;\n            }\n        }\n    }\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.toLower",
          "args": [],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.toLower",
          "args": [],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.mid",
          "args": [
            "\" \""
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.mid",
          "args": [
            "5"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.toLower",
          "args": [
            "\"auth \""
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.toLower",
          "args": [],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.toLower",
          "args": [],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.toLower",
          "args": [],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer.toLower",
          "args": [],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::parseOption(const QString &buffer){\n      if(buffer.toLower()==\"pipelining\"){                     options |= QwwSmtpClient::PipeliningOption;     }\n      else if(buffer.toLower()==\"starttls\"){                  options |= QwwSmtpClient::StartTlsOption;       }\n      else if(buffer.toLower()==\"8bitmime\"){                  options |= QwwSmtpClient::EightBitMimeOption;   }\n      else if(buffer.toLower().startsWith(\"auth \")){          options |= QwwSmtpClient::AuthOption;\n          // parse auth modes\n          QStringList slist = buffer.mid(5).split(\" \");\n          foreach(const QString &s, slist){\n              if(s.toLower()==\"plain\"){\n                  authModes |= QwwSmtpClient::AuthPlain;\n              }\n              if(s.toLower()==\"login\"){\n                  authModes |= QwwSmtpClient::AuthLogin;\n              }\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "sendAuthLogin",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "516-526",
    "snippet": "void QwwSmtpClientPrivate::sendAuthLogin(const QString & username, const QString & password, int stage) {\n    if (stage==1) {\n        qDebug() << \"SMTP <<< [login username]\";\n        socket->write(username.toUtf8().toBase64());\n        socket->write(\"\\r\\n\");\n    } else if (stage==2) {\n        qDebug() << \"SMTP <<< [login password]\";\n        socket->write(password.toUtf8().toBase64());\n        socket->write(\"\\r\\n\");\n    }\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "password.toUtf8().toBase64()"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "password.toUtf8",
          "args": [],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "password.toUtf8",
          "args": [],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "username.toUtf8().toBase64()"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "username.toUtf8",
          "args": [],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "username.toUtf8",
          "args": [],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendAuthLogin(const QString & username, const QString & password, int stage) {\n      if (stage==1) {\n          qDebug() << \"SMTP <<< [login username]\";\n          socket->write(username.toUtf8().toBase64());\n          socket->write(\"\\r\\n\");\n      } else if (stage==2) {\n          qDebug() << \"SMTP <<< [login password]\";\n          socket->write(password.toUtf8().toBase64());\n          socket->write(\"\\r\\n\");\n      }\n  }\n}"
  },
  {
    "function_name": "sendAuthPlain",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "504-514",
    "snippet": "void QwwSmtpClientPrivate::sendAuthPlain(const QString & username, const QString & password) {\n    QByteArray ba;\n    ba.append('\\0');\n    ba.append(username.toUtf8());\n    ba.append('\\0');\n    ba.append(password.toUtf8());\n    QByteArray encoded = ba.toBase64();\n    qDebug() << \"SMTP <<< [authentication data]\";\n    socket->write(encoded);\n    socket->write(\"\\r\\n\");\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "encoded"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 511
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ba.toBase64",
          "args": [],
          "line": 510
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ba.append",
          "args": [
            "password.toUtf8()"
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "password.toUtf8",
          "args": [],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ba.append",
          "args": [
            "'\\0'"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ba.append",
          "args": [
            "username.toUtf8()"
          ],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "username.toUtf8",
          "args": [],
          "line": 507
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ba.append",
          "args": [
            "'\\0'"
          ],
          "line": 506
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendAuthPlain(const QString & username, const QString & password) {\n      QByteArray ba;\n      ba.append('\\0');\n      ba.append(username.toUtf8());\n      ba.append('\\0');\n      ba.append(password.toUtf8());\n      QByteArray encoded = ba.toBase64();\n      qDebug() << \"SMTP <<< [authentication data]\";\n      socket->write(encoded);\n      socket->write(\"\\r\\n\");\n  }\n}"
  },
  {
    "function_name": "sendRcpt",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "488-500",
    "snippet": "void QwwSmtpClientPrivate::sendRcpt() {\n    SMTPCommand &cmd = commandqueue.head();\n    QVariantList vlist = cmd.data.toList();\n    QList<QVariant> rcptlist = vlist.at(1).toList();\n    QByteArray buf = QByteArray(\"RCPT TO:<\").append(rcptlist.first().toByteArray()).append(\">\\r\\n\");\n    qDebug() << \"SMTP >>>\" << buf;\n    socket->write(buf);\n    rcptlist.removeFirst();\n    vlist[1] = rcptlist;\n    cmd.data = vlist;\n\n    if (rcptlist.isEmpty()) cmd.extra = 1;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rcptlist.isEmpty",
          "args": [],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcptlist.removeFirst",
          "args": [],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "buf"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QByteArray",
          "args": [
            "\">\\r\\n\""
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QByteArray",
          "args": [
            "rcptlist.first().toByteArray()"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rcptlist.first",
          "args": [],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "first",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "293-316",
          "snippet": "bool XSqlQuery::first()\n{\n  if (QSqlQuery::first())\n  {\n    if (_data)\n    {\n      if (_data->_keepTotals)\n      {\n        // initial all our values\n        resetSubTotals();\n        QMapIterator<QString,double> mit(_data->_fieldTotals);\n        while(mit.hasNext())\n        {\n          mit.next();\n          _data->_fieldTotals[mit.key()] = value(mit.key()).toDouble();\n          _data->_fieldSubTotals[mit.key()] = value(mit.key()).toDouble();\n        }\n      }\n      _data->_currRecord = record();\n    }\n    return true;\n  }\n  return false;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::first()\n  {\n    if (QSqlQuery::first())\n    {\n      if (_data)\n      {\n        if (_data->_keepTotals)\n        {\n          // initial all our values\n          resetSubTotals();\n          QMapIterator<QString,double> mit(_data->_fieldTotals);\n          while(mit.hasNext())\n          {\n            mit.next();\n            _data->_fieldTotals[mit.key()] = value(mit.key()).toDouble();\n            _data->_fieldSubTotals[mit.key()] = value(mit.key()).toDouble();\n          }\n        }\n        _data->_currRecord = record();\n      }\n      return true;\n    }\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QByteArray",
          "args": [
            "\"RCPT TO:<\""
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vlist.at",
          "args": [],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vlist.at",
          "args": [
            "1"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendRcpt() {\n      SMTPCommand &cmd = commandqueue.head();\n      QVariantList vlist = cmd.data.toList();\n      QList<QVariant> rcptlist = vlist.at(1).toList();\n      QByteArray buf = QByteArray(\"RCPT TO:<\").append(rcptlist.first().toByteArray()).append(\">\\r\\n\");\n      qDebug() << \"SMTP >>>\" << buf;\n      socket->write(buf);\n      rcptlist.removeFirst();\n      vlist[1] = rcptlist;\n      cmd.data = vlist;\n  \n      if (rcptlist.isEmpty()) cmd.extra = 1;\n  }\n}"
  },
  {
    "function_name": "sendQuit",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "480-486",
    "snippet": "void QwwSmtpClientPrivate::sendQuit() {\n    qDebug() << \"SMTP >>> QUIT\";\n    socket->write(\"QUIT\\r\\n\");\n    socket->waitForBytesWritten(1000);\n    socket->disconnectFromHost();\n    setState(QwwSmtpClient::Disconnecting);\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setState",
          "args": [
            "QwwSmtpClient::Disconnecting"
          ],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "setState",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "364-370",
          "snippet": "void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n    QwwSmtpClient::State old = state;\n    state = s;\n    emit q->stateChanged(s);\n    if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n    if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n      QwwSmtpClient::State old = state;\n      state = s;\n      emit q->stateChanged(s);\n      if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n      if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket->disconnectFromHost",
          "args": [],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "disconnectFromHost",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "596-604",
          "snippet": "int QwwSmtpClient::disconnectFromHost() {\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Disconnect;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::disconnectFromHost() {\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Disconnect;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket->waitForBytesWritten",
          "args": [
            "1000"
          ],
          "line": 483
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"QUIT\\r\\n\""
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendQuit() {\n      qDebug() << \"SMTP >>> QUIT\";\n      socket->write(\"QUIT\\r\\n\");\n      socket->waitForBytesWritten(1000);\n      socket->disconnectFromHost();\n      setState(QwwSmtpClient::Disconnecting);\n  }\n}"
  },
  {
    "function_name": "sendHelo",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "468-477",
    "snippet": "void QwwSmtpClientPrivate::sendHelo() {\n    SMTPCommand &cmd = commandqueue.head();\n    QString domain = localName;\n    if (socket->isEncrypted() && localNameEncrypted.isEmpty())\n        domain = localNameEncrypted;\n    QByteArray buf = QString(\"HELO \"+domain+\"\\r\\n\").toUtf8();\n    qDebug() << \"SMTP >>>\" << buf;\n    socket->write(buf);\n    cmd.extra = 1;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "buf"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 473
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"HELO \"+domain+\"\\r\\n\""
          ],
          "line": 473
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessageFileNameRequested(QString",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1702-1706",
          "snippet": "Window::slotDownloadMessageFileNameRequested(QString *fileName)\n{\n    *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Message\"), *fileName, QString(), 0,\n                                             QFileDialog::HideNameFilterDetails);\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotDownloadMessageFileNameRequested(QString *fileName)\n  {\n      *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Message\"), *fileName, QString(), 0,\n                                               QFileDialog::HideNameFilterDetails);\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "localNameEncrypted.isEmpty",
          "args": [],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->isEncrypted",
          "args": [],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendHelo() {\n      SMTPCommand &cmd = commandqueue.head();\n      QString domain = localName;\n      if (socket->isEncrypted() && localNameEncrypted.isEmpty())\n          domain = localNameEncrypted;\n      QByteArray buf = QString(\"HELO \"+domain+\"\\r\\n\").toUtf8();\n      qDebug() << \"SMTP >>>\" << buf;\n      socket->write(buf);\n      cmd.extra = 1;\n  }\n}"
  },
  {
    "function_name": "sendEhlo",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "456-465",
    "snippet": "void QwwSmtpClientPrivate::sendEhlo() {\n    SMTPCommand &cmd = commandqueue.head();\n    QString domain = localName;\n    if (socket->isEncrypted() && !localNameEncrypted.isEmpty())\n        domain = localNameEncrypted;\n    QByteArray buf = QString(\"EHLO \"+domain+\"\\r\\n\").toUtf8();\n    qDebug() << \"SMTP >>>\" << buf;\n    socket->write(buf);\n    cmd.extra = 1;\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "buf"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"EHLO \"+domain+\"\\r\\n\""
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessageFileNameRequested(QString",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1702-1706",
          "snippet": "Window::slotDownloadMessageFileNameRequested(QString *fileName)\n{\n    *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Message\"), *fileName, QString(), 0,\n                                             QFileDialog::HideNameFilterDetails);\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotDownloadMessageFileNameRequested(QString *fileName)\n  {\n      *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Message\"), *fileName, QString(), 0,\n                                               QFileDialog::HideNameFilterDetails);\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "localNameEncrypted.isEmpty",
          "args": [],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->isEncrypted",
          "args": [],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendEhlo() {\n      SMTPCommand &cmd = commandqueue.head();\n      QString domain = localName;\n      if (socket->isEncrypted() && !localNameEncrypted.isEmpty())\n          domain = localNameEncrypted;\n      QByteArray buf = QString(\"EHLO \"+domain+\"\\r\\n\").toUtf8();\n      qDebug() << \"SMTP >>>\" << buf;\n      socket->write(buf);\n      cmd.extra = 1;\n  }\n}"
  },
  {
    "function_name": "_q_encrypted",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "448-453",
    "snippet": "void QwwSmtpClientPrivate::_q_encrypted() {\n        options = QwwSmtpClient::NoOptions;\n    // forget everything, restart ehlo\n//    SMTPCommand &cmd = commandqueue.head();\n    sendEhlo();\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sendEhlo",
          "args": [],
          "line": 452
        },
        "resolved": true,
        "details": {
          "function_name": "sendEhlo",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "456-465",
          "snippet": "void QwwSmtpClientPrivate::sendEhlo() {\n    SMTPCommand &cmd = commandqueue.head();\n    QString domain = localName;\n    if (socket->isEncrypted() && !localNameEncrypted.isEmpty())\n        domain = localNameEncrypted;\n    QByteArray buf = QString(\"EHLO \"+domain+\"\\r\\n\").toUtf8();\n    qDebug() << \"SMTP >>>\" << buf;\n    socket->write(buf);\n    cmd.extra = 1;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendEhlo() {\n      SMTPCommand &cmd = commandqueue.head();\n      QString domain = localName;\n      if (socket->isEncrypted() && !localNameEncrypted.isEmpty())\n          domain = localNameEncrypted;\n      QByteArray buf = QString(\"EHLO \"+domain+\"\\r\\n\").toUtf8();\n      qDebug() << \"SMTP >>>\" << buf;\n      socket->write(buf);\n      cmd.extra = 1;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::_q_encrypted() {\n          options = QwwSmtpClient::NoOptions;\n      // forget everything, restart ehlo\n  //    SMTPCommand &cmd = commandqueue.head();\n      sendEhlo();\n  }\n}"
  },
  {
    "function_name": "processNextCommand",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "372-446",
    "snippet": "void QwwSmtpClientPrivate::processNextCommand(bool ok) {\n    if (inProgress && !commandqueue.isEmpty()) {\n        emit q->commandFinished(commandqueue.head().id, !ok);\n        commandqueue.dequeue();\n    }\n    if (commandqueue.isEmpty()) {\n        inProgress = false;\n        emit q->done(false);\n        return;\n    }\n    const SMTPCommand &cmd = commandqueue.head();\n    switch (cmd.type) {\n    case SMTPCommand::Connect: {\n        QString hostName = cmd.data.toList().at(0).toString();\n        uint port = cmd.data.toList().at(1).toUInt();\n        bool ssl = cmd.data.toList().at(2).toBool();\n        if(ssl){\n            qDebug() << \"SMTP ** connectToHostEncrypted\";\n            socket->connectToHostEncrypted(hostName, port);\n        } else {\n            qDebug() << \"SMTP ** connectToHost\";\n            socket->connectToHost(hostName, port);\n        }\n        setState(QwwSmtpClient::Connecting);\n    }\n    break;\n    case SMTPCommand::Disconnect: {\n        sendQuit();\n    }\n    break;\n    case SMTPCommand::StartTLS: {\n        qDebug() << \"SMTP >>> STARTTLS\";\n        socket->write(\"STARTTLS\\r\\n\");\n        setState(QwwSmtpClient::TLSRequested);\n    }\n    break;\n    case SMTPCommand::Authenticate: {\n        QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n        switch (authmode) {\n        case QwwSmtpClient::AuthPlain:\n            qDebug() << \"SMTP >>> AUTH PLAIN\";\n            socket->write(\"AUTH PLAIN\\r\\n\");\n            setState(QwwSmtpClient::Authenticating);\n            break;\n        case QwwSmtpClient::AuthLogin:\n            qDebug() << \"SMTP >>> AUTH LOGIN\";\n            socket->write(\"AUTH LOGIN\\r\\n\");\n            setState(QwwSmtpClient::Authenticating);\n            break;\n        default:\n            qWarning(\"Unsupported or unknown authentication scheme\");\n            //processNextCommand(false);\n        }\n    }\n    break;\n    case SMTPCommand::Mail:\n    case SMTPCommand::MailBurl:\n    {\n        setState(QwwSmtpClient::Sending);\n        QByteArray buf = QByteArray(\"MAIL FROM:<\").append(cmd.data.toList().at(0).toByteArray()).append(\">\\r\\n\");\n        qDebug() << \"SMTP >>>\" << buf;\n        socket->write(buf);\n        break;\n    }\n    case SMTPCommand::RawCommand: {\n\tQString cont = cmd.data.toString();\n\tif(!cont.endsWith(\"\\r\\n\")) cont.append(\"\\r\\n\");\n    setState(QwwSmtpClient::Sending);\n    qDebug() << \"SMTP >>>\" << cont;\n\tsocket->write(cont.toUtf8());\n\t} break;\n    }\n    inProgress = true;\n    emit q->commandStarted(cmd.id);\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "cont.toUtf8()"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cont.toUtf8",
          "args": [],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setState",
          "args": [
            "QwwSmtpClient::Sending"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "setState",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "364-370",
          "snippet": "void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n    QwwSmtpClient::State old = state;\n    state = s;\n    emit q->stateChanged(s);\n    if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n    if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n      QwwSmtpClient::State old = state;\n      state = s;\n      emit q->stateChanged(s);\n      if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n      if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cont.append",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cont.endsWith",
          "args": [
            "\"\\r\\n\""
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toString",
          "args": [],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "buf"
          ],
          "line": 433
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QByteArray",
          "args": [
            "\">\\r\\n\""
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QByteArray",
          "args": [
            "cmd.data.toList().at(0).toByteArray()"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "0"
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QByteArray",
          "args": [
            "\"MAIL FROM:<\""
          ],
          "line": 431
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qWarning",
          "args": [
            "\"Unsupported or unknown authentication scheme\""
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"AUTH LOGIN\\r\\n\""
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"AUTH PLAIN\\r\\n\""
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "0"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"STARTTLS\\r\\n\""
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 403
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sendQuit",
          "args": [],
          "line": 399
        },
        "resolved": true,
        "details": {
          "function_name": "sendQuit",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "480-486",
          "snippet": "void QwwSmtpClientPrivate::sendQuit() {\n    qDebug() << \"SMTP >>> QUIT\";\n    socket->write(\"QUIT\\r\\n\");\n    socket->waitForBytesWritten(1000);\n    socket->disconnectFromHost();\n    setState(QwwSmtpClient::Disconnecting);\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendQuit() {\n      qDebug() << \"SMTP >>> QUIT\";\n      socket->write(\"QUIT\\r\\n\");\n      socket->waitForBytesWritten(1000);\n      socket->disconnectFromHost();\n      setState(QwwSmtpClient::Disconnecting);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket->connectToHost",
          "args": [
            "hostName",
            "port"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "connectToHost",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "567-576",
          "snippet": "int QwwSmtpClient::connectToHost(const QString & hostName, quint16 port) {\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Connect;\n    cmd.data = QVariantList() << hostName << port << false;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if (!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::connectToHost(const QString & hostName, quint16 port) {\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Connect;\n      cmd.data = QVariantList() << hostName << port << false;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if (!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->connectToHostEncrypted",
          "args": [
            "hostName",
            "port"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "connectToHostEncrypted",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "584-594",
          "snippet": "int QwwSmtpClient::connectToHostEncrypted(const QString & hostName, quint16 port)\n{\n    SMTPCommand cmd;\n    cmd.type = SMTPCommand::Connect;\n    cmd.data = QVariantList() << hostName << port << true;\n    cmd.id = ++d->lastId;\n    d->commandqueue.enqueue(cmd);\n    if(!d->inProgress)\n        d->processNextCommand();\n    return cmd.id;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  int QwwSmtpClient::connectToHostEncrypted(const QString & hostName, quint16 port)\n  {\n      SMTPCommand cmd;\n      cmd.type = SMTPCommand::Connect;\n      cmd.data = QVariantList() << hostName << port << true;\n      cmd.id = ++d->lastId;\n      d->commandqueue.enqueue(cmd);\n      if(!d->inProgress)\n          d->processNextCommand();\n      return cmd.id;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "2"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "1"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "0"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.isEmpty",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.dequeue",
          "args": [],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.isEmpty",
          "args": [],
          "line": 373
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::processNextCommand(bool ok) {\n      if (inProgress && !commandqueue.isEmpty()) {\n          emit q->commandFinished(commandqueue.head().id, !ok);\n          commandqueue.dequeue();\n      }\n      if (commandqueue.isEmpty()) {\n          inProgress = false;\n          emit q->done(false);\n          return;\n      }\n      const SMTPCommand &cmd = commandqueue.head();\n      switch (cmd.type) {\n      case SMTPCommand::Connect: {\n          QString hostName = cmd.data.toList().at(0).toString();\n          uint port = cmd.data.toList().at(1).toUInt();\n          bool ssl = cmd.data.toList().at(2).toBool();\n          if(ssl){\n              qDebug() << \"SMTP ** connectToHostEncrypted\";\n              socket->connectToHostEncrypted(hostName, port);\n          } else {\n              qDebug() << \"SMTP ** connectToHost\";\n              socket->connectToHost(hostName, port);\n          }\n          setState(QwwSmtpClient::Connecting);\n      }\n      break;\n      case SMTPCommand::Disconnect: {\n          sendQuit();\n      }\n      break;\n      case SMTPCommand::StartTLS: {\n          qDebug() << \"SMTP >>> STARTTLS\";\n          socket->write(\"STARTTLS\\r\\n\");\n          setState(QwwSmtpClient::TLSRequested);\n      }\n      break;\n      case SMTPCommand::Authenticate: {\n          QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n          switch (authmode) {\n          case QwwSmtpClient::AuthPlain:\n              qDebug() << \"SMTP >>> AUTH PLAIN\";\n              socket->write(\"AUTH PLAIN\\r\\n\");\n              setState(QwwSmtpClient::Authenticating);\n              break;\n          case QwwSmtpClient::AuthLogin:\n              qDebug() << \"SMTP >>> AUTH LOGIN\";\n              socket->write(\"AUTH LOGIN\\r\\n\");\n              setState(QwwSmtpClient::Authenticating);\n              break;\n          default:\n              qWarning(\"Unsupported or unknown authentication scheme\");\n              //processNextCommand(false);\n          }\n      }\n      break;\n      case SMTPCommand::Mail:\n      case SMTPCommand::MailBurl:\n      {\n          setState(QwwSmtpClient::Sending);\n          QByteArray buf = QByteArray(\"MAIL FROM:<\").append(cmd.data.toList().at(0).toByteArray()).append(\">\\r\\n\");\n          qDebug() << \"SMTP >>>\" << buf;\n          socket->write(buf);\n          break;\n      }\n      case SMTPCommand::RawCommand: {\n  \tQString cont = cmd.data.toString();\n  \tif(!cont.endsWith(\"\\r\\n\")) cont.append(\"\\r\\n\");\n      setState(QwwSmtpClient::Sending);\n      qDebug() << \"SMTP >>>\" << cont;\n  \tsocket->write(cont.toUtf8());\n  \t} break;\n      }\n      inProgress = true;\n      emit q->commandStarted(cmd.id);\n  }\n}"
  },
  {
    "function_name": "setState",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "364-370",
    "snippet": "void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n    QwwSmtpClient::State old = state;\n    state = s;\n    emit q->stateChanged(s);\n    if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n    if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "emit q->disconnected",
          "args": [],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "emit q->connected",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n      QwwSmtpClient::State old = state;\n      state = s;\n      emit q->stateChanged(s);\n      if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n      if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n  }\n}"
  },
  {
    "function_name": "_q_readFromSocket",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "147-362",
    "snippet": "void QwwSmtpClientPrivate::_q_readFromSocket() {\n    while (socket->canReadLine()) {\n        QString line = socket->readLine();\n        qDebug() << \"SMTP <<<\" << line.toUtf8().constData();\n        QRegExp rx(\"(\\\\d+)-(.*)\\n\");        // multiline response (aka 250-XYZ)\n        QRegExp rxlast(\"(\\\\d+) (.*)\\n\");    // single or last line response (aka 250 XYZ)\n        bool mid = rx.exactMatch(line);\n        bool last = rxlast.exactMatch(line);\n        // multiline\n        if (mid){\n            int status = rx.cap(1).toInt();\n            SMTPCommand &cmd = commandqueue.head();\n            switch (cmd.type) {\n            // trying to connect\n            case SMTPCommand::Connect: {\n                    int stage = cmd.extra.toInt();\n                    // stage 0 completed with success - socket is connected and EHLO was sent\n                    if(stage==1 && status==250){\n                        QString arg = rx.cap(2).trimmed();\n                        parseOption(arg);   // we're probably receiving options\n                    }\n                }\n                break;\n            // trying to establish deferred SSL handshake\n            case SMTPCommand::StartTLS: {\n                    int stage = cmd.extra.toInt();\n                    // stage 0 (negotiation) completed ok\n                    if(stage==1 && status==250){\n                        QString arg = rx.cap(2).trimmed();\n                        parseOption(arg);   // we're probably receiving options\n                    }\n                }\n                default: break;\n            }\n        } else\n        // single line\n        if (last) {\n            int status = rxlast.cap(1).toInt();\n            SMTPCommand &cmd = commandqueue.head();\n            switch (cmd.type) {\n            // trying to connect\n            case SMTPCommand::Connect: {\n                int stage = cmd.extra.toInt();\n                // connection established, server sent its banner\n                if (stage==0 && status==220) {\n                    sendEhlo(); // connect ok, send ehlo\n                }\n                // server responded to EHLO\n                if (stage==1 && status==250){\n                    // success (EHLO)\n                    parseOption(rxlast.cap(2).trimmed()); // we're probably receiving the last option\n                    errorString.clear();\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand();\n                }\n                // server responded to HELO (EHLO failed)\n                if (state==2 && status==250) {\n                    // success (HELO)\n                    errorString.clear();\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand();\n                }\n                // EHLO failed, reason given in errorString\n                if (stage==1 && (status==554 || status==501 || status==502 || status==421)) {\n                    errorString = rxlast.cap(2).trimmed();\n                    sendHelo(); // ehlo failed, send helo\n                    cmd.extra = 2;\n                }\n                //abortDialog();\n            }\n            break;\n            // trying to establish a delayed SSL handshake\n            case SMTPCommand::StartTLS: {\n                int stage = cmd.extra.toInt();\n                // received an invitation from the server to enter TLS mode\n                if (stage==0 && status==220) {\n                    qDebug() << \"SMTP ** startClientEncruption\";\n                    socket->startClientEncryption();\n                }\n                // TLS established, connection is encrypted, EHLO was sent\n                else if (stage==1 && status==250) {\n                    setState(QwwSmtpClient::Connected);\n                    parseOption(rxlast.cap(2).trimmed());   // we're probably receiving options\n                    errorString.clear();\n                    emit q->tlsStarted();\n                    processNextCommand();\n                }\n                // starttls failed\n                else {\n                    qDebug() << \"TLS failed at stage \" << stage << \": \" << line;\n                    errorString = \"TLS failed\";\n                    emit q->done(false);\n                }\n            }\n            break;\n            // trying to authenticate the client to the server\n            case SMTPCommand::Authenticate: {\n                int stage = cmd.extra.toInt();\n                if (stage==0 && status==334) {\n                    // AUTH mode was accepted by the server, 1st challenge sent\n                    QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n                    errorString.clear();\n                    switch (authmode) {\n                    case QwwSmtpClient::AuthPlain:\n                        sendAuthPlain(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString());\n                        break;\n                    case QwwSmtpClient::AuthLogin:\n                        sendAuthLogin(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString(), 1);\n                        break;\n                    default:\n                        qWarning(\"I shouldn't be here\");\n                        setState(QwwSmtpClient::Connected);\n                        processNextCommand();\n                        break;\n                    }\n                    cmd.extra = stage+1;\n                } else if (stage==1 && status==334) {\n                    // AUTH mode and user names were acccepted by the server, 2nd challenge sent\n                    QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n                    errorString.clear();\n                    switch (authmode) {\n                    case QwwSmtpClient::AuthPlain:\n                        // auth failed\n                        setState(QwwSmtpClient::Connected);\n                        processNextCommand();\n                        break;\n                    case QwwSmtpClient::AuthLogin:\n                        sendAuthLogin(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString(), 2);\n                        break;\n                    default:\n                        qWarning(\"I shouldn't be here\");\n                        setState(QwwSmtpClient::Connected);\n                        processNextCommand();\n                        break;\n                    }\n                } else if (stage==2 && status==334) {\n                    // auth failed\n                    errorString = rxlast.cap(2).trimmed();\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand();\n                } else if (status==235) {\n                    // auth ok\n                    errorString.clear();\n                    emit q->authenticated();\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand();\n                } else {\n                    errorString = rxlast.cap(2).trimmed();\n                    setState(QwwSmtpClient::Connected);\n                    emit q->done(false);\n                }\n            }\n            break;\n            // trying to send mail\n            case SMTPCommand::Mail:\n            case SMTPCommand::MailBurl:\n            {\n                int stage = cmd.extra.toInt();\n                // temporary failure upon receiving the sender address (greylisting probably)\n                if (status==421 && stage==0) {\n                    errorString = rxlast.cap(2).trimmed();\n                    // temporary envelope failure (greylisting)\n                    setState(QwwSmtpClient::Connected);\n                    processNextCommand(false);\n                }\n                if (status==250 && stage==0) {\n                    // sender accepted\n                    errorString.clear();\n                    sendRcpt();\n                } else if (status==250 && stage==1) {\n                    // all receivers accepted\n                    if (cmd.type == SMTPCommand::MailBurl) {\n                        errorString.clear();\n                        QByteArray url = cmd.data.toList().at(2).toByteArray();\n                        qDebug() << \"SMTP >>> BURL\" << url << \"LAST\";\n                        socket->write(\"BURL \" + url + \" LAST\\r\\n\");\n                        cmd.extra=2;\n                    } else {\n                        errorString.clear();\n                        qDebug() << \"SMTP >>> DATA\";\n                        socket->write(\"DATA\\r\\n\");\n                        cmd.extra=2;\n                    }\n                } else if ((cmd.type == SMTPCommand::Mail && status==354 && stage==2)) {\n                    // DATA command accepted\n                    errorString.clear();\n                    QByteArray toBeWritten = cmd.data.toList().at(2).toString().toUtf8();\n                    qDebug() << \"SMTP >>>\" << toBeWritten << \"\\r\\n.\\r\\n\";\n                    socket->write(toBeWritten); // expecting data to be already escaped (CRLF.CRLF)\n                    socket->write(\"\\r\\n.\\r\\n\"); // termination token - CRLF.CRLF\n                    cmd.extra=3;\n                } else if ((cmd.type == SMTPCommand::MailBurl && status==250 && stage==2)) {\n                    // BURL succeeded\n                    setState(QwwSmtpClient::Connected);\n                    errorString.clear();\n                    processNextCommand();\n                } else if ((cmd.type == SMTPCommand::Mail && status==250 && stage==3)) {\n                    // mail queued\n                    setState(QwwSmtpClient::Connected);\n                    errorString.clear();\n                    processNextCommand();\n                } else {\n                    // something went wrong\n                    errorString = rxlast.cap(2).trimmed();\n                    setState(QwwSmtpClient::Connected);\n                    emit q->done(false);\n                    processNextCommand();\n                }\n            }\n                default: break;\n            }\n        } else {\n            qDebug() << \"None of two regular expressions matched the input\" << line;\n        }\n    }\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setState",
          "args": [
            "QwwSmtpClient::Connected"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "setState",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "364-370",
          "snippet": "void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n    QwwSmtpClient::State old = state;\n    state = s;\n    emit q->stateChanged(s);\n    if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n    if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n      QwwSmtpClient::State old = state;\n      state = s;\n      emit q->stateChanged(s);\n      if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n      if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [
            "2"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errorString.clear",
          "args": [],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"\\r\\n.\\r\\n\""
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "toBeWritten"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "2"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"DATA\\r\\n\""
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->write",
          "args": [
            "\"BURL \" + url + \" LAST\\r\\n\""
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "2"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sendRcpt",
          "args": [],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "sendRcpt",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "488-500",
          "snippet": "void QwwSmtpClientPrivate::sendRcpt() {\n    SMTPCommand &cmd = commandqueue.head();\n    QVariantList vlist = cmd.data.toList();\n    QList<QVariant> rcptlist = vlist.at(1).toList();\n    QByteArray buf = QByteArray(\"RCPT TO:<\").append(rcptlist.first().toByteArray()).append(\">\\r\\n\");\n    qDebug() << \"SMTP >>>\" << buf;\n    socket->write(buf);\n    rcptlist.removeFirst();\n    vlist[1] = rcptlist;\n    cmd.data = vlist;\n\n    if (rcptlist.isEmpty()) cmd.extra = 1;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendRcpt() {\n      SMTPCommand &cmd = commandqueue.head();\n      QVariantList vlist = cmd.data.toList();\n      QList<QVariant> rcptlist = vlist.at(1).toList();\n      QByteArray buf = QByteArray(\"RCPT TO:<\").append(rcptlist.first().toByteArray()).append(\">\\r\\n\");\n      qDebug() << \"SMTP >>>\" << buf;\n      socket->write(buf);\n      rcptlist.removeFirst();\n      vlist[1] = rcptlist;\n      cmd.data = vlist;\n  \n      if (rcptlist.isEmpty()) cmd.extra = 1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [
            "false"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "processNextCommand",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "372-446",
          "snippet": "void QwwSmtpClientPrivate::processNextCommand(bool ok) {\n    if (inProgress && !commandqueue.isEmpty()) {\n        emit q->commandFinished(commandqueue.head().id, !ok);\n        commandqueue.dequeue();\n    }\n    if (commandqueue.isEmpty()) {\n        inProgress = false;\n        emit q->done(false);\n        return;\n    }\n    const SMTPCommand &cmd = commandqueue.head();\n    switch (cmd.type) {\n    case SMTPCommand::Connect: {\n        QString hostName = cmd.data.toList().at(0).toString();\n        uint port = cmd.data.toList().at(1).toUInt();\n        bool ssl = cmd.data.toList().at(2).toBool();\n        if(ssl){\n            qDebug() << \"SMTP ** connectToHostEncrypted\";\n            socket->connectToHostEncrypted(hostName, port);\n        } else {\n            qDebug() << \"SMTP ** connectToHost\";\n            socket->connectToHost(hostName, port);\n        }\n        setState(QwwSmtpClient::Connecting);\n    }\n    break;\n    case SMTPCommand::Disconnect: {\n        sendQuit();\n    }\n    break;\n    case SMTPCommand::StartTLS: {\n        qDebug() << \"SMTP >>> STARTTLS\";\n        socket->write(\"STARTTLS\\r\\n\");\n        setState(QwwSmtpClient::TLSRequested);\n    }\n    break;\n    case SMTPCommand::Authenticate: {\n        QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n        switch (authmode) {\n        case QwwSmtpClient::AuthPlain:\n            qDebug() << \"SMTP >>> AUTH PLAIN\";\n            socket->write(\"AUTH PLAIN\\r\\n\");\n            setState(QwwSmtpClient::Authenticating);\n            break;\n        case QwwSmtpClient::AuthLogin:\n            qDebug() << \"SMTP >>> AUTH LOGIN\";\n            socket->write(\"AUTH LOGIN\\r\\n\");\n            setState(QwwSmtpClient::Authenticating);\n            break;\n        default:\n            qWarning(\"Unsupported or unknown authentication scheme\");\n            //processNextCommand(false);\n        }\n    }\n    break;\n    case SMTPCommand::Mail:\n    case SMTPCommand::MailBurl:\n    {\n        setState(QwwSmtpClient::Sending);\n        QByteArray buf = QByteArray(\"MAIL FROM:<\").append(cmd.data.toList().at(0).toByteArray()).append(\">\\r\\n\");\n        qDebug() << \"SMTP >>>\" << buf;\n        socket->write(buf);\n        break;\n    }\n    case SMTPCommand::RawCommand: {\n\tQString cont = cmd.data.toString();\n\tif(!cont.endsWith(\"\\r\\n\")) cont.append(\"\\r\\n\");\n    setState(QwwSmtpClient::Sending);\n    qDebug() << \"SMTP >>>\" << cont;\n\tsocket->write(cont.toUtf8());\n\t} break;\n    }\n    inProgress = true;\n    emit q->commandStarted(cmd.id);\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::processNextCommand(bool ok) {\n      if (inProgress && !commandqueue.isEmpty()) {\n          emit q->commandFinished(commandqueue.head().id, !ok);\n          commandqueue.dequeue();\n      }\n      if (commandqueue.isEmpty()) {\n          inProgress = false;\n          emit q->done(false);\n          return;\n      }\n      const SMTPCommand &cmd = commandqueue.head();\n      switch (cmd.type) {\n      case SMTPCommand::Connect: {\n          QString hostName = cmd.data.toList().at(0).toString();\n          uint port = cmd.data.toList().at(1).toUInt();\n          bool ssl = cmd.data.toList().at(2).toBool();\n          if(ssl){\n              qDebug() << \"SMTP ** connectToHostEncrypted\";\n              socket->connectToHostEncrypted(hostName, port);\n          } else {\n              qDebug() << \"SMTP ** connectToHost\";\n              socket->connectToHost(hostName, port);\n          }\n          setState(QwwSmtpClient::Connecting);\n      }\n      break;\n      case SMTPCommand::Disconnect: {\n          sendQuit();\n      }\n      break;\n      case SMTPCommand::StartTLS: {\n          qDebug() << \"SMTP >>> STARTTLS\";\n          socket->write(\"STARTTLS\\r\\n\");\n          setState(QwwSmtpClient::TLSRequested);\n      }\n      break;\n      case SMTPCommand::Authenticate: {\n          QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n          switch (authmode) {\n          case QwwSmtpClient::AuthPlain:\n              qDebug() << \"SMTP >>> AUTH PLAIN\";\n              socket->write(\"AUTH PLAIN\\r\\n\");\n              setState(QwwSmtpClient::Authenticating);\n              break;\n          case QwwSmtpClient::AuthLogin:\n              qDebug() << \"SMTP >>> AUTH LOGIN\";\n              socket->write(\"AUTH LOGIN\\r\\n\");\n              setState(QwwSmtpClient::Authenticating);\n              break;\n          default:\n              qWarning(\"Unsupported or unknown authentication scheme\");\n              //processNextCommand(false);\n          }\n      }\n      break;\n      case SMTPCommand::Mail:\n      case SMTPCommand::MailBurl:\n      {\n          setState(QwwSmtpClient::Sending);\n          QByteArray buf = QByteArray(\"MAIL FROM:<\").append(cmd.data.toList().at(0).toByteArray()).append(\">\\r\\n\");\n          qDebug() << \"SMTP >>>\" << buf;\n          socket->write(buf);\n          break;\n      }\n      case SMTPCommand::RawCommand: {\n  \tQString cont = cmd.data.toString();\n  \tif(!cont.endsWith(\"\\r\\n\")) cont.append(\"\\r\\n\");\n      setState(QwwSmtpClient::Sending);\n      qDebug() << \"SMTP >>>\" << cont;\n  \tsocket->write(cont.toUtf8());\n  \t} break;\n      }\n      inProgress = true;\n      emit q->commandStarted(cmd.id);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [
            "2"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.extra.toInt",
          "args": [],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [
            "2"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [
            "2"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qWarning",
          "args": [
            "\"I shouldn't be here\""
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sendAuthLogin",
          "args": [
            "cmd.data.toList().at(1).toString()",
            "cmd.data.toList().at(2).toString()",
            "2"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "sendAuthLogin",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "516-526",
          "snippet": "void QwwSmtpClientPrivate::sendAuthLogin(const QString & username, const QString & password, int stage) {\n    if (stage==1) {\n        qDebug() << \"SMTP <<< [login username]\";\n        socket->write(username.toUtf8().toBase64());\n        socket->write(\"\\r\\n\");\n    } else if (stage==2) {\n        qDebug() << \"SMTP <<< [login password]\";\n        socket->write(password.toUtf8().toBase64());\n        socket->write(\"\\r\\n\");\n    }\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendAuthLogin(const QString & username, const QString & password, int stage) {\n      if (stage==1) {\n          qDebug() << \"SMTP <<< [login username]\";\n          socket->write(username.toUtf8().toBase64());\n          socket->write(\"\\r\\n\");\n      } else if (stage==2) {\n          qDebug() << \"SMTP <<< [login password]\";\n          socket->write(password.toUtf8().toBase64());\n          socket->write(\"\\r\\n\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "2"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "1"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "0"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qWarning",
          "args": [
            "\"I shouldn't be here\""
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "2"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "1"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sendAuthPlain",
          "args": [
            "cmd.data.toList().at(1).toString()",
            "cmd.data.toList().at(2).toString()"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "sendAuthPlain",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "504-514",
          "snippet": "void QwwSmtpClientPrivate::sendAuthPlain(const QString & username, const QString & password) {\n    QByteArray ba;\n    ba.append('\\0');\n    ba.append(username.toUtf8());\n    ba.append('\\0');\n    ba.append(password.toUtf8());\n    QByteArray encoded = ba.toBase64();\n    qDebug() << \"SMTP <<< [authentication data]\";\n    socket->write(encoded);\n    socket->write(\"\\r\\n\");\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendAuthPlain(const QString & username, const QString & password) {\n      QByteArray ba;\n      ba.append('\\0');\n      ba.append(username.toUtf8());\n      ba.append('\\0');\n      ba.append(password.toUtf8());\n      QByteArray encoded = ba.toBase64();\n      qDebug() << \"SMTP <<< [authentication data]\";\n      socket->write(encoded);\n      socket->write(\"\\r\\n\");\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "2"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "1"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [
            "0"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.data.toList",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.extra.toInt",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parseOption",
          "args": [
            "rxlast.cap(2).trimmed()"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "parseOption",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "528-544",
          "snippet": "void QwwSmtpClientPrivate::parseOption(const QString &buffer){\n    if(buffer.toLower()==\"pipelining\"){                     options |= QwwSmtpClient::PipeliningOption;     }\n    else if(buffer.toLower()==\"starttls\"){                  options |= QwwSmtpClient::StartTlsOption;       }\n    else if(buffer.toLower()==\"8bitmime\"){                  options |= QwwSmtpClient::EightBitMimeOption;   }\n    else if(buffer.toLower().startsWith(\"auth \")){          options |= QwwSmtpClient::AuthOption;\n        // parse auth modes\n        QStringList slist = buffer.mid(5).split(\" \");\n        foreach(const QString &s, slist){\n            if(s.toLower()==\"plain\"){\n                authModes |= QwwSmtpClient::AuthPlain;\n            }\n            if(s.toLower()==\"login\"){\n                authModes |= QwwSmtpClient::AuthLogin;\n            }\n        }\n    }\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::parseOption(const QString &buffer){\n      if(buffer.toLower()==\"pipelining\"){                     options |= QwwSmtpClient::PipeliningOption;     }\n      else if(buffer.toLower()==\"starttls\"){                  options |= QwwSmtpClient::StartTlsOption;       }\n      else if(buffer.toLower()==\"8bitmime\"){                  options |= QwwSmtpClient::EightBitMimeOption;   }\n      else if(buffer.toLower().startsWith(\"auth \")){          options |= QwwSmtpClient::AuthOption;\n          // parse auth modes\n          QStringList slist = buffer.mid(5).split(\" \");\n          foreach(const QString &s, slist){\n              if(s.toLower()==\"plain\"){\n                  authModes |= QwwSmtpClient::AuthPlain;\n              }\n              if(s.toLower()==\"login\"){\n                  authModes |= QwwSmtpClient::AuthLogin;\n              }\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [
            "2"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->startClientEncryption",
          "args": [],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.extra.toInt",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sendHelo",
          "args": [],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "sendHelo",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "468-477",
          "snippet": "void QwwSmtpClientPrivate::sendHelo() {\n    SMTPCommand &cmd = commandqueue.head();\n    QString domain = localName;\n    if (socket->isEncrypted() && localNameEncrypted.isEmpty())\n        domain = localNameEncrypted;\n    QByteArray buf = QString(\"HELO \"+domain+\"\\r\\n\").toUtf8();\n    qDebug() << \"SMTP >>>\" << buf;\n    socket->write(buf);\n    cmd.extra = 1;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendHelo() {\n      SMTPCommand &cmd = commandqueue.head();\n      QString domain = localName;\n      if (socket->isEncrypted() && localNameEncrypted.isEmpty())\n          domain = localNameEncrypted;\n      QByteArray buf = QString(\"HELO \"+domain+\"\\r\\n\").toUtf8();\n      qDebug() << \"SMTP >>>\" << buf;\n      socket->write(buf);\n      cmd.extra = 1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [
            "2"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "processNextCommand",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [
            "2"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sendEhlo",
          "args": [],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "sendEhlo",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "456-465",
          "snippet": "void QwwSmtpClientPrivate::sendEhlo() {\n    SMTPCommand &cmd = commandqueue.head();\n    QString domain = localName;\n    if (socket->isEncrypted() && !localNameEncrypted.isEmpty())\n        domain = localNameEncrypted;\n    QByteArray buf = QString(\"EHLO \"+domain+\"\\r\\n\").toUtf8();\n    qDebug() << \"SMTP >>>\" << buf;\n    socket->write(buf);\n    cmd.extra = 1;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::sendEhlo() {\n      SMTPCommand &cmd = commandqueue.head();\n      QString domain = localName;\n      if (socket->isEncrypted() && !localNameEncrypted.isEmpty())\n          domain = localNameEncrypted;\n      QByteArray buf = QString(\"EHLO \"+domain+\"\\r\\n\").toUtf8();\n      qDebug() << \"SMTP >>>\" << buf;\n      socket->write(buf);\n      cmd.extra = 1;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmd.extra.toInt",
          "args": [],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.cap",
          "args": [
            "1"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rx.cap",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rx.cap",
          "args": [
            "2"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.extra.toInt",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rx.cap",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rx.cap",
          "args": [
            "2"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmd.extra.toInt",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rx.cap",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rx.cap",
          "args": [
            "1"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rxlast.exactMatch",
          "args": [
            "line"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rx.exactMatch",
          "args": [
            "line"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "line.toUtf8",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "line.toUtf8",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qDebug",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->readLine",
          "args": [],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket->canReadLine",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::_q_readFromSocket() {\n      while (socket->canReadLine()) {\n          QString line = socket->readLine();\n          qDebug() << \"SMTP <<<\" << line.toUtf8().constData();\n          QRegExp rx(\"(\\\\d+)-(.*)\\n\");        // multiline response (aka 250-XYZ)\n          QRegExp rxlast(\"(\\\\d+) (.*)\\n\");    // single or last line response (aka 250 XYZ)\n          bool mid = rx.exactMatch(line);\n          bool last = rxlast.exactMatch(line);\n          // multiline\n          if (mid){\n              int status = rx.cap(1).toInt();\n              SMTPCommand &cmd = commandqueue.head();\n              switch (cmd.type) {\n              // trying to connect\n              case SMTPCommand::Connect: {\n                      int stage = cmd.extra.toInt();\n                      // stage 0 completed with success - socket is connected and EHLO was sent\n                      if(stage==1 && status==250){\n                          QString arg = rx.cap(2).trimmed();\n                          parseOption(arg);   // we're probably receiving options\n                      }\n                  }\n                  break;\n              // trying to establish deferred SSL handshake\n              case SMTPCommand::StartTLS: {\n                      int stage = cmd.extra.toInt();\n                      // stage 0 (negotiation) completed ok\n                      if(stage==1 && status==250){\n                          QString arg = rx.cap(2).trimmed();\n                          parseOption(arg);   // we're probably receiving options\n                      }\n                  }\n                  default: break;\n              }\n          } else\n          // single line\n          if (last) {\n              int status = rxlast.cap(1).toInt();\n              SMTPCommand &cmd = commandqueue.head();\n              switch (cmd.type) {\n              // trying to connect\n              case SMTPCommand::Connect: {\n                  int stage = cmd.extra.toInt();\n                  // connection established, server sent its banner\n                  if (stage==0 && status==220) {\n                      sendEhlo(); // connect ok, send ehlo\n                  }\n                  // server responded to EHLO\n                  if (stage==1 && status==250){\n                      // success (EHLO)\n                      parseOption(rxlast.cap(2).trimmed()); // we're probably receiving the last option\n                      errorString.clear();\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand();\n                  }\n                  // server responded to HELO (EHLO failed)\n                  if (state==2 && status==250) {\n                      // success (HELO)\n                      errorString.clear();\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand();\n                  }\n                  // EHLO failed, reason given in errorString\n                  if (stage==1 && (status==554 || status==501 || status==502 || status==421)) {\n                      errorString = rxlast.cap(2).trimmed();\n                      sendHelo(); // ehlo failed, send helo\n                      cmd.extra = 2;\n                  }\n                  //abortDialog();\n              }\n              break;\n              // trying to establish a delayed SSL handshake\n              case SMTPCommand::StartTLS: {\n                  int stage = cmd.extra.toInt();\n                  // received an invitation from the server to enter TLS mode\n                  if (stage==0 && status==220) {\n                      qDebug() << \"SMTP ** startClientEncruption\";\n                      socket->startClientEncryption();\n                  }\n                  // TLS established, connection is encrypted, EHLO was sent\n                  else if (stage==1 && status==250) {\n                      setState(QwwSmtpClient::Connected);\n                      parseOption(rxlast.cap(2).trimmed());   // we're probably receiving options\n                      errorString.clear();\n                      emit q->tlsStarted();\n                      processNextCommand();\n                  }\n                  // starttls failed\n                  else {\n                      qDebug() << \"TLS failed at stage \" << stage << \": \" << line;\n                      errorString = \"TLS failed\";\n                      emit q->done(false);\n                  }\n              }\n              break;\n              // trying to authenticate the client to the server\n              case SMTPCommand::Authenticate: {\n                  int stage = cmd.extra.toInt();\n                  if (stage==0 && status==334) {\n                      // AUTH mode was accepted by the server, 1st challenge sent\n                      QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n                      errorString.clear();\n                      switch (authmode) {\n                      case QwwSmtpClient::AuthPlain:\n                          sendAuthPlain(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString());\n                          break;\n                      case QwwSmtpClient::AuthLogin:\n                          sendAuthLogin(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString(), 1);\n                          break;\n                      default:\n                          qWarning(\"I shouldn't be here\");\n                          setState(QwwSmtpClient::Connected);\n                          processNextCommand();\n                          break;\n                      }\n                      cmd.extra = stage+1;\n                  } else if (stage==1 && status==334) {\n                      // AUTH mode and user names were acccepted by the server, 2nd challenge sent\n                      QwwSmtpClient::AuthMode authmode = (QwwSmtpClient::AuthMode)cmd.data.toList().at(0).toInt();\n                      errorString.clear();\n                      switch (authmode) {\n                      case QwwSmtpClient::AuthPlain:\n                          // auth failed\n                          setState(QwwSmtpClient::Connected);\n                          processNextCommand();\n                          break;\n                      case QwwSmtpClient::AuthLogin:\n                          sendAuthLogin(cmd.data.toList().at(1).toString(), cmd.data.toList().at(2).toString(), 2);\n                          break;\n                      default:\n                          qWarning(\"I shouldn't be here\");\n                          setState(QwwSmtpClient::Connected);\n                          processNextCommand();\n                          break;\n                      }\n                  } else if (stage==2 && status==334) {\n                      // auth failed\n                      errorString = rxlast.cap(2).trimmed();\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand();\n                  } else if (status==235) {\n                      // auth ok\n                      errorString.clear();\n                      emit q->authenticated();\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand();\n                  } else {\n                      errorString = rxlast.cap(2).trimmed();\n                      setState(QwwSmtpClient::Connected);\n                      emit q->done(false);\n                  }\n              }\n              break;\n              // trying to send mail\n              case SMTPCommand::Mail:\n              case SMTPCommand::MailBurl:\n              {\n                  int stage = cmd.extra.toInt();\n                  // temporary failure upon receiving the sender address (greylisting probably)\n                  if (status==421 && stage==0) {\n                      errorString = rxlast.cap(2).trimmed();\n                      // temporary envelope failure (greylisting)\n                      setState(QwwSmtpClient::Connected);\n                      processNextCommand(false);\n                  }\n                  if (status==250 && stage==0) {\n                      // sender accepted\n                      errorString.clear();\n                      sendRcpt();\n                  } else if (status==250 && stage==1) {\n                      // all receivers accepted\n                      if (cmd.type == SMTPCommand::MailBurl) {\n                          errorString.clear();\n                          QByteArray url = cmd.data.toList().at(2).toByteArray();\n                          qDebug() << \"SMTP >>> BURL\" << url << \"LAST\";\n                          socket->write(\"BURL \" + url + \" LAST\\r\\n\");\n                          cmd.extra=2;\n                      } else {\n                          errorString.clear();\n                          qDebug() << \"SMTP >>> DATA\";\n                          socket->write(\"DATA\\r\\n\");\n                          cmd.extra=2;\n                      }\n                  } else if ((cmd.type == SMTPCommand::Mail && status==354 && stage==2)) {\n                      // DATA command accepted\n                      errorString.clear();\n                      QByteArray toBeWritten = cmd.data.toList().at(2).toString().toUtf8();\n                      qDebug() << \"SMTP >>>\" << toBeWritten << \"\\r\\n.\\r\\n\";\n                      socket->write(toBeWritten); // expecting data to be already escaped (CRLF.CRLF)\n                      socket->write(\"\\r\\n.\\r\\n\"); // termination token - CRLF.CRLF\n                      cmd.extra=3;\n                  } else if ((cmd.type == SMTPCommand::MailBurl && status==250 && stage==2)) {\n                      // BURL succeeded\n                      setState(QwwSmtpClient::Connected);\n                      errorString.clear();\n                      processNextCommand();\n                  } else if ((cmd.type == SMTPCommand::Mail && status==250 && stage==3)) {\n                      // mail queued\n                      setState(QwwSmtpClient::Connected);\n                      errorString.clear();\n                      processNextCommand();\n                  } else {\n                      // something went wrong\n                      errorString = rxlast.cap(2).trimmed();\n                      setState(QwwSmtpClient::Connected);\n                      emit q->done(false);\n                      processNextCommand();\n                  }\n              }\n                  default: break;\n              }\n          } else {\n              qDebug() << \"None of two regular expressions matched the input\" << line;\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "onError",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "139-143",
    "snippet": "void QwwSmtpClientPrivate::onError(QAbstractSocket::SocketError e)\n{\n    emit q->socketError(e, socket->errorString());\n    onDisconnected();\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onDisconnected",
          "args": [],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "onDisconnected",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "119-137",
          "snippet": "void QwwSmtpClientPrivate::onDisconnected() {\n    setState(QwwSmtpClient::Disconnected);\n    if (commandqueue.isEmpty()) {\n        inProgress = false;\n        emit q->done(true);\n        return;\n    }\n\n    if (commandqueue.head().type == SMTPCommand::Disconnect) {\n        inProgress = false;\n        emit q->done(true);\n        return;\n    }\n\n    emit q->commandFinished(commandqueue.head().id, true);\n    commandqueue.clear();\n    inProgress = false;\n    emit q->done(false);\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::onDisconnected() {\n      setState(QwwSmtpClient::Disconnected);\n      if (commandqueue.isEmpty()) {\n          inProgress = false;\n          emit q->done(true);\n          return;\n      }\n  \n      if (commandqueue.head().type == SMTPCommand::Disconnect) {\n          inProgress = false;\n          emit q->done(true);\n          return;\n      }\n  \n      emit q->commandFinished(commandqueue.head().id, true);\n      commandqueue.clear();\n      inProgress = false;\n      emit q->done(false);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket->errorString",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "errorString",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "712-714",
          "snippet": "QString QwwSmtpClient::errorString() const{\n    return d->errorString;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QString QwwSmtpClient::errorString() const{\n      return d->errorString;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::onError(QAbstractSocket::SocketError e)\n  {\n      emit q->socketError(e, socket->errorString());\n      onDisconnected();\n  }\n}"
  },
  {
    "function_name": "onDisconnected",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "119-137",
    "snippet": "void QwwSmtpClientPrivate::onDisconnected() {\n    setState(QwwSmtpClient::Disconnected);\n    if (commandqueue.isEmpty()) {\n        inProgress = false;\n        emit q->done(true);\n        return;\n    }\n\n    if (commandqueue.head().type == SMTPCommand::Disconnect) {\n        inProgress = false;\n        emit q->done(true);\n        return;\n    }\n\n    emit q->commandFinished(commandqueue.head().id, true);\n    commandqueue.clear();\n    inProgress = false;\n    emit q->done(false);\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "commandqueue.clear",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.head",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "commandqueue.isEmpty",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setState",
          "args": [
            "QwwSmtpClient::Disconnected"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "setState",
          "container": "QwwSmtpClientPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "364-370",
          "snippet": "void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n    QwwSmtpClient::State old = state;\n    state = s;\n    emit q->stateChanged(s);\n    if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n    if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::setState(QwwSmtpClient::State s) {\n      QwwSmtpClient::State old = state;\n      state = s;\n      emit q->stateChanged(s);\n      if (old == QwwSmtpClient::Connecting && s==QwwSmtpClient::Connected) emit q->connected();\n      if (s==QwwSmtpClient::Disconnected) emit q->disconnected();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::onDisconnected() {\n      setState(QwwSmtpClient::Disconnected);\n      if (commandqueue.isEmpty()) {\n          inProgress = false;\n          emit q->done(true);\n          return;\n      }\n  \n      if (commandqueue.head().type == SMTPCommand::Disconnect) {\n          inProgress = false;\n          emit q->done(true);\n          return;\n      }\n  \n      emit q->commandFinished(commandqueue.head().id, true);\n      commandqueue.clear();\n      inProgress = false;\n      emit q->done(false);\n  }\n}"
  },
  {
    "function_name": "onConnected",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "109-114",
    "snippet": "void QwwSmtpClientPrivate::onConnected() {\n    options = QwwSmtpClient::NoOptions;\n    authModes = QwwSmtpClient::AuthNone;\n    emit q->stateChanged(QwwSmtpClient::Connected);\n    emit q->connected();\n}",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  void QwwSmtpClientPrivate::onConnected() {\n      options = QwwSmtpClient::NoOptions;\n      authModes = QwwSmtpClient::AuthNone;\n      emit q->stateChanged(QwwSmtpClient::Connected);\n      emit q->connected();\n  }\n}"
  },
  {
    "function_name": "QwwSmtpClientPrivate",
    "container": "QwwSmtpClientPrivate",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
    "lines": "63-65",
    "snippet": "QwwSmtpClientPrivate(QwwSmtpClient *qq) {\n        q = qq;\n    }",
    "includes": [
      "#include \"moc_qwwsmtpclient.cpp\"",
      "#include <QStringList>",
      "#include <QVariant>",
      "#include <QQueue>",
      "#include <QtDebug>",
      "#include <QSslSocket>",
      "#include \"qwwsmtpclient.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClientPrivate {\n  QwwSmtpClientPrivate(QwwSmtpClient *qq) {\n          q = qq;\n      }\n}"
  }
]