[
  {
    "function_name": "onLinkHovered(",
    "container": "nvelopeView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
    "lines": "142-167",
    "snippet": "oid EnvelopeView::onLinkHovered(const QString &target)\n{\n    QUrl url(target);\n\n    Imap::Message::MailAddress addr;\n    if (Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"mailto\")) ||\n            Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"x-trojita-manage-contact\"))) {\n        QStringList matchingIdentities;\n        emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingIdentities);\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n        QString link = Qt::escape(addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE));\n        QString identities = Qt::escape(matchingIdentities.join(QLatin1String(\"<br/>\\n\")));\n#else\n        QString link = addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE).toHtmlEscaped();\n        QString identities = matchingIdentities.join(QLatin1String(\"<br/>\\n\")).toHtmlEscaped();\n#endif\n        if (matchingIdentities.isEmpty()) {\n            setToolTip(link);\n        } else {\n            setToolTip(link + tr(\"<hr/><b>Address Book:</b><br/>\") + identities);\n        }\n    } else {\n        setToolTip(QString());\n        return;\n    }\n}",
    "includes": [
      "include \"Imap/Model/Model.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QTextDocument>\n#",
      "include <QFontMetrics>\n#",
      "include <QHeaderView>\n#",
      "include \"EnvelopeView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etToolTip(",
          "args": [
            "String())"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "etToolTip(",
          "args": [
            "ink + tr(\"<hr/><b>Address Book:</b><br/>\") + identities)"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "<hr/><b>Address Book:</b><br/>\")"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "etToolTip(",
          "args": [
            "ink)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atchingIdentities.isEmpty",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atchingIdentities.join",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atchingIdentities.join",
          "args": [
            "Latin1String(\"<br/>\\n\"))"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "<br/>\\n\")"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddr.prettyName",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddr.prettyName",
          "args": [
            "map::Message::MailAddress::FORMAT_READABLE)"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t::escape(",
          "args": [
            "atchingIdentities.join(QLatin1String(\"<br/>\\n\")))"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atchingIdentities.join",
          "args": [
            "Latin1String(\"<br/>\\n\"))"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "<br/>\\n\")"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t::escape(",
          "args": [
            "ddr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE))"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddr.prettyName",
          "args": [
            "map::Message::MailAddress::FORMAT_READABLE)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "@')"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::Message::MailAddress::fromUrl(",
          "args": [
            "ddr,",
            "rl,",
            "Latin1String(\"x-trojita-manage-contact\"))"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "fromUrl(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "275-296",
          "snippet": "ool MailAddress::fromUrl(MailAddress &into, const QUrl &url, const QString &expectedScheme)\n{\n    if (url.scheme().toLower() != expectedScheme.toLower())\n        return false;\n\n    QStringList list = url.path().split(QLatin1Char('@'));\n    if (list.size() != 2)\n        return false;\n\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    Imap::Message::MailAddress addr(url.queryItemValue(QLatin1String(\"X-Trojita-DisplayName\")), QString(),\n                                    list[0], list[1]);\n#else\n    QUrlQuery q(url);\n    Imap::Message::MailAddress addr(q.queryItemValue(QLatin1String(\"X-Trojita-DisplayName\")), QString(),\n                                    list[0], list[1]);\n#endif\n    if (!addr.hasUsefulDisplayName())\n        addr.name.clear();\n    into = addr;\n    return true;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ool MailAddress::fromUrl(MailAddress &into, const QUrl &url, const QString &expectedScheme)\n  {\n      if (url.scheme().toLower() != expectedScheme.toLower())\n          return false;\n  \n      QStringList list = url.path().split(QLatin1Char('@'));\n      if (list.size() != 2)\n          return false;\n  \n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      Imap::Message::MailAddress addr(url.queryItemValue(QLatin1String(\"X-Trojita-DisplayName\")), QString(),\n                                      list[0], list[1]);\n  #else\n      QUrlQuery q(url);\n      Imap::Message::MailAddress addr(q.queryItemValue(QLatin1String(\"X-Trojita-DisplayName\")), QString(),\n                                      list[0], list[1]);\n  #endif\n      if (!addr.hasUsefulDisplayName())\n          addr.name.clear();\n      into = addr;\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "x-trojita-manage-contact\")"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mailto\")"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  oid EnvelopeView::onLinkHovered(const QString &target)\n  {\n      QUrl url(target);\n  \n      Imap::Message::MailAddress addr;\n      if (Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"mailto\")) ||\n              Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"x-trojita-manage-contact\"))) {\n          QStringList matchingIdentities;\n          emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingIdentities);\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n          QString link = Qt::escape(addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE));\n          QString identities = Qt::escape(matchingIdentities.join(QLatin1String(\"<br/>\\n\")));\n  #else\n          QString link = addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE).toHtmlEscaped();\n          QString identities = matchingIdentities.join(QLatin1String(\"<br/>\\n\")).toHtmlEscaped();\n  #endif\n          if (matchingIdentities.isEmpty()) {\n              setToolTip(link);\n          } else {\n              setToolTip(link + tr(\"<hr/><b>Address Book:</b><br/>\") + identities);\n          }\n      } else {\n          setToolTip(QString());\n          return;\n      }\n  }\n}"
  },
  {
    "function_name": "headerText(",
    "container": "nvelopeView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
    "lines": "86-140",
    "snippet": "String EnvelopeView::headerText(const QModelIndex &index)\n{\n    if (!index.isValid())\n        return QString();\n\n    const Imap::Message::Envelope e = index.data(Imap::Mailbox::RoleMessageEnvelope).value<Imap::Message::Envelope>();\n\n    QString res;\n    if (!e.from.isEmpty())\n        res += tr(\"<b>From:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.from));\n    if (!e.sender.isEmpty() && e.sender != e.from)\n        res += tr(\"<b>Sender:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.sender));\n    if (!e.replyTo.isEmpty() && e.replyTo != e.from)\n        res += tr(\"<b>Reply-To:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.replyTo));\n    QVariantList headerListPost = index.data(Imap::Mailbox::RoleMessageHeaderListPost).toList();\n    if (!headerListPost.isEmpty()) {\n        QStringList buf;\n        Q_FOREACH(const QVariant &item, headerListPost) {\n            const QString scheme = item.toUrl().scheme().toLower();\n            if (scheme == QLatin1String(\"http\") || scheme == QLatin1String(\"https\") || scheme == QLatin1String(\"mailto\")) {\n                QString target = item.toUrl().toString();\n                QString caption = item.toUrl().toString(scheme == QLatin1String(\"mailto\") ? QUrl::RemoveScheme : QUrl::None);\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                target = Qt::escape(target);\n                caption = Qt::escape(caption);\n#else\n                target = target.toHtmlEscaped();\n                caption = caption.toHtmlEscaped();\n#endif\n                buf << tr(\"<a href=\\\"%1\\\">%2</a>\").arg(target, caption);\n            } else {\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                buf << Qt::escape(item.toUrl().toString());\n#else\n                buf << item.toUrl().toString().toHtmlEscaped();\n#endif\n            }\n        }\n        res += tr(\"<b>List-Post:</b>&nbsp;%1<br/>\").arg(buf.join(tr(\", \")));\n    }\n    if (!e.to.isEmpty())\n        res += tr(\"<b>To:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.to));\n    if (!e.cc.isEmpty())\n        res += tr(\"<b>Cc:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.cc));\n    if (!e.bcc.isEmpty())\n        res += tr(\"<b>Bcc:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.bcc));\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    res += tr(\"<b>Subject:</b>&nbsp;%1\").arg(Qt::escape(e.subject));\n#else\n    res += tr(\"<b>Subject:</b>&nbsp;%1\").arg(e.subject.toHtmlEscaped());\n#endif\n    if (e.date.isValid())\n        res += tr(\"<br/><b>Date:</b>&nbsp;%1\").arg(e.date.toLocalTime().toString(Qt::SystemLocaleLongDate));\n    return res;\n}",
    "includes": [
      "include \"Imap/Model/Model.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QTextDocument>\n#",
      "include <QFontMetrics>\n#",
      "include <QHeaderView>\n#",
      "include \"EnvelopeView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "r",
          "args": [
            ".date.toLocalTime().toString(Qt::SystemLocaleLongDate))"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "onLinkHovered(",
          "container": "nvelopeView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
          "lines": "142-167",
          "snippet": "oid EnvelopeView::onLinkHovered(const QString &target)\n{\n    QUrl url(target);\n\n    Imap::Message::MailAddress addr;\n    if (Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"mailto\")) ||\n            Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"x-trojita-manage-contact\"))) {\n        QStringList matchingIdentities;\n        emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingIdentities);\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n        QString link = Qt::escape(addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE));\n        QString identities = Qt::escape(matchingIdentities.join(QLatin1String(\"<br/>\\n\")));\n#else\n        QString link = addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE).toHtmlEscaped();\n        QString identities = matchingIdentities.join(QLatin1String(\"<br/>\\n\")).toHtmlEscaped();\n#endif\n        if (matchingIdentities.isEmpty()) {\n            setToolTip(link);\n        } else {\n            setToolTip(link + tr(\"<hr/><b>Address Book:</b><br/>\") + identities);\n        }\n    } else {\n        setToolTip(QString());\n        return;\n    }\n}",
          "includes": [
            "include \"Imap/Model/Model.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QTextDocument>\n#",
            "include <QFontMetrics>\n#",
            "include <QHeaderView>\n#",
            "include \"EnvelopeView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  oid EnvelopeView::onLinkHovered(const QString &target)\n  {\n      QUrl url(target);\n  \n      Imap::Message::MailAddress addr;\n      if (Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"mailto\")) ||\n              Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"x-trojita-manage-contact\"))) {\n          QStringList matchingIdentities;\n          emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingIdentities);\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n          QString link = Qt::escape(addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE));\n          QString identities = Qt::escape(matchingIdentities.join(QLatin1String(\"<br/>\\n\")));\n  #else\n          QString link = addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE).toHtmlEscaped();\n          QString identities = matchingIdentities.join(QLatin1String(\"<br/>\\n\")).toHtmlEscaped();\n  #endif\n          if (matchingIdentities.isEmpty()) {\n              setToolTip(link);\n          } else {\n              setToolTip(link + tr(\"<hr/><b>Address Book:</b><br/>\") + identities);\n          }\n      } else {\n          setToolTip(QString());\n          return;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": ".date.toLocalTime",
          "args": [
            "t::SystemLocaleLongDate)"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".date.toLocalTime",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "<br/><b>Date:</b>&nbsp;%1\")"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": ".date.isValid",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": ".subject.toHtmlEscaped",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t::escape(",
          "args": [
            ".subject)"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tmlizeAddresses(",
          "args": [
            ".bcc)"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "htmlizeAddresses(",
          "container": "nvelopeView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
          "lines": "69-84",
          "snippet": "String EnvelopeView::htmlizeAddresses(const QList<Imap::Message::MailAddress> &addresses)\n{\n    Q_ASSERT(!addresses.isEmpty());\n    QStringList buf;\n    Q_FOREACH(const Imap::Message::MailAddress &addr, addresses) {\n        QStringList matchingDisplayNames;\n        emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingDisplayNames);\n        QUrl url = addr.asUrl();\n        QString icon = QString::fromUtf8(\"<span style='width: 4px;'>&nbsp;</span><a href='x-trojita-manage-contact:%1'>\"\n                                         \"<img src='%2' align='center'/></a>\").arg(\n                    url.toString(QUrl::RemoveScheme),\n                    matchingDisplayNames.isEmpty() ? contactUnknownUrl : contactKnownUrl);\n        buf << addr.prettyName(Imap::Message::MailAddress::FORMAT_CLICKABLE) + icon;\n    }\n    return buf.join(QLatin1String(\", \"));\n}",
          "includes": [
            "include \"Imap/Model/Model.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QTextDocument>\n#",
            "include <QFontMetrics>\n#",
            "include <QHeaderView>\n#",
            "include \"EnvelopeView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  String EnvelopeView::htmlizeAddresses(const QList<Imap::Message::MailAddress> &addresses)\n  {\n      Q_ASSERT(!addresses.isEmpty());\n      QStringList buf;\n      Q_FOREACH(const Imap::Message::MailAddress &addr, addresses) {\n          QStringList matchingDisplayNames;\n          emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingDisplayNames);\n          QUrl url = addr.asUrl();\n          QString icon = QString::fromUtf8(\"<span style='width: 4px;'>&nbsp;</span><a href='x-trojita-manage-contact:%1'>\"\n                                           \"<img src='%2' align='center'/></a>\").arg(\n                      url.toString(QUrl::RemoveScheme),\n                      matchingDisplayNames.isEmpty() ? contactUnknownUrl : contactKnownUrl);\n          buf << addr.prettyName(Imap::Message::MailAddress::FORMAT_CLICKABLE) + icon;\n      }\n      return buf.join(QLatin1String(\", \"));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": ".bcc.isEmpty",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".cc.isEmpty",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".to.isEmpty",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uf.join",
          "args": [
            "r(\", \"))"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t::escape(",
          "args": [
            "tem.toUrl().toString())"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "arget,",
            "aption)"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "MessageSourceWidget",
          "container": "MessageSourceWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageSourceWidget.cpp",
          "lines": "32-48",
          "snippet": "MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n    QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n{\n    setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n    Q_ASSERT(messageIndex.isValid());\n    page()->setNetworkAccessManager(0);\n\n    m_loadingSpinner = new Spinner(this);\n    m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n    m_loadingSpinner->setType(Spinner::Sun);\n    m_loadingSpinner->start(250);\n\n    m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n    connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n    connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n    m_combiner->load();\n}",
          "includes": [
            "#include \"Imap/Model/FullMessageCombiner.h\"",
            "#include \"Gui/Spinner.h\"",
            "#include \"Gui/IconLoader.h\"",
            "#include <QModelIndex>",
            "#include \"MessageSourceWidget.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Imap/Model/FullMessageCombiner.h\"\n#include \"Gui/Spinner.h\"\n#include \"Gui/IconLoader.h\"\n#include <QModelIndex>\n#include \"MessageSourceWidget.h\"\n\nMessageSourceWidget {\n  MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n      QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n  {\n      setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n      Q_ASSERT(messageIndex.isValid());\n      page()->setNetworkAccessManager(0);\n  \n      m_loadingSpinner = new Spinner(this);\n      m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n      m_loadingSpinner->setType(Spinner::Sun);\n      m_loadingSpinner->start(250);\n  \n      m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n      connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n      connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n      m_combiner->load();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "aption.toHtmlEscaped",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arget.toHtmlEscaped",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t::escape(",
          "args": [
            "aption)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t::escape(",
          "args": [
            "arget)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [
            "cheme == QLatin1String(\"mailto\") ? QUrl::RemoveScheme : QUrl::None)"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mailto\")"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mailto\")"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "https\")"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "http\")"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toUrl",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderListPost.isEmpty",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.data",
          "args": [],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndex.data",
          "args": [
            "map::Mailbox::RoleMessageHeaderListPost)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".replyTo.isEmpty",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".sender.isEmpty",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".from.isEmpty",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.data",
          "args": [
            "map::Mailbox::RoleMessageEnvelope)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  String EnvelopeView::headerText(const QModelIndex &index)\n  {\n      if (!index.isValid())\n          return QString();\n  \n      const Imap::Message::Envelope e = index.data(Imap::Mailbox::RoleMessageEnvelope).value<Imap::Message::Envelope>();\n  \n      QString res;\n      if (!e.from.isEmpty())\n          res += tr(\"<b>From:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.from));\n      if (!e.sender.isEmpty() && e.sender != e.from)\n          res += tr(\"<b>Sender:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.sender));\n      if (!e.replyTo.isEmpty() && e.replyTo != e.from)\n          res += tr(\"<b>Reply-To:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.replyTo));\n      QVariantList headerListPost = index.data(Imap::Mailbox::RoleMessageHeaderListPost).toList();\n      if (!headerListPost.isEmpty()) {\n          QStringList buf;\n          Q_FOREACH(const QVariant &item, headerListPost) {\n              const QString scheme = item.toUrl().scheme().toLower();\n              if (scheme == QLatin1String(\"http\") || scheme == QLatin1String(\"https\") || scheme == QLatin1String(\"mailto\")) {\n                  QString target = item.toUrl().toString();\n                  QString caption = item.toUrl().toString(scheme == QLatin1String(\"mailto\") ? QUrl::RemoveScheme : QUrl::None);\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                  target = Qt::escape(target);\n                  caption = Qt::escape(caption);\n  #else\n                  target = target.toHtmlEscaped();\n                  caption = caption.toHtmlEscaped();\n  #endif\n                  buf << tr(\"<a href=\\\"%1\\\">%2</a>\").arg(target, caption);\n              } else {\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                  buf << Qt::escape(item.toUrl().toString());\n  #else\n                  buf << item.toUrl().toString().toHtmlEscaped();\n  #endif\n              }\n          }\n          res += tr(\"<b>List-Post:</b>&nbsp;%1<br/>\").arg(buf.join(tr(\", \")));\n      }\n      if (!e.to.isEmpty())\n          res += tr(\"<b>To:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.to));\n      if (!e.cc.isEmpty())\n          res += tr(\"<b>Cc:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.cc));\n      if (!e.bcc.isEmpty())\n          res += tr(\"<b>Bcc:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.bcc));\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      res += tr(\"<b>Subject:</b>&nbsp;%1\").arg(Qt::escape(e.subject));\n  #else\n      res += tr(\"<b>Subject:</b>&nbsp;%1\").arg(e.subject.toHtmlEscaped());\n  #endif\n      if (e.date.isValid())\n          res += tr(\"<br/><b>Date:</b>&nbsp;%1\").arg(e.date.toLocalTime().toString(Qt::SystemLocaleLongDate));\n      return res;\n  }\n}"
  },
  {
    "function_name": "htmlizeAddresses(",
    "container": "nvelopeView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
    "lines": "69-84",
    "snippet": "String EnvelopeView::htmlizeAddresses(const QList<Imap::Message::MailAddress> &addresses)\n{\n    Q_ASSERT(!addresses.isEmpty());\n    QStringList buf;\n    Q_FOREACH(const Imap::Message::MailAddress &addr, addresses) {\n        QStringList matchingDisplayNames;\n        emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingDisplayNames);\n        QUrl url = addr.asUrl();\n        QString icon = QString::fromUtf8(\"<span style='width: 4px;'>&nbsp;</span><a href='x-trojita-manage-contact:%1'>\"\n                                         \"<img src='%2' align='center'/></a>\").arg(\n                    url.toString(QUrl::RemoveScheme),\n                    matchingDisplayNames.isEmpty() ? contactUnknownUrl : contactKnownUrl);\n        buf << addr.prettyName(Imap::Message::MailAddress::FORMAT_CLICKABLE) + icon;\n    }\n    return buf.join(QLatin1String(\", \"));\n}",
    "includes": [
      "include \"Imap/Model/Model.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QTextDocument>\n#",
      "include <QFontMetrics>\n#",
      "include <QHeaderView>\n#",
      "include \"EnvelopeView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "uf.join",
          "args": [
            "Latin1String(\", \"))"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ", \")"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddr.prettyName",
          "args": [
            "map::Message::MailAddress::FORMAT_CLICKABLE)"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "rl.toString(QUrl::RemoveScheme),",
            "atchingDisplayNames.isEmpty() ? contactUnknownUrl : contactKnownUrl)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atchingDisplayNames.isEmpty",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.toString",
          "args": [
            "Url::RemoveScheme)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "<span style='width: 4px;'>&nbsp;</span><a href='x-trojita-manage-contact:%1'>\"\n                                         \"<img src='%2' align='center'/></a>\")"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddr.asUrl",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "@')"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "addresses.isEmpty())"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddresses.isEmpty",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  String EnvelopeView::htmlizeAddresses(const QList<Imap::Message::MailAddress> &addresses)\n  {\n      Q_ASSERT(!addresses.isEmpty());\n      QStringList buf;\n      Q_FOREACH(const Imap::Message::MailAddress &addr, addresses) {\n          QStringList matchingDisplayNames;\n          emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingDisplayNames);\n          QUrl url = addr.asUrl();\n          QString icon = QString::fromUtf8(\"<span style='width: 4px;'>&nbsp;</span><a href='x-trojita-manage-contact:%1'>\"\n                                           \"<img src='%2' align='center'/></a>\").arg(\n                      url.toString(QUrl::RemoveScheme),\n                      matchingDisplayNames.isEmpty() ? contactUnknownUrl : contactKnownUrl);\n          buf << addr.prettyName(Imap::Message::MailAddress::FORMAT_CLICKABLE) + icon;\n      }\n      return buf.join(QLatin1String(\", \"));\n  }\n}"
  },
  {
    "function_name": "setMessage(",
    "container": "nvelopeView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
    "lines": "63-66",
    "snippet": "oid EnvelopeView::setMessage(const QModelIndex &index)\n{\n    setText(headerText(index));\n}",
    "includes": [
      "include \"Imap/Model/Model.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QTextDocument>\n#",
      "include <QFontMetrics>\n#",
      "include <QHeaderView>\n#",
      "include \"EnvelopeView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etText(",
          "args": [
            "eaderText(index))"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "setText(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "43-61",
          "snippet": "oid Spinner::setText(const QString &text)\n{\n    static const QLatin1Char newLine('\\n');\n    m_text = text;\n    // calculate the maximum glyphs per row\n    // this is later on used in the painting code to determine the font size\n    // size altering pointsizes of fonts does not scale dimensions in a linear way (depending on the\n    // hinter) this is precise enough and by using the maximum glyph width has enough padding from\n    // the circle\n    int idx = text.indexOf(newLine);\n    int lidx = 0;\n    m_textCols = 0;\n    while (idx > -1) {\n        m_textCols = qMax(m_textCols, idx - lidx);\n        lidx = idx + 1;\n        idx = text.indexOf(newLine, lidx);\n    }\n    m_textCols = qMax(m_textCols, text.length() - lidx);\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  oid Spinner::setText(const QString &text)\n  {\n      static const QLatin1Char newLine('\\n');\n      m_text = text;\n      // calculate the maximum glyphs per row\n      // this is later on used in the painting code to determine the font size\n      // size altering pointsizes of fonts does not scale dimensions in a linear way (depending on the\n      // hinter) this is precise enough and by using the maximum glyph width has enough padding from\n      // the circle\n      int idx = text.indexOf(newLine);\n      int lidx = 0;\n      m_textCols = 0;\n      while (idx > -1) {\n          m_textCols = qMax(m_textCols, idx - lidx);\n          lidx = idx + 1;\n          idx = text.indexOf(newLine, lidx);\n      }\n      m_textCols = qMax(m_textCols, text.length() - lidx);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "eaderText(",
          "args": [
            "ndex)"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "headerText(",
          "container": "nvelopeView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
          "lines": "86-140",
          "snippet": "String EnvelopeView::headerText(const QModelIndex &index)\n{\n    if (!index.isValid())\n        return QString();\n\n    const Imap::Message::Envelope e = index.data(Imap::Mailbox::RoleMessageEnvelope).value<Imap::Message::Envelope>();\n\n    QString res;\n    if (!e.from.isEmpty())\n        res += tr(\"<b>From:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.from));\n    if (!e.sender.isEmpty() && e.sender != e.from)\n        res += tr(\"<b>Sender:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.sender));\n    if (!e.replyTo.isEmpty() && e.replyTo != e.from)\n        res += tr(\"<b>Reply-To:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.replyTo));\n    QVariantList headerListPost = index.data(Imap::Mailbox::RoleMessageHeaderListPost).toList();\n    if (!headerListPost.isEmpty()) {\n        QStringList buf;\n        Q_FOREACH(const QVariant &item, headerListPost) {\n            const QString scheme = item.toUrl().scheme().toLower();\n            if (scheme == QLatin1String(\"http\") || scheme == QLatin1String(\"https\") || scheme == QLatin1String(\"mailto\")) {\n                QString target = item.toUrl().toString();\n                QString caption = item.toUrl().toString(scheme == QLatin1String(\"mailto\") ? QUrl::RemoveScheme : QUrl::None);\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                target = Qt::escape(target);\n                caption = Qt::escape(caption);\n#else\n                target = target.toHtmlEscaped();\n                caption = caption.toHtmlEscaped();\n#endif\n                buf << tr(\"<a href=\\\"%1\\\">%2</a>\").arg(target, caption);\n            } else {\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                buf << Qt::escape(item.toUrl().toString());\n#else\n                buf << item.toUrl().toString().toHtmlEscaped();\n#endif\n            }\n        }\n        res += tr(\"<b>List-Post:</b>&nbsp;%1<br/>\").arg(buf.join(tr(\", \")));\n    }\n    if (!e.to.isEmpty())\n        res += tr(\"<b>To:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.to));\n    if (!e.cc.isEmpty())\n        res += tr(\"<b>Cc:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.cc));\n    if (!e.bcc.isEmpty())\n        res += tr(\"<b>Bcc:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.bcc));\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    res += tr(\"<b>Subject:</b>&nbsp;%1\").arg(Qt::escape(e.subject));\n#else\n    res += tr(\"<b>Subject:</b>&nbsp;%1\").arg(e.subject.toHtmlEscaped());\n#endif\n    if (e.date.isValid())\n        res += tr(\"<br/><b>Date:</b>&nbsp;%1\").arg(e.date.toLocalTime().toString(Qt::SystemLocaleLongDate));\n    return res;\n}",
          "includes": [
            "include \"Imap/Model/Model.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QTextDocument>\n#",
            "include <QFontMetrics>\n#",
            "include <QHeaderView>\n#",
            "include \"EnvelopeView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  String EnvelopeView::headerText(const QModelIndex &index)\n  {\n      if (!index.isValid())\n          return QString();\n  \n      const Imap::Message::Envelope e = index.data(Imap::Mailbox::RoleMessageEnvelope).value<Imap::Message::Envelope>();\n  \n      QString res;\n      if (!e.from.isEmpty())\n          res += tr(\"<b>From:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.from));\n      if (!e.sender.isEmpty() && e.sender != e.from)\n          res += tr(\"<b>Sender:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.sender));\n      if (!e.replyTo.isEmpty() && e.replyTo != e.from)\n          res += tr(\"<b>Reply-To:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.replyTo));\n      QVariantList headerListPost = index.data(Imap::Mailbox::RoleMessageHeaderListPost).toList();\n      if (!headerListPost.isEmpty()) {\n          QStringList buf;\n          Q_FOREACH(const QVariant &item, headerListPost) {\n              const QString scheme = item.toUrl().scheme().toLower();\n              if (scheme == QLatin1String(\"http\") || scheme == QLatin1String(\"https\") || scheme == QLatin1String(\"mailto\")) {\n                  QString target = item.toUrl().toString();\n                  QString caption = item.toUrl().toString(scheme == QLatin1String(\"mailto\") ? QUrl::RemoveScheme : QUrl::None);\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                  target = Qt::escape(target);\n                  caption = Qt::escape(caption);\n  #else\n                  target = target.toHtmlEscaped();\n                  caption = caption.toHtmlEscaped();\n  #endif\n                  buf << tr(\"<a href=\\\"%1\\\">%2</a>\").arg(target, caption);\n              } else {\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                  buf << Qt::escape(item.toUrl().toString());\n  #else\n                  buf << item.toUrl().toString().toHtmlEscaped();\n  #endif\n              }\n          }\n          res += tr(\"<b>List-Post:</b>&nbsp;%1<br/>\").arg(buf.join(tr(\", \")));\n      }\n      if (!e.to.isEmpty())\n          res += tr(\"<b>To:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.to));\n      if (!e.cc.isEmpty())\n          res += tr(\"<b>Cc:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.cc));\n      if (!e.bcc.isEmpty())\n          res += tr(\"<b>Bcc:</b>&nbsp;%1<br/>\").arg(htmlizeAddresses(e.bcc));\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      res += tr(\"<b>Subject:</b>&nbsp;%1\").arg(Qt::escape(e.subject));\n  #else\n      res += tr(\"<b>Subject:</b>&nbsp;%1\").arg(e.subject.toHtmlEscaped());\n  #endif\n      if (e.date.isValid())\n          res += tr(\"<br/><b>Date:</b>&nbsp;%1\").arg(e.date.toLocalTime().toString(Qt::SystemLocaleLongDate));\n      return res;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  oid EnvelopeView::setMessage(const QModelIndex &index)\n  {\n      setText(headerText(index));\n  }\n}"
  },
  {
    "function_name": "EnvelopeView(",
    "container": "nvelopeView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
    "lines": "38-60",
    "snippet": "nvelopeView::EnvelopeView(QWidget *parent, MessageView *messageView): QLabel(parent)\n{\n    // we create a dummy header, pass it through the style and the use it's color roles so we\n    // know what headers in general look like in the system\n    QHeaderView helpingHeader(Qt::Horizontal);\n    helpingHeader.ensurePolished();\n\n    setBackgroundRole(helpingHeader.backgroundRole());\n    setForegroundRole(helpingHeader.foregroundRole());\n    setTextInteractionFlags(Qt::TextSelectableByMouse | Qt::LinksAccessibleByMouse);\n    setIndent(5);\n    setWordWrap(true);\n    connect(this, SIGNAL(linkHovered(QString)), this, SLOT(onLinkHovered(QString)));\n\n    QFontMetrics fm(font());\n    int iconSize = fm.boundingRect(QLatin1Char('M')).height();\n    contactKnownUrl = Gui::Util::resizedImageAsDataUrl(QLatin1String(\":/icons/contact-known.svg\"), iconSize);\n    contactUnknownUrl = Gui::Util::resizedImageAsDataUrl(QLatin1String(\":/icons/contact-unknown.svgz\"), iconSize);\n\n    connect(this, SIGNAL(linkActivated(QString)), messageView, SLOT(headerLinkActivated(QString)));\n    connect(this, SIGNAL(addressDetailsRequested(QString,QStringList&)),\n            messageView, SIGNAL(addressDetailsRequested(QString,QStringList&)));\n}",
    "includes": [
      "include \"Imap/Model/Model.h\"",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"MessageView.h\"\n#",
      "include <QUrlQuery>\n#",
      "include <QTextDocument>\n#",
      "include <QFontMetrics>\n#",
      "include <QHeaderView>\n#",
      "include \"EnvelopeView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(linkActivated(QString)),",
            "essageView,",
            "LOT(headerLinkActivated(QString)))"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eaderLinkActivated(QString))"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eaderLinkActivated(",
          "args": [
            "String)"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "headerLinkActivated(Q",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "483-487",
          "snippet": "id MessageView::headerLinkActivated(QString s)\n{\n    // Trojita is registered to handle any mailto: URL\n    QDesktopServices::openUrl(QUrl(s));\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::headerLinkActivated(QString s)\n  {\n      // Trojita is registered to handle any mailto: URL\n      QDesktopServices::openUrl(QUrl(s));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "inkActivated(QString))"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui::Util::resizedImageAsDataUrl(",
          "args": [
            "Latin1String(\":/icons/contact-unknown.svgz\"),",
            "conSize)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ":/icons/contact-unknown.svgz\")"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui::Util::resizedImageAsDataUrl(",
          "args": [
            "Latin1String(\":/icons/contact-known.svg\"),",
            "conSize)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ":/icons/contact-known.svg\")"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m.boundingRect",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m.boundingRect",
          "args": [
            "Latin1Char('M'))"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "M')"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(linkHovered(QString)),",
            "his,",
            "LOT(onLinkHovered(QString)))"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nLinkHovered(QString))"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nLinkHovered(",
          "args": [
            "String)"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "onLinkHovered(",
          "container": "nvelopeView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EnvelopeView.cpp",
          "lines": "142-167",
          "snippet": "oid EnvelopeView::onLinkHovered(const QString &target)\n{\n    QUrl url(target);\n\n    Imap::Message::MailAddress addr;\n    if (Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"mailto\")) ||\n            Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"x-trojita-manage-contact\"))) {\n        QStringList matchingIdentities;\n        emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingIdentities);\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n        QString link = Qt::escape(addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE));\n        QString identities = Qt::escape(matchingIdentities.join(QLatin1String(\"<br/>\\n\")));\n#else\n        QString link = addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE).toHtmlEscaped();\n        QString identities = matchingIdentities.join(QLatin1String(\"<br/>\\n\")).toHtmlEscaped();\n#endif\n        if (matchingIdentities.isEmpty()) {\n            setToolTip(link);\n        } else {\n            setToolTip(link + tr(\"<hr/><b>Address Book:</b><br/>\") + identities);\n        }\n    } else {\n        setToolTip(QString());\n        return;\n    }\n}",
          "includes": [
            "include \"Imap/Model/Model.h\"",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QTextDocument>\n#",
            "include <QFontMetrics>\n#",
            "include <QHeaderView>\n#",
            "include \"EnvelopeView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  oid EnvelopeView::onLinkHovered(const QString &target)\n  {\n      QUrl url(target);\n  \n      Imap::Message::MailAddress addr;\n      if (Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"mailto\")) ||\n              Imap::Message::MailAddress::fromUrl(addr, url, QLatin1String(\"x-trojita-manage-contact\"))) {\n          QStringList matchingIdentities;\n          emit addressDetailsRequested(addr.mailbox + QLatin1Char('@') + addr.host, matchingIdentities);\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n          QString link = Qt::escape(addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE));\n          QString identities = Qt::escape(matchingIdentities.join(QLatin1String(\"<br/>\\n\")));\n  #else\n          QString link = addr.prettyName(Imap::Message::MailAddress::FORMAT_READABLE).toHtmlEscaped();\n          QString identities = matchingIdentities.join(QLatin1String(\"<br/>\\n\")).toHtmlEscaped();\n  #endif\n          if (matchingIdentities.isEmpty()) {\n              setToolTip(link);\n          } else {\n              setToolTip(link + tr(\"<hr/><b>Address Book:</b><br/>\") + identities);\n          }\n      } else {\n          setToolTip(QString());\n          return;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "inkHovered(QString))"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etWordWrap(",
          "args": [
            "rue)"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etIndent(",
          "args": [
            ")"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etTextInteractionFlags(",
          "args": [
            "t::TextSelectableByMouse | Qt::LinksAccessibleByMouse)"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etForegroundRole(",
          "args": [
            "elpingHeader.foregroundRole())"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elpingHeader.foregroundRole",
          "args": [],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etBackgroundRole(",
          "args": [
            "elpingHeader.backgroundRole())"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elpingHeader.backgroundRole",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elpingHeader.ensurePolished",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Model.h\"\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QTextDocument>\n#\ninclude <QFontMetrics>\n#\ninclude <QHeaderView>\n#\ninclude \"EnvelopeView.h\"\n#\n\nnvelopeView {\n  nvelopeView::EnvelopeView(QWidget *parent, MessageView *messageView): QLabel(parent)\n  {\n      // we create a dummy header, pass it through the style and the use it's color roles so we\n      // know what headers in general look like in the system\n      QHeaderView helpingHeader(Qt::Horizontal);\n      helpingHeader.ensurePolished();\n  \n      setBackgroundRole(helpingHeader.backgroundRole());\n      setForegroundRole(helpingHeader.foregroundRole());\n      setTextInteractionFlags(Qt::TextSelectableByMouse | Qt::LinksAccessibleByMouse);\n      setIndent(5);\n      setWordWrap(true);\n      connect(this, SIGNAL(linkHovered(QString)), this, SLOT(onLinkHovered(QString)));\n  \n      QFontMetrics fm(font());\n      int iconSize = fm.boundingRect(QLatin1Char('M')).height();\n      contactKnownUrl = Gui::Util::resizedImageAsDataUrl(QLatin1String(\":/icons/contact-known.svg\"), iconSize);\n      contactUnknownUrl = Gui::Util::resizedImageAsDataUrl(QLatin1String(\":/icons/contact-unknown.svgz\"), iconSize);\n  \n      connect(this, SIGNAL(linkActivated(QString)), messageView, SLOT(headerLinkActivated(QString)));\n      connect(this, SIGNAL(addressDetailsRequested(QString,QStringList&)),\n              messageView, SIGNAL(addressDetailsRequested(QString,QStringList&)));\n  }\n}"
  }
]