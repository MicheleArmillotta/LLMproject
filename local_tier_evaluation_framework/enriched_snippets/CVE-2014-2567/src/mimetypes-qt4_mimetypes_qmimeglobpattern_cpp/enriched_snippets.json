[
  {
    "function_name": "clear",
    "container": "QMimeAllGlobPatterns",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
    "lines": "233-238",
    "snippet": "void QMimeAllGlobPatterns::clear()\n{\n    m_fastPatterns.clear();\n    m_highWeightGlobs.clear();\n    m_lowWeightGlobs.clear();\n}",
    "includes": [
      "#include <QDebug>",
      "#include <QStringList>",
      "#include <QRegExp>",
      "#include \"qmimeglobpattern_p.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_lowWeightGlobs.clear",
          "args": [],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeAllGlobPatterns",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "233-238",
          "snippet": "void QMimeAllGlobPatterns::clear()\n{\n    m_fastPatterns.clear();\n    m_highWeightGlobs.clear();\n    m_lowWeightGlobs.clear();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeAllGlobPatterns {\n  void QMimeAllGlobPatterns::clear()\n  {\n      m_fastPatterns.clear();\n      m_highWeightGlobs.clear();\n      m_lowWeightGlobs.clear();\n  }\n}"
  },
  {
    "function_name": "matchingGlobs",
    "container": "QMimeAllGlobPatterns",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
    "lines": "202-231",
    "snippet": "QStringList QMimeAllGlobPatterns::matchingGlobs(const QString &fileName, QString *foundSuffix) const\n{\n    // First try the high weight matches (>50), if any.\n    QMimeGlobMatchResult result;\n    m_highWeightGlobs.match(result, fileName);\n    if (result.m_matchingMimeTypes.isEmpty()) {\n\n        // Now use the \"fast patterns\" dict, for simple *.foo patterns with weight 50\n        // (which is most of them, so this optimization is definitely worth it)\n        const int lastDot = fileName.lastIndexOf(QLatin1Char('.'));\n        if (lastDot != -1) { // if no '.', skip the extension lookup\n            const int ext_len = fileName.length() - lastDot - 1;\n            const QString simpleExtension = fileName.right(ext_len).toLower();\n            // (toLower because fast patterns are always case-insensitive and saved as lowercase)\n\n            const QStringList matchingMimeTypes = m_fastPatterns.value(simpleExtension);\n            foreach (const QString &mime, matchingMimeTypes) {\n                result.addMatch(mime, 50, QLatin1String(\"*.\") + simpleExtension);\n            }\n            // Can't return yet; *.tar.bz2 has to win over *.bz2, so we need the low-weight mimetypes anyway,\n            // at least those with weight 50.\n        }\n\n        // Finally, try the low weight matches (<=50)\n        m_lowWeightGlobs.match(result, fileName);\n    }\n    if (foundSuffix)\n        *foundSuffix = result.m_foundSuffix;\n    return result.m_matchingMimeTypes;\n}",
    "includes": [
      "#include <QDebug>",
      "#include <QStringList>",
      "#include <QRegExp>",
      "#include \"qmimeglobpattern_p.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_lowWeightGlobs.match",
          "args": [
            "result",
            "fileName"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "match",
          "container": "QMimeGlobPatternList",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "189-200",
          "snippet": "void QMimeGlobPatternList::match(QMimeGlobMatchResult &result,\n                                 const QString &fileName) const\n{\n\n    QMimeGlobPatternList::const_iterator it = this->constBegin();\n    const QMimeGlobPatternList::const_iterator endIt = this->constEnd();\n    for (; it != endIt; ++it) {\n        const QMimeGlobPattern &glob = *it;\n        if (glob.matchFileName(fileName))\n            result.addMatch(glob.mimeType(), glob.weight(), glob.pattern());\n    }\n}",
          "includes": [
            "#include <QDebug>",
            "#include <QStringList>",
            "#include <QRegExp>",
            "#include \"qmimeglobpattern_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeGlobPatternList {\n  void QMimeGlobPatternList::match(QMimeGlobMatchResult &result,\n                                   const QString &fileName) const\n  {\n  \n      QMimeGlobPatternList::const_iterator it = this->constBegin();\n      const QMimeGlobPatternList::const_iterator endIt = this->constEnd();\n      for (; it != endIt; ++it) {\n          const QMimeGlobPattern &glob = *it;\n          if (glob.matchFileName(fileName))\n              result.addMatch(glob.mimeType(), glob.weight(), glob.pattern());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "result.addMatch",
          "args": [
            "mime",
            "50",
            "QLatin1String(\"*.\") + simpleExtension"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "addMatch",
          "container": "QMimeGlobMatchResult",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "48-82",
          "snippet": "QT_BEGIN_NAMESPACE\n\n/*!\n    \\internal\n    \\class QMimeGlobMatchResult\n    \\brief The QMimeGlobMatchResult class accumulates results from glob matching.\n\n    Handles glob weights, and preferring longer matches over shorter matches.\n*/\n\nvoid QMimeGlobMatchResult::addMatch(const QString &mimeType, int weight, const QString &pattern)\n{\n    // Is this a lower-weight pattern than the last match? Skip this match then.\n    if (weight < m_weight)\n        return;\n    bool replace = weight > m_weight;\n    if (!replace) {\n        // Compare the length of the match\n        if (pattern.length() < m_matchingPatternLength)\n            return; // too short, ignore\n        else if (pattern.length() > m_matchingPatternLength) {\n            // longer: clear any previous match (like *.bz2, when pattern is *.tar.bz2)\n            replace = true;\n        }\n    }\n    if (replace) {\n        m_matchingMimeTypes.clear();\n        // remember the new \"longer\" length\n        m_matchingPatternLength = pattern.length();\n        m_weight = weight;\n    }\n    m_matchingMimeTypes.append(mimeType);\n    if (pattern.startsWith(QLatin1String(\"*.\")))\n        m_foundSuffix = pattern.mid(2);\n}",
          "includes": [
            "#include <QDebug>",
            "#include <QStringList>",
            "#include <QRegExp>",
            "#include \"qmimeglobpattern_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeGlobMatchResult {\n  QT_BEGIN_NAMESPACE\n  \n  /*!\n      \\internal\n      \\class QMimeGlobMatchResult\n      \\brief The QMimeGlobMatchResult class accumulates results from glob matching.\n  \n      Handles glob weights, and preferring longer matches over shorter matches.\n  */\n  \n  void QMimeGlobMatchResult::addMatch(const QString &mimeType, int weight, const QString &pattern)\n  {\n      // Is this a lower-weight pattern than the last match? Skip this match then.\n      if (weight < m_weight)\n          return;\n      bool replace = weight > m_weight;\n      if (!replace) {\n          // Compare the length of the match\n          if (pattern.length() < m_matchingPatternLength)\n              return; // too short, ignore\n          else if (pattern.length() > m_matchingPatternLength) {\n              // longer: clear any previous match (like *.bz2, when pattern is *.tar.bz2)\n              replace = true;\n          }\n      }\n      if (replace) {\n          m_matchingMimeTypes.clear();\n          // remember the new \"longer\" length\n          m_matchingPatternLength = pattern.length();\n          m_weight = weight;\n      }\n      m_matchingMimeTypes.append(mimeType);\n      if (pattern.startsWith(QLatin1String(\"*.\")))\n          m_foundSuffix = pattern.mid(2);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"*.\""
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_fastPatterns.value",
          "args": [
            "simpleExtension"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "187-205",
          "snippet": "QVariant XSqlQuery::value(const QString & name) const\n{\n    if (name.isEmpty())\n        return QVariant();\n\n    if (_data && !_data->_currRecord.isEmpty())\n    {\n        int i = _data->_currRecord.indexOf(name);\n        if(i<0)\n        {\n            QString err = \"Column \" + name + \" not found in record\";\n            qWarning(\"%s\", err.toLocal8Bit().constData());\n            return QVariant(_nameErrorValue);\n        }\n        return value(_data->_currRecord.indexOf(name));\n    }\n\n    return QVariant();\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [
            "static QString _nameErrorValue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nstatic QString _nameErrorValue;\n\nXSqlQuery {\n  QVariant XSqlQuery::value(const QString & name) const\n  {\n      if (name.isEmpty())\n          return QVariant();\n  \n      if (_data && !_data->_currRecord.isEmpty())\n      {\n          int i = _data->_currRecord.indexOf(name);\n          if(i<0)\n          {\n              QString err = \"Column \" + name + \" not found in record\";\n              qWarning(\"%s\", err.toLocal8Bit().constData());\n              return QVariant(_nameErrorValue);\n          }\n          return value(_data->_currRecord.indexOf(name));\n      }\n  \n      return QVariant();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fileName.right",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileName.right",
          "args": [
            "ext_len"
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileName.length",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileName.lastIndexOf",
          "args": [
            "QLatin1Char('.')"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'.'"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.m_matchingMimeTypes.isEmpty",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeAllGlobPatterns {\n  QStringList QMimeAllGlobPatterns::matchingGlobs(const QString &fileName, QString *foundSuffix) const\n  {\n      // First try the high weight matches (>50), if any.\n      QMimeGlobMatchResult result;\n      m_highWeightGlobs.match(result, fileName);\n      if (result.m_matchingMimeTypes.isEmpty()) {\n  \n          // Now use the \"fast patterns\" dict, for simple *.foo patterns with weight 50\n          // (which is most of them, so this optimization is definitely worth it)\n          const int lastDot = fileName.lastIndexOf(QLatin1Char('.'));\n          if (lastDot != -1) { // if no '.', skip the extension lookup\n              const int ext_len = fileName.length() - lastDot - 1;\n              const QString simpleExtension = fileName.right(ext_len).toLower();\n              // (toLower because fast patterns are always case-insensitive and saved as lowercase)\n  \n              const QStringList matchingMimeTypes = m_fastPatterns.value(simpleExtension);\n              foreach (const QString &mime, matchingMimeTypes) {\n                  result.addMatch(mime, 50, QLatin1String(\"*.\") + simpleExtension);\n              }\n              // Can't return yet; *.tar.bz2 has to win over *.bz2, so we need the low-weight mimetypes anyway,\n              // at least those with weight 50.\n          }\n  \n          // Finally, try the low weight matches (<=50)\n          m_lowWeightGlobs.match(result, fileName);\n      }\n      if (foundSuffix)\n          *foundSuffix = result.m_foundSuffix;\n      return result.m_matchingMimeTypes;\n  }\n}"
  },
  {
    "function_name": "match",
    "container": "QMimeGlobPatternList",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
    "lines": "189-200",
    "snippet": "void QMimeGlobPatternList::match(QMimeGlobMatchResult &result,\n                                 const QString &fileName) const\n{\n\n    QMimeGlobPatternList::const_iterator it = this->constBegin();\n    const QMimeGlobPatternList::const_iterator endIt = this->constEnd();\n    for (; it != endIt; ++it) {\n        const QMimeGlobPattern &glob = *it;\n        if (glob.matchFileName(fileName))\n            result.addMatch(glob.mimeType(), glob.weight(), glob.pattern());\n    }\n}",
    "includes": [
      "#include <QDebug>",
      "#include <QStringList>",
      "#include <QRegExp>",
      "#include \"qmimeglobpattern_p.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "result.addMatch",
          "args": [
            "glob.mimeType()",
            "glob.weight()",
            "glob.pattern()"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "addMatch",
          "container": "QMimeGlobMatchResult",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "48-82",
          "snippet": "QT_BEGIN_NAMESPACE\n\n/*!\n    \\internal\n    \\class QMimeGlobMatchResult\n    \\brief The QMimeGlobMatchResult class accumulates results from glob matching.\n\n    Handles glob weights, and preferring longer matches over shorter matches.\n*/\n\nvoid QMimeGlobMatchResult::addMatch(const QString &mimeType, int weight, const QString &pattern)\n{\n    // Is this a lower-weight pattern than the last match? Skip this match then.\n    if (weight < m_weight)\n        return;\n    bool replace = weight > m_weight;\n    if (!replace) {\n        // Compare the length of the match\n        if (pattern.length() < m_matchingPatternLength)\n            return; // too short, ignore\n        else if (pattern.length() > m_matchingPatternLength) {\n            // longer: clear any previous match (like *.bz2, when pattern is *.tar.bz2)\n            replace = true;\n        }\n    }\n    if (replace) {\n        m_matchingMimeTypes.clear();\n        // remember the new \"longer\" length\n        m_matchingPatternLength = pattern.length();\n        m_weight = weight;\n    }\n    m_matchingMimeTypes.append(mimeType);\n    if (pattern.startsWith(QLatin1String(\"*.\")))\n        m_foundSuffix = pattern.mid(2);\n}",
          "includes": [
            "#include <QDebug>",
            "#include <QStringList>",
            "#include <QRegExp>",
            "#include \"qmimeglobpattern_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeGlobMatchResult {\n  QT_BEGIN_NAMESPACE\n  \n  /*!\n      \\internal\n      \\class QMimeGlobMatchResult\n      \\brief The QMimeGlobMatchResult class accumulates results from glob matching.\n  \n      Handles glob weights, and preferring longer matches over shorter matches.\n  */\n  \n  void QMimeGlobMatchResult::addMatch(const QString &mimeType, int weight, const QString &pattern)\n  {\n      // Is this a lower-weight pattern than the last match? Skip this match then.\n      if (weight < m_weight)\n          return;\n      bool replace = weight > m_weight;\n      if (!replace) {\n          // Compare the length of the match\n          if (pattern.length() < m_matchingPatternLength)\n              return; // too short, ignore\n          else if (pattern.length() > m_matchingPatternLength) {\n              // longer: clear any previous match (like *.bz2, when pattern is *.tar.bz2)\n              replace = true;\n          }\n      }\n      if (replace) {\n          m_matchingMimeTypes.clear();\n          // remember the new \"longer\" length\n          m_matchingPatternLength = pattern.length();\n          m_weight = weight;\n      }\n      m_matchingMimeTypes.append(mimeType);\n      if (pattern.startsWith(QLatin1String(\"*.\")))\n          m_foundSuffix = pattern.mid(2);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "glob.pattern",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glob.weight",
          "args": [],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "weight",
          "container": "QMimeGlobPattern",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern_p.h",
          "lines": "83-83",
          "snippet": "inline unsigned weight() const { return m_weight; }",
          "includes": [
            "#include <qhash.h>",
            "#include <qstringlist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qhash.h>\n#include <qstringlist.h>\n\nQMimeGlobPattern {\n  inline unsigned weight() const { return m_weight; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "glob.mimeType",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glob.matchFileName",
          "args": [
            "fileName"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "matchFileName",
          "container": "QMimeGlobPattern",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "92-140",
          "snippet": "bool QMimeGlobPattern::matchFileName(const QString &inputFilename) const\n{\n    // \"Applications MUST match globs case-insensitively, except when the case-sensitive\n    // attribute is set to true.\"\n    // The constructor takes care of putting case-insensitive patterns in lowercase.\n    const QString filename = m_caseSensitivity == Qt::CaseInsensitive ? inputFilename.toLower() : inputFilename;\n\n    const int pattern_len = m_pattern.length();\n    if (!pattern_len)\n        return false;\n    const int len = filename.length();\n\n    const int starCount = m_pattern.count(QLatin1Char('*'));\n\n    // Patterns like \"*~\", \"*.extension\"\n    if (m_pattern[0] == QLatin1Char('*') && m_pattern.indexOf(QLatin1Char('[')) == -1 && starCount == 1)\n    {\n        if (len + 1 < pattern_len) return false;\n\n        const QChar *c1 = m_pattern.unicode() + pattern_len - 1;\n        const QChar *c2 = filename.unicode() + len - 1;\n        int cnt = 1;\n        while (cnt < pattern_len && *c1-- == *c2--)\n            ++cnt;\n        return cnt == pattern_len;\n    }\n\n    // Patterns like \"README*\" (well this is currently the only one like that...)\n    if (starCount == 1 && m_pattern.at(pattern_len - 1) == QLatin1Char('*')) {\n        if (len + 1 < pattern_len) return false;\n        if (m_pattern.at(0) == QLatin1Char('*'))\n            return filename.indexOf(m_pattern.mid(1, pattern_len - 2)) != -1;\n\n        const QChar *c1 = m_pattern.unicode();\n        const QChar *c2 = filename.unicode();\n        int cnt = 1;\n        while (cnt < pattern_len && *c1++ == *c2++)\n           ++cnt;\n        return cnt == pattern_len;\n    }\n\n    // Names without any wildcards like \"README\"\n    if (m_pattern.indexOf(QLatin1Char('[')) == -1 && starCount == 0 && m_pattern.indexOf(QLatin1Char('?')))\n        return (m_pattern == filename);\n\n    // Other (quite rare) patterns, like \"*.anim[1-9j]\": use slow but correct method\n    QRegExp rx(m_pattern, Qt::CaseSensitive, QRegExp::WildcardUnix);\n    return rx.exactMatch(filename);\n}",
          "includes": [
            "#include <QDebug>",
            "#include <QStringList>",
            "#include <QRegExp>",
            "#include \"qmimeglobpattern_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeGlobPattern {\n  bool QMimeGlobPattern::matchFileName(const QString &inputFilename) const\n  {\n      // \"Applications MUST match globs case-insensitively, except when the case-sensitive\n      // attribute is set to true.\"\n      // The constructor takes care of putting case-insensitive patterns in lowercase.\n      const QString filename = m_caseSensitivity == Qt::CaseInsensitive ? inputFilename.toLower() : inputFilename;\n  \n      const int pattern_len = m_pattern.length();\n      if (!pattern_len)\n          return false;\n      const int len = filename.length();\n  \n      const int starCount = m_pattern.count(QLatin1Char('*'));\n  \n      // Patterns like \"*~\", \"*.extension\"\n      if (m_pattern[0] == QLatin1Char('*') && m_pattern.indexOf(QLatin1Char('[')) == -1 && starCount == 1)\n      {\n          if (len + 1 < pattern_len) return false;\n  \n          const QChar *c1 = m_pattern.unicode() + pattern_len - 1;\n          const QChar *c2 = filename.unicode() + len - 1;\n          int cnt = 1;\n          while (cnt < pattern_len && *c1-- == *c2--)\n              ++cnt;\n          return cnt == pattern_len;\n      }\n  \n      // Patterns like \"README*\" (well this is currently the only one like that...)\n      if (starCount == 1 && m_pattern.at(pattern_len - 1) == QLatin1Char('*')) {\n          if (len + 1 < pattern_len) return false;\n          if (m_pattern.at(0) == QLatin1Char('*'))\n              return filename.indexOf(m_pattern.mid(1, pattern_len - 2)) != -1;\n  \n          const QChar *c1 = m_pattern.unicode();\n          const QChar *c2 = filename.unicode();\n          int cnt = 1;\n          while (cnt < pattern_len && *c1++ == *c2++)\n             ++cnt;\n          return cnt == pattern_len;\n      }\n  \n      // Names without any wildcards like \"README\"\n      if (m_pattern.indexOf(QLatin1Char('[')) == -1 && starCount == 0 && m_pattern.indexOf(QLatin1Char('?')))\n          return (m_pattern == filename);\n  \n      // Other (quite rare) patterns, like \"*.anim[1-9j]\": use slow but correct method\n      QRegExp rx(m_pattern, Qt::CaseSensitive, QRegExp::WildcardUnix);\n      return rx.exactMatch(filename);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->constEnd",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->constBegin",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeGlobPatternList {\n  void QMimeGlobPatternList::match(QMimeGlobMatchResult &result,\n                                   const QString &fileName) const\n  {\n  \n      QMimeGlobPatternList::const_iterator it = this->constBegin();\n      const QMimeGlobPatternList::const_iterator endIt = this->constEnd();\n      for (; it != endIt; ++it) {\n          const QMimeGlobPattern &glob = *it;\n          if (glob.matchFileName(fileName))\n              result.addMatch(glob.mimeType(), glob.weight(), glob.pattern());\n      }\n  }\n}"
  },
  {
    "function_name": "removeMimeType",
    "container": "QMimeAllGlobPatterns",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
    "lines": "179-187",
    "snippet": "void QMimeAllGlobPatterns::removeMimeType(const QString &mimeType)\n{\n    QMutableHashIterator<QString, QStringList> it(m_fastPatterns);\n    while (it.hasNext()) {\n        it.next().value().removeAll(mimeType);\n    }\n    m_highWeightGlobs.removeMimeType(mimeType);\n    m_lowWeightGlobs.removeMimeType(mimeType);\n}",
    "includes": [
      "#include <QDebug>",
      "#include <QStringList>",
      "#include <QRegExp>",
      "#include \"qmimeglobpattern_p.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_lowWeightGlobs.removeMimeType",
          "args": [
            "mimeType"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "removeMimeType",
          "container": "QMimeAllGlobPatterns",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "179-187",
          "snippet": "void QMimeAllGlobPatterns::removeMimeType(const QString &mimeType)\n{\n    QMutableHashIterator<QString, QStringList> it(m_fastPatterns);\n    while (it.hasNext()) {\n        it.next().value().removeAll(mimeType);\n    }\n    m_highWeightGlobs.removeMimeType(mimeType);\n    m_lowWeightGlobs.removeMimeType(mimeType);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "it.next",
          "args": [
            "mimeType"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.next",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "next",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "318-340",
          "snippet": "bool XSqlQuery::next()\n{\n  if (QSqlQuery::next())\n  {\n    if (_data)\n    {\n      if (_data->_keepTotals)\n      {\n        // increment all our values\n        QMapIterator<QString,double> mit(_data->_fieldTotals);\n        while(mit.hasNext())\n        {\n          mit.next();\n          _data->_fieldTotals[mit.key()] += value(mit.key()).toDouble();\n          _data->_fieldSubTotals[mit.key()] += value(mit.key()).toDouble();\n        }\n      }\n      _data->_currRecord = record();\n    }\n    return true;\n  }\n  return false;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::next()\n  {\n    if (QSqlQuery::next())\n    {\n      if (_data)\n      {\n        if (_data->_keepTotals)\n        {\n          // increment all our values\n          QMapIterator<QString,double> mit(_data->_fieldTotals);\n          while(mit.hasNext())\n          {\n            mit.next();\n            _data->_fieldTotals[mit.key()] += value(mit.key()).toDouble();\n            _data->_fieldSubTotals[mit.key()] += value(mit.key()).toDouble();\n          }\n        }\n        _data->_currRecord = record();\n      }\n      return true;\n    }\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it.hasNext",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeAllGlobPatterns {\n  void QMimeAllGlobPatterns::removeMimeType(const QString &mimeType)\n  {\n      QMutableHashIterator<QString, QStringList> it(m_fastPatterns);\n      while (it.hasNext()) {\n          it.next().value().removeAll(mimeType);\n      }\n      m_highWeightGlobs.removeMimeType(mimeType);\n      m_lowWeightGlobs.removeMimeType(mimeType);\n  }\n}"
  },
  {
    "function_name": "addGlob",
    "container": "QMimeAllGlobPatterns",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
    "lines": "153-177",
    "snippet": "void QMimeAllGlobPatterns::addGlob(const QMimeGlobPattern &glob)\n{\n    const QString &pattern = glob.pattern();\n    Q_ASSERT(!pattern.isEmpty());\n\n    // Store each patterns into either m_fastPatternDict (*.txt, *.html etc. with default weight 50)\n    // or for the rest, like core.*, *.tar.bz2, *~, into highWeightPatternOffset (>50)\n    // or lowWeightPatternOffset (<=50)\n\n    if (glob.weight() == 50 && isFastPattern(pattern) && !glob.isCaseSensitive()) {\n        // The bulk of the patterns is *.foo with weight 50 --> those go into the fast patterns hash.\n        const QString extension = pattern.mid(2).toLower();\n        QStringList &patterns = m_fastPatterns[extension]; // find or create\n        // This would just slow things down: if (!patterns.contains(glob.mimeType()))\n        patterns.append(glob.mimeType());\n    } else {\n        if (glob.weight() > 50) {\n            // This would just slow things down: if (!m_highWeightGlobs.hasPattern(glob.mimeType(), glob.pattern()))\n            m_highWeightGlobs.append(glob);\n        } else {\n            //This would just slow things down: if (!m_lowWeightGlobs.hasPattern(glob.mimeType(), glob.pattern()))\n            m_lowWeightGlobs.append(glob);\n        }\n    }\n}",
    "includes": [
      "#include <QDebug>",
      "#include <QStringList>",
      "#include <QRegExp>",
      "#include \"qmimeglobpattern_p.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_lowWeightGlobs.append",
          "args": [
            "glob"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_highWeightGlobs.append",
          "args": [
            "glob"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glob.weight",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "weight",
          "container": "QMimeGlobPattern",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern_p.h",
          "lines": "83-83",
          "snippet": "inline unsigned weight() const { return m_weight; }",
          "includes": [
            "#include <qhash.h>",
            "#include <qstringlist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qhash.h>\n#include <qstringlist.h>\n\nQMimeGlobPattern {\n  inline unsigned weight() const { return m_weight; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "patterns.append",
          "args": [
            "glob.mimeType()"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glob.mimeType",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.mid",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.mid",
          "args": [
            "2"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glob.isCaseSensitive",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "isCaseSensitive",
          "container": "QMimeGlobPattern",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern_p.h",
          "lines": "85-85",
          "snippet": "inline bool isCaseSensitive() const { return m_caseSensitivity == Qt::CaseSensitive; }",
          "includes": [
            "#include <qhash.h>",
            "#include <qstringlist.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qhash.h>\n#include <qstringlist.h>\n\nQMimeGlobPattern {\n  inline bool isCaseSensitive() const { return m_caseSensitivity == Qt::CaseSensitive; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isFastPattern",
          "args": [
            "pattern"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "isFastPattern",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "142-151",
          "snippet": "static bool isFastPattern(const QString &pattern)\n{\n   // starts with \"*.\", has no other '*' and no other '.'\n   return pattern.lastIndexOf(QLatin1Char('*')) == 0\n      && pattern.lastIndexOf(QLatin1Char('.')) == 1\n      // and contains no other special character\n      && !pattern.contains(QLatin1Char('?'))\n      && !pattern.contains(QLatin1Char('['))\n      ;\n}",
          "includes": [
            "#include <QDebug>",
            "#include <QStringList>",
            "#include <QRegExp>",
            "#include \"qmimeglobpattern_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nstatic bool isFastPattern(const QString &pattern)\n{\n   // starts with \"*.\", has no other '*' and no other '.'\n   return pattern.lastIndexOf(QLatin1Char('*')) == 0\n      && pattern.lastIndexOf(QLatin1Char('.')) == 1\n      // and contains no other special character\n      && !pattern.contains(QLatin1Char('?'))\n      && !pattern.contains(QLatin1Char('['))\n      ;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Q_ASSERT",
          "args": [
            "!pattern.isEmpty()"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.isEmpty",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glob.pattern",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeAllGlobPatterns {\n  void QMimeAllGlobPatterns::addGlob(const QMimeGlobPattern &glob)\n  {\n      const QString &pattern = glob.pattern();\n      Q_ASSERT(!pattern.isEmpty());\n  \n      // Store each patterns into either m_fastPatternDict (*.txt, *.html etc. with default weight 50)\n      // or for the rest, like core.*, *.tar.bz2, *~, into highWeightPatternOffset (>50)\n      // or lowWeightPatternOffset (<=50)\n  \n      if (glob.weight() == 50 && isFastPattern(pattern) && !glob.isCaseSensitive()) {\n          // The bulk of the patterns is *.foo with weight 50 --> those go into the fast patterns hash.\n          const QString extension = pattern.mid(2).toLower();\n          QStringList &patterns = m_fastPatterns[extension]; // find or create\n          // This would just slow things down: if (!patterns.contains(glob.mimeType()))\n          patterns.append(glob.mimeType());\n      } else {\n          if (glob.weight() > 50) {\n              // This would just slow things down: if (!m_highWeightGlobs.hasPattern(glob.mimeType(), glob.pattern()))\n              m_highWeightGlobs.append(glob);\n          } else {\n              //This would just slow things down: if (!m_lowWeightGlobs.hasPattern(glob.mimeType(), glob.pattern()))\n              m_lowWeightGlobs.append(glob);\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "isFastPattern",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
    "lines": "142-151",
    "snippet": "static bool isFastPattern(const QString &pattern)\n{\n   // starts with \"*.\", has no other '*' and no other '.'\n   return pattern.lastIndexOf(QLatin1Char('*')) == 0\n      && pattern.lastIndexOf(QLatin1Char('.')) == 1\n      // and contains no other special character\n      && !pattern.contains(QLatin1Char('?'))\n      && !pattern.contains(QLatin1Char('['))\n      ;\n}",
    "includes": [
      "#include <QDebug>",
      "#include <QStringList>",
      "#include <QRegExp>",
      "#include \"qmimeglobpattern_p.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pattern.contains",
          "args": [
            "QLatin1Char('[')"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'['"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.contains",
          "args": [
            "QLatin1Char('?')"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'?'"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.lastIndexOf",
          "args": [
            "QLatin1Char('.')"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'.'"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.lastIndexOf",
          "args": [
            "QLatin1Char('*')"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'*'"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nstatic bool isFastPattern(const QString &pattern)\n{\n   // starts with \"*.\", has no other '*' and no other '.'\n   return pattern.lastIndexOf(QLatin1Char('*')) == 0\n      && pattern.lastIndexOf(QLatin1Char('.')) == 1\n      // and contains no other special character\n      && !pattern.contains(QLatin1Char('?'))\n      && !pattern.contains(QLatin1Char('['))\n      ;\n}"
  },
  {
    "function_name": "matchFileName",
    "container": "QMimeGlobPattern",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
    "lines": "92-140",
    "snippet": "bool QMimeGlobPattern::matchFileName(const QString &inputFilename) const\n{\n    // \"Applications MUST match globs case-insensitively, except when the case-sensitive\n    // attribute is set to true.\"\n    // The constructor takes care of putting case-insensitive patterns in lowercase.\n    const QString filename = m_caseSensitivity == Qt::CaseInsensitive ? inputFilename.toLower() : inputFilename;\n\n    const int pattern_len = m_pattern.length();\n    if (!pattern_len)\n        return false;\n    const int len = filename.length();\n\n    const int starCount = m_pattern.count(QLatin1Char('*'));\n\n    // Patterns like \"*~\", \"*.extension\"\n    if (m_pattern[0] == QLatin1Char('*') && m_pattern.indexOf(QLatin1Char('[')) == -1 && starCount == 1)\n    {\n        if (len + 1 < pattern_len) return false;\n\n        const QChar *c1 = m_pattern.unicode() + pattern_len - 1;\n        const QChar *c2 = filename.unicode() + len - 1;\n        int cnt = 1;\n        while (cnt < pattern_len && *c1-- == *c2--)\n            ++cnt;\n        return cnt == pattern_len;\n    }\n\n    // Patterns like \"README*\" (well this is currently the only one like that...)\n    if (starCount == 1 && m_pattern.at(pattern_len - 1) == QLatin1Char('*')) {\n        if (len + 1 < pattern_len) return false;\n        if (m_pattern.at(0) == QLatin1Char('*'))\n            return filename.indexOf(m_pattern.mid(1, pattern_len - 2)) != -1;\n\n        const QChar *c1 = m_pattern.unicode();\n        const QChar *c2 = filename.unicode();\n        int cnt = 1;\n        while (cnt < pattern_len && *c1++ == *c2++)\n           ++cnt;\n        return cnt == pattern_len;\n    }\n\n    // Names without any wildcards like \"README\"\n    if (m_pattern.indexOf(QLatin1Char('[')) == -1 && starCount == 0 && m_pattern.indexOf(QLatin1Char('?')))\n        return (m_pattern == filename);\n\n    // Other (quite rare) patterns, like \"*.anim[1-9j]\": use slow but correct method\n    QRegExp rx(m_pattern, Qt::CaseSensitive, QRegExp::WildcardUnix);\n    return rx.exactMatch(filename);\n}",
    "includes": [
      "#include <QDebug>",
      "#include <QStringList>",
      "#include <QRegExp>",
      "#include \"qmimeglobpattern_p.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rx.exactMatch",
          "args": [
            "filename"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.indexOf",
          "args": [
            "QLatin1Char('?')"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'?'"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.indexOf",
          "args": [
            "QLatin1Char('[')"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'['"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.unicode",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.unicode",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.indexOf",
          "args": [
            "m_pattern.mid(1, pattern_len - 2)"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.mid",
          "args": [
            "1",
            "pattern_len - 2"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'*'"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.at",
          "args": [
            "0"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'*'"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.at",
          "args": [
            "pattern_len - 1"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.unicode",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.unicode",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.indexOf",
          "args": [
            "QLatin1Char('[')"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'['"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'*'"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.count",
          "args": [
            "QLatin1Char('*')"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1Char",
          "args": [
            "'*'"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename.length",
          "args": [],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_pattern.length",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inputFilename.toLower",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeGlobPattern {\n  bool QMimeGlobPattern::matchFileName(const QString &inputFilename) const\n  {\n      // \"Applications MUST match globs case-insensitively, except when the case-sensitive\n      // attribute is set to true.\"\n      // The constructor takes care of putting case-insensitive patterns in lowercase.\n      const QString filename = m_caseSensitivity == Qt::CaseInsensitive ? inputFilename.toLower() : inputFilename;\n  \n      const int pattern_len = m_pattern.length();\n      if (!pattern_len)\n          return false;\n      const int len = filename.length();\n  \n      const int starCount = m_pattern.count(QLatin1Char('*'));\n  \n      // Patterns like \"*~\", \"*.extension\"\n      if (m_pattern[0] == QLatin1Char('*') && m_pattern.indexOf(QLatin1Char('[')) == -1 && starCount == 1)\n      {\n          if (len + 1 < pattern_len) return false;\n  \n          const QChar *c1 = m_pattern.unicode() + pattern_len - 1;\n          const QChar *c2 = filename.unicode() + len - 1;\n          int cnt = 1;\n          while (cnt < pattern_len && *c1-- == *c2--)\n              ++cnt;\n          return cnt == pattern_len;\n      }\n  \n      // Patterns like \"README*\" (well this is currently the only one like that...)\n      if (starCount == 1 && m_pattern.at(pattern_len - 1) == QLatin1Char('*')) {\n          if (len + 1 < pattern_len) return false;\n          if (m_pattern.at(0) == QLatin1Char('*'))\n              return filename.indexOf(m_pattern.mid(1, pattern_len - 2)) != -1;\n  \n          const QChar *c1 = m_pattern.unicode();\n          const QChar *c2 = filename.unicode();\n          int cnt = 1;\n          while (cnt < pattern_len && *c1++ == *c2++)\n             ++cnt;\n          return cnt == pattern_len;\n      }\n  \n      // Names without any wildcards like \"README\"\n      if (m_pattern.indexOf(QLatin1Char('[')) == -1 && starCount == 0 && m_pattern.indexOf(QLatin1Char('?')))\n          return (m_pattern == filename);\n  \n      // Other (quite rare) patterns, like \"*.anim[1-9j]\": use slow but correct method\n      QRegExp rx(m_pattern, Qt::CaseSensitive, QRegExp::WildcardUnix);\n      return rx.exactMatch(filename);\n  }\n}"
  },
  {
    "function_name": "addMatch",
    "container": "QMimeGlobMatchResult",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
    "lines": "48-82",
    "snippet": "QT_BEGIN_NAMESPACE\n\n/*!\n    \\internal\n    \\class QMimeGlobMatchResult\n    \\brief The QMimeGlobMatchResult class accumulates results from glob matching.\n\n    Handles glob weights, and preferring longer matches over shorter matches.\n*/\n\nvoid QMimeGlobMatchResult::addMatch(const QString &mimeType, int weight, const QString &pattern)\n{\n    // Is this a lower-weight pattern than the last match? Skip this match then.\n    if (weight < m_weight)\n        return;\n    bool replace = weight > m_weight;\n    if (!replace) {\n        // Compare the length of the match\n        if (pattern.length() < m_matchingPatternLength)\n            return; // too short, ignore\n        else if (pattern.length() > m_matchingPatternLength) {\n            // longer: clear any previous match (like *.bz2, when pattern is *.tar.bz2)\n            replace = true;\n        }\n    }\n    if (replace) {\n        m_matchingMimeTypes.clear();\n        // remember the new \"longer\" length\n        m_matchingPatternLength = pattern.length();\n        m_weight = weight;\n    }\n    m_matchingMimeTypes.append(mimeType);\n    if (pattern.startsWith(QLatin1String(\"*.\")))\n        m_foundSuffix = pattern.mid(2);\n}",
    "includes": [
      "#include <QDebug>",
      "#include <QStringList>",
      "#include <QRegExp>",
      "#include \"qmimeglobpattern_p.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pattern.mid",
          "args": [
            "2"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.startsWith",
          "args": [
            "QLatin1String(\"*.\")"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QLatin1String",
          "args": [
            "\"*.\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_matchingMimeTypes.append",
          "args": [
            "mimeType"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.length",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_matchingMimeTypes.clear",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeAllGlobPatterns",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeglobpattern.cpp",
          "lines": "233-238",
          "snippet": "void QMimeAllGlobPatterns::clear()\n{\n    m_fastPatterns.clear();\n    m_highWeightGlobs.clear();\n    m_lowWeightGlobs.clear();\n}",
          "includes": [
            "#include <QDebug>",
            "#include <QStringList>",
            "#include <QRegExp>",
            "#include \"qmimeglobpattern_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeAllGlobPatterns {\n  void QMimeAllGlobPatterns::clear()\n  {\n      m_fastPatterns.clear();\n      m_highWeightGlobs.clear();\n      m_lowWeightGlobs.clear();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pattern.length",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.length",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QDebug>\n#include <QStringList>\n#include <QRegExp>\n#include \"qmimeglobpattern_p.h\"\n\nQMimeGlobMatchResult {\n  QT_BEGIN_NAMESPACE\n  \n  /*!\n      \\internal\n      \\class QMimeGlobMatchResult\n      \\brief The QMimeGlobMatchResult class accumulates results from glob matching.\n  \n      Handles glob weights, and preferring longer matches over shorter matches.\n  */\n  \n  void QMimeGlobMatchResult::addMatch(const QString &mimeType, int weight, const QString &pattern)\n  {\n      // Is this a lower-weight pattern than the last match? Skip this match then.\n      if (weight < m_weight)\n          return;\n      bool replace = weight > m_weight;\n      if (!replace) {\n          // Compare the length of the match\n          if (pattern.length() < m_matchingPatternLength)\n              return; // too short, ignore\n          else if (pattern.length() > m_matchingPatternLength) {\n              // longer: clear any previous match (like *.bz2, when pattern is *.tar.bz2)\n              replace = true;\n          }\n      }\n      if (replace) {\n          m_matchingMimeTypes.clear();\n          // remember the new \"longer\" length\n          m_matchingPatternLength = pattern.length();\n          m_weight = weight;\n      }\n      m_matchingMimeTypes.append(mimeType);\n      if (pattern.startsWith(QLatin1String(\"*.\")))\n          m_foundSuffix = pattern.mid(2);\n  }\n}"
  }
]