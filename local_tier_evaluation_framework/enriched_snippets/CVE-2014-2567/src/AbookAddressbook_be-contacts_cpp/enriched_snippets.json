[
  {
    "function_name": "importPhoto(c",
    "container": "::Contacts",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "236-443",
    "snippet": "id BE::Contacts::importPhoto(const QString &path)\n{\n    if (!m_currentContact) {\n        qWarning(\"CANNOT IMPORT PHOTO FOR INVALID CONTACT!\");\n        return;\n    }\n    const QString photo = QString::number(\n#if QT_VERSION < QT_VERSION_CHECK(4, 7, 0)\n                QDateTime(QDate(1970, 1, 1), QTime(0, 0, 0)).secsTo(QDateTime::currentDateTime())\n#else\n                QDateTime::currentMSecsSinceEpoch()\n#endif\n                ) + \".\" + QFileInfo(path).suffix();\n\n    const QString file = QDir::homePath() + \"/.abook/\" + photo;\n    if (QFile::copy(path, file)) {\n        m_currentContact->setData(photo, Gui::AbookAddressbook::Photo);\n        setPhoto(file);\n    }\n}\n\nvoid BE::Contacts::addContact()\n{\n    m_dirty = true;\n    QStandardItem *item = new QStandardItem(\"[New Contact]\");\n    for (QList<Field>::const_iterator   it = fields.constBegin(),\n                                        end = fields.constEnd(); it != end; ++it) {\n        if (it->type == Gui::AbookAddressbook::Name || it->type == Gui::AbookAddressbook::Photo)\n            continue;\n        item->setData( \"[\" + it->key + \"]\", it->type );\n    }\n    if (m_currentContact)\n        m_abook->model()->insertRow(m_currentContact->index().row() + 1, item);\n    else\n        m_abook->model()->appendRow(item);\n    m_ui->contacts->setCurrentIndex(m_sortFilterProxy->mapFromSource(item->index()));\n}\n\nvoid BE::Contacts::removeCurrentContact()\n{\n    m_dirty = true;\n    if (m_currentContact) {\n        QModelIndex idx = m_sortFilterProxy->mapFromSource(m_currentContact->index());\n        delete m_currentContact;\n        m_currentContact = 0;\n        m_sortFilterProxy->removeRow(idx.row());\n    }\n}\n\nvoid BE::Contacts::setContact(const QModelIndex &index)\n{\n    QModelIndex translated = index;\n    if (index.model() == m_sortFilterProxy)\n        translated = m_sortFilterProxy->mapToSource(index);\n\n    if (m_currentContact) {\n        if (m_abook->model()->itemFromIndex(translated) == m_currentContact)\n            return; // same one\n        for (QList<Field>::const_iterator   it = fields.constBegin(),\n                                            end = fields.constEnd(); it != end; ++it) {\n            if (it->type != Gui::AbookAddressbook::Photo) {\n                QString s = lifeText(it->label);\n                if (s.startsWith(\"[\"))\n                    s.clear();\n                if (m_currentContact->data(it->type).toString() != s) {\n                    m_currentContact->setData( true, Gui::AbookAddressbook::Dirty );\n                    if (s.isEmpty())\n                        m_currentContact->setData( QVariant(), it->type ); // invalidate\n                    else\n                        m_currentContact->setData( s, it->type );\n                    m_dirty = true;\n                }\n            }\n        }\n    }\n\n    m_currentContact = m_abook->model()->itemFromIndex(translated);\n    if (!m_currentContact)\n        return;\n\n    for (QList<Field>::const_iterator   it = fields.constBegin(),\n        end = fields.constEnd(); it != end; ++it) {\n        if (it->type != Gui::AbookAddressbook::Photo) {\n            QString s;\n            QVariant v = m_currentContact->data(it->type);\n            if (v.isValid())\n                s = v.toString();\n            else\n                s = \"[\" + it->key + \"]\";\n            setText(it->label, s);\n        }\n    }\n    QPixmap userPic = m_incognitoPic;\n    QString photo = m_currentContact->data(Gui::AbookAddressbook::Photo).toString();\n    if (!photo.isEmpty()) {\n        if (QDir::isRelativePath(photo))\n            photo = QDir::homePath() + \"/.abook/\" + photo;\n        if (QFile::exists(photo) && setPhoto(photo))\n            return;\n    }\n    m_ui2->photo->setPixmap(userPic);\n\n    m_ui->contacts->setCurrentIndex(m_sortFilterProxy->mapFromSource(translated));\n}\n\nbool BE::Contacts::setPhoto(const QString &path)\n{\n    QRect r(0,0,160,160);\n    QImage  img = QImage( path );\n    if (img.isNull())\n        return false;\n    const float f = qMin( float(img.width())/float(r.width()),\n                            float(img.height())/float(r.height()) );\n    r.setSize( r.size()*f );\n    r.moveTopRight( img.rect().topRight() );\n    img = img.copy(r).scaled( QSize(160,160), Qt::KeepAspectRatioByExpanding, Qt::SmoothTransformation);\n\n    img = img.convertToFormat(QImage::Format_ARGB32);\n\n//     if ( !MPC::setting(\"rgbCover\").toBool() )\n    {\n        int r,g,b;\n        palette().color(foregroundRole()).getRgb(&r,&g,&b);\n\n        int n = img.width() * img.height();\n        const uchar *bits = img.bits();\n        QRgb *pixel = (QRgb*)(const_cast<uchar*>(bits));\n\n        // this creates a (slightly) translucent monochromactic version of the\n        // image using the foreground color\n        // the gray value is turned into the opacity\n        #define ALPHA qAlpha(pixel[i])\n        #define GRAY qGray(pixel[i])\n        #define OPACITY 224\n        if ( qMax( qMax(r,g), b ) > 128 ) // value > 50%, bright foreground\n            for (int i = 0; i < n; ++i)\n                pixel[i] = qRgba( r,g,b, ( ALPHA * ( (OPACITY*GRAY) / 255 ) ) / 255 );\n            else // inverse\n            for (int i = 0; i < n; ++i)\n                pixel[i] = qRgba( r,g,b, ( ALPHA * ( (OPACITY*(255-GRAY)) / 255 ) ) / 255 );\n    }\n#if 1\n    QPainterPath glasPath;\n    glasPath.moveTo( img.rect().topLeft() );\n    glasPath.lineTo( img.rect().topRight() );\n    glasPath.quadTo( img.rect().center()/2, img.rect().bottomLeft() );\n\n    QPainter p( &img );\n    p.setRenderHint( QPainter::Antialiasing );\n    p.setPen( Qt::NoPen );\n    p.setBrush( QColor(255,255,255,64) );\n    p.drawPath(glasPath);\n    p.end();\n#endif\n    m_ui2->photo->setPixmap( QPixmap::fromImage( img ) );\n    return true;\n}\n\nvoid BE::Contacts::updateFocusPolicy(QWidget *oldFocus, QWidget *newFocus)\n{\n    bool wasEdit(false), isEdit(false);\n    for (QList<Field>::const_iterator it = fields.constBegin(), end = fields.constEnd(); it != end; ++it) {\n        if (oldFocus == it->label)\n            wasEdit = true;\n        else if (newFocus == it->label)\n            isEdit = true;\n        if (isEdit && wasEdit)\n            break;\n    }\n\n    if (isEdit == wasEdit)\n        return;\n\n    Qt::FocusPolicy policy = isEdit ? Qt::StrongFocus : Qt::ClickFocus;\n\n    for (QList<Field>::const_iterator it = fields.constBegin(), end = fields.constEnd(); it != end; ++it)\n        it->label->setFocusPolicy(policy);\n\n    m_ui2->photo->setFocusPolicy(Qt::ClickFocus);\n\n    policy = isEdit ? Qt::ClickFocus : Qt::StrongFocus;\n    m_ui->filter->setFocusPolicy(policy);\n    m_ui->contacts->setFocusPolicy(policy);\n    m_ui->add->setFocusPolicy(policy);\n    m_ui->remove->setFocusPolicy(policy);\n}\n\nvoid BE::Contacts::manageContact(const QString &mail, const QString &prettyName)\n{\n    QStandardItemModel *model = m_abook->model();\n    for (int i = 0; i < model->rowCount(); ++i) {\n        QStandardItem *item = model->item(i);\n        if (QString::compare(item->data(Gui::AbookAddressbook::Mail).toString(), mail, Qt::CaseInsensitive) == 0) {\n            setContact(model->index(i, 0));\n            return;\n        }\n    }\n\n    // no match -> create one\n    addContact();\n    m_ui2->mail->setText(mail);\n    if (!prettyName.isEmpty()) {\n        m_ui2->name->setText(prettyName);\n        m_currentContact->setText(prettyName);\n    } else {\n        m_ui2->name->setText(\"[name]\");\n    }\n}",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui2->name->setText",
          "args": [
            "name]\");"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->setText",
          "args": [
            "ettyName);"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->name->setText",
          "args": [
            "ettyName);"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ettyName.isEmpty",
          "args": [],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->mail->setText",
          "args": [
            "il);"
          ],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dContact()",
          "args": [],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tContact(m",
          "args": [
            "del->index(i, 0));"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "del->index",
          "args": [
            ")"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "indexForTask(",
          "container": "askPresentationModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/TaskPresentationModel.cpp",
          "lines": "111-132",
          "snippet": "ModelIndex TaskPresentationModel::indexForTask(ImapTask *const task) const\n{\n    Q_ASSERT(task);\n    if (task->parentTask) {\n        // The target task is a child of another task\n        int index = task->parentTask->dependentTasks.indexOf(task);\n        Q_ASSERT(index != -1);\n        return createIndex(index, 0, task);\n    } else {\n        // The child has no parent task, so the child is apparently the top-level task for a given parser,\n        Q_ASSERT(task->parser);\n        int index = m_model->accessParser(task->parser).activeTasks.indexOf(task);\n        if (index == -1) {\n#ifdef TROJITA_DEBUG_TASK_TREE\n            m_model->checkTaskTreeConsistency();\n            Q_ASSERT(index != -1);\n#endif\n            return QModelIndex();\n        }\n        return createIndex(index, 0, task);\n    }\n}",
          "includes": [
            "include \"QAIM_reset.h\"",
            "include \"Model.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/UnSelectTask.h\"\n#",
            "include \"Imap/Tasks/SortTask.h\"\n#",
            "include \"Imap/Tasks/OpenConnectionTask.h\"\n#",
            "include \"Imap/Tasks/NoopTask.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Tasks/GetAnyConnectionTask.h\"\n#",
            "include \"TaskPresentationModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"QAIM_reset.h\"\ninclude \"Model.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/UnSelectTask.h\"\n#\ninclude \"Imap/Tasks/SortTask.h\"\n#\ninclude \"Imap/Tasks/OpenConnectionTask.h\"\n#\ninclude \"Imap/Tasks/NoopTask.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Tasks/GetAnyConnectionTask.h\"\n#\ninclude \"TaskPresentationModel.h\"\n#\n\naskPresentationModel {\n  ModelIndex TaskPresentationModel::indexForTask(ImapTask *const task) const\n  {\n      Q_ASSERT(task);\n      if (task->parentTask) {\n          // The target task is a child of another task\n          int index = task->parentTask->dependentTasks.indexOf(task);\n          Q_ASSERT(index != -1);\n          return createIndex(index, 0, task);\n      } else {\n          // The child has no parent task, so the child is apparently the top-level task for a given parser,\n          Q_ASSERT(task->parser);\n          int index = m_model->accessParser(task->parser).activeTasks.indexOf(task);\n          if (index == -1) {\n  #ifdef TROJITA_DEBUG_TASK_TREE\n              m_model->checkTaskTreeConsistency();\n              Q_ASSERT(index != -1);\n  #endif\n              return QModelIndex();\n          }\n          return createIndex(index, 0, task);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tring::compare(i",
          "args": [
            "em->data(Gui::AbookAddressbook::Mail).toString(),",
            "il,",
            "::CaseInsensitive)"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "em->data",
          "args": [],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "em->data",
          "args": [
            "i::AbookAddressbook::Mail)."
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "del->item",
          "args": [
            ";"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "del->rowCount",
          "args": [],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "rowCount",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "133-153",
          "snippet": "void ModelTest::rowCount()\n{\n    // check top row\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    int rows = model->rowCount(topIndex);\n    Q_ASSERT(rows >= 0);\n    if (rows > 0)\n        Q_ASSERT(model->hasChildren(topIndex) == true);\n\n    QModelIndex secondLevelIndex = model->index(0, 0, topIndex);\n    if (secondLevelIndex.isValid()) { // not the top level\n        // check a row count where parent is valid\n        rows = model->rowCount(secondLevelIndex);\n        Q_ASSERT(rows >= 0);\n        if (rows > 0)\n            Q_ASSERT(model->hasChildren(secondLevelIndex) == true);\n    }\n\n    // The models rowCount() is tested more extensively in checkChildren(),\n    // but this catches the big mistakes\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::rowCount()\n  {\n      // check top row\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      int rows = model->rowCount(topIndex);\n      Q_ASSERT(rows >= 0);\n      if (rows > 0)\n          Q_ASSERT(model->hasChildren(topIndex) == true);\n  \n      QModelIndex secondLevelIndex = model->index(0, 0, topIndex);\n      if (secondLevelIndex.isValid()) { // not the top level\n          // check a row count where parent is valid\n          rows = model->rowCount(secondLevelIndex);\n          Q_ASSERT(rows >= 0);\n          if (rows > 0)\n              Q_ASSERT(model->hasChildren(secondLevelIndex) == true);\n      }\n  \n      // The models rowCount() is tested more extensively in checkChildren(),\n      // but this catches the big mistakes\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->remove->setFocusPolicy",
          "args": [
            "licy);"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->add->setFocusPolicy",
          "args": [
            "licy);"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->setFocusPolicy",
          "args": [
            "licy);"
          ],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->filter->setFocusPolicy",
          "args": [
            "licy);"
          ],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->photo->setFocusPolicy",
          "args": [
            "::ClickFocus);"
          ],
          "line": 414
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->label->setFocusPolicy",
          "args": [
            "licy);"
          ],
          "line": 412
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constEnd",
          "args": [],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constBegin",
          "args": [],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constEnd",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constBegin",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->photo->setPixmap",
          "args": [
            "ixmap::fromImage( img ) )"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmap::fromImage(",
          "args": [
            "g )"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "send(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "338-370",
          "snippet": "oid ComposeWidget::send()\n{\n    // Well, Trojita is of course rock solid and will never ever crash :), but experience has shown that every now and then,\n    // there is a subtle issue $somewhere. This means that it's probably a good idea to save the draft explicitly -- better\n    // than losing some work. It's cheap anyway.\n    saveDraft(m_autoSavePath);\n\n    if (!buildMessageData())\n        return;\n\n    m_submission->setImapOptions(m_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),\n                                 m_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),\n                                 m_settings->value(Common::SettingsNames::imapHostKey).toString(),\n                                 m_settings->value(Common::SettingsNames::imapUserKey).toString(),\n                                 m_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail);\n    m_submission->setSmtpOptions(m_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),\n                                 m_settings->value(Common::SettingsNames::smtpUserKey).toString());\n\n\n    ProgressPopUp *progress = new ProgressPopUp();\n    OverlayWidget *overlay = new OverlayWidget(progress, this);\n    overlay->show();\n    setUiWidgetsEnabled(false);\n\n    connect(m_submission, SIGNAL(progressMin(int)), progress, SLOT(setMinimum(int)));\n    connect(m_submission, SIGNAL(progressMax(int)), progress, SLOT(setMaximum(int)));\n    connect(m_submission, SIGNAL(progress(int)), progress, SLOT(setValue(int)));\n    connect(m_submission, SIGNAL(updateStatusMessage(QString)), progress, SLOT(setLabelText(QString)));\n    connect(m_submission, SIGNAL(succeeded()), overlay, SLOT(deleteLater()));\n    connect(m_submission, SIGNAL(failed(QString)), overlay, SLOT(deleteLater()));\n\n    m_submission->send();\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::send()\n  {\n      // Well, Trojita is of course rock solid and will never ever crash :), but experience has shown that every now and then,\n      // there is a subtle issue $somewhere. This means that it's probably a good idea to save the draft explicitly -- better\n      // than losing some work. It's cheap anyway.\n      saveDraft(m_autoSavePath);\n  \n      if (!buildMessageData())\n          return;\n  \n      m_submission->setImapOptions(m_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),\n                                   m_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),\n                                   m_settings->value(Common::SettingsNames::imapHostKey).toString(),\n                                   m_settings->value(Common::SettingsNames::imapUserKey).toString(),\n                                   m_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail);\n      m_submission->setSmtpOptions(m_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),\n                                   m_settings->value(Common::SettingsNames::smtpUserKey).toString());\n  \n  \n      ProgressPopUp *progress = new ProgressPopUp();\n      OverlayWidget *overlay = new OverlayWidget(progress, this);\n      overlay->show();\n      setUiWidgetsEnabled(false);\n  \n      connect(m_submission, SIGNAL(progressMin(int)), progress, SLOT(setMinimum(int)));\n      connect(m_submission, SIGNAL(progressMax(int)), progress, SLOT(setMaximum(int)));\n      connect(m_submission, SIGNAL(progress(int)), progress, SLOT(setValue(int)));\n      connect(m_submission, SIGNAL(updateStatusMessage(QString)), progress, SLOT(setLabelText(QString)));\n      connect(m_submission, SIGNAL(succeeded()), overlay, SLOT(deleteLater()));\n      connect(m_submission, SIGNAL(failed(QString)), overlay, SLOT(deleteLater()));\n  \n      m_submission->send();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "drawPath",
          "args": [
            "asPath);"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setBrush",
          "args": [
            "olor(255,255,255,64) )"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "olor(2",
          "args": [
            "5,2",
            "5,2",
            "5,6",
            ")"
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setPen",
          "args": [
            "::NoPen )"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setRenderHint",
          "args": [
            "ainter::Antialiasing )"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asPath.quadTo",
          "args": [
            "g.rect().center()/2,",
            "g.rect().bottomLeft() )"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asPath.lineTo",
          "args": [
            "g.rect().topRight() )"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asPath.moveTo",
          "args": [
            "g.rect().topLeft() )"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gba(",
          "args": [
            "g",
            "b",
            "ALPHA * ( (OPACITY*(255-GRAY)) / 255 ) ) / 255 )"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gba(",
          "args": [
            "g",
            "b",
            "ALPHA * ( (OPACITY*GRAY) / 255 ) ) / 255 )"
          ],
          "line": 372
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ax(",
          "args": [
            "ax(r,g),",
            ")"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ax(r",
          "args": [
            "g",
            ","
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nst_cast<uchar*>",
          "args": [
            "ts))"
          ],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.bits",
          "args": [],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.height",
          "args": [],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.width",
          "args": [],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lette",
          "args": [
            ",&",
            ",&",
            ");"
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lette",
          "args": [
            "regroundRole())."
          ],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "regroundRole()",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lette()",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.convertToFormat",
          "args": [
            "mage::Format_ARGB32);"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.copy",
          "args": [
            "ize(160,160),",
            "::KeepAspectRatioByExpanding,",
            "::SmoothTransformation);"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ize(1",
          "args": [
            "0,1",
            "0),"
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.copy",
          "args": [
            "."
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "moveTopRight",
          "args": [
            "g.rect().topRight() )"
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.rect",
          "args": [],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setSize",
          "args": [
            "size()*f )"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size",
          "args": [],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "sizeHint",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "131-134",
          "snippet": "QSize FlowLayout::sizeHint() const\n{\n    return minimumSize();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  QSize FlowLayout::sizeHint() const\n  {\n      return minimumSize();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "in(",
          "args": [
            "oat(img.width())/float(r.width()),",
            "oat(img.height())/float(r.height()) )"
          ],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "ain(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/main.cpp",
          "lines": "35-87",
          "snippet": "nt main(int argc, char **argv)\n{\n    Common::registerMetaTypes();\n\n    QApplication app(argc, argv);\n    Q_INIT_RESOURCE(icons);\n    Q_INIT_RESOURCE(license);\n\n    QTranslator qtTranslator;\n    qtTranslator.load(QLatin1String(\"qt_\") + QLocale::system().name(),\n                      QLibraryInfo::location(QLibraryInfo::TranslationsPath));\n    app.installTranslator(&qtTranslator);\n\n    QLatin1String localeSuffix(\"/locale\");\n    QString localeName(QLatin1String(\"trojita_common_\") + QLocale::system().name());\n\n    // The \"installed to system\" localization\n    QTranslator appSystemTranslator;\n    if (!Gui::Util::pkgDataDir().isEmpty()) {\n        appSystemTranslator.load(localeName, Gui::Util::pkgDataDir() + localeSuffix);\n        app.installTranslator(&appSystemTranslator);\n    }\n\n    // The \"in the directory with the binary\" localization\n    QTranslator appDirectoryTranslator;\n    appDirectoryTranslator.load(localeName, app.applicationDirPath() + localeSuffix);\n    app.installTranslator(&appDirectoryTranslator);\n\n    AppVersion::setGitVersion();\n    AppVersion::setCoreApplicationData();\n    app.setWindowIcon(QIcon(QLatin1String(\":/icons/trojita.png\")));\n\n    // Hack: support multiple \"profiles\"\n    QString profileName;\n    if (argc == 3 && argv[1] == QByteArray(\"--profile\")) {\n        profileName = QString::fromLocal8Bit(argv[2]);\n        // We are abusing the env vars here. Yes, it's a hidden global. Yes, it's ugly.\n        // Take it or leave it, this is a time-limited hack.\n        // The env var is also in UTF-8. I like UTF-8.\n        qputenv(\"TROJITA_PROFILE\", profileName.toUtf8());\n    } else {\n#ifndef Q_OS_WIN32\n        unsetenv(\"TROJITA_PROFILE\");\n#else\n        putenv(\"TROJITA_PROFILE=\");\n#endif\n    }\n    QSettings settings(Common::Application::organization,\n                       profileName.isEmpty() ? Common::Application::name : Common::Application::name + QLatin1Char('-') + profileName);\n    Gui::MainWindow win(&settings);\n    win.show();\n    return app.exec();\n}",
          "includes": [
            "include \"static_plugins.h\"",
            "include \"Gui/Window.h\"",
            "include \"Gui/Util.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AppVersion/SetCoreApplication.h\"\n#",
            "include <QTranslator>",
            "include <QSettings>\n#",
            "include <QLibraryInfo>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"static_plugins.h\"\ninclude \"Gui/Window.h\"\ninclude \"Gui/Util.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AppVersion/SetCoreApplication.h\"\n#\ninclude <QTranslator>\ninclude <QSettings>\n#\ninclude <QLibraryInfo>\n#\ninclude <QApplication>\n#\n\nnt main(int argc, char **argv)\n{\n    Common::registerMetaTypes();\n\n    QApplication app(argc, argv);\n    Q_INIT_RESOURCE(icons);\n    Q_INIT_RESOURCE(license);\n\n    QTranslator qtTranslator;\n    qtTranslator.load(QLatin1String(\"qt_\") + QLocale::system().name(),\n                      QLibraryInfo::location(QLibraryInfo::TranslationsPath));\n    app.installTranslator(&qtTranslator);\n\n    QLatin1String localeSuffix(\"/locale\");\n    QString localeName(QLatin1String(\"trojita_common_\") + QLocale::system().name());\n\n    // The \"installed to system\" localization\n    QTranslator appSystemTranslator;\n    if (!Gui::Util::pkgDataDir().isEmpty()) {\n        appSystemTranslator.load(localeName, Gui::Util::pkgDataDir() + localeSuffix);\n        app.installTranslator(&appSystemTranslator);\n    }\n\n    // The \"in the directory with the binary\" localization\n    QTranslator appDirectoryTranslator;\n    appDirectoryTranslator.load(localeName, app.applicationDirPath() + localeSuffix);\n    app.installTranslator(&appDirectoryTranslator);\n\n    AppVersion::setGitVersion();\n    AppVersion::setCoreApplicationData();\n    app.setWindowIcon(QIcon(QLatin1String(\":/icons/trojita.png\")));\n\n    // Hack: support multiple \"profiles\"\n    QString profileName;\n    if (argc == 3 && argv[1] == QByteArray(\"--profile\")) {\n        profileName = QString::fromLocal8Bit(argv[2]);\n        // We are abusing the env vars here. Yes, it's a hidden global. Yes, it's ugly.\n        // Take it or leave it, this is a time-limited hack.\n        // The env var is also in UTF-8. I like UTF-8.\n        qputenv(\"TROJITA_PROFILE\", profileName.toUtf8());\n    } else {\n#ifndef Q_OS_WIN32\n        unsetenv(\"TROJITA_PROFILE\");\n#else\n        putenv(\"TROJITA_PROFILE=\");\n#endif\n    }\n    QSettings settings(Common::Application::organization,\n                       profileName.isEmpty() ? Common::Application::name : Common::Application::name + QLatin1Char('-') + profileName);\n    Gui::MainWindow win(&settings);\n    win.show();\n    return app.exec();\n}"
        }
      },
      {
        "call_info": {
          "callee": "oat",
          "args": [
            "height())"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "height",
          "args": [],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oat",
          "args": [
            "g.height())/"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.height",
          "args": [],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oat",
          "args": [
            "width()),"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "width",
          "args": [],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oat",
          "args": [
            "g.width())/"
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.width",
          "args": [],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.isNull",
          "args": [],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mage(",
          "args": [
            "th )"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->setCurrentIndex",
          "args": [
            "sortFilterProxy->mapFromSource(translated));"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->mapFromSource",
          "args": [
            "anslated))"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->photo->setPixmap",
          "args": [
            "erPic);"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tPhoto(p",
          "args": [
            "oto))"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile::exists(p",
          "args": [
            "oto)"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ir::homePath()",
          "args": [],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ir::isRelativePath(p",
          "args": [
            "oto))"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oto.isEmpty",
          "args": [],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->data",
          "args": [
            "i::AbookAddressbook::Photo)."
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tText(i",
          "args": [
            "->label,",
            ";"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toString",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isValid",
          "args": [],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "isValid(",
          "container": "equence",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Sequence.cpp",
          "lines": "125-131",
          "snippet": "ool Sequence::isValid() const\n{\n    if (kind == DISTINCT && list.isEmpty())\n        return false;\n    else\n        return true;\n}",
          "includes": [
            "include <QTextStream>",
            "include <QStringList>\n#",
            "include \"Sequence.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QTextStream>\ninclude <QStringList>\n#\ninclude \"Sequence.h\"\n#\n\nequence {\n  ool Sequence::isValid() const\n  {\n      if (kind == DISTINCT && list.isEmpty())\n          return false;\n      else\n          return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "currentContact->data",
          "args": [
            "->type);"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constEnd",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constBegin",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [
            "anslated);"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->setData",
          "args": [
            "->type )"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->setData",
          "args": [
            "ariant(),",
            "->type )"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ariant()",
          "args": [],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isEmpty",
          "args": [],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->setData",
          "args": [
            "ue,",
            "i::AbookAddressbook::Dirty )"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->data",
          "args": [
            "->type)."
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clear",
          "args": [],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "clearLogDisplay(",
          "container": "rotocolLoggerWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ProtocolLoggerWidget.cpp",
          "lines": "115-130",
          "snippet": "oid ProtocolLoggerWidget::clearLogDisplay()\n{\n    // These will be freed from the GUI\n    loggerWidgets.clear();\n\n    // We use very different indexing internally, to an extent where QTabWidget's ints are not easily obtainable from that,\n    // so it's much better to clean up the GUI at first and only after that purge the underlying data\n    while (tabs->count()) {\n        QWidget *w = tabs->widget(0);\n        Q_ASSERT(w);\n        tabs->removeTab(0);\n        w->deleteLater();\n    }\n\n    buffers.clear();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Common/FileLogger.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include <QVBoxLayout>\n#",
            "include <QTimer>\n#",
            "include <QTextStream>\n#",
            "include <QTabWidget>\n#",
            "include <QPushButton>\n#",
            "include <QPlainTextEdit>\n#",
            "include <QFile>\n#",
            "include <QDateTime>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Common/FileLogger.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude <QVBoxLayout>\n#\ninclude <QTimer>\n#\ninclude <QTextStream>\n#\ninclude <QTabWidget>\n#\ninclude <QPushButton>\n#\ninclude <QPlainTextEdit>\n#\ninclude <QFile>\n#\ninclude <QDateTime>\n#\n\nrotocolLoggerWidget {\n  oid ProtocolLoggerWidget::clearLogDisplay()\n  {\n      // These will be freed from the GUI\n      loggerWidgets.clear();\n  \n      // We use very different indexing internally, to an extent where QTabWidget's ints are not easily obtainable from that,\n      // so it's much better to clean up the GUI at first and only after that purge the underlying data\n      while (tabs->count()) {\n          QWidget *w = tabs->widget(0);\n          Q_ASSERT(w);\n          tabs->removeTab(0);\n          w->deleteLater();\n      }\n  \n      buffers.clear();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "startsWith",
          "args": [
            "\"))"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "feText(i",
          "args": [
            "->label);"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constEnd",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constBegin",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [
            "anslated)"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->mapToSource",
          "args": [
            "dex);"
          ],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dex.model",
          "args": [],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->removeRow",
          "args": [
            "x.row());"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "x.row",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->mapFromSource",
          "args": [
            "currentContact->index());"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->index",
          "args": [],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "index",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "200-224",
          "snippet": "void ModelTest::index()\n{\n    // Make sure that invalid values returns an invalid index\n    Q_ASSERT(model->index(-2, -2) == QModelIndex());\n    Q_ASSERT(model->index(-2, 0) == QModelIndex());\n    Q_ASSERT(model->index(0, -2) == QModelIndex());\n\n    int rows = model->rowCount();\n    int columns = model->columnCount();\n\n    if (rows == 0)\n        return;\n\n    // Catch off by one errors\n    Q_ASSERT(model->index(rows, columns) == QModelIndex());\n    Q_ASSERT(model->index(0, 0).isValid() == true);\n\n    // Make sure that the same index is *always* returned\n    QModelIndex a = model->index(0, 0);\n    QModelIndex b = model->index(0, 0);\n    Q_ASSERT(a == b);\n\n    // index() is tested more extensively in checkChildren(),\n    // but this catches the big mistakes\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::index()\n  {\n      // Make sure that invalid values returns an invalid index\n      Q_ASSERT(model->index(-2, -2) == QModelIndex());\n      Q_ASSERT(model->index(-2, 0) == QModelIndex());\n      Q_ASSERT(model->index(0, -2) == QModelIndex());\n  \n      int rows = model->rowCount();\n      int columns = model->columnCount();\n  \n      if (rows == 0)\n          return;\n  \n      // Catch off by one errors\n      Q_ASSERT(model->index(rows, columns) == QModelIndex());\n      Q_ASSERT(model->index(0, 0).isValid() == true);\n  \n      // Make sure that the same index is *always* returned\n      QModelIndex a = model->index(0, 0);\n      QModelIndex b = model->index(0, 0);\n      Q_ASSERT(a == b);\n  \n      // index() is tested more extensively in checkChildren(),\n      // but this catches the big mistakes\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tring::number(",
          "args": [
            "f QT_VERSION < QT_VERSION_CHECK(4, 7, 0)\n                QDateTime(QDate(1970, 1, 1), QTime(0, 0, 0)).secsTo(QDateTime::currentDateTime())\n#else\n                QDateTime::currentMSecsSinceEpoch()\n#endif\n                ) + \".\" + QFileInfo(path).suffix();\n\n    const QString file = QDir::homePath() + \"/.abook/\" + photo;\n    if (QFile::copy(path, file)) {\n        m_currentContact->setData(photo, Gui::AbookAddressbook::Photo);\n        setPhoto(file);\n    }\n}\n\nvoid BE::Contacts::addContact()\n{    m_dirty = true;\n    QStandardItem *item = new QStandardItem(\"[New Contact]\");\n    for (QList<Field>::const_iterator   it = fields.constBegin(),\n                                        end = fields.constEnd(); it != end; ++it) {\n        if (it->type == Gui::AbookAddressbook::Name || it->type == Gui::AbookAddressbook::Photo)\n            continue;\n        item->setData( \"[\" + it->key + \"]\", it->type );\n    }\n    if (m_currentContact)\n        m_abook->model()->insertRow(m_currentContact->index().row() + 1, item);\n    else\n        m_abook->model()->appendRow(item);\n    m_ui->contacts->setCurrentIndex(m_sortFilterProxy->mapFromSource(item->index()));\n}\n\nid BE::Contacts::removeCurrentContact()"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->setCurrentIndex",
          "args": [
            "sortFilterProxy->mapFromSource(item->index()));"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->mapFromSource",
          "args": [
            "em->index()))"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [
            "em);"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [
            "currentContact->index().row() + 1,",
            "em);"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "em->setData",
          "args": [
            "\" + it->key + \"]\",",
            "->type )"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constEnd",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constBegin",
          "args": [],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::Contacts::addContact()",
          "args": [],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tPhoto(f",
          "args": [
            "le);"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->setData",
          "args": [
            "oto,",
            "i::AbookAddressbook::Photo);"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oto;",
          "args": [
            "ile::copy(path, file))"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile::copy(p",
          "args": [
            "th,",
            "le))"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ileInfo",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ileInfo(p",
          "args": [
            "th)."
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ateTime",
          "args": [
            "ateTime::currentDateTime())"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "arseRFC2822DateTime(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/LowLevelParser.cpp",
          "lines": "391-456",
          "snippet": "DateTime parseRFC2822DateTime(const QString &string)\n{\n    QStringList monthNames = QStringList() << QLatin1String(\"jan\") << QLatin1String(\"feb\") << QLatin1String(\"mar\")\n                                           << QLatin1String(\"apr\") << QLatin1String(\"may\") << QLatin1String(\"jun\")\n                                           << QLatin1String(\"jul\") << QLatin1String(\"aug\") << QLatin1String(\"sep\")\n                                           << QLatin1String(\"oct\") << QLatin1String(\"nov\") << QLatin1String(\"dec\");\n\n    QRegExp rx(QString::fromUtf8(\"^(?:\\\\s*([A-Z][a-z]+)\\\\s*,\\\\s*)?\"   // date-of-week\n                                 \"(\\\\d{1,2})\\\\s+(%1)\\\\s+(\\\\d{2,4})\" // date\n                                 \"\\\\s+(\\\\d{1,2})\\\\s*:(\\\\d{1,2})\\\\s*(?::\\\\s*(\\\\d{1,2})\\\\s*)?\" // time\n                                 \"(\\\\s+(?:(?:([+-]?)(\\\\d{2})(\\\\d{2}))|(UT|GMT|EST|EDT|CST|CDT|MST|MDT|PST|PDT|[A-IK-Za-ik-z])))?\" // timezone\n                                 ).arg(monthNames.join(QLatin1String(\"|\"))), Qt::CaseInsensitive);\n    int pos = rx.indexIn(string);\n\n    if (pos == -1)\n        throw ParseError(\"Date format not recognized\");\n\n    QStringList list = rx.capturedTexts();\n\n    if (list.size() != 13)\n        throw ParseError(\"Date regular expression returned weird data (internal error?)\");\n\n    int year = list[4].toInt();\n    int month = monthNames.indexOf(list[3].toLower()) + 1;\n    if (month == 0)\n        throw ParseError(\"Invalid month name\");\n    int day = list[2].toInt();\n    int hours = list[5].toInt();\n    int minutes = list[6].toInt();\n    int seconds = list[7].toInt();\n    int shift = list[10].toInt() * 60 + list[11].toInt();\n    if (list[9] == QLatin1String(\"-\"))\n        shift *= 60;\n    else\n        shift *= -60;\n    if (! list[12].isEmpty()) {\n        const QString tz = list[12].toUpper();\n        if (tz == QLatin1String(\"UT\") || tz == QLatin1String(\"GMT\"))\n            shift = 0;\n        else if (tz == QLatin1String(\"EST\"))\n            shift = 5 * 3600;\n        else if (tz == QLatin1String(\"EDT\"))\n            shift = 4 * 3600;\n        else if (tz == QLatin1String(\"CST\"))\n            shift = 6 * 3600;\n        else if (tz == QLatin1String(\"CDT\"))\n            shift = 5 * 3600;\n        else if (tz == QLatin1String(\"MST\"))\n            shift = 7 * 3600;\n        else if (tz == QLatin1String(\"MDT\"))\n            shift = 6 * 3600;\n        else if (tz == QLatin1String(\"PST\"))\n            shift = 8 * 3600;\n        else if (tz == QLatin1String(\"PDT\"))\n            shift = 7 * 3600;\n        else if (tz.size() == 1)\n            shift = 0;\n        else\n            throw ParseError(\"Invalid TZ specification\");\n    }\n\n    QDateTime date(QDate(year, month, day), QTime(hours, minutes, seconds), Qt::UTC);\n    date = date.addSecs(shift);\n\n    return date;\n}",
          "includes": [
            "include \"Imap/Encoders.h\"",
            "include \"../Exceptions.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include <QDateTime>\n#",
            "include <QVariant>\n#",
            "include <QStringList>\n#",
            "include <QPair>\n#",
            "include <limits>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Encoders.h\"\ninclude \"../Exceptions.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude <QDateTime>\n#\ninclude <QVariant>\n#\ninclude <QStringList>\n#\ninclude <QPair>\n#\ninclude <limits>\n#\n\nDateTime parseRFC2822DateTime(const QString &string)\n{\n    QStringList monthNames = QStringList() << QLatin1String(\"jan\") << QLatin1String(\"feb\") << QLatin1String(\"mar\")\n                                           << QLatin1String(\"apr\") << QLatin1String(\"may\") << QLatin1String(\"jun\")\n                                           << QLatin1String(\"jul\") << QLatin1String(\"aug\") << QLatin1String(\"sep\")\n                                           << QLatin1String(\"oct\") << QLatin1String(\"nov\") << QLatin1String(\"dec\");\n\n    QRegExp rx(QString::fromUtf8(\"^(?:\\\\s*([A-Z][a-z]+)\\\\s*,\\\\s*)?\"   // date-of-week\n                                 \"(\\\\d{1,2})\\\\s+(%1)\\\\s+(\\\\d{2,4})\" // date\n                                 \"\\\\s+(\\\\d{1,2})\\\\s*:(\\\\d{1,2})\\\\s*(?::\\\\s*(\\\\d{1,2})\\\\s*)?\" // time\n                                 \"(\\\\s+(?:(?:([+-]?)(\\\\d{2})(\\\\d{2}))|(UT|GMT|EST|EDT|CST|CDT|MST|MDT|PST|PDT|[A-IK-Za-ik-z])))?\" // timezone\n                                 ).arg(monthNames.join(QLatin1String(\"|\"))), Qt::CaseInsensitive);\n    int pos = rx.indexIn(string);\n\n    if (pos == -1)\n        throw ParseError(\"Date format not recognized\");\n\n    QStringList list = rx.capturedTexts();\n\n    if (list.size() != 13)\n        throw ParseError(\"Date regular expression returned weird data (internal error?)\");\n\n    int year = list[4].toInt();\n    int month = monthNames.indexOf(list[3].toLower()) + 1;\n    if (month == 0)\n        throw ParseError(\"Invalid month name\");\n    int day = list[2].toInt();\n    int hours = list[5].toInt();\n    int minutes = list[6].toInt();\n    int seconds = list[7].toInt();\n    int shift = list[10].toInt() * 60 + list[11].toInt();\n    if (list[9] == QLatin1String(\"-\"))\n        shift *= 60;\n    else\n        shift *= -60;\n    if (! list[12].isEmpty()) {\n        const QString tz = list[12].toUpper();\n        if (tz == QLatin1String(\"UT\") || tz == QLatin1String(\"GMT\"))\n            shift = 0;\n        else if (tz == QLatin1String(\"EST\"))\n            shift = 5 * 3600;\n        else if (tz == QLatin1String(\"EDT\"))\n            shift = 4 * 3600;\n        else if (tz == QLatin1String(\"CST\"))\n            shift = 6 * 3600;\n        else if (tz == QLatin1String(\"CDT\"))\n            shift = 5 * 3600;\n        else if (tz == QLatin1String(\"MST\"))\n            shift = 7 * 3600;\n        else if (tz == QLatin1String(\"MDT\"))\n            shift = 6 * 3600;\n        else if (tz == QLatin1String(\"PST\"))\n            shift = 8 * 3600;\n        else if (tz == QLatin1String(\"PDT\"))\n            shift = 7 * 3600;\n        else if (tz.size() == 1)\n            shift = 0;\n        else\n            throw ParseError(\"Invalid TZ specification\");\n    }\n\n    QDateTime date(QDate(year, month, day), QTime(hours, minutes, seconds), Qt::UTC);\n    date = date.addSecs(shift);\n\n    return date;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ateTime::currentDateTime()",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ateTime(Q",
          "args": [
            "ate(1970, 1, 1),",
            "ime(0, 0, 0))."
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ime(0",
          "args": [
            ")"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ate(1",
          "args": [
            "70,",
            ","
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_VERSION_CHECK(4",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arning(\"",
          "args": [
            "ANNOT IMPORT PHOTO FOR INVALID CONTACT!\");"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\n {\n  Contacts {\n    id BE::Contacts::importPhoto(const QString &path)\n    {\n        if (!m_currentContact) {\n            qWarning(\"CANNOT IMPORT PHOTO FOR INVALID CONTACT!\");\n            return;\n        }\n        const QString photo = QString::number(\n    #if QT_VERSION < QT_VERSION_CHECK(4, 7, 0)\n                    QDateTime(QDate(1970, 1, 1), QTime(0, 0, 0)).secsTo(QDateTime::currentDateTime())\n    #else\n                    QDateTime::currentMSecsSinceEpoch()\n    #endif\n                    ) + \".\" + QFileInfo(path).suffix();\n    \n        const QString file = QDir::homePath() + \"/.abook/\" + photo;\n        if (QFile::copy(path, file)) {\n            m_currentContact->setData(photo, Gui::AbookAddressbook::Photo);\n            setPhoto(file);\n        }\n    }\n    \n    void BE::Contacts::addContact()\n    {\n        m_dirty = true;\n        QStandardItem *item = new QStandardItem(\"[New Contact]\");\n        for (QList<Field>::const_iterator   it = fields.constBegin(),\n                                            end = fields.constEnd(); it != end; ++it) {\n            if (it->type == Gui::AbookAddressbook::Name || it->type == Gui::AbookAddressbook::Photo)\n                continue;\n            item->setData( \"[\" + it->key + \"]\", it->type );\n        }\n        if (m_currentContact)\n            m_abook->model()->insertRow(m_currentContact->index().row() + 1, item);\n        else\n            m_abook->model()->appendRow(item);\n        m_ui->contacts->setCurrentIndex(m_sortFilterProxy->mapFromSource(item->index()));\n    }\n    \n    void BE::Contacts::removeCurrentContact()\n    {\n        m_dirty = true;\n        if (m_currentContact) {\n            QModelIndex idx = m_sortFilterProxy->mapFromSource(m_currentContact->index());\n            delete m_currentContact;\n            m_currentContact = 0;\n            m_sortFilterProxy->removeRow(idx.row());\n        }\n    }\n    \n    void BE::Contacts::setContact(const QModelIndex &index)\n    {\n        QModelIndex translated = index;\n        if (index.model() == m_sortFilterProxy)\n            translated = m_sortFilterProxy->mapToSource(index);\n    \n        if (m_currentContact) {\n            if (m_abook->model()->itemFromIndex(translated) == m_currentContact)\n                return; // same one\n            for (QList<Field>::const_iterator   it = fields.constBegin(),\n                                                end = fields.constEnd(); it != end; ++it) {\n                if (it->type != Gui::AbookAddressbook::Photo) {\n                    QString s = lifeText(it->label);\n                    if (s.startsWith(\"[\"))\n                        s.clear();\n                    if (m_currentContact->data(it->type).toString() != s) {\n                        m_currentContact->setData( true, Gui::AbookAddressbook::Dirty );\n                        if (s.isEmpty())\n                            m_currentContact->setData( QVariant(), it->type ); // invalidate\n                        else\n                            m_currentContact->setData( s, it->type );\n                        m_dirty = true;\n                    }\n                }\n            }\n        }\n    \n        m_currentContact = m_abook->model()->itemFromIndex(translated);\n        if (!m_currentContact)\n            return;\n    \n        for (QList<Field>::const_iterator   it = fields.constBegin(),\n            end = fields.constEnd(); it != end; ++it) {\n            if (it->type != Gui::AbookAddressbook::Photo) {\n                QString s;\n                QVariant v = m_currentContact->data(it->type);\n                if (v.isValid())\n                    s = v.toString();\n                else\n                    s = \"[\" + it->key + \"]\";\n                setText(it->label, s);\n            }\n        }\n        QPixmap userPic = m_incognitoPic;\n        QString photo = m_currentContact->data(Gui::AbookAddressbook::Photo).toString();\n        if (!photo.isEmpty()) {\n            if (QDir::isRelativePath(photo))\n                photo = QDir::homePath() + \"/.abook/\" + photo;\n            if (QFile::exists(photo) && setPhoto(photo))\n                return;\n        }\n        m_ui2->photo->setPixmap(userPic);\n    \n        m_ui->contacts->setCurrentIndex(m_sortFilterProxy->mapFromSource(translated));\n    }\n    \n    bool BE::Contacts::setPhoto(const QString &path)\n    {\n        QRect r(0,0,160,160);\n        QImage  img = QImage( path );\n        if (img.isNull())\n            return false;\n        const float f = qMin( float(img.width())/float(r.width()),\n                                float(img.height())/float(r.height()) );\n        r.setSize( r.size()*f );\n        r.moveTopRight( img.rect().topRight() );\n        img = img.copy(r).scaled( QSize(160,160), Qt::KeepAspectRatioByExpanding, Qt::SmoothTransformation);\n    \n        img = img.convertToFormat(QImage::Format_ARGB32);\n    \n    //     if ( !MPC::setting(\"rgbCover\").toBool() )\n        {\n            int r,g,b;\n            palette().color(foregroundRole()).getRgb(&r,&g,&b);\n    \n            int n = img.width() * img.height();\n            const uchar *bits = img.bits();\n            QRgb *pixel = (QRgb*)(const_cast<uchar*>(bits));\n    \n            // this creates a (slightly) translucent monochromactic version of the\n            // image using the foreground color\n            // the gray value is turned into the opacity\n            #define ALPHA qAlpha(pixel[i])\n            #define GRAY qGray(pixel[i])\n            #define OPACITY 224\n            if ( qMax( qMax(r,g), b ) > 128 ) // value > 50%, bright foreground\n                for (int i = 0; i < n; ++i)\n                    pixel[i] = qRgba( r,g,b, ( ALPHA * ( (OPACITY*GRAY) / 255 ) ) / 255 );\n                else // inverse\n                for (int i = 0; i < n; ++i)\n                    pixel[i] = qRgba( r,g,b, ( ALPHA * ( (OPACITY*(255-GRAY)) / 255 ) ) / 255 );\n        }\n    #if 1\n        QPainterPath glasPath;\n        glasPath.moveTo( img.rect().topLeft() );\n        glasPath.lineTo( img.rect().topRight() );\n        glasPath.quadTo( img.rect().center()/2, img.rect().bottomLeft() );\n    \n        QPainter p( &img );\n        p.setRenderHint( QPainter::Antialiasing );\n        p.setPen( Qt::NoPen );\n        p.setBrush( QColor(255,255,255,64) );\n        p.drawPath(glasPath);\n        p.end();\n    #endif\n        m_ui2->photo->setPixmap( QPixmap::fromImage( img ) );\n        return true;\n    }\n    \n    void BE::Contacts::updateFocusPolicy(QWidget *oldFocus, QWidget *newFocus)\n    {\n        bool wasEdit(false), isEdit(false);\n        for (QList<Field>::const_iterator it = fields.constBegin(), end = fields.constEnd(); it != end; ++it) {\n            if (oldFocus == it->label)\n                wasEdit = true;\n            else if (newFocus == it->label)\n                isEdit = true;\n            if (isEdit && wasEdit)\n                break;\n        }\n    \n        if (isEdit == wasEdit)\n            return;\n    \n        Qt::FocusPolicy policy = isEdit ? Qt::StrongFocus : Qt::ClickFocus;\n    \n        for (QList<Field>::const_iterator it = fields.constBegin(), end = fields.constEnd(); it != end; ++it)\n            it->label->setFocusPolicy(policy);\n    \n        m_ui2->photo->setFocusPolicy(Qt::ClickFocus);\n    \n        policy = isEdit ? Qt::ClickFocus : Qt::StrongFocus;\n        m_ui->filter->setFocusPolicy(policy);\n        m_ui->contacts->setFocusPolicy(policy);\n        m_ui->add->setFocusPolicy(policy);\n        m_ui->remove->setFocusPolicy(policy);\n    }\n    \n    void BE::Contacts::manageContact(const QString &mail, const QString &prettyName)\n    {\n        QStandardItemModel *model = m_abook->model();\n        for (int i = 0; i < model->rowCount(); ++i) {\n            QStandardItem *item = model->item(i);\n            if (QString::compare(item->data(Gui::AbookAddressbook::Mail).toString(), mail, Qt::CaseInsensitive) == 0) {\n                setContact(model->index(i, 0));\n                return;\n            }\n        }\n    \n        // no match -> create one\n        addContact();\n        m_ui2->mail->setText(mail);\n        if (!prettyName.isEmpty()) {\n            m_ui2->name->setText(prettyName);\n            m_currentContact->setText(prettyName);\n        } else {\n            m_ui2->name->setText(\"[name]\");\n        }\n    }\n  }\n}"
  },
  {
    "function_name": "eventFilter(Q",
    "container": "::Contacts",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "165-232",
    "snippet": "ol BE::Contacts::eventFilter(QObject *o, QEvent *e)\n{\n    if (o == m_ui->filter) {\n        if (e->type() == QEvent::KeyPress)\n        if (static_cast<QKeyEvent*>(e)->key() == Qt::Key_Down)\n            m_ui->contacts->setFocus();\n        return false;\n    }\n\n    if (o == m_ui->contacts) {\n        if (e->type() == QEvent::KeyPress) {\n            QKeyEvent *ke = static_cast<QKeyEvent*>(e);\n            if (ke->key() == Qt::Key_Up && !m_ui->contacts->currentIndex().row()) {\n            m_ui->filter->setFocus();\n            return true;\n            } else if (ke->key() == Qt::Key_Delete) {\n                removeCurrentContact();\n                return true;\n            }\n        }\n        return false;\n    }\n\n    if (!m_currentContact)\n        return false;\n    switch (e->type()) {\n    case QEvent::DragEnter:\n    case QEvent::DragMove:\n    case QEvent::Drop: {\n        if (o != m_ui2->photo)\n            return false;\n        QDropEvent *de = static_cast<QDropEvent*>(e);\n        if (!de->mimeData())\n            return false;\n        QList<QUrl> urls = de->mimeData()->urls();\n        if (urls.isEmpty())\n            return false;\n        QUrl url = urls.first();\n        if (\n#if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n                url.isLocalFile()\n#else\n                (url.scheme() == QLatin1String(\"file\"))\n#endif\n                && QImageReader(url.path()).canRead()) {\n            if (e->type() == QEvent::Drop)\n                importPhoto(url.path());\n            else\n                de->acceptProposedAction();\n        }\n        return false;\n    }\n    case QEvent::KeyPress: {\n        const int key = static_cast<QKeyEvent*>(e)->key();\n        if (key == Qt::Key_Delete && o == m_ui2->photo) { // reset photo\n            if (m_currentContact)\n                m_currentContact->setData(QString(), Gui::AbookAddressbook::Photo);\n            m_ui2->photo->setPixmap(m_incognitoPic);\n        }\n        else if (key == Qt::Key_Escape && o != m_ui2->photo)\n        if (QLabel *l = qobject_cast<QLabel*>(o)) {\n            setText(l, l->text());\n            return true; // prevent closing the dialog!\n        }\n    }\n    default:\n        return false;\n    }",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tText(l",
          "args": [
            ">text());"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">text",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "bject_cast<QLabel*>",
          "args": [
            ")"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->photo->setPixmap",
          "args": [
            "incognitoPic);"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentContact->setData",
          "args": [
            "tring(),",
            "i::AbookAddressbook::Photo);"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tring()",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atic_cast<QKeyEvent*>",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atic_cast<QKeyEvent*>",
          "args": [
            "-"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "portPhoto(u",
          "args": [
            "l.path());"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l.path",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "{\n            if",
          "args": [
            ">type() == QEvent::Drop)"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">type",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mageReader",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mageReader(u",
          "args": [
            "l.path())."
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l.path",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lse",
          "args": [
            "l.scheme() == QLatin1String(\"file\"))"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atin1String(\"",
          "args": [
            "ile\"))"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l.scheme",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "l.isLocalFile",
          "args": [],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_VERSION_CHECK(4",
          "args": [],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ls.first",
          "args": [],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "first",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "293-316",
          "snippet": "bool XSqlQuery::first()\n{\n  if (QSqlQuery::first())\n  {\n    if (_data)\n    {\n      if (_data->_keepTotals)\n      {\n        // initial all our values\n        resetSubTotals();\n        QMapIterator<QString,double> mit(_data->_fieldTotals);\n        while(mit.hasNext())\n        {\n          mit.next();\n          _data->_fieldTotals[mit.key()] = value(mit.key()).toDouble();\n          _data->_fieldSubTotals[mit.key()] = value(mit.key()).toDouble();\n        }\n      }\n      _data->_currRecord = record();\n    }\n    return true;\n  }\n  return false;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::first()\n  {\n    if (QSqlQuery::first())\n    {\n      if (_data)\n      {\n        if (_data->_keepTotals)\n        {\n          // initial all our values\n          resetSubTotals();\n          QMapIterator<QString,double> mit(_data->_fieldTotals);\n          while(mit.hasNext())\n          {\n            mit.next();\n            _data->_fieldTotals[mit.key()] = value(mit.key()).toDouble();\n            _data->_fieldSubTotals[mit.key()] = value(mit.key()).toDouble();\n          }\n        }\n        _data->_currRecord = record();\n      }\n      return true;\n    }\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ls.isEmpty",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mimeData",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mimeData",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->mimeData",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atic_cast<QDropEvent*>",
          "args": [
            ";"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">type",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "moveCurrentContact()",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->key",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->filter->setFocus",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->currentIndex",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->currentIndex",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->key",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atic_cast<QKeyEvent*>",
          "args": [
            ";"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">type",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->setFocus",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atic_cast<QKeyEvent*>",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "atic_cast<QKeyEvent*>",
          "args": [
            "-"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">type",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\n {\n  Contacts {\n    ol BE::Contacts::eventFilter(QObject *o, QEvent *e)\n    {\n        if (o == m_ui->filter) {\n            if (e->type() == QEvent::KeyPress)\n            if (static_cast<QKeyEvent*>(e)->key() == Qt::Key_Down)\n                m_ui->contacts->setFocus();\n            return false;\n        }\n    \n        if (o == m_ui->contacts) {\n            if (e->type() == QEvent::KeyPress) {\n                QKeyEvent *ke = static_cast<QKeyEvent*>(e);\n                if (ke->key() == Qt::Key_Up && !m_ui->contacts->currentIndex().row()) {\n                m_ui->filter->setFocus();\n                return true;\n                } else if (ke->key() == Qt::Key_Delete) {\n                    removeCurrentContact();\n                    return true;\n                }\n            }\n            return false;\n        }\n    \n        if (!m_currentContact)\n            return false;\n        switch (e->type()) {\n        case QEvent::DragEnter:\n        case QEvent::DragMove:\n        case QEvent::Drop: {\n            if (o != m_ui2->photo)\n                return false;\n            QDropEvent *de = static_cast<QDropEvent*>(e);\n            if (!de->mimeData())\n                return false;\n            QList<QUrl> urls = de->mimeData()->urls();\n            if (urls.isEmpty())\n                return false;\n            QUrl url = urls.first();\n            if (\n    #if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n                    url.isLocalFile()\n    #else\n                    (url.scheme() == QLatin1String(\"file\"))\n    #endif\n                    && QImageReader(url.path()).canRead()) {\n                if (e->type() == QEvent::Drop)\n                    importPhoto(url.path());\n                else\n                    de->acceptProposedAction();\n            }\n            return false;\n        }\n        case QEvent::KeyPress: {\n            const int key = static_cast<QKeyEvent*>(e)->key();\n            if (key == Qt::Key_Delete && o == m_ui2->photo) { // reset photo\n                if (m_currentContact)\n                    m_currentContact->setData(QString(), Gui::AbookAddressbook::Photo);\n                m_ui2->photo->setPixmap(m_incognitoPic);\n            }\n            else if (key == Qt::Key_Escape && o != m_ui2->photo)\n            if (QLabel *l = qobject_cast<QLabel*>(o)) {\n                setText(l, l->text());\n                return true; // prevent closing the dialog!\n            }\n        }\n        default:\n            return false;\n        }\n  }\n}"
  },
  {
    "function_name": "tText(Q",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "157-163",
    "snippet": "atic void setText(QLabel *l, const QString &text)\n{\n    if (QTextDocument *t = l->findChild<QTextDocument*>())\n        t->setPlainText(text);\n    l->setText(\"\");\n    l->setText(text);\n}",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": ">setText",
          "args": [
            "xt);"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">setText",
          "args": [
            ");"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">setPlainText",
          "args": [
            "xt);"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">findChild<QTextDocument*>",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\natic void setText(QLabel *l, const QString &text)\n{\n    if (QTextDocument *t = l->findChild<QTextDocument*>())\n        t->setPlainText(text);\n    l->setText(\"\");\n    l->setText(text);\n}"
  },
  {
    "function_name": "feText(c",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "150-155",
    "snippet": "atic QString lifeText(const QLabel *l)\n{\n    if (QTextDocument *t = l->findChild<QTextDocument*>())\n        return t->toPlainText();\n    return l->text();\n}",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": ">text",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">toPlainText",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ">findChild<QTextDocument*>",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\natic QString lifeText(const QLabel *l)\n{\n    if (QTextDocument *t = l->findChild<QTextDocument*>())\n        return t->toPlainText();\n    return l->text();\n}"
  },
  {
    "function_name": "saveContacts()",
    "container": "::Contacts",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "144-148",
    "snippet": "id BE::Contacts::saveContacts()\n{\n    setContact(QModelIndex()); // store current contact changes\n    m_abook->saveContacts();\n}",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abook->saveContacts",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tContact(Q",
          "args": [
            "odelIndex());"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "odelIndex()",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\n {\n  Contacts {\n    id BE::Contacts::saveContacts()\n    {\n        setContact(QModelIndex()); // store current contact changes\n        m_abook->saveContacts();\n    }\n  }\n}"
  },
  {
    "function_name": "closeEvent(Q",
    "container": "::Contacts",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "132-142",
    "snippet": "id BE::Contacts::closeEvent(QCloseEvent *)\n{\n    if (m_dirty) {\n        if (QMessageBox::question(this, tr(\"Contacts\"), tr(\"Save changes?\"), QMessageBox::Yes | QMessageBox::No) == QMessageBox::Yes) {\n            saveContacts();\n        } else {\n            m_abook->model()->removeRows(0, m_abook->model()->rowCount());\n            m_abook->readAbook(false);\n        }\n    }\n}",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abook->readAbook",
          "args": [
            "lse);"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [
            "abook->model()->rowCount());"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "veContacts()",
          "args": [],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "saveContacts()",
          "container": "::Contacts",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
          "lines": "144-148",
          "snippet": "id BE::Contacts::saveContacts()\n{\n    setContact(QModelIndex()); // store current contact changes\n    m_abook->saveContacts();\n}",
          "includes": [
            "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
            "nclude \"ui_onecontact.h\"\n#i",
            "nclude \"ui_be-contacts.h\"\n#i",
            "nclude \"be-contacts.h\"\n#i",
            "nclude <QtDebug>\n\n#",
            "nclude <QUrl>\n\n#",
            "nclude <QTimer>\n#i",
            "nclude <QTextDocument>\n#i",
            "nclude <QStandardItemModel>\n#i",
            "nclude <QSortFilterProxyModel>\n#i",
            "nclude <QSettings>\n#i",
            "nclude <QPainterPath>\n#i",
            "nclude <QPainter>\n#i",
            "nclude <QMimeData>\n#i",
            "nclude <QMetaProperty>\n#i",
            "nclude <QMessageBox>\n#i",
            "nclude <QKeyEvent>\n#i",
            "nclude <QImageReader>\n#i",
            "nclude <QFileSystemWatcher>\n#i",
            "nclude <QFileInfo>\n#i",
            "nclude <QDropEvent>\n#i",
            "nclude <QDir>\n#i",
            "nclude <QDateTime>\n#i"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\n {\n  Contacts {\n    id BE::Contacts::saveContacts()\n    {\n        setContact(QModelIndex()); // store current contact changes\n        m_abook->saveContacts();\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essageBox::question(t",
          "args": [
            "is,",
            "(\"Contacts\"),",
            "(\"Save changes?\"),",
            "essageBox::Yes | QMessageBox::No)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(\"",
          "args": [
            "ave changes?\"),"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(\"",
          "args": [
            "ontacts\"),"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\n {\n  Contacts {\n    id BE::Contacts::closeEvent(QCloseEvent *)\n    {\n        if (m_dirty) {\n            if (QMessageBox::question(this, tr(\"Contacts\"), tr(\"Save changes?\"), QMessageBox::Yes | QMessageBox::No) == QMessageBox::Yes) {\n                saveContacts();\n            } else {\n                m_abook->model()->removeRows(0, m_abook->model()->rowCount());\n                m_abook->readAbook(false);\n            }\n        }\n    }\n  }\n}"
  },
  {
    "function_name": "~Contacts()",
    "container": "::Contacts",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "128-130",
    "snippet": "::Contacts::~Contacts()\n{\n}",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\n {\n  Contacts {\n    ::Contacts::~Contacts()\n    {\n    }\n  }\n}"
  },
  {
    "function_name": "Contacts(G",
    "container": "::Contacts",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "74-126",
    "snippet": "::Contacts::Contacts(Gui::AbookAddressbook *abook): m_abook(abook), m_dirty(false)\n{\n    m_currentContact = 0;\n    QImage img(QDir::homePath() + \"/.abook/incognito.png\");\n    if (!img.isNull())\n        m_incognitoPic = QPixmap::fromImage(img.scaled(160,160,Qt::KeepAspectRatio,Qt::SmoothTransformation));\n    m_ui = new Ui::Contacts;\n    m_ui->setupUi(this);\n#if QT_VERSION >= 0x040700\n    m_ui->filter->setPlaceholderText(tr(\"Filter\"));\n#endif\n    m_ui2 = new Ui::OneContact;\n    m_ui2->setupUi(m_ui->oneContact);\n\n    fields <<   Field(Gui::AbookAddressbook::Name, m_ui2->name, \"name\") << Field(Gui::AbookAddressbook::Mail, m_ui2->mail, \"email\") <<\n                Field(Gui::AbookAddressbook::Address, m_ui2->address, \"address\") << Field(Gui::AbookAddressbook::City, m_ui2->city, \"city\") <<\n                Field(Gui::AbookAddressbook::State, m_ui2->state, \"state\") << Field(Gui::AbookAddressbook::ZIP, m_ui2->zip, \"zip\") <<\n                Field(Gui::AbookAddressbook::Country, m_ui2->country, \"country\") << Field(Gui::AbookAddressbook::Phone, m_ui2->phone, \"phone\") <<\n                Field(Gui::AbookAddressbook::Workphone, m_ui2->workphone, \"workphone\") << Field(Gui::AbookAddressbook::Fax, m_ui2->fax, \"fax\") <<\n                Field(Gui::AbookAddressbook::Mobile, m_ui2->mobile, \"mobile\") << Field(Gui::AbookAddressbook::Nick, m_ui2->nick, \"nick\") <<\n                Field(Gui::AbookAddressbook::URL, m_ui2->url, \"url\") << Field(Gui::AbookAddressbook::Notes, m_ui2->notes, \"notes\") <<\n                Field(Gui::AbookAddressbook::Anniversary, m_ui2->anniversary, \"anniversary\") << Field(Gui::AbookAddressbook::Photo, m_ui2->photo, \"photo\");\n\n    m_sortFilterProxy = new QSortFilterProxyModel(this);\n    m_sortFilterProxy->setFilterCaseSensitivity(Qt::CaseInsensitive);\n    m_sortFilterProxy->setFilterKeyColumn(-1);\n    m_sortFilterProxy->setSourceModel(m_abook->model());\n    connect (m_ui->filter, SIGNAL(textChanged(QString)), m_sortFilterProxy, SLOT(setFilterWildcard(QString)));\n    m_ui->filter->installEventFilter(this);\n\n    QFont fnt = m_ui2->name->font();\n    fnt.setPointSize(fnt.pointSize()*2);\n    m_ui2->name->setFont(fnt);\n    for (QList<Field>::const_iterator   it = fields.constBegin(),\n                                        end = fields.constEnd(); it != end; ++it) {\n        it->label->installEventFilter(this);\n    }\n\n    m_ui->contacts->setModel(m_sortFilterProxy);\n    m_ui->contacts->setSelectionMode(QAbstractItemView::SingleSelection);\n    connect (m_ui->contacts->selectionModel(), SIGNAL(currentChanged(QModelIndex,QModelIndex)), SLOT(setContact(QModelIndex)));\n    QModelIndex idx = m_sortFilterProxy->index(0,0);\n    if (idx.isValid())\n        m_ui->contacts->setCurrentIndex(idx);\n    m_ui->contacts->installEventFilter(this);\n\n    connect (m_ui->add, SIGNAL(clicked()), SLOT(addContact()));\n    connect (m_ui->remove, SIGNAL(clicked()), SLOT(removeCurrentContact()));\n    connect (qApp, SIGNAL(focusChanged(QWidget*, QWidget*)), SLOT(updateFocusPolicy(QWidget*, QWidget*)));\n\n    // cheat to correct the focuspolicies ;-)\n    updateFocusPolicy(m_ui2->name, m_ui->filter);\n}",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dateFocusPolicy(m",
          "args": [
            "ui2->name,",
            "ui->filter);"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nnect (",
          "args": [
            "ui->remove,",
            "GNAL(clicked()),",
            "OT(removeCurrentContact()));"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OT(r",
          "args": [
            "moveCurrentContact()))"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "moveCurrentContact()",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNAL(c",
          "args": [
            "icked()),"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "icked()",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "deleteButtonClicked()",
          "container": "eralPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SettingsDialog.cpp",
          "lines": "225-240",
          "snippet": "d GeneralPage::deleteButtonClicked()\n{\n    Q_ASSERT(identityTabelView->currentIndex().isValid());\n    QMessageBox::StandardButton answer =\n            QMessageBox::question(this, tr(\"Delete Identity?\"),\n                                  tr(\"Are you sure you want to delete identity %1 <%2>?\").arg(\n                                      m_identitiesModel->index(identityTabelView->currentIndex().row(),\n                                                               Composer::SenderIdentitiesModel::COLUMN_NAME).data().toString(),\n                                      m_identitiesModel->index(identityTabelView->currentIndex().row(),\n                                                               Composer::SenderIdentitiesModel::COLUMN_EMAIL).data().toString()),\n                                  QMessageBox::Yes | QMessageBox::No);\n    if (answer == QMessageBox::Yes) {\n        m_identitiesModel->removeIdentityAt(identityTabelView->currentIndex().row());\n        updateWidgets();\n    }\n}\n\nv",
          "includes": [
            "include \"Gui/Util.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include <QDataWidgetMapper>\n#",
            "include <QMessageBox>\n#",
            "include <QToolTip>\n#",
            "include <QStandardItemModel>\n#",
            "include <QDebug>\n#",
            "include <QResizeEvent>\n#",
            "include <QPushButton>\n#",
            "include <QProcess>\n#",
            "include <QVBoxLayout>\n#",
            "include <QTabWidget>\n#",
            "include <QSpinBox>\n#",
            "include <QRadioButton>\n#",
            "include <QListWidget>\n#",
            "include <QLineEdit>\n#",
            "include <QInputDialog>\n#",
            "include <QGroupBox>\n#",
            "include <QFormLayout>\n#",
            "include <QDir>\n#",
            "include <QDialogButtonBox>\n#",
            "include <QComboBox>\n#",
            "include <QCheckBox>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Gui/Util.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude <QDataWidgetMapper>\n#\ninclude <QMessageBox>\n#\ninclude <QToolTip>\n#\ninclude <QStandardItemModel>\n#\ninclude <QDebug>\n#\ninclude <QResizeEvent>\n#\ninclude <QPushButton>\n#\ninclude <QProcess>\n#\ninclude <QVBoxLayout>\n#\ninclude <QTabWidget>\n#\ninclude <QSpinBox>\n#\ninclude <QRadioButton>\n#\ninclude <QListWidget>\n#\ninclude <QLineEdit>\n#\ninclude <QInputDialog>\n#\ninclude <QGroupBox>\n#\ninclude <QFormLayout>\n#\ninclude <QDir>\n#\ninclude <QDialogButtonBox>\n#\ninclude <QComboBox>\n#\ninclude <QCheckBox>\n#\n\neralPage {\n  d GeneralPage::deleteButtonClicked()\n  {\n      Q_ASSERT(identityTabelView->currentIndex().isValid());\n      QMessageBox::StandardButton answer =\n              QMessageBox::question(this, tr(\"Delete Identity?\"),\n                                    tr(\"Are you sure you want to delete identity %1 <%2>?\").arg(\n                                        m_identitiesModel->index(identityTabelView->currentIndex().row(),\n                                                                 Composer::SenderIdentitiesModel::COLUMN_NAME).data().toString(),\n                                        m_identitiesModel->index(identityTabelView->currentIndex().row(),\n                                                                 Composer::SenderIdentitiesModel::COLUMN_EMAIL).data().toString()),\n                                    QMessageBox::Yes | QMessageBox::No);\n      if (answer == QMessageBox::Yes) {\n          m_identitiesModel->removeIdentityAt(identityTabelView->currentIndex().row());\n          updateWidgets();\n      }\n  }\n  \n  v\n}"
        }
      },
      {
        "call_info": {
          "callee": "nnect (",
          "args": [
            "ui->add,",
            "GNAL(clicked()),",
            "OT(addContact()));"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OT(a",
          "args": [
            "dContact()))"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dContact()",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNAL(c",
          "args": [
            "icked()),"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->installEventFilter",
          "args": [
            "is);"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->setCurrentIndex",
          "args": [
            "x);"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "x.isValid",
          "args": [],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->index",
          "args": [
            "0",
            ";"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nnect (",
          "args": [
            "ui->contacts->selectionModel(),",
            "GNAL(currentChanged(QModelIndex,QModelIndex)),",
            "OT(setContact(QModelIndex)));"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OT(s",
          "args": [
            "tContact(QModelIndex)))"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tContact(Q",
          "args": [
            "odelIndex))"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNAL(c",
          "args": [
            "rrentChanged(QModelIndex,QModelIndex)),"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rrentChanged(Q",
          "args": [
            "odelIndex,Q",
            "odelIndex))"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->selectionModel",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->setSelectionMode",
          "args": [
            "bstractItemView::SingleSelection);"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->contacts->setModel",
          "args": [
            "sortFilterProxy);"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->label->installEventFilter",
          "args": [
            "is);"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constEnd",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "elds.constBegin",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->name->setFont",
          "args": [
            "t);"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t.setPointSize",
          "args": [
            "t.pointSize()*2);"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t.pointSize",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->name->font",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->filter->installEventFilter",
          "args": [
            "is);"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nnect (",
          "args": [
            "ui->filter,",
            "GNAL(textChanged(QString)),",
            "sortFilterProxy,",
            "OT(setFilterWildcard(QString)));"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OT(s",
          "args": [
            "tFilterWildcard(QString)))"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tFilterWildcard(Q",
          "args": [
            "tring))"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GNAL(t",
          "args": [
            "xtChanged(QString)),"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xtChanged(Q",
          "args": [
            "tring))"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->setSourceModel",
          "args": [
            "abook->model());"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "abook->model",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->setFilterKeyColumn",
          "args": [
            ");"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sortFilterProxy->setFilterCaseSensitivity",
          "args": [
            "::CaseInsensitive);"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Photo,",
            "ui2->photo,",
            "hoto\");"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Anniversary,",
            "ui2->anniversary,",
            "nniversary\")"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Notes,",
            "ui2->notes,",
            "otes\")"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::URL,",
            "ui2->url,",
            "rl\")"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Nick,",
            "ui2->nick,",
            "ick\")"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Mobile,",
            "ui2->mobile,",
            "obile\")"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Fax,",
            "ui2->fax,",
            "ax\")"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Workphone,",
            "ui2->workphone,",
            "orkphone\")"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Phone,",
            "ui2->phone,",
            "hone\")"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Country,",
            "ui2->country,",
            "ountry\")"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::ZIP,",
            "ui2->zip,",
            "ip\")"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::State,",
            "ui2->state,",
            "tate\")"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::City,",
            "ui2->city,",
            "ity\")"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Address,",
            "ui2->address,",
            "ddress\")"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Mail,",
            "ui2->mail,",
            "mail\")"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eld(G",
          "args": [
            "i::AbookAddressbook::Name,",
            "ui2->name,",
            "ame\")"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui2->setupUi",
          "args": [
            "ui->oneContact);"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->filter->setPlaceholderText",
          "args": [
            "(\"Filter\"));"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "(\"",
          "args": [
            "ilter\"))"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "is);"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ixmap::fromImage(i",
          "args": [
            "g.scaled(160,160,Qt::KeepAspectRatio,Qt::SmoothTransformation));"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.scaled",
          "args": [
            "0,1",
            "0,Q",
            "::KeepAspectRatio,Q",
            "::SmoothTransformation))"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.isNull",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ir::homePath()",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\n {\n  Contacts {\n    ::Contacts::Contacts(Gui::AbookAddressbook *abook): m_abook(abook), m_dirty(false)\n    {\n        m_currentContact = 0;\n        QImage img(QDir::homePath() + \"/.abook/incognito.png\");\n        if (!img.isNull())\n            m_incognitoPic = QPixmap::fromImage(img.scaled(160,160,Qt::KeepAspectRatio,Qt::SmoothTransformation));\n        m_ui = new Ui::Contacts;\n        m_ui->setupUi(this);\n    #if QT_VERSION >= 0x040700\n        m_ui->filter->setPlaceholderText(tr(\"Filter\"));\n    #endif\n        m_ui2 = new Ui::OneContact;\n        m_ui2->setupUi(m_ui->oneContact);\n    \n        fields <<   Field(Gui::AbookAddressbook::Name, m_ui2->name, \"name\") << Field(Gui::AbookAddressbook::Mail, m_ui2->mail, \"email\") <<\n                    Field(Gui::AbookAddressbook::Address, m_ui2->address, \"address\") << Field(Gui::AbookAddressbook::City, m_ui2->city, \"city\") <<\n                    Field(Gui::AbookAddressbook::State, m_ui2->state, \"state\") << Field(Gui::AbookAddressbook::ZIP, m_ui2->zip, \"zip\") <<\n                    Field(Gui::AbookAddressbook::Country, m_ui2->country, \"country\") << Field(Gui::AbookAddressbook::Phone, m_ui2->phone, \"phone\") <<\n                    Field(Gui::AbookAddressbook::Workphone, m_ui2->workphone, \"workphone\") << Field(Gui::AbookAddressbook::Fax, m_ui2->fax, \"fax\") <<\n                    Field(Gui::AbookAddressbook::Mobile, m_ui2->mobile, \"mobile\") << Field(Gui::AbookAddressbook::Nick, m_ui2->nick, \"nick\") <<\n                    Field(Gui::AbookAddressbook::URL, m_ui2->url, \"url\") << Field(Gui::AbookAddressbook::Notes, m_ui2->notes, \"notes\") <<\n                    Field(Gui::AbookAddressbook::Anniversary, m_ui2->anniversary, \"anniversary\") << Field(Gui::AbookAddressbook::Photo, m_ui2->photo, \"photo\");\n    \n        m_sortFilterProxy = new QSortFilterProxyModel(this);\n        m_sortFilterProxy->setFilterCaseSensitivity(Qt::CaseInsensitive);\n        m_sortFilterProxy->setFilterKeyColumn(-1);\n        m_sortFilterProxy->setSourceModel(m_abook->model());\n        connect (m_ui->filter, SIGNAL(textChanged(QString)), m_sortFilterProxy, SLOT(setFilterWildcard(QString)));\n        m_ui->filter->installEventFilter(this);\n    \n        QFont fnt = m_ui2->name->font();\n        fnt.setPointSize(fnt.pointSize()*2);\n        m_ui2->name->setFont(fnt);\n        for (QList<Field>::const_iterator   it = fields.constBegin(),\n                                            end = fields.constEnd(); it != end; ++it) {\n            it->label->installEventFilter(this);\n        }\n    \n        m_ui->contacts->setModel(m_sortFilterProxy);\n        m_ui->contacts->setSelectionMode(QAbstractItemView::SingleSelection);\n        connect (m_ui->contacts->selectionModel(), SIGNAL(currentChanged(QModelIndex,QModelIndex)), SLOT(setContact(QModelIndex)));\n        QModelIndex idx = m_sortFilterProxy->index(0,0);\n        if (idx.isValid())\n            m_ui->contacts->setCurrentIndex(idx);\n        m_ui->contacts->installEventFilter(this);\n    \n        connect (m_ui->add, SIGNAL(clicked()), SLOT(addContact()));\n        connect (m_ui->remove, SIGNAL(clicked()), SLOT(removeCurrentContact()));\n        connect (qApp, SIGNAL(focusChanged(QWidget*, QWidget*)), SLOT(updateFocusPolicy(QWidget*, QWidget*)));\n    \n        // cheat to correct the focuspolicies ;-)\n        updateFocusPolicy(m_ui2->name, m_ui->filter);\n    }\n  }\n}"
  },
  {
    "function_name": "eld(c",
    "container": "eld {",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "62-67",
    "snippet": "eld(const Field &other)\n    {\n        this->type = other.type;\n        this->label = other.label;\n        this->key = other.key;\n    }",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\neld { {\n  eld(const Field &other)\n      {\n          this->type = other.type;\n          this->label = other.label;\n          this->key = other.key;\n      }\n}"
  },
  {
    "function_name": "eld(T",
    "container": "eld {",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/AbookAddressbook/be-contacts.cpp",
    "lines": "56-61",
    "snippet": "eld(Type type, QLabel *label, QString key)\n    {\n        this->type = type;\n        this->label = label;\n        this->key = key;\n    }",
    "includes": [
      "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn",
      "nclude \"ui_onecontact.h\"\n#i",
      "nclude \"ui_be-contacts.h\"\n#i",
      "nclude \"be-contacts.h\"\n#i",
      "nclude <QtDebug>\n\n#",
      "nclude <QUrl>\n\n#",
      "nclude <QTimer>\n#i",
      "nclude <QTextDocument>\n#i",
      "nclude <QStandardItemModel>\n#i",
      "nclude <QSortFilterProxyModel>\n#i",
      "nclude <QSettings>\n#i",
      "nclude <QPainterPath>\n#i",
      "nclude <QPainter>\n#i",
      "nclude <QMimeData>\n#i",
      "nclude <QMetaProperty>\n#i",
      "nclude <QMessageBox>\n#i",
      "nclude <QKeyEvent>\n#i",
      "nclude <QImageReader>\n#i",
      "nclude <QFileSystemWatcher>\n#i",
      "nclude <QFileInfo>\n#i",
      "nclude <QDropEvent>\n#i",
      "nclude <QDir>\n#i",
      "nclude <QDateTime>\n#i"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "nclude \"AbookAddressbook/AbookAddressbook.h\"\n\nn\nnclude \"ui_onecontact.h\"\n#i\nnclude \"ui_be-contacts.h\"\n#i\nnclude \"be-contacts.h\"\n#i\nnclude <QtDebug>\n\n#\nnclude <QUrl>\n\n#\nnclude <QTimer>\n#i\nnclude <QTextDocument>\n#i\nnclude <QStandardItemModel>\n#i\nnclude <QSortFilterProxyModel>\n#i\nnclude <QSettings>\n#i\nnclude <QPainterPath>\n#i\nnclude <QPainter>\n#i\nnclude <QMimeData>\n#i\nnclude <QMetaProperty>\n#i\nnclude <QMessageBox>\n#i\nnclude <QKeyEvent>\n#i\nnclude <QImageReader>\n#i\nnclude <QFileSystemWatcher>\n#i\nnclude <QFileInfo>\n#i\nnclude <QDropEvent>\n#i\nnclude <QDir>\n#i\nnclude <QDateTime>\n#i\n\neld { {\n  eld(Type type, QLabel *label, QString key)\n      {\n          this->type = type;\n          this->label = label;\n          this->key = key;\n      }\n}"
  }
]