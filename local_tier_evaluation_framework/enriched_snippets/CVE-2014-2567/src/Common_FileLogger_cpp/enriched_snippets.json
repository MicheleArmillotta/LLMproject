[
  {
    "function_name": "setConsoleLogging(",
    "container": "ileLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
    "lines": "141-144",
    "snippet": "oid FileLogger::setConsoleLogging(const bool enabled)\n{\n    m_consoleLog = enabled;\n}",
    "includes": [
      "include \"../Imap/Model/Utils.h\"",
      "include \"FileLogger.h\"\n#",
      "include <QTextStream>\n#",
      "include <QFile>\n#",
      "include <QDebug>\n#",
      "include <QDateTime>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  oid FileLogger::setConsoleLogging(const bool enabled)\n  {\n      m_consoleLog = enabled;\n  }\n}"
  },
  {
    "function_name": "setAutoFlush(",
    "container": "ileLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
    "lines": "134-139",
    "snippet": "oid FileLogger::setAutoFlush(const bool autoFlush)\n{\n    m_autoFlush = autoFlush;\n    if (m_autoFlush && m_fileLog)\n        m_fileLog->flush();\n}",
    "includes": [
      "include \"../Imap/Model/Utils.h\"",
      "include \"FileLogger.h\"\n#",
      "include <QTextStream>\n#",
      "include <QFile>\n#",
      "include <QDebug>\n#",
      "include <QDateTime>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_fileLog->flush",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  oid FileLogger::setAutoFlush(const bool autoFlush)\n  {\n      m_autoFlush = autoFlush;\n      if (m_autoFlush && m_fileLog)\n          m_fileLog->flush();\n  }\n}"
  },
  {
    "function_name": "formatMessage(",
    "container": "ileLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
    "lines": "95-127",
    "snippet": "String FileLogger::formatMessage(uint parser, const Common::LogMessage &message) const\n{\n    using namespace Common;\n    QString direction;\n    switch (message.kind) {\n    case LOG_IO_READ:\n        direction = QLatin1String(\" <<< \");\n        break;\n    case LOG_IO_WRITTEN:\n        direction = QLatin1String(\" >>> \");\n        break;\n    case LOG_PARSE_ERROR:\n        direction = QLatin1String(\" [err] \");\n        break;\n    case LOG_MAILBOX_SYNC:\n        direction = QLatin1String(\" [sync] \");\n        break;\n    case LOG_TASKS:\n        direction = QLatin1String(\" [task] \");\n        break;\n    case LOG_MESSAGES:\n        direction = QLatin1String(\" [msg] \");\n        break;\n    case LOG_OTHER:\n        direction = QLatin1String(\" \");\n        break;\n    }\n    if (message.truncatedBytes) {\n        direction += QLatin1String(\"[truncated] \");\n    }\n    return message.timestamp.toString(QLatin1String(\"hh:mm:ss.zzz\")) + QString::number(parser) + QLatin1Char(' ') +\n            direction + message.source + QLatin1Char(' ') + message.message.trimmed();\n}",
    "includes": [
      "include \"../Imap/Model/Utils.h\"",
      "include \"FileLogger.h\"\n#",
      "include <QTextStream>\n#",
      "include <QFile>\n#",
      "include <QDebug>\n#",
      "include <QDateTime>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "essage.message.trimmed",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "')"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "')"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::number(",
          "args": [
            "arser)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.timestamp.toString",
          "args": [
            "Latin1String(\"hh:mm:ss.zzz\"))"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "hh:mm:ss.zzz\")"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "[truncated] \")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "\")"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "[msg] \")"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "[task] \")"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "[sync] \")"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "[err] \")"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ">>> \")"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "<<< \")"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  String FileLogger::formatMessage(uint parser, const Common::LogMessage &message) const\n  {\n      using namespace Common;\n      QString direction;\n      switch (message.kind) {\n      case LOG_IO_READ:\n          direction = QLatin1String(\" <<< \");\n          break;\n      case LOG_IO_WRITTEN:\n          direction = QLatin1String(\" >>> \");\n          break;\n      case LOG_PARSE_ERROR:\n          direction = QLatin1String(\" [err] \");\n          break;\n      case LOG_MAILBOX_SYNC:\n          direction = QLatin1String(\" [sync] \");\n          break;\n      case LOG_TASKS:\n          direction = QLatin1String(\" [task] \");\n          break;\n      case LOG_MESSAGES:\n          direction = QLatin1String(\" [msg] \");\n          break;\n      case LOG_OTHER:\n          direction = QLatin1String(\" \");\n          break;\n      }\n      if (message.truncatedBytes) {\n          direction += QLatin1String(\"[truncated] \");\n      }\n      return message.timestamp.toString(QLatin1String(\"hh:mm:ss.zzz\")) + QString::number(parser) + QLatin1Char(' ') +\n              direction + message.source + QLatin1Char(' ') + message.message.trimmed();\n  }\n}"
  },
  {
    "function_name": "slotImapLogged(",
    "container": "ileLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
    "lines": "68-93",
    "snippet": "oid FileLogger::slotImapLogged(uint parser, Common::LogMessage message)\n{\n    if (!m_fileLog && !m_consoleLog)\n        return;\n\n    QString formatted = formatMessage(parser, message);\n    escapeCrLf(formatted);\n\n    if (m_fileLog) {\n        *m_fileLog << formatted << \"\\n\";\n        if (m_autoFlush)\n            m_fileLog->flush();\n    }\n\n    enum {CUTOFF=200};\n    if (m_consoleLog) {\n        if (message.message.size() > CUTOFF) {\n            // Got to reformat the message\n            message.truncatedBytes = message.message.size() - CUTOFF;\n            message.message = message.message.left(CUTOFF);\n            formatted = formatMessage(parser, message);\n            escapeCrLf(formatted);\n        }\n        qDebug() << formatted.toUtf8().constData() << \"\\n\";\n    }\n}",
    "includes": [
      "include \"../Imap/Model/Utils.h\"",
      "include \"FileLogger.h\"\n#",
      "include <QTextStream>\n#",
      "include <QFile>\n#",
      "include <QDebug>\n#",
      "include <QDateTime>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ormatted.toUtf8",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ormatted.toUtf8",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scapeCrLf(",
          "args": [
            "ormatted)"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "escapeCrLf(",
          "container": "ileLogger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
          "lines": "62-66",
          "snippet": "oid FileLogger::escapeCrLf(QString &s)\n{\n    s.replace(QChar('\\r'), 0x240d /* SYMBOL FOR CARRIAGE RETURN */)\n            .replace(QChar('\\n'), 0x240a /* SYMBOL FOR LINE FEED */);\n}",
          "includes": [
            "include \"../Imap/Model/Utils.h\"",
            "include \"FileLogger.h\"\n#",
            "include <QTextStream>\n#",
            "include <QFile>\n#",
            "include <QDebug>\n#",
            "include <QDateTime>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  oid FileLogger::escapeCrLf(QString &s)\n  {\n      s.replace(QChar('\\r'), 0x240d /* SYMBOL FOR CARRIAGE RETURN */)\n              .replace(QChar('\\n'), 0x240a /* SYMBOL FOR LINE FEED */);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ormatMessage(",
          "args": [
            "arser,",
            "essage)"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "formatMessage(",
          "container": "ileLogger",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
          "lines": "95-127",
          "snippet": "String FileLogger::formatMessage(uint parser, const Common::LogMessage &message) const\n{\n    using namespace Common;\n    QString direction;\n    switch (message.kind) {\n    case LOG_IO_READ:\n        direction = QLatin1String(\" <<< \");\n        break;\n    case LOG_IO_WRITTEN:\n        direction = QLatin1String(\" >>> \");\n        break;\n    case LOG_PARSE_ERROR:\n        direction = QLatin1String(\" [err] \");\n        break;\n    case LOG_MAILBOX_SYNC:\n        direction = QLatin1String(\" [sync] \");\n        break;\n    case LOG_TASKS:\n        direction = QLatin1String(\" [task] \");\n        break;\n    case LOG_MESSAGES:\n        direction = QLatin1String(\" [msg] \");\n        break;\n    case LOG_OTHER:\n        direction = QLatin1String(\" \");\n        break;\n    }\n    if (message.truncatedBytes) {\n        direction += QLatin1String(\"[truncated] \");\n    }\n    return message.timestamp.toString(QLatin1String(\"hh:mm:ss.zzz\")) + QString::number(parser) + QLatin1Char(' ') +\n            direction + message.source + QLatin1Char(' ') + message.message.trimmed();\n}",
          "includes": [
            "include \"../Imap/Model/Utils.h\"",
            "include \"FileLogger.h\"\n#",
            "include <QTextStream>\n#",
            "include <QFile>\n#",
            "include <QDebug>\n#",
            "include <QDateTime>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  String FileLogger::formatMessage(uint parser, const Common::LogMessage &message) const\n  {\n      using namespace Common;\n      QString direction;\n      switch (message.kind) {\n      case LOG_IO_READ:\n          direction = QLatin1String(\" <<< \");\n          break;\n      case LOG_IO_WRITTEN:\n          direction = QLatin1String(\" >>> \");\n          break;\n      case LOG_PARSE_ERROR:\n          direction = QLatin1String(\" [err] \");\n          break;\n      case LOG_MAILBOX_SYNC:\n          direction = QLatin1String(\" [sync] \");\n          break;\n      case LOG_TASKS:\n          direction = QLatin1String(\" [task] \");\n          break;\n      case LOG_MESSAGES:\n          direction = QLatin1String(\" [msg] \");\n          break;\n      case LOG_OTHER:\n          direction = QLatin1String(\" \");\n          break;\n      }\n      if (message.truncatedBytes) {\n          direction += QLatin1String(\"[truncated] \");\n      }\n      return message.timestamp.toString(QLatin1String(\"hh:mm:ss.zzz\")) + QString::number(parser) + QLatin1Char(' ') +\n              direction + message.source + QLatin1Char(' ') + message.message.trimmed();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essage.message.left",
          "args": [
            "UTOFF)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.message.size",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.message.size",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_fileLog->flush",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  oid FileLogger::slotImapLogged(uint parser, Common::LogMessage message)\n  {\n      if (!m_fileLog && !m_consoleLog)\n          return;\n  \n      QString formatted = formatMessage(parser, message);\n      escapeCrLf(formatted);\n  \n      if (m_fileLog) {\n          *m_fileLog << formatted << \"\\n\";\n          if (m_autoFlush)\n              m_fileLog->flush();\n      }\n  \n      enum {CUTOFF=200};\n      if (m_consoleLog) {\n          if (message.message.size() > CUTOFF) {\n              // Got to reformat the message\n              message.truncatedBytes = message.message.size() - CUTOFF;\n              message.message = message.message.left(CUTOFF);\n              formatted = formatMessage(parser, message);\n              escapeCrLf(formatted);\n          }\n          qDebug() << formatted.toUtf8().constData() << \"\\n\";\n      }\n  }\n}"
  },
  {
    "function_name": "escapeCrLf(",
    "container": "ileLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
    "lines": "62-66",
    "snippet": "oid FileLogger::escapeCrLf(QString &s)\n{\n    s.replace(QChar('\\r'), 0x240d /* SYMBOL FOR CARRIAGE RETURN */)\n            .replace(QChar('\\n'), 0x240a /* SYMBOL FOR LINE FEED */);\n}",
    "includes": [
      "include \"../Imap/Model/Utils.h\"",
      "include \"FileLogger.h\"\n#",
      "include <QTextStream>\n#",
      "include <QFile>\n#",
      "include <QDebug>\n#",
      "include <QDateTime>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": ".replace",
          "args": [
            "Char('\\n'),",
            "x240a * SYMBOL FOR LINE FEED */)"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "replaceChildMailboxes(",
          "container": "odel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Model.cpp",
          "lines": "434-493",
          "snippet": "oid Model::replaceChildMailboxes(TreeItemMailbox *mailboxPtr, const TreeItemChildrenList &mailboxes)\n{\n    /* Previously, we would call layoutAboutToBeChanged() and layoutChanged() here, but it\n       resulted in invalid memory access in the attached QSortFilterProxyModels like this one:\n\n    ==23294== Invalid read of size 4\n    ==23294==    at 0x5EA34B1: QSortFilterProxyModelPrivate::index_to_iterator(QModelIndex const&) const (qsortfilterproxymodel.cpp:191)\n    ==23294==    by 0x5E9F8A3: QSortFilterProxyModel::parent(QModelIndex const&) const (qsortfilterproxymodel.cpp:1654)\n    ==23294==    by 0x5C5D45D: QModelIndex::parent() const (qabstractitemmodel.h:389)\n    ==23294==    by 0x5E47C48: QTreeView::drawRow(QPainter*, QStyleOptionViewItem const&, QModelIndex const&) const (qtreeview.cpp:1479)\n    ==23294==    by 0x5E479D9: QTreeView::drawTree(QPainter*, QRegion const&) const (qtreeview.cpp:1441)\n    ==23294==    by 0x5E4703A: QTreeView::paintEvent(QPaintEvent*) (qtreeview.cpp:1274)\n    ==23294==    by 0x5810C30: QWidget::event(QEvent*) (qwidget.cpp:8346)\n    ==23294==    by 0x5C91D03: QFrame::event(QEvent*) (qframe.cpp:557)\n    ==23294==    by 0x5D4259C: QAbstractScrollArea::viewportEvent(QEvent*) (qabstractscrollarea.cpp:1043)\n    ==23294==    by 0x5DFFD6E: QAbstractItemView::viewportEvent(QEvent*) (qabstractitemview.cpp:1619)\n    ==23294==    by 0x5E46EE0: QTreeView::viewportEvent(QEvent*) (qtreeview.cpp:1256)\n    ==23294==    by 0x5D43110: QAbstractScrollAreaPrivate::viewportEvent(QEvent*) (qabstractscrollarea_p.h:100)\n    ==23294==  Address 0x908dbec is 20 bytes inside a block of size 24 free'd\n    ==23294==    at 0x4024D74: operator delete(void*) (vg_replace_malloc.c:346)\n    ==23294==    by 0x5EA5236: void qDeleteAll<QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*>::const_iterator>(QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*>::const_iterator, QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*>::const_iterator) (qalgorithms.h:322)\n    ==23294==    by 0x5EA3C06: void qDeleteAll<QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*> >(QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*> const&) (qalgorithms.h:330)\n    ==23294==    by 0x5E9E64B: QSortFilterProxyModelPrivate::_q_sourceLayoutChanged() (qsortfilterproxymodel.cpp:1249)\n    ==23294==    by 0x5EA29EC: QSortFilterProxyModel::qt_metacall(QMetaObject::Call, int, void**) (moc_qsortfilterproxymodel.cpp:133)\n    ==23294==    by 0x80EB205: Imap::Mailbox::PrettyMailboxModel::qt_metacall(QMetaObject::Call, int, void**) (moc_PrettyMailboxModel.cpp:64)\n    ==23294==    by 0x65D3EAD: QMetaObject::metacall(QObject*, QMetaObject::Call, int, void**) (qmetaobject.cpp:237)\n    ==23294==    by 0x65E8D7C: QMetaObject::activate(QObject*, QMetaObject const*, int, void**) (qobject.cpp:3272)\n    ==23294==    by 0x664A7E8: QAbstractItemModel::layoutChanged() (moc_qabstractitemmodel.cpp:161)\n    ==23294==    by 0x664A354: QAbstractItemModel::qt_metacall(QMetaObject::Call, int, void**) (moc_qabstractitemmodel.cpp:118)\n    ==23294==    by 0x5E9A3A9: QAbstractProxyModel::qt_metacall(QMetaObject::Call, int, void**) (moc_qabstractproxymodel.cpp:67)\n    ==23294==    by 0x80EAF3D: Imap::Mailbox::MailboxModel::qt_metacall(QMetaObject::Call, int, void**) (moc_MailboxModel.cpp:81)\n\n       I have no idea why something like that happens -- layoutChanged() should be a hint that the indexes are gone now, which means\n       that the code should *not* use tham after that point. That's just weird.\n    */\n\n    QModelIndex parent = mailboxPtr == m_mailboxes ? QModelIndex() : mailboxPtr->toIndex(this);\n\n    if (mailboxPtr->m_children.size() != 1) {\n        // There's something besides the TreeItemMsgList and we're going to\n        // overwrite them, so we have to delete them right now\n        int count = mailboxPtr->rowCount(this);\n        beginRemoveRows(parent, 1, count - 1);\n        auto oldItems = mailboxPtr->setChildren(TreeItemChildrenList());\n        endRemoveRows();\n\n        qDeleteAll(oldItems);\n    }\n\n    if (! mailboxes.isEmpty()) {\n        beginInsertRows(parent, 1, mailboxes.size());\n        auto dummy = mailboxPtr->setChildren(mailboxes);\n        endInsertRows();\n        Q_ASSERT(dummy.isEmpty());\n    } else {\n        auto dummy = mailboxPtr->setChildren(mailboxes);\n        Q_ASSERT(dummy.isEmpty());\n    }\n    emit dataChanged(parent, parent);\n}",
          "includes": [
            "include \"Streams/SocketFactory.h\"",
            "include \"Imap/Tasks/UpdateFlagsTask.h\"\n#",
            "include \"Imap/Tasks/OpenConnectionTask.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Tasks/GetAnyConnectionTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include \"TaskPresentationModel.h\"\n#",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"QAIM_reset.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"Model.h\"\n#",
            "include <QtAlgorithms>\n#",
            "include <QDebug>\n#",
            "include <QCoreApplication>\n#",
            "include <QAuthenticator>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Streams/SocketFactory.h\"\ninclude \"Imap/Tasks/UpdateFlagsTask.h\"\n#\ninclude \"Imap/Tasks/OpenConnectionTask.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Tasks/GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude \"TaskPresentationModel.h\"\n#\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"QAIM_reset.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"Model.h\"\n#\ninclude <QtAlgorithms>\n#\ninclude <QDebug>\n#\ninclude <QCoreApplication>\n#\ninclude <QAuthenticator>\n#\ninclude <QAbstractProxyModel>\n#\n\nodel {\n  oid Model::replaceChildMailboxes(TreeItemMailbox *mailboxPtr, const TreeItemChildrenList &mailboxes)\n  {\n      /* Previously, we would call layoutAboutToBeChanged() and layoutChanged() here, but it\n         resulted in invalid memory access in the attached QSortFilterProxyModels like this one:\n  \n      ==23294== Invalid read of size 4\n      ==23294==    at 0x5EA34B1: QSortFilterProxyModelPrivate::index_to_iterator(QModelIndex const&) const (qsortfilterproxymodel.cpp:191)\n      ==23294==    by 0x5E9F8A3: QSortFilterProxyModel::parent(QModelIndex const&) const (qsortfilterproxymodel.cpp:1654)\n      ==23294==    by 0x5C5D45D: QModelIndex::parent() const (qabstractitemmodel.h:389)\n      ==23294==    by 0x5E47C48: QTreeView::drawRow(QPainter*, QStyleOptionViewItem const&, QModelIndex const&) const (qtreeview.cpp:1479)\n      ==23294==    by 0x5E479D9: QTreeView::drawTree(QPainter*, QRegion const&) const (qtreeview.cpp:1441)\n      ==23294==    by 0x5E4703A: QTreeView::paintEvent(QPaintEvent*) (qtreeview.cpp:1274)\n      ==23294==    by 0x5810C30: QWidget::event(QEvent*) (qwidget.cpp:8346)\n      ==23294==    by 0x5C91D03: QFrame::event(QEvent*) (qframe.cpp:557)\n      ==23294==    by 0x5D4259C: QAbstractScrollArea::viewportEvent(QEvent*) (qabstractscrollarea.cpp:1043)\n      ==23294==    by 0x5DFFD6E: QAbstractItemView::viewportEvent(QEvent*) (qabstractitemview.cpp:1619)\n      ==23294==    by 0x5E46EE0: QTreeView::viewportEvent(QEvent*) (qtreeview.cpp:1256)\n      ==23294==    by 0x5D43110: QAbstractScrollAreaPrivate::viewportEvent(QEvent*) (qabstractscrollarea_p.h:100)\n      ==23294==  Address 0x908dbec is 20 bytes inside a block of size 24 free'd\n      ==23294==    at 0x4024D74: operator delete(void*) (vg_replace_malloc.c:346)\n      ==23294==    by 0x5EA5236: void qDeleteAll<QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*>::const_iterator>(QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*>::const_iterator, QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*>::const_iterator) (qalgorithms.h:322)\n      ==23294==    by 0x5EA3C06: void qDeleteAll<QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*> >(QHash<QModelIndex, QSortFilterProxyModelPrivate::Mapping*> const&) (qalgorithms.h:330)\n      ==23294==    by 0x5E9E64B: QSortFilterProxyModelPrivate::_q_sourceLayoutChanged() (qsortfilterproxymodel.cpp:1249)\n      ==23294==    by 0x5EA29EC: QSortFilterProxyModel::qt_metacall(QMetaObject::Call, int, void**) (moc_qsortfilterproxymodel.cpp:133)\n      ==23294==    by 0x80EB205: Imap::Mailbox::PrettyMailboxModel::qt_metacall(QMetaObject::Call, int, void**) (moc_PrettyMailboxModel.cpp:64)\n      ==23294==    by 0x65D3EAD: QMetaObject::metacall(QObject*, QMetaObject::Call, int, void**) (qmetaobject.cpp:237)\n      ==23294==    by 0x65E8D7C: QMetaObject::activate(QObject*, QMetaObject const*, int, void**) (qobject.cpp:3272)\n      ==23294==    by 0x664A7E8: QAbstractItemModel::layoutChanged() (moc_qabstractitemmodel.cpp:161)\n      ==23294==    by 0x664A354: QAbstractItemModel::qt_metacall(QMetaObject::Call, int, void**) (moc_qabstractitemmodel.cpp:118)\n      ==23294==    by 0x5E9A3A9: QAbstractProxyModel::qt_metacall(QMetaObject::Call, int, void**) (moc_qabstractproxymodel.cpp:67)\n      ==23294==    by 0x80EAF3D: Imap::Mailbox::MailboxModel::qt_metacall(QMetaObject::Call, int, void**) (moc_MailboxModel.cpp:81)\n  \n         I have no idea why something like that happens -- layoutChanged() should be a hint that the indexes are gone now, which means\n         that the code should *not* use tham after that point. That's just weird.\n      */\n  \n      QModelIndex parent = mailboxPtr == m_mailboxes ? QModelIndex() : mailboxPtr->toIndex(this);\n  \n      if (mailboxPtr->m_children.size() != 1) {\n          // There's something besides the TreeItemMsgList and we're going to\n          // overwrite them, so we have to delete them right now\n          int count = mailboxPtr->rowCount(this);\n          beginRemoveRows(parent, 1, count - 1);\n          auto oldItems = mailboxPtr->setChildren(TreeItemChildrenList());\n          endRemoveRows();\n  \n          qDeleteAll(oldItems);\n      }\n  \n      if (! mailboxes.isEmpty()) {\n          beginInsertRows(parent, 1, mailboxes.size());\n          auto dummy = mailboxPtr->setChildren(mailboxes);\n          endInsertRows();\n          Q_ASSERT(dummy.isEmpty());\n      } else {\n          auto dummy = mailboxPtr->setChildren(mailboxes);\n          Q_ASSERT(dummy.isEmpty());\n      }\n      emit dataChanged(parent, parent);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Char(",
          "args": [
            "\\n')"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "exValueOfChar(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Encoders.cpp",
          "lines": "131-142",
          "snippet": "tatic inline int hexValueOfChar(const char input)\n    {\n        if (input >= '0' && input <= '9') {\n            return input - '0';\n        } else if (input >= 'A' && input <= 'F') {\n            return 0x0a + input - 'A';\n        } else if (input >= 'a' && input <= 'f') {\n            return 0x0a + input - 'a';\n        } else {\n            return -1;\n        }\n    }",
          "includes": [
            "include \"Parser/3rdparty/kcodecs.h\"",
            "include \"Parser/3rdparty/rfccodecs.h\"\n#",
            "include \"Encoders.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Parser/3rdparty/kcodecs.h\"\ninclude \"Parser/3rdparty/rfccodecs.h\"\n#\ninclude \"Encoders.h\"\n#\n\ntatic inline int hexValueOfChar(const char input)\n    {\n        if (input >= '0' && input <= '9') {\n            return input - '0';\n        } else if (input >= 'A' && input <= 'F') {\n            return 0x0a + input - 'A';\n        } else if (input >= 'a' && input <= 'f') {\n            return 0x0a + input - 'a';\n        } else {\n            return -1;\n        }\n    }"
        }
      }
    ],
    "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  oid FileLogger::escapeCrLf(QString &s)\n  {\n      s.replace(QChar('\\r'), 0x240d /* SYMBOL FOR CARRIAGE RETURN */)\n              .replace(QChar('\\n'), 0x240a /* SYMBOL FOR LINE FEED */);\n  }\n}"
  },
  {
    "function_name": "~FileLogger(",
    "container": "ileLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
    "lines": "57-60",
    "snippet": "ileLogger::~FileLogger()\n{\n    delete m_fileLog;\n}",
    "includes": [
      "include \"../Imap/Model/Utils.h\"",
      "include \"FileLogger.h\"\n#",
      "include <QTextStream>\n#",
      "include <QFile>\n#",
      "include <QDebug>\n#",
      "include <QDateTime>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  ileLogger::~FileLogger()\n  {\n      delete m_fileLog;\n  }\n}"
  },
  {
    "function_name": "setFileLogging(",
    "container": "ileLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
    "lines": "38-55",
    "snippet": "oid FileLogger::setFileLogging(const bool enabled, const QString &fileName)\n{\n    if (enabled) {\n        if (m_fileLog)\n            return;\n\n        QFile *logFile = new QFile(fileName, this);\n        logFile->open(QIODevice::Truncate | QIODevice::WriteOnly);\n        m_fileLog = new QTextStream(logFile);\n    } else {\n        if (m_fileLog) {\n            QIODevice *dev = m_fileLog->device();\n            delete m_fileLog;\n            delete dev;\n            m_fileLog = 0;\n        }\n    }\n}",
    "includes": [
      "include \"../Imap/Model/Utils.h\"",
      "include \"FileLogger.h\"\n#",
      "include <QTextStream>\n#",
      "include <QFile>\n#",
      "include <QDebug>\n#",
      "include <QDateTime>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_fileLog->device",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ogFile->open",
          "args": [
            "IODevice::Truncate | QIODevice::WriteOnly)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  oid FileLogger::setFileLogging(const bool enabled, const QString &fileName)\n  {\n      if (enabled) {\n          if (m_fileLog)\n              return;\n  \n          QFile *logFile = new QFile(fileName, this);\n          logFile->open(QIODevice::Truncate | QIODevice::WriteOnly);\n          m_fileLog = new QTextStream(logFile);\n      } else {\n          if (m_fileLog) {\n              QIODevice *dev = m_fileLog->device();\n              delete m_fileLog;\n              delete dev;\n              m_fileLog = 0;\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "FileLogger(",
    "container": "ileLogger",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Common/FileLogger.cpp",
    "lines": "33-36",
    "snippet": "ileLogger::FileLogger(QObject *parent) :\n    QObject(parent), m_fileLog(0), m_consoleLog(false), m_autoFlush(false)\n{\n}",
    "includes": [
      "include \"../Imap/Model/Utils.h\"",
      "include \"FileLogger.h\"\n#",
      "include <QTextStream>\n#",
      "include <QFile>\n#",
      "include <QDebug>\n#",
      "include <QDateTime>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"../Imap/Model/Utils.h\"\ninclude \"FileLogger.h\"\n#\ninclude <QTextStream>\n#\ninclude <QFile>\n#\ninclude <QDebug>\n#\ninclude <QDateTime>\n#\n\nileLogger {\n  ileLogger::FileLogger(QObject *parent) :\n      QObject(parent), m_fileLog(0), m_consoleLog(false), m_autoFlush(false)\n  {\n  }\n}"
  }
]