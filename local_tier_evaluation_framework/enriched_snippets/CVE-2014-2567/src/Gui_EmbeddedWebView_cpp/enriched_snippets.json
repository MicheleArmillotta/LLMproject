[
  {
    "function_name": "extension(",
    "container": "rrorCheckingPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "245-269",
    "snippet": "ool ErrorCheckingPage::extension(Extension extension, const ExtensionOption *option, ExtensionReturn *output)\n{\n#if QT_VERSION < QT_VERSION_CHECK(4, 8, 0)\n    return false;\n#else\n    if (extension != ErrorPageExtension)\n        return false;\n\n    const ErrorPageExtensionOption *input = static_cast<const ErrorPageExtensionOption *>(option);\n    ErrorPageExtensionReturn *res = static_cast<ErrorPageExtensionReturn *>(output);\n    if (input && res) {\n        if (input->url.scheme() == QLatin1String(\"trojita-imap\")) {\n            if (input->domain == QtNetwork && input->error == QNetworkReply::TimeoutError) {\n                res->content = tr(\"<img src='%2'/><span style='font-family: sans-serif; color: gray'>\"\n                                  \"Uncached data not available when offline</span>\")\n                        .arg(Util::resizedImageAsDataUrl(QLatin1String(\":/icons/network-offline.png\"), 32)).toUtf8();\n                return true;\n            }\n        }\n        res->content = input->errorString.toUtf8();\n        res->contentType = QLatin1String(\"text/plain\");\n    }\n    return true;\n#endif\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "text/plain\")"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput->errorString.toUtf8",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r",
          "args": [],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "findScrollParent(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "178-212",
          "snippet": "oid EmbeddedWebView::findScrollParent()\n{\n    if (m_scrollParent)\n        m_scrollParent->removeEventFilter(this);\n    m_scrollParent = 0;\n    m_scrollParentPadding = 4;\n    QWidget *runner = this;\n    int left, top, right, bottom;\n    while (runner) {\n        runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n        runner->getContentsMargins(&left, &top, &right, &bottom);\n        m_scrollParentPadding += left + right + 4;\n        if (runner->layout()) {\n            runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right;\n        }\n        QWidget *p = runner->parentWidget();\n        if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n            p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n            qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n            p->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right + 4;\n            if (p->layout()) {\n                p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                m_scrollParentPadding += left + right;\n            }\n            m_scrollParent = p->parentWidget();\n            break; // then we have our actual message view\n        }\n        runner = p;\n    }\n    m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n    if (m_scrollParent)\n        m_scrollParent->installEventFilter(this);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::findScrollParent()\n  {\n      if (m_scrollParent)\n          m_scrollParent->removeEventFilter(this);\n      m_scrollParent = 0;\n      m_scrollParentPadding = 4;\n      QWidget *runner = this;\n      int left, top, right, bottom;\n      while (runner) {\n          runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n          runner->getContentsMargins(&left, &top, &right, &bottom);\n          m_scrollParentPadding += left + right + 4;\n          if (runner->layout()) {\n              runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right;\n          }\n          QWidget *p = runner->parentWidget();\n          if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n              p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n              qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n              p->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right + 4;\n              if (p->layout()) {\n                  p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                  m_scrollParentPadding += left + right;\n              }\n              m_scrollParent = p->parentWidget();\n              break; // then we have our actual message view\n          }\n          runner = p;\n      }\n      m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n      if (m_scrollParent)\n          m_scrollParent->installEventFilter(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "til::resizedImageAsDataUrl(QLatin1String(\":/icons/network-offline.png\"), 32))"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "supportsExtension(",
          "container": "rrorCheckingPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "235-243",
          "snippet": "ool ErrorCheckingPage::supportsExtension(Extension extension) const\n{\n#if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n    if (extension == ErrorPageExtension)\n        return true;\n    else\n#endif\n        return false;\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nrrorCheckingPage {\n  ool ErrorCheckingPage::supportsExtension(Extension extension) const\n  {\n  #if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n      if (extension == ErrorPageExtension)\n          return true;\n      else\n  #endif\n          return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "til::resizedImageAsDataUrl(",
          "args": [
            "Latin1String(\":/icons/network-offline.png\"),",
            "2)"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ":/icons/network-offline.png\")"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "<img src='%2'/><span style='font-family: sans-serif; color: gray'>\"\n                                  \"Uncached data not available when offline</span>\")"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "ncrementor(",
          "container": "ncrementor ",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "45-48",
          "snippet": "ncrementor(int *what): m_int(what)\n    {\n        ++(*m_int);\n    }",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nncrementor  {\n  ncrementor(int *what): m_int(what)\n      {\n          ++(*m_int);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "trojita-imap\")"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nput->url.scheme",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<ErrorPageExtensionReturn *>",
          "args": [
            "utput)"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<const ErrorPageExtensionOption *>",
          "args": [
            "ption)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nrrorCheckingPage {\n  ool ErrorCheckingPage::extension(Extension extension, const ExtensionOption *option, ExtensionReturn *output)\n  {\n  #if QT_VERSION < QT_VERSION_CHECK(4, 8, 0)\n      return false;\n  #else\n      if (extension != ErrorPageExtension)\n          return false;\n  \n      const ErrorPageExtensionOption *input = static_cast<const ErrorPageExtensionOption *>(option);\n      ErrorPageExtensionReturn *res = static_cast<ErrorPageExtensionReturn *>(output);\n      if (input && res) {\n          if (input->url.scheme() == QLatin1String(\"trojita-imap\")) {\n              if (input->domain == QtNetwork && input->error == QNetworkReply::TimeoutError) {\n                  res->content = tr(\"<img src='%2'/><span style='font-family: sans-serif; color: gray'>\"\n                                    \"Uncached data not available when offline</span>\")\n                          .arg(Util::resizedImageAsDataUrl(QLatin1String(\":/icons/network-offline.png\"), 32)).toUtf8();\n                  return true;\n              }\n          }\n          res->content = input->errorString.toUtf8();\n          res->contentType = QLatin1String(\"text/plain\");\n      }\n      return true;\n  #endif\n  }\n}"
  },
  {
    "function_name": "supportsExtension(",
    "container": "rrorCheckingPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "235-243",
    "snippet": "ool ErrorCheckingPage::supportsExtension(Extension extension) const\n{\n#if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n    if (extension == ErrorPageExtension)\n        return true;\n    else\n#endif\n        return false;\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nrrorCheckingPage {\n  ool ErrorCheckingPage::supportsExtension(Extension extension) const\n  {\n  #if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n      if (extension == ErrorPageExtension)\n          return true;\n      else\n  #endif\n          return false;\n  }\n}"
  },
  {
    "function_name": "ErrorCheckingPage(",
    "container": "rrorCheckingPage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "231-233",
    "snippet": "rrorCheckingPage::ErrorCheckingPage(QObject *parent): QWebPage(parent)\n{\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nrrorCheckingPage {\n  rrorCheckingPage::ErrorCheckingPage(QObject *parent): QWebPage(parent)\n  {\n  }\n}"
  },
  {
    "function_name": "sizeHint(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "226-229",
    "snippet": "Size EmbeddedWebView::sizeHint() const\n{\n    return QSize(32,32); // QWebView returns 800x600 what will lead to too wide pages for our implementation\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Size(",
          "args": [
            "2,",
            "2)"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "prettySize(",
          "container": "rettySize",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Utils.cpp",
          "lines": "50-76",
          "snippet": "String PrettySize::prettySize(uint bytes, const ShowBytesSuffix compactUnitFormat)\n{\n    if (bytes == 0) {\n        return tr(\"0\");\n    }\n    int order = std::log(static_cast<double>(bytes)) / std::log(1024.0);\n    double number = bytes / std::pow(1024.0, order);\n\n    QString suffix;\n    if (order <= 0) {\n        if (compactUnitFormat == COMPACT_FORM)\n            return QString::number(bytes);\n        else\n            return tr(\"%1 bytes\").arg(QString::number(bytes));\n    } else if (order == 1) {\n        suffix = tr(\"kB\");\n    } else if (order == 2) {\n        suffix = tr(\"MB\");\n    } else if (order == 3) {\n        suffix = tr(\"GB\");\n    } else {\n        // make sure not to show wrong size for those that have > 1024 TB e-mail messages\n        order = 4;\n        suffix = tr(\"TB\"); // shame on you for such mails\n    }\n    return tr(\"%1 %2\").arg(QString::number(number, 'f', number < 100 ? 1 : 0), suffix);\n}",
          "includes": [
            "include <QSystemDeviceInfo>\n#",
            "include \"Imap/Model/Model.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include <QTextDocument>",
            "include <QSysInfo>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSettings>\n#",
            "include <QProcess>\n#",
            "include <QLocale>\n#",
            "include <QGuiApplication>\n#",
            "include <QDir>\n#",
            "include <QDateTime>\n#",
            "include <cmath>\n#",
            "include \"Utils.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QSystemDeviceInfo>\n#\ninclude \"Imap/Model/Model.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude <QTextDocument>\ninclude <QSysInfo>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSettings>\n#\ninclude <QProcess>\n#\ninclude <QLocale>\n#\ninclude <QGuiApplication>\n#\ninclude <QDir>\n#\ninclude <QDateTime>\n#\ninclude <cmath>\n#\ninclude \"Utils.h\"\n#\n\nrettySize {\n  String PrettySize::prettySize(uint bytes, const ShowBytesSuffix compactUnitFormat)\n  {\n      if (bytes == 0) {\n          return tr(\"0\");\n      }\n      int order = std::log(static_cast<double>(bytes)) / std::log(1024.0);\n      double number = bytes / std::pow(1024.0, order);\n  \n      QString suffix;\n      if (order <= 0) {\n          if (compactUnitFormat == COMPACT_FORM)\n              return QString::number(bytes);\n          else\n              return tr(\"%1 bytes\").arg(QString::number(bytes));\n      } else if (order == 1) {\n          suffix = tr(\"kB\");\n      } else if (order == 2) {\n          suffix = tr(\"MB\");\n      } else if (order == 3) {\n          suffix = tr(\"GB\");\n      } else {\n          // make sure not to show wrong size for those that have > 1024 TB e-mail messages\n          order = 4;\n          suffix = tr(\"TB\"); // shame on you for such mails\n      }\n      return tr(\"%1 %2\").arg(QString::number(number, 'f', number < 100 ? 1 : 0), suffix);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  Size EmbeddedWebView::sizeHint() const\n  {\n      return QSize(32,32); // QWebView returns 800x600 what will lead to too wide pages for our implementation\n  }\n}"
  },
  {
    "function_name": "showEvent(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "214-224",
    "snippet": "oid EmbeddedWebView::showEvent(QShowEvent *se)\n{\n    QWebView::showEvent(se);\n    Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, Qt::ScrollBarAsNeeded);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n    if (isWindow()) {\n        resize(640,480);\n    } else if (!m_scrollParent) // it would be much easier if the parents were just passed with the constructor ;-)\n        findScrollParent();\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "indScrollParent(",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "findScrollParent(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "178-212",
          "snippet": "oid EmbeddedWebView::findScrollParent()\n{\n    if (m_scrollParent)\n        m_scrollParent->removeEventFilter(this);\n    m_scrollParent = 0;\n    m_scrollParentPadding = 4;\n    QWidget *runner = this;\n    int left, top, right, bottom;\n    while (runner) {\n        runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n        runner->getContentsMargins(&left, &top, &right, &bottom);\n        m_scrollParentPadding += left + right + 4;\n        if (runner->layout()) {\n            runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right;\n        }\n        QWidget *p = runner->parentWidget();\n        if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n            p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n            qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n            p->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right + 4;\n            if (p->layout()) {\n                p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                m_scrollParentPadding += left + right;\n            }\n            m_scrollParent = p->parentWidget();\n            break; // then we have our actual message view\n        }\n        runner = p;\n    }\n    m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n    if (m_scrollParent)\n        m_scrollParent->installEventFilter(this);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::findScrollParent()\n  {\n      if (m_scrollParent)\n          m_scrollParent->removeEventFilter(this);\n      m_scrollParent = 0;\n      m_scrollParentPadding = 4;\n      QWidget *runner = this;\n      int left, top, right, bottom;\n      while (runner) {\n          runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n          runner->getContentsMargins(&left, &top, &right, &bottom);\n          m_scrollParentPadding += left + right + 4;\n          if (runner->layout()) {\n              runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right;\n          }\n          QWidget *p = runner->parentWidget();\n          if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n              p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n              qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n              p->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right + 4;\n              if (p->layout()) {\n                  p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                  m_scrollParentPadding += left + right;\n              }\n              m_scrollParent = p->parentWidget();\n              break; // then we have our actual message view\n          }\n          runner = p;\n      }\n      m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n      if (m_scrollParent)\n          m_scrollParent->installEventFilter(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "esize(",
          "args": [
            "40,",
            "80)"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sWindow(",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "age",
          "args": [
            "t::Vertical,",
            "olicy)"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "MessageSourceWidget",
          "container": "MessageSourceWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageSourceWidget.cpp",
          "lines": "32-48",
          "snippet": "MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n    QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n{\n    setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n    Q_ASSERT(messageIndex.isValid());\n    page()->setNetworkAccessManager(0);\n\n    m_loadingSpinner = new Spinner(this);\n    m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n    m_loadingSpinner->setType(Spinner::Sun);\n    m_loadingSpinner->start(250);\n\n    m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n    connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n    connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n    m_combiner->load();\n}",
          "includes": [
            "#include \"Imap/Model/FullMessageCombiner.h\"",
            "#include \"Gui/Spinner.h\"",
            "#include \"Gui/IconLoader.h\"",
            "#include <QModelIndex>",
            "#include \"MessageSourceWidget.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Imap/Model/FullMessageCombiner.h\"\n#include \"Gui/Spinner.h\"\n#include \"Gui/IconLoader.h\"\n#include <QModelIndex>\n#include \"MessageSourceWidget.h\"\n\nMessageSourceWidget {\n  MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n      QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n  {\n      setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n      Q_ASSERT(messageIndex.isValid());\n      page()->setNetworkAccessManager(0);\n  \n      m_loadingSpinner = new Spinner(this);\n      m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n      m_loadingSpinner->setType(Spinner::Sun);\n      m_loadingSpinner->start(250);\n  \n      m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n      connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n      connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n      m_combiner->load();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age",
          "args": [],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "handlePageLoadFinished(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "152-162",
          "snippet": "oid EmbeddedWebView::handlePageLoadFinished()\n{\n    constrainSize();\n\n    // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n    // Let's do it again here, it works.\n    Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n    page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::handlePageLoadFinished()\n  {\n      constrainSize();\n  \n      // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n      // Let's do it again here, it works.\n      Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n      page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n      page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n      page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age(",
          "args": [],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessage(",
          "container": "implePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
          "lines": "227-240",
          "snippet": "oid SimplePartWidget::slotDownloadMessage()\n{\n    QModelIndex index;\n    if (m_partIndex.isValid()) {\n        index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n    }\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadMessage();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include <QWebFrame>",
            "include <QNetworkReply>\n#",
            "include <QFileDialog>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadMessage()\n  {\n      QModelIndex index;\n      if (m_partIndex.isValid()) {\n          index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n      }\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadMessage();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sWindow(",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WebView::showEvent(",
          "args": [
            "e)"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "showEvent(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "214-224",
          "snippet": "oid EmbeddedWebView::showEvent(QShowEvent *se)\n{\n    QWebView::showEvent(se);\n    Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, Qt::ScrollBarAsNeeded);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n    if (isWindow()) {\n        resize(640,480);\n    } else if (!m_scrollParent) // it would be much easier if the parents were just passed with the constructor ;-)\n        findScrollParent();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::showEvent(QShowEvent *se)\n  {\n      QWebView::showEvent(se);\n      Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n      page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, Qt::ScrollBarAsNeeded);\n      page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n      if (isWindow()) {\n          resize(640,480);\n      } else if (!m_scrollParent) // it would be much easier if the parents were just passed with the constructor ;-)\n          findScrollParent();\n  }\n}"
  },
  {
    "function_name": "findScrollParent(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "178-212",
    "snippet": "oid EmbeddedWebView::findScrollParent()\n{\n    if (m_scrollParent)\n        m_scrollParent->removeEventFilter(this);\n    m_scrollParent = 0;\n    m_scrollParentPadding = 4;\n    QWidget *runner = this;\n    int left, top, right, bottom;\n    while (runner) {\n        runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n        runner->getContentsMargins(&left, &top, &right, &bottom);\n        m_scrollParentPadding += left + right + 4;\n        if (runner->layout()) {\n            runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right;\n        }\n        QWidget *p = runner->parentWidget();\n        if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n            p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n            qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n            p->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right + 4;\n            if (p->layout()) {\n                p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                m_scrollParentPadding += left + right;\n            }\n            m_scrollParent = p->parentWidget();\n            break; // then we have our actual message view\n        }\n        runner = p;\n    }\n    m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n    if (m_scrollParent)\n        m_scrollParent->installEventFilter(this);\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_scrollParent->installEventFilter",
          "args": [
            "his)"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle",
          "args": [
            "Style::PM_ScrollBarExtent,",
            ",",
            "_scrollParent)"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle(",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->parentWidget",
          "args": [],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->layout",
          "args": [
            "left,",
            "top,",
            "right,",
            "bottom)"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->layout",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "layoutChanged(",
          "container": "odelWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelWatcher.cpp",
          "lines": "94-97",
          "snippet": "oid ModelWatcher::layoutChanged()\n{\n    qDebug() << sender()->objectName() << \"layoutChanged()\";\n}",
          "includes": [
            "include \"ModelWatcher.h\"",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"ModelWatcher.h\"\ninclude <QDebug>\n#\n\nodelWatcher {\n  oid ModelWatcher::layoutChanged()\n  {\n      qDebug() << sender()->objectName() << \"layoutChanged()\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "->getContentsMargins",
          "args": [
            "left,",
            "top,",
            "right,",
            "bottom)"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object_cast<QAbstractScrollArea*>",
          "args": [
            "->parentWidget())"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->parentWidget",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->objectName",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object_cast<MessageView*>",
          "args": [
            "unner)"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unner->parentWidget",
          "args": [],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unner->layout",
          "args": [
            "left,",
            "top,",
            "right,",
            "bottom)"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unner->layout",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unner->layout",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unner->getContentsMargins",
          "args": [
            "left,",
            "top,",
            "right,",
            "bottom)"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unner->setSizePolicy",
          "args": [
            "SizePolicy::Preferred,",
            "SizePolicy::Preferred)"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_scrollParent->removeEventFilter",
          "args": [
            "his)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::findScrollParent()\n  {\n      if (m_scrollParent)\n          m_scrollParent->removeEventFilter(this);\n      m_scrollParent = 0;\n      m_scrollParentPadding = 4;\n      QWidget *runner = this;\n      int left, top, right, bottom;\n      while (runner) {\n          runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n          runner->getContentsMargins(&left, &top, &right, &bottom);\n          m_scrollParentPadding += left + right + 4;\n          if (runner->layout()) {\n              runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right;\n          }\n          QWidget *p = runner->parentWidget();\n          if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n              p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n              qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n              p->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right + 4;\n              if (p->layout()) {\n                  p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                  m_scrollParentPadding += left + right;\n              }\n              m_scrollParent = p->parentWidget();\n              break; // then we have our actual message view\n          }\n          runner = p;\n      }\n      m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n      if (m_scrollParent)\n          m_scrollParent->installEventFilter(this);\n  }\n}"
  },
  {
    "function_name": "eventFilter(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "171-176",
    "snippet": "ool EmbeddedWebView::eventFilter(QObject *o, QEvent *e)\n{\n    if (e->type() == QEvent::Resize && o == m_scrollParent)\n        constrainSize();\n    return QWebView::eventFilter(o, e);\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WebView::eventFilter(",
          "args": [
            ",",
            ")"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "eventFilter(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "171-176",
          "snippet": "ool EmbeddedWebView::eventFilter(QObject *o, QEvent *e)\n{\n    if (e->type() == QEvent::Resize && o == m_scrollParent)\n        constrainSize();\n    return QWebView::eventFilter(o, e);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "onstrainSize(",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "constrainSize(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "108-135",
          "snippet": "oid EmbeddedWebView::constrainSize()\n{\n    Incrementor dummy(&m_resizeInProgress);\n\n    if (!(m_scrollParent && page() && page()->mainFrame()))\n        return; // should not happen but who knows\n\n    // Prevent expensive operation where a resize triggers one extra resizing operation.\n    // This is very visible on large attachments, and in fact could possibly lead to recursion as the\n    // contentsSizeChanged signal is connected to handlePageLoadFinished.\n    if (m_resizeInProgress > 1)\n        return;\n\n    // the m_scrollParentPadding measures the summed up horizontal paddings of this view compared to\n    // its m_scrollParent\n    setMinimumSize(0,0);\n    setMaximumSize(QWIDGETSIZE_MAX, QWIDGETSIZE_MAX);\n    // resize so that the viewport has much vertical and wanted horizontal space\n    resize(m_scrollParent->width() - m_scrollParentPadding, QWIDGETSIZE_MAX);\n    // resize the PAGES viewport to this width and a minimum height\n    page()->setViewportSize(QSize(m_scrollParent->width() - m_scrollParentPadding, 32));\n    // now the page has an idea about it's demanded size\n    const QSize bestSize = page()->mainFrame()->contentsSize();\n    // set the viewport to that size! - Otherwise it'd still be our \"suggestion\"\n    page()->setViewportSize(bestSize);\n    // fix the widgets size so the layout doesn't have much choice\n    setFixedSize(bestSize);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::constrainSize()\n  {\n      Incrementor dummy(&m_resizeInProgress);\n  \n      if (!(m_scrollParent && page() && page()->mainFrame()))\n          return; // should not happen but who knows\n  \n      // Prevent expensive operation where a resize triggers one extra resizing operation.\n      // This is very visible on large attachments, and in fact could possibly lead to recursion as the\n      // contentsSizeChanged signal is connected to handlePageLoadFinished.\n      if (m_resizeInProgress > 1)\n          return;\n  \n      // the m_scrollParentPadding measures the summed up horizontal paddings of this view compared to\n      // its m_scrollParent\n      setMinimumSize(0,0);\n      setMaximumSize(QWIDGETSIZE_MAX, QWIDGETSIZE_MAX);\n      // resize so that the viewport has much vertical and wanted horizontal space\n      resize(m_scrollParent->width() - m_scrollParentPadding, QWIDGETSIZE_MAX);\n      // resize the PAGES viewport to this width and a minimum height\n      page()->setViewportSize(QSize(m_scrollParent->width() - m_scrollParentPadding, 32));\n      // now the page has an idea about it's demanded size\n      const QSize bestSize = page()->mainFrame()->contentsSize();\n      // set the viewport to that size! - Otherwise it'd still be our \"suggestion\"\n      page()->setViewportSize(bestSize);\n      // fix the widgets size so the layout doesn't have much choice\n      setFixedSize(bestSize);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "->type",
          "args": [],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "type(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "73-76",
          "snippet": "pinner::Type Spinner::type() const\n{\n    return m_type;\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Type Spinner::type() const\n  {\n      return m_type;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  ool EmbeddedWebView::eventFilter(QObject *o, QEvent *e)\n  {\n      if (e->type() == QEvent::Resize && o == m_scrollParent)\n          constrainSize();\n      return QWebView::eventFilter(o, e);\n  }\n}"
  },
  {
    "function_name": "changeEvent(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "164-169",
    "snippet": "oid EmbeddedWebView::changeEvent(QEvent *e)\n{\n    QWebView::changeEvent(e);\n    if (e->type() == QEvent::ParentChange)\n        findScrollParent();\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "indScrollParent(",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "findScrollParent(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "178-212",
          "snippet": "oid EmbeddedWebView::findScrollParent()\n{\n    if (m_scrollParent)\n        m_scrollParent->removeEventFilter(this);\n    m_scrollParent = 0;\n    m_scrollParentPadding = 4;\n    QWidget *runner = this;\n    int left, top, right, bottom;\n    while (runner) {\n        runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n        runner->getContentsMargins(&left, &top, &right, &bottom);\n        m_scrollParentPadding += left + right + 4;\n        if (runner->layout()) {\n            runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right;\n        }\n        QWidget *p = runner->parentWidget();\n        if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n            p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n            qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n            p->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right + 4;\n            if (p->layout()) {\n                p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                m_scrollParentPadding += left + right;\n            }\n            m_scrollParent = p->parentWidget();\n            break; // then we have our actual message view\n        }\n        runner = p;\n    }\n    m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n    if (m_scrollParent)\n        m_scrollParent->installEventFilter(this);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::findScrollParent()\n  {\n      if (m_scrollParent)\n          m_scrollParent->removeEventFilter(this);\n      m_scrollParent = 0;\n      m_scrollParentPadding = 4;\n      QWidget *runner = this;\n      int left, top, right, bottom;\n      while (runner) {\n          runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n          runner->getContentsMargins(&left, &top, &right, &bottom);\n          m_scrollParentPadding += left + right + 4;\n          if (runner->layout()) {\n              runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right;\n          }\n          QWidget *p = runner->parentWidget();\n          if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n              p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n              qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n              p->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right + 4;\n              if (p->layout()) {\n                  p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                  m_scrollParentPadding += left + right;\n              }\n              m_scrollParent = p->parentWidget();\n              break; // then we have our actual message view\n          }\n          runner = p;\n      }\n      m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n      if (m_scrollParent)\n          m_scrollParent->installEventFilter(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "->type",
          "args": [],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "type(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "73-76",
          "snippet": "pinner::Type Spinner::type() const\n{\n    return m_type;\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Type Spinner::type() const\n  {\n      return m_type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "WebView::changeEvent(",
          "args": [
            ")"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "changeEvent(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "164-169",
          "snippet": "oid EmbeddedWebView::changeEvent(QEvent *e)\n{\n    QWebView::changeEvent(e);\n    if (e->type() == QEvent::ParentChange)\n        findScrollParent();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::changeEvent(QEvent *e)\n  {\n      QWebView::changeEvent(e);\n      if (e->type() == QEvent::ParentChange)\n          findScrollParent();\n  }\n}"
  },
  {
    "function_name": "handlePageLoadFinished(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "152-162",
    "snippet": "oid EmbeddedWebView::handlePageLoadFinished()\n{\n    constrainSize();\n\n    // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n    // Let's do it again here, it works.\n    Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n    page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "age",
          "args": [
            "WebPage::DelegateAllLinks)"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "supportsExtension(",
          "container": "rrorCheckingPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "235-243",
          "snippet": "ool ErrorCheckingPage::supportsExtension(Extension extension) const\n{\n#if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n    if (extension == ErrorPageExtension)\n        return true;\n    else\n#endif\n        return false;\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nrrorCheckingPage {\n  ool ErrorCheckingPage::supportsExtension(Extension extension) const\n  {\n  #if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n      if (extension == ErrorPageExtension)\n          return true;\n      else\n  #endif\n          return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age(",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessage(",
          "container": "implePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
          "lines": "227-240",
          "snippet": "oid SimplePartWidget::slotDownloadMessage()\n{\n    QModelIndex index;\n    if (m_partIndex.isValid()) {\n        index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n    }\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadMessage();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include <QWebFrame>",
            "include <QNetworkReply>\n#",
            "include <QFileDialog>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadMessage()\n  {\n      QModelIndex index;\n      if (m_partIndex.isValid()) {\n          index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n      }\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadMessage();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age",
          "args": [
            "t::Vertical,",
            "olicy)"
          ],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "MessageSourceWidget",
          "container": "MessageSourceWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageSourceWidget.cpp",
          "lines": "32-48",
          "snippet": "MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n    QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n{\n    setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n    Q_ASSERT(messageIndex.isValid());\n    page()->setNetworkAccessManager(0);\n\n    m_loadingSpinner = new Spinner(this);\n    m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n    m_loadingSpinner->setType(Spinner::Sun);\n    m_loadingSpinner->start(250);\n\n    m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n    connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n    connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n    m_combiner->load();\n}",
          "includes": [
            "#include \"Imap/Model/FullMessageCombiner.h\"",
            "#include \"Gui/Spinner.h\"",
            "#include \"Gui/IconLoader.h\"",
            "#include <QModelIndex>",
            "#include \"MessageSourceWidget.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Imap/Model/FullMessageCombiner.h\"\n#include \"Gui/Spinner.h\"\n#include \"Gui/IconLoader.h\"\n#include <QModelIndex>\n#include \"MessageSourceWidget.h\"\n\nMessageSourceWidget {\n  MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n      QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n  {\n      setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n      Q_ASSERT(messageIndex.isValid());\n      page()->setNetworkAccessManager(0);\n  \n      m_loadingSpinner = new Spinner(this);\n      m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n      m_loadingSpinner->setType(Spinner::Sun);\n      m_loadingSpinner->start(250);\n  \n      m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n      connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n      connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n      m_combiner->load();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age",
          "args": [],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "handlePageLoadFinished(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "152-162",
          "snippet": "oid EmbeddedWebView::handlePageLoadFinished()\n{\n    constrainSize();\n\n    // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n    // Let's do it again here, it works.\n    Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n    page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "sWindow(",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onstrainSize(",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "constrainSize(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "108-135",
          "snippet": "oid EmbeddedWebView::constrainSize()\n{\n    Incrementor dummy(&m_resizeInProgress);\n\n    if (!(m_scrollParent && page() && page()->mainFrame()))\n        return; // should not happen but who knows\n\n    // Prevent expensive operation where a resize triggers one extra resizing operation.\n    // This is very visible on large attachments, and in fact could possibly lead to recursion as the\n    // contentsSizeChanged signal is connected to handlePageLoadFinished.\n    if (m_resizeInProgress > 1)\n        return;\n\n    // the m_scrollParentPadding measures the summed up horizontal paddings of this view compared to\n    // its m_scrollParent\n    setMinimumSize(0,0);\n    setMaximumSize(QWIDGETSIZE_MAX, QWIDGETSIZE_MAX);\n    // resize so that the viewport has much vertical and wanted horizontal space\n    resize(m_scrollParent->width() - m_scrollParentPadding, QWIDGETSIZE_MAX);\n    // resize the PAGES viewport to this width and a minimum height\n    page()->setViewportSize(QSize(m_scrollParent->width() - m_scrollParentPadding, 32));\n    // now the page has an idea about it's demanded size\n    const QSize bestSize = page()->mainFrame()->contentsSize();\n    // set the viewport to that size! - Otherwise it'd still be our \"suggestion\"\n    page()->setViewportSize(bestSize);\n    // fix the widgets size so the layout doesn't have much choice\n    setFixedSize(bestSize);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::constrainSize()\n  {\n      Incrementor dummy(&m_resizeInProgress);\n  \n      if (!(m_scrollParent && page() && page()->mainFrame()))\n          return; // should not happen but who knows\n  \n      // Prevent expensive operation where a resize triggers one extra resizing operation.\n      // This is very visible on large attachments, and in fact could possibly lead to recursion as the\n      // contentsSizeChanged signal is connected to handlePageLoadFinished.\n      if (m_resizeInProgress > 1)\n          return;\n  \n      // the m_scrollParentPadding measures the summed up horizontal paddings of this view compared to\n      // its m_scrollParent\n      setMinimumSize(0,0);\n      setMaximumSize(QWIDGETSIZE_MAX, QWIDGETSIZE_MAX);\n      // resize so that the viewport has much vertical and wanted horizontal space\n      resize(m_scrollParent->width() - m_scrollParentPadding, QWIDGETSIZE_MAX);\n      // resize the PAGES viewport to this width and a minimum height\n      page()->setViewportSize(QSize(m_scrollParent->width() - m_scrollParentPadding, 32));\n      // now the page has an idea about it's demanded size\n      const QSize bestSize = page()->mainFrame()->contentsSize();\n      // set the viewport to that size! - Otherwise it'd still be our \"suggestion\"\n      page()->setViewportSize(bestSize);\n      // fix the widgets size so the layout doesn't have much choice\n      setFixedSize(bestSize);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::handlePageLoadFinished()\n  {\n      constrainSize();\n  \n      // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n      // Let's do it again here, it works.\n      Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n      page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n      page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n      page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n  }\n}"
  },
  {
    "function_name": "slotLinkClicked(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "137-150",
    "snippet": "oid EmbeddedWebView::slotLinkClicked(const QUrl &url)\n{\n    // Only allow external http:// and https:// links for safety reasons\n    if (url.scheme().toLower() == QLatin1String(\"http\") || url.scheme().toLower() == QLatin1String(\"https\")) {\n        QDesktopServices::openUrl(url);\n    } else if (url.scheme().toLower() == QLatin1String(\"mailto\")) {\n        // The mailto: scheme is registered by Gui::MainWindow and handled internally;\n        // even if it wasn't, opening a third-party application in response to a\n        // user-initiated click does not pose a security risk\n        QUrl betterUrl(url);\n        betterUrl.setScheme(url.scheme().toLower());\n        QDesktopServices::openUrl(betterUrl);\n    }\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DesktopServices::openUrl(",
          "args": [
            "etterUrl)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etterUrl.setScheme",
          "args": [
            "rl.scheme().toLower())"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mailto\")"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DesktopServices::openUrl(",
          "args": [
            "rl)"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "https\")"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "http\")"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::slotLinkClicked(const QUrl &url)\n  {\n      // Only allow external http:// and https:// links for safety reasons\n      if (url.scheme().toLower() == QLatin1String(\"http\") || url.scheme().toLower() == QLatin1String(\"https\")) {\n          QDesktopServices::openUrl(url);\n      } else if (url.scheme().toLower() == QLatin1String(\"mailto\")) {\n          // The mailto: scheme is registered by Gui::MainWindow and handled internally;\n          // even if it wasn't, opening a third-party application in response to a\n          // user-initiated click does not pose a security risk\n          QUrl betterUrl(url);\n          betterUrl.setScheme(url.scheme().toLower());\n          QDesktopServices::openUrl(betterUrl);\n      }\n  }\n}"
  },
  {
    "function_name": "constrainSize(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "108-135",
    "snippet": "oid EmbeddedWebView::constrainSize()\n{\n    Incrementor dummy(&m_resizeInProgress);\n\n    if (!(m_scrollParent && page() && page()->mainFrame()))\n        return; // should not happen but who knows\n\n    // Prevent expensive operation where a resize triggers one extra resizing operation.\n    // This is very visible on large attachments, and in fact could possibly lead to recursion as the\n    // contentsSizeChanged signal is connected to handlePageLoadFinished.\n    if (m_resizeInProgress > 1)\n        return;\n\n    // the m_scrollParentPadding measures the summed up horizontal paddings of this view compared to\n    // its m_scrollParent\n    setMinimumSize(0,0);\n    setMaximumSize(QWIDGETSIZE_MAX, QWIDGETSIZE_MAX);\n    // resize so that the viewport has much vertical and wanted horizontal space\n    resize(m_scrollParent->width() - m_scrollParentPadding, QWIDGETSIZE_MAX);\n    // resize the PAGES viewport to this width and a minimum height\n    page()->setViewportSize(QSize(m_scrollParent->width() - m_scrollParentPadding, 32));\n    // now the page has an idea about it's demanded size\n    const QSize bestSize = page()->mainFrame()->contentsSize();\n    // set the viewport to that size! - Otherwise it'd still be our \"suggestion\"\n    page()->setViewportSize(bestSize);\n    // fix the widgets size so the layout doesn't have much choice\n    setFixedSize(bestSize);\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etFixedSize(",
          "args": [
            "estSize)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "age",
          "args": [
            "estSize)"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "supportsExtension(",
          "container": "rrorCheckingPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "235-243",
          "snippet": "ool ErrorCheckingPage::supportsExtension(Extension extension) const\n{\n#if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n    if (extension == ErrorPageExtension)\n        return true;\n    else\n#endif\n        return false;\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nrrorCheckingPage {\n  ool ErrorCheckingPage::supportsExtension(Extension extension) const\n  {\n  #if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n      if (extension == ErrorPageExtension)\n          return true;\n      else\n  #endif\n          return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age(",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessage(",
          "container": "implePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
          "lines": "227-240",
          "snippet": "oid SimplePartWidget::slotDownloadMessage()\n{\n    QModelIndex index;\n    if (m_partIndex.isValid()) {\n        index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n    }\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadMessage();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include <QWebFrame>",
            "include <QNetworkReply>\n#",
            "include <QFileDialog>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadMessage()\n  {\n      QModelIndex index;\n      if (m_partIndex.isValid()) {\n          index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n      }\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadMessage();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "handlePageLoadFinished(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "152-162",
          "snippet": "oid EmbeddedWebView::handlePageLoadFinished()\n{\n    constrainSize();\n\n    // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n    // Let's do it again here, it works.\n    Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n    page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::handlePageLoadFinished()\n  {\n      constrainSize();\n  \n      // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n      // Let's do it again here, it works.\n      Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n      page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n      page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n      page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Size(",
          "args": [
            "_scrollParent->width() - m_scrollParentPadding,",
            "2)"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "prettySize(",
          "container": "rettySize",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Utils.cpp",
          "lines": "50-76",
          "snippet": "String PrettySize::prettySize(uint bytes, const ShowBytesSuffix compactUnitFormat)\n{\n    if (bytes == 0) {\n        return tr(\"0\");\n    }\n    int order = std::log(static_cast<double>(bytes)) / std::log(1024.0);\n    double number = bytes / std::pow(1024.0, order);\n\n    QString suffix;\n    if (order <= 0) {\n        if (compactUnitFormat == COMPACT_FORM)\n            return QString::number(bytes);\n        else\n            return tr(\"%1 bytes\").arg(QString::number(bytes));\n    } else if (order == 1) {\n        suffix = tr(\"kB\");\n    } else if (order == 2) {\n        suffix = tr(\"MB\");\n    } else if (order == 3) {\n        suffix = tr(\"GB\");\n    } else {\n        // make sure not to show wrong size for those that have > 1024 TB e-mail messages\n        order = 4;\n        suffix = tr(\"TB\"); // shame on you for such mails\n    }\n    return tr(\"%1 %2\").arg(QString::number(number, 'f', number < 100 ? 1 : 0), suffix);\n}",
          "includes": [
            "include <QSystemDeviceInfo>\n#",
            "include \"Imap/Model/Model.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include <QTextDocument>",
            "include <QSysInfo>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSettings>\n#",
            "include <QProcess>\n#",
            "include <QLocale>\n#",
            "include <QGuiApplication>\n#",
            "include <QDir>\n#",
            "include <QDateTime>\n#",
            "include <cmath>\n#",
            "include \"Utils.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QSystemDeviceInfo>\n#\ninclude \"Imap/Model/Model.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude <QTextDocument>\ninclude <QSysInfo>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSettings>\n#\ninclude <QProcess>\n#\ninclude <QLocale>\n#\ninclude <QGuiApplication>\n#\ninclude <QDir>\n#\ninclude <QDateTime>\n#\ninclude <cmath>\n#\ninclude \"Utils.h\"\n#\n\nrettySize {\n  String PrettySize::prettySize(uint bytes, const ShowBytesSuffix compactUnitFormat)\n  {\n      if (bytes == 0) {\n          return tr(\"0\");\n      }\n      int order = std::log(static_cast<double>(bytes)) / std::log(1024.0);\n      double number = bytes / std::pow(1024.0, order);\n  \n      QString suffix;\n      if (order <= 0) {\n          if (compactUnitFormat == COMPACT_FORM)\n              return QString::number(bytes);\n          else\n              return tr(\"%1 bytes\").arg(QString::number(bytes));\n      } else if (order == 1) {\n          suffix = tr(\"kB\");\n      } else if (order == 2) {\n          suffix = tr(\"MB\");\n      } else if (order == 3) {\n          suffix = tr(\"GB\");\n      } else {\n          // make sure not to show wrong size for those that have > 1024 TB e-mail messages\n          order = 4;\n          suffix = tr(\"TB\"); // shame on you for such mails\n      }\n      return tr(\"%1 %2\").arg(QString::number(number, 'f', number < 100 ? 1 : 0), suffix);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_scrollParent->width",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esize(",
          "args": [
            "_scrollParent->width() - m_scrollParentPadding,",
            "WIDGETSIZE_MAX)"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_scrollParent->width",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etMaximumSize(",
          "args": [
            "WIDGETSIZE_MAX,",
            "WIDGETSIZE_MAX)"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etMinimumSize(",
          "args": [
            ",",
            ")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::constrainSize()\n  {\n      Incrementor dummy(&m_resizeInProgress);\n  \n      if (!(m_scrollParent && page() && page()->mainFrame()))\n          return; // should not happen but who knows\n  \n      // Prevent expensive operation where a resize triggers one extra resizing operation.\n      // This is very visible on large attachments, and in fact could possibly lead to recursion as the\n      // contentsSizeChanged signal is connected to handlePageLoadFinished.\n      if (m_resizeInProgress > 1)\n          return;\n  \n      // the m_scrollParentPadding measures the summed up horizontal paddings of this view compared to\n      // its m_scrollParent\n      setMinimumSize(0,0);\n      setMaximumSize(QWIDGETSIZE_MAX, QWIDGETSIZE_MAX);\n      // resize so that the viewport has much vertical and wanted horizontal space\n      resize(m_scrollParent->width() - m_scrollParentPadding, QWIDGETSIZE_MAX);\n      // resize the PAGES viewport to this width and a minimum height\n      page()->setViewportSize(QSize(m_scrollParent->width() - m_scrollParentPadding, 32));\n      // now the page has an idea about it's demanded size\n      const QSize bestSize = page()->mainFrame()->contentsSize();\n      // set the viewport to that size! - Otherwise it'd still be our \"suggestion\"\n      page()->setViewportSize(bestSize);\n      // fix the widgets size so the layout doesn't have much choice\n      setFixedSize(bestSize);\n  }\n}"
  },
  {
    "function_name": "EmbeddedWebView(",
    "container": "mbeddedWebView",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "61-106",
    "snippet": "mbeddedWebView::EmbeddedWebView(QWidget *parent, QNetworkAccessManager *networkManager):\n    QWebView(parent), m_scrollParent(0L), m_resizeInProgress(0)\n{\n    // set to expanding, ie. \"freely\" - this is important so the widget will attempt to shrink below the sizehint!\n    setSizePolicy(QSizePolicy::Expanding, QSizePolicy::Expanding);\n    setFocusPolicy(Qt::StrongFocus); // not by the wheel\n    setPage(new ErrorCheckingPage(this));\n    page()->setNetworkAccessManager(networkManager);\n\n    QWebSettings *s = settings();\n    s->setAttribute(QWebSettings::JavascriptEnabled, false);\n    s->setAttribute(QWebSettings::JavaEnabled, false);\n    s->setAttribute(QWebSettings::PluginsEnabled, false);\n    s->setAttribute(QWebSettings::PrivateBrowsingEnabled, true);\n    s->setAttribute(QWebSettings::JavaEnabled, false);\n    s->setAttribute(QWebSettings::OfflineStorageDatabaseEnabled, false);\n    s->setAttribute(QWebSettings::OfflineWebApplicationCacheEnabled, false);\n    s->setAttribute(QWebSettings::LocalStorageDatabaseEnabled, false);\n    s->clearMemoryCaches();\n\n    page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n    connect(this, SIGNAL(linkClicked(QUrl)), this, SLOT(slotLinkClicked(QUrl)));\n    connect(this, SIGNAL(loadFinished(bool)), this, SLOT(handlePageLoadFinished()));\n    connect(page()->mainFrame(), SIGNAL(contentsSizeChanged(QSize)), this, SLOT(handlePageLoadFinished()));\n\n    // Scrolling is implemented on upper layers\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, Qt::ScrollBarAlwaysOff);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, Qt::ScrollBarAlwaysOff);\n\n    // Setup shortcuts for standard actions\n    QAction *copyAction = page()->action(QWebPage::Copy);\n    copyAction->setShortcut(tr(\"Ctrl+C\"));\n    addAction(copyAction);\n\n    // Redmine#3, the QWebView uses black text color when rendering stuff on dark background\n    QPalette palette = QApplication::palette();\n    if (palette.background().color().lightness() < 50) {\n        QStyle *style = QStyleFactory::create(QLatin1String(\"windows\"));\n        Q_ASSERT(style);\n        palette = style->standardPalette();\n        setPalette(palette);\n    }\n\n    setContextMenuPolicy(Qt::NoContextMenu);\n    findScrollParent();\n}",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "indScrollParent(",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "findScrollParent(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "178-212",
          "snippet": "oid EmbeddedWebView::findScrollParent()\n{\n    if (m_scrollParent)\n        m_scrollParent->removeEventFilter(this);\n    m_scrollParent = 0;\n    m_scrollParentPadding = 4;\n    QWidget *runner = this;\n    int left, top, right, bottom;\n    while (runner) {\n        runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n        runner->getContentsMargins(&left, &top, &right, &bottom);\n        m_scrollParentPadding += left + right + 4;\n        if (runner->layout()) {\n            runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right;\n        }\n        QWidget *p = runner->parentWidget();\n        if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n            p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n            qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n            p->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right + 4;\n            if (p->layout()) {\n                p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                m_scrollParentPadding += left + right;\n            }\n            m_scrollParent = p->parentWidget();\n            break; // then we have our actual message view\n        }\n        runner = p;\n    }\n    m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n    if (m_scrollParent)\n        m_scrollParent->installEventFilter(this);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::findScrollParent()\n  {\n      if (m_scrollParent)\n          m_scrollParent->removeEventFilter(this);\n      m_scrollParent = 0;\n      m_scrollParentPadding = 4;\n      QWidget *runner = this;\n      int left, top, right, bottom;\n      while (runner) {\n          runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n          runner->getContentsMargins(&left, &top, &right, &bottom);\n          m_scrollParentPadding += left + right + 4;\n          if (runner->layout()) {\n              runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right;\n          }\n          QWidget *p = runner->parentWidget();\n          if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n              p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n              qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n              p->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right + 4;\n              if (p->layout()) {\n                  p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                  m_scrollParentPadding += left + right;\n              }\n              m_scrollParent = p->parentWidget();\n              break; // then we have our actual message view\n          }\n          runner = p;\n      }\n      m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n      if (m_scrollParent)\n          m_scrollParent->installEventFilter(this);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "etContextMenuPolicy(",
          "args": [
            "t::NoContextMenu)"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etPalette(",
          "args": [
            "alette)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tyle->standardPalette",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "tyle)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StyleFactory::create(",
          "args": [
            "Latin1String(\"windows\"))"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "create(",
          "container": "arser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Parser.cpp",
          "lines": "208-211",
          "snippet": "ommandHandle Parser::create(const QString &mailbox)\n{\n    return queueCommand(Commands::Command(\"CREATE\") << encodeImapFolderName(mailbox));\n}",
          "includes": [
            "include \"../Model/Utils.h\"",
            "include \"../../Streams/IODeviceSocket.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Parser.h\"\n#",
            "include <QTimer>\n#",
            "include <QTime>\n#",
            "include <QSslError>\n#",
            "include <QProcess>\n#",
            "include <QMutexLocker>\n#",
            "include <QStringList>\n#",
            "include <QDebug>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Model/Utils.h\"\ninclude \"../../Streams/IODeviceSocket.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Parser.h\"\n#\ninclude <QTimer>\n#\ninclude <QTime>\n#\ninclude <QSslError>\n#\ninclude <QProcess>\n#\ninclude <QMutexLocker>\n#\ninclude <QStringList>\n#\ninclude <QDebug>\n#\ninclude <algorithm>\n#\n\narser {\n  ommandHandle Parser::create(const QString &mailbox)\n  {\n      return queueCommand(Commands::Command(\"CREATE\") << encodeImapFolderName(mailbox));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "windows\")"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.background",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.background",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.background",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::palette(",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddAction(",
          "args": [
            "opyAction)"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "opyAction->setShortcut",
          "args": [
            "r(\"Ctrl+C\"))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Ctrl+C\")"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "ncrementor(",
          "container": "ncrementor ",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "45-48",
          "snippet": "ncrementor(int *what): m_int(what)\n    {\n        ++(*m_int);\n    }",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nncrementor  {\n  ncrementor(int *what): m_int(what)\n      {\n          ++(*m_int);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age",
          "args": [
            "WebPage::Copy)"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "supportsExtension(",
          "container": "rrorCheckingPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "235-243",
          "snippet": "ool ErrorCheckingPage::supportsExtension(Extension extension) const\n{\n#if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n    if (extension == ErrorPageExtension)\n        return true;\n    else\n#endif\n        return false;\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nrrorCheckingPage {\n  ool ErrorCheckingPage::supportsExtension(Extension extension) const\n  {\n  #if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n      if (extension == ErrorPageExtension)\n          return true;\n      else\n  #endif\n          return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age(",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessage(",
          "container": "implePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
          "lines": "227-240",
          "snippet": "oid SimplePartWidget::slotDownloadMessage()\n{\n    QModelIndex index;\n    if (m_partIndex.isValid()) {\n        index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n    }\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadMessage();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include <QWebFrame>",
            "include <QNetworkReply>\n#",
            "include <QFileDialog>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadMessage()\n  {\n      QModelIndex index;\n      if (m_partIndex.isValid()) {\n          index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n      }\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadMessage();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age",
          "args": [
            "t::Vertical,",
            "t::ScrollBarAlwaysOff)"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "MessageSourceWidget",
          "container": "MessageSourceWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageSourceWidget.cpp",
          "lines": "32-48",
          "snippet": "MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n    QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n{\n    setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n    Q_ASSERT(messageIndex.isValid());\n    page()->setNetworkAccessManager(0);\n\n    m_loadingSpinner = new Spinner(this);\n    m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n    m_loadingSpinner->setType(Spinner::Sun);\n    m_loadingSpinner->start(250);\n\n    m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n    connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n    connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n    m_combiner->load();\n}",
          "includes": [
            "#include \"Imap/Model/FullMessageCombiner.h\"",
            "#include \"Gui/Spinner.h\"",
            "#include \"Gui/IconLoader.h\"",
            "#include <QModelIndex>",
            "#include \"MessageSourceWidget.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Imap/Model/FullMessageCombiner.h\"\n#include \"Gui/Spinner.h\"\n#include \"Gui/IconLoader.h\"\n#include <QModelIndex>\n#include \"MessageSourceWidget.h\"\n\nMessageSourceWidget {\n  MessageSourceWidget::MessageSourceWidget(QWidget *parent, const QModelIndex &messageIndex):\n      QWebView(parent), m_combiner(0), m_loadingSpinner(0)\n  {\n      setWindowIcon(loadIcon(QLatin1String(\"text-x-hex\")));\n      Q_ASSERT(messageIndex.isValid());\n      page()->setNetworkAccessManager(0);\n  \n      m_loadingSpinner = new Spinner(this);\n      m_loadingSpinner->setText(tr(\"Fetching\\nMessage\"));\n      m_loadingSpinner->setType(Spinner::Sun);\n      m_loadingSpinner->start(250);\n  \n      m_combiner = new Imap::Mailbox::FullMessageCombiner(messageIndex, this);\n      connect(m_combiner, SIGNAL(completed()), this, SLOT(slotCompleted()));\n      connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(slotError(QString)));\n      m_combiner->load();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "handlePageLoadFinished(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "152-162",
          "snippet": "oid EmbeddedWebView::handlePageLoadFinished()\n{\n    constrainSize();\n\n    // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n    // Let's do it again here, it works.\n    Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n    page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::handlePageLoadFinished()\n  {\n      constrainSize();\n  \n      // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n      // Let's do it again here, it works.\n      Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n      page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n      page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n      page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "age()->mainFrame(),",
            "IGNAL(contentsSizeChanged(QSize)),",
            "his,",
            "LOT(handlePageLoadFinished()))"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "andlePageLoadFinished())"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ontentsSizeChanged(QSize))"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ontentsSizeChanged(",
          "args": [
            "Size)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(linkClicked(QUrl)),",
            "his,",
            "LOT(slotLinkClicked(QUrl)))"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotLinkClicked(QUrl))"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotLinkClicked(",
          "args": [
            "Url)"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "slotLinkClicked(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "137-150",
          "snippet": "oid EmbeddedWebView::slotLinkClicked(const QUrl &url)\n{\n    // Only allow external http:// and https:// links for safety reasons\n    if (url.scheme().toLower() == QLatin1String(\"http\") || url.scheme().toLower() == QLatin1String(\"https\")) {\n        QDesktopServices::openUrl(url);\n    } else if (url.scheme().toLower() == QLatin1String(\"mailto\")) {\n        // The mailto: scheme is registered by Gui::MainWindow and handled internally;\n        // even if it wasn't, opening a third-party application in response to a\n        // user-initiated click does not pose a security risk\n        QUrl betterUrl(url);\n        betterUrl.setScheme(url.scheme().toLower());\n        QDesktopServices::openUrl(betterUrl);\n    }\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::slotLinkClicked(const QUrl &url)\n  {\n      // Only allow external http:// and https:// links for safety reasons\n      if (url.scheme().toLower() == QLatin1String(\"http\") || url.scheme().toLower() == QLatin1String(\"https\")) {\n          QDesktopServices::openUrl(url);\n      } else if (url.scheme().toLower() == QLatin1String(\"mailto\")) {\n          // The mailto: scheme is registered by Gui::MainWindow and handled internally;\n          // even if it wasn't, opening a third-party application in response to a\n          // user-initiated click does not pose a security risk\n          QUrl betterUrl(url);\n          betterUrl.setScheme(url.scheme().toLower());\n          QDesktopServices::openUrl(betterUrl);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "inkClicked(QUrl))"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->clearMemoryCaches",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setAttribute",
          "args": [
            "WebSettings::LocalStorageDatabaseEnabled,",
            "alse)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setAttribute",
          "args": [
            "WebSettings::OfflineWebApplicationCacheEnabled,",
            "alse)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setAttribute",
          "args": [
            "WebSettings::OfflineStorageDatabaseEnabled,",
            "alse)"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setAttribute",
          "args": [
            "WebSettings::JavaEnabled,",
            "alse)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setAttribute",
          "args": [
            "WebSettings::PrivateBrowsingEnabled,",
            "rue)"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setAttribute",
          "args": [
            "WebSettings::PluginsEnabled,",
            "alse)"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setAttribute",
          "args": [
            "WebSettings::JavaEnabled,",
            "alse)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setAttribute",
          "args": [
            "WebSettings::JavascriptEnabled,",
            "alse)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ettings(",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "slotShowSettings()\n{",
          "container": "ow",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1055-1074",
          "snippet": "nWindow::slotShowSettings()\n{\n    SettingsDialog *dialog = new SettingsDialog(this, m_senderIdentities, m_settings);\n    if (dialog->exec() == QDialog::Accepted) {\n        // FIXME: wipe cache in case we're moving between servers\n        nukeModels();\n        setupModels();\n        connectModelActions();\n        // The systray is still connected to the old model -- got to make sure it's getting updated\n        removeSysTray();\n        slotToggleSysTray();\n    }\n    QString method = m_settings->value(Common::SettingsNames::imapMethodKey).toString();\n    if (method != Common::SettingsNames::methodTCP && method != Common::SettingsNames::methodSSL &&\n            method != Common::SettingsNames::methodProcess ) {\n        QMessageBox::critical(this, tr(\"No Configuration\"),\n                              trUtf8(\"No IMAP account is configured. Trojit cannot do much without one.\"));\n    }\n    applySizesAndState();\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\now {\n  nWindow::slotShowSettings()\n  {\n      SettingsDialog *dialog = new SettingsDialog(this, m_senderIdentities, m_settings);\n      if (dialog->exec() == QDialog::Accepted) {\n          // FIXME: wipe cache in case we're moving between servers\n          nukeModels();\n          setupModels();\n          connectModelActions();\n          // The systray is still connected to the old model -- got to make sure it's getting updated\n          removeSysTray();\n          slotToggleSysTray();\n      }\n      QString method = m_settings->value(Common::SettingsNames::imapMethodKey).toString();\n      if (method != Common::SettingsNames::methodTCP && method != Common::SettingsNames::methodSSL &&\n              method != Common::SettingsNames::methodProcess ) {\n          QMessageBox::critical(this, tr(\"No Configuration\"),\n                                trUtf8(\"No IMAP account is configured. Trojit cannot do much without one.\"));\n      }\n      applySizesAndState();\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "etPage(",
          "args": [
            "ew ErrorCheckingPage(this))"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etFocusPolicy(",
          "args": [
            "t::StrongFocus)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etSizePolicy(",
          "args": [
            "SizePolicy::Expanding,",
            "SizePolicy::Expanding)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  mbeddedWebView::EmbeddedWebView(QWidget *parent, QNetworkAccessManager *networkManager):\n      QWebView(parent), m_scrollParent(0L), m_resizeInProgress(0)\n  {\n      // set to expanding, ie. \"freely\" - this is important so the widget will attempt to shrink below the sizehint!\n      setSizePolicy(QSizePolicy::Expanding, QSizePolicy::Expanding);\n      setFocusPolicy(Qt::StrongFocus); // not by the wheel\n      setPage(new ErrorCheckingPage(this));\n      page()->setNetworkAccessManager(networkManager);\n  \n      QWebSettings *s = settings();\n      s->setAttribute(QWebSettings::JavascriptEnabled, false);\n      s->setAttribute(QWebSettings::JavaEnabled, false);\n      s->setAttribute(QWebSettings::PluginsEnabled, false);\n      s->setAttribute(QWebSettings::PrivateBrowsingEnabled, true);\n      s->setAttribute(QWebSettings::JavaEnabled, false);\n      s->setAttribute(QWebSettings::OfflineStorageDatabaseEnabled, false);\n      s->setAttribute(QWebSettings::OfflineWebApplicationCacheEnabled, false);\n      s->setAttribute(QWebSettings::LocalStorageDatabaseEnabled, false);\n      s->clearMemoryCaches();\n  \n      page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n      connect(this, SIGNAL(linkClicked(QUrl)), this, SLOT(slotLinkClicked(QUrl)));\n      connect(this, SIGNAL(loadFinished(bool)), this, SLOT(handlePageLoadFinished()));\n      connect(page()->mainFrame(), SIGNAL(contentsSizeChanged(QSize)), this, SLOT(handlePageLoadFinished()));\n  \n      // Scrolling is implemented on upper layers\n      page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, Qt::ScrollBarAlwaysOff);\n      page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, Qt::ScrollBarAlwaysOff);\n  \n      // Setup shortcuts for standard actions\n      QAction *copyAction = page()->action(QWebPage::Copy);\n      copyAction->setShortcut(tr(\"Ctrl+C\"));\n      addAction(copyAction);\n  \n      // Redmine#3, the QWebView uses black text color when rendering stuff on dark background\n      QPalette palette = QApplication::palette();\n      if (palette.background().color().lightness() < 50) {\n          QStyle *style = QStyleFactory::create(QLatin1String(\"windows\"));\n          Q_ASSERT(style);\n          palette = style->standardPalette();\n          setPalette(palette);\n      }\n  \n      setContextMenuPolicy(Qt::NoContextMenu);\n      findScrollParent();\n  }\n}"
  },
  {
    "function_name": "ncrementor(",
    "container": "ncrementor ",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
    "lines": "45-48",
    "snippet": "ncrementor(int *what): m_int(what)\n    {\n        ++(*m_int);\n    }",
    "includes": [
      "include <QDebug>",
      "include <QWebHistory>",
      "include <QWebFrame>\n#",
      "include <QStyleFactory>\n#",
      "include <QStyle>\n#",
      "include <QNetworkReply>\n#",
      "include <QLayout>\n#",
      "include <QDesktopServices>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include <QAbstractScrollArea>\n#",
      "include \"Gui/Util.h\"",
      "include \"MessageView.h\"\n#",
      "include \"EmbeddedWebView.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nncrementor  {\n  ncrementor(int *what): m_int(what)\n      {\n          ++(*m_int);\n      }\n}"
  }
]