[
  {
    "function_name": "slotDownloadMessage(",
    "container": "implePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
    "lines": "227-240",
    "snippet": "oid SimplePartWidget::slotDownloadMessage()\n{\n    QModelIndex index;\n    if (m_partIndex.isValid()) {\n        index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n    }\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadMessage();\n}",
    "includes": [
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Encoders.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include <QWebFrame>",
      "include <QNetworkReply>\n#",
      "include <QFileDialog>\n#",
      "include <QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "anager->downloadMessage",
          "args": [],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "downloadMessage(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "85-108",
          "snippet": "oid FileDownloadManager::downloadMessage()\n{\n    if (!partIndex.isValid()) {\n        emit transferError(tr(\"FileDownloadManager::downloadMessage(): message has disappeared\"));\n        return;\n    }\n    QString saveFileName = toRealFileName(partIndex);\n    Q_ASSERT(!m_combiner);\n    m_combiner = new Imap::Mailbox::FullMessageCombiner(partIndex, this);\n\n    emit fileNameRequested(&saveFileName);\n    if (saveFileName.isEmpty()) {\n        emit cancelled();\n        return;\n    }\n\n    saving.setFileName(saveFileName);\n    saved = false;\n    connect(m_combiner, SIGNAL(completed()), this, SLOT(onMessageDataTransferred()));\n    connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(onCombinerTransferError(QString)));\n    connect(m_combiner, SIGNAL(completed()), m_combiner, SLOT(deleteLater()), Qt::QueuedConnection);\n    connect(m_combiner, SIGNAL(failed(QString)), m_combiner, SLOT(deleteLater()), Qt::QueuedConnection);\n    m_combiner->load();\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::downloadMessage()\n  {\n      if (!partIndex.isValid()) {\n          emit transferError(tr(\"FileDownloadManager::downloadMessage(): message has disappeared\"));\n          return;\n      }\n      QString saveFileName = toRealFileName(partIndex);\n      Q_ASSERT(!m_combiner);\n      m_combiner = new Imap::Mailbox::FullMessageCombiner(partIndex, this);\n  \n      emit fileNameRequested(&saveFileName);\n      if (saveFileName.isEmpty()) {\n          emit cancelled();\n          return;\n      }\n  \n      saving.setFileName(saveFileName);\n      saved = false;\n      connect(m_combiner, SIGNAL(completed()), this, SLOT(onMessageDataTransferred()));\n      connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(onCombinerTransferError(QString)));\n      connect(m_combiner, SIGNAL(completed()), m_combiner, SLOT(deleteLater()), Qt::QueuedConnection);\n      connect(m_combiner, SIGNAL(failed(QString)), m_combiner, SLOT(deleteLater()), Qt::QueuedConnection);\n      m_combiner->load();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(succeeded()),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ucceeded())"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ucceeded(",
          "args": [],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendSucceeded(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "347-364",
          "snippet": "oid Submission::slotAppendSucceeded()\n{\n    if (m_appendUid && m_appendUidValidity) {\n        // Only ever consider valid UIDVALIDITY/UID pair\n        m_appendUidReceived = true;\n\n        if (m_useBurl) {\n            slotAskForUrl();\n        } else {\n            slotInvokeMsaNow();\n        }\n    } else {\n        m_useBurl = false;\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                          QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n        slotInvokeMsaNow();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendSucceeded()\n  {\n      if (m_appendUid && m_appendUidValidity) {\n          // Only ever consider valid UIDVALIDITY/UID pair\n          m_appendUidReceived = true;\n  \n          if (m_useBurl) {\n              slotAskForUrl();\n          } else {\n              slotInvokeMsaNow();\n          }\n      } else {\n          m_useBurl = false;\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                            QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n          slotInvokeMsaNow();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ransferError(",
          "args": [
            "String)"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadTransferError(const QS",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1696-1700",
          "snippet": "Window::slotDownloadTransferError(const QString &errorString)\n{\n    QMessageBox::critical(this, tr(\"Can't save into file\"),\n                          tr(\"Unable to save into file. Error:\\n%1\").arg(errorString));\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotDownloadTransferError(const QString &errorString)\n  {\n      QMessageBox::critical(this, tr(\"Can't save into file\"),\n                            tr(\"Unable to save into file. Error:\\n%1\").arg(errorString));\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "_messageView,",
            "IGNAL(transferError(QString)))"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::Mailbox::Model::findMessageForItem(",
          "args": [
            "map::deproxifiedIndex(m_partIndex))"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::deproxifiedIndex(",
          "args": [
            "_partIndex)"
          ],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_partIndex.isValid",
          "args": [],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadMessage()\n  {\n      QModelIndex index;\n      if (m_partIndex.isValid()) {\n          index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n      }\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadMessage();\n  }\n}"
  },
  {
    "function_name": "slotDownloadPart(",
    "container": "implePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
    "lines": "217-225",
    "snippet": "oid SimplePartWidget::slotDownloadPart()\n{\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, m_partIndex);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadPart();\n}",
    "includes": [
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Encoders.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include <QWebFrame>",
      "include <QNetworkReply>\n#",
      "include <QFileDialog>\n#",
      "include <QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "anager->downloadPart",
          "args": [],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "downloadPart(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "57-83",
          "snippet": "oid FileDownloadManager::downloadPart()\n{\n    if (!partIndex.isValid()) {\n        emit transferError(tr(\"FileDownloadManager::downloadPart(): part has disappeared\"));\n        return;\n    }\n    QString saveFileName = toRealFileName(partIndex);\n    emit fileNameRequested(&saveFileName);\n    if (saveFileName.isEmpty()) {\n        emit cancelled();\n        return;\n    }\n\n    saving.setFileName(saveFileName);\n    saved = false;\n\n    QNetworkRequest request;\n    QUrl url;\n    url.setScheme(QLatin1String(\"trojita-imap\"));\n    url.setHost(QLatin1String(\"msg\"));\n    url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n    request.setUrl(url);\n    reply = manager->get(request);\n    connect(reply, SIGNAL(finished()), this, SLOT(onPartDataTransfered()));\n    connect(reply, SIGNAL(error(QNetworkReply::NetworkError)), this, SLOT(onReplyTransferError()));\n    connect(manager, SIGNAL(finished(QNetworkReply *)), this, SLOT(deleteReply(QNetworkReply *)));\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::downloadPart()\n  {\n      if (!partIndex.isValid()) {\n          emit transferError(tr(\"FileDownloadManager::downloadPart(): part has disappeared\"));\n          return;\n      }\n      QString saveFileName = toRealFileName(partIndex);\n      emit fileNameRequested(&saveFileName);\n      if (saveFileName.isEmpty()) {\n          emit cancelled();\n          return;\n      }\n  \n      saving.setFileName(saveFileName);\n      saved = false;\n  \n      QNetworkRequest request;\n      QUrl url;\n      url.setScheme(QLatin1String(\"trojita-imap\"));\n      url.setHost(QLatin1String(\"msg\"));\n      url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n      request.setUrl(url);\n      reply = manager->get(request);\n      connect(reply, SIGNAL(finished()), this, SLOT(onPartDataTransfered()));\n      connect(reply, SIGNAL(error(QNetworkReply::NetworkError)), this, SLOT(onReplyTransferError()));\n      connect(manager, SIGNAL(finished(QNetworkReply *)), this, SLOT(deleteReply(QNetworkReply *)));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(succeeded()),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ucceeded())"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ucceeded(",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendSucceeded(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "347-364",
          "snippet": "oid Submission::slotAppendSucceeded()\n{\n    if (m_appendUid && m_appendUidValidity) {\n        // Only ever consider valid UIDVALIDITY/UID pair\n        m_appendUidReceived = true;\n\n        if (m_useBurl) {\n            slotAskForUrl();\n        } else {\n            slotInvokeMsaNow();\n        }\n    } else {\n        m_useBurl = false;\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                          QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n        slotInvokeMsaNow();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendSucceeded()\n  {\n      if (m_appendUid && m_appendUidValidity) {\n          // Only ever consider valid UIDVALIDITY/UID pair\n          m_appendUidReceived = true;\n  \n          if (m_useBurl) {\n              slotAskForUrl();\n          } else {\n              slotInvokeMsaNow();\n          }\n      } else {\n          m_useBurl = false;\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                            QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n          slotInvokeMsaNow();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "anager,",
            "LOT(deleteLater()))"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ransferError(",
          "args": [
            "String)"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadTransferError(const QS",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1696-1700",
          "snippet": "Window::slotDownloadTransferError(const QString &errorString)\n{\n    QMessageBox::critical(this, tr(\"Can't save into file\"),\n                          tr(\"Unable to save into file. Error:\\n%1\").arg(errorString));\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotDownloadTransferError(const QString &errorString)\n  {\n      QMessageBox::critical(this, tr(\"Can't save into file\"),\n                            tr(\"Unable to save into file. Error:\\n%1\").arg(errorString));\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "anager,",
            "IGNAL(transferError(QString)),",
            "_messageView,",
            "IGNAL(transferError(QString)))"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ransferError(QString))"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadPart()\n  {\n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, m_partIndex);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadPart();\n  }\n}"
  },
  {
    "function_name": "contextMenuSpecificActions(",
    "container": "implePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
    "lines": "212-215",
    "snippet": "List<QAction *> SimplePartWidget::contextMenuSpecificActions() const\n{\n    return QList<QAction*>() << m_savePart << m_saveMessage << m_findAction;\n}",
    "includes": [
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Encoders.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include <QWebFrame>",
      "include <QNetworkReply>\n#",
      "include <QFileDialog>\n#",
      "include <QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "List<QAction*>",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "newTagRequested",
          "container": "TagListWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/TagListWidget.cpp",
          "lines": "74-87",
          "snippet": "void TagListWidget::newTagRequested()\n{\n    QString tag = QInputDialog::getText(this, tr(\"New Label\"), tr(\"Label name:\"));\n    if (tag.isEmpty()) {\n        return;\n    }\n    if (m_ignoredFlags.contains(tag.toLower())) {\n        QMessageBox::warning(this, tr(\"Invalid tag value\"),\n                             tr(\"Tag name %1 is a reserved name which cannot be manipulated this way.\").arg(tag));\n        return;\n    }\n\n    emit tagAdded(tag);\n}",
          "includes": [
            "#include \"TagWidget.h\"",
            "#include \"FlowLayout.h\"",
            "#include \"TagListWidget.h\"",
            "#include <QPushButton>",
            "#include <QMessageBox>",
            "#include <QLabel>",
            "#include <QInputDialog>",
            "#include <QHBoxLayout>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"TagWidget.h\"\n#include \"FlowLayout.h\"\n#include \"TagListWidget.h\"\n#include <QPushButton>\n#include <QMessageBox>\n#include <QLabel>\n#include <QInputDialog>\n#include <QHBoxLayout>\n\nTagListWidget {\n  void TagListWidget::newTagRequested()\n  {\n      QString tag = QInputDialog::getText(this, tr(\"New Label\"), tr(\"Label name:\"));\n      if (tag.isEmpty()) {\n          return;\n      }\n      if (m_ignoredFlags.contains(tag.toLower())) {\n          QMessageBox::warning(this, tr(\"Invalid tag value\"),\n                               tr(\"Tag name %1 is a reserved name which cannot be manipulated this way.\").arg(tag));\n          return;\n      }\n  \n      emit tagAdded(tag);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  List<QAction *> SimplePartWidget::contextMenuSpecificActions() const\n  {\n      return QList<QAction*>() << m_savePart << m_saveMessage << m_findAction;\n  }\n}"
  },
  {
    "function_name": "reloadContents(",
    "container": "implePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
    "lines": "207-210",
    "snippet": "oid SimplePartWidget::reloadContents()\n{\n    EmbeddedWebView::reload();\n}",
    "includes": [
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Encoders.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include <QWebFrame>",
      "include <QNetworkReply>\n#",
      "include <QFileDialog>\n#",
      "include <QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mbeddedWebView::reload(",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::reloadContents()\n  {\n      EmbeddedWebView::reload();\n  }\n}"
  },
  {
    "function_name": "quoteMe(",
    "container": "implePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
    "lines": "198-205",
    "snippet": "String SimplePartWidget::quoteMe() const\n{\n    QString selection = selectedText();\n    if (selection.isEmpty())\n        return page()->mainFrame()->toPlainText();\n    else\n        return selection;\n}",
    "includes": [
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Encoders.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include <QWebFrame>",
      "include <QNetworkReply>\n#",
      "include <QFileDialog>\n#",
      "include <QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "age",
          "args": [],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessage(",
          "container": "implePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
          "lines": "227-240",
          "snippet": "oid SimplePartWidget::slotDownloadMessage()\n{\n    QModelIndex index;\n    if (m_partIndex.isValid()) {\n        index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n    }\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadMessage();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include <QWebFrame>",
            "include <QNetworkReply>\n#",
            "include <QFileDialog>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadMessage()\n  {\n      QModelIndex index;\n      if (m_partIndex.isValid()) {\n          index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n      }\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadMessage();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "election.isEmpty",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "electedText(",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  String SimplePartWidget::quoteMe() const\n  {\n      QString selection = selectedText();\n      if (selection.isEmpty())\n          return page()->mainFrame()->toPlainText();\n      else\n          return selection;\n  }\n}"
  },
  {
    "function_name": "slotFileNameRequested(",
    "container": "implePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
    "lines": "190-196",
    "snippet": "oid SimplePartWidget::slotFileNameRequested(QString *fileName)\n{\n    *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Attachment\"),\n                *fileName, QString(),\n                0, QFileDialog::HideNameFilterDetails\n                                            );\n}",
    "includes": [
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Encoders.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include <QWebFrame>",
      "include <QNetworkReply>\n#",
      "include <QFileDialog>\n#",
      "include <QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FileDialog::getSaveFileName(",
          "args": [
            "his,",
            "r(\"Save Attachment\"),",
            "fileName,",
            "String(),",
            ",",
            "FileDialog::HideNameFilterDetails"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Save Attachment\")"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotFileNameRequested(QString *fileName)\n  {\n      *fileName = QFileDialog::getSaveFileName(this, tr(\"Save Attachment\"),\n                  *fileName, QString(),\n                  0, QFileDialog::HideNameFilterDetails\n                                              );\n  }\n}"
  },
  {
    "function_name": "slotMarkupPlainText(",
    "container": "implePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
    "lines": "99-188",
    "snippet": "oid SimplePartWidget::slotMarkupPlainText()\n{\n    // NOTICE \"single shot\", we get a recursion otherwise!\n    disconnect(this, SIGNAL(loadFinished(bool)), this, SLOT(slotMarkupPlainText()));\n\n    // If there's no data, don't try to \"fix it up\"\n    if (!m_partIndex.isValid() || !m_partIndex.data(Imap::Mailbox::RoleIsFetched).toBool())\n        return;\n\n    static const QString defaultStyle = QString::fromUtf8(\n        \"pre{word-wrap: break-word; white-space: pre-wrap;}\"\n        // The following line, sadly, produces a warning \"QFont::setPixelSize: Pixel size <= 0 (0)\".\n        // However, if it is not in place or if the font size is set higher, even to 0.1px, WebKit reserves space for the\n        // quotation characters and therefore a weird white area appears. Even width: 0px doesn't help, so it looks like\n        // we will have to live with this warning for the time being.\n        \".quotemarks{color:transparent;font-size:0px;}\"\n\n        // Cannot really use the :dir(rtl) selector for putting the quote indicator to the \"correct\" side.\n        // It's CSS4 and it isn't supported yet.\n        \"blockquote{font-size:90%; margin: 4pt 0 4pt 0; padding: 0 0 0 1em; border-left: 2px solid %1; unicode-bidi: -webkit-plaintext}\"\n\n        // Stop the font size from getting smaller after reaching two levels of quotes\n        // (ie. starting on the third level, don't make the size any smaller than what it already is)\n        \"blockquote blockquote blockquote {font-size: 100%}\"\n        \".signature{opacity: 0.6;}\"\n\n        // Dynamic quote collapsing via pure CSS, yay\n        \"input {display: none}\"\n        \"input ~ span.full {display: block}\"\n        \"input ~ span.short {display: none}\"\n        \"input:checked ~ span.full {display: none}\"\n        \"input:checked ~ span.short {display: block}\"\n        \"label {border: 1px solid %2; border-radius: 5px; padding: 0px 4px 0px 4px; white-space: nowrap}\"\n        // BLACK UP-POINTING SMALL TRIANGLE (U+25B4)\n        // BLACK DOWN-POINTING SMALL TRIANGLE (U+25BE)\n        \"span.full > blockquote > label:before {content: \\\"\\u25b4\\\"}\"\n        \"span.short > blockquote > label:after {content: \\\" \\u25be\\\"}\"\n        \"span.shortquote > blockquote > label {display: none}\"\n    );\n\n    QFontInfo monospaceInfo(Gui::Util::systemMonospaceFont());\n    QString fontSpecification(QLatin1String(\"pre{\"));\n    if (monospaceInfo.italic())\n        fontSpecification += QLatin1String(\"font-style: italic; \");\n    if (monospaceInfo.bold())\n        fontSpecification += QLatin1String(\"font-weight: bold; \");\n    fontSpecification += QString::fromUtf8(\"font-size: %1px; font-family: \\\"%2\\\", monospace }\").arg(\n                QString::number(monospaceInfo.pixelSize()), monospaceInfo.family());\n\n    QPalette palette = QApplication::palette();\n    QString textColors = QString::fromUtf8(\"body { background-color: %1; color: %2 }\"\n                                           \"a:link { color: %3 } a:visited { color: %4 } a:hover { color: %3 }\").arg(\n                palette.base().color().name(), palette.text().color().name(),\n                palette.link().color().name(), palette.linkVisited().color().name());\n    // looks like there's no special color for hovered links in Qt\n\n    // build stylesheet and html header\n    QColor tintForQuoteIndicator = palette.base().color();\n    tintForQuoteIndicator.setAlpha(0x66);\n    static QString stylesheet = defaultStyle.arg(palette.link().color().name(),\n                                                 Gui::Util::tintColor(palette.text().color(), tintForQuoteIndicator).name());\n    static QFile file(Common::writablePath(Common::LOCATION_DATA) + QLatin1String(\"message.css\"));\n    static QDateTime lastVersion;\n    QDateTime lastTouched(file.exists() ? QFileInfo(file).lastModified() : QDateTime());\n    if (lastVersion < lastTouched) {\n        stylesheet = defaultStyle;\n        if (file.open(QIODevice::ReadOnly | QIODevice::Text)) {\n            const QString userSheet = QString::fromLocal8Bit(file.readAll().data());\n            lastVersion = lastTouched;\n            stylesheet += \"\\n\" + userSheet;\n            file.close();\n        }\n    }\n\n    // The dir=\"auto\" is required for WebKit to treat all paragraphs as entities with possibly different text direction.\n    // The individual paragraphs unfortunately share the same text alignment, though, as per\n    // https://bugs.webkit.org/show_bug.cgi?id=71194 (fixed in Blink already).\n    QString htmlHeader(\"<html><head><style type=\\\"text/css\\\"><!--\" + textColors + fontSpecification + stylesheet +\n                       \"--></style></head><body><pre dir=\\\"auto\\\">\");\n    static QString htmlFooter(\"\\n</pre></body></html>\");\n\n    // We cannot rely on the QWebFrame's toPlainText because of https://bugs.kde.org/show_bug.cgi?id=321160\n    QString markup = Composer::Util::plainTextToHtml(\n                Imap::decodeByteArray(m_partIndex.data(Imap::Mailbox::RolePartData).toByteArray(),\n                                      m_partIndex.data(Imap::Mailbox::RolePartCharset).toString()),\n                flowedFormat);\n\n    // and finally set the marked up page.\n    page()->mainFrame()->setHtml(htmlHeader + markup + htmlFooter);\n}",
    "includes": [
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Encoders.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include <QWebFrame>",
      "include <QNetworkReply>\n#",
      "include <QFileDialog>\n#",
      "include <QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "age",
          "args": [
            "tmlHeader + markup + htmlFooter)"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "slotError",
          "container": "MessageSourceWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageSourceWidget.cpp",
          "lines": "56-60",
          "snippet": "void MessageSourceWidget::slotError(const QString &message)\n{\n    m_loadingSpinner->stop();\n    setContent(message.toUtf8(), QLatin1String(\"text/plain; charset=utf-8\"));\n}",
          "includes": [
            "#include \"Imap/Model/FullMessageCombiner.h\"",
            "#include \"Gui/Spinner.h\"",
            "#include \"Gui/IconLoader.h\"",
            "#include <QModelIndex>",
            "#include \"MessageSourceWidget.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Imap/Model/FullMessageCombiner.h\"\n#include \"Gui/Spinner.h\"\n#include \"Gui/IconLoader.h\"\n#include <QModelIndex>\n#include \"MessageSourceWidget.h\"\n\nMessageSourceWidget {\n  void MessageSourceWidget::slotError(const QString &message)\n  {\n      m_loadingSpinner->stop();\n      setContent(message.toUtf8(), QLatin1String(\"text/plain; charset=utf-8\"));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "age",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessage(",
          "container": "implePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
          "lines": "227-240",
          "snippet": "oid SimplePartWidget::slotDownloadMessage()\n{\n    QModelIndex index;\n    if (m_partIndex.isValid()) {\n        index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n    }\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadMessage();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include <QWebFrame>",
            "include <QNetworkReply>\n#",
            "include <QFileDialog>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadMessage()\n  {\n      QModelIndex index;\n      if (m_partIndex.isValid()) {\n          index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n      }\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadMessage();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "omposer::Util::plainTextToHtml(",
          "args": [
            "map::decodeByteArray(m_partIndex.data(Imap::Mailbox::RolePartData).toByteArray(),\n                                      m_partIndex.data(Imap::Mailbox::RolePartCharset).toString()),",
            "lowedFormat)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::decodeByteArray(",
          "args": [
            "_partIndex.data(Imap::Mailbox::RolePartData).toByteArray(),",
            "_partIndex.data(Imap::Mailbox::RolePartCharset).toString())"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_partIndex.data",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_partIndex.data",
          "args": [
            "map::Mailbox::RolePartCharset)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_partIndex.data",
          "args": [
            "map::Mailbox::RolePartData)"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.close",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromLocal8Bit(",
          "args": [
            "ile.readAll().data())"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.readAll",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.readAll",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.open",
          "args": [
            "IODevice::ReadOnly | QIODevice::Text)"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTime(",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FileInfo",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FileInfo(",
          "args": [
            "ile)"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.exists",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "message.css\")"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ommon::writablePath(",
          "args": [
            "ommon::LOCATION_DATA)"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "efaultStyle.arg",
          "args": [
            "alette.link().color().name(),",
            "ui::Util::tintColor(palette.text().color(), tintForQuoteIndicator).name())"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui::Util::tintColor",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui::Util::tintColor(",
          "args": [
            "alette.text().color(),",
            "intForQuoteIndicator)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.text",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.text",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.link",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.link",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.link",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "intForQuoteIndicator.setAlpha",
          "args": [
            "x66)"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.base",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.base",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "alette.base().color().name(),",
            "alette.text().color().name(),",
            "alette.link().color().name(),",
            "alette.linkVisited().color().name())"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.linkVisited",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.linkVisited",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.linkVisited",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.link",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.link",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.link",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.text",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.text",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.text",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.base",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.base",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alette.base",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "body { background-color: %1; color: %2 }\"\n                                           \"a:link { color: %3 } a:visited { color: %4 } a:hover { color: %3 }\")"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::palette(",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "String::number(monospaceInfo.pixelSize()),",
            "onospaceInfo.family())"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onospaceInfo.family",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::number(",
          "args": [
            "onospaceInfo.pixelSize())"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onospaceInfo.pixelSize",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "font-size: %1px; font-family: \\\"%2\\\", monospace }\")"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "font-weight: bold; \")"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onospaceInfo.bold",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "font-style: italic; \")"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onospaceInfo.italic",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "pre{\")"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "pre{word-wrap: break-word; white-space: pre-wrap;}\"\n        // The following line, sadly, produces a warning \"QFont::setPixelSize: Pixel size <= 0 (0)\".\n        // However, if it is not in place or if the font size is set higher, even to 0.1px, WebKit reserves space for the\n        // quotation characters and therefore a weird white area appears. Even width: 0px doesn't help, so it looks like\n        // we will have to live with this warning for the time being.\n        \".quotemarks{color:transparent;font-size:0px;}\"\n\n        // Cannot really use the :dir(rtl) selector for putting the quote indicator to the \"correct\" side.\n        // It's CSS4 and it isn't supported yet.\n        \"blockquote{font-size:90%; margin: 4pt 0 4pt 0; padding: 0 0 0 1em; border-left: 2px solid %1; unicode-bidi: -webkit-plaintext}\"\n\n        // Stop the font size from getting smaller after reaching two levels of quotes\n        // (ie. starting on the third level, don't make the size any smaller than what it already is)\n        \"blockquote blockquote blockquote {font-size: 100%}\"\n        \".signature{opacity: 0.6;}\"\n\n        // Dynamic quote collapsing via pure CSS, yay\n        \"input {display: none}\"\n        \"input ~ span.full {display: block}\"\n        \"input ~ span.short {display: none}\"\n        \"input:checked ~ span.full {display: none}\"\n        \"input:checked ~ span.short {display: block}\"\n        \"label {border: 1px solid %2; border-radius: 5px; padding: 0px 4px 0px 4px; white-space: nowrap}\"\n        // BLACK UP-POINTING SMALL TRIANGLE (U+25B4)\n        // BLACK DOWN-POINTING SMALL TRIANGLE (U+25BE)\n        \"span.full > blockquote > label:before {content: \\\"\\u25b4\\\"}\"\n        \"span.short > blockquote > label:after {content: \\\" \\u25be\\\"}\"\n        \"span.shortquote > blockquote > label {display: none}\""
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_partIndex.data",
          "args": [
            "map::Mailbox::RoleIsFetched)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_partIndex.isValid",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotMarkupPlainText()\n  {\n      // NOTICE \"single shot\", we get a recursion otherwise!\n      disconnect(this, SIGNAL(loadFinished(bool)), this, SLOT(slotMarkupPlainText()));\n  \n      // If there's no data, don't try to \"fix it up\"\n      if (!m_partIndex.isValid() || !m_partIndex.data(Imap::Mailbox::RoleIsFetched).toBool())\n          return;\n  \n      static const QString defaultStyle = QString::fromUtf8(\n          \"pre{word-wrap: break-word; white-space: pre-wrap;}\"\n          // The following line, sadly, produces a warning \"QFont::setPixelSize: Pixel size <= 0 (0)\".\n          // However, if it is not in place or if the font size is set higher, even to 0.1px, WebKit reserves space for the\n          // quotation characters and therefore a weird white area appears. Even width: 0px doesn't help, so it looks like\n          // we will have to live with this warning for the time being.\n          \".quotemarks{color:transparent;font-size:0px;}\"\n  \n          // Cannot really use the :dir(rtl) selector for putting the quote indicator to the \"correct\" side.\n          // It's CSS4 and it isn't supported yet.\n          \"blockquote{font-size:90%; margin: 4pt 0 4pt 0; padding: 0 0 0 1em; border-left: 2px solid %1; unicode-bidi: -webkit-plaintext}\"\n  \n          // Stop the font size from getting smaller after reaching two levels of quotes\n          // (ie. starting on the third level, don't make the size any smaller than what it already is)\n          \"blockquote blockquote blockquote {font-size: 100%}\"\n          \".signature{opacity: 0.6;}\"\n  \n          // Dynamic quote collapsing via pure CSS, yay\n          \"input {display: none}\"\n          \"input ~ span.full {display: block}\"\n          \"input ~ span.short {display: none}\"\n          \"input:checked ~ span.full {display: none}\"\n          \"input:checked ~ span.short {display: block}\"\n          \"label {border: 1px solid %2; border-radius: 5px; padding: 0px 4px 0px 4px; white-space: nowrap}\"\n          // BLACK UP-POINTING SMALL TRIANGLE (U+25B4)\n          // BLACK DOWN-POINTING SMALL TRIANGLE (U+25BE)\n          \"span.full > blockquote > label:before {content: \\\"\\u25b4\\\"}\"\n          \"span.short > blockquote > label:after {content: \\\" \\u25be\\\"}\"\n          \"span.shortquote > blockquote > label {display: none}\"\n      );\n  \n      QFontInfo monospaceInfo(Gui::Util::systemMonospaceFont());\n      QString fontSpecification(QLatin1String(\"pre{\"));\n      if (monospaceInfo.italic())\n          fontSpecification += QLatin1String(\"font-style: italic; \");\n      if (monospaceInfo.bold())\n          fontSpecification += QLatin1String(\"font-weight: bold; \");\n      fontSpecification += QString::fromUtf8(\"font-size: %1px; font-family: \\\"%2\\\", monospace }\").arg(\n                  QString::number(monospaceInfo.pixelSize()), monospaceInfo.family());\n  \n      QPalette palette = QApplication::palette();\n      QString textColors = QString::fromUtf8(\"body { background-color: %1; color: %2 }\"\n                                             \"a:link { color: %3 } a:visited { color: %4 } a:hover { color: %3 }\").arg(\n                  palette.base().color().name(), palette.text().color().name(),\n                  palette.link().color().name(), palette.linkVisited().color().name());\n      // looks like there's no special color for hovered links in Qt\n  \n      // build stylesheet and html header\n      QColor tintForQuoteIndicator = palette.base().color();\n      tintForQuoteIndicator.setAlpha(0x66);\n      static QString stylesheet = defaultStyle.arg(palette.link().color().name(),\n                                                   Gui::Util::tintColor(palette.text().color(), tintForQuoteIndicator).name());\n      static QFile file(Common::writablePath(Common::LOCATION_DATA) + QLatin1String(\"message.css\"));\n      static QDateTime lastVersion;\n      QDateTime lastTouched(file.exists() ? QFileInfo(file).lastModified() : QDateTime());\n      if (lastVersion < lastTouched) {\n          stylesheet = defaultStyle;\n          if (file.open(QIODevice::ReadOnly | QIODevice::Text)) {\n              const QString userSheet = QString::fromLocal8Bit(file.readAll().data());\n              lastVersion = lastTouched;\n              stylesheet += \"\\n\" + userSheet;\n              file.close();\n          }\n      }\n  \n      // The dir=\"auto\" is required for WebKit to treat all paragraphs as entities with possibly different text direction.\n      // The individual paragraphs unfortunately share the same text alignment, though, as per\n      // https://bugs.webkit.org/show_bug.cgi?id=71194 (fixed in Blink already).\n      QString htmlHeader(\"<html><head><style type=\\\"text/css\\\"><!--\" + textColors + fontSpecification + stylesheet +\n                         \"--></style></head><body><pre dir=\\\"auto\\\">\");\n      static QString htmlFooter(\"\\n</pre></body></html>\");\n  \n      // We cannot rely on the QWebFrame's toPlainText because of https://bugs.kde.org/show_bug.cgi?id=321160\n      QString markup = Composer::Util::plainTextToHtml(\n                  Imap::decodeByteArray(m_partIndex.data(Imap::Mailbox::RolePartData).toByteArray(),\n                                        m_partIndex.data(Imap::Mailbox::RolePartCharset).toString()),\n                  flowedFormat);\n  \n      // and finally set the marked up page.\n      page()->mainFrame()->setHtml(htmlHeader + markup + htmlFooter);\n  }\n}"
  },
  {
    "function_name": "SimplePartWidget(",
    "container": "implePartWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
    "lines": "41-97",
    "snippet": "implePartWidget::SimplePartWidget(QWidget *parent, Imap::Network::MsgPartNetAccessManager *manager,\n                                   const QModelIndex &partIndex, MessageView *messageView):\n    EmbeddedWebView(parent, manager), m_partIndex(partIndex), m_messageView(messageView), m_netAccessManager(manager),\n    flowedFormat(Composer::Util::FORMAT_PLAIN)\n{\n    Q_ASSERT(partIndex.isValid());\n\n    if (m_messageView) {\n        connect(this, SIGNAL(loadStarted()), m_messageView, SLOT(onWebViewLoadStarted()));\n        connect(this, SIGNAL(loadFinished(bool)), m_messageView, SLOT(onWebViewLoadFinished()));\n    }\n\n    QUrl url;\n    url.setScheme(QLatin1String(\"trojita-imap\"));\n    url.setHost(QLatin1String(\"msg\"));\n    url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n    if (partIndex.data(Imap::Mailbox::RolePartMimeType).toString() == QLatin1String(\"text/plain\")\n            && partIndex.data(Imap::Mailbox::RolePartOctets).toUInt() < 100 * 1024) {\n        connect(this, SIGNAL(loadFinished(bool)), this, SLOT(slotMarkupPlainText()));\n    }\n    if (partIndex.data(Imap::Mailbox::RolePartContentFormat).toString().toLower() == QLatin1String(\"flowed\")) {\n        flowedFormat = Composer::Util::FORMAT_FLOWED;\n\n        if (partIndex.data(Imap::Mailbox::RolePartContentDelSp).toString().toLower() == QLatin1String(\"yes\"))\n            flowedFormat = Composer::Util::FORMAT_FLOWED_DELSP;\n    }\n    load(url);\n\n    m_savePart = new QAction(tr(\"Save this message part...\"), this);\n    connect(m_savePart, SIGNAL(triggered()), this, SLOT(slotDownloadPart()));\n    this->addAction(m_savePart);\n\n    m_saveMessage = new QAction(tr(\"Save whole message...\"), this);\n    connect(m_saveMessage, SIGNAL(triggered()), this, SLOT(slotDownloadMessage()));\n    this->addAction(m_saveMessage);\n\n    m_findAction = new QAction(tr(\"Search...\"), this);\n    m_findAction->setShortcut(tr(\"Ctrl+F\"));\n    connect(m_findAction, SIGNAL(triggered()), this, SIGNAL(searchDialogRequested()));\n    addAction(m_findAction);\n\n    setContextMenuPolicy(Qt::CustomContextMenu);\n\n    // It is actually OK to construct this widget without any connection to a messageView -- this is often used when\n    // displaying message source or message headers. Let's silence the QObject::connect warning.\n    if (m_messageView) {\n        connect(this, SIGNAL(customContextMenuRequested(QPoint)), m_messageView, SLOT(partContextMenuRequested(QPoint)));\n        connect(this, SIGNAL(searchDialogRequested()), m_messageView, SLOT(triggerSearchDialog()));\n        // The targets expect the sender() of the signal to be a SimplePartWidget, not a QWebPage,\n        // which means we have to do this indirection\n        connect(page(), SIGNAL(linkHovered(QString,QString,QString)), this, SIGNAL(linkHovered(QString,QString,QString)));\n        connect(this, SIGNAL(linkHovered(QString,QString,QString)),\n                m_messageView, SLOT(partLinkHovered(QString,QString,QString)));\n\n        installEventFilter(m_messageView);\n    }\n}",
    "includes": [
      "include \"Imap/Model/Utils.h\"",
      "include \"Imap/Network/FileDownloadManager.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/MailboxTree.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Encoders.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"SimplePartWidget.h\"\n#",
      "include <QWebFrame>",
      "include <QNetworkReply>\n#",
      "include <QFileDialog>\n#",
      "include <QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nstallEventFilter(",
          "args": [
            "_messageView)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(linkHovered(QString,QString,QString)),",
            "_messageView,",
            "LOT(partLinkHovered(QString,QString,QString)))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "artLinkHovered(QString,QString,QString))"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artLinkHovered(",
          "args": [
            "String,",
            "String,",
            "String)"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "partLinkHovered(c",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "504-509",
          "snippet": "id MessageView::partLinkHovered(const QString &link, const QString &title, const QString &textContent)\n{\n    Q_UNUSED(title);\n    Q_UNUSED(textContent);\n    emit linkHovered(link);\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::partLinkHovered(const QString &link, const QString &title, const QString &textContent)\n  {\n      Q_UNUSED(title);\n      Q_UNUSED(textContent);\n      emit linkHovered(link);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "inkHovered(QString,QString,QString))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "age(),",
            "IGNAL(linkHovered(QString,QString,QString)),",
            "his,",
            "IGNAL(linkHovered(QString,QString,QString)))"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "inkHovered(QString,QString,QString))"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "inkHovered(QString,QString,QString))"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "age(",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadMessage(",
          "container": "implePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
          "lines": "227-240",
          "snippet": "oid SimplePartWidget::slotDownloadMessage()\n{\n    QModelIndex index;\n    if (m_partIndex.isValid()) {\n        index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n    }\n\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadMessage();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include <QWebFrame>",
            "include <QNetworkReply>\n#",
            "include <QFileDialog>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadMessage()\n  {\n      QModelIndex index;\n      if (m_partIndex.isValid()) {\n          index = Imap::Mailbox::Model::findMessageForItem(Imap::deproxifiedIndex(m_partIndex));\n      }\n  \n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, index);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadMessage();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(searchDialogRequested()),",
            "_messageView,",
            "LOT(triggerSearchDialog()))"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "riggerSearchDialog())"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "riggerSearchDialog(",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "triggerSearchDialog()",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "511-514",
          "snippet": "id MessageView::triggerSearchDialog()\n{\n    emit searchRequestedBy(qobject_cast<QWebView*>(sender()));\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::triggerSearchDialog()\n  {\n      emit searchRequestedBy(qobject_cast<QWebView*>(sender()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "earchDialogRequested())"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "earchDialogRequested(",
          "args": [],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(customContextMenuRequested(QPoint)),",
            "_messageView,",
            "LOT(partContextMenuRequested(QPoint)))"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "artContextMenuRequested(QPoint))"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artContextMenuRequested(",
          "args": [
            "Point)"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "partContextMenuRequested(c",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "489-502",
          "snippet": "id MessageView::partContextMenuRequested(const QPoint &point)\n{\n    if (SimplePartWidget *w = qobject_cast<SimplePartWidget *>(sender())) {\n        QMenu menu(w);\n        Q_FOREACH(QAction *action, w->contextMenuSpecificActions())\n            menu.addAction(action);\n        menu.addAction(w->pageAction(QWebPage::SelectAll));\n        if (!w->page()->mainFrame()->hitTestContent(point).linkUrl().isEmpty()) {\n            menu.addSeparator();\n            menu.addAction(w->pageAction(QWebPage::CopyLinkToClipboard));\n        }\n        menu.exec(w->mapToGlobal(point));\n    }\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::partContextMenuRequested(const QPoint &point)\n  {\n      if (SimplePartWidget *w = qobject_cast<SimplePartWidget *>(sender())) {\n          QMenu menu(w);\n          Q_FOREACH(QAction *action, w->contextMenuSpecificActions())\n              menu.addAction(action);\n          menu.addAction(w->pageAction(QWebPage::SelectAll));\n          if (!w->page()->mainFrame()->hitTestContent(point).linkUrl().isEmpty()) {\n              menu.addSeparator();\n              menu.addAction(w->pageAction(QWebPage::CopyLinkToClipboard));\n          }\n          menu.exec(w->mapToGlobal(point));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ustomContextMenuRequested(QPoint))"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ustomContextMenuRequested(",
          "args": [
            "Point)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etContextMenuPolicy(",
          "args": [
            "t::CustomContextMenu)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddAction(",
          "args": [
            "_findAction)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_findAction,",
            "IGNAL(triggered()),",
            "his,",
            "IGNAL(searchDialogRequested()))"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "earchDialogRequested())"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "earchDialogRequested(",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "riggered())"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "riggered(",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_findAction->setShortcut",
          "args": [
            "r(\"Ctrl+F\"))"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Ctrl+F\")"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "his->addAction",
          "args": [
            "_saveMessage)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_saveMessage,",
            "IGNAL(triggered()),",
            "his,",
            "LOT(slotDownloadMessage()))"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotDownloadMessage())"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "riggered())"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "riggered(",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "his->addAction",
          "args": [
            "_savePart)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_savePart,",
            "IGNAL(triggered()),",
            "his,",
            "LOT(slotDownloadPart()))"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotDownloadPart())"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotDownloadPart(",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "slotDownloadPart(",
          "container": "implePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SimplePartWidget.cpp",
          "lines": "217-225",
          "snippet": "oid SimplePartWidget::slotDownloadPart()\n{\n    Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, m_partIndex);\n    connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n    connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n    connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n    connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n    manager->downloadPart();\n}",
          "includes": [
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include <QWebFrame>",
            "include <QNetworkReply>\n#",
            "include <QFileDialog>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  oid SimplePartWidget::slotDownloadPart()\n  {\n      Imap::Network::FileDownloadManager *manager = new Imap::Network::FileDownloadManager(this, m_netAccessManager, m_partIndex);\n      connect(manager, SIGNAL(fileNameRequested(QString *)), this, SLOT(slotFileNameRequested(QString *)));\n      connect(manager, SIGNAL(transferError(QString)), m_messageView, SIGNAL(transferError(QString)));\n      connect(manager, SIGNAL(transferError(QString)), manager, SLOT(deleteLater()));\n      connect(manager, SIGNAL(succeeded()), manager, SLOT(deleteLater()));\n      manager->downloadPart();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "riggered())"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "riggered(",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oad(",
          "args": [
            "rl)"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "requestEnvelopeDownload(",
          "container": "eepMailboxOpenTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/KeepMailboxOpenTask.cpp",
          "lines": "737-743",
          "snippet": "oid KeepMailboxOpenTask::requestEnvelopeDownload(const uint uid)\n{\n    requestedEnvelopes.append(uid);\n    if (!fetchEnvelopeTimer->isActive()) {\n        fetchEnvelopeTimer->start();\n    }\n}",
          "includes": [
            "include \"UnSelectTask.h\"",
            "include \"NoopTask.h\"\n#",
            "include \"SortTask.h\"\n#",
            "include \"OfflineConnectionTask.h\"\n#",
            "include \"ObtainSynchronizedMailboxTask.h\"\n#",
            "include \"OpenConnectionTask.h\"\n#",
            "include \"IdleLauncher.h\"\n#",
            "include \"FetchMsgPartTask.h\"\n#",
            "include \"FetchMsgMetadataTask.h\"\n#",
            "include \"DeleteMailboxTask.h\"\n#",
            "include \"Imap/Model/TaskFactory.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"KeepMailboxOpenTask.h\"\n#",
            "include <sstream>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"UnSelectTask.h\"\ninclude \"NoopTask.h\"\n#\ninclude \"SortTask.h\"\n#\ninclude \"OfflineConnectionTask.h\"\n#\ninclude \"ObtainSynchronizedMailboxTask.h\"\n#\ninclude \"OpenConnectionTask.h\"\n#\ninclude \"IdleLauncher.h\"\n#\ninclude \"FetchMsgPartTask.h\"\n#\ninclude \"FetchMsgMetadataTask.h\"\n#\ninclude \"DeleteMailboxTask.h\"\n#\ninclude \"Imap/Model/TaskFactory.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"KeepMailboxOpenTask.h\"\n#\ninclude <sstream>\n#\n\neepMailboxOpenTask {\n  oid KeepMailboxOpenTask::requestEnvelopeDownload(const uint uid)\n  {\n      requestedEnvelopes.append(uid);\n      if (!fetchEnvelopeTimer->isActive()) {\n          fetchEnvelopeTimer->start();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "yes\")"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartContentDelSp)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "flowed\")"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartContentFormat)"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartOctets)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "text/plain\")"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartMimeType)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.setPath",
          "args": [
            "artIndex.data(Imap::Mailbox::RolePartPathToPart).toString())"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartPathToPart)"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.setHost",
          "args": [
            "Latin1String(\"msg\"))"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "msg\")"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.setScheme",
          "args": [
            "Latin1String(\"trojita-imap\"))"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "trojita-imap\")"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "his,",
            "IGNAL(loadStarted()),",
            "_messageView,",
            "LOT(onWebViewLoadStarted()))"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nWebViewLoadStarted())"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nWebViewLoadStarted(",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "onWebViewLoadStarted()",
          "container": "ssageView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageView.cpp",
          "lines": "521-532",
          "snippet": "id MessageView::onWebViewLoadStarted()\n{\n    QWebView *wv = qobject_cast<QWebView*>(sender());\n    Q_ASSERT(wv);\n    QModelIndex messageIndex;\n    const Imap::Mailbox::Model *constModel = 0;\n    Imap::Mailbox::Model::realTreeItem(message, &constModel, &messageIndex);\n    if (constModel && constModel->isNetworkAvailable()) {\n        m_loadingItems << wv;\n        m_loadingSpinner->start(250);\n    }\n}",
          "includes": [
            "include \"Imap/Network/MsgPartNetAccessManager.h\"",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Composer/SubjectMangling.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Window.h\"\n#",
            "include \"UserAgentWebPage.h\"\n#",
            "include \"TagListWidget.h\"\n#",
            "include \"Spinner.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"PartWidgetFactory.h\"\n#",
            "include \"OverlayWidget.h\"\n#",
            "include \"ExternalElementsWidget.h\"\n#",
            "include \"EnvelopeView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"AbstractPartWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include <QWebPage>",
            "include <QWebHitTestResult>\n#",
            "include <QWebHistory>\n#",
            "include <QWebFrame>\n#",
            "include <QVBoxLayout>\n#",
            "include <QUrl>\n#",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QHeaderView>\n#",
            "include <QDesktopServices>\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Network/MsgPartNetAccessManager.h\"\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Composer/SubjectMangling.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Window.h\"\n#\ninclude \"UserAgentWebPage.h\"\n#\ninclude \"TagListWidget.h\"\n#\ninclude \"Spinner.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"PartWidgetFactory.h\"\n#\ninclude \"OverlayWidget.h\"\n#\ninclude \"ExternalElementsWidget.h\"\n#\ninclude \"EnvelopeView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"AbstractPartWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude <QWebPage>\ninclude <QWebHitTestResult>\n#\ninclude <QWebHistory>\n#\ninclude <QWebFrame>\n#\ninclude <QVBoxLayout>\n#\ninclude <QUrl>\n#\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QHeaderView>\n#\ninclude <QDesktopServices>\n#\ninclude <QDebug>\n#\n\nssageView {\n  id MessageView::onWebViewLoadStarted()\n  {\n      QWebView *wv = qobject_cast<QWebView*>(sender());\n      Q_ASSERT(wv);\n      QModelIndex messageIndex;\n      const Imap::Mailbox::Model *constModel = 0;\n      Imap::Mailbox::Model::realTreeItem(message, &constModel, &messageIndex);\n      if (constModel && constModel->isNetworkAvailable()) {\n          m_loadingItems << wv;\n          m_loadingSpinner->start(250);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "oadStarted())"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "artIndex.isValid())"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.isValid",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Model/Utils.h\"\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude <QWebFrame>\ninclude <QNetworkReply>\n#\ninclude <QFileDialog>\n#\ninclude <QApplication>\n#\n\nimplePartWidget {\n  implePartWidget::SimplePartWidget(QWidget *parent, Imap::Network::MsgPartNetAccessManager *manager,\n                                     const QModelIndex &partIndex, MessageView *messageView):\n      EmbeddedWebView(parent, manager), m_partIndex(partIndex), m_messageView(messageView), m_netAccessManager(manager),\n      flowedFormat(Composer::Util::FORMAT_PLAIN)\n  {\n      Q_ASSERT(partIndex.isValid());\n  \n      if (m_messageView) {\n          connect(this, SIGNAL(loadStarted()), m_messageView, SLOT(onWebViewLoadStarted()));\n          connect(this, SIGNAL(loadFinished(bool)), m_messageView, SLOT(onWebViewLoadFinished()));\n      }\n  \n      QUrl url;\n      url.setScheme(QLatin1String(\"trojita-imap\"));\n      url.setHost(QLatin1String(\"msg\"));\n      url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n      if (partIndex.data(Imap::Mailbox::RolePartMimeType).toString() == QLatin1String(\"text/plain\")\n              && partIndex.data(Imap::Mailbox::RolePartOctets).toUInt() < 100 * 1024) {\n          connect(this, SIGNAL(loadFinished(bool)), this, SLOT(slotMarkupPlainText()));\n      }\n      if (partIndex.data(Imap::Mailbox::RolePartContentFormat).toString().toLower() == QLatin1String(\"flowed\")) {\n          flowedFormat = Composer::Util::FORMAT_FLOWED;\n  \n          if (partIndex.data(Imap::Mailbox::RolePartContentDelSp).toString().toLower() == QLatin1String(\"yes\"))\n              flowedFormat = Composer::Util::FORMAT_FLOWED_DELSP;\n      }\n      load(url);\n  \n      m_savePart = new QAction(tr(\"Save this message part...\"), this);\n      connect(m_savePart, SIGNAL(triggered()), this, SLOT(slotDownloadPart()));\n      this->addAction(m_savePart);\n  \n      m_saveMessage = new QAction(tr(\"Save whole message...\"), this);\n      connect(m_saveMessage, SIGNAL(triggered()), this, SLOT(slotDownloadMessage()));\n      this->addAction(m_saveMessage);\n  \n      m_findAction = new QAction(tr(\"Search...\"), this);\n      m_findAction->setShortcut(tr(\"Ctrl+F\"));\n      connect(m_findAction, SIGNAL(triggered()), this, SIGNAL(searchDialogRequested()));\n      addAction(m_findAction);\n  \n      setContextMenuPolicy(Qt::CustomContextMenu);\n  \n      // It is actually OK to construct this widget without any connection to a messageView -- this is often used when\n      // displaying message source or message headers. Let's silence the QObject::connect warning.\n      if (m_messageView) {\n          connect(this, SIGNAL(customContextMenuRequested(QPoint)), m_messageView, SLOT(partContextMenuRequested(QPoint)));\n          connect(this, SIGNAL(searchDialogRequested()), m_messageView, SLOT(triggerSearchDialog()));\n          // The targets expect the sender() of the signal to be a SimplePartWidget, not a QWebPage,\n          // which means we have to do this indirection\n          connect(page(), SIGNAL(linkHovered(QString,QString,QString)), this, SIGNAL(linkHovered(QString,QString,QString)));\n          connect(this, SIGNAL(linkHovered(QString,QString,QString)),\n                  m_messageView, SLOT(partLinkHovered(QString,QString,QString)));\n  \n          installEventFilter(m_messageView);\n      }\n  }\n}"
  }
]