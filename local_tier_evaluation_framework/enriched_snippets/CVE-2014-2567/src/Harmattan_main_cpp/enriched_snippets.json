[
  {
    "function_name": "ain(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Harmattan/main.cpp",
    "lines": "32-52",
    "snippet": "nt main(int argc, char *argv[])\n{\n    Common::registerMetaTypes();\n    QApplication app(argc, argv);\n    Common::Application::name = QString::fromAscii(\"trojita-tp\");\n    AppVersion::setGitVersion();\n    AppVersion::setCoreApplicationData();\n\n    QmlApplicationViewer viewer;\n\n    QSettings s;\n    Imap::ImapAccess imapAccess(0, &s, QLatin1String(\"defaultAccount\"));\n    QDeclarativeContext *ctxt = viewer.rootContext();\n    ctxt->setContextProperty(QLatin1String(\"imapAccess\"), &imapAccess);\n\n    viewer.setOrientation(QmlApplicationViewer::ScreenOrientationAuto);\n    viewer.setMainQmlFile(QLatin1String(\"qml/trojita/main.qml\"));\n    viewer.showExpanded();\n\n    return app.exec();\n}",
    "includes": [
      "include \"Imap/Model/ImapAccess.h\"",
      "include \"Common/MetaTypes.h\"\n#",
      "include \"Common/Application.h\"\n#",
      "include \"AppVersion/SetCoreApplication.h\"\n#",
      "include \"qmlapplicationviewer.h\"\n#",
      "include <QSettings>\n#",
      "include <QDeclarativeContext>\n#",
      "include <QtGui/QApplication>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pp.exec",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "exec",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "217-242",
          "snippet": "bool XSqlQuery::exec()\n{\n  bool returnValue = false;\n\n  if(_data && _data->_emulatePrepare)\n  {\n// In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n// caused several problems with all our code and the way it worked so this is a modified copy\n// of their code to use the implemented prepare if we have that option set so we can use the method\n// that works best in the case we are using it for.\n    if (lastError().isValid())\n      ((XSqlResultHelper*)result())->setLastError(QSqlError());\n\n    returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n  }\n  else\n    returnValue = QSqlQuery::exec();\n\n  if (_data)\n    _data->_currRecord = record();\n\n  if(false == returnValue)\n    notifyErrorListeners(this);\n\n  return returnValue;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::exec()\n  {\n    bool returnValue = false;\n  \n    if(_data && _data->_emulatePrepare)\n    {\n  // In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n  // caused several problems with all our code and the way it worked so this is a modified copy\n  // of their code to use the implemented prepare if we have that option set so we can use the method\n  // that works best in the case we are using it for.\n      if (lastError().isValid())\n        ((XSqlResultHelper*)result())->setLastError(QSqlError());\n  \n      returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n    }\n    else\n      returnValue = QSqlQuery::exec();\n  \n    if (_data)\n      _data->_currRecord = record();\n  \n    if(false == returnValue)\n      notifyErrorListeners(this);\n  \n    return returnValue;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iewer.showExpanded",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "showExpanded",
          "container": "QmlApplicationViewer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Harmattan/qmlapplicationviewer/qmlapplicationviewer.cpp",
          "lines": "159-168",
          "snippet": "void QmlApplicationViewer::showExpanded()\n{\n#if defined(MEEGO_EDITION_HARMATTAN) || defined(Q_WS_SIMULATOR) || defined(Q_OS_QNX)\n    showFullScreen();\n#elif defined(Q_WS_MAEMO_5)\n    showMaximized();\n#else\n    show();\n#endif\n}",
          "includes": [
            "#include <qdeclarativeviewobserver.h>",
            "#include <jsdebuggeragent.h>",
            "#include <qt_private/qdeclarativedebughelper_p.h>",
            "#include <MDeclarativeCache>",
            "#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN",
            "#include <QDeclarativeContext>",
            "#include <QDeclarativeEngine>",
            "#include <QDeclarativeComponent>",
            "#include <QApplication>",
            "#include <QFileInfo>",
            "#include <QDir>",
            "#include \"qmlapplicationviewer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qdeclarativeviewobserver.h>\n#include <jsdebuggeragent.h>\n#include <qt_private/qdeclarativedebughelper_p.h>\n#include <MDeclarativeCache>\n#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN\n#include <QDeclarativeContext>\n#include <QDeclarativeEngine>\n#include <QDeclarativeComponent>\n#include <QApplication>\n#include <QFileInfo>\n#include <QDir>\n#include \"qmlapplicationviewer.h\"\n\nQmlApplicationViewer {\n  void QmlApplicationViewer::showExpanded()\n  {\n  #if defined(MEEGO_EDITION_HARMATTAN) || defined(Q_WS_SIMULATOR) || defined(Q_OS_QNX)\n      showFullScreen();\n  #elif defined(Q_WS_MAEMO_5)\n      showMaximized();\n  #else\n      show();\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "iewer.setMainQmlFile",
          "args": [
            "Latin1String(\"qml/trojita/main.qml\"))"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "setMainQmlFile",
          "container": "QmlApplicationViewer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Harmattan/qmlapplicationviewer/qmlapplicationviewer.cpp",
          "lines": "108-116",
          "snippet": "void QmlApplicationViewer::setMainQmlFile(const QString &file)\n{\n    d->mainQmlFile = QmlApplicationViewerPrivate::adjustPath(file);\n#ifdef Q_OS_ANDROID\n    setSource(QUrl(QLatin1String(\"assets:/\")+d->mainQmlFile));\n#else\n    setSource(QUrl::fromLocalFile(d->mainQmlFile));\n#endif\n}",
          "includes": [
            "#include <qdeclarativeviewobserver.h>",
            "#include <jsdebuggeragent.h>",
            "#include <qt_private/qdeclarativedebughelper_p.h>",
            "#include <MDeclarativeCache>",
            "#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN",
            "#include <QDeclarativeContext>",
            "#include <QDeclarativeEngine>",
            "#include <QDeclarativeComponent>",
            "#include <QApplication>",
            "#include <QFileInfo>",
            "#include <QDir>",
            "#include \"qmlapplicationviewer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qdeclarativeviewobserver.h>\n#include <jsdebuggeragent.h>\n#include <qt_private/qdeclarativedebughelper_p.h>\n#include <MDeclarativeCache>\n#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN\n#include <QDeclarativeContext>\n#include <QDeclarativeEngine>\n#include <QDeclarativeComponent>\n#include <QApplication>\n#include <QFileInfo>\n#include <QDir>\n#include \"qmlapplicationviewer.h\"\n\nQmlApplicationViewer {\n  void QmlApplicationViewer::setMainQmlFile(const QString &file)\n  {\n      d->mainQmlFile = QmlApplicationViewerPrivate::adjustPath(file);\n  #ifdef Q_OS_ANDROID\n      setSource(QUrl(QLatin1String(\"assets:/\")+d->mainQmlFile));\n  #else\n      setSource(QUrl::fromLocalFile(d->mainQmlFile));\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "qml/trojita/main.qml\")"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iewer.setOrientation",
          "args": [
            "mlApplicationViewer::ScreenOrientationAuto)"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "setOrientation",
          "container": "QmlApplicationViewer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Harmattan/qmlapplicationviewer/qmlapplicationviewer.cpp",
          "lines": "123-157",
          "snippet": "void QmlApplicationViewer::setOrientation(ScreenOrientation orientation)\n{\n#if QT_VERSION < 0x050000\n    Qt::WidgetAttribute attribute;\n    switch (orientation) {\n#if QT_VERSION < 0x040702\n    // Qt < 4.7.2 does not yet have the Qt::WA_*Orientation attributes\n    case ScreenOrientationLockPortrait:\n        attribute = static_cast<Qt::WidgetAttribute>(128);\n        break;\n    case ScreenOrientationLockLandscape:\n        attribute = static_cast<Qt::WidgetAttribute>(129);\n        break;\n    default:\n    case ScreenOrientationAuto:\n        attribute = static_cast<Qt::WidgetAttribute>(130);\n        break;\n#else // QT_VERSION < 0x040702\n    case ScreenOrientationLockPortrait:\n        attribute = Qt::WA_LockPortraitOrientation;\n        break;\n    case ScreenOrientationLockLandscape:\n        attribute = Qt::WA_LockLandscapeOrientation;\n        break;\n    default:\n    case ScreenOrientationAuto:\n        attribute = Qt::WA_AutoOrientation;\n        break;\n#endif // QT_VERSION < 0x040702\n    };\n    setAttribute(attribute, true);\n#else // QT_VERSION < 0x050000\n    Q_UNUSED(orientation)\n#endif // QT_VERSION < 0x050000\n}",
          "includes": [
            "#include <qdeclarativeviewobserver.h>",
            "#include <jsdebuggeragent.h>",
            "#include <qt_private/qdeclarativedebughelper_p.h>",
            "#include <MDeclarativeCache>",
            "#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN",
            "#include <QDeclarativeContext>",
            "#include <QDeclarativeEngine>",
            "#include <QDeclarativeComponent>",
            "#include <QApplication>",
            "#include <QFileInfo>",
            "#include <QDir>",
            "#include \"qmlapplicationviewer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qdeclarativeviewobserver.h>\n#include <jsdebuggeragent.h>\n#include <qt_private/qdeclarativedebughelper_p.h>\n#include <MDeclarativeCache>\n#include <qplatformdefs.h> // MEEGO_EDITION_HARMATTAN\n#include <QDeclarativeContext>\n#include <QDeclarativeEngine>\n#include <QDeclarativeComponent>\n#include <QApplication>\n#include <QFileInfo>\n#include <QDir>\n#include \"qmlapplicationviewer.h\"\n\nQmlApplicationViewer {\n  void QmlApplicationViewer::setOrientation(ScreenOrientation orientation)\n  {\n  #if QT_VERSION < 0x050000\n      Qt::WidgetAttribute attribute;\n      switch (orientation) {\n  #if QT_VERSION < 0x040702\n      // Qt < 4.7.2 does not yet have the Qt::WA_*Orientation attributes\n      case ScreenOrientationLockPortrait:\n          attribute = static_cast<Qt::WidgetAttribute>(128);\n          break;\n      case ScreenOrientationLockLandscape:\n          attribute = static_cast<Qt::WidgetAttribute>(129);\n          break;\n      default:\n      case ScreenOrientationAuto:\n          attribute = static_cast<Qt::WidgetAttribute>(130);\n          break;\n  #else // QT_VERSION < 0x040702\n      case ScreenOrientationLockPortrait:\n          attribute = Qt::WA_LockPortraitOrientation;\n          break;\n      case ScreenOrientationLockLandscape:\n          attribute = Qt::WA_LockLandscapeOrientation;\n          break;\n      default:\n      case ScreenOrientationAuto:\n          attribute = Qt::WA_AutoOrientation;\n          break;\n  #endif // QT_VERSION < 0x040702\n      };\n      setAttribute(attribute, true);\n  #else // QT_VERSION < 0x050000\n      Q_UNUSED(orientation)\n  #endif // QT_VERSION < 0x050000\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "txt->setContextProperty",
          "args": [
            "Latin1String(\"imapAccess\"),",
            "imapAccess)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "imapAccess\")"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "iewer.rootContext",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "defaultAccount\")"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppVersion::setCoreApplicationData(",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ppVersion::setGitVersion(",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromAscii(",
          "args": [
            "trojita-tp\")"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ommon::registerMetaTypes(",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Model/ImapAccess.h\"\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AppVersion/SetCoreApplication.h\"\n#\ninclude \"qmlapplicationviewer.h\"\n#\ninclude <QSettings>\n#\ninclude <QDeclarativeContext>\n#\ninclude <QtGui/QApplication>\n#\n\nnt main(int argc, char *argv[])\n{\n    Common::registerMetaTypes();\n    QApplication app(argc, argv);\n    Common::Application::name = QString::fromAscii(\"trojita-tp\");\n    AppVersion::setGitVersion();\n    AppVersion::setCoreApplicationData();\n\n    QmlApplicationViewer viewer;\n\n    QSettings s;\n    Imap::ImapAccess imapAccess(0, &s, QLatin1String(\"defaultAccount\"));\n    QDeclarativeContext *ctxt = viewer.rootContext();\n    ctxt->setContextProperty(QLatin1String(\"imapAccess\"), &imapAccess);\n\n    viewer.setOrientation(QmlApplicationViewer::ScreenOrientationAuto);\n    viewer.setMainQmlFile(QLatin1String(\"qml/trojita/main.qml\"));\n    viewer.showExpanded();\n\n    return app.exec();\n}"
  }
]