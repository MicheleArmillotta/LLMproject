[
  {
    "function_name": "handleRowsInserted(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "337-344",
    "snippet": "oid MailboxModel::handleRowsInserted(const QModelIndex &parent, int first, int last)\n{\n    if (parent.internalPointer() && ! dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer())))\n        return;\n    if (first == 0 && last == 0)\n        return;\n    endInsertRows();\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndInsertRows(",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(parent.internalPointer()))"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "arent.internalPointer())"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleRowsInserted(const QModelIndex &parent, int first, int last)\n  {\n      if (parent.internalPointer() && ! dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer())))\n          return;\n      if (first == 0 && last == 0)\n          return;\n      endInsertRows();\n  }\n}"
  },
  {
    "function_name": "handleRowsAboutToBeInserted(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "328-335",
    "snippet": "oid MailboxModel::handleRowsAboutToBeInserted(const QModelIndex &parent, int first, int last)\n{\n    if (parent.internalPointer() && ! dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer())))\n        return;\n    if (first == 0 && last == 0)\n        return;\n    beginInsertRows(mapFromSource(parent), first - 1, last - 1);\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eginInsertRows(",
          "args": [
            "apFromSource(parent),",
            "irst - 1,",
            "ast - 1)"
          ],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "apFromSource(",
          "args": [
            "arent)"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "mapFromSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "184-202",
          "snippet": "ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n{\n    if (!sourceIndex.isValid())\n        return QModelIndex();\n\n    if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n            static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n        return QModelIndex();\n\n    int row = sourceIndex.row();\n    if (row == 0)\n        return QModelIndex();\n    if (row > 0)\n        --row;\n    if (sourceIndex.column() != 0)\n        return QModelIndex();\n\n    return createIndex(row, 0, sourceIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n  {\n      if (!sourceIndex.isValid())\n          return QModelIndex();\n  \n      if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n              static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n          return QModelIndex();\n  \n      int row = sourceIndex.row();\n      if (row == 0)\n          return QModelIndex();\n      if (row > 0)\n          --row;\n      if (sourceIndex.column() != 0)\n          return QModelIndex();\n  \n      return createIndex(row, 0, sourceIndex.internalPointer());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(parent.internalPointer()))"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "arent.internalPointer())"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleRowsAboutToBeInserted(const QModelIndex &parent, int first, int last)\n  {\n      if (parent.internalPointer() && ! dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer())))\n          return;\n      if (first == 0 && last == 0)\n          return;\n      beginInsertRows(mapFromSource(parent), first - 1, last - 1);\n  }\n}"
  },
  {
    "function_name": "handleRowsRemoved(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "318-326",
    "snippet": "oid MailboxModel::handleRowsRemoved(const QModelIndex &parent, int first, int last)\n{\n    Q_UNUSED(first);\n    Q_UNUSED(last);\n    TreeItemMailbox *parentMbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer()));\n    if (parent.internalPointer() && ! parentMbox)\n        return;\n    endRemoveRows();\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndRemoveRows(",
          "args": [],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(parent.internalPointer()))"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "arent.internalPointer())"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "ast)"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "irst)"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleRowsRemoved(const QModelIndex &parent, int first, int last)\n  {\n      Q_UNUSED(first);\n      Q_UNUSED(last);\n      TreeItemMailbox *parentMbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer()));\n      if (parent.internalPointer() && ! parentMbox)\n          return;\n      endRemoveRows();\n  }\n}"
  },
  {
    "function_name": "handleRowsAboutToBeRemoved(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "305-316",
    "snippet": "oid MailboxModel::handleRowsAboutToBeRemoved(const QModelIndex &parent, int first, int last)\n{\n    TreeItemMailbox *parentMbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer()));\n    if (parent.internalPointer() && ! parentMbox)\n        return;\n    if (! parentMbox)\n        parentMbox = static_cast<Imap::Mailbox::Model *>(sourceModel())->m_mailboxes;\n    Q_ASSERT(first >= 1);\n    Q_ASSERT(last <= parentMbox->m_children.size() - 1);\n    Q_ASSERT(first <= last);\n    beginRemoveRows(mapFromSource(parent), first - 1, last - 1);\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eginRemoveRows(",
          "args": [
            "apFromSource(parent),",
            "irst - 1,",
            "ast - 1)"
          ],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "apFromSource(",
          "args": [
            "arent)"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "mapFromSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "184-202",
          "snippet": "ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n{\n    if (!sourceIndex.isValid())\n        return QModelIndex();\n\n    if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n            static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n        return QModelIndex();\n\n    int row = sourceIndex.row();\n    if (row == 0)\n        return QModelIndex();\n    if (row > 0)\n        --row;\n    if (sourceIndex.column() != 0)\n        return QModelIndex();\n\n    return createIndex(row, 0, sourceIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n  {\n      if (!sourceIndex.isValid())\n          return QModelIndex();\n  \n      if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n              static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n          return QModelIndex();\n  \n      int row = sourceIndex.row();\n      if (row == 0)\n          return QModelIndex();\n      if (row > 0)\n          --row;\n      if (sourceIndex.column() != 0)\n          return QModelIndex();\n  \n      return createIndex(row, 0, sourceIndex.internalPointer());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "irst <= last)"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ast <= parentMbox->m_children.size() - 1)"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arentMbox->m_children.size",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "irst >= 1)"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Imap::Mailbox::Model *>",
          "args": [
            "ourceModel())"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(parent.internalPointer()))"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "arent.internalPointer())"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleRowsAboutToBeRemoved(const QModelIndex &parent, int first, int last)\n  {\n      TreeItemMailbox *parentMbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer()));\n      if (parent.internalPointer() && ! parentMbox)\n          return;\n      if (! parentMbox)\n          parentMbox = static_cast<Imap::Mailbox::Model *>(sourceModel())->m_mailboxes;\n      Q_ASSERT(first >= 1);\n      Q_ASSERT(last <= parentMbox->m_children.size() - 1);\n      Q_ASSERT(first <= last);\n      beginRemoveRows(mapFromSource(parent), first - 1, last - 1);\n  }\n}"
  },
  {
    "function_name": "dropMimeData(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "259-303",
    "snippet": "ool MailboxModel::dropMimeData(const QMimeData *data, Qt::DropAction action,\n                                int row, int column, const QModelIndex &parent)\n{\n    Q_UNUSED(row); Q_UNUSED(column);\n    if (action != Qt::CopyAction && action != Qt::MoveAction)\n        return false;\n\n    if (! parent.isValid())\n        return false;\n\n    if (! static_cast<Model *>(sourceModel())->isNetworkAvailable())\n        return false;\n\n    TreeItemMailbox *target = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer()));\n    Q_ASSERT(target);\n\n    if (! target->isSelectable())\n        return false;\n\n    QByteArray encodedData = data->data(\"application/x-trojita-message-list\");\n    QDataStream stream(&encodedData, QIODevice::ReadOnly);\n\n    Q_ASSERT(! stream.atEnd());\n    QString origMboxName;\n    stream >> origMboxName;\n    TreeItemMailbox *origMbox = static_cast<Model *>(sourceModel())->findMailboxByName(origMboxName);\n    if (! origMbox) {\n        qDebug() << \"Can't find original mailbox when performing a drag&drop on messages\";\n        return false;\n    }\n\n    uint uidValidity;\n    stream >> uidValidity;\n    if (uidValidity != origMbox->syncState.uidValidity()) {\n        qDebug() << \"UID validity for original mailbox got changed, can't copy messages\";\n        return false;\n    }\n\n    QList<uint> uids;\n    stream >> uids;\n\n    static_cast<Model *>(sourceModel())->copyMoveMessages(origMbox, target->mailbox(), uids,\n            (action == Qt::MoveAction) ? MOVE : COPY);\n    return true;\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [
            "rigMbox,",
            "arget->mailbox(),",
            "ids,",
            "action == Qt::MoveAction) ? MOVE : COPY)"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arget->mailbox",
          "args": [],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [
            "ourceModel())"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rigMbox->syncState.uidValidity",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [
            "rigMboxName)"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [
            "ourceModel())"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "stream.atEnd())"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tream.atEnd",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ata->data",
          "args": [
            "application/x-trojita-message-list\")"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arget->isSelectable",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "arget)"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(parent.internalPointer()))"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "arent.internalPointer())"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.internalPointer",
          "args": [],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [
            "ourceModel())"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.isValid",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "olumn)"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "ow)"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ool MailboxModel::dropMimeData(const QMimeData *data, Qt::DropAction action,\n                                  int row, int column, const QModelIndex &parent)\n  {\n      Q_UNUSED(row); Q_UNUSED(column);\n      if (action != Qt::CopyAction && action != Qt::MoveAction)\n          return false;\n  \n      if (! parent.isValid())\n          return false;\n  \n      if (! static_cast<Model *>(sourceModel())->isNetworkAvailable())\n          return false;\n  \n      TreeItemMailbox *target = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(parent.internalPointer()));\n      Q_ASSERT(target);\n  \n      if (! target->isSelectable())\n          return false;\n  \n      QByteArray encodedData = data->data(\"application/x-trojita-message-list\");\n      QDataStream stream(&encodedData, QIODevice::ReadOnly);\n  \n      Q_ASSERT(! stream.atEnd());\n      QString origMboxName;\n      stream >> origMboxName;\n      TreeItemMailbox *origMbox = static_cast<Model *>(sourceModel())->findMailboxByName(origMboxName);\n      if (! origMbox) {\n          qDebug() << \"Can't find original mailbox when performing a drag&drop on messages\";\n          return false;\n      }\n  \n      uint uidValidity;\n      stream >> uidValidity;\n      if (uidValidity != origMbox->syncState.uidValidity()) {\n          qDebug() << \"UID validity for original mailbox got changed, can't copy messages\";\n          return false;\n      }\n  \n      QList<uint> uids;\n      stream >> uids;\n  \n      static_cast<Model *>(sourceModel())->copyMoveMessages(origMbox, target->mailbox(), uids,\n              (action == Qt::MoveAction) ? MOVE : COPY);\n      return true;\n  }\n}"
  },
  {
    "function_name": "mimeTypes(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "254-257",
    "snippet": "StringList MailboxModel::mimeTypes() const\n{\n    return QStringList() << QLatin1String(\"application/x-trojita-message-list\");\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "application/x-trojita-message-list\")"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringList(",
          "args": [],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  StringList MailboxModel::mimeTypes() const\n  {\n      return QStringList() << QLatin1String(\"application/x-trojita-message-list\");\n  }\n}"
  },
  {
    "function_name": "supportedDropActions(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "249-252",
    "snippet": "t::DropActions MailboxModel::supportedDropActions() const\n{\n    return Qt::CopyAction | Qt::MoveAction;\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  t::DropActions MailboxModel::supportedDropActions() const\n  {\n      return Qt::CopyAction | Qt::MoveAction;\n  }\n}"
  },
  {
    "function_name": "flags(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "230-247",
    "snippet": "t::ItemFlags MailboxModel::flags(const QModelIndex &index) const\n{\n    if (! index.isValid())\n        return QAbstractProxyModel::flags(index);\n\n    TreeItemMailbox *mbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(index.internalPointer()));\n    Q_ASSERT(mbox);\n\n    Qt::ItemFlags res = QAbstractProxyModel::flags(index);\n    if (!mbox->isSelectable()) {\n        res &= ~Qt::ItemIsSelectable;\n        res |= Qt::ItemIsEnabled;\n    }\n    if (static_cast<Model *>(sourceModel())->isNetworkAvailable()) {\n        res |= Qt::ItemIsDropEnabled;\n    }\n    return res;\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [
            "ourceModel())"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "box->isSelectable",
          "args": [],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "isSelectable(",
          "container": "reeItemMailbox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "834-837",
          "snippet": "ool TreeItemMailbox::isSelectable() const\n{\n    return !m_metadata.flags.contains(QLatin1String(\"\\\\NOSELECT\")) && !m_metadata.flags.contains(QLatin1String(\"\\\\NONEXISTENT\"));\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemMailbox {\n  ool TreeItemMailbox::isSelectable() const\n  {\n      return !m_metadata.flags.contains(QLatin1String(\"\\\\NOSELECT\")) && !m_metadata.flags.contains(QLatin1String(\"\\\\NONEXISTENT\"));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AbstractProxyModel::flags(",
          "args": [
            "ndex)"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "flags(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "230-247",
          "snippet": "t::ItemFlags MailboxModel::flags(const QModelIndex &index) const\n{\n    if (! index.isValid())\n        return QAbstractProxyModel::flags(index);\n\n    TreeItemMailbox *mbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(index.internalPointer()));\n    Q_ASSERT(mbox);\n\n    Qt::ItemFlags res = QAbstractProxyModel::flags(index);\n    if (!mbox->isSelectable()) {\n        res &= ~Qt::ItemIsSelectable;\n        res |= Qt::ItemIsEnabled;\n    }\n    if (static_cast<Model *>(sourceModel())->isNetworkAvailable()) {\n        res |= Qt::ItemIsDropEnabled;\n    }\n    return res;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "box)"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(index.internalPointer()))"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "ndex.internalPointer())"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.internalPointer",
          "args": [],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.isValid",
          "args": [],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  t::ItemFlags MailboxModel::flags(const QModelIndex &index) const\n  {\n      if (! index.isValid())\n          return QAbstractProxyModel::flags(index);\n  \n      TreeItemMailbox *mbox = dynamic_cast<TreeItemMailbox *>(static_cast<TreeItem *>(index.internalPointer()));\n      Q_ASSERT(mbox);\n  \n      Qt::ItemFlags res = QAbstractProxyModel::flags(index);\n      if (!mbox->isSelectable()) {\n          res &= ~Qt::ItemIsSelectable;\n          res |= Qt::ItemIsEnabled;\n      }\n      if (static_cast<Model *>(sourceModel())->isNetworkAvailable()) {\n          res |= Qt::ItemIsDropEnabled;\n      }\n      return res;\n  }\n}"
  },
  {
    "function_name": "handleMessageCountPossiblyChanged(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "222-228",
    "snippet": "oid MailboxModel::handleMessageCountPossiblyChanged(const QModelIndex &mailbox)\n{\n    QModelIndex translated = mapFromSource(mailbox);\n    if (translated.isValid()) {\n        emit dataChanged(translated, translated);\n    }\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ranslated.isValid",
          "args": [],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "apFromSource(",
          "args": [
            "ailbox)"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "mapFromSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "184-202",
          "snippet": "ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n{\n    if (!sourceIndex.isValid())\n        return QModelIndex();\n\n    if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n            static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n        return QModelIndex();\n\n    int row = sourceIndex.row();\n    if (row == 0)\n        return QModelIndex();\n    if (row > 0)\n        --row;\n    if (sourceIndex.column() != 0)\n        return QModelIndex();\n\n    return createIndex(row, 0, sourceIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n  {\n      if (!sourceIndex.isValid())\n          return QModelIndex();\n  \n      if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n              static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n          return QModelIndex();\n  \n      int row = sourceIndex.row();\n      if (row == 0)\n          return QModelIndex();\n      if (row > 0)\n          --row;\n      if (sourceIndex.column() != 0)\n          return QModelIndex();\n  \n      return createIndex(row, 0, sourceIndex.internalPointer());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleMessageCountPossiblyChanged(const QModelIndex &mailbox)\n  {\n      QModelIndex translated = mapFromSource(mailbox);\n      if (translated.isValid()) {\n          emit dataChanged(translated, translated);\n      }\n  }\n}"
  },
  {
    "function_name": "data(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "204-220",
    "snippet": "Variant MailboxModel::data(const QModelIndex &proxyIndex, int role) const\n{\n    if (! proxyIndex.isValid() || proxyIndex.model() != this)\n        return QVariant();\n\n    if (proxyIndex.column() != 0)\n        return QVariant();\n\n    TreeItemMailbox *mbox = dynamic_cast<TreeItemMailbox *>(\n                                static_cast<TreeItem *>(proxyIndex.internalPointer())\n                            );\n    Q_ASSERT(mbox);\n    if (role > RoleBase && role < RoleInvalidLastOne)\n        return mbox->data(static_cast<Imap::Mailbox::Model *>(sourceModel()), role);\n    else\n        return QAbstractProxyModel::data(createIndex(proxyIndex.row(), 0, proxyIndex.internalPointer()), role);\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AbstractProxyModel::data(",
          "args": [
            "reateIndex(proxyIndex.row(), 0, proxyIndex.internalPointer()),",
            "ole)"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "data(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "204-220",
          "snippet": "Variant MailboxModel::data(const QModelIndex &proxyIndex, int role) const\n{\n    if (! proxyIndex.isValid() || proxyIndex.model() != this)\n        return QVariant();\n\n    if (proxyIndex.column() != 0)\n        return QVariant();\n\n    TreeItemMailbox *mbox = dynamic_cast<TreeItemMailbox *>(\n                                static_cast<TreeItem *>(proxyIndex.internalPointer())\n                            );\n    Q_ASSERT(mbox);\n    if (role > RoleBase && role < RoleInvalidLastOne)\n        return mbox->data(static_cast<Imap::Mailbox::Model *>(sourceModel()), role);\n    else\n        return QAbstractProxyModel::data(createIndex(proxyIndex.row(), 0, proxyIndex.internalPointer()), role);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "reateIndex(",
          "args": [
            "roxyIndex.row(),",
            ",",
            "roxyIndex.internalPointer())"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.internalPointer",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.row",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "box->data",
          "args": [
            "tatic_cast<Imap::Mailbox::Model *>(sourceModel()),",
            "ole)"
          ],
          "line": 217
        },
        "resolved": true,
        "details": {
          "function_name": "data(",
          "container": "reeItemMailbox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "200-272",
          "snippet": "Variant TreeItemMailbox::data(Model *const model, int role)\n{\n    if (!parent())\n        return QVariant();\n\n    TreeItemMsgList *list = dynamic_cast<TreeItemMsgList *>(m_children[0]);\n    Q_ASSERT(list);\n\n    switch (role) {\n    case Qt::DisplayRole:\n    {\n        // this one is used only for a dumb view attached to the Model\n        QString res = separator().isEmpty() ? mailbox() : mailbox().split(separator(), QString::SkipEmptyParts).last();\n        return loading() ? res + \" [loading]\" : res;\n    }\n    case RoleIsFetched:\n        return fetched();\n    case RoleIsUnavailable:\n        return isUnavailable(model);\n    case RoleShortMailboxName:\n        return separator().isEmpty() ? mailbox() : mailbox().split(separator(), QString::SkipEmptyParts).last();\n    case RoleMailboxName:\n        return mailbox();\n    case RoleMailboxSeparator:\n        return separator();\n    case RoleMailboxHasChildMailboxes:\n        return hasChildMailboxes(model);\n    case RoleMailboxIsINBOX:\n        return mailbox().toUpper() == QLatin1String(\"INBOX\");\n    case RoleMailboxIsSelectable:\n        return isSelectable();\n    case RoleMailboxNumbersFetched:\n        return list->numbersFetched();\n    case RoleTotalMessageCount:\n    {\n        if (! isSelectable())\n            return QVariant();\n        // At first, register that request for count\n        int res = list->totalMessageCount(model);\n        // ...and now that it's been sent, display a number if it's available, or if it was available before.\n        // It's better to return a value which is maybe already obsolete than to hide a value which might\n        // very well be still correct.\n        return list->numbersFetched() || res != -1 ? QVariant(res) : QVariant();\n    }\n    case RoleUnreadMessageCount:\n    {\n        if (! isSelectable())\n            return QVariant();\n        // This one is similar to the case of RoleTotalMessageCount\n        int res = list->unreadMessageCount(model);\n        return list->numbersFetched() || res != -1 ? QVariant(res): QVariant();\n    }\n    case RoleRecentMessageCount:\n    {\n        if (! isSelectable())\n            return QVariant();\n        // see above\n        int res = list->recentMessageCount(model);\n        return list->numbersFetched() || res != -1 ? QVariant(res): QVariant();\n    }\n    case RoleMailboxItemsAreLoading:\n        return list->loading() || (isSelectable() && ! list->numbersFetched());\n    case RoleMailboxUidValidity:\n    {\n        list->fetch(model);\n        return list->fetched() ? QVariant(syncState.uidValidity()) : QVariant();\n    }\n    case RoleMailboxIsSubscribed:\n        return QVariant::fromValue<bool>(m_metadata.flags.contains(QLatin1String(\"\\\\SUBSCRIBED\")));\n    default:\n        return QVariant();\n    }\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemMailbox {\n  Variant TreeItemMailbox::data(Model *const model, int role)\n  {\n      if (!parent())\n          return QVariant();\n  \n      TreeItemMsgList *list = dynamic_cast<TreeItemMsgList *>(m_children[0]);\n      Q_ASSERT(list);\n  \n      switch (role) {\n      case Qt::DisplayRole:\n      {\n          // this one is used only for a dumb view attached to the Model\n          QString res = separator().isEmpty() ? mailbox() : mailbox().split(separator(), QString::SkipEmptyParts).last();\n          return loading() ? res + \" [loading]\" : res;\n      }\n      case RoleIsFetched:\n          return fetched();\n      case RoleIsUnavailable:\n          return isUnavailable(model);\n      case RoleShortMailboxName:\n          return separator().isEmpty() ? mailbox() : mailbox().split(separator(), QString::SkipEmptyParts).last();\n      case RoleMailboxName:\n          return mailbox();\n      case RoleMailboxSeparator:\n          return separator();\n      case RoleMailboxHasChildMailboxes:\n          return hasChildMailboxes(model);\n      case RoleMailboxIsINBOX:\n          return mailbox().toUpper() == QLatin1String(\"INBOX\");\n      case RoleMailboxIsSelectable:\n          return isSelectable();\n      case RoleMailboxNumbersFetched:\n          return list->numbersFetched();\n      case RoleTotalMessageCount:\n      {\n          if (! isSelectable())\n              return QVariant();\n          // At first, register that request for count\n          int res = list->totalMessageCount(model);\n          // ...and now that it's been sent, display a number if it's available, or if it was available before.\n          // It's better to return a value which is maybe already obsolete than to hide a value which might\n          // very well be still correct.\n          return list->numbersFetched() || res != -1 ? QVariant(res) : QVariant();\n      }\n      case RoleUnreadMessageCount:\n      {\n          if (! isSelectable())\n              return QVariant();\n          // This one is similar to the case of RoleTotalMessageCount\n          int res = list->unreadMessageCount(model);\n          return list->numbersFetched() || res != -1 ? QVariant(res): QVariant();\n      }\n      case RoleRecentMessageCount:\n      {\n          if (! isSelectable())\n              return QVariant();\n          // see above\n          int res = list->recentMessageCount(model);\n          return list->numbersFetched() || res != -1 ? QVariant(res): QVariant();\n      }\n      case RoleMailboxItemsAreLoading:\n          return list->loading() || (isSelectable() && ! list->numbersFetched());\n      case RoleMailboxUidValidity:\n      {\n          list->fetch(model);\n          return list->fetched() ? QVariant(syncState.uidValidity()) : QVariant();\n      }\n      case RoleMailboxIsSubscribed:\n          return QVariant::fromValue<bool>(m_metadata.flags.contains(QLatin1String(\"\\\\SUBSCRIBED\")));\n      default:\n          return QVariant();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tatic_cast<Imap::Mailbox::Model *>",
          "args": [
            "ourceModel())"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "box)"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(proxyIndex.internalPointer())"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "roxyIndex.internalPointer())"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.internalPointer",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.column",
          "args": [],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.model",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.isValid",
          "args": [],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  Variant MailboxModel::data(const QModelIndex &proxyIndex, int role) const\n  {\n      if (! proxyIndex.isValid() || proxyIndex.model() != this)\n          return QVariant();\n  \n      if (proxyIndex.column() != 0)\n          return QVariant();\n  \n      TreeItemMailbox *mbox = dynamic_cast<TreeItemMailbox *>(\n                                  static_cast<TreeItem *>(proxyIndex.internalPointer())\n                              );\n      Q_ASSERT(mbox);\n      if (role > RoleBase && role < RoleInvalidLastOne)\n          return mbox->data(static_cast<Imap::Mailbox::Model *>(sourceModel()), role);\n      else\n          return QAbstractProxyModel::data(createIndex(proxyIndex.row(), 0, proxyIndex.internalPointer()), role);\n  }\n}"
  },
  {
    "function_name": "mapFromSource(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "184-202",
    "snippet": "ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n{\n    if (!sourceIndex.isValid())\n        return QModelIndex();\n\n    if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n            static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n        return QModelIndex();\n\n    int row = sourceIndex.row();\n    if (row == 0)\n        return QModelIndex();\n    if (row > 0)\n        --row;\n    if (sourceIndex.column() != 0)\n        return QModelIndex();\n\n    return createIndex(row, 0, sourceIndex.internalPointer());\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reateIndex(",
          "args": [
            "ow,",
            ",",
            "ourceIndex.internalPointer())"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceIndex.internalPointer",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceIndex.column",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceIndex.row",
          "args": [],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<Imap::Mailbox::TreeItemMailbox *>",
          "args": [
            "tatic_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer()))"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Imap::Mailbox::TreeItem *>",
          "args": [
            "ourceIndex.internalPointer())"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceIndex.internalPointer",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceIndex.isValid",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n  {\n      if (!sourceIndex.isValid())\n          return QModelIndex();\n  \n      if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n              static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n          return QModelIndex();\n  \n      int row = sourceIndex.row();\n      if (row == 0)\n          return QModelIndex();\n      if (row > 0)\n          --row;\n      if (sourceIndex.column() != 0)\n          return QModelIndex();\n  \n      return createIndex(row, 0, sourceIndex.internalPointer());\n  }\n}"
  },
  {
    "function_name": "mapToSource(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "175-182",
    "snippet": "ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n{\n    int row = proxyIndex.row();\n    if (row < 0 || proxyIndex.column() != 0)\n        return QModelIndex();\n    ++row;\n    return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tatic_cast<Imap::Mailbox::Model *>",
          "args": [
            "ow,",
            ",",
            "roxyIndex.internalPointer())"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.internalPointer",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<Imap::Mailbox::Model *>",
          "args": [
            "ourceModel())"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.column",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.row",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n  {\n      int row = proxyIndex.row();\n      if (row < 0 || proxyIndex.column() != 0)\n          return QModelIndex();\n      ++row;\n      return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n  }\n}"
  },
  {
    "function_name": "columnCount(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "170-173",
    "snippet": "nt MailboxModel::columnCount(const QModelIndex &parent) const\n{\n    return parent.column() == 0 || parent.column() == -1 ? 1 : 0;\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "arent.column",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.column",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  nt MailboxModel::columnCount(const QModelIndex &parent) const\n  {\n      return parent.column() == 0 || parent.column() == -1 ? 1 : 0;\n  }\n}"
  },
  {
    "function_name": "rowCount(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "160-168",
    "snippet": "nt MailboxModel::rowCount(const QModelIndex &parent) const\n{\n    if (parent.column() != 0 && parent.column() != -1)\n        return 0;\n    int res = sourceModel()->rowCount(mapToSource(parent));\n    if (res > 0)\n        --res;\n    return res;\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ourceModel",
          "args": [
            "apToSource(parent))"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "setSourceModel(",
          "container": "hreadingMsgListModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ThreadingMsgListModel.cpp",
          "lines": "71-109",
          "snippet": "oid ThreadingMsgListModel::setSourceModel(QAbstractItemModel *sourceModel)\n{\n    threading.clear();\n    ptrToInternal.clear();\n    unknownUids.clear();\n    threadedRootIds.clear();\n    m_currentSortResult.clear();\n    m_searchValidity = RESULT_INVALIDATED;\n\n    if (this->sourceModel()) {\n        // there's already something, so take care to disconnect all signals\n        this->sourceModel()->disconnect(this);\n    }\n\n    RESET_MODEL;\n\n    if (!sourceModel)\n        return;\n\n    Imap::Mailbox::MsgListModel *msgList = qobject_cast<Imap::Mailbox::MsgListModel *>(sourceModel);\n    Q_ASSERT(msgList);\n    QAbstractProxyModel::setSourceModel(msgList);\n\n    // FIXME: will need to be expanded when Model supports more signals...\n    connect(sourceModel, SIGNAL(modelReset()), this, SLOT(resetMe()));\n    connect(sourceModel, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n    connect(sourceModel, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n    connect(sourceModel, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n            this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n    connect(sourceModel, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsRemoved(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsInserted(const QModelIndex &, int,int)));\n    resetMe();\n}",
          "includes": [
            "include \"QAIM_reset.h\"",
            "include \"MsgListModel.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/ThreadTask.h\"\n#",
            "include \"Imap/Tasks/SortTask.h\"\n#",
            "include <QDebug>\n#",
            "include <QBuffer>\n#",
            "include <algorithm>\n#",
            "include \"ThreadingMsgListModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"QAIM_reset.h\"\ninclude \"MsgListModel.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/ThreadTask.h\"\n#\ninclude \"Imap/Tasks/SortTask.h\"\n#\ninclude <QDebug>\n#\ninclude <QBuffer>\n#\ninclude <algorithm>\n#\ninclude \"ThreadingMsgListModel.h\"\n#\n\nhreadingMsgListModel {\n  oid ThreadingMsgListModel::setSourceModel(QAbstractItemModel *sourceModel)\n  {\n      threading.clear();\n      ptrToInternal.clear();\n      unknownUids.clear();\n      threadedRootIds.clear();\n      m_currentSortResult.clear();\n      m_searchValidity = RESULT_INVALIDATED;\n  \n      if (this->sourceModel()) {\n          // there's already something, so take care to disconnect all signals\n          this->sourceModel()->disconnect(this);\n      }\n  \n      RESET_MODEL;\n  \n      if (!sourceModel)\n          return;\n  \n      Imap::Mailbox::MsgListModel *msgList = qobject_cast<Imap::Mailbox::MsgListModel *>(sourceModel);\n      Q_ASSERT(msgList);\n      QAbstractProxyModel::setSourceModel(msgList);\n  \n      // FIXME: will need to be expanded when Model supports more signals...\n      connect(sourceModel, SIGNAL(modelReset()), this, SLOT(resetMe()));\n      connect(sourceModel, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n      connect(sourceModel, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n      connect(sourceModel, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n              this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n      connect(sourceModel, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsRemoved(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsInserted(const QModelIndex &, int,int)));\n      resetMe();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "apToSource(",
          "args": [
            "arent)"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "mapToSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "175-182",
          "snippet": "ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n{\n    int row = proxyIndex.row();\n    if (row < 0 || proxyIndex.column() != 0)\n        return QModelIndex();\n    ++row;\n    return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n  {\n      int row = proxyIndex.row();\n      if (row < 0 || proxyIndex.column() != 0)\n          return QModelIndex();\n      ++row;\n      return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.column",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.column",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  nt MailboxModel::rowCount(const QModelIndex &parent) const\n  {\n      if (parent.column() != 0 && parent.column() != -1)\n          return 0;\n      int res = sourceModel()->rowCount(mapToSource(parent));\n      if (res > 0)\n          --res;\n      return res;\n  }\n}"
  },
  {
    "function_name": "parent(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "155-158",
    "snippet": "ModelIndex MailboxModel::parent(const QModelIndex &index) const\n{\n    return mapFromSource(mapToSource(index).parent());\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "apFromSource(",
          "args": [
            "apToSource(index).parent())"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "mapFromSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "184-202",
          "snippet": "ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n{\n    if (!sourceIndex.isValid())\n        return QModelIndex();\n\n    if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n            static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n        return QModelIndex();\n\n    int row = sourceIndex.row();\n    if (row == 0)\n        return QModelIndex();\n    if (row > 0)\n        --row;\n    if (sourceIndex.column() != 0)\n        return QModelIndex();\n\n    return createIndex(row, 0, sourceIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n  {\n      if (!sourceIndex.isValid())\n          return QModelIndex();\n  \n      if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n              static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n          return QModelIndex();\n  \n      int row = sourceIndex.row();\n      if (row == 0)\n          return QModelIndex();\n      if (row > 0)\n          --row;\n      if (sourceIndex.column() != 0)\n          return QModelIndex();\n  \n      return createIndex(row, 0, sourceIndex.internalPointer());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "apToSource",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "apToSource(",
          "args": [
            "ndex)"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "mapToSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "175-182",
          "snippet": "ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n{\n    int row = proxyIndex.row();\n    if (row < 0 || proxyIndex.column() != 0)\n        return QModelIndex();\n    ++row;\n    return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n  {\n      int row = proxyIndex.row();\n      if (row < 0 || proxyIndex.column() != 0)\n          return QModelIndex();\n      ++row;\n      return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::parent(const QModelIndex &index) const\n  {\n      return mapFromSource(mapToSource(index).parent());\n  }\n}"
  },
  {
    "function_name": "index(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "136-153",
    "snippet": "ModelIndex MailboxModel::index(int row, int column, const QModelIndex &parent) const\n{\n    if (row < 0 || column != 0)\n        return QModelIndex();\n\n    if (parent.column() != 0 && parent.column() != -1)\n        return QModelIndex();\n\n    QModelIndex translatedParent = mapToSource(parent);\n\n    if (row < sourceModel()->rowCount(translatedParent) - 1) {\n        void *ptr = sourceModel()->index(row + 1, 0, translatedParent).internalPointer();\n        Q_ASSERT(ptr);\n        return createIndex(row, column, ptr);\n    } else {\n        return QModelIndex();\n    }\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reateIndex(",
          "args": [
            "ow,",
            "olumn,",
            "tr)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "tr)"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "sourceModelDestroyed(",
          "container": "DescendantsProxyModelPrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/kdeui-itemviews/kdescendantsproxymodel.cpp",
          "lines": "968-971",
          "snippet": "oid KDescendantsProxyModelPrivate::sourceModelDestroyed()\n{\n  resetInternalData();\n}",
          "includes": [
            "include \"moc_kdescendantsproxymodel.cpp\"",
            "include \"kbihash_p.h\"",
            "include <QtCore/QTimer>",
            "include <QtCore/QStringList>\n#",
            "include \"kdescendantsproxymodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"moc_kdescendantsproxymodel.cpp\"\ninclude \"kbihash_p.h\"\ninclude <QtCore/QTimer>\ninclude <QtCore/QStringList>\n#\ninclude \"kdescendantsproxymodel.h\"\n\nDescendantsProxyModelPrivate {\n  oid KDescendantsProxyModelPrivate::sourceModelDestroyed()\n  {\n    resetInternalData();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ourceModel",
          "args": [
            "ow + 1,",
            ",",
            "ranslatedParent)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel",
          "args": [
            "ranslatedParent)"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "setSourceModel(",
          "container": "hreadingMsgListModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ThreadingMsgListModel.cpp",
          "lines": "71-109",
          "snippet": "oid ThreadingMsgListModel::setSourceModel(QAbstractItemModel *sourceModel)\n{\n    threading.clear();\n    ptrToInternal.clear();\n    unknownUids.clear();\n    threadedRootIds.clear();\n    m_currentSortResult.clear();\n    m_searchValidity = RESULT_INVALIDATED;\n\n    if (this->sourceModel()) {\n        // there's already something, so take care to disconnect all signals\n        this->sourceModel()->disconnect(this);\n    }\n\n    RESET_MODEL;\n\n    if (!sourceModel)\n        return;\n\n    Imap::Mailbox::MsgListModel *msgList = qobject_cast<Imap::Mailbox::MsgListModel *>(sourceModel);\n    Q_ASSERT(msgList);\n    QAbstractProxyModel::setSourceModel(msgList);\n\n    // FIXME: will need to be expanded when Model supports more signals...\n    connect(sourceModel, SIGNAL(modelReset()), this, SLOT(resetMe()));\n    connect(sourceModel, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n    connect(sourceModel, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n    connect(sourceModel, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n            this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n    connect(sourceModel, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsRemoved(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsInserted(const QModelIndex &, int,int)));\n    resetMe();\n}",
          "includes": [
            "include \"QAIM_reset.h\"",
            "include \"MsgListModel.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/ThreadTask.h\"\n#",
            "include \"Imap/Tasks/SortTask.h\"\n#",
            "include <QDebug>\n#",
            "include <QBuffer>\n#",
            "include <algorithm>\n#",
            "include \"ThreadingMsgListModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"QAIM_reset.h\"\ninclude \"MsgListModel.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/ThreadTask.h\"\n#\ninclude \"Imap/Tasks/SortTask.h\"\n#\ninclude <QDebug>\n#\ninclude <QBuffer>\n#\ninclude <algorithm>\n#\ninclude \"ThreadingMsgListModel.h\"\n#\n\nhreadingMsgListModel {\n  oid ThreadingMsgListModel::setSourceModel(QAbstractItemModel *sourceModel)\n  {\n      threading.clear();\n      ptrToInternal.clear();\n      unknownUids.clear();\n      threadedRootIds.clear();\n      m_currentSortResult.clear();\n      m_searchValidity = RESULT_INVALIDATED;\n  \n      if (this->sourceModel()) {\n          // there's already something, so take care to disconnect all signals\n          this->sourceModel()->disconnect(this);\n      }\n  \n      RESET_MODEL;\n  \n      if (!sourceModel)\n          return;\n  \n      Imap::Mailbox::MsgListModel *msgList = qobject_cast<Imap::Mailbox::MsgListModel *>(sourceModel);\n      Q_ASSERT(msgList);\n      QAbstractProxyModel::setSourceModel(msgList);\n  \n      // FIXME: will need to be expanded when Model supports more signals...\n      connect(sourceModel, SIGNAL(modelReset()), this, SLOT(resetMe()));\n      connect(sourceModel, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n      connect(sourceModel, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n      connect(sourceModel, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n              this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n      connect(sourceModel, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsRemoved(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsInserted(const QModelIndex &, int,int)));\n      resetMe();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "apToSource(",
          "args": [
            "arent)"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "mapToSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "175-182",
          "snippet": "ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n{\n    int row = proxyIndex.row();\n    if (row < 0 || proxyIndex.column() != 0)\n        return QModelIndex();\n    ++row;\n    return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n  {\n      int row = proxyIndex.row();\n      if (row < 0 || proxyIndex.column() != 0)\n          return QModelIndex();\n      ++row;\n      return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.column",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.column",
          "args": [],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::index(int row, int column, const QModelIndex &parent) const\n  {\n      if (row < 0 || column != 0)\n          return QModelIndex();\n  \n      if (parent.column() != 0 && parent.column() != -1)\n          return QModelIndex();\n  \n      QModelIndex translatedParent = mapToSource(parent);\n  \n      if (row < sourceModel()->rowCount(translatedParent) - 1) {\n          void *ptr = sourceModel()->index(row + 1, 0, translatedParent).internalPointer();\n          Q_ASSERT(ptr);\n          return createIndex(row, column, ptr);\n      } else {\n          return QModelIndex();\n      }\n  }\n}"
  },
  {
    "function_name": "handleDataChanged(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "117-134",
    "snippet": "oid MailboxModel::handleDataChanged(const QModelIndex &topLeft, const QModelIndex &bottomRight)\n{\n    QModelIndex first = mapFromSource(topLeft);\n    QModelIndex second = mapFromSource(bottomRight);\n\n    if (! first.isValid() || ! second.isValid()) {\n        // It's something completely alien...\n        return;\n    }\n\n    if (first.parent() == second.parent() && first.column() == second.column()) {\n        emit dataChanged(first, second);\n    } else {\n        // FIXME: batched updates aren't used yet\n        Q_ASSERT(false);\n        return;\n    }\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "alse)"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "econd.column",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "irst.column",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "econd.parent",
          "args": [],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "229-268",
          "snippet": "void ModelTest::parent()\n{\n    // Make sure the model wont crash and will return an invalid QModelIndex\n    // when asked for the parent of an invalid index.\n    Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // Column 0                | Column 1    |\n    // QModelIndex()           |             |\n    //    \\- topIndex          | topIndex1   |\n    //         \\- childIndex   | childIndex1 |\n\n    // Common error test #1, make sure that a top level index has a parent\n    // that is a invalid QModelIndex.\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    Q_ASSERT(model->parent(topIndex) == QModelIndex());\n\n    // Common error test #2, make sure that a second level index has a parent\n    // that is the first level index.\n    if (model->rowCount(topIndex) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        Q_ASSERT(model->parent(childIndex) == topIndex);\n    }\n\n    // Common error test #3, the second column should NOT have the same children\n    // as the first column in a row.\n    // Usually the second column shouldn't have children.\n    QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n    if (model->rowCount(topIndex1) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n        Q_ASSERT(childIndex != childIndex1);\n    }\n\n    // Full test, walk n levels deep through the model making sure that all\n    // parent's children correctly specify their parent.\n    checkChildren(QModelIndex());\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::parent()\n  {\n      // Make sure the model wont crash and will return an invalid QModelIndex\n      // when asked for the parent of an invalid index.\n      Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // Column 0                | Column 1    |\n      // QModelIndex()           |             |\n      //    \\- topIndex          | topIndex1   |\n      //         \\- childIndex   | childIndex1 |\n  \n      // Common error test #1, make sure that a top level index has a parent\n      // that is a invalid QModelIndex.\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      Q_ASSERT(model->parent(topIndex) == QModelIndex());\n  \n      // Common error test #2, make sure that a second level index has a parent\n      // that is the first level index.\n      if (model->rowCount(topIndex) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          Q_ASSERT(model->parent(childIndex) == topIndex);\n      }\n  \n      // Common error test #3, the second column should NOT have the same children\n      // as the first column in a row.\n      // Usually the second column shouldn't have children.\n      QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n      if (model->rowCount(topIndex1) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n          Q_ASSERT(childIndex != childIndex1);\n      }\n  \n      // Full test, walk n levels deep through the model making sure that all\n      // parent's children correctly specify their parent.\n      checkChildren(QModelIndex());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "econd.isValid",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "apFromSource(",
          "args": [
            "ottomRight)"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "mapFromSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "184-202",
          "snippet": "ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n{\n    if (!sourceIndex.isValid())\n        return QModelIndex();\n\n    if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n            static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n        return QModelIndex();\n\n    int row = sourceIndex.row();\n    if (row == 0)\n        return QModelIndex();\n    if (row > 0)\n        --row;\n    if (sourceIndex.column() != 0)\n        return QModelIndex();\n\n    return createIndex(row, 0, sourceIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapFromSource(const QModelIndex &sourceIndex) const\n  {\n      if (!sourceIndex.isValid())\n          return QModelIndex();\n  \n      if (! dynamic_cast<Imap::Mailbox::TreeItemMailbox *>(\n              static_cast<Imap::Mailbox::TreeItem *>(sourceIndex.internalPointer())))\n          return QModelIndex();\n  \n      int row = sourceIndex.row();\n      if (row == 0)\n          return QModelIndex();\n      if (row > 0)\n          --row;\n      if (sourceIndex.column() != 0)\n          return QModelIndex();\n  \n      return createIndex(row, 0, sourceIndex.internalPointer());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleDataChanged(const QModelIndex &topLeft, const QModelIndex &bottomRight)\n  {\n      QModelIndex first = mapFromSource(topLeft);\n      QModelIndex second = mapFromSource(bottomRight);\n  \n      if (! first.isValid() || ! second.isValid()) {\n          // It's something completely alien...\n          return;\n      }\n  \n      if (first.parent() == second.parent() && first.column() == second.column()) {\n          emit dataChanged(first, second);\n      } else {\n          // FIXME: batched updates aren't used yet\n          Q_ASSERT(false);\n          return;\n      }\n  }\n}"
  },
  {
    "function_name": "hasChildren(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "101-115",
    "snippet": "ool MailboxModel::hasChildren(const QModelIndex &parent) const\n{\n    if (parent.isValid() && parent.column() != 0)\n        return false;\n\n    QModelIndex index = mapToSource(parent);\n\n    TreeItemMailbox *mbox = dynamic_cast<TreeItemMailbox *>(\n                                static_cast<TreeItem *>(\n                                    index.internalPointer()\n                                ));\n    return mbox ?\n           mbox->hasChildMailboxes(static_cast<Model *>(sourceModel())) :\n           sourceModel()->hasChildren(index);\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ourceModel",
          "args": [
            "ndex)"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "setSourceModel(",
          "container": "hreadingMsgListModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ThreadingMsgListModel.cpp",
          "lines": "71-109",
          "snippet": "oid ThreadingMsgListModel::setSourceModel(QAbstractItemModel *sourceModel)\n{\n    threading.clear();\n    ptrToInternal.clear();\n    unknownUids.clear();\n    threadedRootIds.clear();\n    m_currentSortResult.clear();\n    m_searchValidity = RESULT_INVALIDATED;\n\n    if (this->sourceModel()) {\n        // there's already something, so take care to disconnect all signals\n        this->sourceModel()->disconnect(this);\n    }\n\n    RESET_MODEL;\n\n    if (!sourceModel)\n        return;\n\n    Imap::Mailbox::MsgListModel *msgList = qobject_cast<Imap::Mailbox::MsgListModel *>(sourceModel);\n    Q_ASSERT(msgList);\n    QAbstractProxyModel::setSourceModel(msgList);\n\n    // FIXME: will need to be expanded when Model supports more signals...\n    connect(sourceModel, SIGNAL(modelReset()), this, SLOT(resetMe()));\n    connect(sourceModel, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n    connect(sourceModel, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n    connect(sourceModel, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n            this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n    connect(sourceModel, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsRemoved(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsInserted(const QModelIndex &, int,int)));\n    resetMe();\n}",
          "includes": [
            "include \"QAIM_reset.h\"",
            "include \"MsgListModel.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/ThreadTask.h\"\n#",
            "include \"Imap/Tasks/SortTask.h\"\n#",
            "include <QDebug>\n#",
            "include <QBuffer>\n#",
            "include <algorithm>\n#",
            "include \"ThreadingMsgListModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"QAIM_reset.h\"\ninclude \"MsgListModel.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/ThreadTask.h\"\n#\ninclude \"Imap/Tasks/SortTask.h\"\n#\ninclude <QDebug>\n#\ninclude <QBuffer>\n#\ninclude <algorithm>\n#\ninclude \"ThreadingMsgListModel.h\"\n#\n\nhreadingMsgListModel {\n  oid ThreadingMsgListModel::setSourceModel(QAbstractItemModel *sourceModel)\n  {\n      threading.clear();\n      ptrToInternal.clear();\n      unknownUids.clear();\n      threadedRootIds.clear();\n      m_currentSortResult.clear();\n      m_searchValidity = RESULT_INVALIDATED;\n  \n      if (this->sourceModel()) {\n          // there's already something, so take care to disconnect all signals\n          this->sourceModel()->disconnect(this);\n      }\n  \n      RESET_MODEL;\n  \n      if (!sourceModel)\n          return;\n  \n      Imap::Mailbox::MsgListModel *msgList = qobject_cast<Imap::Mailbox::MsgListModel *>(sourceModel);\n      Q_ASSERT(msgList);\n      QAbstractProxyModel::setSourceModel(msgList);\n  \n      // FIXME: will need to be expanded when Model supports more signals...\n      connect(sourceModel, SIGNAL(modelReset()), this, SLOT(resetMe()));\n      connect(sourceModel, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n      connect(sourceModel, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n      connect(sourceModel, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n              this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n      connect(sourceModel, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsRemoved(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsInserted(const QModelIndex &, int,int)));\n      resetMe();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "box->hasChildMailboxes",
          "args": [
            "tatic_cast<Model *>(sourceModel()))"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "hasChildMailboxes(",
          "container": "reeItemMailbox",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "294-306",
          "snippet": "ool TreeItemMailbox::hasChildMailboxes(Model *const model)\n{\n    if (fetched() || isUnavailable(model)) {\n        return m_children.size() > 1;\n    } else if (hasNoChildMailboxesAlreadyKnown()) {\n        return false;\n    } else if (m_metadata.flags.contains(flagHasChildren) && ! m_metadata.flags.contains(flagHasNoChildren)) {\n        return true;\n    } else {\n        fetch(model);\n        return m_children.size() > 1;\n    }\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemMailbox {\n  ool TreeItemMailbox::hasChildMailboxes(Model *const model)\n  {\n      if (fetched() || isUnavailable(model)) {\n          return m_children.size() > 1;\n      } else if (hasNoChildMailboxesAlreadyKnown()) {\n          return false;\n      } else if (m_metadata.flags.contains(flagHasChildren) && ! m_metadata.flags.contains(flagHasNoChildren)) {\n          return true;\n      } else {\n          fetch(model);\n          return m_children.size() > 1;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tatic_cast<Model *>",
          "args": [
            "ourceModel())"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ourceModel(",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ynamic_cast<TreeItemMailbox *>",
          "args": [
            "tatic_cast<TreeItem *>(\n                                    index.internalPointer()\n                                ))"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<TreeItem *>",
          "args": [
            "ndex.internalPointer()"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.internalPointer",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "apToSource(",
          "args": [
            "arent)"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "mapToSource(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "175-182",
          "snippet": "ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n{\n    int row = proxyIndex.row();\n    if (row < 0 || proxyIndex.column() != 0)\n        return QModelIndex();\n    ++row;\n    return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ModelIndex MailboxModel::mapToSource(const QModelIndex &proxyIndex) const\n  {\n      int row = proxyIndex.row();\n      if (row < 0 || proxyIndex.column() != 0)\n          return QModelIndex();\n      ++row;\n      return static_cast<Imap::Mailbox::Model *>(sourceModel())->createIndex(row, 0, proxyIndex.internalPointer());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arent.column",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent.isValid",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ool MailboxModel::hasChildren(const QModelIndex &parent) const\n  {\n      if (parent.isValid() && parent.column() != 0)\n          return false;\n  \n      QModelIndex index = mapToSource(parent);\n  \n      TreeItemMailbox *mbox = dynamic_cast<TreeItemMailbox *>(\n                                  static_cast<TreeItem *>(\n                                      index.internalPointer()\n                                  ));\n      return mbox ?\n             mbox->hasChildMailboxes(static_cast<Model *>(sourceModel())) :\n             sourceModel()->hasChildren(index);\n  }\n}"
  },
  {
    "function_name": "handleModelReset(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "96-99",
    "snippet": "oid MailboxModel::handleModelReset()\n{\n    endResetModel();\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ndResetModel(",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleModelReset()\n  {\n      endResetModel();\n  }\n}"
  },
  {
    "function_name": "handleModelAboutToBeReset(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "91-94",
    "snippet": "oid MailboxModel::handleModelAboutToBeReset()\n{\n    beginResetModel();\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eginResetModel(",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleModelAboutToBeReset()\n  {\n      beginResetModel();\n  }\n}"
  },
  {
    "function_name": "roleNames(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "70-89",
    "snippet": "Hash<int, QByteArray> MailboxModel::roleNames() const\n#endif\n{\n    static QHash<int, QByteArray> roleNames;\n    if (roleNames.isEmpty()) {\n        roleNames[RoleIsFetched] = \"isFetched\";\n        roleNames[RoleShortMailboxName] = \"shortMailboxName\";\n        roleNames[RoleMailboxName] = \"mailboxName\";\n        roleNames[RoleMailboxSeparator] = \"mailboxSeparator\";\n        roleNames[RoleMailboxHasChildMailboxes] = \"mailboxHasChildMailboxes\";\n        roleNames[RoleMailboxIsINBOX] = \"mailboxIsINBOX\";\n        roleNames[RoleMailboxIsSelectable] = \"mailboxIsSelectable\";\n        roleNames[RoleMailboxNumbersFetched] = \"mailboxNumbersFetched\";\n        roleNames[RoleTotalMessageCount] = \"totalMessageCount\";\n        roleNames[RoleUnreadMessageCount] = \"unreadMessageCount\";\n        roleNames[RoleRecentMessageCount] = \"recentMessageCount\";\n        roleNames[RoleMailboxItemsAreLoading] = \"mailboxItemsAreLoading\";\n    }\n    return roleNames;\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "oleNames.isEmpty",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  Hash<int, QByteArray> MailboxModel::roleNames() const\n  #endif\n  {\n      static QHash<int, QByteArray> roleNames;\n      if (roleNames.isEmpty()) {\n          roleNames[RoleIsFetched] = \"isFetched\";\n          roleNames[RoleShortMailboxName] = \"shortMailboxName\";\n          roleNames[RoleMailboxName] = \"mailboxName\";\n          roleNames[RoleMailboxSeparator] = \"mailboxSeparator\";\n          roleNames[RoleMailboxHasChildMailboxes] = \"mailboxHasChildMailboxes\";\n          roleNames[RoleMailboxIsINBOX] = \"mailboxIsINBOX\";\n          roleNames[RoleMailboxIsSelectable] = \"mailboxIsSelectable\";\n          roleNames[RoleMailboxNumbersFetched] = \"mailboxNumbersFetched\";\n          roleNames[RoleTotalMessageCount] = \"totalMessageCount\";\n          roleNames[RoleUnreadMessageCount] = \"unreadMessageCount\";\n          roleNames[RoleRecentMessageCount] = \"recentMessageCount\";\n          roleNames[RoleMailboxItemsAreLoading] = \"mailboxItemsAreLoading\";\n      }\n      return roleNames;\n  }\n}"
  },
  {
    "function_name": "MailboxModel(",
    "container": "ailboxModel",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
    "lines": "35-63",
    "snippet": "ailboxModel::MailboxModel(QObject *parent, Model *model): QAbstractProxyModel(parent)\n{\n    setSourceModel(model);\n\n    // FIXME: will need to be expanded when Model supports more signals...\n    connect(model, SIGNAL(modelAboutToBeReset()), this, SLOT(handleModelAboutToBeReset()));\n    connect(model, SIGNAL(modelReset()), this, SLOT(handleModelReset()));\n    connect(model, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n    connect(model, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n    connect(model, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n            this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n    connect(model, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int, int)));\n    connect(model, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsRemoved(const QModelIndex &, int, int)));\n    connect(model, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int, int)));\n    connect(model, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsInserted(const QModelIndex &, int, int)));\n    connect(model, SIGNAL(messageCountPossiblyChanged(const QModelIndex &)),\n            this, SLOT(handleMessageCountPossiblyChanged(const QModelIndex &)));\n\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // There's no virtual in Qt4.\n    setRoleNames(trojitaProxyRoleNames());\n#else\n    // In Qt5, the roleNames() is virtual and will work just fine.\n#endif\n}",
    "includes": [
      "include <QMimeData>",
      "include <QDebug>\n#",
      "include \"ItemRoles.h\"",
      "include \"MailboxTree.h\"\n#",
      "include \"MailboxModel.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etRoleNames(",
          "args": [
            "rojitaProxyRoleNames())"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "proxySetRoleNames(",
          "container": "DescendantsProxyModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/kdeui-itemviews/kdescendantsproxymodel.cpp",
          "lines": "999-1007",
          "snippet": "oid KDescendantsProxyModel::proxySetRoleNames(const QHash<int, QByteArray> &roleNames)\n{\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    setRoleNames(roleNames);\n#else\n  Q_D(KDescendantsProxyModel);\n  d->m_roleNames = roleNames;\n#endif\n}",
          "includes": [
            "include \"moc_kdescendantsproxymodel.cpp\"",
            "include \"kbihash_p.h\"",
            "include <QtCore/QTimer>",
            "include <QtCore/QStringList>\n#",
            "include \"kdescendantsproxymodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"moc_kdescendantsproxymodel.cpp\"\ninclude \"kbihash_p.h\"\ninclude <QtCore/QTimer>\ninclude <QtCore/QStringList>\n#\ninclude \"kdescendantsproxymodel.h\"\n\nDescendantsProxyModel {\n  oid KDescendantsProxyModel::proxySetRoleNames(const QHash<int, QByteArray> &roleNames)\n  {\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      setRoleNames(roleNames);\n  #else\n    Q_D(KDescendantsProxyModel);\n    d->m_roleNames = roleNames;\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rojitaProxyRoleNames(",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "odel,",
            "IGNAL(layoutChanged()),",
            "his,",
            "IGNAL(layoutChanged()))"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ayoutChanged())"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayoutChanged(",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "layoutChanged(",
          "container": "odelWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelWatcher.cpp",
          "lines": "94-97",
          "snippet": "oid ModelWatcher::layoutChanged()\n{\n    qDebug() << sender()->objectName() << \"layoutChanged()\";\n}",
          "includes": [
            "include \"ModelWatcher.h\"",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"ModelWatcher.h\"\ninclude <QDebug>\n#\n\nodelWatcher {\n  oid ModelWatcher::layoutChanged()\n  {\n      qDebug() << sender()->objectName() << \"layoutChanged()\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ayoutChanged())"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "odel,",
            "IGNAL(layoutAboutToBeChanged()),",
            "his,",
            "IGNAL(layoutAboutToBeChanged()))"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ayoutAboutToBeChanged())"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayoutAboutToBeChanged(",
          "args": [],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "layoutAboutToBeChanged(",
          "container": "odelWatcher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelWatcher.cpp",
          "lines": "89-92",
          "snippet": "oid ModelWatcher::layoutAboutToBeChanged()\n{\n    qDebug() << sender()->objectName() << \"layoutAboutToBeChanged()\";\n}",
          "includes": [
            "include \"ModelWatcher.h\"",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"ModelWatcher.h\"\ninclude <QDebug>\n#\n\nodelWatcher {\n  oid ModelWatcher::layoutAboutToBeChanged()\n  {\n      qDebug() << sender()->objectName() << \"layoutAboutToBeChanged()\";\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ayoutAboutToBeChanged())"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "odel,",
            "IGNAL(modelReset()),",
            "his,",
            "LOT(handleModelReset()))"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "andleModelReset())"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "andleModelReset(",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "handleModelReset(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "96-99",
          "snippet": "oid MailboxModel::handleModelReset()\n{\n    endResetModel();\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleModelReset()\n  {\n      endResetModel();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "odelReset())"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "odel,",
            "IGNAL(modelAboutToBeReset()),",
            "his,",
            "LOT(handleModelAboutToBeReset()))"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "andleModelAboutToBeReset())"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "andleModelAboutToBeReset(",
          "args": [],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "handleModelAboutToBeReset(",
          "container": "ailboxModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxModel.cpp",
          "lines": "91-94",
          "snippet": "oid MailboxModel::handleModelAboutToBeReset()\n{\n    beginResetModel();\n}",
          "includes": [
            "include <QMimeData>",
            "include <QDebug>\n#",
            "include \"ItemRoles.h\"",
            "include \"MailboxTree.h\"\n#",
            "include \"MailboxModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  oid MailboxModel::handleModelAboutToBeReset()\n  {\n      beginResetModel();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "odelAboutToBeReset())"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etSourceModel(",
          "args": [
            "odel)"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "setSourceModel(",
          "container": "hreadingMsgListModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ThreadingMsgListModel.cpp",
          "lines": "71-109",
          "snippet": "oid ThreadingMsgListModel::setSourceModel(QAbstractItemModel *sourceModel)\n{\n    threading.clear();\n    ptrToInternal.clear();\n    unknownUids.clear();\n    threadedRootIds.clear();\n    m_currentSortResult.clear();\n    m_searchValidity = RESULT_INVALIDATED;\n\n    if (this->sourceModel()) {\n        // there's already something, so take care to disconnect all signals\n        this->sourceModel()->disconnect(this);\n    }\n\n    RESET_MODEL;\n\n    if (!sourceModel)\n        return;\n\n    Imap::Mailbox::MsgListModel *msgList = qobject_cast<Imap::Mailbox::MsgListModel *>(sourceModel);\n    Q_ASSERT(msgList);\n    QAbstractProxyModel::setSourceModel(msgList);\n\n    // FIXME: will need to be expanded when Model supports more signals...\n    connect(sourceModel, SIGNAL(modelReset()), this, SLOT(resetMe()));\n    connect(sourceModel, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n    connect(sourceModel, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n    connect(sourceModel, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n            this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n    connect(sourceModel, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsRemoved(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int,int)));\n    connect(sourceModel, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n            this, SLOT(handleRowsInserted(const QModelIndex &, int,int)));\n    resetMe();\n}",
          "includes": [
            "include \"QAIM_reset.h\"",
            "include \"MsgListModel.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/ThreadTask.h\"\n#",
            "include \"Imap/Tasks/SortTask.h\"\n#",
            "include <QDebug>\n#",
            "include <QBuffer>\n#",
            "include <algorithm>\n#",
            "include \"ThreadingMsgListModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"QAIM_reset.h\"\ninclude \"MsgListModel.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/ThreadTask.h\"\n#\ninclude \"Imap/Tasks/SortTask.h\"\n#\ninclude <QDebug>\n#\ninclude <QBuffer>\n#\ninclude <algorithm>\n#\ninclude \"ThreadingMsgListModel.h\"\n#\n\nhreadingMsgListModel {\n  oid ThreadingMsgListModel::setSourceModel(QAbstractItemModel *sourceModel)\n  {\n      threading.clear();\n      ptrToInternal.clear();\n      unknownUids.clear();\n      threadedRootIds.clear();\n      m_currentSortResult.clear();\n      m_searchValidity = RESULT_INVALIDATED;\n  \n      if (this->sourceModel()) {\n          // there's already something, so take care to disconnect all signals\n          this->sourceModel()->disconnect(this);\n      }\n  \n      RESET_MODEL;\n  \n      if (!sourceModel)\n          return;\n  \n      Imap::Mailbox::MsgListModel *msgList = qobject_cast<Imap::Mailbox::MsgListModel *>(sourceModel);\n      Q_ASSERT(msgList);\n      QAbstractProxyModel::setSourceModel(msgList);\n  \n      // FIXME: will need to be expanded when Model supports more signals...\n      connect(sourceModel, SIGNAL(modelReset()), this, SLOT(resetMe()));\n      connect(sourceModel, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n      connect(sourceModel, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n      connect(sourceModel, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n              this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n      connect(sourceModel, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsRemoved(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int,int)));\n      connect(sourceModel, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsInserted(const QModelIndex &, int,int)));\n      resetMe();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QMimeData>\ninclude <QDebug>\n#\ninclude \"ItemRoles.h\"\ninclude \"MailboxTree.h\"\n#\ninclude \"MailboxModel.h\"\n#\n\nailboxModel {\n  ailboxModel::MailboxModel(QObject *parent, Model *model): QAbstractProxyModel(parent)\n  {\n      setSourceModel(model);\n  \n      // FIXME: will need to be expanded when Model supports more signals...\n      connect(model, SIGNAL(modelAboutToBeReset()), this, SLOT(handleModelAboutToBeReset()));\n      connect(model, SIGNAL(modelReset()), this, SLOT(handleModelReset()));\n      connect(model, SIGNAL(layoutAboutToBeChanged()), this, SIGNAL(layoutAboutToBeChanged()));\n      connect(model, SIGNAL(layoutChanged()), this, SIGNAL(layoutChanged()));\n      connect(model, SIGNAL(dataChanged(const QModelIndex &, const QModelIndex &)),\n              this, SLOT(handleDataChanged(const QModelIndex &, const QModelIndex &)));\n      connect(model, SIGNAL(rowsAboutToBeRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeRemoved(const QModelIndex &, int, int)));\n      connect(model, SIGNAL(rowsRemoved(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsRemoved(const QModelIndex &, int, int)));\n      connect(model, SIGNAL(rowsAboutToBeInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsAboutToBeInserted(const QModelIndex &, int, int)));\n      connect(model, SIGNAL(rowsInserted(const QModelIndex &, int, int)),\n              this, SLOT(handleRowsInserted(const QModelIndex &, int, int)));\n      connect(model, SIGNAL(messageCountPossiblyChanged(const QModelIndex &)),\n              this, SLOT(handleMessageCountPossiblyChanged(const QModelIndex &)));\n  \n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // There's no virtual in Qt4.\n      setRoleNames(trojitaProxyRoleNames());\n  #else\n      // In Qt5, the roleNames() is virtual and will work just fine.\n  #endif\n  }\n}"
  }
]