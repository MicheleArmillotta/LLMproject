[
  {
    "function_name": "ExternalElementsWidget(",
    "container": "xternalElementsWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ExternalElementsWidget.cpp",
    "lines": "31-56",
    "snippet": "xternalElementsWidget::ExternalElementsWidget(QWidget *parent):\n    QWidget(parent)\n{\n    QHBoxLayout *layout = new QHBoxLayout(this);\n    loadStuffButton = new QPushButton(tr(\"Load\"), this);\n    QLabel *lbl = new QLabel(tr(\"This e-mail wants to load external entities from the Internet\"), this);\n    layout->addWidget(lbl);\n    layout->addWidget(loadStuffButton);\n    layout->addStretch();\n    setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Fixed);\n    connect(loadStuffButton, SIGNAL(clicked()), this, SIGNAL(loadingEnabled()));\n\n    /*\n    FIXME: would be cool to have more clear error messages\n\n    Also perhaps provide a list of URLs of external entities? But note that\n    the current implementation is an \"all or nothing\" -- once the user clicks\n    the \"allow external entities\" button, they will be enabled for the current\n    message until it is closed. Therefore, it is possible that user allows requests\n    to a presumably \"safe site\", but something evil subsequently asks for something\n    from a malicious, third-party site. I'm not sure how they'd do that, though, given\n    that we already do disable JavaScript...\n\n    */\n\n}",
    "includes": [
      "include <QPushButton>",
      "include <QLabel>\n#",
      "include <QHBoxLayout>\n#",
      "include \"ExternalElementsWidget.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "oadStuffButton,",
            "IGNAL(clicked()),",
            "his,",
            "IGNAL(loadingEnabled()))"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "oadingEnabled())"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadingEnabled(",
          "args": [],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "licked())"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "licked(",
          "args": [],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "loadClicked(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "55-74",
          "snippet": "oid LoadablePartWidget::loadClicked()\n{\n    if (!partIndex.isValid()) {\n        if (loadButton) {\n            loadButton->setEnabled(false);\n        }\n        return;\n    }\n    if (loadButton) {\n        loadButton->deleteLater();\n        loadButton = 0;\n    }\n\n    // We have to disable any flags which might cause recursion here\n    realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                 (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                  | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n    addWidget(realPart);\n    setCurrentIndex(1);\n}",
          "includes": [
            "include <QPushButton>",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"LoadablePartWidget.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oid LoadablePartWidget::loadClicked()\n  {\n      if (!partIndex.isValid()) {\n          if (loadButton) {\n              loadButton->setEnabled(false);\n          }\n          return;\n      }\n      if (loadButton) {\n          loadButton->deleteLater();\n          loadButton = 0;\n      }\n  \n      // We have to disable any flags which might cause recursion here\n      realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                   (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                    | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n      addWidget(realPart);\n      setCurrentIndex(1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "etSizePolicy(",
          "args": [
            "SizePolicy::Preferred,",
            "SizePolicy::Fixed)"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addStretch",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "oadStuffButton)"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "bl)"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "This e-mail wants to load external entities from the Internet\")"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QPushButton>\ninclude <QLabel>\n#\ninclude <QHBoxLayout>\n#\ninclude \"ExternalElementsWidget.h\"\n\nxternalElementsWidget {\n  xternalElementsWidget::ExternalElementsWidget(QWidget *parent):\n      QWidget(parent)\n  {\n      QHBoxLayout *layout = new QHBoxLayout(this);\n      loadStuffButton = new QPushButton(tr(\"Load\"), this);\n      QLabel *lbl = new QLabel(tr(\"This e-mail wants to load external entities from the Internet\"), this);\n      layout->addWidget(lbl);\n      layout->addWidget(loadStuffButton);\n      layout->addStretch();\n      setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Fixed);\n      connect(loadStuffButton, SIGNAL(clicked()), this, SIGNAL(loadingEnabled()));\n  \n      /*\n      FIXME: would be cool to have more clear error messages\n  \n      Also perhaps provide a list of URLs of external entities? But note that\n      the current implementation is an \"all or nothing\" -- once the user clicks\n      the \"allow external entities\" button, they will be enabled for the current\n      message until it is closed. Therefore, it is possible that user allows requests\n      to a presumably \"safe site\", but something evil subsequently asks for something\n      from a malicious, third-party site. I'm not sure how they'd do that, though, given\n      that we already do disable JavaScript...\n  \n      */\n  \n  }\n}"
  }
]