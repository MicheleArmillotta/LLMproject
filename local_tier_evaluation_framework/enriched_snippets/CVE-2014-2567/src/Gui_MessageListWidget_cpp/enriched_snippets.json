[
  {
    "function_name": "MessageListWidget(",
    "container": "essageListWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/MessageListWidget.cpp",
    "lines": "40-310",
    "snippet": "essageListWidget::MessageListWidget(QWidget *parent) :\n    QWidget(parent), m_supportsFuzzySearch(false)\n{\n    tree = new MsgListView(this);\n\n    m_quickSearchText = new LineEdit(this);\n    m_quickSearchText->setHistoryEnabled(true);\n    // Filter out newline. It will wreak havoc into the direct IMAP passthrough and could lead to data loss.\n    QValidator *validator = new ReplaceCharValidator(QLatin1Char('\\n'), QLatin1Char(' '), m_quickSearchText);\n    m_quickSearchText->setValidator(validator);\n#if QT_VERSION >= 0x040700\n    m_quickSearchText->setPlaceholderText(tr(\"Quick Search\"));\n#endif\n    m_quickSearchText->setToolTip(tr(\"Type in a text to search for within this mailbox. \"\n                                     \"The icon on the left can be used to limit the search options \"\n                                     \"(like whether to include addresses or message bodies, etc).\"\n                                     \"<br/><hr/>\"\n                                     \"Experts who have read RFC3501 can use the <code>:=</code> prefix and switch to a raw IMAP mode.\"));\n    m_queryPlaceholder = tr(\"<query>\");\n\n    connect(m_quickSearchText, SIGNAL(returnPressed()), this, SLOT(slotApplySearch()));\n    connect(m_quickSearchText, SIGNAL(textChanged(QString)), this, SLOT(slotConditionalSearchReset()));\n    connect(m_quickSearchText, SIGNAL(cursorPositionChanged(int, int)), this, SLOT(slotUpdateSearchCursor()));\n\n    m_searchOptions = new QToolButton(this);\n    m_searchOptions->setAutoRaise(true);\n    m_searchOptions->setPopupMode(QToolButton::InstantPopup);\n    m_searchOptions->setText(\"*\");\n    m_searchOptions->setIcon(loadIcon(QLatin1String(\"imap-search-details\")));\n    QMenu *optionsMenu = new QMenu(m_searchOptions);\n    m_searchFuzzy = optionsMenu->addAction(tr(\"Fuzzy Search\"));\n    m_searchFuzzy->setCheckable(true);\n    optionsMenu->addSeparator();\n    m_searchInSubject = optionsMenu->addAction(tr(\"Subject\"));\n    m_searchInSubject->setCheckable(true);\n    m_searchInSubject->setChecked(true);\n    m_searchInBody = optionsMenu->addAction(tr(\"Body\"));\n    m_searchInBody->setCheckable(true);\n    m_searchInSenders = optionsMenu->addAction(tr(\"Senders\"));\n    m_searchInSenders->setCheckable(true);\n    m_searchInSenders->setChecked(true);\n    m_searchInRecipients = optionsMenu->addAction(tr(\"Recipients\"));\n    m_searchInRecipients->setCheckable(true);\n\n    optionsMenu->addSeparator();\n\n    QMenu *complexMenu = new QMenu(tr(\"Complex IMAP query\"), optionsMenu);\n    connect(complexMenu, SIGNAL(triggered(QAction*)), this, SLOT(slotComplexSearchInput(QAction*)));\n    complexMenu->addAction(tr(\"Not ...\"))->setData(\"NOT \" + m_queryPlaceholder);\n    complexMenu->addAction(tr(\"Either... or...\"))->setData(\"OR \" + m_queryPlaceholder + \" \" + m_queryPlaceholder);\n    complexMenu->addSeparator();\n    complexMenu->addAction(tr(\"From sender\"))->setData(\"FROM \" + m_queryPlaceholder);\n    complexMenu->addAction(tr(\"To receiver\"))->setData(\"TO \" + m_queryPlaceholder);\n    complexMenu->addSeparator();\n    complexMenu->addAction(tr(\"About subject\"))->setData(\"SUBJECT \" + m_queryPlaceholder);\n    complexMenu->addAction(tr(\"Message contains ...\"))->setData(\"BODY \" + m_queryPlaceholder);\n    complexMenu->addSeparator();\n    complexMenu->addAction(tr(\"Before date\"))->setData(\"BEFORE <d-mmm-yyyy>\");\n    complexMenu->addAction(tr(\"Since date\"))->setData(\"SINCE <d-mmm-yyyy>\");\n    complexMenu->addSeparator();\n    complexMenu->addAction(tr(\"Has been seen\"))->setData(\"SEEN\");\n\n    m_rawSearch = optionsMenu->addAction(tr(\"Allow raw IMAP search\"));\n    m_rawSearch->setCheckable(true);\n    QAction *rawSearchMenu = optionsMenu->addMenu(complexMenu);\n    rawSearchMenu->setVisible(false);\n    connect (m_rawSearch, SIGNAL(toggled(bool)), rawSearchMenu, SLOT(setVisible(bool)));\n    connect (m_rawSearch, SIGNAL(toggled(bool)), SIGNAL(rawSearchSettingChanged(bool)));\n\n    m_searchOptions->setMenu(optionsMenu);\n    connect (optionsMenu, SIGNAL(aboutToShow()), SLOT(slotDeActivateSimpleSearch()));\n\n    delete m_quickSearchText->layout();\n    QHBoxLayout *hlayout = new QHBoxLayout(m_quickSearchText);\n    hlayout->setContentsMargins(0, 0, 0, 0);\n    hlayout->addWidget(m_searchOptions);\n    hlayout->addStretch();\n    hlayout->addWidget(m_quickSearchText->clearButton());\n    hlayout->activate(); // this processes the layout and ensures the toolbutton has it's final dimensions\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n    if (QGuiApplication::isLeftToRight())\n#else\n    if (qApp->keyboardInputDirection() == Qt::LeftToRight)\n#endif\n        m_quickSearchText->setTextMargins(m_searchOptions->width(), 0, 0, 0);\n    else // ppl. in N Africa and the middle east write the wrong direction...\n        m_quickSearchText->setTextMargins(0, 0, m_searchOptions->width(), 0);\n    m_searchOptions->setCursor(Qt::ArrowCursor); // inherits I-Beam from lineedit otherwise\n\n    QVBoxLayout *layout = new QVBoxLayout(this);\n    layout->setSpacing(0);\n    layout->addWidget(m_quickSearchText);\n    layout->addWidget(tree);\n\n    m_searchResetTimer = new QTimer(this);\n    m_searchResetTimer->setSingleShot(true);\n    connect(m_searchResetTimer, SIGNAL(timeout()), SLOT(slotApplySearch()));\n\n    slotAutoEnableDisableSearch();\n}\n\nvoid MessageListWidget::focusSearch()\n{\n    if (!m_quickSearchText->isEnabled() || m_quickSearchText->hasFocus())\n        return;\n    m_quickSearchText->setFocus(Qt::ShortcutFocusReason);\n}\n\nvoid MessageListWidget::focusRawSearch()\n{\n    if (!m_quickSearchText->isEnabled() || m_quickSearchText->hasFocus() || !m_rawSearch->isChecked())\n        return;\n    m_quickSearchText->setFocus(Qt::ShortcutFocusReason);\n    m_quickSearchText->setText(\":=\");\n    m_quickSearchText->deselect();\n    m_quickSearchText->setCursorPosition(m_quickSearchText->text().length());\n}\n\nvoid MessageListWidget::slotApplySearch()\n{\n    emit requestingSearch(searchConditions());\n}\n\nvoid MessageListWidget::slotAutoEnableDisableSearch()\n{\n    bool isEnabled;\n    if (!m_quickSearchText->text().isEmpty()) {\n        // Some search criteria are in effect and suddenly all matching messages\n        // disappear. We have to make sure that the search bar remains enabled.\n        isEnabled = true;\n    } else if (tree && tree->model()) {\n        isEnabled = tree->model()->rowCount();\n    } else {\n        isEnabled = false;\n    }\n    m_quickSearchText->setEnabled(isEnabled);\n    m_searchOptions->setEnabled(isEnabled);\n}\n\nvoid MessageListWidget::slotSortingFailed()\n{\n    QPalette pal = m_quickSearchText->palette();\n    pal.setColor(m_quickSearchText->backgroundRole(), Qt::red);\n    pal.setColor(m_quickSearchText->foregroundRole(), Qt::white);\n    m_quickSearchText->setPalette(pal);\n    QTimer::singleShot(500, this, SLOT(slotResetSortingFailed()));\n}\n\nvoid MessageListWidget::slotResetSortingFailed()\n{\n    m_quickSearchText->setPalette(QPalette());\n}\n\nvoid MessageListWidget::slotConditionalSearchReset()\n{\n    if (m_quickSearchText->text().isEmpty())\n        m_searchResetTimer->start(250);\n    else\n        m_searchResetTimer->stop();\n}\n\nvoid MessageListWidget::slotUpdateSearchCursor()\n{\n    int cp = m_quickSearchText->cursorPosition();\n    int ts = -1, te = -1;\n    for (int i = cp-1; i > -1; --i) {\n        if (m_quickSearchText->text().at(i) == '>')\n            break; // invalid\n        if (m_quickSearchText->text().at(i) == '<') {\n            ts = i;\n            break; // found TagStart\n        }\n    }\n    if (ts < 0)\n        return; // not inside tag!\n    for (int i = cp; i < m_quickSearchText->text().length(); ++i) {\n        if (m_quickSearchText->text().at(i) == '<')\n            break; // invalid\n        if (m_quickSearchText->text().at(i) == '>') {\n            te = i;\n            break; // found TagEnd\n        }\n    }\n    if (te < 0)\n        return; // not inside tag?\n    if (m_quickSearchText->text().midRef(ts, m_queryPlaceholder.length()) == m_queryPlaceholder)\n        m_quickSearchText->setSelection(ts, m_queryPlaceholder.length());\n}\n\nvoid MessageListWidget::slotComplexSearchInput(QAction *act)\n{\n    QString s = act->data().toString();\n    const int selectionStart = m_quickSearchText->selectionStart() - 1;\n    if (selectionStart > -1 && m_quickSearchText->text().at(selectionStart) != ' ')\n            s.prepend(' ');\n    m_quickSearchText->insert(s);\n    if (!m_quickSearchText->text().startsWith(QLatin1String(\":=\"))) {\n        s = m_quickSearchText->text().trimmed();\n        m_quickSearchText->setText(\":=\" + s);\n    }\n    m_quickSearchText->setFocus();\n    const int pos = m_quickSearchText->text().indexOf(m_queryPlaceholder);\n    if (pos > -1)\n        m_quickSearchText->setSelection(pos, m_queryPlaceholder.length());\n}\n\nvoid MessageListWidget::slotDeActivateSimpleSearch()\n{\n    const bool isEnabled = !(m_rawSearch->isChecked() && m_quickSearchText->text().startsWith(QLatin1String(\":=\")));\n    m_searchInSubject->setEnabled(isEnabled);\n    m_searchInBody->setEnabled(isEnabled);\n    m_searchInSenders->setEnabled(isEnabled);\n    m_searchInRecipients->setEnabled(isEnabled);\n    m_searchFuzzy->setEnabled(isEnabled && m_supportsFuzzySearch);\n}\n\nQStringList MessageListWidget::searchConditions() const\n{\n    if (!m_quickSearchText->isEnabled() || m_quickSearchText->text().isEmpty())\n        return QStringList();\n\n    static QString rawPrefix = QLatin1String(\":=\");\n\n    if (m_rawSearch->isChecked() && m_quickSearchText->text().startsWith(rawPrefix)) {\n        // It's a \"raw\" IMAP search, let's simply pass it through\n        return QStringList() << m_quickSearchText->text().mid(rawPrefix.size());\n    }\n\n    QStringList keys;\n    if (m_searchInSubject->isChecked())\n        keys << QLatin1String(\"SUBJECT\");\n    if (m_searchInBody->isChecked())\n        keys << QLatin1String(\"BODY\");\n    if (m_searchInRecipients->isChecked())\n        keys << QLatin1String(\"TO\") << QLatin1String(\"CC\") << QLatin1String(\"BCC\");\n    if (m_searchInSenders->isChecked())\n        keys << QLatin1String(\"FROM\");\n\n    if (keys.isEmpty())\n        return keys;\n\n    QStringList res;\n    Q_FOREACH(const QString &key, keys) {\n        if (m_supportsFuzzySearch)\n            res << QLatin1String(\"FUZZY\");\n        res << key << m_quickSearchText->text();\n    }\n    if (keys.size() > 1) {\n        // Got to make this a conjunction. The OR operator's reverse-polish-notation accepts just two operands, though.\n        int num = keys.size() - 1;\n        for (int i = 0; i < num; ++i) {\n            res.prepend(QLatin1String(\"OR\"));\n        }\n    }\n\n    return res;\n}\n\nvoid MessageListWidget::setFuzzySearchSupported(bool supported)\n{\n    m_supportsFuzzySearch = supported;\n    m_searchFuzzy->setEnabled(supported);\n    m_searchFuzzy->setChecked(supported);\n}\n\nvoid MessageListWidget::setRawSearchEnabled(bool enabled)\n{\n    m_rawSearch->setChecked(enabled);\n}\n\n}",
    "includes": [
      "include \"ReplaceCharValidator.h\"",
      "include \"MsgListView.h\"\n#",
      "include \"LineEdit.h\"\n#",
      "include \"IconLoader.h\"\n#",
      "include <QWidgetAction>\n#",
      "include <QVBoxLayout>\n#",
      "include <QToolButton>\n#",
      "include <QTimer>\n#",
      "include <QMenu>\n#",
      "include <QFrame>\n#",
      "include <QCheckBox>\n#",
      "include <QApplication>\n#",
      "include <QAction>\n#",
      "include \"MessageListWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_rawSearch->setChecked",
          "args": [
            "nabled)"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchFuzzy->setChecked",
          "args": [
            "upported)"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchFuzzy->setEnabled",
          "args": [
            "upported)"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "es.prepend",
          "args": [
            "Latin1String(\"OR\"))"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "OR\")"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eys.size",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eys.size",
          "args": [],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "FUZZY\")"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eys.isEmpty",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "FROM\")"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInSenders->isChecked",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "BCC\")"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "CC\")"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "TO\")"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInRecipients->isChecked",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "BODY\")"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInBody->isChecked",
          "args": [],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "SUBJECT\")"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInSubject->isChecked",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            "awPrefix.size())"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awPrefix.size",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringList(",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            "awPrefix)"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_rawSearch->isChecked",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ":=\")"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringList(",
          "args": [],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->isEnabled",
          "args": [],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchFuzzy->setEnabled",
          "args": [
            "sEnabled && m_supportsFuzzySearch)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInRecipients->setEnabled",
          "args": [
            "sEnabled)"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInSenders->setEnabled",
          "args": [
            "sEnabled)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInBody->setEnabled",
          "args": [
            "sEnabled)"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInSubject->setEnabled",
          "args": [
            "sEnabled)"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            "Latin1String(\":=\"))"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ":=\")"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_rawSearch->isChecked",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setSelection",
          "args": [
            "os,",
            "_queryPlaceholder.length())"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_queryPlaceholder.length",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            "_queryPlaceholder)"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setFocus",
          "args": [],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setText",
          "args": [
            ":=\" + s)"
          ],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            "Latin1String(\":=\"))"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ":=\")"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->insert",
          "args": [
            ")"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".prepend",
          "args": [
            "')"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            "electionStart)"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->selectionStart",
          "args": [],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ct->data",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setSelection",
          "args": [
            "s,",
            "_queryPlaceholder.length())"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_queryPlaceholder.length",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            "s,",
            "_queryPlaceholder.length())"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_queryPlaceholder.length",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            ")"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            ")"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            ")"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [
            ")"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->cursorPosition",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchResetTimer->stop",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchResetTimer->start",
          "args": [
            "50)"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setPalette",
          "args": [
            "Palette())"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Palette(",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Timer::singleShot(",
          "args": [
            "00,",
            "his,",
            "LOT(slotResetSortingFailed()))"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotResetSortingFailed())"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotResetSortingFailed(",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setPalette",
          "args": [
            "al)"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.setColor",
          "args": [
            "_quickSearchText->foregroundRole(),",
            "t::white)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->foregroundRole",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "al.setColor",
          "args": [
            "_quickSearchText->backgroundRole(),",
            "t::red)"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->backgroundRole",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->palette",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->setEnabled",
          "args": [
            "sEnabled)"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setEnabled",
          "args": [
            "sEnabled)"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree->model",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree->model",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ree->model",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setCursorPosition",
          "args": [
            "_quickSearchText->text().length())"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->text",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->deselect",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setText",
          "args": [
            ":=\")"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setFocus",
          "args": [
            "t::ShortcutFocusReason)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_rawSearch->isChecked",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->hasFocus",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->isEnabled",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setFocus",
          "args": [
            "t::ShortcutFocusReason)"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->hasFocus",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->isEnabled",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotAutoEnableDisableSearch(",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_searchResetTimer,",
            "IGNAL(timeout()),",
            "LOT(slotApplySearch()))"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotApplySearch())"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotApplySearch(",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "imeout())"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "imeout(",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchResetTimer->setSingleShot",
          "args": [
            "rue)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "ree)"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "_quickSearchText)"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->setSpacing",
          "args": [
            ")"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->setCursor",
          "args": [
            "t::ArrowCursor)"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setTextMargins",
          "args": [
            ",",
            ",",
            "_searchOptions->width(),",
            ")"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->width",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setTextMargins",
          "args": [
            "_searchOptions->width(),",
            ",",
            ",",
            ")"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->width",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "App->keyboardInputDirection",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GuiApplication::isLeftToRight(",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout->activate",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout->addWidget",
          "args": [
            "_quickSearchText->clearButton())"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->clearButton",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout->addStretch",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout->addWidget",
          "args": [
            "_searchOptions)"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "layout->setContentsMargins",
          "args": [
            ",",
            ",",
            ",",
            ")"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->layout",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect",
          "args": [
            "ptionsMenu,",
            "IGNAL(aboutToShow()),",
            "LOT(slotDeActivateSimpleSearch()))"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "XtConnectPage(QW",
          "container": "onnectPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SettingsDialog.cpp",
          "lines": "767-826",
          "snippet": "onnectPage::XtConnectPage(QWidget *parent, QSettings &s, ImapPage *imapPage): QWidget(parent), imap(imapPage)\n{\n    // Take care not to clash with the cache of the GUI\n    QString cacheLocation = Common::writablePath(Common::LOCATION_CACHE) + QString::fromAscii(\"xtconnect-trojita\");\n    QFormLayout *layout = new QFormLayout(this);\n    cacheDir = new QLineEdit(s.value(Common::SettingsNames::xtConnectCacheDirectory, cacheLocation).toString(), this);\n    layout->addRow(tr(\"Cache Directory\"), cacheDir);\n\n    QGroupBox *box = new QGroupBox(tr(\"Mailboxes to synchronize\"), this);\n    QVBoxLayout *boxLayout = new QVBoxLayout(box);\n    QListWidget *mailboxes = new QListWidget(box);\n    mailboxes->addItems(s.value(Common::SettingsNames::xtSyncMailboxList).toStringList());\n    for (int i = 0; i < mailboxes->count(); ++i) {\n        mailboxes->item(i)->setFlags(Qt::ItemIsEnabled);\n    }\n    mailboxes->setToolTip(tr(\"Please use context menu inside the main application to select mailboxes to synchronize\"));\n    boxLayout->addWidget(mailboxes);\n    layout->addRow(box);\n\n    QString optionHost = s.value(Common::SettingsNames::xtDbHost).toString();\n    int optionPort = s.value(Common::SettingsNames::xtDbPort, QVariant(5432)).toInt();\n    QString optionDbname = s.value(Common::SettingsNames::xtDbDbName).toString();\n    QString optionUsername = s.value(Common::SettingsNames::xtDbUser).toString();\n\n    QStringList args = QCoreApplication::arguments();\n    for (int i = 1; i < args.length(); i++) {\n        if (args.at(i) == \"-h\" && args.length() > i)\n            optionHost = args.at(++i);\n        else if (args.at(i) == \"-d\" && args.length() > i)\n            optionDbname = args.at(++i);\n        else if (args.at(i) == \"-p\" && args.length() > i)\n            optionPort = args.at(++i).toInt();\n        else if (args.at(i) == \"-U\" && args.length() > i)\n            optionUsername = args.at(++i);\n    }\n\n\n    hostName = new QLineEdit(optionHost);\n    layout->addRow(tr(\"DB Hostname\"), hostName);\n    port = new QSpinBox();\n    port->setRange(1, 65535);\n    port->setValue(optionPort);\n    layout->addRow(tr(\"DB Port\"), port);\n    dbName = new QLineEdit(optionDbname);\n    layout->addRow(tr(\"DB Name\"), dbName);\n    username = new QLineEdit(optionUsername);\n    layout->addRow(tr(\"DB Username\"), username);\n\n    imapPasswordWarning = new QLabel(tr(\"Please fill in all IMAP options, including the password, at the IMAP page. \"\n                                        \"If you do not save the password, background synchronization will not run.\"), this);\n    imapPasswordWarning->setWordWrap(true);\n    imapPasswordWarning->setStyleSheet(SettingsDialog::warningStyleSheet);\n    layout->addRow(imapPasswordWarning);\n    debugLog = new QCheckBox();\n    layout->addRow(tr(\"Debugging\"), debugLog);\n\n    QPushButton *btn = new QPushButton(tr(\"Run xTuple Synchronization\"));\n    connect(btn, SIGNAL(clicked()), this, SLOT(runXtConnect()));\n    layout->addRow(btn);\n}\n\nv",
          "includes": [
            "include \"Gui/Util.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include <QDataWidgetMapper>\n#",
            "include <QMessageBox>\n#",
            "include <QToolTip>\n#",
            "include <QStandardItemModel>\n#",
            "include <QDebug>\n#",
            "include <QResizeEvent>\n#",
            "include <QPushButton>\n#",
            "include <QProcess>\n#",
            "include <QVBoxLayout>\n#",
            "include <QTabWidget>\n#",
            "include <QSpinBox>\n#",
            "include <QRadioButton>\n#",
            "include <QListWidget>\n#",
            "include <QLineEdit>\n#",
            "include <QInputDialog>\n#",
            "include <QGroupBox>\n#",
            "include <QFormLayout>\n#",
            "include <QDir>\n#",
            "include <QDialogButtonBox>\n#",
            "include <QComboBox>\n#",
            "include <QCheckBox>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Gui/Util.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude <QDataWidgetMapper>\n#\ninclude <QMessageBox>\n#\ninclude <QToolTip>\n#\ninclude <QStandardItemModel>\n#\ninclude <QDebug>\n#\ninclude <QResizeEvent>\n#\ninclude <QPushButton>\n#\ninclude <QProcess>\n#\ninclude <QVBoxLayout>\n#\ninclude <QTabWidget>\n#\ninclude <QSpinBox>\n#\ninclude <QRadioButton>\n#\ninclude <QListWidget>\n#\ninclude <QLineEdit>\n#\ninclude <QInputDialog>\n#\ninclude <QGroupBox>\n#\ninclude <QFormLayout>\n#\ninclude <QDir>\n#\ninclude <QDialogButtonBox>\n#\ninclude <QComboBox>\n#\ninclude <QCheckBox>\n#\n\nonnectPage {\n  onnectPage::XtConnectPage(QWidget *parent, QSettings &s, ImapPage *imapPage): QWidget(parent), imap(imapPage)\n  {\n      // Take care not to clash with the cache of the GUI\n      QString cacheLocation = Common::writablePath(Common::LOCATION_CACHE) + QString::fromAscii(\"xtconnect-trojita\");\n      QFormLayout *layout = new QFormLayout(this);\n      cacheDir = new QLineEdit(s.value(Common::SettingsNames::xtConnectCacheDirectory, cacheLocation).toString(), this);\n      layout->addRow(tr(\"Cache Directory\"), cacheDir);\n  \n      QGroupBox *box = new QGroupBox(tr(\"Mailboxes to synchronize\"), this);\n      QVBoxLayout *boxLayout = new QVBoxLayout(box);\n      QListWidget *mailboxes = new QListWidget(box);\n      mailboxes->addItems(s.value(Common::SettingsNames::xtSyncMailboxList).toStringList());\n      for (int i = 0; i < mailboxes->count(); ++i) {\n          mailboxes->item(i)->setFlags(Qt::ItemIsEnabled);\n      }\n      mailboxes->setToolTip(tr(\"Please use context menu inside the main application to select mailboxes to synchronize\"));\n      boxLayout->addWidget(mailboxes);\n      layout->addRow(box);\n  \n      QString optionHost = s.value(Common::SettingsNames::xtDbHost).toString();\n      int optionPort = s.value(Common::SettingsNames::xtDbPort, QVariant(5432)).toInt();\n      QString optionDbname = s.value(Common::SettingsNames::xtDbDbName).toString();\n      QString optionUsername = s.value(Common::SettingsNames::xtDbUser).toString();\n  \n      QStringList args = QCoreApplication::arguments();\n      for (int i = 1; i < args.length(); i++) {\n          if (args.at(i) == \"-h\" && args.length() > i)\n              optionHost = args.at(++i);\n          else if (args.at(i) == \"-d\" && args.length() > i)\n              optionDbname = args.at(++i);\n          else if (args.at(i) == \"-p\" && args.length() > i)\n              optionPort = args.at(++i).toInt();\n          else if (args.at(i) == \"-U\" && args.length() > i)\n              optionUsername = args.at(++i);\n      }\n  \n  \n      hostName = new QLineEdit(optionHost);\n      layout->addRow(tr(\"DB Hostname\"), hostName);\n      port = new QSpinBox();\n      port->setRange(1, 65535);\n      port->setValue(optionPort);\n      layout->addRow(tr(\"DB Port\"), port);\n      dbName = new QLineEdit(optionDbname);\n      layout->addRow(tr(\"DB Name\"), dbName);\n      username = new QLineEdit(optionUsername);\n      layout->addRow(tr(\"DB Username\"), username);\n  \n      imapPasswordWarning = new QLabel(tr(\"Please fill in all IMAP options, including the password, at the IMAP page. \"\n                                          \"If you do not save the password, background synchronization will not run.\"), this);\n      imapPasswordWarning->setWordWrap(true);\n      imapPasswordWarning->setStyleSheet(SettingsDialog::warningStyleSheet);\n      layout->addRow(imapPasswordWarning);\n      debugLog = new QCheckBox();\n      layout->addRow(tr(\"Debugging\"), debugLog);\n  \n      QPushButton *btn = new QPushButton(tr(\"Run xTuple Synchronization\"));\n      connect(btn, SIGNAL(clicked()), this, SLOT(runXtConnect()));\n      layout->addRow(btn);\n  }\n  \n  v\n}"
        }
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotDeActivateSimpleSearch())"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotDeActivateSimpleSearch(",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "boutToShow())"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "boutToShow(",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->setMenu",
          "args": [
            "ptionsMenu)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "awSearchMenu->setVisible",
          "args": [
            "alse)"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "setVisible",
          "container": "FindBar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FindBar.cpp",
          "lines": "134-164",
          "snippet": "void FindBar::setVisible(bool visible)\n{\n    QWidget::setVisible(visible);\n\n    if (!m_associatedWebView)\n        return;\n\n    if (visible) {\n        const QString selectedText = m_associatedWebView->page()->selectedText();\n        if (!hasFocus() && !selectedText.isEmpty()) {\n            const QString previousText = m_lineEdit->text();\n            m_lineEdit->setText(selectedText);\n\n            if (m_lineEdit->text() != previousText) {\n                findPrevious();\n            } else {\n                updateHighlight();\n            }\n        } else if (selectedText.isEmpty()) {\n            emit searchString(m_lineEdit->text());\n        }\n\n        m_lineEdit->setFocus();\n        m_lineEdit->selectAll();\n    } else {\n        updateHighlight();\n\n        // Clear the selection\n        m_associatedWebView->page()->findText(QString());\n    }\n}",
          "includes": [
            "#include \"Gui/Util.h\"",
            "#include \"LineEdit.h\"",
            "#include <QWebView>",
            "#include <QWebFrame>",
            "#include <QToolButton>",
            "#include <QPushButton>",
            "#include <QLabel>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCheckBox>",
            "#include \"FindBar.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Gui/Util.h\"\n#include \"LineEdit.h\"\n#include <QWebView>\n#include <QWebFrame>\n#include <QToolButton>\n#include <QPushButton>\n#include <QLabel>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCheckBox>\n#include \"FindBar.h\"\n\nFindBar {\n  void FindBar::setVisible(bool visible)\n  {\n      QWidget::setVisible(visible);\n  \n      if (!m_associatedWebView)\n          return;\n  \n      if (visible) {\n          const QString selectedText = m_associatedWebView->page()->selectedText();\n          if (!hasFocus() && !selectedText.isEmpty()) {\n              const QString previousText = m_lineEdit->text();\n              m_lineEdit->setText(selectedText);\n  \n              if (m_lineEdit->text() != previousText) {\n                  findPrevious();\n              } else {\n                  updateHighlight();\n              }\n          } else if (selectedText.isEmpty()) {\n              emit searchString(m_lineEdit->text());\n          }\n  \n          m_lineEdit->setFocus();\n          m_lineEdit->selectAll();\n      } else {\n          updateHighlight();\n  \n          // Clear the selection\n          m_associatedWebView->page()->findText(QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addMenu",
          "args": [
            "omplexMenu)"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_rawSearch->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addAction",
          "args": [
            "r(\"Allow raw IMAP search\"))"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Allow raw IMAP search\")"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "Spinner(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "36-41",
          "snippet": "pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                    m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n{\n    updateAncestors();\n    hide();\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Spinner(QWidget *parent) : QWidget(parent), m_step(0), m_fadeStep(0), m_timer(0),\n                                      m_startTimer(0), m_textCols(0), m_type(Sun), m_geometryDirty(false)\n  {\n      updateAncestors();\n      hide();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "SEEN\")"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"Has been seen\"))"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addSeparator",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "SINCE <d-mmm-yyyy>\")"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"Since date\"))"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "BEFORE <d-mmm-yyyy>\")"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"Before date\"))"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addSeparator",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "BODY \" + m_queryPlaceholder)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"Message contains ...\"))"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "SUBJECT \" + m_queryPlaceholder)"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"About subject\"))"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addSeparator",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "TO \" + m_queryPlaceholder)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"To receiver\"))"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "FROM \" + m_queryPlaceholder)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"From sender\"))"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addSeparator",
          "args": [],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "OR \" + m_queryPlaceholder + \" \" + m_queryPlaceholder)"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"Either... or...\"))"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "NOT \" + m_queryPlaceholder)"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omplexMenu->addAction",
          "args": [
            "r(\"Not ...\"))"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addSeparator",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInRecipients->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addAction",
          "args": [
            "r(\"Recipients\"))"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInSenders->setChecked",
          "args": [
            "rue)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInSenders->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addAction",
          "args": [
            "r(\"Senders\"))"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInBody->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addAction",
          "args": [
            "r(\"Body\"))"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInSubject->setChecked",
          "args": [
            "rue)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchInSubject->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addAction",
          "args": [
            "r(\"Subject\"))"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addSeparator",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchFuzzy->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ptionsMenu->addAction",
          "args": [
            "r(\"Fuzzy Search\"))"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->setIcon",
          "args": [
            "oadIcon(QLatin1String(\"imap-search-details\")))"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oadIcon(",
          "args": [
            "Latin1String(\"imap-search-details\"))"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "imap-search-details\")"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->setText",
          "args": [
            "*\")"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->setPopupMode",
          "args": [
            "ToolButton::InstantPopup)"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_searchOptions->setAutoRaise",
          "args": [
            "rue)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_quickSearchText,",
            "IGNAL(textChanged(QString)),",
            "his,",
            "LOT(slotConditionalSearchReset()))"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotConditionalSearchReset())"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotConditionalSearchReset(",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "extChanged(QString))"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "extChanged(",
          "args": [
            "String)"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_quickSearchText,",
            "IGNAL(returnPressed()),",
            "his,",
            "LOT(slotApplySearch()))"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotApplySearch())"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotApplySearch(",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "eturnPressed())"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eturnPressed(",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setToolTip",
          "args": [
            "r(\"Type in a text to search for within this mailbox. \"\n                                     \"The icon on the left can be used to limit the search options \"\n                                     \"(like whether to include addresses or message bodies, etc).\"\n                                     \"<br/><hr/>\"\n                                     \"Experts who have read RFC3501 can use the <code>:=</code> prefix and switch to a raw IMAP mode.\"))"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setPlaceholderText",
          "args": [
            "r(\"Quick Search\"))"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setValidator",
          "args": [
            "alidator)"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "')"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "\\n')"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_quickSearchText->setHistoryEnabled",
          "args": [
            "rue)"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "setHistoryEnabled",
          "container": "LineEdit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LineEdit.cpp",
          "lines": "70-87",
          "snippet": "void LineEdit::setHistoryEnabled(bool enabled)\n{\n    if (enabled == m_historyEnabled)\n        return;\n    m_historyEnabled = enabled;\n    if (m_historyEnabled) {\n        // queued so we learn and update the history list *after* the user selected an item from popup\n        connect(this, SIGNAL(returnPressed()), this, SLOT(learnEntry()), Qt::QueuedConnection);\n        QCompleter *completer = new QCompleter(QStringList(), this);\n        completer->setCaseSensitivity(Qt::CaseInsensitive);\n        completer->setCompletionMode(QCompleter::InlineCompletion);\n        setCompleter(completer);\n    } else {\n        disconnect(this, SIGNAL(returnPressed()), this, SLOT(learnEntry()));\n        delete completer();\n        setCompleter(NULL);\n    }\n}",
          "includes": [
            "#include \"Common/InvokeMethod.h\"",
            "#include <QStyle>",
            "#include <QToolButton>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCompleter>",
            "#include <QAbstractItemView>",
            "#include <QAbstractItemModel>",
            "#include \"LineEdit.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Common/InvokeMethod.h\"\n#include <QStyle>\n#include <QToolButton>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCompleter>\n#include <QAbstractItemView>\n#include <QAbstractItemModel>\n#include \"LineEdit.h\"\n\nLineEdit {\n  void LineEdit::setHistoryEnabled(bool enabled)\n  {\n      if (enabled == m_historyEnabled)\n          return;\n      m_historyEnabled = enabled;\n      if (m_historyEnabled) {\n          // queued so we learn and update the history list *after* the user selected an item from popup\n          connect(this, SIGNAL(returnPressed()), this, SLOT(learnEntry()), Qt::QueuedConnection);\n          QCompleter *completer = new QCompleter(QStringList(), this);\n          completer->setCaseSensitivity(Qt::CaseInsensitive);\n          completer->setCompletionMode(QCompleter::InlineCompletion);\n          setCompleter(completer);\n      } else {\n          disconnect(this, SIGNAL(returnPressed()), this, SLOT(learnEntry()));\n          delete completer();\n          setCompleter(NULL);\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"ReplaceCharValidator.h\"\ninclude \"MsgListView.h\"\n#\ninclude \"LineEdit.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude <QWidgetAction>\n#\ninclude <QVBoxLayout>\n#\ninclude <QToolButton>\n#\ninclude <QTimer>\n#\ninclude <QMenu>\n#\ninclude <QFrame>\n#\ninclude <QCheckBox>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude \"MessageListWidget.h\"\n#\n\nessageListWidget {\n  essageListWidget::MessageListWidget(QWidget *parent) :\n      QWidget(parent), m_supportsFuzzySearch(false)\n  {\n      tree = new MsgListView(this);\n  \n      m_quickSearchText = new LineEdit(this);\n      m_quickSearchText->setHistoryEnabled(true);\n      // Filter out newline. It will wreak havoc into the direct IMAP passthrough and could lead to data loss.\n      QValidator *validator = new ReplaceCharValidator(QLatin1Char('\\n'), QLatin1Char(' '), m_quickSearchText);\n      m_quickSearchText->setValidator(validator);\n  #if QT_VERSION >= 0x040700\n      m_quickSearchText->setPlaceholderText(tr(\"Quick Search\"));\n  #endif\n      m_quickSearchText->setToolTip(tr(\"Type in a text to search for within this mailbox. \"\n                                       \"The icon on the left can be used to limit the search options \"\n                                       \"(like whether to include addresses or message bodies, etc).\"\n                                       \"<br/><hr/>\"\n                                       \"Experts who have read RFC3501 can use the <code>:=</code> prefix and switch to a raw IMAP mode.\"));\n      m_queryPlaceholder = tr(\"<query>\");\n  \n      connect(m_quickSearchText, SIGNAL(returnPressed()), this, SLOT(slotApplySearch()));\n      connect(m_quickSearchText, SIGNAL(textChanged(QString)), this, SLOT(slotConditionalSearchReset()));\n      connect(m_quickSearchText, SIGNAL(cursorPositionChanged(int, int)), this, SLOT(slotUpdateSearchCursor()));\n  \n      m_searchOptions = new QToolButton(this);\n      m_searchOptions->setAutoRaise(true);\n      m_searchOptions->setPopupMode(QToolButton::InstantPopup);\n      m_searchOptions->setText(\"*\");\n      m_searchOptions->setIcon(loadIcon(QLatin1String(\"imap-search-details\")));\n      QMenu *optionsMenu = new QMenu(m_searchOptions);\n      m_searchFuzzy = optionsMenu->addAction(tr(\"Fuzzy Search\"));\n      m_searchFuzzy->setCheckable(true);\n      optionsMenu->addSeparator();\n      m_searchInSubject = optionsMenu->addAction(tr(\"Subject\"));\n      m_searchInSubject->setCheckable(true);\n      m_searchInSubject->setChecked(true);\n      m_searchInBody = optionsMenu->addAction(tr(\"Body\"));\n      m_searchInBody->setCheckable(true);\n      m_searchInSenders = optionsMenu->addAction(tr(\"Senders\"));\n      m_searchInSenders->setCheckable(true);\n      m_searchInSenders->setChecked(true);\n      m_searchInRecipients = optionsMenu->addAction(tr(\"Recipients\"));\n      m_searchInRecipients->setCheckable(true);\n  \n      optionsMenu->addSeparator();\n  \n      QMenu *complexMenu = new QMenu(tr(\"Complex IMAP query\"), optionsMenu);\n      connect(complexMenu, SIGNAL(triggered(QAction*)), this, SLOT(slotComplexSearchInput(QAction*)));\n      complexMenu->addAction(tr(\"Not ...\"))->setData(\"NOT \" + m_queryPlaceholder);\n      complexMenu->addAction(tr(\"Either... or...\"))->setData(\"OR \" + m_queryPlaceholder + \" \" + m_queryPlaceholder);\n      complexMenu->addSeparator();\n      complexMenu->addAction(tr(\"From sender\"))->setData(\"FROM \" + m_queryPlaceholder);\n      complexMenu->addAction(tr(\"To receiver\"))->setData(\"TO \" + m_queryPlaceholder);\n      complexMenu->addSeparator();\n      complexMenu->addAction(tr(\"About subject\"))->setData(\"SUBJECT \" + m_queryPlaceholder);\n      complexMenu->addAction(tr(\"Message contains ...\"))->setData(\"BODY \" + m_queryPlaceholder);\n      complexMenu->addSeparator();\n      complexMenu->addAction(tr(\"Before date\"))->setData(\"BEFORE <d-mmm-yyyy>\");\n      complexMenu->addAction(tr(\"Since date\"))->setData(\"SINCE <d-mmm-yyyy>\");\n      complexMenu->addSeparator();\n      complexMenu->addAction(tr(\"Has been seen\"))->setData(\"SEEN\");\n  \n      m_rawSearch = optionsMenu->addAction(tr(\"Allow raw IMAP search\"));\n      m_rawSearch->setCheckable(true);\n      QAction *rawSearchMenu = optionsMenu->addMenu(complexMenu);\n      rawSearchMenu->setVisible(false);\n      connect (m_rawSearch, SIGNAL(toggled(bool)), rawSearchMenu, SLOT(setVisible(bool)));\n      connect (m_rawSearch, SIGNAL(toggled(bool)), SIGNAL(rawSearchSettingChanged(bool)));\n  \n      m_searchOptions->setMenu(optionsMenu);\n      connect (optionsMenu, SIGNAL(aboutToShow()), SLOT(slotDeActivateSimpleSearch()));\n  \n      delete m_quickSearchText->layout();\n      QHBoxLayout *hlayout = new QHBoxLayout(m_quickSearchText);\n      hlayout->setContentsMargins(0, 0, 0, 0);\n      hlayout->addWidget(m_searchOptions);\n      hlayout->addStretch();\n      hlayout->addWidget(m_quickSearchText->clearButton());\n      hlayout->activate(); // this processes the layout and ensures the toolbutton has it's final dimensions\n  #if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n      if (QGuiApplication::isLeftToRight())\n  #else\n      if (qApp->keyboardInputDirection() == Qt::LeftToRight)\n  #endif\n          m_quickSearchText->setTextMargins(m_searchOptions->width(), 0, 0, 0);\n      else // ppl. in N Africa and the middle east write the wrong direction...\n          m_quickSearchText->setTextMargins(0, 0, m_searchOptions->width(), 0);\n      m_searchOptions->setCursor(Qt::ArrowCursor); // inherits I-Beam from lineedit otherwise\n  \n      QVBoxLayout *layout = new QVBoxLayout(this);\n      layout->setSpacing(0);\n      layout->addWidget(m_quickSearchText);\n      layout->addWidget(tree);\n  \n      m_searchResetTimer = new QTimer(this);\n      m_searchResetTimer->setSingleShot(true);\n      connect(m_searchResetTimer, SIGNAL(timeout()), SLOT(slotApplySearch()));\n  \n      slotAutoEnableDisableSearch();\n  }\n  \n  void MessageListWidget::focusSearch()\n  {\n      if (!m_quickSearchText->isEnabled() || m_quickSearchText->hasFocus())\n          return;\n      m_quickSearchText->setFocus(Qt::ShortcutFocusReason);\n  }\n  \n  void MessageListWidget::focusRawSearch()\n  {\n      if (!m_quickSearchText->isEnabled() || m_quickSearchText->hasFocus() || !m_rawSearch->isChecked())\n          return;\n      m_quickSearchText->setFocus(Qt::ShortcutFocusReason);\n      m_quickSearchText->setText(\":=\");\n      m_quickSearchText->deselect();\n      m_quickSearchText->setCursorPosition(m_quickSearchText->text().length());\n  }\n  \n  void MessageListWidget::slotApplySearch()\n  {\n      emit requestingSearch(searchConditions());\n  }\n  \n  void MessageListWidget::slotAutoEnableDisableSearch()\n  {\n      bool isEnabled;\n      if (!m_quickSearchText->text().isEmpty()) {\n          // Some search criteria are in effect and suddenly all matching messages\n          // disappear. We have to make sure that the search bar remains enabled.\n          isEnabled = true;\n      } else if (tree && tree->model()) {\n          isEnabled = tree->model()->rowCount();\n      } else {\n          isEnabled = false;\n      }\n      m_quickSearchText->setEnabled(isEnabled);\n      m_searchOptions->setEnabled(isEnabled);\n  }\n  \n  void MessageListWidget::slotSortingFailed()\n  {\n      QPalette pal = m_quickSearchText->palette();\n      pal.setColor(m_quickSearchText->backgroundRole(), Qt::red);\n      pal.setColor(m_quickSearchText->foregroundRole(), Qt::white);\n      m_quickSearchText->setPalette(pal);\n      QTimer::singleShot(500, this, SLOT(slotResetSortingFailed()));\n  }\n  \n  void MessageListWidget::slotResetSortingFailed()\n  {\n      m_quickSearchText->setPalette(QPalette());\n  }\n  \n  void MessageListWidget::slotConditionalSearchReset()\n  {\n      if (m_quickSearchText->text().isEmpty())\n          m_searchResetTimer->start(250);\n      else\n          m_searchResetTimer->stop();\n  }\n  \n  void MessageListWidget::slotUpdateSearchCursor()\n  {\n      int cp = m_quickSearchText->cursorPosition();\n      int ts = -1, te = -1;\n      for (int i = cp-1; i > -1; --i) {\n          if (m_quickSearchText->text().at(i) == '>')\n              break; // invalid\n          if (m_quickSearchText->text().at(i) == '<') {\n              ts = i;\n              break; // found TagStart\n          }\n      }\n      if (ts < 0)\n          return; // not inside tag!\n      for (int i = cp; i < m_quickSearchText->text().length(); ++i) {\n          if (m_quickSearchText->text().at(i) == '<')\n              break; // invalid\n          if (m_quickSearchText->text().at(i) == '>') {\n              te = i;\n              break; // found TagEnd\n          }\n      }\n      if (te < 0)\n          return; // not inside tag?\n      if (m_quickSearchText->text().midRef(ts, m_queryPlaceholder.length()) == m_queryPlaceholder)\n          m_quickSearchText->setSelection(ts, m_queryPlaceholder.length());\n  }\n  \n  void MessageListWidget::slotComplexSearchInput(QAction *act)\n  {\n      QString s = act->data().toString();\n      const int selectionStart = m_quickSearchText->selectionStart() - 1;\n      if (selectionStart > -1 && m_quickSearchText->text().at(selectionStart) != ' ')\n              s.prepend(' ');\n      m_quickSearchText->insert(s);\n      if (!m_quickSearchText->text().startsWith(QLatin1String(\":=\"))) {\n          s = m_quickSearchText->text().trimmed();\n          m_quickSearchText->setText(\":=\" + s);\n      }\n      m_quickSearchText->setFocus();\n      const int pos = m_quickSearchText->text().indexOf(m_queryPlaceholder);\n      if (pos > -1)\n          m_quickSearchText->setSelection(pos, m_queryPlaceholder.length());\n  }\n  \n  void MessageListWidget::slotDeActivateSimpleSearch()\n  {\n      const bool isEnabled = !(m_rawSearch->isChecked() && m_quickSearchText->text().startsWith(QLatin1String(\":=\")));\n      m_searchInSubject->setEnabled(isEnabled);\n      m_searchInBody->setEnabled(isEnabled);\n      m_searchInSenders->setEnabled(isEnabled);\n      m_searchInRecipients->setEnabled(isEnabled);\n      m_searchFuzzy->setEnabled(isEnabled && m_supportsFuzzySearch);\n  }\n  \n  QStringList MessageListWidget::searchConditions() const\n  {\n      if (!m_quickSearchText->isEnabled() || m_quickSearchText->text().isEmpty())\n          return QStringList();\n  \n      static QString rawPrefix = QLatin1String(\":=\");\n  \n      if (m_rawSearch->isChecked() && m_quickSearchText->text().startsWith(rawPrefix)) {\n          // It's a \"raw\" IMAP search, let's simply pass it through\n          return QStringList() << m_quickSearchText->text().mid(rawPrefix.size());\n      }\n  \n      QStringList keys;\n      if (m_searchInSubject->isChecked())\n          keys << QLatin1String(\"SUBJECT\");\n      if (m_searchInBody->isChecked())\n          keys << QLatin1String(\"BODY\");\n      if (m_searchInRecipients->isChecked())\n          keys << QLatin1String(\"TO\") << QLatin1String(\"CC\") << QLatin1String(\"BCC\");\n      if (m_searchInSenders->isChecked())\n          keys << QLatin1String(\"FROM\");\n  \n      if (keys.isEmpty())\n          return keys;\n  \n      QStringList res;\n      Q_FOREACH(const QString &key, keys) {\n          if (m_supportsFuzzySearch)\n              res << QLatin1String(\"FUZZY\");\n          res << key << m_quickSearchText->text();\n      }\n      if (keys.size() > 1) {\n          // Got to make this a conjunction. The OR operator's reverse-polish-notation accepts just two operands, though.\n          int num = keys.size() - 1;\n          for (int i = 0; i < num; ++i) {\n              res.prepend(QLatin1String(\"OR\"));\n          }\n      }\n  \n      return res;\n  }\n  \n  void MessageListWidget::setFuzzySearchSupported(bool supported)\n  {\n      m_supportsFuzzySearch = supported;\n      m_searchFuzzy->setEnabled(supported);\n      m_searchFuzzy->setChecked(supported);\n  }\n  \n  void MessageListWidget::setRawSearchEnabled(bool enabled)\n  {\n      m_rawSearch->setChecked(enabled);\n  }\n  \n  }\n}"
  }
]