[
  {
    "function_name": "deleteReply(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "163-171",
    "snippet": "oid FileDownloadManager::deleteReply(QNetworkReply *reply)\n{\n    if (reply == this->reply) {\n        if (!saved)\n            onPartDataTransfered();\n        delete reply;\n        this->reply = 0;\n    }\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nPartDataTransfered(",
          "args": [],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "onPartDataTransfered(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "110-130",
          "snippet": "oid FileDownloadManager::onPartDataTransfered()\n{\n    Q_ASSERT(reply);\n    if (reply->error() == QNetworkReply::NoError) {\n        if (!saving.open(QIODevice::WriteOnly)) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        if (saving.write(reply->readAll()) == -1) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        if (!saving.flush()) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        saving.close();\n        saved = true;\n        emit succeeded();\n    }\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onPartDataTransfered()\n  {\n      Q_ASSERT(reply);\n      if (reply->error() == QNetworkReply::NoError) {\n          if (!saving.open(QIODevice::WriteOnly)) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          if (saving.write(reply->readAll()) == -1) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          if (!saving.flush()) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          saving.close();\n          saved = true;\n          emit succeeded();\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::deleteReply(QNetworkReply *reply)\n  {\n      if (reply == this->reply) {\n          if (!saved)\n              onPartDataTransfered();\n          delete reply;\n          this->reply = 0;\n      }\n  }\n}"
  },
  {
    "function_name": "onCombinerTransferError(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "158-161",
    "snippet": "oid FileDownloadManager::onCombinerTransferError(const QString &message)\n{\n    emit transferError(message);\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onCombinerTransferError(const QString &message)\n  {\n      emit transferError(message);\n  }\n}"
  },
  {
    "function_name": "onReplyTransferError(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "152-156",
    "snippet": "oid FileDownloadManager::onReplyTransferError()\n{\n    Q_ASSERT(reply);\n    emit transferError(reply->errorString());\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eply->errorString",
          "args": [],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "errorString",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "712-714",
          "snippet": "QString QwwSmtpClient::errorString() const{\n    return d->errorString;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QString QwwSmtpClient::errorString() const{\n      return d->errorString;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "eply)"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onReplyTransferError()\n  {\n      Q_ASSERT(reply);\n      emit transferError(reply->errorString());\n  }\n}"
  },
  {
    "function_name": "onMessageDataTransferred(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "132-150",
    "snippet": "oid FileDownloadManager::onMessageDataTransferred()\n{\n    Q_ASSERT(m_combiner);\n    if (!saving.open(QIODevice::WriteOnly)) {\n        emit transferError(saving.errorString());\n        return;\n    }\n    if (saving.write(m_combiner->data().data()) == -1) {\n        emit transferError(saving.errorString());\n        return;\n    }\n    if (!saving.flush()) {\n        emit transferError(saving.errorString());\n        return;\n    }\n    saving.close();\n    saved = true;\n    emit succeeded();\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aving.close",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aving.errorString",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "errorString",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "712-714",
          "snippet": "QString QwwSmtpClient::errorString() const{\n    return d->errorString;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QString QwwSmtpClient::errorString() const{\n      return d->errorString;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "aving.flush",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aving.write",
          "args": [
            "_combiner->data().data())"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_combiner->data",
          "args": [],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "aving.open",
          "args": [
            "IODevice::WriteOnly)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_combiner)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onMessageDataTransferred()\n  {\n      Q_ASSERT(m_combiner);\n      if (!saving.open(QIODevice::WriteOnly)) {\n          emit transferError(saving.errorString());\n          return;\n      }\n      if (saving.write(m_combiner->data().data()) == -1) {\n          emit transferError(saving.errorString());\n          return;\n      }\n      if (!saving.flush()) {\n          emit transferError(saving.errorString());\n          return;\n      }\n      saving.close();\n      saved = true;\n      emit succeeded();\n  }\n}"
  },
  {
    "function_name": "onPartDataTransfered(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "110-130",
    "snippet": "oid FileDownloadManager::onPartDataTransfered()\n{\n    Q_ASSERT(reply);\n    if (reply->error() == QNetworkReply::NoError) {\n        if (!saving.open(QIODevice::WriteOnly)) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        if (saving.write(reply->readAll()) == -1) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        if (!saving.flush()) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        saving.close();\n        saved = true;\n        emit succeeded();\n    }\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "aving.close",
          "args": [],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aving.errorString",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "errorString",
          "container": "QwwSmtpClient",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/qwwsmtpclient/qwwsmtpclient.cpp",
          "lines": "712-714",
          "snippet": "QString QwwSmtpClient::errorString() const{\n    return d->errorString;\n}",
          "includes": [
            "#include \"moc_qwwsmtpclient.cpp\"",
            "#include <QStringList>",
            "#include <QVariant>",
            "#include <QQueue>",
            "#include <QtDebug>",
            "#include <QSslSocket>",
            "#include \"qwwsmtpclient.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"moc_qwwsmtpclient.cpp\"\n#include <QStringList>\n#include <QVariant>\n#include <QQueue>\n#include <QtDebug>\n#include <QSslSocket>\n#include \"qwwsmtpclient.h\"\n\nQwwSmtpClient {\n  QString QwwSmtpClient::errorString() const{\n      return d->errorString;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "aving.flush",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aving.write",
          "args": [
            "eply->readAll())"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eply->readAll",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aving.open",
          "args": [
            "IODevice::WriteOnly)"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eply->error",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "eply)"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onPartDataTransfered()\n  {\n      Q_ASSERT(reply);\n      if (reply->error() == QNetworkReply::NoError) {\n          if (!saving.open(QIODevice::WriteOnly)) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          if (saving.write(reply->readAll()) == -1) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          if (!saving.flush()) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          saving.close();\n          saved = true;\n          emit succeeded();\n      }\n  }\n}"
  },
  {
    "function_name": "downloadMessage(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "85-108",
    "snippet": "oid FileDownloadManager::downloadMessage()\n{\n    if (!partIndex.isValid()) {\n        emit transferError(tr(\"FileDownloadManager::downloadMessage(): message has disappeared\"));\n        return;\n    }\n    QString saveFileName = toRealFileName(partIndex);\n    Q_ASSERT(!m_combiner);\n    m_combiner = new Imap::Mailbox::FullMessageCombiner(partIndex, this);\n\n    emit fileNameRequested(&saveFileName);\n    if (saveFileName.isEmpty()) {\n        emit cancelled();\n        return;\n    }\n\n    saving.setFileName(saveFileName);\n    saved = false;\n    connect(m_combiner, SIGNAL(completed()), this, SLOT(onMessageDataTransferred()));\n    connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(onCombinerTransferError(QString)));\n    connect(m_combiner, SIGNAL(completed()), m_combiner, SLOT(deleteLater()), Qt::QueuedConnection);\n    connect(m_combiner, SIGNAL(failed(QString)), m_combiner, SLOT(deleteLater()), Qt::QueuedConnection);\n    m_combiner->load();\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_combiner->load",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "load",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/io/qsystemlibrary_p.h",
          "lines": "69-74",
          "snippet": "bool load(bool onlySystemDirectory = true)\n    {\n        m_handle = load((const wchar_t *)m_libraryName.utf16(), onlySystemDirectory);\n        m_didLoad = true;\n        return (m_handle != 0);\n    }",
          "includes": [
            "#include <QtCore/qstring.h>",
            "#include <qt_windows.h>",
            "#include <QtCore/qglobal.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtCore/qstring.h>\n#include <qt_windows.h>\n#include <QtCore/qglobal.h>\n\nbool load(bool onlySystemDirectory = true)\n    {\n        m_handle = load((const wchar_t *)m_libraryName.utf16(), onlySystemDirectory);\n        m_didLoad = true;\n        return (m_handle != 0);\n    }"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_combiner,",
            "IGNAL(failed(QString)),",
            "_combiner,",
            "LOT(deleteLater()),",
            "t::QueuedConnection)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ailed(QString))"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailed(",
          "args": [
            "String)"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "authenticationFailed(const QS",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1103-1107",
          "snippet": "Window::authenticationFailed(const QString &message)\n{\n    m_ignoreStoredPassword = true;\n    QMessageBox::warning(this, tr(\"Login Failed\"), message);\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::authenticationFailed(const QString &message)\n  {\n      m_ignoreStoredPassword = true;\n      QMessageBox::warning(this, tr(\"Login Failed\"), message);\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_combiner,",
            "IGNAL(completed()),",
            "_combiner,",
            "LOT(deleteLater()),",
            "t::QueuedConnection)"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ompleted())"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ompleted(",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "idleCommandCompleted(",
          "container": "dleLauncher",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Tasks/IdleLauncher.cpp",
          "lines": "123-134",
          "snippet": "oid IdleLauncher::idleCommandCompleted()\n{\n    // FIXME: these asseerts could be triggered by a rogue server...\n    if (m_idling) {\n        task->log(\"Warning: IDLE completed before we could ask for its termination...\", Common::LOG_MAILBOX_SYNC);\n        m_idling = false;\n        renewal->stop();\n        task->parser->idleMagicallyTerminatedByServer();\n    }\n    Q_ASSERT(m_idleCommandRunning);\n    m_idleCommandRunning = false;\n}",
          "includes": [
            "include \"KeepMailboxOpenTask.h\"",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"IdleLauncher.h\"\n#",
            "include <QTimer>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"KeepMailboxOpenTask.h\"\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"IdleLauncher.h\"\n#\ninclude <QTimer>\n#\n\ndleLauncher {\n  oid IdleLauncher::idleCommandCompleted()\n  {\n      // FIXME: these asseerts could be triggered by a rogue server...\n      if (m_idling) {\n          task->log(\"Warning: IDLE completed before we could ask for its termination...\", Common::LOG_MAILBOX_SYNC);\n          m_idling = false;\n          renewal->stop();\n          task->parser->idleMagicallyTerminatedByServer();\n      }\n      Q_ASSERT(m_idleCommandRunning);\n      m_idleCommandRunning = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_combiner,",
            "IGNAL(failed(QString)),",
            "his,",
            "LOT(onCombinerTransferError(QString)))"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nCombinerTransferError(QString))"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nCombinerTransferError(",
          "args": [
            "String)"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "onCombinerTransferError(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "158-161",
          "snippet": "oid FileDownloadManager::onCombinerTransferError(const QString &message)\n{\n    emit transferError(message);\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onCombinerTransferError(const QString &message)\n  {\n      emit transferError(message);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ailed(QString))"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_combiner,",
            "IGNAL(completed()),",
            "his,",
            "LOT(onMessageDataTransferred()))"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nMessageDataTransferred())"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nMessageDataTransferred(",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "onMessageDataTransferred(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "132-150",
          "snippet": "oid FileDownloadManager::onMessageDataTransferred()\n{\n    Q_ASSERT(m_combiner);\n    if (!saving.open(QIODevice::WriteOnly)) {\n        emit transferError(saving.errorString());\n        return;\n    }\n    if (saving.write(m_combiner->data().data()) == -1) {\n        emit transferError(saving.errorString());\n        return;\n    }\n    if (!saving.flush()) {\n        emit transferError(saving.errorString());\n        return;\n    }\n    saving.close();\n    saved = true;\n    emit succeeded();\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onMessageDataTransferred()\n  {\n      Q_ASSERT(m_combiner);\n      if (!saving.open(QIODevice::WriteOnly)) {\n          emit transferError(saving.errorString());\n          return;\n      }\n      if (saving.write(m_combiner->data().data()) == -1) {\n          emit transferError(saving.errorString());\n          return;\n      }\n      if (!saving.flush()) {\n          emit transferError(saving.errorString());\n          return;\n      }\n      saving.close();\n      saved = true;\n      emit succeeded();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ompleted())"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aving.setFileName",
          "args": [
            "aveFileName)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aveFileName.isEmpty",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "m_combiner)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oRealFileName(",
          "args": [
            "artIndex)"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "toRealFileName(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "40-55",
          "snippet": "String FileDownloadManager::toRealFileName(const QModelIndex &index)\n{\n    QString fileName = index.data(Imap::Mailbox::RolePartFileName).toString();\n    if (!fileName.isEmpty())\n        return fileName;\n\n    QString uid = index.data(Imap::Mailbox::RoleMessageUid).toString();\n    QString partId = index.data(Imap::Mailbox::RolePartId).toString();\n    if (partId.isEmpty()) {\n        // we're saving the complete message\n        return tr(\"msg_%1.eml\").arg(uid);\n    } else {\n        // it's a message part\n        return tr(\"msg_%1_%2\").arg(uid, partId);\n    }\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  String FileDownloadManager::toRealFileName(const QModelIndex &index)\n  {\n      QString fileName = index.data(Imap::Mailbox::RolePartFileName).toString();\n      if (!fileName.isEmpty())\n          return fileName;\n  \n      QString uid = index.data(Imap::Mailbox::RoleMessageUid).toString();\n      QString partId = index.data(Imap::Mailbox::RolePartId).toString();\n      if (partId.isEmpty()) {\n          // we're saving the complete message\n          return tr(\"msg_%1.eml\").arg(uid);\n      } else {\n          // it's a message part\n          return tr(\"msg_%1_%2\").arg(uid, partId);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.isValid",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::downloadMessage()\n  {\n      if (!partIndex.isValid()) {\n          emit transferError(tr(\"FileDownloadManager::downloadMessage(): message has disappeared\"));\n          return;\n      }\n      QString saveFileName = toRealFileName(partIndex);\n      Q_ASSERT(!m_combiner);\n      m_combiner = new Imap::Mailbox::FullMessageCombiner(partIndex, this);\n  \n      emit fileNameRequested(&saveFileName);\n      if (saveFileName.isEmpty()) {\n          emit cancelled();\n          return;\n      }\n  \n      saving.setFileName(saveFileName);\n      saved = false;\n      connect(m_combiner, SIGNAL(completed()), this, SLOT(onMessageDataTransferred()));\n      connect(m_combiner, SIGNAL(failed(QString)), this, SLOT(onCombinerTransferError(QString)));\n      connect(m_combiner, SIGNAL(completed()), m_combiner, SLOT(deleteLater()), Qt::QueuedConnection);\n      connect(m_combiner, SIGNAL(failed(QString)), m_combiner, SLOT(deleteLater()), Qt::QueuedConnection);\n      m_combiner->load();\n  }\n}"
  },
  {
    "function_name": "downloadPart(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "57-83",
    "snippet": "oid FileDownloadManager::downloadPart()\n{\n    if (!partIndex.isValid()) {\n        emit transferError(tr(\"FileDownloadManager::downloadPart(): part has disappeared\"));\n        return;\n    }\n    QString saveFileName = toRealFileName(partIndex);\n    emit fileNameRequested(&saveFileName);\n    if (saveFileName.isEmpty()) {\n        emit cancelled();\n        return;\n    }\n\n    saving.setFileName(saveFileName);\n    saved = false;\n\n    QNetworkRequest request;\n    QUrl url;\n    url.setScheme(QLatin1String(\"trojita-imap\"));\n    url.setHost(QLatin1String(\"msg\"));\n    url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n    request.setUrl(url);\n    reply = manager->get(request);\n    connect(reply, SIGNAL(finished()), this, SLOT(onPartDataTransfered()));\n    connect(reply, SIGNAL(error(QNetworkReply::NetworkError)), this, SLOT(onReplyTransferError()));\n    connect(manager, SIGNAL(finished(QNetworkReply *)), this, SLOT(deleteReply(QNetworkReply *)));\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "eply,",
            "IGNAL(error(QNetworkReply::NetworkError)),",
            "his,",
            "LOT(onReplyTransferError()))"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nReplyTransferError())"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nReplyTransferError(",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "onReplyTransferError(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "152-156",
          "snippet": "oid FileDownloadManager::onReplyTransferError()\n{\n    Q_ASSERT(reply);\n    emit transferError(reply->errorString());\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onReplyTransferError()\n  {\n      Q_ASSERT(reply);\n      emit transferError(reply->errorString());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "rror(QNetworkReply::NetworkError))"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rror(",
          "args": [
            "NetworkReply::NetworkError)"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "onCombinerTransferError(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "158-161",
          "snippet": "oid FileDownloadManager::onCombinerTransferError(const QString &message)\n{\n    emit transferError(message);\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onCombinerTransferError(const QString &message)\n  {\n      emit transferError(message);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "eply,",
            "IGNAL(finished()),",
            "his,",
            "LOT(onPartDataTransfered()))"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "nPartDataTransfered())"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nPartDataTransfered(",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "onPartDataTransfered(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "110-130",
          "snippet": "oid FileDownloadManager::onPartDataTransfered()\n{\n    Q_ASSERT(reply);\n    if (reply->error() == QNetworkReply::NoError) {\n        if (!saving.open(QIODevice::WriteOnly)) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        if (saving.write(reply->readAll()) == -1) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        if (!saving.flush()) {\n            emit transferError(saving.errorString());\n            return;\n        }\n        saving.close();\n        saved = true;\n        emit succeeded();\n    }\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onPartDataTransfered()\n  {\n      Q_ASSERT(reply);\n      if (reply->error() == QNetworkReply::NoError) {\n          if (!saving.open(QIODevice::WriteOnly)) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          if (saving.write(reply->readAll()) == -1) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          if (!saving.flush()) {\n              emit transferError(saving.errorString());\n              return;\n          }\n          saving.close();\n          saved = true;\n          emit succeeded();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "inished())"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inished(",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "handlePageLoadFinished(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "152-162",
          "snippet": "oid EmbeddedWebView::handlePageLoadFinished()\n{\n    constrainSize();\n\n    // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n    // Let's do it again here, it works.\n    Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n    page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n    page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n    page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::handlePageLoadFinished()\n  {\n      constrainSize();\n  \n      // We've already set in in our constructor, but apparently it isn't enough (Qt 4.8.0 on X11).\n      // Let's do it again here, it works.\n      Qt::ScrollBarPolicy policy = isWindow() ? Qt::ScrollBarAsNeeded : Qt::ScrollBarAlwaysOff;\n      page()->mainFrame()->setScrollBarPolicy(Qt::Horizontal, policy);\n      page()->mainFrame()->setScrollBarPolicy(Qt::Vertical, policy);\n      page()->setLinkDelegationPolicy(QWebPage::DelegateAllLinks);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "anager->get",
          "args": [
            "equest)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "equest.setUrl",
          "args": [
            "rl)"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "setUrl",
          "container": "TrojitaQNAMDeclarativeWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/QmlSupport/QNAMWebView/qdeclarativewebview.cpp",
          "lines": "385-407",
          "snippet": "void TrojitaQNAMDeclarativeWebView::setUrl(const QUrl& url)\n{\n    if (url == d->url)\n        return;\n\n    if (isComponentComplete()) {\n        d->url = url;\n        updateContentsSize();\n        QUrl seturl = url;\n        if (seturl.isEmpty())\n            seturl = QUrl(QLatin1String(\"about:blank\"));\n\n        Q_ASSERT(!seturl.isRelative());\n\n        page()->mainFrame()->load(seturl);\n\n        emit urlChanged();\n\n    } else {\n        d->pending = d->PendingUrl;\n        d->pendingUrl = url;\n    }\n}",
          "includes": [
            "#include \"qwebsettings.h\"",
            "#include \"qwebpage.h\"",
            "#include \"qwebframe.h\"",
            "#include \"qwebelement.h\"",
            "#include <QtGui/QPen>",
            "#include <QtGui/QMouseEvent>",
            "#include <QtGui/QKeyEvent>",
            "#include <QtGui/QGraphicsSceneMouseEvent>",
            "#include <QtGui/QApplication>",
            "#include <QtDeclarative/qdeclarative.h>",
            "#include <QtDeclarative/QDeclarativeEngine>",
            "#include <QtDeclarative/QDeclarativeContext>",
            "#include <QtCore/QFile>",
            "#include <QtCore/QEvent>",
            "#include <QtCore/QDebug>",
            "#include \"qdeclarativewebview_p.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QUrl url;",
            "enum { PendingNone, PendingUrl, PendingHtml, PendingContent } pending;",
            "QUrl pendingUrl;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"qwebsettings.h\"\n#include \"qwebpage.h\"\n#include \"qwebframe.h\"\n#include \"qwebelement.h\"\n#include <QtGui/QPen>\n#include <QtGui/QMouseEvent>\n#include <QtGui/QKeyEvent>\n#include <QtGui/QGraphicsSceneMouseEvent>\n#include <QtGui/QApplication>\n#include <QtDeclarative/qdeclarative.h>\n#include <QtDeclarative/QDeclarativeEngine>\n#include <QtDeclarative/QDeclarativeContext>\n#include <QtCore/QFile>\n#include <QtCore/QEvent>\n#include <QtCore/QDebug>\n#include \"qdeclarativewebview_p.h\"\n\nQUrl url;\nenum { PendingNone, PendingUrl, PendingHtml, PendingContent } pending;\nQUrl pendingUrl;\n\nTrojitaQNAMDeclarativeWebView {\n  void TrojitaQNAMDeclarativeWebView::setUrl(const QUrl& url)\n  {\n      if (url == d->url)\n          return;\n  \n      if (isComponentComplete()) {\n          d->url = url;\n          updateContentsSize();\n          QUrl seturl = url;\n          if (seturl.isEmpty())\n              seturl = QUrl(QLatin1String(\"about:blank\"));\n  \n          Q_ASSERT(!seturl.isRelative());\n  \n          page()->mainFrame()->load(seturl);\n  \n          emit urlChanged();\n  \n      } else {\n          d->pending = d->PendingUrl;\n          d->pendingUrl = url;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rl.setPath",
          "args": [
            "artIndex.data(Imap::Mailbox::RolePartPathToPart).toString())"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.data",
          "args": [
            "map::Mailbox::RolePartPathToPart)"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.setHost",
          "args": [
            "Latin1String(\"msg\"))"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "msg\")"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.setScheme",
          "args": [
            "Latin1String(\"trojita-imap\"))"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "trojita-imap\")"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aving.setFileName",
          "args": [
            "aveFileName)"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aveFileName.isEmpty",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oRealFileName(",
          "args": [
            "artIndex)"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "toRealFileName(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "40-55",
          "snippet": "String FileDownloadManager::toRealFileName(const QModelIndex &index)\n{\n    QString fileName = index.data(Imap::Mailbox::RolePartFileName).toString();\n    if (!fileName.isEmpty())\n        return fileName;\n\n    QString uid = index.data(Imap::Mailbox::RoleMessageUid).toString();\n    QString partId = index.data(Imap::Mailbox::RolePartId).toString();\n    if (partId.isEmpty()) {\n        // we're saving the complete message\n        return tr(\"msg_%1.eml\").arg(uid);\n    } else {\n        // it's a message part\n        return tr(\"msg_%1_%2\").arg(uid, partId);\n    }\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  String FileDownloadManager::toRealFileName(const QModelIndex &index)\n  {\n      QString fileName = index.data(Imap::Mailbox::RolePartFileName).toString();\n      if (!fileName.isEmpty())\n          return fileName;\n  \n      QString uid = index.data(Imap::Mailbox::RoleMessageUid).toString();\n      QString partId = index.data(Imap::Mailbox::RolePartId).toString();\n      if (partId.isEmpty()) {\n          // we're saving the complete message\n          return tr(\"msg_%1.eml\").arg(uid);\n      } else {\n          // it's a message part\n          return tr(\"msg_%1_%2\").arg(uid, partId);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artIndex.isValid",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::downloadPart()\n  {\n      if (!partIndex.isValid()) {\n          emit transferError(tr(\"FileDownloadManager::downloadPart(): part has disappeared\"));\n          return;\n      }\n      QString saveFileName = toRealFileName(partIndex);\n      emit fileNameRequested(&saveFileName);\n      if (saveFileName.isEmpty()) {\n          emit cancelled();\n          return;\n      }\n  \n      saving.setFileName(saveFileName);\n      saved = false;\n  \n      QNetworkRequest request;\n      QUrl url;\n      url.setScheme(QLatin1String(\"trojita-imap\"));\n      url.setHost(QLatin1String(\"msg\"));\n      url.setPath(partIndex.data(Imap::Mailbox::RolePartPathToPart).toString());\n      request.setUrl(url);\n      reply = manager->get(request);\n      connect(reply, SIGNAL(finished()), this, SLOT(onPartDataTransfered()));\n      connect(reply, SIGNAL(error(QNetworkReply::NetworkError)), this, SLOT(onReplyTransferError()));\n      connect(manager, SIGNAL(finished(QNetworkReply *)), this, SLOT(deleteReply(QNetworkReply *)));\n  }\n}"
  },
  {
    "function_name": "toRealFileName(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "40-55",
    "snippet": "String FileDownloadManager::toRealFileName(const QModelIndex &index)\n{\n    QString fileName = index.data(Imap::Mailbox::RolePartFileName).toString();\n    if (!fileName.isEmpty())\n        return fileName;\n\n    QString uid = index.data(Imap::Mailbox::RoleMessageUid).toString();\n    QString partId = index.data(Imap::Mailbox::RolePartId).toString();\n    if (partId.isEmpty()) {\n        // we're saving the complete message\n        return tr(\"msg_%1.eml\").arg(uid);\n    } else {\n        // it's a message part\n        return tr(\"msg_%1_%2\").arg(uid, partId);\n    }\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "r",
          "args": [
            "id,",
            "artId)"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "eadData(",
          "container": "orbiddenReply ",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/ForbiddenReply.h",
          "lines": "39-42",
          "snippet": "irtual qint64 readData(char *data, qint64 maxSize) {\n        Q_UNUSED(data); Q_UNUSED(maxSize);\n        return -1;\n    }",
          "includes": [
            "include <QNetworkReply>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QNetworkReply>\n\norbiddenReply  {\n  irtual qint64 readData(char *data, qint64 maxSize) {\n          Q_UNUSED(data); Q_UNUSED(maxSize);\n          return -1;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "msg_%1_%2\")"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "onCombinerTransferError(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "158-161",
          "snippet": "oid FileDownloadManager::onCombinerTransferError(const QString &message)\n{\n    emit transferError(message);\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::onCombinerTransferError(const QString &message)\n  {\n      emit transferError(message);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "id)"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "deleteReply(",
          "container": "ileDownloadManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
          "lines": "163-171",
          "snippet": "oid FileDownloadManager::deleteReply(QNetworkReply *reply)\n{\n    if (reply == this->reply) {\n        if (!saved)\n            onPartDataTransfered();\n        delete reply;\n        this->reply = 0;\n    }\n}",
          "includes": [
            "include <QDir>",
            "include \"Imap/Model/MailboxTree.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Imap/Model/FullMessageCombiner.h\"\n#",
            "include \"FileDownloadManager.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  oid FileDownloadManager::deleteReply(QNetworkReply *reply)\n  {\n      if (reply == this->reply) {\n          if (!saved)\n              onPartDataTransfered();\n          delete reply;\n          this->reply = 0;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "artId.isEmpty",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.data",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndex.data",
          "args": [
            "map::Mailbox::RolePartId)"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.data",
          "args": [
            "map::Mailbox::RoleMessageUid)"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ileName.isEmpty",
          "args": [],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ndex.data",
          "args": [
            "map::Mailbox::RolePartFileName)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  String FileDownloadManager::toRealFileName(const QModelIndex &index)\n  {\n      QString fileName = index.data(Imap::Mailbox::RolePartFileName).toString();\n      if (!fileName.isEmpty())\n          return fileName;\n  \n      QString uid = index.data(Imap::Mailbox::RoleMessageUid).toString();\n      QString partId = index.data(Imap::Mailbox::RolePartId).toString();\n      if (partId.isEmpty()) {\n          // we're saving the complete message\n          return tr(\"msg_%1.eml\").arg(uid);\n      } else {\n          // it's a message part\n          return tr(\"msg_%1_%2\").arg(uid, partId);\n      }\n  }\n}"
  },
  {
    "function_name": "FileDownloadManager(",
    "container": "ileDownloadManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Network/FileDownloadManager.cpp",
    "lines": "35-38",
    "snippet": "ileDownloadManager::FileDownloadManager(QObject *parent, Imap::Network::MsgPartNetAccessManager *manager, const QModelIndex &partIndex):\n    QObject(parent), manager(manager), partIndex(partIndex), reply(0), saved(false)\n{\n}",
    "includes": [
      "include <QDir>",
      "include \"Imap/Model/MailboxTree.h\"",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Imap/Model/FullMessageCombiner.h\"\n#",
      "include \"FileDownloadManager.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include <QDir>\ninclude \"Imap/Model/MailboxTree.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Imap/Model/FullMessageCombiner.h\"\n#\ninclude \"FileDownloadManager.h\"\n#\n\nileDownloadManager {\n  ileDownloadManager::FileDownloadManager(QObject *parent, Imap::Network::MsgPartNetAccessManager *manager, const QModelIndex &partIndex):\n      QObject(parent), manager(manager), partIndex(partIndex), reply(0), saved(false)\n  {\n  }\n}"
  }
]