[
  {
    "function_name": "slotWalkDeferredMessages(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "241-267",
    "snippet": "oid MailSynchronizer::slotWalkDeferredMessages()\n{\n    QList<QPersistentModelIndex>::iterator it = m_deferredMessages.begin();\n    while (it != m_deferredMessages.end()) {\n        if ( ! it->isValid() ) {\n            qDebug() << \"A message got removed between the moment we saw it for the first time and the time we tried to process it\";\n            it = m_deferredMessages.erase(it);\n            continue;\n        }\n        QVariant uid = it->data(Imap::Mailbox::RoleMessageUid);\n        Q_ASSERT(uid.isValid());\n        if ( uid.toUInt() == 0 ) {\n            qDebug() << m_mailbox << \": still no UID for message #\" << it->row() + 1;\n            ++it;\n        } else {\n            bool shouldLoad = true;\n            QModelIndex message = *it;\n            it = m_deferredMessages.erase(it);\n            emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n            if ( shouldLoad ) {\n                m_downloader->requestDownload(message);\n            }\n        }\n    }\n    if ( ! m_deferredMessages.isEmpty() )\n        m_deferredTimer->start();\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_deferredTimer->start",
          "args": [],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredMessages.isEmpty",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_downloader->requestDownload",
          "args": [
            "essage)"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredMessages.erase",
          "args": [
            "t)"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t->row",
          "args": [],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "row(",
          "container": "reeItemModifiedPart",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/MailboxTree.cpp",
          "lines": "1575-1579",
          "snippet": "nt TreeItemModifiedPart::row() const\n{\n    // we're always at the very top\n    return 0;\n}",
          "includes": [
            "include <QtDebug>",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"Model.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Parser/Rfc5322HeaderParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/MetaTypes.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include <QTextStream>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"Model.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Parser/Rfc5322HeaderParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/MetaTypes.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude <QTextStream>\n#\ninclude <algorithm>\n#\n\nreeItemModifiedPart {\n  nt TreeItemModifiedPart::row() const\n  {\n      // we're always at the very top\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "id.toUInt",
          "args": [],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "id.isValid())"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "id.isValid",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "t->data",
          "args": [
            "map::Mailbox::RoleMessageUid)"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredMessages.erase",
          "args": [
            "t)"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredMessages.end",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredMessages.begin",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotWalkDeferredMessages()\n  {\n      QList<QPersistentModelIndex>::iterator it = m_deferredMessages.begin();\n      while (it != m_deferredMessages.end()) {\n          if ( ! it->isValid() ) {\n              qDebug() << \"A message got removed between the moment we saw it for the first time and the time we tried to process it\";\n              it = m_deferredMessages.erase(it);\n              continue;\n          }\n          QVariant uid = it->data(Imap::Mailbox::RoleMessageUid);\n          Q_ASSERT(uid.isValid());\n          if ( uid.toUInt() == 0 ) {\n              qDebug() << m_mailbox << \": still no UID for message #\" << it->row() + 1;\n              ++it;\n          } else {\n              bool shouldLoad = true;\n              QModelIndex message = *it;\n              it = m_deferredMessages.erase(it);\n              emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n              if ( shouldLoad ) {\n                  m_downloader->requestDownload(message);\n              }\n          }\n      }\n      if ( ! m_deferredMessages.isEmpty() )\n          m_deferredTimer->start();\n  }\n}"
  },
  {
    "function_name": "debugStats(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "228-239",
    "snippet": "oid MailSynchronizer::debugStats() const\n{\n    if ( m_index.isValid() ) {\n        qDebug() << \"Mailbox\" << m_mailbox <<\n                ( m_index.data(Imap::Mailbox::RoleMailboxItemsAreLoading).toBool() ? \"[loading]\" : \"\" ) <<\n                \"total\" << m_index.data( Imap::Mailbox::RoleTotalMessageCount ).toUInt() <<\n                \", active\" << m_downloader->activeMessages() << \", queued\" << m_downloader->pendingMessages() <<\n                \", uid_wait\" << m_deferredMessages.count();\n    } else {\n        qDebug() << \"Mailbox\" << m_mailbox << \": waiting for sync.\";\n    }\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredMessages.count",
          "args": [],
          "line": 235
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "207-215",
          "snippet": "int XSqlQuery::count()\n{\n  QSqlRecord rec = record();\n\n  if (!rec.isEmpty())\n    return rec.count();\n  else\n    return 0;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  int XSqlQuery::count()\n  {\n    QSqlRecord rec = record();\n  \n    if (!rec.isEmpty())\n      return rec.count();\n    else\n      return 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_downloader->pendingMessages",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_downloader->activeMessages",
          "args": [],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_index.data",
          "args": [],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_index.data",
          "args": [
            "map::Mailbox::RoleTotalMessageCount"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_index.data",
          "args": [
            "map::Mailbox::RoleMailboxItemsAreLoading)"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_index.isValid",
          "args": [],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::debugStats() const\n  {\n      if ( m_index.isValid() ) {\n          qDebug() << \"Mailbox\" << m_mailbox <<\n                  ( m_index.data(Imap::Mailbox::RoleMailboxItemsAreLoading).toBool() ? \"[loading]\" : \"\" ) <<\n                  \"total\" << m_index.data( Imap::Mailbox::RoleTotalMessageCount ).toUInt() <<\n                  \", active\" << m_downloader->activeMessages() << \", queued\" << m_downloader->pendingMessages() <<\n                  \", uid_wait\" << m_deferredMessages.count();\n      } else {\n          qDebug() << \"Mailbox\" << m_mailbox << \": waiting for sync.\";\n      }\n  }\n}"
  },
  {
    "function_name": "_saveAddrList(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "198-226",
    "snippet": "oid MailSynchronizer::_saveAddrList( const quint64 emlId, const QVariant &addresses, const QLatin1String kind )\n{\n    // FIXME: batched updates would be great...\n    Q_ASSERT( addresses.type() == QVariant::List );\n    Q_FOREACH( const QVariant &item, addresses.toList() ) {\n        Q_ASSERT( item.isValid() );\n        Q_ASSERT( item.type() == QVariant::StringList );\n        QStringList expanded = item.toStringList();\n        Q_ASSERT( expanded.size() == 4 );\n        QString name = expanded[0];\n\n        QString address;\n        if ( expanded[2].isEmpty() && expanded[3].isEmpty() ) {\n            address = QLatin1String(\"undisclosed-recipients;\");\n        } else if ( expanded[2].isEmpty() ) {\n            address = expanded[3];\n        } else if ( expanded[3].isEmpty() ) {\n            address = expanded[2];\n        } else {\n            address = expanded[2] + QLatin1Char('@') + expanded[3];\n        }\n\n        if ( m_storage->insertAddress( emlId, name, address, kind ) != SqlStorage::RESULT_OK ) {\n            m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                              QLatin1String(\"Failed to insert address\"));\n            qWarning() << \"Failed to insert address\";\n        }\n    }\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Warning(",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "maybeShowPasswordWarning()",
          "container": "goingPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SettingsDialog.cpp",
          "lines": "761-764",
          "snippet": "d OutgoingPage::maybeShowPasswordWarning()\n{\n    passwordWarning->setVisible(!smtpPass->text().isEmpty());\n}\n\n#",
          "includes": [
            "include \"Gui/Util.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include <QDataWidgetMapper>\n#",
            "include <QMessageBox>\n#",
            "include <QToolTip>\n#",
            "include <QStandardItemModel>\n#",
            "include <QDebug>\n#",
            "include <QResizeEvent>\n#",
            "include <QPushButton>\n#",
            "include <QProcess>\n#",
            "include <QVBoxLayout>\n#",
            "include <QTabWidget>\n#",
            "include <QSpinBox>\n#",
            "include <QRadioButton>\n#",
            "include <QListWidget>\n#",
            "include <QLineEdit>\n#",
            "include <QInputDialog>\n#",
            "include <QGroupBox>\n#",
            "include <QFormLayout>\n#",
            "include <QDir>\n#",
            "include <QDialogButtonBox>\n#",
            "include <QComboBox>\n#",
            "include <QCheckBox>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Gui/Util.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude <QDataWidgetMapper>\n#\ninclude <QMessageBox>\n#\ninclude <QToolTip>\n#\ninclude <QStandardItemModel>\n#\ninclude <QDebug>\n#\ninclude <QResizeEvent>\n#\ninclude <QPushButton>\n#\ninclude <QProcess>\n#\ninclude <QVBoxLayout>\n#\ninclude <QTabWidget>\n#\ninclude <QSpinBox>\n#\ninclude <QRadioButton>\n#\ninclude <QListWidget>\n#\ninclude <QLineEdit>\n#\ninclude <QInputDialog>\n#\ninclude <QGroupBox>\n#\ninclude <QFormLayout>\n#\ninclude <QDir>\n#\ninclude <QDialogButtonBox>\n#\ninclude <QComboBox>\n#\ninclude <QCheckBox>\n#\n\ngoingPage {\n  d OutgoingPage::maybeShowPasswordWarning()\n  {\n      passwordWarning->setVisible(!smtpPass->text().isEmpty());\n  }\n  \n  #\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            ",",
            "ommon::LOG_OTHER,",
            "Latin1String(\"MailSynchronizer\"),",
            "Latin1String(\"Failed to insert address\"))"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Failed to insert address\")"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "MailSynchronizer\")"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_storage->insertAddress",
          "args": [
            "mlId,",
            "ame,",
            "ddress,",
            "ind"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "@')"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xpanded[3].isEmpty",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xpanded[2].isEmpty",
          "args": [],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "undisclosed-recipients;\")"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xpanded[3].isEmpty",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xpanded[2].isEmpty",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "xpanded.size() == 4"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xpanded.size",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.toStringList",
          "args": [],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "tem.type() == QVariant::StringList"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.type",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "tem.isValid()"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.isValid",
          "args": [],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ddresses.type() == QVariant::List"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::_saveAddrList( const quint64 emlId, const QVariant &addresses, const QLatin1String kind )\n  {\n      // FIXME: batched updates would be great...\n      Q_ASSERT( addresses.type() == QVariant::List );\n      Q_FOREACH( const QVariant &item, addresses.toList() ) {\n          Q_ASSERT( item.isValid() );\n          Q_ASSERT( item.type() == QVariant::StringList );\n          QStringList expanded = item.toStringList();\n          Q_ASSERT( expanded.size() == 4 );\n          QString name = expanded[0];\n  \n          QString address;\n          if ( expanded[2].isEmpty() && expanded[3].isEmpty() ) {\n              address = QLatin1String(\"undisclosed-recipients;\");\n          } else if ( expanded[2].isEmpty() ) {\n              address = expanded[3];\n          } else if ( expanded[3].isEmpty() ) {\n              address = expanded[2];\n          } else {\n              address = expanded[2] + QLatin1Char('@') + expanded[3];\n          }\n  \n          if ( m_storage->insertAddress( emlId, name, address, kind ) != SqlStorage::RESULT_OK ) {\n              m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                                QLatin1String(\"Failed to insert address\"));\n              qWarning() << \"Failed to insert address\";\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "slotMessageDataReady(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "143-196",
    "snippet": "oid MailSynchronizer::slotMessageDataReady( const QModelIndex &message, const QByteArray &headers, const QByteArray &body, const QString &mainPart )\n{\n    Common::SqlTransactionAutoAborter guard = m_storage->transactionGuard();\n\n    QVariant dateTimeVariant = message.data( Imap::Mailbox::RoleMessageDate );\n    QVariant subject = message.data( Imap::Mailbox::RoleMessageSubject );\n    Q_ASSERT(dateTimeVariant.isValid());\n    Q_ASSERT(subject.isValid());\n    QDateTime dateTime = dateTimeVariant.toDateTime();\n    if ( dateTime.isNull() ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                          QString::fromUtf8(\"Warning: unknown timestamp for UID %1 in %2 - using current one\").arg(\n                              message.data(Imap::Mailbox::RoleMessageUid).toString(),\n                              message.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()));\n        dateTime = QDateTime::currentDateTimeUtc();\n    }\n\n    quint64 emlId;\n    SqlStorage::ResultType res = m_storage->insertMail( dateTime, subject.toString(),\n                                                        mainPart, headers, body, emlId );\n\n    if ( res == SqlStorage::RESULT_DUPLICATE ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"), QLatin1String(\"Duplicate message\"));\n        emit messageIsDuplicate( m_mailbox, message );\n        return;\n    }\n\n    if ( res == SqlStorage::RESULT_ERROR ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"), QLatin1String(\"Cannot store into Postgres\"));\n        qWarning() << \"Inserting failed\";\n        return;\n    }\n\n    _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageFrom ), QLatin1String(\"FROM\") );\n    _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageTo ), QLatin1String(\"TO\") );\n    _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageCc ), QLatin1String(\"CC\") );\n    _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageBcc ), QLatin1String(\"BCC\") );\n\n    if ( m_storage->markMailReady( emlId ) != SqlStorage::RESULT_OK ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                          QLatin1String(\"Failed to mark mail ready\"));\n        qWarning() << \"Failed to mark mail ready\";\n        return;\n    }\n\n    if ( ! guard.commit() ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                          QLatin1String(\"Failed to commit current transaction\"));\n        m_storage->fail( QLatin1String(\"Failed to commit current transaction\") );\n        return;\n    }\n\n    emit messageSaved( m_mailbox, message );\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_storage->fail",
          "args": [
            "Latin1String(\"Failed to commit current transaction\")"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Failed to commit current transaction\")"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            "essage,",
            "ommon::LOG_OTHER,",
            "Latin1String(\"MailSynchronizer\"),",
            "Latin1String(\"Failed to commit current transaction\"))"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Failed to commit current transaction\")"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "MailSynchronizer\")"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uard.commit",
          "args": [],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Warning(",
          "args": [],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "maybeShowPasswordWarning()",
          "container": "goingPage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SettingsDialog.cpp",
          "lines": "761-764",
          "snippet": "d OutgoingPage::maybeShowPasswordWarning()\n{\n    passwordWarning->setVisible(!smtpPass->text().isEmpty());\n}\n\n#",
          "includes": [
            "include \"Gui/Util.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include <QDataWidgetMapper>\n#",
            "include <QMessageBox>\n#",
            "include <QToolTip>\n#",
            "include <QStandardItemModel>\n#",
            "include <QDebug>\n#",
            "include <QResizeEvent>\n#",
            "include <QPushButton>\n#",
            "include <QProcess>\n#",
            "include <QVBoxLayout>\n#",
            "include <QTabWidget>\n#",
            "include <QSpinBox>\n#",
            "include <QRadioButton>\n#",
            "include <QListWidget>\n#",
            "include <QLineEdit>\n#",
            "include <QInputDialog>\n#",
            "include <QGroupBox>\n#",
            "include <QFormLayout>\n#",
            "include <QDir>\n#",
            "include <QDialogButtonBox>\n#",
            "include <QComboBox>\n#",
            "include <QCheckBox>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Gui/Util.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude <QDataWidgetMapper>\n#\ninclude <QMessageBox>\n#\ninclude <QToolTip>\n#\ninclude <QStandardItemModel>\n#\ninclude <QDebug>\n#\ninclude <QResizeEvent>\n#\ninclude <QPushButton>\n#\ninclude <QProcess>\n#\ninclude <QVBoxLayout>\n#\ninclude <QTabWidget>\n#\ninclude <QSpinBox>\n#\ninclude <QRadioButton>\n#\ninclude <QListWidget>\n#\ninclude <QLineEdit>\n#\ninclude <QInputDialog>\n#\ninclude <QGroupBox>\n#\ninclude <QFormLayout>\n#\ninclude <QDir>\n#\ninclude <QDialogButtonBox>\n#\ninclude <QComboBox>\n#\ninclude <QCheckBox>\n#\n\ngoingPage {\n  d OutgoingPage::maybeShowPasswordWarning()\n  {\n      passwordWarning->setVisible(!smtpPass->text().isEmpty());\n  }\n  \n  #\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            "essage,",
            "ommon::LOG_OTHER,",
            "Latin1String(\"MailSynchronizer\"),",
            "Latin1String(\"Failed to mark mail ready\"))"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Failed to mark mail ready\")"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "MailSynchronizer\")"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_storage->markMailReady",
          "args": [
            "mlId"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "saveAddrList(",
          "args": [
            "mlId,",
            "essage.data( Imap::Mailbox::RoleMessageBcc ),",
            "Latin1String(\"BCC\")"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "_saveAddrList(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "198-226",
          "snippet": "oid MailSynchronizer::_saveAddrList( const quint64 emlId, const QVariant &addresses, const QLatin1String kind )\n{\n    // FIXME: batched updates would be great...\n    Q_ASSERT( addresses.type() == QVariant::List );\n    Q_FOREACH( const QVariant &item, addresses.toList() ) {\n        Q_ASSERT( item.isValid() );\n        Q_ASSERT( item.type() == QVariant::StringList );\n        QStringList expanded = item.toStringList();\n        Q_ASSERT( expanded.size() == 4 );\n        QString name = expanded[0];\n\n        QString address;\n        if ( expanded[2].isEmpty() && expanded[3].isEmpty() ) {\n            address = QLatin1String(\"undisclosed-recipients;\");\n        } else if ( expanded[2].isEmpty() ) {\n            address = expanded[3];\n        } else if ( expanded[3].isEmpty() ) {\n            address = expanded[2];\n        } else {\n            address = expanded[2] + QLatin1Char('@') + expanded[3];\n        }\n\n        if ( m_storage->insertAddress( emlId, name, address, kind ) != SqlStorage::RESULT_OK ) {\n            m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                              QLatin1String(\"Failed to insert address\"));\n            qWarning() << \"Failed to insert address\";\n        }\n    }\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::_saveAddrList( const quint64 emlId, const QVariant &addresses, const QLatin1String kind )\n  {\n      // FIXME: batched updates would be great...\n      Q_ASSERT( addresses.type() == QVariant::List );\n      Q_FOREACH( const QVariant &item, addresses.toList() ) {\n          Q_ASSERT( item.isValid() );\n          Q_ASSERT( item.type() == QVariant::StringList );\n          QStringList expanded = item.toStringList();\n          Q_ASSERT( expanded.size() == 4 );\n          QString name = expanded[0];\n  \n          QString address;\n          if ( expanded[2].isEmpty() && expanded[3].isEmpty() ) {\n              address = QLatin1String(\"undisclosed-recipients;\");\n          } else if ( expanded[2].isEmpty() ) {\n              address = expanded[3];\n          } else if ( expanded[3].isEmpty() ) {\n              address = expanded[2];\n          } else {\n              address = expanded[2] + QLatin1Char('@') + expanded[3];\n          }\n  \n          if ( m_storage->insertAddress( emlId, name, address, kind ) != SqlStorage::RESULT_OK ) {\n              m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                                QLatin1String(\"Failed to insert address\"));\n              qWarning() << \"Failed to insert address\";\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "BCC\")"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageBcc"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "CC\")"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageCc"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "TO\")"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageTo"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "FROM\")"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageFrom"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            "essage,",
            "ommon::LOG_OTHER,",
            "Latin1String(\"MailSynchronizer\"),",
            "Latin1String(\"Cannot store into Postgres\"))"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Cannot store into Postgres\")"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "MailSynchronizer\")"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            "essage,",
            "ommon::LOG_OTHER,",
            "Latin1String(\"MailSynchronizer\"),",
            "Latin1String(\"Duplicate message\"))"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Duplicate message\")"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "MailSynchronizer\")"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_storage->insertMail",
          "args": [
            "ateTime,",
            "ubject.toString(),",
            "ainPart,",
            "eaders,",
            "ody,",
            "mlId"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubject.toString",
          "args": [],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTime::currentDateTimeUtc(",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->logTrace",
          "args": [
            "essage,",
            "ommon::LOG_OTHER,",
            "Latin1String(\"MailSynchronizer\"),",
            "String::fromUtf8(\"Warning: unknown timestamp for UID %1 in %2 - using current one\").arg(\n                              message.data(Imap::Mailbox::RoleMessageUid).toString(),\n                              message.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()))"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8",
          "args": [
            "essage.data(Imap::Mailbox::RoleMessageUid).toString(),",
            "essage.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString())"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.parent",
          "args": [],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "229-268",
          "snippet": "void ModelTest::parent()\n{\n    // Make sure the model wont crash and will return an invalid QModelIndex\n    // when asked for the parent of an invalid index.\n    Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // Column 0                | Column 1    |\n    // QModelIndex()           |             |\n    //    \\- topIndex          | topIndex1   |\n    //         \\- childIndex   | childIndex1 |\n\n    // Common error test #1, make sure that a top level index has a parent\n    // that is a invalid QModelIndex.\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    Q_ASSERT(model->parent(topIndex) == QModelIndex());\n\n    // Common error test #2, make sure that a second level index has a parent\n    // that is the first level index.\n    if (model->rowCount(topIndex) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        Q_ASSERT(model->parent(childIndex) == topIndex);\n    }\n\n    // Common error test #3, the second column should NOT have the same children\n    // as the first column in a row.\n    // Usually the second column shouldn't have children.\n    QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n    if (model->rowCount(topIndex1) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n        Q_ASSERT(childIndex != childIndex1);\n    }\n\n    // Full test, walk n levels deep through the model making sure that all\n    // parent's children correctly specify their parent.\n    checkChildren(QModelIndex());\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::parent()\n  {\n      // Make sure the model wont crash and will return an invalid QModelIndex\n      // when asked for the parent of an invalid index.\n      Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // Column 0                | Column 1    |\n      // QModelIndex()           |             |\n      //    \\- topIndex          | topIndex1   |\n      //         \\- childIndex   | childIndex1 |\n  \n      // Common error test #1, make sure that a top level index has a parent\n      // that is a invalid QModelIndex.\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      Q_ASSERT(model->parent(topIndex) == QModelIndex());\n  \n      // Common error test #2, make sure that a second level index has a parent\n      // that is the first level index.\n      if (model->rowCount(topIndex) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          Q_ASSERT(model->parent(childIndex) == topIndex);\n      }\n  \n      // Common error test #3, the second column should NOT have the same children\n      // as the first column in a row.\n      // Usually the second column shouldn't have children.\n      QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n      if (model->rowCount(topIndex1) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n          Q_ASSERT(childIndex != childIndex1);\n      }\n  \n      // Full test, walk n levels deep through the model making sure that all\n      // parent's children correctly specify their parent.\n      checkChildren(QModelIndex());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essage.parent",
          "args": [
            "map::Mailbox::RoleMailboxName)"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageUid)"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "Warning: unknown timestamp for UID %1 in %2 - using current one\")"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "MailSynchronizer\")"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ateTime.isNull",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ateTimeVariant.toDateTime",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ubject.isValid())"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ubject.isValid",
          "args": [],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ateTimeVariant.isValid())"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageSubject"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essage.data",
          "args": [
            "map::Mailbox::RoleMessageDate"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_storage->transactionGuard",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotMessageDataReady( const QModelIndex &message, const QByteArray &headers, const QByteArray &body, const QString &mainPart )\n  {\n      Common::SqlTransactionAutoAborter guard = m_storage->transactionGuard();\n  \n      QVariant dateTimeVariant = message.data( Imap::Mailbox::RoleMessageDate );\n      QVariant subject = message.data( Imap::Mailbox::RoleMessageSubject );\n      Q_ASSERT(dateTimeVariant.isValid());\n      Q_ASSERT(subject.isValid());\n      QDateTime dateTime = dateTimeVariant.toDateTime();\n      if ( dateTime.isNull() ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                            QString::fromUtf8(\"Warning: unknown timestamp for UID %1 in %2 - using current one\").arg(\n                                message.data(Imap::Mailbox::RoleMessageUid).toString(),\n                                message.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()));\n          dateTime = QDateTime::currentDateTimeUtc();\n      }\n  \n      quint64 emlId;\n      SqlStorage::ResultType res = m_storage->insertMail( dateTime, subject.toString(),\n                                                          mainPart, headers, body, emlId );\n  \n      if ( res == SqlStorage::RESULT_DUPLICATE ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"), QLatin1String(\"Duplicate message\"));\n          emit messageIsDuplicate( m_mailbox, message );\n          return;\n      }\n  \n      if ( res == SqlStorage::RESULT_ERROR ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"), QLatin1String(\"Cannot store into Postgres\"));\n          qWarning() << \"Inserting failed\";\n          return;\n      }\n  \n      _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageFrom ), QLatin1String(\"FROM\") );\n      _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageTo ), QLatin1String(\"TO\") );\n      _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageCc ), QLatin1String(\"CC\") );\n      _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageBcc ), QLatin1String(\"BCC\") );\n  \n      if ( m_storage->markMailReady( emlId ) != SqlStorage::RESULT_OK ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                            QLatin1String(\"Failed to mark mail ready\"));\n          qWarning() << \"Failed to mark mail ready\";\n          return;\n      }\n  \n      if ( ! guard.commit() ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                            QLatin1String(\"Failed to commit current transaction\"));\n          m_storage->fail( QLatin1String(\"Failed to commit current transaction\") );\n          return;\n      }\n  \n      emit messageSaved( m_mailbox, message );\n  }\n}"
  },
  {
    "function_name": "switchHere(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "135-141",
    "snippet": "oid MailSynchronizer::switchHere()\n{\n    if ( renewMailboxIndex() )\n        return;\n\n    m_model->switchToMailbox( m_index );\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_model->switchToMailbox",
          "args": [
            "_index"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enewMailboxIndex(",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "renewMailboxIndex(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "124-133",
          "snippet": "ool MailSynchronizer::renewMailboxIndex()\n{\n    if ( ! m_index.isValid() ) {\n        qDebug() << \"Oops, we've lost the mailbox\" << m_mailbox <<\", will ask for it again in a while.\";\n        QTimer::singleShot( 14*1000 /*1000 * 60 * 2*/, this, SLOT(slotGetMailboxIndexAgain()) );\n        return true;\n    } else {\n        return false;\n    }\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  ool MailSynchronizer::renewMailboxIndex()\n  {\n      if ( ! m_index.isValid() ) {\n          qDebug() << \"Oops, we've lost the mailbox\" << m_mailbox <<\", will ask for it again in a while.\";\n          QTimer::singleShot( 14*1000 /*1000 * 60 * 2*/, this, SLOT(slotGetMailboxIndexAgain()) );\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::switchHere()\n  {\n      if ( renewMailboxIndex() )\n          return;\n  \n      m_model->switchToMailbox( m_index );\n  }\n}"
  },
  {
    "function_name": "renewMailboxIndex(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "124-133",
    "snippet": "ool MailSynchronizer::renewMailboxIndex()\n{\n    if ( ! m_index.isValid() ) {\n        qDebug() << \"Oops, we've lost the mailbox\" << m_mailbox <<\", will ask for it again in a while.\";\n        QTimer::singleShot( 14*1000 /*1000 * 60 * 2*/, this, SLOT(slotGetMailboxIndexAgain()) );\n        return true;\n    } else {\n        return false;\n    }\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Timer::singleShot(",
          "args": [
            "4*1000 *1000 * 60 * 2*/,",
            "his,",
            "LOT(slotGetMailboxIndexAgain())"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotGetMailboxIndexAgain())"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotGetMailboxIndexAgain(",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "slotGetMailboxIndexAgain(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "63-67",
          "snippet": "oid MailSynchronizer::slotGetMailboxIndexAgain()\n{\n    Q_ASSERT(m_finder);\n    m_finder->addMailbox( m_mailbox );\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotGetMailboxIndexAgain()\n  {\n      Q_ASSERT(m_finder);\n      m_finder->addMailbox( m_mailbox );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_index.isValid",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  ool MailSynchronizer::renewMailboxIndex()\n  {\n      if ( ! m_index.isValid() ) {\n          qDebug() << \"Oops, we've lost the mailbox\" << m_mailbox <<\", will ask for it again in a while.\";\n          QTimer::singleShot( 14*1000 /*1000 * 60 * 2*/, this, SLOT(slotGetMailboxIndexAgain()) );\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
  },
  {
    "function_name": "walkThroughMessages(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "88-122",
    "snippet": "oid MailSynchronizer::walkThroughMessages( int start, int end )\n{\n    if ( renewMailboxIndex() )\n        return;\n\n    QModelIndex list = m_index.child( 0, 0 );\n    Q_ASSERT( list.isValid() );\n\n    if ( start == -1 && end == -1 ) {\n        start = 0;\n        end = m_model->rowCount( list ) - 1;\n    } else {\n        start = qMax( start, 0 );\n        end = qMin( end, m_model->rowCount( list ) - 1 );\n    }\n\n    for ( int i = start; i <= end; ++i ) {\n        QModelIndex message = m_model->index( i, 0, list );\n        Q_ASSERT( message.isValid() );\n        QVariant uid = m_model->data( message, Imap::Mailbox::RoleMessageUid );\n\n        if ( uid.isValid() && uid.toUInt() != 0 ) {\n            bool shouldLoad = true;\n            emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n            if ( shouldLoad ) {\n                m_downloader->requestDownload( message );\n            }\n        } else {\n            m_deferredMessages << message;\n            if ( ! m_deferredTimer->isActive() )\n                m_deferredTimer->start();\n            //qDebug() << \"Message not synced yet, will check in a while\" << m_mailbox << i;\n        }\n    }\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_deferredTimer->start",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredTimer->isActive",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_downloader->requestDownload",
          "args": [
            "essage"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "id.toUInt",
          "args": [],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "id.isValid",
          "args": [],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->data",
          "args": [
            "essage,",
            "map::Mailbox::RoleMessageUid"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "essage.isValid()"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->index",
          "args": [
            ",",
            ",",
            "ist"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Min(",
          "args": [
            "nd,",
            "_model->rowCount( list ) - 1"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_model->rowCount",
          "args": [
            "ist"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Max(",
          "args": [
            "tart,"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "doEmitProgressMax(",
          "container": "akeFactory",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/MSA/FakeMSA.cpp",
          "lines": "96-99",
          "snippet": "oid FakeFactory::doEmitProgressMax(int max)\n{\n    emit lastMSA()->progressMax(max);\n}",
          "includes": [
            "include \"FakeMSA.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"FakeMSA.h\"\n\nakeFactory {\n  oid FakeFactory::doEmitProgressMax(int max)\n  {\n      emit lastMSA()->progressMax(max);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_model->rowCount",
          "args": [
            "ist"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ist.isValid()"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_index.child",
          "args": [
            ","
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "enewMailboxIndex(",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "renewMailboxIndex(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "124-133",
          "snippet": "ool MailSynchronizer::renewMailboxIndex()\n{\n    if ( ! m_index.isValid() ) {\n        qDebug() << \"Oops, we've lost the mailbox\" << m_mailbox <<\", will ask for it again in a while.\";\n        QTimer::singleShot( 14*1000 /*1000 * 60 * 2*/, this, SLOT(slotGetMailboxIndexAgain()) );\n        return true;\n    } else {\n        return false;\n    }\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  ool MailSynchronizer::renewMailboxIndex()\n  {\n      if ( ! m_index.isValid() ) {\n          qDebug() << \"Oops, we've lost the mailbox\" << m_mailbox <<\", will ask for it again in a while.\";\n          QTimer::singleShot( 14*1000 /*1000 * 60 * 2*/, this, SLOT(slotGetMailboxIndexAgain()) );\n          return true;\n      } else {\n          return false;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::walkThroughMessages( int start, int end )\n  {\n      if ( renewMailboxIndex() )\n          return;\n  \n      QModelIndex list = m_index.child( 0, 0 );\n      Q_ASSERT( list.isValid() );\n  \n      if ( start == -1 && end == -1 ) {\n          start = 0;\n          end = m_model->rowCount( list ) - 1;\n      } else {\n          start = qMax( start, 0 );\n          end = qMin( end, m_model->rowCount( list ) - 1 );\n      }\n  \n      for ( int i = start; i <= end; ++i ) {\n          QModelIndex message = m_model->index( i, 0, list );\n          Q_ASSERT( message.isValid() );\n          QVariant uid = m_model->data( message, Imap::Mailbox::RoleMessageUid );\n  \n          if ( uid.isValid() && uid.toUInt() != 0 ) {\n              bool shouldLoad = true;\n              emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n              if ( shouldLoad ) {\n                  m_downloader->requestDownload( message );\n              }\n          } else {\n              m_deferredMessages << message;\n              if ( ! m_deferredTimer->isActive() )\n                  m_deferredTimer->start();\n              //qDebug() << \"Message not synced yet, will check in a while\" << m_mailbox << i;\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "slotRowsInserted(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "79-86",
    "snippet": "oid MailSynchronizer::slotRowsInserted(const QModelIndex &parent, int start, int end)\n{\n    // check the mailbox's list, if it's the same index as the \"parent\" we just got passed\n    if ( parent.parent() != m_index )\n        return;\n\n    walkThroughMessages( start, end );\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alkThroughMessages(",
          "args": [
            "tart,",
            "nd"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "walkThroughMessages(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "88-122",
          "snippet": "oid MailSynchronizer::walkThroughMessages( int start, int end )\n{\n    if ( renewMailboxIndex() )\n        return;\n\n    QModelIndex list = m_index.child( 0, 0 );\n    Q_ASSERT( list.isValid() );\n\n    if ( start == -1 && end == -1 ) {\n        start = 0;\n        end = m_model->rowCount( list ) - 1;\n    } else {\n        start = qMax( start, 0 );\n        end = qMin( end, m_model->rowCount( list ) - 1 );\n    }\n\n    for ( int i = start; i <= end; ++i ) {\n        QModelIndex message = m_model->index( i, 0, list );\n        Q_ASSERT( message.isValid() );\n        QVariant uid = m_model->data( message, Imap::Mailbox::RoleMessageUid );\n\n        if ( uid.isValid() && uid.toUInt() != 0 ) {\n            bool shouldLoad = true;\n            emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n            if ( shouldLoad ) {\n                m_downloader->requestDownload( message );\n            }\n        } else {\n            m_deferredMessages << message;\n            if ( ! m_deferredTimer->isActive() )\n                m_deferredTimer->start();\n            //qDebug() << \"Message not synced yet, will check in a while\" << m_mailbox << i;\n        }\n    }\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::walkThroughMessages( int start, int end )\n  {\n      if ( renewMailboxIndex() )\n          return;\n  \n      QModelIndex list = m_index.child( 0, 0 );\n      Q_ASSERT( list.isValid() );\n  \n      if ( start == -1 && end == -1 ) {\n          start = 0;\n          end = m_model->rowCount( list ) - 1;\n      } else {\n          start = qMax( start, 0 );\n          end = qMin( end, m_model->rowCount( list ) - 1 );\n      }\n  \n      for ( int i = start; i <= end; ++i ) {\n          QModelIndex message = m_model->index( i, 0, list );\n          Q_ASSERT( message.isValid() );\n          QVariant uid = m_model->data( message, Imap::Mailbox::RoleMessageUid );\n  \n          if ( uid.isValid() && uid.toUInt() != 0 ) {\n              bool shouldLoad = true;\n              emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n              if ( shouldLoad ) {\n                  m_downloader->requestDownload( message );\n              }\n          } else {\n              m_deferredMessages << message;\n              if ( ! m_deferredTimer->isActive() )\n                  m_deferredTimer->start();\n              //qDebug() << \"Message not synced yet, will check in a while\" << m_mailbox << i;\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arent.parent",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "parent",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "229-268",
          "snippet": "void ModelTest::parent()\n{\n    // Make sure the model wont crash and will return an invalid QModelIndex\n    // when asked for the parent of an invalid index.\n    Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // Column 0                | Column 1    |\n    // QModelIndex()           |             |\n    //    \\- topIndex          | topIndex1   |\n    //         \\- childIndex   | childIndex1 |\n\n    // Common error test #1, make sure that a top level index has a parent\n    // that is a invalid QModelIndex.\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    Q_ASSERT(model->parent(topIndex) == QModelIndex());\n\n    // Common error test #2, make sure that a second level index has a parent\n    // that is the first level index.\n    if (model->rowCount(topIndex) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        Q_ASSERT(model->parent(childIndex) == topIndex);\n    }\n\n    // Common error test #3, the second column should NOT have the same children\n    // as the first column in a row.\n    // Usually the second column shouldn't have children.\n    QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n    if (model->rowCount(topIndex1) > 0) {\n        QModelIndex childIndex = model->index(0, 0, topIndex);\n        QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n        Q_ASSERT(childIndex != childIndex1);\n    }\n\n    // Full test, walk n levels deep through the model making sure that all\n    // parent's children correctly specify their parent.\n    checkChildren(QModelIndex());\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::parent()\n  {\n      // Make sure the model wont crash and will return an invalid QModelIndex\n      // when asked for the parent of an invalid index.\n      Q_ASSERT(model->parent(QModelIndex()) == QModelIndex());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // Column 0                | Column 1    |\n      // QModelIndex()           |             |\n      //    \\- topIndex          | topIndex1   |\n      //         \\- childIndex   | childIndex1 |\n  \n      // Common error test #1, make sure that a top level index has a parent\n      // that is a invalid QModelIndex.\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      Q_ASSERT(model->parent(topIndex) == QModelIndex());\n  \n      // Common error test #2, make sure that a second level index has a parent\n      // that is the first level index.\n      if (model->rowCount(topIndex) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          Q_ASSERT(model->parent(childIndex) == topIndex);\n      }\n  \n      // Common error test #3, the second column should NOT have the same children\n      // as the first column in a row.\n      // Usually the second column shouldn't have children.\n      QModelIndex topIndex1 = model->index(0, 1, QModelIndex());\n      if (model->rowCount(topIndex1) > 0) {\n          QModelIndex childIndex = model->index(0, 0, topIndex);\n          QModelIndex childIndex1 = model->index(0, 0, topIndex1);\n          Q_ASSERT(childIndex != childIndex1);\n      }\n  \n      // Full test, walk n levels deep through the model making sure that all\n      // parent's children correctly specify their parent.\n      checkChildren(QModelIndex());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotRowsInserted(const QModelIndex &parent, int start, int end)\n  {\n      // check the mailbox's list, if it's the same index as the \"parent\" we just got passed\n      if ( parent.parent() != m_index )\n          return;\n  \n      walkThroughMessages( start, end );\n  }\n}"
  },
  {
    "function_name": "slotMailboxFound(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "69-77",
    "snippet": "oid MailSynchronizer::slotMailboxFound( const QString &mailbox, const QModelIndex &index )\n{\n    if ( mailbox != m_mailbox )\n        return;\n\n    m_index = index;\n    switchHere();\n    walkThroughMessages( -1, -1 );\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alkThroughMessages(",
          "args": [
            "1,",
            "1"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "walkThroughMessages(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "88-122",
          "snippet": "oid MailSynchronizer::walkThroughMessages( int start, int end )\n{\n    if ( renewMailboxIndex() )\n        return;\n\n    QModelIndex list = m_index.child( 0, 0 );\n    Q_ASSERT( list.isValid() );\n\n    if ( start == -1 && end == -1 ) {\n        start = 0;\n        end = m_model->rowCount( list ) - 1;\n    } else {\n        start = qMax( start, 0 );\n        end = qMin( end, m_model->rowCount( list ) - 1 );\n    }\n\n    for ( int i = start; i <= end; ++i ) {\n        QModelIndex message = m_model->index( i, 0, list );\n        Q_ASSERT( message.isValid() );\n        QVariant uid = m_model->data( message, Imap::Mailbox::RoleMessageUid );\n\n        if ( uid.isValid() && uid.toUInt() != 0 ) {\n            bool shouldLoad = true;\n            emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n            if ( shouldLoad ) {\n                m_downloader->requestDownload( message );\n            }\n        } else {\n            m_deferredMessages << message;\n            if ( ! m_deferredTimer->isActive() )\n                m_deferredTimer->start();\n            //qDebug() << \"Message not synced yet, will check in a while\" << m_mailbox << i;\n        }\n    }\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::walkThroughMessages( int start, int end )\n  {\n      if ( renewMailboxIndex() )\n          return;\n  \n      QModelIndex list = m_index.child( 0, 0 );\n      Q_ASSERT( list.isValid() );\n  \n      if ( start == -1 && end == -1 ) {\n          start = 0;\n          end = m_model->rowCount( list ) - 1;\n      } else {\n          start = qMax( start, 0 );\n          end = qMin( end, m_model->rowCount( list ) - 1 );\n      }\n  \n      for ( int i = start; i <= end; ++i ) {\n          QModelIndex message = m_model->index( i, 0, list );\n          Q_ASSERT( message.isValid() );\n          QVariant uid = m_model->data( message, Imap::Mailbox::RoleMessageUid );\n  \n          if ( uid.isValid() && uid.toUInt() != 0 ) {\n              bool shouldLoad = true;\n              emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n              if ( shouldLoad ) {\n                  m_downloader->requestDownload( message );\n              }\n          } else {\n              m_deferredMessages << message;\n              if ( ! m_deferredTimer->isActive() )\n                  m_deferredTimer->start();\n              //qDebug() << \"Message not synced yet, will check in a while\" << m_mailbox << i;\n          }\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "witchHere(",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "switchHere(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "135-141",
          "snippet": "oid MailSynchronizer::switchHere()\n{\n    if ( renewMailboxIndex() )\n        return;\n\n    m_model->switchToMailbox( m_index );\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::switchHere()\n  {\n      if ( renewMailboxIndex() )\n          return;\n  \n      m_model->switchToMailbox( m_index );\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotMailboxFound( const QString &mailbox, const QModelIndex &index )\n  {\n      if ( mailbox != m_mailbox )\n          return;\n  \n      m_index = index;\n      switchHere();\n      walkThroughMessages( -1, -1 );\n  }\n}"
  },
  {
    "function_name": "slotGetMailboxIndexAgain(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "63-67",
    "snippet": "oid MailSynchronizer::slotGetMailboxIndexAgain()\n{\n    Q_ASSERT(m_finder);\n    m_finder->addMailbox( m_mailbox );\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_finder->addMailbox",
          "args": [
            "_mailbox"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_finder)"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotGetMailboxIndexAgain()\n  {\n      Q_ASSERT(m_finder);\n      m_finder->addMailbox( m_mailbox );\n  }\n}"
  },
  {
    "function_name": "setMailbox(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "56-61",
    "snippet": "oid MailSynchronizer::setMailbox( const QString &mailbox )\n{\n    m_mailbox = mailbox;\n    qDebug() << \"Will watch mailbox\" << mailbox;\n    slotGetMailboxIndexAgain();\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lotGetMailboxIndexAgain(",
          "args": [],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "slotGetMailboxIndexAgain(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "63-67",
          "snippet": "oid MailSynchronizer::slotGetMailboxIndexAgain()\n{\n    Q_ASSERT(m_finder);\n    m_finder->addMailbox( m_mailbox );\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotGetMailboxIndexAgain()\n  {\n      Q_ASSERT(m_finder);\n      m_finder->addMailbox( m_mailbox );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Debug(",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::setMailbox( const QString &mailbox )\n  {\n      m_mailbox = mailbox;\n      qDebug() << \"Will watch mailbox\" << mailbox;\n      slotGetMailboxIndexAgain();\n  }\n}"
  },
  {
    "function_name": "MailSynchronizer(",
    "container": "ailSynchronizer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
    "lines": "39-54",
    "snippet": "ailSynchronizer::MailSynchronizer( QObject *parent, Imap::Mailbox::Model *model, MailboxFinder *finder, MessageDownloader *downloader, SqlStorage *storage ) :\n    QObject(parent), m_model(model), m_finder(finder), m_downloader(downloader), m_storage(storage)\n{\n    Q_ASSERT(m_model);\n    Q_ASSERT(m_finder);\n    Q_ASSERT(m_downloader);\n    Q_ASSERT(m_storage);\n    connect( m_model, SIGNAL(rowsInserted(QModelIndex,int,int)), this, SLOT(slotRowsInserted(QModelIndex,int,int)) );\n    connect( m_finder, SIGNAL(mailboxFound(QString,QModelIndex)), this, SLOT(slotMailboxFound(QString,QModelIndex)) );\n    connect( m_downloader, SIGNAL(messageDownloaded(QModelIndex,QByteArray,QByteArray,QString)),\n             this, SLOT(slotMessageDataReady(QModelIndex,QByteArray,QByteArray,QString)) );\n    m_deferredTimer = new QTimer(this);\n    m_deferredTimer->setSingleShot(true);\n    m_deferredTimer->setInterval(5000);\n    connect(m_deferredTimer, SIGNAL(timeout()), this, SLOT(slotWalkDeferredMessages()));\n}",
    "includes": [
      "include \"SqlStorage.h\"",
      "include \"MessageDownloader.h\"\n#",
      "include \"Imap/Model/MailboxFinder.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"MailSynchronizer.h\"\n#",
      "include <QDebug>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_deferredTimer,",
            "IGNAL(timeout()),",
            "his,",
            "LOT(slotWalkDeferredMessages()))"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotWalkDeferredMessages())"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotWalkDeferredMessages(",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "slotWalkDeferredMessages(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "241-267",
          "snippet": "oid MailSynchronizer::slotWalkDeferredMessages()\n{\n    QList<QPersistentModelIndex>::iterator it = m_deferredMessages.begin();\n    while (it != m_deferredMessages.end()) {\n        if ( ! it->isValid() ) {\n            qDebug() << \"A message got removed between the moment we saw it for the first time and the time we tried to process it\";\n            it = m_deferredMessages.erase(it);\n            continue;\n        }\n        QVariant uid = it->data(Imap::Mailbox::RoleMessageUid);\n        Q_ASSERT(uid.isValid());\n        if ( uid.toUInt() == 0 ) {\n            qDebug() << m_mailbox << \": still no UID for message #\" << it->row() + 1;\n            ++it;\n        } else {\n            bool shouldLoad = true;\n            QModelIndex message = *it;\n            it = m_deferredMessages.erase(it);\n            emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n            if ( shouldLoad ) {\n                m_downloader->requestDownload(message);\n            }\n        }\n    }\n    if ( ! m_deferredMessages.isEmpty() )\n        m_deferredTimer->start();\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotWalkDeferredMessages()\n  {\n      QList<QPersistentModelIndex>::iterator it = m_deferredMessages.begin();\n      while (it != m_deferredMessages.end()) {\n          if ( ! it->isValid() ) {\n              qDebug() << \"A message got removed between the moment we saw it for the first time and the time we tried to process it\";\n              it = m_deferredMessages.erase(it);\n              continue;\n          }\n          QVariant uid = it->data(Imap::Mailbox::RoleMessageUid);\n          Q_ASSERT(uid.isValid());\n          if ( uid.toUInt() == 0 ) {\n              qDebug() << m_mailbox << \": still no UID for message #\" << it->row() + 1;\n              ++it;\n          } else {\n              bool shouldLoad = true;\n              QModelIndex message = *it;\n              it = m_deferredMessages.erase(it);\n              emit aboutToRequestMessage( m_mailbox, message, &shouldLoad );\n              if ( shouldLoad ) {\n                  m_downloader->requestDownload(message);\n              }\n          }\n      }\n      if ( ! m_deferredMessages.isEmpty() )\n          m_deferredTimer->start();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "imeout())"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "imeout(",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredTimer->setInterval",
          "args": [
            "000)"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_deferredTimer->setSingleShot",
          "args": [
            "rue)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_downloader,",
            "IGNAL(messageDownloaded(QModelIndex,QByteArray,QByteArray,QString)),",
            "his,",
            "LOT(slotMessageDataReady(QModelIndex,QByteArray,QByteArray,QString))"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotMessageDataReady(QModelIndex,QByteArray,QByteArray,QString))"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotMessageDataReady(",
          "args": [
            "ModelIndex,",
            "ByteArray,",
            "ByteArray,",
            "String)"
          ],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "slotMessageDataReady(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "143-196",
          "snippet": "oid MailSynchronizer::slotMessageDataReady( const QModelIndex &message, const QByteArray &headers, const QByteArray &body, const QString &mainPart )\n{\n    Common::SqlTransactionAutoAborter guard = m_storage->transactionGuard();\n\n    QVariant dateTimeVariant = message.data( Imap::Mailbox::RoleMessageDate );\n    QVariant subject = message.data( Imap::Mailbox::RoleMessageSubject );\n    Q_ASSERT(dateTimeVariant.isValid());\n    Q_ASSERT(subject.isValid());\n    QDateTime dateTime = dateTimeVariant.toDateTime();\n    if ( dateTime.isNull() ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                          QString::fromUtf8(\"Warning: unknown timestamp for UID %1 in %2 - using current one\").arg(\n                              message.data(Imap::Mailbox::RoleMessageUid).toString(),\n                              message.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()));\n        dateTime = QDateTime::currentDateTimeUtc();\n    }\n\n    quint64 emlId;\n    SqlStorage::ResultType res = m_storage->insertMail( dateTime, subject.toString(),\n                                                        mainPart, headers, body, emlId );\n\n    if ( res == SqlStorage::RESULT_DUPLICATE ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"), QLatin1String(\"Duplicate message\"));\n        emit messageIsDuplicate( m_mailbox, message );\n        return;\n    }\n\n    if ( res == SqlStorage::RESULT_ERROR ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"), QLatin1String(\"Cannot store into Postgres\"));\n        qWarning() << \"Inserting failed\";\n        return;\n    }\n\n    _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageFrom ), QLatin1String(\"FROM\") );\n    _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageTo ), QLatin1String(\"TO\") );\n    _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageCc ), QLatin1String(\"CC\") );\n    _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageBcc ), QLatin1String(\"BCC\") );\n\n    if ( m_storage->markMailReady( emlId ) != SqlStorage::RESULT_OK ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                          QLatin1String(\"Failed to mark mail ready\"));\n        qWarning() << \"Failed to mark mail ready\";\n        return;\n    }\n\n    if ( ! guard.commit() ) {\n        m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                          QLatin1String(\"Failed to commit current transaction\"));\n        m_storage->fail( QLatin1String(\"Failed to commit current transaction\") );\n        return;\n    }\n\n    emit messageSaved( m_mailbox, message );\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotMessageDataReady( const QModelIndex &message, const QByteArray &headers, const QByteArray &body, const QString &mainPart )\n  {\n      Common::SqlTransactionAutoAborter guard = m_storage->transactionGuard();\n  \n      QVariant dateTimeVariant = message.data( Imap::Mailbox::RoleMessageDate );\n      QVariant subject = message.data( Imap::Mailbox::RoleMessageSubject );\n      Q_ASSERT(dateTimeVariant.isValid());\n      Q_ASSERT(subject.isValid());\n      QDateTime dateTime = dateTimeVariant.toDateTime();\n      if ( dateTime.isNull() ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                            QString::fromUtf8(\"Warning: unknown timestamp for UID %1 in %2 - using current one\").arg(\n                                message.data(Imap::Mailbox::RoleMessageUid).toString(),\n                                message.parent().parent().data(Imap::Mailbox::RoleMailboxName).toString()));\n          dateTime = QDateTime::currentDateTimeUtc();\n      }\n  \n      quint64 emlId;\n      SqlStorage::ResultType res = m_storage->insertMail( dateTime, subject.toString(),\n                                                          mainPart, headers, body, emlId );\n  \n      if ( res == SqlStorage::RESULT_DUPLICATE ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"), QLatin1String(\"Duplicate message\"));\n          emit messageIsDuplicate( m_mailbox, message );\n          return;\n      }\n  \n      if ( res == SqlStorage::RESULT_ERROR ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"), QLatin1String(\"Cannot store into Postgres\"));\n          qWarning() << \"Inserting failed\";\n          return;\n      }\n  \n      _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageFrom ), QLatin1String(\"FROM\") );\n      _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageTo ), QLatin1String(\"TO\") );\n      _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageCc ), QLatin1String(\"CC\") );\n      _saveAddrList( emlId, message.data( Imap::Mailbox::RoleMessageBcc ), QLatin1String(\"BCC\") );\n  \n      if ( m_storage->markMailReady( emlId ) != SqlStorage::RESULT_OK ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                            QLatin1String(\"Failed to mark mail ready\"));\n          qWarning() << \"Failed to mark mail ready\";\n          return;\n      }\n  \n      if ( ! guard.commit() ) {\n          m_model->logTrace(message, Common::LOG_OTHER, QLatin1String(\"MailSynchronizer\"),\n                            QLatin1String(\"Failed to commit current transaction\"));\n          m_storage->fail( QLatin1String(\"Failed to commit current transaction\") );\n          return;\n      }\n  \n      emit messageSaved( m_mailbox, message );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "essageDownloaded(QModelIndex,QByteArray,QByteArray,QString))"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "essageDownloaded(",
          "args": [
            "ModelIndex,",
            "ByteArray,",
            "ByteArray,",
            "String)"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_finder,",
            "IGNAL(mailboxFound(QString,QModelIndex)),",
            "his,",
            "LOT(slotMailboxFound(QString,QModelIndex))"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotMailboxFound(QString,QModelIndex))"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotMailboxFound(",
          "args": [
            "String,",
            "ModelIndex)"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "slotMailboxFound(",
          "container": "ailSynchronizer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/MailSynchronizer.cpp",
          "lines": "69-77",
          "snippet": "oid MailSynchronizer::slotMailboxFound( const QString &mailbox, const QModelIndex &index )\n{\n    if ( mailbox != m_mailbox )\n        return;\n\n    m_index = index;\n    switchHere();\n    walkThroughMessages( -1, -1 );\n}",
          "includes": [
            "include \"SqlStorage.h\"",
            "include \"MessageDownloader.h\"\n#",
            "include \"Imap/Model/MailboxFinder.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"MailSynchronizer.h\"\n#",
            "include <QDebug>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  oid MailSynchronizer::slotMailboxFound( const QString &mailbox, const QModelIndex &index )\n  {\n      if ( mailbox != m_mailbox )\n          return;\n  \n      m_index = index;\n      switchHere();\n      walkThroughMessages( -1, -1 );\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ailboxFound(QString,QModelIndex))"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_storage)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_downloader)"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_finder)"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_model)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"SqlStorage.h\"\ninclude \"MessageDownloader.h\"\n#\ninclude \"Imap/Model/MailboxFinder.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"MailSynchronizer.h\"\n#\ninclude <QDebug>\n#\n\nailSynchronizer {\n  ailSynchronizer::MailSynchronizer( QObject *parent, Imap::Mailbox::Model *model, MailboxFinder *finder, MessageDownloader *downloader, SqlStorage *storage ) :\n      QObject(parent), m_model(model), m_finder(finder), m_downloader(downloader), m_storage(storage)\n  {\n      Q_ASSERT(m_model);\n      Q_ASSERT(m_finder);\n      Q_ASSERT(m_downloader);\n      Q_ASSERT(m_storage);\n      connect( m_model, SIGNAL(rowsInserted(QModelIndex,int,int)), this, SLOT(slotRowsInserted(QModelIndex,int,int)) );\n      connect( m_finder, SIGNAL(mailboxFound(QString,QModelIndex)), this, SLOT(slotMailboxFound(QString,QModelIndex)) );\n      connect( m_downloader, SIGNAL(messageDownloaded(QModelIndex,QByteArray,QByteArray,QString)),\n               this, SLOT(slotMessageDataReady(QModelIndex,QByteArray,QByteArray,QString)) );\n      m_deferredTimer = new QTimer(this);\n      m_deferredTimer->setSingleShot(true);\n      m_deferredTimer->setInterval(5000);\n      connect(m_deferredTimer, SIGNAL(timeout()), this, SLOT(slotWalkDeferredMessages()));\n  }\n}"
  }
]