[
  {
    "function_name": "oreach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "956-1171",
    "snippet": "oreach (const QUrl &url, urls) {\n\n#if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n        if (url.isLocalFile()) {\n#else\n        if (url.scheme() == QLatin1String(\"file\")) {\n#endif\n            m_submission->composer()->addFileAttachment(url.path());\n        }\n    }\n}\n\nvoid ComposeWidget::slotUpdateSignature()\n{\n    QAbstractProxyModel *proxy = qobject_cast<QAbstractProxyModel*>(ui->sender->model());\n    Q_ASSERT(proxy);\n    QModelIndex proxyIndex = ui->sender->model()->index(ui->sender->currentIndex(), 0, ui->sender->rootModelIndex());\n\n    if (!proxyIndex.isValid()) {\n        // This happens when the settings dialog gets closed and the SenderIdentitiesModel reloads data from the on-disk cache\n        return;\n    }\n\n    QString newSignature = proxy->mapToSource(proxyIndex).sibling(proxyIndex.row(),\n                                                                  Composer::SenderIdentitiesModel::COLUMN_SIGNATURE)\n            .data().toString();\n\n    const bool wasEdited = m_messageEverEdited;\n    Composer::Util::replaceSignature(ui->mailText->document(), newSignature);\n    m_messageEverEdited = wasEdited;\n}\n\n/** @short Massage the list of recipients so that they match the desired type of reply\n\nIn case of an error, the original list of recipients is left as is.\n*/\nbool ComposeWidget::setReplyMode(const Composer::ReplyMode mode)\n{\n    if (!m_replyingToMessage.isValid())\n        return false;\n\n    // Determine the new list of recipients\n    Composer::RecipientList list;\n    if (!Composer::Util::replyRecipientList(mode, m_mainWindow->senderIdentitiesModel(),\n                                            m_replyingToMessage, list)) {\n        return false;\n    }\n\n    while (!m_recipients.isEmpty())\n        removeRecipient(0);\n\n    Q_FOREACH(Composer::RecipientList::value_type recipient, list) {\n        if (!recipient.second.hasUsefulDisplayName())\n            recipient.second.name.clear();\n        addRecipient(m_recipients.size(), recipient.first, recipient.second.asPrettyString());\n    }\n\n    updateRecipientList();\n    ui->mailText->setFocus();\n\n    return true;\n}\n\n/** local draft serializaton:\n * Version (int)\n * Whether this draft was stored explicitly (bool)\n * The sender (QString)\n * Amount of recipients (int)\n * n * (RecipientKind (\"int\") + recipient (QString))\n * Subject (QString)\n * The message text (QString)\n */\n\nvoid ComposeWidget::saveDraft(const QString &path)\n{\n    static const int trojitaDraftVersion = 3;\n    QFile file(path);\n    if (!file.open(QIODevice::WriteOnly))\n        return; // TODO: error message?\n    QDataStream stream(&file);\n    stream.setVersion(QDataStream::Qt_4_6);\n    stream << trojitaDraftVersion << m_explicitDraft << ui->sender->currentText();\n    stream << m_recipients.count();\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        stream << m_recipients.at(i).first->itemData(m_recipients.at(i).first->currentIndex()).toInt();\n        stream << m_recipients.at(i).second->text();\n    }\n    stream << m_submission->composer()->timestamp() << m_inReplyTo << m_references;\n    stream << m_actionInReplyTo->isChecked();\n    stream << ui->subject->text();\n    stream << ui->mailText->toPlainText();\n    // we spare attachments\n    // a) serializing isn't an option, they could be HUUUGE\n    // b) storing urls only works for urls\n    // c) the data behind the url or the url validity might have changed\n    // d) nasty part is writing mails - DnD a file into it is not a problem\n    file.close();\n    file.setPermissions(QFile::ReadOwner|QFile::WriteOwner);\n}\n\n/**\n * When loading a draft we omit the present autostorage (content is replaced anyway) and make\n * the loaded path the autosave path, so all further automatic storage goes into the present\n * draft file\n */\n\nvoid ComposeWidget::loadDraft(const QString &path)\n{\n    QFile file(path);\n    if (!file.open(QIODevice::ReadOnly))\n        return;\n\n    if (m_autoSavePath != path) {\n        QFile::remove(m_autoSavePath);\n        m_autoSavePath = path;\n    }\n\n    QDataStream stream(&file);\n    stream.setVersion(QDataStream::Qt_4_6);\n    QString string;\n    int version, recipientCount;\n    stream >> version;\n    stream >> m_explicitDraft;\n    stream >> string >> recipientCount; // sender / amount of recipients\n    int senderIndex = ui->sender->findText(string);\n    if (senderIndex != -1) {\n        ui->sender->setCurrentIndex(senderIndex);\n    } else {\n        ui->sender->setEditText(string);\n    }\n    for (int i = 0; i < recipientCount; ++i) {\n        int kind;\n        stream >> kind >> string;\n        if (!string.isEmpty())\n            addRecipient(i, static_cast<Composer::RecipientKind>(kind), string);\n    }\n    if (version >= 2) {\n        QDateTime timestamp;\n        stream >> timestamp >> m_inReplyTo >> m_references;\n        m_submission->composer()->setTimestamp(timestamp);\n        if (!m_inReplyTo.isEmpty()) {\n            m_markButton->show();\n\n            // We do not have the message index at this point, but we can at least show the Message-Id here\n            QStringList inReplyTo;\n            Q_FOREACH(auto item, m_inReplyTo) {\n                // There's no HTML escaping to worry about\n                inReplyTo << QLatin1Char('<') + QString::fromUtf8(item.constData()) + QLatin1Char('>');\n            }\n            m_actionInReplyTo->setToolTip(tr(\"This mail will be marked as a response<hr/>%1\").arg(\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n                                              inReplyTo.join(tr(\"<br/>\")).toHtmlEscaped()\n#else\n                                              Qt::escape(inReplyTo.join(tr(\"<br/>\")))\n#endif\n                                              ));\n            if (version == 2) {\n                // it is always marked as a reply in v2\n                m_actionInReplyTo->trigger();\n            }\n        }\n    }\n    if (version >= 3) {\n        bool replyChecked;\n        stream >> replyChecked;\n        // Got to use trigger() so that the default action of the QToolButton is updated\n        if (replyChecked) {\n            m_actionInReplyTo->trigger();\n        } else {\n            m_actionStandalone->trigger();\n        }\n    }\n    stream >> string;\n    ui->subject->setText(string);\n    stream >> string;\n    ui->mailText->setPlainText(string);\n    m_messageUpdated = false; // this is now the most up-to-date one\n    file.close();\n}\n\nvoid ComposeWidget::autoSaveDraft()\n{\n    if (m_messageUpdated) {\n        m_messageUpdated = false;\n        saveDraft(m_autoSavePath);\n    }\n}\n\nvoid ComposeWidget::setMessageUpdated()\n{\n    m_messageEverEdited = m_messageUpdated = true;\n}\n\nvoid ComposeWidget::updateWindowTitle()\n{\n    if (ui->subject->text().isEmpty()) {\n        setWindowTitle(tr(\"Compose Mail\"));\n    } else {\n        setWindowTitle(tr(\"%1 - Compose Mail\").arg(ui->subject->text()));\n    }\n}\n\nvoid ComposeWidget::toggleReplyMarking()\n{\n    (m_actionInReplyTo->isChecked() ? m_actionStandalone : m_actionInReplyTo)->trigger();\n}\n\nvoid ComposeWidget::updateReplyMarkingAction()\n{\n    auto action = m_markAsReply->checkedAction();\n    m_actionToggleMarking->setText(action->text());\n    m_actionToggleMarking->setIcon(action->icon());\n    m_actionToggleMarking->setToolTip(action->toolTip());\n}\n\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_actionToggleMarking->setToolTip",
          "args": [
            "ction->toolTip())"
          ],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ction->toolTip",
          "args": [],
          "line": 1168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionToggleMarking->setIcon",
          "args": [
            "ction->icon())"
          ],
          "line": 1167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ction->icon",
          "args": [],
          "line": 1167
        },
        "resolved": true,
        "details": {
          "function_name": "icon",
          "container": "TrojitaQNAMDeclarativeWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/QmlSupport/QNAMWebView/qdeclarativewebview.cpp",
          "lines": "685-688",
          "snippet": "QPixmap TrojitaQNAMDeclarativeWebView::icon() const\n{\n    return page()->mainFrame()->icon().pixmap(QSize(256, 256));\n}",
          "includes": [
            "#include \"qwebsettings.h\"",
            "#include \"qwebpage.h\"",
            "#include \"qwebframe.h\"",
            "#include \"qwebelement.h\"",
            "#include <QtGui/QPen>",
            "#include <QtGui/QMouseEvent>",
            "#include <QtGui/QKeyEvent>",
            "#include <QtGui/QGraphicsSceneMouseEvent>",
            "#include <QtGui/QApplication>",
            "#include <QtDeclarative/qdeclarative.h>",
            "#include <QtDeclarative/QDeclarativeEngine>",
            "#include <QtDeclarative/QDeclarativeContext>",
            "#include <QtCore/QFile>",
            "#include <QtCore/QEvent>",
            "#include <QtCore/QDebug>",
            "#include \"qdeclarativewebview_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"qwebsettings.h\"\n#include \"qwebpage.h\"\n#include \"qwebframe.h\"\n#include \"qwebelement.h\"\n#include <QtGui/QPen>\n#include <QtGui/QMouseEvent>\n#include <QtGui/QKeyEvent>\n#include <QtGui/QGraphicsSceneMouseEvent>\n#include <QtGui/QApplication>\n#include <QtDeclarative/qdeclarative.h>\n#include <QtDeclarative/QDeclarativeEngine>\n#include <QtDeclarative/QDeclarativeContext>\n#include <QtCore/QFile>\n#include <QtCore/QEvent>\n#include <QtCore/QDebug>\n#include \"qdeclarativewebview_p.h\"\n\nTrojitaQNAMDeclarativeWebView {\n  QPixmap TrojitaQNAMDeclarativeWebView::icon() const\n  {\n      return page()->mainFrame()->icon().pixmap(QSize(256, 256));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_actionToggleMarking->setText",
          "args": [
            "ction->text())"
          ],
          "line": 1166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ction->text",
          "args": [],
          "line": 1166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markAsReply->checkedAction",
          "args": [],
          "line": 1165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_actionInReplyTo->isChecked",
          "args": [],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->isChecked",
          "args": [],
          "line": 1160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etWindowTitle(",
          "args": [
            "r(\"%1 - Compose Mail\").arg(ui->subject->text()))"
          ],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "i->subject->text())"
          ],
          "line": 1154
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->subject->text",
          "args": [],
          "line": 1154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etWindowTitle(",
          "args": [
            "r(\"Compose Mail\"))"
          ],
          "line": 1152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->text",
          "args": [],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->text",
          "args": [],
          "line": 1151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aveDraft(",
          "args": [
            "_autoSavePath)"
          ],
          "line": 1140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.close",
          "args": [],
          "line": 1133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->mailText->setPlainText",
          "args": [
            "tring)"
          ],
          "line": 1131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->setText",
          "args": [
            "tring)"
          ],
          "line": 1129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionStandalone->trigger",
          "args": [],
          "line": 1125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->trigger",
          "args": [],
          "line": 1123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->trigger",
          "args": [],
          "line": 1114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->setToolTip",
          "args": [
            "r(\"This mail will be marked as a response<hr/>%1\").arg(\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n                                              inReplyTo.join(tr(\"<br/>\")).toHtmlEscaped()\n#else\n                                              Qt::escape(inReplyTo.join(tr(\"<br/>\")))\n#endif\n                                              ))"
          ],
          "line": 1105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "t::escape(",
          "args": [
            "nReplyTo.join(tr(\"<br/>\")))"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nReplyTo.join",
          "args": [
            "r(\"<br/>\"))"
          ],
          "line": 1109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK",
          "args": [],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK",
          "args": [
            "r(\"<br/>\"))"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 1106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            ">')"
          ],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::fromUtf8(",
          "args": [
            "tem.constData())"
          ],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tem.constData",
          "args": [],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "<')"
          ],
          "line": 1103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markButton->show",
          "args": [],
          "line": 1097
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_inReplyTo.isEmpty",
          "args": [],
          "line": 1096
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "imestamp)"
          ],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 1095
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ddRecipient(",
          "args": [
            ",",
            "tatic_cast<Composer::RecipientKind>(kind),",
            "tring)"
          ],
          "line": 1090
        },
        "resolved": true,
        "details": {
          "function_name": "addRecipient(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "554-590",
          "snippet": "oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n{\n    QComboBox *combo = new QComboBox(this);\n    combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n    combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n    combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n    combo->setCurrentIndex(combo->findData(kind));\n    LineEdit *edit = new LineEdit(address, this);\n    slotCheckAddress(edit);\n    connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n    connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n    connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n    connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n    m_recipients.insert(position, Recipient(combo, edit));\n    ui->envelopeWidget->setUpdatesEnabled(false);\n    ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n    setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n    setTabOrder(combo, edit);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (ui->recipientSlider->isVisible()) {\n        const int v = ui->recipientSlider->value();\n        int keepInSight = ++position;\n        for (int i = 0; i < m_recipients.count(); ++i) {\n            if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                keepInSight = i;\n                break;\n            }\n        }\n        if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n            ui->recipientSlider->setValue(position*max/m_recipients.count());\n        if (v == ui->recipientSlider->value()) // force scroll update\n            scrollRecipients(v);\n    }\n    ui->envelopeWidget->setUpdatesEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n  {\n      QComboBox *combo = new QComboBox(this);\n      combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n      combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n      combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n      combo->setCurrentIndex(combo->findData(kind));\n      LineEdit *edit = new LineEdit(address, this);\n      slotCheckAddress(edit);\n      connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n      connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n      connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n      connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n      m_recipients.insert(position, Recipient(combo, edit));\n      ui->envelopeWidget->setUpdatesEnabled(false);\n      ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n      setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n      setTabOrder(combo, edit);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (ui->recipientSlider->isVisible()) {\n          const int v = ui->recipientSlider->value();\n          int keepInSight = ++position;\n          for (int i = 0; i < m_recipients.count(); ++i) {\n              if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                  keepInSight = i;\n                  break;\n              }\n          }\n          if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n              ui->recipientSlider->setValue(position*max/m_recipients.count());\n          if (v == ui->recipientSlider->value()) // force scroll update\n              scrollRecipients(v);\n      }\n      ui->envelopeWidget->setUpdatesEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tatic_cast<Composer::RecipientKind>",
          "args": [
            "ind)"
          ],
          "line": 1090
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tring.isEmpty",
          "args": [],
          "line": 1089
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->setEditText",
          "args": [
            "tring)"
          ],
          "line": 1084
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->setCurrentIndex",
          "args": [
            "enderIndex)"
          ],
          "line": 1082
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->findText",
          "args": [
            "tring)"
          ],
          "line": 1080
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tream.setVersion",
          "args": [
            "DataStream::Qt_4_6)"
          ],
          "line": 1074
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "File::remove(",
          "args": [
            "_autoSavePath)"
          ],
          "line": 1069
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.open",
          "args": [
            "IODevice::ReadOnly)"
          ],
          "line": 1065
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.setPermissions",
          "args": [
            "File::ReadOwner|QFile::WriteOwner)"
          ],
          "line": 1053
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.close",
          "args": [],
          "line": 1052
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->mailText->toPlainText",
          "args": [],
          "line": 1046
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->text",
          "args": [],
          "line": 1045
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->isChecked",
          "args": [],
          "line": 1044
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 1043
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "_recipients.at(i).first->currentIndex())"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 1040
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.count",
          "args": [],
          "line": 1039
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->sender->currentText",
          "args": [],
          "line": 1037
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tream.setVersion",
          "args": [
            "DataStream::Qt_4_6)"
          ],
          "line": 1036
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ile.open",
          "args": [
            "IODevice::WriteOnly)"
          ],
          "line": 1033
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->mailText->setFocus",
          "args": [],
          "line": 1014
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdateRecipientList(",
          "args": [],
          "line": 1013
        },
        "resolved": true,
        "details": {
          "function_name": "updateRecipientList(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "651-670",
          "snippet": "oid ComposeWidget::updateRecipientList()\n{\n    // we ensure there's always one empty available\n    bool haveEmpty = false;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        if (m_recipients.at(i).second->text().isEmpty()) {\n            if (haveEmpty) {\n                removeRecipient(i);\n            }\n            haveEmpty = true;\n        }\n    }\n    if (!haveEmpty) {\n        addRecipient(m_recipients.count(),\n                     m_recipients.isEmpty() ?\n                         Composer::ADDRESS_TO :\n                         recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                     QString());\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::updateRecipientList()\n  {\n      // we ensure there's always one empty available\n      bool haveEmpty = false;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          if (m_recipients.at(i).second->text().isEmpty()) {\n              if (haveEmpty) {\n                  removeRecipient(i);\n              }\n              haveEmpty = true;\n          }\n      }\n      if (!haveEmpty) {\n          addRecipient(m_recipients.count(),\n                       m_recipients.isEmpty() ?\n                           Composer::ADDRESS_TO :\n                           recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                       QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecipient.second.asPrettyString",
          "args": [],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.size",
          "args": [],
          "line": 1010
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecipient.second.name.clear",
          "args": [],
          "line": 1009
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecipient.second.hasUsefulDisplayName",
          "args": [],
          "line": 1008
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "emoveRecipient(",
          "args": [
            ")"
          ],
          "line": 1005
        },
        "resolved": true,
        "details": {
          "function_name": "removeRecipient(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "611-644",
          "snippet": "oid ComposeWidget::removeRecipient(int pos)\n{\n    // removing the widgets from the layout is important\n    // a) not doing so leaks (minor)\n    // b) deleteLater() crosses the evenchain and so our actualRow function would be tricked\n    QWidget *formerFocus = QApplication::focusWidget();\n    if (!formerFocus)\n        formerFocus = m_lastFocusedRecipient;\n\n    if (pos + 1 < m_recipients.count()) {\n        if (m_recipients.at(pos).first == formerFocus) {\n            m_recipients.at(pos + 1).first->setFocus();\n            formerFocus = m_recipients.at(pos + 1).first;\n        } else if (m_recipients.at(pos).second == formerFocus) {\n            m_recipients.at(pos + 1).second->setFocus();\n            formerFocus = m_recipients.at(pos + 1).second;\n        }\n    } else if (m_recipients.at(pos).first == formerFocus || m_recipients.at(pos).second == formerFocus) {\n            formerFocus = 0;\n    }\n\n    ui->envelopeLayout->removeWidget(m_recipients.at(pos).first);\n    ui->envelopeLayout->removeWidget(m_recipients.at(pos).second);\n    m_recipients.at(pos).first->deleteLater();\n    m_recipients.at(pos).second->deleteLater();\n    m_recipients.removeAt(pos);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (formerFocus) {\n        // skip event loop, remove might be triggered by imminent focus loss\n        CALL_LATER_NOARG(formerFocus, setFocus);\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::removeRecipient(int pos)\n  {\n      // removing the widgets from the layout is important\n      // a) not doing so leaks (minor)\n      // b) deleteLater() crosses the evenchain and so our actualRow function would be tricked\n      QWidget *formerFocus = QApplication::focusWidget();\n      if (!formerFocus)\n          formerFocus = m_lastFocusedRecipient;\n  \n      if (pos + 1 < m_recipients.count()) {\n          if (m_recipients.at(pos).first == formerFocus) {\n              m_recipients.at(pos + 1).first->setFocus();\n              formerFocus = m_recipients.at(pos + 1).first;\n          } else if (m_recipients.at(pos).second == formerFocus) {\n              m_recipients.at(pos + 1).second->setFocus();\n              formerFocus = m_recipients.at(pos + 1).second;\n          }\n      } else if (m_recipients.at(pos).first == formerFocus || m_recipients.at(pos).second == formerFocus) {\n              formerFocus = 0;\n      }\n  \n      ui->envelopeLayout->removeWidget(m_recipients.at(pos).first);\n      ui->envelopeLayout->removeWidget(m_recipients.at(pos).second);\n      m_recipients.at(pos).first->deleteLater();\n      m_recipients.at(pos).second->deleteLater();\n      m_recipients.removeAt(pos);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (formerFocus) {\n          // skip event loop, remove might be triggered by imminent focus loss\n          CALL_LATER_NOARG(formerFocus, setFocus);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_recipients.isEmpty",
          "args": [],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omposer::Util::replyRecipientList(",
          "args": [
            "ode,",
            "_mainWindow->senderIdentitiesModel(),",
            "_replyingToMessage,",
            "ist)"
          ],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mainWindow->senderIdentitiesModel",
          "args": [],
          "line": 999
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_replyingToMessage.isValid",
          "args": [],
          "line": 994
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "omposer::Util::replaceSignature(",
          "args": [
            "i->mailText->document(),",
            "ewSignature)"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->mailText->document",
          "args": [],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->mapToSource",
          "args": [],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->mapToSource",
          "args": [],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->mapToSource",
          "args": [
            "roxyIndex.row(),",
            "omposer::SenderIdentitiesModel::COLUMN_SIGNATURE)"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.row",
          "args": [],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->mapToSource",
          "args": [
            "roxyIndex)"
          ],
          "line": 979
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->model",
          "args": [
            "i->sender->currentIndex(),",
            ",",
            "i->sender->rootModelIndex())"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->rootModelIndex",
          "args": [],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->currentIndex",
          "args": [],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->model",
          "args": [],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "roxy)"
          ],
          "line": 971
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object_cast<QAbstractProxyModel*>",
          "args": [
            "i->sender->model())"
          ],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->model",
          "args": [],
          "line": 970
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "rl.path())"
          ],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.path",
          "args": [],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "file\")"
          ],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.scheme",
          "args": [],
          "line": 961
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rl.isLocalFile",
          "args": [],
          "line": 959
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 958
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\noreach (const QUrl &url, urls) {\n\n#if QT_VERSION >= QT_VERSION_CHECK(4, 8, 0)\n        if (url.isLocalFile()) {\n#else\n        if (url.scheme() == QLatin1String(\"file\")) {\n#endif\n            m_submission->composer()->addFileAttachment(url.path());\n        }\n    }\n}\n\nvoid ComposeWidget::slotUpdateSignature()\n{\n    QAbstractProxyModel *proxy = qobject_cast<QAbstractProxyModel*>(ui->sender->model());\n    Q_ASSERT(proxy);\n    QModelIndex proxyIndex = ui->sender->model()->index(ui->sender->currentIndex(), 0, ui->sender->rootModelIndex());\n\n    if (!proxyIndex.isValid()) {\n        // This happens when the settings dialog gets closed and the SenderIdentitiesModel reloads data from the on-disk cache\n        return;\n    }\n\n    QString newSignature = proxy->mapToSource(proxyIndex).sibling(proxyIndex.row(),\n                                                                  Composer::SenderIdentitiesModel::COLUMN_SIGNATURE)\n            .data().toString();\n\n    const bool wasEdited = m_messageEverEdited;\n    Composer::Util::replaceSignature(ui->mailText->document(), newSignature);\n    m_messageEverEdited = wasEdited;\n}\n\n/** @short Massage the list of recipients so that they match the desired type of reply\n\nIn case of an error, the original list of recipients is left as is.\n*/\nbool ComposeWidget::setReplyMode(const Composer::ReplyMode mode)\n{\n    if (!m_replyingToMessage.isValid())\n        return false;\n\n    // Determine the new list of recipients\n    Composer::RecipientList list;\n    if (!Composer::Util::replyRecipientList(mode, m_mainWindow->senderIdentitiesModel(),\n                                            m_replyingToMessage, list)) {\n        return false;\n    }\n\n    while (!m_recipients.isEmpty())\n        removeRecipient(0);\n\n    Q_FOREACH(Composer::RecipientList::value_type recipient, list) {\n        if (!recipient.second.hasUsefulDisplayName())\n            recipient.second.name.clear();\n        addRecipient(m_recipients.size(), recipient.first, recipient.second.asPrettyString());\n    }\n\n    updateRecipientList();\n    ui->mailText->setFocus();\n\n    return true;\n}\n\n/** local draft serializaton:\n * Version (int)\n * Whether this draft was stored explicitly (bool)\n * The sender (QString)\n * Amount of recipients (int)\n * n * (RecipientKind (\"int\") + recipient (QString))\n * Subject (QString)\n * The message text (QString)\n */\n\nvoid ComposeWidget::saveDraft(const QString &path)\n{\n    static const int trojitaDraftVersion = 3;\n    QFile file(path);\n    if (!file.open(QIODevice::WriteOnly))\n        return; // TODO: error message?\n    QDataStream stream(&file);\n    stream.setVersion(QDataStream::Qt_4_6);\n    stream << trojitaDraftVersion << m_explicitDraft << ui->sender->currentText();\n    stream << m_recipients.count();\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        stream << m_recipients.at(i).first->itemData(m_recipients.at(i).first->currentIndex()).toInt();\n        stream << m_recipients.at(i).second->text();\n    }\n    stream << m_submission->composer()->timestamp() << m_inReplyTo << m_references;\n    stream << m_actionInReplyTo->isChecked();\n    stream << ui->subject->text();\n    stream << ui->mailText->toPlainText();\n    // we spare attachments\n    // a) serializing isn't an option, they could be HUUUGE\n    // b) storing urls only works for urls\n    // c) the data behind the url or the url validity might have changed\n    // d) nasty part is writing mails - DnD a file into it is not a problem\n    file.close();\n    file.setPermissions(QFile::ReadOwner|QFile::WriteOwner);\n}\n\n/**\n * When loading a draft we omit the present autostorage (content is replaced anyway) and make\n * the loaded path the autosave path, so all further automatic storage goes into the present\n * draft file\n */\n\nvoid ComposeWidget::loadDraft(const QString &path)\n{\n    QFile file(path);\n    if (!file.open(QIODevice::ReadOnly))\n        return;\n\n    if (m_autoSavePath != path) {\n        QFile::remove(m_autoSavePath);\n        m_autoSavePath = path;\n    }\n\n    QDataStream stream(&file);\n    stream.setVersion(QDataStream::Qt_4_6);\n    QString string;\n    int version, recipientCount;\n    stream >> version;\n    stream >> m_explicitDraft;\n    stream >> string >> recipientCount; // sender / amount of recipients\n    int senderIndex = ui->sender->findText(string);\n    if (senderIndex != -1) {\n        ui->sender->setCurrentIndex(senderIndex);\n    } else {\n        ui->sender->setEditText(string);\n    }\n    for (int i = 0; i < recipientCount; ++i) {\n        int kind;\n        stream >> kind >> string;\n        if (!string.isEmpty())\n            addRecipient(i, static_cast<Composer::RecipientKind>(kind), string);\n    }\n    if (version >= 2) {\n        QDateTime timestamp;\n        stream >> timestamp >> m_inReplyTo >> m_references;\n        m_submission->composer()->setTimestamp(timestamp);\n        if (!m_inReplyTo.isEmpty()) {\n            m_markButton->show();\n\n            // We do not have the message index at this point, but we can at least show the Message-Id here\n            QStringList inReplyTo;\n            Q_FOREACH(auto item, m_inReplyTo) {\n                // There's no HTML escaping to worry about\n                inReplyTo << QLatin1Char('<') + QString::fromUtf8(item.constData()) + QLatin1Char('>');\n            }\n            m_actionInReplyTo->setToolTip(tr(\"This mail will be marked as a response<hr/>%1\").arg(\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n                                              inReplyTo.join(tr(\"<br/>\")).toHtmlEscaped()\n#else\n                                              Qt::escape(inReplyTo.join(tr(\"<br/>\")))\n#endif\n                                              ));\n            if (version == 2) {\n                // it is always marked as a reply in v2\n                m_actionInReplyTo->trigger();\n            }\n        }\n    }\n    if (version >= 3) {\n        bool replyChecked;\n        stream >> replyChecked;\n        // Got to use trigger() so that the default action of the QToolButton is updated\n        if (replyChecked) {\n            m_actionInReplyTo->trigger();\n        } else {\n            m_actionStandalone->trigger();\n        }\n    }\n    stream >> string;\n    ui->subject->setText(string);\n    stream >> string;\n    ui->mailText->setPlainText(string);\n    m_messageUpdated = false; // this is now the most up-to-date one\n    file.close();\n}\n\nvoid ComposeWidget::autoSaveDraft()\n{\n    if (m_messageUpdated) {\n        m_messageUpdated = false;\n        saveDraft(m_autoSavePath);\n    }\n}\n\nvoid ComposeWidget::setMessageUpdated()\n{\n    m_messageEverEdited = m_messageUpdated = true;\n}\n\nvoid ComposeWidget::updateWindowTitle()\n{\n    if (ui->subject->text().isEmpty()) {\n        setWindowTitle(tr(\"Compose Mail\"));\n    } else {\n        setWindowTitle(tr(\"%1 - Compose Mail\").arg(ui->subject->text()));\n    }\n}\n\nvoid ComposeWidget::toggleReplyMarking()\n{\n    (m_actionInReplyTo->isChecked() ? m_actionStandalone : m_actionInReplyTo)->trigger();\n}\n\nvoid ComposeWidget::updateReplyMarkingAction()\n{\n    auto action = m_markAsReply->checkedAction();\n    m_actionToggleMarking->setText(action->text());\n    m_actionToggleMarking->setIcon(action->icon());\n    m_actionToggleMarking->setToolTip(action->toolTip());\n}\n\n}"
  },
  {
    "function_name": "slotAskForFileAttachment(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "945-952",
    "snippet": "oid ComposeWidget::slotAskForFileAttachment()\n{\n    QString fileName = QFileDialog::getOpenFileName(this, tr(\"Attach File...\"), QString(), QString(), 0,\n                                                    QFileDialog::DontResolveSymlinks);\n    if (!fileName.isEmpty()) {\n        m_submission->composer()->addFileAttachment(fileName);\n    }\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "ileName)"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ileName.isEmpty",
          "args": [],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FileDialog::getOpenFileName(",
          "args": [
            "his,",
            "r(\"Attach File...\"),",
            "String(),",
            "String(),",
            ",",
            "FileDialog::DontResolveSymlinks)"
          ],
          "line": 947
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 947
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Attach File...\")"
          ],
          "line": 947
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::slotAskForFileAttachment()\n  {\n      QString fileName = QFileDialog::getOpenFileName(this, tr(\"Attach File...\"), QString(), QString(), 0,\n                                                      QFileDialog::DontResolveSymlinks);\n      if (!fileName.isEmpty()) {\n          m_submission->composer()->addFileAttachment(fileName);\n      }\n  }\n}"
  },
  {
    "function_name": "eventFilter(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "892-942",
    "snippet": "ool ComposeWidget::eventFilter(QObject *o, QEvent *e)\n{\n    if (o == m_completionPopup) {\n        if (e->type() == QEvent::KeyPress || e->type() == QEvent::KeyRelease) {\n            QKeyEvent *ke = static_cast<QKeyEvent*>(e);\n            if (!(  ke->key() == Qt::Key_Up || ke->key() == Qt::Key_Down || // Navigation\n                    ke->key() == Qt::Key_Escape || // \"escape\"\n                    ke->key() == Qt::Key_Return || ke->key() == Qt::Key_Enter)) { // selection\n                QCoreApplication::sendEvent(m_completionReceiver, e);\n                return true;\n            }\n        }\n        return false;\n    }\n\n    if (o == ui->envelopeWidget)  {\n        if (e->type() == QEvent::Wheel) {\n            int v = ui->recipientSlider->value();\n            if (static_cast<QWheelEvent*>(e)->delta() > 0)\n                --v;\n            else\n                ++v;\n            // just QApplication::sendEvent(ui->recipientSlider, e) will cause a recursion if\n            // ui->recipientSlider ignores the event (eg. because it would lead to an invalid value)\n            // since ui->recipientSlider is child of ui->envelopeWidget\n            // my guts tell me to not send events to children if it can be avoided, but its just a gut feeling\n            ui->recipientSlider->setValue(v);\n            e->accept();\n            return true;\n        }\n        if (e->type() == QEvent::KeyPress && ui->envelopeWidget->hasFocus()) {\n            scrollToFocus();\n            QWidget *focus = QApplication::focusWidget();\n            if (focus && focus != ui->envelopeWidget) {\n                int key = static_cast<QKeyEvent*>(e)->key();\n                if (!(key == Qt::Key_Tab || key == Qt::Key_Backtab)) // those alter the focus again\n                    QApplication::sendEvent(focus, e);\n            }\n            return true;\n        }\n        if (e->type() == QEvent::Resize) {\n            QResizeEvent *re = static_cast<QResizeEvent*>(e);\n            if (re->size().height() != re->oldSize().height())\n                calculateMaxVisibleRecipients();\n            return false;\n        }\n        return false;\n    }\n\n    return false;\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "alculateMaxVisibleRecipients(",
          "args": [],
          "line": 935
        },
        "resolved": true,
        "details": {
          "function_name": "calculateMaxVisibleRecipients(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "511-552",
          "snippet": "oid ComposeWidget::calculateMaxVisibleRecipients()\n{\n    const int oldMaxVisibleRecipients = m_maxVisibleRecipients;\n    int spacing, bottom;\n    ui->envelopeLayout->getContentsMargins(&spacing, &spacing, &spacing, &bottom);\n    // we abuse the fact that there's always an addressee and that they all look the same\n    QRect itemRects[2];\n    for (int i = 0; i < 2; ++i) {\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::LabelRole)) {\n            itemRects[i] |= li->geometry();\n        }\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::FieldRole)) {\n            itemRects[i] |= li->geometry();\n        }\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::SpanningRole)) {\n            itemRects[i] |= li->geometry();\n        }\n    }\n    int itemHeight = itemRects[0].height();\n    spacing = qMax(0, itemRects[0].top() - itemRects[1].bottom() - 1); // QFormLayout::[vertical]spacing() is useless ...\n    int firstTop = itemRects[0].top();\n    const int subjectHeight = ui->subject->height();\n    const int height = ui->verticalSplitter->sizes().at(0) - // entire splitter area\n                       firstTop - // offset of first recipient\n                       (subjectHeight + spacing) - // for the subject\n                       bottom - // layout bottom padding\n                       2; // extra pixels padding to detect that the user wants to shrink\n    if (itemHeight + spacing == 0) {\n        m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS;\n    } else {\n        m_maxVisibleRecipients = height / (itemHeight + spacing);\n    }\n    if (m_maxVisibleRecipients < MIN_MAX_VISIBLE_RECIPIENTS)\n        m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS; // allow up to 4 recipients w/o need for a sliding\n    if (oldMaxVisibleRecipients != m_maxVisibleRecipients) {\n        const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n        int v = qRound(1.0f*(ui->recipientSlider->value()*m_maxVisibleRecipients)/oldMaxVisibleRecipients);\n        ui->recipientSlider->setMaximum(max);\n        ui->recipientSlider->setVisible(max > 0);\n        scrollRecipients(qMin(qMax(0, v), max));\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::calculateMaxVisibleRecipients()\n  {\n      const int oldMaxVisibleRecipients = m_maxVisibleRecipients;\n      int spacing, bottom;\n      ui->envelopeLayout->getContentsMargins(&spacing, &spacing, &spacing, &bottom);\n      // we abuse the fact that there's always an addressee and that they all look the same\n      QRect itemRects[2];\n      for (int i = 0; i < 2; ++i) {\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::LabelRole)) {\n              itemRects[i] |= li->geometry();\n          }\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::FieldRole)) {\n              itemRects[i] |= li->geometry();\n          }\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::SpanningRole)) {\n              itemRects[i] |= li->geometry();\n          }\n      }\n      int itemHeight = itemRects[0].height();\n      spacing = qMax(0, itemRects[0].top() - itemRects[1].bottom() - 1); // QFormLayout::[vertical]spacing() is useless ...\n      int firstTop = itemRects[0].top();\n      const int subjectHeight = ui->subject->height();\n      const int height = ui->verticalSplitter->sizes().at(0) - // entire splitter area\n                         firstTop - // offset of first recipient\n                         (subjectHeight + spacing) - // for the subject\n                         bottom - // layout bottom padding\n                         2; // extra pixels padding to detect that the user wants to shrink\n      if (itemHeight + spacing == 0) {\n          m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS;\n      } else {\n          m_maxVisibleRecipients = height / (itemHeight + spacing);\n      }\n      if (m_maxVisibleRecipients < MIN_MAX_VISIBLE_RECIPIENTS)\n          m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS; // allow up to 4 recipients w/o need for a sliding\n      if (oldMaxVisibleRecipients != m_maxVisibleRecipients) {\n          const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n          int v = qRound(1.0f*(ui->recipientSlider->value()*m_maxVisibleRecipients)/oldMaxVisibleRecipients);\n          ui->recipientSlider->setMaximum(max);\n          ui->recipientSlider->setVisible(max > 0);\n          scrollRecipients(qMin(qMax(0, v), max));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "e->oldSize",
          "args": [],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->oldSize",
          "args": [],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->size",
          "args": [],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->size",
          "args": [],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QResizeEvent*>",
          "args": [
            ")"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->type",
          "args": [],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "type(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "73-76",
          "snippet": "pinner::Type Spinner::type() const\n{\n    return m_type;\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Type Spinner::type() const\n  {\n      return m_type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Application::sendEvent(",
          "args": [
            "ocus,",
            ")"
          ],
          "line": 928
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QKeyEvent*>",
          "args": [],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QKeyEvent*>",
          "args": [
            ")"
          ],
          "line": 926
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::focusWidget(",
          "args": [],
          "line": 924
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crollToFocus(",
          "args": [],
          "line": 923
        },
        "resolved": true,
        "details": {
          "function_name": "scrollToFocus(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "681-708",
          "snippet": "oid ComposeWidget::scrollToFocus()\n{\n    if (!ui->recipientSlider->isVisible())\n        return;\n\n    QWidget *focus = QApplication::focusWidget();\n    if (focus == ui->envelopeWidget)\n        focus = m_lastFocusedRecipient;\n    if (!focus)\n        return;\n\n    // if this is the first or last visible recipient, show one more (to hint there's more and allow tab progression)\n    for (int i = 0, pos = 0; i < m_recipients.count(); ++i) {\n        if (m_recipients.at(i).first->isVisible())\n            ++pos;\n        if (focus == m_recipients.at(i).first || focus == m_recipients.at(i).second) {\n            if (pos > 1 && pos < m_maxVisibleRecipients) // prev & next are in sight\n                break;\n            if (pos == 1)\n                ui->recipientSlider->setValue(i - 1); // scroll to prev\n            else\n                ui->recipientSlider->setValue(i + 2 - m_maxVisibleRecipients);  // scroll to next\n            break;\n        }\n    }\n    if (focus == m_lastFocusedRecipient)\n        focus->setFocus(); // in case we scrolled to m_lastFocusedRecipient\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::scrollToFocus()\n  {\n      if (!ui->recipientSlider->isVisible())\n          return;\n  \n      QWidget *focus = QApplication::focusWidget();\n      if (focus == ui->envelopeWidget)\n          focus = m_lastFocusedRecipient;\n      if (!focus)\n          return;\n  \n      // if this is the first or last visible recipient, show one more (to hint there's more and allow tab progression)\n      for (int i = 0, pos = 0; i < m_recipients.count(); ++i) {\n          if (m_recipients.at(i).first->isVisible())\n              ++pos;\n          if (focus == m_recipients.at(i).first || focus == m_recipients.at(i).second) {\n              if (pos > 1 && pos < m_maxVisibleRecipients) // prev & next are in sight\n                  break;\n              if (pos == 1)\n                  ui->recipientSlider->setValue(i - 1); // scroll to prev\n              else\n                  ui->recipientSlider->setValue(i + 2 - m_maxVisibleRecipients);  // scroll to next\n              break;\n          }\n      }\n      if (focus == m_lastFocusedRecipient)\n          focus->setFocus(); // in case we scrolled to m_lastFocusedRecipient\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->envelopeWidget->hasFocus",
          "args": [],
          "line": 922
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->accept",
          "args": [],
          "line": 919
        },
        "resolved": true,
        "details": {
          "function_name": "accept(",
          "container": "ettingsDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/SettingsDialog.cpp",
          "lines": "94-119",
          "snippet": "oid SettingsDialog::accept()\n{\n    Q_FOREACH(ConfigurationWidgetInterface *page, pages) {\n        if (!page->checkValidity()) {\n            stack->setCurrentWidget(page->asWidget());\n            return;\n        }\n    }\n\n#ifndef Q_OS_WIN\n    // Try to wour around QSettings' inability to set umask for its file access. We don't want to set umask globally.\n    QFile settingsFile(m_settings->fileName());\n    settingsFile.setPermissions(QFile::ReadUser | QFile::WriteUser);\n#endif\n    Q_FOREACH(ConfigurationWidgetInterface *page, pages) {\n        page->save(*m_settings);\n    }\n#ifdef XTUPLE_CONNECT\n    xtConnect->save(*m_settings);\n#endif\n    m_settings->sync();\n#ifndef Q_OS_WIN\n    settingsFile.setPermissions(QFile::ReadUser | QFile::WriteUser);\n#endif\n    QDialog::accept();\n}",
          "includes": [
            "include \"Gui/Util.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include <QDataWidgetMapper>\n#",
            "include <QMessageBox>\n#",
            "include <QToolTip>\n#",
            "include <QStandardItemModel>\n#",
            "include <QDebug>\n#",
            "include <QResizeEvent>\n#",
            "include <QPushButton>\n#",
            "include <QProcess>\n#",
            "include <QVBoxLayout>\n#",
            "include <QTabWidget>\n#",
            "include <QSpinBox>\n#",
            "include <QRadioButton>\n#",
            "include <QListWidget>\n#",
            "include <QLineEdit>\n#",
            "include <QInputDialog>\n#",
            "include <QGroupBox>\n#",
            "include <QFormLayout>\n#",
            "include <QDir>\n#",
            "include <QDialogButtonBox>\n#",
            "include <QComboBox>\n#",
            "include <QCheckBox>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Gui/Util.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude <QDataWidgetMapper>\n#\ninclude <QMessageBox>\n#\ninclude <QToolTip>\n#\ninclude <QStandardItemModel>\n#\ninclude <QDebug>\n#\ninclude <QResizeEvent>\n#\ninclude <QPushButton>\n#\ninclude <QProcess>\n#\ninclude <QVBoxLayout>\n#\ninclude <QTabWidget>\n#\ninclude <QSpinBox>\n#\ninclude <QRadioButton>\n#\ninclude <QListWidget>\n#\ninclude <QLineEdit>\n#\ninclude <QInputDialog>\n#\ninclude <QGroupBox>\n#\ninclude <QFormLayout>\n#\ninclude <QDir>\n#\ninclude <QDialogButtonBox>\n#\ninclude <QComboBox>\n#\ninclude <QCheckBox>\n#\n\nettingsDialog {\n  oid SettingsDialog::accept()\n  {\n      Q_FOREACH(ConfigurationWidgetInterface *page, pages) {\n          if (!page->checkValidity()) {\n              stack->setCurrentWidget(page->asWidget());\n              return;\n          }\n      }\n  \n  #ifndef Q_OS_WIN\n      // Try to wour around QSettings' inability to set umask for its file access. We don't want to set umask globally.\n      QFile settingsFile(m_settings->fileName());\n      settingsFile.setPermissions(QFile::ReadUser | QFile::WriteUser);\n  #endif\n      Q_FOREACH(ConfigurationWidgetInterface *page, pages) {\n          page->save(*m_settings);\n      }\n  #ifdef XTUPLE_CONNECT\n      xtConnect->save(*m_settings);\n  #endif\n      m_settings->sync();\n  #ifndef Q_OS_WIN\n      settingsFile.setPermissions(QFile::ReadUser | QFile::WriteUser);\n  #endif\n      QDialog::accept();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setValue",
          "args": [
            ")"
          ],
          "line": 918
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QWheelEvent*>",
          "args": [],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QWheelEvent*>",
          "args": [
            ")"
          ],
          "line": 910
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->value",
          "args": [],
          "line": 909
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "333-336",
          "snippet": "QByteArray QMimeMagicRule::value() const\n{\n    return d->value;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QByteArray QMimeMagicRule::value() const\n  {\n      return d->value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CoreApplication::sendEvent(",
          "args": [
            "_completionReceiver,",
            ")"
          ],
          "line": 900
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 899
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 898
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->key",
          "args": [],
          "line": 897
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QKeyEvent*>",
          "args": [
            ")"
          ],
          "line": 896
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  ool ComposeWidget::eventFilter(QObject *o, QEvent *e)\n  {\n      if (o == m_completionPopup) {\n          if (e->type() == QEvent::KeyPress || e->type() == QEvent::KeyRelease) {\n              QKeyEvent *ke = static_cast<QKeyEvent*>(e);\n              if (!(  ke->key() == Qt::Key_Up || ke->key() == Qt::Key_Down || // Navigation\n                      ke->key() == Qt::Key_Escape || // \"escape\"\n                      ke->key() == Qt::Key_Return || ke->key() == Qt::Key_Enter)) { // selection\n                  QCoreApplication::sendEvent(m_completionReceiver, e);\n                  return true;\n              }\n          }\n          return false;\n      }\n  \n      if (o == ui->envelopeWidget)  {\n          if (e->type() == QEvent::Wheel) {\n              int v = ui->recipientSlider->value();\n              if (static_cast<QWheelEvent*>(e)->delta() > 0)\n                  --v;\n              else\n                  ++v;\n              // just QApplication::sendEvent(ui->recipientSlider, e) will cause a recursion if\n              // ui->recipientSlider ignores the event (eg. because it would lead to an invalid value)\n              // since ui->recipientSlider is child of ui->envelopeWidget\n              // my guts tell me to not send events to children if it can be avoided, but its just a gut feeling\n              ui->recipientSlider->setValue(v);\n              e->accept();\n              return true;\n          }\n          if (e->type() == QEvent::KeyPress && ui->envelopeWidget->hasFocus()) {\n              scrollToFocus();\n              QWidget *focus = QApplication::focusWidget();\n              if (focus && focus != ui->envelopeWidget) {\n                  int key = static_cast<QKeyEvent*>(e)->key();\n                  if (!(key == Qt::Key_Tab || key == Qt::Key_Backtab)) // those alter the focus again\n                      QApplication::sendEvent(focus, e);\n              }\n              return true;\n          }\n          if (e->type() == QEvent::Resize) {\n              QResizeEvent *re = static_cast<QResizeEvent*>(e);\n              if (re->size().height() != re->oldSize().height())\n                  calculateMaxVisibleRecipients();\n              return false;\n          }\n          return false;\n      }\n  \n      return false;\n  }\n}"
  },
  {
    "function_name": "completeRecipient(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "881-890",
    "snippet": "oid ComposeWidget::completeRecipient(QAction *act)\n{\n    if (act->text().isEmpty())\n        return;\n    m_completionReceiver->setText(act->text());\n    if (m_completionPopup) {\n        m_completionPopup->close();\n        m_completionReceiver = 0;\n    }\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_completionPopup->close",
          "args": [],
          "line": 887
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_completionReceiver->setText",
          "args": [
            "ct->text())"
          ],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ct->text",
          "args": [],
          "line": 885
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ct->text",
          "args": [],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ct->text",
          "args": [],
          "line": 883
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::completeRecipient(QAction *act)\n  {\n      if (act->text().isEmpty())\n          return;\n      m_completionReceiver->setText(act->text());\n      if (m_completionPopup) {\n          m_completionPopup->close();\n          m_completionReceiver = 0;\n      }\n  }\n}"
  },
  {
    "function_name": "completeRecipients(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "852-879",
    "snippet": "oid ComposeWidget::completeRecipients(const QString &text)\n{\n    if (text.isEmpty()) {\n        if (m_completionPopup) {\n            // if there's a popup close it and set back the receiver\n            m_completionPopup->close();\n            m_completionReceiver = 0;\n        }\n        return; // we do not suggest \"nothing\"\n    }\n    Q_ASSERT(sender());\n    QLineEdit *toEdit = static_cast<QLineEdit*>(sender());\n    QStringList contacts = m_mainWindow->addressBook()->complete(text, QStringList(), m_completionCount);\n    if (contacts.isEmpty() && m_completionPopup) {\n        m_completionPopup->close();\n        m_completionReceiver = 0;\n    }\n    else {\n        m_completionReceiver = toEdit;\n        m_completionPopup->setUpdatesEnabled(false);\n        m_completionPopup->clear();\n        Q_FOREACH(const QString &s, contacts)\n            m_completionPopup->addAction(s);\n        if (m_completionPopup->isHidden())\n            m_completionPopup->popup(toEdit->mapToGlobal(QPoint(0, toEdit->height())));\n        m_completionPopup->setUpdatesEnabled(true);\n    }\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_completionPopup->setUpdatesEnabled",
          "args": [
            "rue)"
          ],
          "line": 877
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_completionPopup->popup",
          "args": [
            "oEdit->mapToGlobal(QPoint(0, toEdit->height())))"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oEdit->mapToGlobal",
          "args": [
            "Point(0, toEdit->height()))"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Point(",
          "args": [
            ",",
            "oEdit->height())"
          ],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oEdit->height",
          "args": [],
          "line": 876
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_completionPopup->isHidden",
          "args": [],
          "line": 875
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_completionPopup->addAction",
          "args": [
            ")"
          ],
          "line": 874
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_completionPopup->clear",
          "args": [],
          "line": 872
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "QMimeTypePrivate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimetype.cpp",
          "lines": "70-78",
          "snippet": "void QMimeTypePrivate::clear()\n{\n    name.clear();\n    localeComments.clear();\n    genericIconName.clear();\n    iconName.clear();\n    globPatterns.clear();\n    loaded = false;\n}",
          "includes": [
            "#include <memory>",
            "#include <QLocale>",
            "#include <QDebug>",
            "#include \"qmimeglobpattern_p.h\"",
            "#include \"qmimeprovider_p.h\"",
            "#include \"qmimedatabase_p.h\"",
            "#include \"qmimetype_p.h\"",
            "#include \"qmimetype.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "QT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false)"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <QLocale>\n#include <QDebug>\n#include \"qmimeglobpattern_p.h\"\n#include \"qmimeprovider_p.h\"\n#include \"qmimedatabase_p.h\"\n#include \"qmimetype_p.h\"\n#include \"qmimetype.h\"\n\nQT_BEGIN_NAMESPACE\n\nQMimeTypePrivate::QMimeTypePrivate()\n    : loaded(false);\n\nQMimeTypePrivate {\n  void QMimeTypePrivate::clear()\n  {\n      name.clear();\n      localeComments.clear();\n      genericIconName.clear();\n      iconName.clear();\n      globPatterns.clear();\n      loaded = false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_completionPopup->setUpdatesEnabled",
          "args": [
            "alse)"
          ],
          "line": 871
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_completionPopup->close",
          "args": [],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ontacts.isEmpty",
          "args": [],
          "line": 865
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mainWindow->addressBook",
          "args": [
            "ext,",
            "StringList(),",
            "_completionCount)"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringList(",
          "args": [],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mainWindow->addressBook",
          "args": [],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<QLineEdit*>",
          "args": [
            "ender())"
          ],
          "line": 863
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ender(",
          "args": [],
          "line": 863
        },
        "resolved": true,
        "details": {
          "function_name": "sender(",
          "container": "neMessageModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/OneMessageModel.cpp",
          "lines": "134-137",
          "snippet": "VariantList OneMessageModel::sender() const\n{\n    return m_message.data(RoleMessageSender).toList();\n}",
          "includes": [
            "include \"SubtreeModel.h\"",
            "include \"Model.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"FindInterestingPart.h\"\n#",
            "include \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#",
            "include \"OneMessageModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SubtreeModel.h\"\ninclude \"Model.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"FindInterestingPart.h\"\n#\ninclude \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#\ninclude \"OneMessageModel.h\"\n#\n\nneMessageModel {\n  VariantList OneMessageModel::sender() const\n  {\n      return m_message.data(RoleMessageSender).toList();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ender())"
          ],
          "line": 862
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_completionPopup->close",
          "args": [],
          "line": 857
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ext.isEmpty",
          "args": [],
          "line": 854
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::completeRecipients(const QString &text)\n  {\n      if (text.isEmpty()) {\n          if (m_completionPopup) {\n              // if there's a popup close it and set back the receiver\n              m_completionPopup->close();\n              m_completionReceiver = 0;\n          }\n          return; // we do not suggest \"nothing\"\n      }\n      Q_ASSERT(sender());\n      QLineEdit *toEdit = static_cast<QLineEdit*>(sender());\n      QStringList contacts = m_mainWindow->addressBook()->complete(text, QStringList(), m_completionCount);\n      if (contacts.isEmpty() && m_completionPopup) {\n          m_completionPopup->close();\n          m_completionReceiver = 0;\n      }\n      else {\n          m_completionReceiver = toEdit;\n          m_completionPopup->setUpdatesEnabled(false);\n          m_completionPopup->clear();\n          Q_FOREACH(const QString &s, contacts)\n              m_completionPopup->addAction(s);\n          if (m_completionPopup->isHidden())\n              m_completionPopup->popup(toEdit->mapToGlobal(QPoint(0, toEdit->height())));\n          m_completionPopup->setUpdatesEnabled(true);\n      }\n  }\n}"
  },
  {
    "function_name": "parseRecipients(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "830-850",
    "snippet": "ool ComposeWidget::parseRecipients(QList<QPair<Composer::RecipientKind, Imap::Message::MailAddress> > &results, QString &errorMessage)\n{\n    for (int i = 0; i < m_recipients.size(); ++i) {\n        Composer::RecipientKind kind = currentRecipient(m_recipients.at(i).first);\n\n        QString text = m_recipients.at(i).second->text();\n        if (text.isEmpty())\n            continue;\n        Imap::Message::MailAddress addr;\n        bool ok = Imap::Message::MailAddress::fromPrettyString(addr, text);\n        if (ok) {\n            // TODO: should we *really* learn every junk entered into a recipient field?\n            // m_mainWindow->addressBook()->learn(addr);\n            results << qMakePair(kind, addr);\n        } else {\n            errorMessage = tr(\"Can't parse \\\"%1\\\" as an e-mail address.\").arg(text);\n            return false;\n        }\n    }\n    return true;\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "r",
          "args": [
            "ext)"
          ],
          "line": 845
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakePair(",
          "args": [
            "ind,",
            "ddr)"
          ],
          "line": 843
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::Message::MailAddress::fromPrettyString(",
          "args": [
            "ddr,",
            "ext)"
          ],
          "line": 839
        },
        "resolved": true,
        "details": {
          "function_name": "fromPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "41-52",
          "snippet": "ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n{\n    int offset = 0;\n\n    if (!parseOneAddress(into, address, offset))\n        return false;\n\n    if (offset < address.size())\n        return false;\n\n    return true;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n  {\n      int offset = 0;\n  \n      if (!parseOneAddress(into, address, offset))\n          return false;\n  \n      if (offset < address.size())\n          return false;\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ext.isEmpty",
          "args": [],
          "line": 836
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 835
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentRecipient(",
          "args": [
            "_recipients.at(i).first)"
          ],
          "line": 833
        },
        "resolved": true,
        "details": {
          "function_name": "urrentRecipient(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "646-649",
          "snippet": "tatic inline Composer::RecipientKind currentRecipient(const QComboBox *box)\n{\n    return Composer::RecipientKind(box->itemData(box->currentIndex()).toInt());\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\ntatic inline Composer::RecipientKind currentRecipient(const QComboBox *box)\n{\n    return Composer::RecipientKind(box->itemData(box->currentIndex()).toInt());\n}"
        }
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 833
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.size",
          "args": [],
          "line": 832
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  ool ComposeWidget::parseRecipients(QList<QPair<Composer::RecipientKind, Imap::Message::MailAddress> > &results, QString &errorMessage)\n  {\n      for (int i = 0; i < m_recipients.size(); ++i) {\n          Composer::RecipientKind kind = currentRecipient(m_recipients.at(i).first);\n  \n          QString text = m_recipients.at(i).second->text();\n          if (text.isEmpty())\n              continue;\n          Imap::Message::MailAddress addr;\n          bool ok = Imap::Message::MailAddress::fromPrettyString(addr, text);\n          if (ok) {\n              // TODO: should we *really* learn every junk entered into a recipient field?\n              // m_mainWindow->addressBook()->learn(addr);\n              results << qMakePair(kind, addr);\n          } else {\n              errorMessage = tr(\"Can't parse \\\"%1\\\" as an e-mail address.\").arg(text);\n              return false;\n          }\n      }\n      return true;\n  }\n}"
  },
  {
    "function_name": "sent(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "822-828",
    "snippet": "oid ComposeWidget::sent()\n{\n    // FIXME: move back to the currently selected mailbox\n\n    m_sentMail = true;\n    QTimer::singleShot(0, this, SLOT(close()));\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Timer::singleShot(",
          "args": [
            ",",
            "his,",
            "LOT(close()))"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lose())"
          ],
          "line": 827
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lose(",
          "args": [],
          "line": 827
        },
        "resolved": true,
        "details": {
          "function_name": "close(",
          "container": "arser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Parser.cpp",
          "lines": "301-304",
          "snippet": "ommandHandle Parser::close()\n{\n    return queueCommand(Commands::ATOM, \"CLOSE\");\n}",
          "includes": [
            "include \"../Model/Utils.h\"",
            "include \"../../Streams/IODeviceSocket.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Parser.h\"\n#",
            "include <QTimer>\n#",
            "include <QTime>\n#",
            "include <QSslError>\n#",
            "include <QProcess>\n#",
            "include <QMutexLocker>\n#",
            "include <QStringList>\n#",
            "include <QDebug>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Model/Utils.h\"\ninclude \"../../Streams/IODeviceSocket.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Parser.h\"\n#\ninclude <QTimer>\n#\ninclude <QTime>\n#\ninclude <QSslError>\n#\ninclude <QProcess>\n#\ninclude <QMutexLocker>\n#\ninclude <QStringList>\n#\ninclude <QDebug>\n#\ninclude <algorithm>\n#\n\narser {\n  ommandHandle Parser::close()\n  {\n      return queueCommand(Commands::ATOM, \"CLOSE\");\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::sent()\n  {\n      // FIXME: move back to the currently selected mailbox\n  \n      m_sentMail = true;\n      QTimer::singleShot(0, this, SLOT(close()));\n  }\n}"
  },
  {
    "function_name": "gotError(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "816-820",
    "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etUiWidgetsEnabled(",
          "args": [
            "rue)"
          ],
          "line": 819
        },
        "resolved": true,
        "details": {
          "function_name": "setUiWidgetsEnabled(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "372-376",
          "snippet": "oid ComposeWidget::setUiWidgetsEnabled(const bool enabled)\n{\n    ui->splitter->setEnabled(enabled);\n    ui->buttonBox->setEnabled(enabled);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::setUiWidgetsEnabled(const bool enabled)\n  {\n      ui->splitter->setEnabled(enabled);\n      ui->buttonBox->setEnabled(enabled);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MessageBox::critical(",
          "args": [
            "his,",
            "r(\"Failed to Send Mail\"),",
            "rror)"
          ],
          "line": 818
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Failed to Send Mail\")"
          ],
          "line": 818
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
  },
  {
    "function_name": "collapseRecipients(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "793-814",
    "snippet": "oid ComposeWidget::collapseRecipients()\n{\n    QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n    Q_ASSERT(edit);\n    if (edit->hasFocus() || !edit->text().isEmpty())\n        return; // nothing to clean up\n\n    // an empty recipient line just lost focus -> we \"place it at the end\", ie. simply remove it\n    // and append a clone\n    bool needEmpty = false;\n    Composer::RecipientKind carriedKind = recipientKindForNextRow(Composer::ADDRESS_TO);\n    for (int i = 0; i < m_recipients.count() - 1; ++i) { // sic! on the -1, no action if it trails anyway\n        if (m_recipients.at(i).second == edit) {\n            carriedKind = currentRecipient(m_recipients.last().first);\n            removeRecipient(i);\n            needEmpty = true;\n            break;\n        }\n    }\n    if (needEmpty)\n        addRecipient(m_recipients.count(), carriedKind, QString());\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ddRecipient(",
          "args": [
            "_recipients.count(),",
            "arriedKind,",
            "String())"
          ],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "addRecipient(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "554-590",
          "snippet": "oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n{\n    QComboBox *combo = new QComboBox(this);\n    combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n    combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n    combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n    combo->setCurrentIndex(combo->findData(kind));\n    LineEdit *edit = new LineEdit(address, this);\n    slotCheckAddress(edit);\n    connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n    connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n    connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n    connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n    m_recipients.insert(position, Recipient(combo, edit));\n    ui->envelopeWidget->setUpdatesEnabled(false);\n    ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n    setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n    setTabOrder(combo, edit);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (ui->recipientSlider->isVisible()) {\n        const int v = ui->recipientSlider->value();\n        int keepInSight = ++position;\n        for (int i = 0; i < m_recipients.count(); ++i) {\n            if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                keepInSight = i;\n                break;\n            }\n        }\n        if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n            ui->recipientSlider->setValue(position*max/m_recipients.count());\n        if (v == ui->recipientSlider->value()) // force scroll update\n            scrollRecipients(v);\n    }\n    ui->envelopeWidget->setUpdatesEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n  {\n      QComboBox *combo = new QComboBox(this);\n      combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n      combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n      combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n      combo->setCurrentIndex(combo->findData(kind));\n      LineEdit *edit = new LineEdit(address, this);\n      slotCheckAddress(edit);\n      connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n      connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n      connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n      connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n      m_recipients.insert(position, Recipient(combo, edit));\n      ui->envelopeWidget->setUpdatesEnabled(false);\n      ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n      setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n      setTabOrder(combo, edit);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (ui->recipientSlider->isVisible()) {\n          const int v = ui->recipientSlider->value();\n          int keepInSight = ++position;\n          for (int i = 0; i < m_recipients.count(); ++i) {\n              if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                  keepInSight = i;\n                  break;\n              }\n          }\n          if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n              ui->recipientSlider->setValue(position*max/m_recipients.count());\n          if (v == ui->recipientSlider->value()) // force scroll update\n              scrollRecipients(v);\n      }\n      ui->envelopeWidget->setUpdatesEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_recipients.count",
          "args": [],
          "line": 813
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "emoveRecipient(",
          "args": [
            ")"
          ],
          "line": 807
        },
        "resolved": true,
        "details": {
          "function_name": "removeRecipient(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "611-644",
          "snippet": "oid ComposeWidget::removeRecipient(int pos)\n{\n    // removing the widgets from the layout is important\n    // a) not doing so leaks (minor)\n    // b) deleteLater() crosses the evenchain and so our actualRow function would be tricked\n    QWidget *formerFocus = QApplication::focusWidget();\n    if (!formerFocus)\n        formerFocus = m_lastFocusedRecipient;\n\n    if (pos + 1 < m_recipients.count()) {\n        if (m_recipients.at(pos).first == formerFocus) {\n            m_recipients.at(pos + 1).first->setFocus();\n            formerFocus = m_recipients.at(pos + 1).first;\n        } else if (m_recipients.at(pos).second == formerFocus) {\n            m_recipients.at(pos + 1).second->setFocus();\n            formerFocus = m_recipients.at(pos + 1).second;\n        }\n    } else if (m_recipients.at(pos).first == formerFocus || m_recipients.at(pos).second == formerFocus) {\n            formerFocus = 0;\n    }\n\n    ui->envelopeLayout->removeWidget(m_recipients.at(pos).first);\n    ui->envelopeLayout->removeWidget(m_recipients.at(pos).second);\n    m_recipients.at(pos).first->deleteLater();\n    m_recipients.at(pos).second->deleteLater();\n    m_recipients.removeAt(pos);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (formerFocus) {\n        // skip event loop, remove might be triggered by imminent focus loss\n        CALL_LATER_NOARG(formerFocus, setFocus);\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::removeRecipient(int pos)\n  {\n      // removing the widgets from the layout is important\n      // a) not doing so leaks (minor)\n      // b) deleteLater() crosses the evenchain and so our actualRow function would be tricked\n      QWidget *formerFocus = QApplication::focusWidget();\n      if (!formerFocus)\n          formerFocus = m_lastFocusedRecipient;\n  \n      if (pos + 1 < m_recipients.count()) {\n          if (m_recipients.at(pos).first == formerFocus) {\n              m_recipients.at(pos + 1).first->setFocus();\n              formerFocus = m_recipients.at(pos + 1).first;\n          } else if (m_recipients.at(pos).second == formerFocus) {\n              m_recipients.at(pos + 1).second->setFocus();\n              formerFocus = m_recipients.at(pos + 1).second;\n          }\n      } else if (m_recipients.at(pos).first == formerFocus || m_recipients.at(pos).second == formerFocus) {\n              formerFocus = 0;\n      }\n  \n      ui->envelopeLayout->removeWidget(m_recipients.at(pos).first);\n      ui->envelopeLayout->removeWidget(m_recipients.at(pos).second);\n      m_recipients.at(pos).first->deleteLater();\n      m_recipients.at(pos).second->deleteLater();\n      m_recipients.removeAt(pos);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (formerFocus) {\n          // skip event loop, remove might be triggered by imminent focus loss\n          CALL_LATER_NOARG(formerFocus, setFocus);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "urrentRecipient(",
          "args": [
            "_recipients.last().first)"
          ],
          "line": 806
        },
        "resolved": true,
        "details": {
          "function_name": "urrentRecipient(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "646-649",
          "snippet": "tatic inline Composer::RecipientKind currentRecipient(const QComboBox *box)\n{\n    return Composer::RecipientKind(box->itemData(box->currentIndex()).toInt());\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\ntatic inline Composer::RecipientKind currentRecipient(const QComboBox *box)\n{\n    return Composer::RecipientKind(box->itemData(box->currentIndex()).toInt());\n}"
        }
      },
      {
        "call_info": {
          "callee": "_recipients.last",
          "args": [],
          "line": 806
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 805
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecipientKindForNextRow(",
          "args": [
            "omposer::ADDRESS_TO)"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "recipientKindForNextRow(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "423-444",
          "snippet": "omposer::RecipientKind ComposeWidget::recipientKindForNextRow(const Composer::RecipientKind kind)\n{\n    using namespace Imap::Mailbox;\n    switch (kind) {\n    case Composer::ADDRESS_TO:\n        // Heuristic: if the last one is \"to\", chances are that the next one shall not be \"to\" as well.\n        // Cc is reasonable here.\n        return Composer::ADDRESS_CC;\n    case Composer::ADDRESS_CC:\n    case Composer::ADDRESS_BCC:\n        // In any other case, it is probably better to just reuse the type of the last row\n        return kind;\n    case Composer::ADDRESS_FROM:\n    case Composer::ADDRESS_SENDER:\n    case Composer::ADDRESS_REPLY_TO:\n        // shall never be used here\n        Q_ASSERT(false);\n        return kind;\n    }\n    Q_ASSERT(false);\n    return Composer::ADDRESS_TO;\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  omposer::RecipientKind ComposeWidget::recipientKindForNextRow(const Composer::RecipientKind kind)\n  {\n      using namespace Imap::Mailbox;\n      switch (kind) {\n      case Composer::ADDRESS_TO:\n          // Heuristic: if the last one is \"to\", chances are that the next one shall not be \"to\" as well.\n          // Cc is reasonable here.\n          return Composer::ADDRESS_CC;\n      case Composer::ADDRESS_CC:\n      case Composer::ADDRESS_BCC:\n          // In any other case, it is probably better to just reuse the type of the last row\n          return kind;\n      case Composer::ADDRESS_FROM:\n      case Composer::ADDRESS_SENDER:\n      case Composer::ADDRESS_REPLY_TO:\n          // shall never be used here\n          Q_ASSERT(false);\n          return kind;\n      }\n      Q_ASSERT(false);\n      return Composer::ADDRESS_TO;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dit->text",
          "args": [],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dit->text",
          "args": [],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dit->hasFocus",
          "args": [],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "dit)"
          ],
          "line": 796
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object_cast<QLineEdit*>",
          "args": [
            "ender())"
          ],
          "line": 795
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ender(",
          "args": [],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "sender(",
          "container": "neMessageModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/OneMessageModel.cpp",
          "lines": "134-137",
          "snippet": "VariantList OneMessageModel::sender() const\n{\n    return m_message.data(RoleMessageSender).toList();\n}",
          "includes": [
            "include \"SubtreeModel.h\"",
            "include \"Model.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"FindInterestingPart.h\"\n#",
            "include \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#",
            "include \"OneMessageModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SubtreeModel.h\"\ninclude \"Model.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"FindInterestingPart.h\"\n#\ninclude \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#\ninclude \"OneMessageModel.h\"\n#\n\nneMessageModel {\n  VariantList OneMessageModel::sender() const\n  {\n      return m_message.data(RoleMessageSender).toList();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::collapseRecipients()\n  {\n      QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n      Q_ASSERT(edit);\n      if (edit->hasFocus() || !edit->text().isEmpty())\n          return; // nothing to clean up\n  \n      // an empty recipient line just lost focus -> we \"place it at the end\", ie. simply remove it\n      // and append a clone\n      bool needEmpty = false;\n      Composer::RecipientKind carriedKind = recipientKindForNextRow(Composer::ADDRESS_TO);\n      for (int i = 0; i < m_recipients.count() - 1; ++i) { // sic! on the -1, no action if it trails anyway\n          if (m_recipients.at(i).second == edit) {\n              carriedKind = currentRecipient(m_recipients.last().first);\n              removeRecipient(i);\n              needEmpty = true;\n              break;\n          }\n      }\n      if (needEmpty)\n          addRecipient(m_recipients.count(), carriedKind, QString());\n  }\n}"
  },
  {
    "function_name": "scrollRecipients(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "731-791",
    "snippet": "oid ComposeWidget::scrollRecipients(int value)\n{\n    // ignore focus changes caused by \"scrolling\"\n    disconnect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), this, SLOT(handleFocusChange()));\n\n    QList<QWidget*> visibleWidgets;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        // remove all widgets from the form because of vspacing - causes spurious padding\n\n        QWidget *toCC = m_recipients.at(i).first;\n        QWidget *lineEdit = m_recipients.at(i).second;\n        if (!m_lastFocusedRecipient) { // apply only _once_\n            if (toCC->hasFocus())\n                m_lastFocusedRecipient = toCC;\n            else if (lineEdit->hasFocus())\n                m_lastFocusedRecipient = lineEdit;\n        }\n        if (toCC->isVisible())\n            visibleWidgets << toCC;\n        if (lineEdit->isVisible())\n            visibleWidgets << lineEdit;\n        ui->envelopeLayout->removeWidget(toCC);\n        ui->envelopeLayout->removeWidget(lineEdit);\n        toCC->hide();\n        lineEdit->hide();\n    }\n\n    const int begin = qMin(m_recipients.count(), value);\n    const int end   = qMin(m_recipients.count(), value + m_maxVisibleRecipients);\n    for (int i = begin, j = 0; i < end; ++i, ++j) {\n        const int pos = actualRow(ui->envelopeLayout, j + OFFSET_OF_FIRST_ADDRESSEE);\n        QWidget *toCC = m_recipients.at(i).first;\n        QWidget *lineEdit = m_recipients.at(i).second;\n        ui->envelopeLayout->insertRow(pos, toCC, lineEdit);\n        if (!visibleWidgets.contains(toCC))\n            fadeIn(toCC);\n        visibleWidgets.removeOne(toCC);\n        if (!visibleWidgets.contains(lineEdit))\n            fadeIn(lineEdit);\n        visibleWidgets.removeOne(lineEdit);\n        toCC->show();\n        lineEdit->show();\n        setTabOrder(formPredecessor(ui->envelopeLayout, toCC), toCC);\n        setTabOrder(toCC, lineEdit);\n        if (toCC == m_lastFocusedRecipient)\n            toCC->setFocus();\n        else if (lineEdit == m_lastFocusedRecipient)\n            lineEdit->setFocus();\n    }\n\n    if (m_lastFocusedRecipient && !m_lastFocusedRecipient->hasFocus() && QApplication::focusWidget())\n        ui->envelopeWidget->setFocus();\n\n    Q_FOREACH (QWidget *w, visibleWidgets) {\n        // was visible, is no longer -> stop animation so it won't conflict later ones\n        w->setGraphicsEffect(0); // deletes old one\n        if (QPropertyAnimation *pa = w->findChild<QPropertyAnimation*>(trojita_opacityAnimation))\n            pa->stop();\n    }\n    connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a->stop",
          "args": [],
          "line": 788
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->findChild<QPropertyAnimation*>",
          "args": [
            "rojita_opacityAnimation)"
          ],
          "line": 787
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setGraphicsEffect",
          "args": [
            ")"
          ],
          "line": 786
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeWidget->setFocus",
          "args": [],
          "line": 782
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::focusWidget(",
          "args": [],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_lastFocusedRecipient->hasFocus",
          "args": [],
          "line": 781
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ineEdit->setFocus",
          "args": [],
          "line": 778
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oCC->setFocus",
          "args": [],
          "line": 776
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etTabOrder(",
          "args": [
            "oCC,",
            "ineEdit)"
          ],
          "line": 774
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etTabOrder(",
          "args": [
            "ormPredecessor(ui->envelopeLayout, toCC),",
            "oCC)"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ormPredecessor(",
          "args": [
            "i->envelopeLayout,",
            "oCC)"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ineEdit->show",
          "args": [],
          "line": 772
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oCC->show",
          "args": [],
          "line": 771
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isibleWidgets.removeOne",
          "args": [
            "ineEdit)"
          ],
          "line": 770
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "adeIn(",
          "args": [
            "ineEdit)"
          ],
          "line": 769
        },
        "resolved": true,
        "details": {
          "function_name": "fadeIn(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "710-721",
          "snippet": "oid ComposeWidget::fadeIn(QWidget *w)\n{\n    QGraphicsOpacityEffect *effect = new QGraphicsOpacityEffect(w);\n    w->setGraphicsEffect(effect);\n    QPropertyAnimation *animation = new QPropertyAnimation(effect, \"opacity\", w);\n    connect(animation, SIGNAL(finished()), SLOT(slotFadeFinished()));\n    animation->setObjectName(trojita_opacityAnimation);\n    animation->setDuration(333);\n    animation->setStartValue(0.0);\n    animation->setEndValue(1.0);\n    animation->start(QAbstractAnimation::DeleteWhenStopped);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::fadeIn(QWidget *w)\n  {\n      QGraphicsOpacityEffect *effect = new QGraphicsOpacityEffect(w);\n      w->setGraphicsEffect(effect);\n      QPropertyAnimation *animation = new QPropertyAnimation(effect, \"opacity\", w);\n      connect(animation, SIGNAL(finished()), SLOT(slotFadeFinished()));\n      animation->setObjectName(trojita_opacityAnimation);\n      animation->setDuration(333);\n      animation->setStartValue(0.0);\n      animation->setEndValue(1.0);\n      animation->start(QAbstractAnimation::DeleteWhenStopped);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isibleWidgets.contains",
          "args": [
            "ineEdit)"
          ],
          "line": 768
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isibleWidgets.removeOne",
          "args": [
            "oCC)"
          ],
          "line": 767
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isibleWidgets.contains",
          "args": [
            "oCC)"
          ],
          "line": 765
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->insertRow",
          "args": [
            "os,",
            "oCC,",
            "ineEdit)"
          ],
          "line": 764
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 763
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 762
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctualRow(",
          "args": [
            "i->envelopeLayout,",
            "+ OFFSET_OF_FIRST_ADDRESSEE)"
          ],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "ctualRow(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "456-467",
          "snippet": "tatic int actualRow(QFormLayout *form, int row)\n{\n    for (int i = 0, c = 0; i < form->rowCount(); ++i) {\n        if (c == row) {\n            return i;\n        }\n        if (form->itemAt(i, QFormLayout::LabelRole) || form->itemAt(i, QFormLayout::FieldRole) ||\n            form->itemAt(i, QFormLayout::SpanningRole))\n            ++c;\n    }\n    return form->rowCount(); // append\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\ntatic int actualRow(QFormLayout *form, int row)\n{\n    for (int i = 0, c = 0; i < form->rowCount(); ++i) {\n        if (c == row) {\n            return i;\n        }\n        if (form->itemAt(i, QFormLayout::LabelRole) || form->itemAt(i, QFormLayout::FieldRole) ||\n            form->itemAt(i, QFormLayout::SpanningRole))\n            ++c;\n    }\n    return form->rowCount(); // append\n}"
        }
      },
      {
        "call_info": {
          "callee": "Min(",
          "args": [
            "_recipients.count(),",
            "alue + m_maxVisibleRecipients)"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.count",
          "args": [],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Min(",
          "args": [
            "_recipients.count(),",
            "alue)"
          ],
          "line": 758
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ineEdit->hide",
          "args": [],
          "line": 755
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oCC->hide",
          "args": [],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->removeWidget",
          "args": [
            "ineEdit)"
          ],
          "line": 753
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->removeWidget",
          "args": [
            "oCC)"
          ],
          "line": 752
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ineEdit->isVisible",
          "args": [],
          "line": 750
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oCC->isVisible",
          "args": [],
          "line": 748
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ineEdit->hasFocus",
          "args": [],
          "line": 745
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oCC->hasFocus",
          "args": [],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 741
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::scrollRecipients(int value)\n  {\n      // ignore focus changes caused by \"scrolling\"\n      disconnect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), this, SLOT(handleFocusChange()));\n  \n      QList<QWidget*> visibleWidgets;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          // remove all widgets from the form because of vspacing - causes spurious padding\n  \n          QWidget *toCC = m_recipients.at(i).first;\n          QWidget *lineEdit = m_recipients.at(i).second;\n          if (!m_lastFocusedRecipient) { // apply only _once_\n              if (toCC->hasFocus())\n                  m_lastFocusedRecipient = toCC;\n              else if (lineEdit->hasFocus())\n                  m_lastFocusedRecipient = lineEdit;\n          }\n          if (toCC->isVisible())\n              visibleWidgets << toCC;\n          if (lineEdit->isVisible())\n              visibleWidgets << lineEdit;\n          ui->envelopeLayout->removeWidget(toCC);\n          ui->envelopeLayout->removeWidget(lineEdit);\n          toCC->hide();\n          lineEdit->hide();\n      }\n  \n      const int begin = qMin(m_recipients.count(), value);\n      const int end   = qMin(m_recipients.count(), value + m_maxVisibleRecipients);\n      for (int i = begin, j = 0; i < end; ++i, ++j) {\n          const int pos = actualRow(ui->envelopeLayout, j + OFFSET_OF_FIRST_ADDRESSEE);\n          QWidget *toCC = m_recipients.at(i).first;\n          QWidget *lineEdit = m_recipients.at(i).second;\n          ui->envelopeLayout->insertRow(pos, toCC, lineEdit);\n          if (!visibleWidgets.contains(toCC))\n              fadeIn(toCC);\n          visibleWidgets.removeOne(toCC);\n          if (!visibleWidgets.contains(lineEdit))\n              fadeIn(lineEdit);\n          visibleWidgets.removeOne(lineEdit);\n          toCC->show();\n          lineEdit->show();\n          setTabOrder(formPredecessor(ui->envelopeLayout, toCC), toCC);\n          setTabOrder(toCC, lineEdit);\n          if (toCC == m_lastFocusedRecipient)\n              toCC->setFocus();\n          else if (lineEdit == m_lastFocusedRecipient)\n              lineEdit->setFocus();\n      }\n  \n      if (m_lastFocusedRecipient && !m_lastFocusedRecipient->hasFocus() && QApplication::focusWidget())\n          ui->envelopeWidget->setFocus();\n  \n      Q_FOREACH (QWidget *w, visibleWidgets) {\n          // was visible, is no longer -> stop animation so it won't conflict later ones\n          w->setGraphicsEffect(0); // deletes old one\n          if (QPropertyAnimation *pa = w->findChild<QPropertyAnimation*>(trojita_opacityAnimation))\n              pa->stop();\n      }\n      connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n  }\n}"
  },
  {
    "function_name": "slotFadeFinished(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "723-729",
    "snippet": "oid ComposeWidget::slotFadeFinished()\n{\n    Q_ASSERT(sender());\n    QWidget *animatedEffectWidget = qobject_cast<QWidget*>(sender()->parent());\n    Q_ASSERT(animatedEffectWidget);\n    animatedEffectWidget->setGraphicsEffect(0); // deletes old one\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nimatedEffectWidget->setGraphicsEffect",
          "args": [
            ")"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "nimatedEffectWidget)"
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object_cast<QWidget*>",
          "args": [
            "ender()->parent())"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ender",
          "args": [],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "sender(",
          "container": "neMessageModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/OneMessageModel.cpp",
          "lines": "134-137",
          "snippet": "VariantList OneMessageModel::sender() const\n{\n    return m_message.data(RoleMessageSender).toList();\n}",
          "includes": [
            "include \"SubtreeModel.h\"",
            "include \"Model.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"FindInterestingPart.h\"\n#",
            "include \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#",
            "include \"OneMessageModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SubtreeModel.h\"\ninclude \"Model.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"FindInterestingPart.h\"\n#\ninclude \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#\ninclude \"OneMessageModel.h\"\n#\n\nneMessageModel {\n  VariantList OneMessageModel::sender() const\n  {\n      return m_message.data(RoleMessageSender).toList();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ender())"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::slotFadeFinished()\n  {\n      Q_ASSERT(sender());\n      QWidget *animatedEffectWidget = qobject_cast<QWidget*>(sender()->parent());\n      Q_ASSERT(animatedEffectWidget);\n      animatedEffectWidget->setGraphicsEffect(0); // deletes old one\n  }\n}"
  },
  {
    "function_name": "fadeIn(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "710-721",
    "snippet": "oid ComposeWidget::fadeIn(QWidget *w)\n{\n    QGraphicsOpacityEffect *effect = new QGraphicsOpacityEffect(w);\n    w->setGraphicsEffect(effect);\n    QPropertyAnimation *animation = new QPropertyAnimation(effect, \"opacity\", w);\n    connect(animation, SIGNAL(finished()), SLOT(slotFadeFinished()));\n    animation->setObjectName(trojita_opacityAnimation);\n    animation->setDuration(333);\n    animation->setStartValue(0.0);\n    animation->setEndValue(1.0);\n    animation->start(QAbstractAnimation::DeleteWhenStopped);\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nimation->start",
          "args": [
            "AbstractAnimation::DeleteWhenStopped)"
          ],
          "line": 720
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimation->setEndValue",
          "args": [
            ".0)"
          ],
          "line": 719
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimation->setStartValue",
          "args": [
            ".0)"
          ],
          "line": 718
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimation->setDuration",
          "args": [
            "33)"
          ],
          "line": 717
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nimation->setObjectName",
          "args": [
            "rojita_opacityAnimation)"
          ],
          "line": 716
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "nimation,",
            "IGNAL(finished()),",
            "LOT(slotFadeFinished()))"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotFadeFinished())"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotFadeFinished(",
          "args": [],
          "line": 715
        },
        "resolved": true,
        "details": {
          "function_name": "slotFadeFinished(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "723-729",
          "snippet": "oid ComposeWidget::slotFadeFinished()\n{\n    Q_ASSERT(sender());\n    QWidget *animatedEffectWidget = qobject_cast<QWidget*>(sender()->parent());\n    Q_ASSERT(animatedEffectWidget);\n    animatedEffectWidget->setGraphicsEffect(0); // deletes old one\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::slotFadeFinished()\n  {\n      Q_ASSERT(sender());\n      QWidget *animatedEffectWidget = qobject_cast<QWidget*>(sender()->parent());\n      Q_ASSERT(animatedEffectWidget);\n      animatedEffectWidget->setGraphicsEffect(0); // deletes old one\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "inished())"
          ],
          "line": 715
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->setGraphicsEffect",
          "args": [
            "ffect)"
          ],
          "line": 713
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::fadeIn(QWidget *w)\n  {\n      QGraphicsOpacityEffect *effect = new QGraphicsOpacityEffect(w);\n      w->setGraphicsEffect(effect);\n      QPropertyAnimation *animation = new QPropertyAnimation(effect, \"opacity\", w);\n      connect(animation, SIGNAL(finished()), SLOT(slotFadeFinished()));\n      animation->setObjectName(trojita_opacityAnimation);\n      animation->setDuration(333);\n      animation->setStartValue(0.0);\n      animation->setEndValue(1.0);\n      animation->start(QAbstractAnimation::DeleteWhenStopped);\n  }\n}"
  },
  {
    "function_name": "scrollToFocus(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "681-708",
    "snippet": "oid ComposeWidget::scrollToFocus()\n{\n    if (!ui->recipientSlider->isVisible())\n        return;\n\n    QWidget *focus = QApplication::focusWidget();\n    if (focus == ui->envelopeWidget)\n        focus = m_lastFocusedRecipient;\n    if (!focus)\n        return;\n\n    // if this is the first or last visible recipient, show one more (to hint there's more and allow tab progression)\n    for (int i = 0, pos = 0; i < m_recipients.count(); ++i) {\n        if (m_recipients.at(i).first->isVisible())\n            ++pos;\n        if (focus == m_recipients.at(i).first || focus == m_recipients.at(i).second) {\n            if (pos > 1 && pos < m_maxVisibleRecipients) // prev & next are in sight\n                break;\n            if (pos == 1)\n                ui->recipientSlider->setValue(i - 1); // scroll to prev\n            else\n                ui->recipientSlider->setValue(i + 2 - m_maxVisibleRecipients);  // scroll to next\n            break;\n        }\n    }\n    if (focus == m_lastFocusedRecipient)\n        focus->setFocus(); // in case we scrolled to m_lastFocusedRecipient\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ocus->setFocus",
          "args": [],
          "line": 707
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setValue",
          "args": [
            "+ 2 - m_maxVisibleRecipients)"
          ],
          "line": 702
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setValue",
          "args": [
            "- 1)"
          ],
          "line": 700
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 696
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.count",
          "args": [],
          "line": 693
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Application::focusWidget(",
          "args": [],
          "line": 686
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->isVisible",
          "args": [],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::scrollToFocus()\n  {\n      if (!ui->recipientSlider->isVisible())\n          return;\n  \n      QWidget *focus = QApplication::focusWidget();\n      if (focus == ui->envelopeWidget)\n          focus = m_lastFocusedRecipient;\n      if (!focus)\n          return;\n  \n      // if this is the first or last visible recipient, show one more (to hint there's more and allow tab progression)\n      for (int i = 0, pos = 0; i < m_recipients.count(); ++i) {\n          if (m_recipients.at(i).first->isVisible())\n              ++pos;\n          if (focus == m_recipients.at(i).first || focus == m_recipients.at(i).second) {\n              if (pos > 1 && pos < m_maxVisibleRecipients) // prev & next are in sight\n                  break;\n              if (pos == 1)\n                  ui->recipientSlider->setValue(i - 1); // scroll to prev\n              else\n                  ui->recipientSlider->setValue(i + 2 - m_maxVisibleRecipients);  // scroll to next\n              break;\n          }\n      }\n      if (focus == m_lastFocusedRecipient)\n          focus->setFocus(); // in case we scrolled to m_lastFocusedRecipient\n  }\n}"
  },
  {
    "function_name": "handleFocusChange(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "672-679",
    "snippet": "oid ComposeWidget::handleFocusChange()\n{\n    // got explicit focus on other widget - don't restore former focused recipient on scrolling\n    m_lastFocusedRecipient = QApplication::focusWidget();\n\n    if (m_lastFocusedRecipient)\n        QTimer::singleShot(150, this, SLOT(scrollToFocus())); // give user chance to notice the focus change disposition\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Timer::singleShot(",
          "args": [
            "50,",
            "his,",
            "LOT(scrollToFocus()))"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "crollToFocus())"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crollToFocus(",
          "args": [],
          "line": 678
        },
        "resolved": true,
        "details": {
          "function_name": "scrollToFocus(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "681-708",
          "snippet": "oid ComposeWidget::scrollToFocus()\n{\n    if (!ui->recipientSlider->isVisible())\n        return;\n\n    QWidget *focus = QApplication::focusWidget();\n    if (focus == ui->envelopeWidget)\n        focus = m_lastFocusedRecipient;\n    if (!focus)\n        return;\n\n    // if this is the first or last visible recipient, show one more (to hint there's more and allow tab progression)\n    for (int i = 0, pos = 0; i < m_recipients.count(); ++i) {\n        if (m_recipients.at(i).first->isVisible())\n            ++pos;\n        if (focus == m_recipients.at(i).first || focus == m_recipients.at(i).second) {\n            if (pos > 1 && pos < m_maxVisibleRecipients) // prev & next are in sight\n                break;\n            if (pos == 1)\n                ui->recipientSlider->setValue(i - 1); // scroll to prev\n            else\n                ui->recipientSlider->setValue(i + 2 - m_maxVisibleRecipients);  // scroll to next\n            break;\n        }\n    }\n    if (focus == m_lastFocusedRecipient)\n        focus->setFocus(); // in case we scrolled to m_lastFocusedRecipient\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::scrollToFocus()\n  {\n      if (!ui->recipientSlider->isVisible())\n          return;\n  \n      QWidget *focus = QApplication::focusWidget();\n      if (focus == ui->envelopeWidget)\n          focus = m_lastFocusedRecipient;\n      if (!focus)\n          return;\n  \n      // if this is the first or last visible recipient, show one more (to hint there's more and allow tab progression)\n      for (int i = 0, pos = 0; i < m_recipients.count(); ++i) {\n          if (m_recipients.at(i).first->isVisible())\n              ++pos;\n          if (focus == m_recipients.at(i).first || focus == m_recipients.at(i).second) {\n              if (pos > 1 && pos < m_maxVisibleRecipients) // prev & next are in sight\n                  break;\n              if (pos == 1)\n                  ui->recipientSlider->setValue(i - 1); // scroll to prev\n              else\n                  ui->recipientSlider->setValue(i + 2 - m_maxVisibleRecipients);  // scroll to next\n              break;\n          }\n      }\n      if (focus == m_lastFocusedRecipient)\n          focus->setFocus(); // in case we scrolled to m_lastFocusedRecipient\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Application::focusWidget(",
          "args": [],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::handleFocusChange()\n  {\n      // got explicit focus on other widget - don't restore former focused recipient on scrolling\n      m_lastFocusedRecipient = QApplication::focusWidget();\n  \n      if (m_lastFocusedRecipient)\n          QTimer::singleShot(150, this, SLOT(scrollToFocus())); // give user chance to notice the focus change disposition\n  }\n}"
  },
  {
    "function_name": "updateRecipientList(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "651-670",
    "snippet": "oid ComposeWidget::updateRecipientList()\n{\n    // we ensure there's always one empty available\n    bool haveEmpty = false;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        if (m_recipients.at(i).second->text().isEmpty()) {\n            if (haveEmpty) {\n                removeRecipient(i);\n            }\n            haveEmpty = true;\n        }\n    }\n    if (!haveEmpty) {\n        addRecipient(m_recipients.count(),\n                     m_recipients.isEmpty() ?\n                         Composer::ADDRESS_TO :\n                         recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                     QString());\n    }\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ddRecipient(",
          "args": [
            "_recipients.count(),",
            "_recipients.isEmpty() ?\n                         Composer::ADDRESS_TO :\n                         recipientKindForNextRow(currentRecipient(m_recipients.last().first)),",
            "String())"
          ],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "addRecipient(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "554-590",
          "snippet": "oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n{\n    QComboBox *combo = new QComboBox(this);\n    combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n    combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n    combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n    combo->setCurrentIndex(combo->findData(kind));\n    LineEdit *edit = new LineEdit(address, this);\n    slotCheckAddress(edit);\n    connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n    connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n    connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n    connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n    m_recipients.insert(position, Recipient(combo, edit));\n    ui->envelopeWidget->setUpdatesEnabled(false);\n    ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n    setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n    setTabOrder(combo, edit);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (ui->recipientSlider->isVisible()) {\n        const int v = ui->recipientSlider->value();\n        int keepInSight = ++position;\n        for (int i = 0; i < m_recipients.count(); ++i) {\n            if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                keepInSight = i;\n                break;\n            }\n        }\n        if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n            ui->recipientSlider->setValue(position*max/m_recipients.count());\n        if (v == ui->recipientSlider->value()) // force scroll update\n            scrollRecipients(v);\n    }\n    ui->envelopeWidget->setUpdatesEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n  {\n      QComboBox *combo = new QComboBox(this);\n      combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n      combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n      combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n      combo->setCurrentIndex(combo->findData(kind));\n      LineEdit *edit = new LineEdit(address, this);\n      slotCheckAddress(edit);\n      connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n      connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n      connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n      connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n      m_recipients.insert(position, Recipient(combo, edit));\n      ui->envelopeWidget->setUpdatesEnabled(false);\n      ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n      setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n      setTabOrder(combo, edit);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (ui->recipientSlider->isVisible()) {\n          const int v = ui->recipientSlider->value();\n          int keepInSight = ++position;\n          for (int i = 0; i < m_recipients.count(); ++i) {\n              if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                  keepInSight = i;\n                  break;\n              }\n          }\n          if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n              ui->recipientSlider->setValue(position*max/m_recipients.count());\n          if (v == ui->recipientSlider->value()) // force scroll update\n              scrollRecipients(v);\n      }\n      ui->envelopeWidget->setUpdatesEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecipientKindForNextRow(",
          "args": [
            "urrentRecipient(m_recipients.last().first))"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "recipientKindForNextRow(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "423-444",
          "snippet": "omposer::RecipientKind ComposeWidget::recipientKindForNextRow(const Composer::RecipientKind kind)\n{\n    using namespace Imap::Mailbox;\n    switch (kind) {\n    case Composer::ADDRESS_TO:\n        // Heuristic: if the last one is \"to\", chances are that the next one shall not be \"to\" as well.\n        // Cc is reasonable here.\n        return Composer::ADDRESS_CC;\n    case Composer::ADDRESS_CC:\n    case Composer::ADDRESS_BCC:\n        // In any other case, it is probably better to just reuse the type of the last row\n        return kind;\n    case Composer::ADDRESS_FROM:\n    case Composer::ADDRESS_SENDER:\n    case Composer::ADDRESS_REPLY_TO:\n        // shall never be used here\n        Q_ASSERT(false);\n        return kind;\n    }\n    Q_ASSERT(false);\n    return Composer::ADDRESS_TO;\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  omposer::RecipientKind ComposeWidget::recipientKindForNextRow(const Composer::RecipientKind kind)\n  {\n      using namespace Imap::Mailbox;\n      switch (kind) {\n      case Composer::ADDRESS_TO:\n          // Heuristic: if the last one is \"to\", chances are that the next one shall not be \"to\" as well.\n          // Cc is reasonable here.\n          return Composer::ADDRESS_CC;\n      case Composer::ADDRESS_CC:\n      case Composer::ADDRESS_BCC:\n          // In any other case, it is probably better to just reuse the type of the last row\n          return kind;\n      case Composer::ADDRESS_FROM:\n      case Composer::ADDRESS_SENDER:\n      case Composer::ADDRESS_REPLY_TO:\n          // shall never be used here\n          Q_ASSERT(false);\n          return kind;\n      }\n      Q_ASSERT(false);\n      return Composer::ADDRESS_TO;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "urrentRecipient(",
          "args": [
            "_recipients.last().first)"
          ],
          "line": 667
        },
        "resolved": true,
        "details": {
          "function_name": "urrentRecipient(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "646-649",
          "snippet": "tatic inline Composer::RecipientKind currentRecipient(const QComboBox *box)\n{\n    return Composer::RecipientKind(box->itemData(box->currentIndex()).toInt());\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\ntatic inline Composer::RecipientKind currentRecipient(const QComboBox *box)\n{\n    return Composer::RecipientKind(box->itemData(box->currentIndex()).toInt());\n}"
        }
      },
      {
        "call_info": {
          "callee": "_recipients.last",
          "args": [],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.isEmpty",
          "args": [],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.count",
          "args": [],
          "line": 664
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "emoveRecipient(",
          "args": [
            ")"
          ],
          "line": 658
        },
        "resolved": true,
        "details": {
          "function_name": "removeRecipient(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "611-644",
          "snippet": "oid ComposeWidget::removeRecipient(int pos)\n{\n    // removing the widgets from the layout is important\n    // a) not doing so leaks (minor)\n    // b) deleteLater() crosses the evenchain and so our actualRow function would be tricked\n    QWidget *formerFocus = QApplication::focusWidget();\n    if (!formerFocus)\n        formerFocus = m_lastFocusedRecipient;\n\n    if (pos + 1 < m_recipients.count()) {\n        if (m_recipients.at(pos).first == formerFocus) {\n            m_recipients.at(pos + 1).first->setFocus();\n            formerFocus = m_recipients.at(pos + 1).first;\n        } else if (m_recipients.at(pos).second == formerFocus) {\n            m_recipients.at(pos + 1).second->setFocus();\n            formerFocus = m_recipients.at(pos + 1).second;\n        }\n    } else if (m_recipients.at(pos).first == formerFocus || m_recipients.at(pos).second == formerFocus) {\n            formerFocus = 0;\n    }\n\n    ui->envelopeLayout->removeWidget(m_recipients.at(pos).first);\n    ui->envelopeLayout->removeWidget(m_recipients.at(pos).second);\n    m_recipients.at(pos).first->deleteLater();\n    m_recipients.at(pos).second->deleteLater();\n    m_recipients.removeAt(pos);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (formerFocus) {\n        // skip event loop, remove might be triggered by imminent focus loss\n        CALL_LATER_NOARG(formerFocus, setFocus);\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::removeRecipient(int pos)\n  {\n      // removing the widgets from the layout is important\n      // a) not doing so leaks (minor)\n      // b) deleteLater() crosses the evenchain and so our actualRow function would be tricked\n      QWidget *formerFocus = QApplication::focusWidget();\n      if (!formerFocus)\n          formerFocus = m_lastFocusedRecipient;\n  \n      if (pos + 1 < m_recipients.count()) {\n          if (m_recipients.at(pos).first == formerFocus) {\n              m_recipients.at(pos + 1).first->setFocus();\n              formerFocus = m_recipients.at(pos + 1).first;\n          } else if (m_recipients.at(pos).second == formerFocus) {\n              m_recipients.at(pos + 1).second->setFocus();\n              formerFocus = m_recipients.at(pos + 1).second;\n          }\n      } else if (m_recipients.at(pos).first == formerFocus || m_recipients.at(pos).second == formerFocus) {\n              formerFocus = 0;\n      }\n  \n      ui->envelopeLayout->removeWidget(m_recipients.at(pos).first);\n      ui->envelopeLayout->removeWidget(m_recipients.at(pos).second);\n      m_recipients.at(pos).first->deleteLater();\n      m_recipients.at(pos).second->deleteLater();\n      m_recipients.removeAt(pos);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (formerFocus) {\n          // skip event loop, remove might be triggered by imminent focus loss\n          CALL_LATER_NOARG(formerFocus, setFocus);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::updateRecipientList()\n  {\n      // we ensure there's always one empty available\n      bool haveEmpty = false;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          if (m_recipients.at(i).second->text().isEmpty()) {\n              if (haveEmpty) {\n                  removeRecipient(i);\n              }\n              haveEmpty = true;\n          }\n      }\n      if (!haveEmpty) {\n          addRecipient(m_recipients.count(),\n                       m_recipients.isEmpty() ?\n                           Composer::ADDRESS_TO :\n                           recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                       QString());\n      }\n  }\n}"
  },
  {
    "function_name": "urrentRecipient(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "646-649",
    "snippet": "tatic inline Composer::RecipientKind currentRecipient(const QComboBox *box)\n{\n    return Composer::RecipientKind(box->itemData(box->currentIndex()).toInt());\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "omposer::RecipientKind(",
          "args": [
            "ox->itemData(box->currentIndex()).toInt())"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ox->itemData",
          "args": [],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ox->itemData",
          "args": [
            "ox->currentIndex())"
          ],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ox->currentIndex",
          "args": [],
          "line": 648
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\ntatic inline Composer::RecipientKind currentRecipient(const QComboBox *box)\n{\n    return Composer::RecipientKind(box->itemData(box->currentIndex()).toInt());\n}"
  },
  {
    "function_name": "removeRecipient(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "611-644",
    "snippet": "oid ComposeWidget::removeRecipient(int pos)\n{\n    // removing the widgets from the layout is important\n    // a) not doing so leaks (minor)\n    // b) deleteLater() crosses the evenchain and so our actualRow function would be tricked\n    QWidget *formerFocus = QApplication::focusWidget();\n    if (!formerFocus)\n        formerFocus = m_lastFocusedRecipient;\n\n    if (pos + 1 < m_recipients.count()) {\n        if (m_recipients.at(pos).first == formerFocus) {\n            m_recipients.at(pos + 1).first->setFocus();\n            formerFocus = m_recipients.at(pos + 1).first;\n        } else if (m_recipients.at(pos).second == formerFocus) {\n            m_recipients.at(pos + 1).second->setFocus();\n            formerFocus = m_recipients.at(pos + 1).second;\n        }\n    } else if (m_recipients.at(pos).first == formerFocus || m_recipients.at(pos).second == formerFocus) {\n            formerFocus = 0;\n    }\n\n    ui->envelopeLayout->removeWidget(m_recipients.at(pos).first);\n    ui->envelopeLayout->removeWidget(m_recipients.at(pos).second);\n    m_recipients.at(pos).first->deleteLater();\n    m_recipients.at(pos).second->deleteLater();\n    m_recipients.removeAt(pos);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (formerFocus) {\n        // skip event loop, remove might be triggered by imminent focus loss\n        CALL_LATER_NOARG(formerFocus, setFocus);\n    }\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ALL_LATER_NOARG(",
          "args": [
            "ormerFocus,",
            "etFocus)"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setVisible",
          "args": [
            "ax > 0)"
          ],
          "line": 639
        },
        "resolved": true,
        "details": {
          "function_name": "setVisible",
          "container": "FindBar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FindBar.cpp",
          "lines": "134-164",
          "snippet": "void FindBar::setVisible(bool visible)\n{\n    QWidget::setVisible(visible);\n\n    if (!m_associatedWebView)\n        return;\n\n    if (visible) {\n        const QString selectedText = m_associatedWebView->page()->selectedText();\n        if (!hasFocus() && !selectedText.isEmpty()) {\n            const QString previousText = m_lineEdit->text();\n            m_lineEdit->setText(selectedText);\n\n            if (m_lineEdit->text() != previousText) {\n                findPrevious();\n            } else {\n                updateHighlight();\n            }\n        } else if (selectedText.isEmpty()) {\n            emit searchString(m_lineEdit->text());\n        }\n\n        m_lineEdit->setFocus();\n        m_lineEdit->selectAll();\n    } else {\n        updateHighlight();\n\n        // Clear the selection\n        m_associatedWebView->page()->findText(QString());\n    }\n}",
          "includes": [
            "#include \"Gui/Util.h\"",
            "#include \"LineEdit.h\"",
            "#include <QWebView>",
            "#include <QWebFrame>",
            "#include <QToolButton>",
            "#include <QPushButton>",
            "#include <QLabel>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCheckBox>",
            "#include \"FindBar.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Gui/Util.h\"\n#include \"LineEdit.h\"\n#include <QWebView>\n#include <QWebFrame>\n#include <QToolButton>\n#include <QPushButton>\n#include <QLabel>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCheckBox>\n#include \"FindBar.h\"\n\nFindBar {\n  void FindBar::setVisible(bool visible)\n  {\n      QWidget::setVisible(visible);\n  \n      if (!m_associatedWebView)\n          return;\n  \n      if (visible) {\n          const QString selectedText = m_associatedWebView->page()->selectedText();\n          if (!hasFocus() && !selectedText.isEmpty()) {\n              const QString previousText = m_lineEdit->text();\n              m_lineEdit->setText(selectedText);\n  \n              if (m_lineEdit->text() != previousText) {\n                  findPrevious();\n              } else {\n                  updateHighlight();\n              }\n          } else if (selectedText.isEmpty()) {\n              emit searchString(m_lineEdit->text());\n          }\n  \n          m_lineEdit->setFocus();\n          m_lineEdit->selectAll();\n      } else {\n          updateHighlight();\n  \n          // Clear the selection\n          m_associatedWebView->page()->findText(QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setMaximum",
          "args": [
            "ax)"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Max(",
          "args": [
            ",",
            "_recipients.count() - m_maxVisibleRecipients)"
          ],
          "line": 637
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.count",
          "args": [],
          "line": 637
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_recipients.removeAt",
          "args": [
            "os)"
          ],
          "line": 636
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os)"
          ],
          "line": 635
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os)"
          ],
          "line": 634
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->removeWidget",
          "args": [
            "_recipients.at(pos).second)"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os)"
          ],
          "line": 633
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->removeWidget",
          "args": [
            "_recipients.at(pos).first)"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os)"
          ],
          "line": 632
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os)"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os)"
          ],
          "line": 628
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os + 1)"
          ],
          "line": 626
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os + 1)"
          ],
          "line": 625
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os)"
          ],
          "line": 624
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os + 1)"
          ],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os + 1)"
          ],
          "line": 622
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            "os)"
          ],
          "line": 621
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Application::focusWidget(",
          "args": [],
          "line": 616
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::removeRecipient(int pos)\n  {\n      // removing the widgets from the layout is important\n      // a) not doing so leaks (minor)\n      // b) deleteLater() crosses the evenchain and so our actualRow function would be tricked\n      QWidget *formerFocus = QApplication::focusWidget();\n      if (!formerFocus)\n          formerFocus = m_lastFocusedRecipient;\n  \n      if (pos + 1 < m_recipients.count()) {\n          if (m_recipients.at(pos).first == formerFocus) {\n              m_recipients.at(pos + 1).first->setFocus();\n              formerFocus = m_recipients.at(pos + 1).first;\n          } else if (m_recipients.at(pos).second == formerFocus) {\n              m_recipients.at(pos + 1).second->setFocus();\n              formerFocus = m_recipients.at(pos + 1).second;\n          }\n      } else if (m_recipients.at(pos).first == formerFocus || m_recipients.at(pos).second == formerFocus) {\n              formerFocus = 0;\n      }\n  \n      ui->envelopeLayout->removeWidget(m_recipients.at(pos).first);\n      ui->envelopeLayout->removeWidget(m_recipients.at(pos).second);\n      m_recipients.at(pos).first->deleteLater();\n      m_recipients.at(pos).second->deleteLater();\n      m_recipients.removeAt(pos);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (formerFocus) {\n          // skip event loop, remove might be triggered by imminent focus loss\n          CALL_LATER_NOARG(formerFocus, setFocus);\n      }\n  }\n}"
  },
  {
    "function_name": "slotCheckAddress(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "599-609",
    "snippet": "oid ComposeWidget::slotCheckAddress(QLineEdit *edit)\n{\n    Imap::Message::MailAddress addr;\n    if (edit->text().isEmpty() || Imap::Message::MailAddress::fromPrettyString(addr, edit->text())) {\n        edit->setPalette(QPalette());\n    } else {\n        QPalette p;\n        p.setColor(QPalette::Base, Gui::Util::tintColor(p.color(QPalette::Base), QColor(0xff, 0, 0, 0x20)));\n        edit->setPalette(p);\n    }\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dit->setPalette",
          "args": [
            ")"
          ],
          "line": 607
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".setColor",
          "args": [
            "Palette::Base,",
            "ui::Util::tintColor(p.color(QPalette::Base), QColor(0xff, 0, 0, 0x20)))"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui::Util::tintColor(",
          "args": [
            ".color(QPalette::Base),",
            "Color(0xff, 0, 0, 0x20))"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Color(",
          "args": [
            "xff,",
            ",",
            ",",
            "x20)"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": ".color",
          "args": [
            "Palette::Base)"
          ],
          "line": 606
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dit->setPalette",
          "args": [
            "Palette())"
          ],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Palette(",
          "args": [],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::Message::MailAddress::fromPrettyString(",
          "args": [
            "ddr,",
            "dit->text())"
          ],
          "line": 602
        },
        "resolved": true,
        "details": {
          "function_name": "fromPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "41-52",
          "snippet": "ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n{\n    int offset = 0;\n\n    if (!parseOneAddress(into, address, offset))\n        return false;\n\n    if (offset < address.size())\n        return false;\n\n    return true;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n  {\n      int offset = 0;\n  \n      if (!parseOneAddress(into, address, offset))\n          return false;\n  \n      if (offset < address.size())\n          return false;\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "dit->text",
          "args": [],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dit->text",
          "args": [],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dit->text",
          "args": [],
          "line": 602
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::slotCheckAddress(QLineEdit *edit)\n  {\n      Imap::Message::MailAddress addr;\n      if (edit->text().isEmpty() || Imap::Message::MailAddress::fromPrettyString(addr, edit->text())) {\n          edit->setPalette(QPalette());\n      } else {\n          QPalette p;\n          p.setColor(QPalette::Base, Gui::Util::tintColor(p.color(QPalette::Base), QColor(0xff, 0, 0, 0x20)));\n          edit->setPalette(p);\n      }\n  }\n}"
  },
  {
    "function_name": "slotCheckAddress(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "592-597",
    "snippet": "oid ComposeWidget::slotCheckAddress()\n{\n    QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n    Q_ASSERT(edit);\n    slotCheckAddress(edit);\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lotCheckAddress(",
          "args": [
            "dit)"
          ],
          "line": 596
        },
        "resolved": true,
        "details": {
          "function_name": "slotCheckAddress(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "599-609",
          "snippet": "oid ComposeWidget::slotCheckAddress(QLineEdit *edit)\n{\n    Imap::Message::MailAddress addr;\n    if (edit->text().isEmpty() || Imap::Message::MailAddress::fromPrettyString(addr, edit->text())) {\n        edit->setPalette(QPalette());\n    } else {\n        QPalette p;\n        p.setColor(QPalette::Base, Gui::Util::tintColor(p.color(QPalette::Base), QColor(0xff, 0, 0, 0x20)));\n        edit->setPalette(p);\n    }\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "dit)"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object_cast<QLineEdit*>",
          "args": [
            "ender())"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ender(",
          "args": [],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "sender(",
          "container": "neMessageModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/OneMessageModel.cpp",
          "lines": "134-137",
          "snippet": "VariantList OneMessageModel::sender() const\n{\n    return m_message.data(RoleMessageSender).toList();\n}",
          "includes": [
            "include \"SubtreeModel.h\"",
            "include \"Model.h\"\n#",
            "include \"ItemRoles.h\"\n#",
            "include \"FindInterestingPart.h\"\n#",
            "include \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#",
            "include \"OneMessageModel.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"SubtreeModel.h\"\ninclude \"Model.h\"\n#\ninclude \"ItemRoles.h\"\n#\ninclude \"FindInterestingPart.h\"\n#\ninclude \"kdeui-itemviews/kdescendantsproxymodel.h\"\n#\ninclude \"OneMessageModel.h\"\n#\n\nneMessageModel {\n  VariantList OneMessageModel::sender() const\n  {\n      return m_message.data(RoleMessageSender).toList();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::slotCheckAddress()\n  {\n      QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n      Q_ASSERT(edit);\n      slotCheckAddress(edit);\n  }\n}"
  },
  {
    "function_name": "addRecipient(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "554-590",
    "snippet": "oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n{\n    QComboBox *combo = new QComboBox(this);\n    combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n    combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n    combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n    combo->setCurrentIndex(combo->findData(kind));\n    LineEdit *edit = new LineEdit(address, this);\n    slotCheckAddress(edit);\n    connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n    connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n    connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n    connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n    m_recipients.insert(position, Recipient(combo, edit));\n    ui->envelopeWidget->setUpdatesEnabled(false);\n    ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n    setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n    setTabOrder(combo, edit);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (ui->recipientSlider->isVisible()) {\n        const int v = ui->recipientSlider->value();\n        int keepInSight = ++position;\n        for (int i = 0; i < m_recipients.count(); ++i) {\n            if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                keepInSight = i;\n                break;\n            }\n        }\n        if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n            ui->recipientSlider->setValue(position*max/m_recipients.count());\n        if (v == ui->recipientSlider->value()) // force scroll update\n            scrollRecipients(v);\n    }\n    ui->envelopeWidget->setUpdatesEnabled(true);\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "i->envelopeWidget->setUpdatesEnabled",
          "args": [
            "rue)"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crollRecipients(",
          "args": [
            ")"
          ],
          "line": 587
        },
        "resolved": true,
        "details": {
          "function_name": "scrollRecipients(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "731-791",
          "snippet": "oid ComposeWidget::scrollRecipients(int value)\n{\n    // ignore focus changes caused by \"scrolling\"\n    disconnect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), this, SLOT(handleFocusChange()));\n\n    QList<QWidget*> visibleWidgets;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        // remove all widgets from the form because of vspacing - causes spurious padding\n\n        QWidget *toCC = m_recipients.at(i).first;\n        QWidget *lineEdit = m_recipients.at(i).second;\n        if (!m_lastFocusedRecipient) { // apply only _once_\n            if (toCC->hasFocus())\n                m_lastFocusedRecipient = toCC;\n            else if (lineEdit->hasFocus())\n                m_lastFocusedRecipient = lineEdit;\n        }\n        if (toCC->isVisible())\n            visibleWidgets << toCC;\n        if (lineEdit->isVisible())\n            visibleWidgets << lineEdit;\n        ui->envelopeLayout->removeWidget(toCC);\n        ui->envelopeLayout->removeWidget(lineEdit);\n        toCC->hide();\n        lineEdit->hide();\n    }\n\n    const int begin = qMin(m_recipients.count(), value);\n    const int end   = qMin(m_recipients.count(), value + m_maxVisibleRecipients);\n    for (int i = begin, j = 0; i < end; ++i, ++j) {\n        const int pos = actualRow(ui->envelopeLayout, j + OFFSET_OF_FIRST_ADDRESSEE);\n        QWidget *toCC = m_recipients.at(i).first;\n        QWidget *lineEdit = m_recipients.at(i).second;\n        ui->envelopeLayout->insertRow(pos, toCC, lineEdit);\n        if (!visibleWidgets.contains(toCC))\n            fadeIn(toCC);\n        visibleWidgets.removeOne(toCC);\n        if (!visibleWidgets.contains(lineEdit))\n            fadeIn(lineEdit);\n        visibleWidgets.removeOne(lineEdit);\n        toCC->show();\n        lineEdit->show();\n        setTabOrder(formPredecessor(ui->envelopeLayout, toCC), toCC);\n        setTabOrder(toCC, lineEdit);\n        if (toCC == m_lastFocusedRecipient)\n            toCC->setFocus();\n        else if (lineEdit == m_lastFocusedRecipient)\n            lineEdit->setFocus();\n    }\n\n    if (m_lastFocusedRecipient && !m_lastFocusedRecipient->hasFocus() && QApplication::focusWidget())\n        ui->envelopeWidget->setFocus();\n\n    Q_FOREACH (QWidget *w, visibleWidgets) {\n        // was visible, is no longer -> stop animation so it won't conflict later ones\n        w->setGraphicsEffect(0); // deletes old one\n        if (QPropertyAnimation *pa = w->findChild<QPropertyAnimation*>(trojita_opacityAnimation))\n            pa->stop();\n    }\n    connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::scrollRecipients(int value)\n  {\n      // ignore focus changes caused by \"scrolling\"\n      disconnect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), this, SLOT(handleFocusChange()));\n  \n      QList<QWidget*> visibleWidgets;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          // remove all widgets from the form because of vspacing - causes spurious padding\n  \n          QWidget *toCC = m_recipients.at(i).first;\n          QWidget *lineEdit = m_recipients.at(i).second;\n          if (!m_lastFocusedRecipient) { // apply only _once_\n              if (toCC->hasFocus())\n                  m_lastFocusedRecipient = toCC;\n              else if (lineEdit->hasFocus())\n                  m_lastFocusedRecipient = lineEdit;\n          }\n          if (toCC->isVisible())\n              visibleWidgets << toCC;\n          if (lineEdit->isVisible())\n              visibleWidgets << lineEdit;\n          ui->envelopeLayout->removeWidget(toCC);\n          ui->envelopeLayout->removeWidget(lineEdit);\n          toCC->hide();\n          lineEdit->hide();\n      }\n  \n      const int begin = qMin(m_recipients.count(), value);\n      const int end   = qMin(m_recipients.count(), value + m_maxVisibleRecipients);\n      for (int i = begin, j = 0; i < end; ++i, ++j) {\n          const int pos = actualRow(ui->envelopeLayout, j + OFFSET_OF_FIRST_ADDRESSEE);\n          QWidget *toCC = m_recipients.at(i).first;\n          QWidget *lineEdit = m_recipients.at(i).second;\n          ui->envelopeLayout->insertRow(pos, toCC, lineEdit);\n          if (!visibleWidgets.contains(toCC))\n              fadeIn(toCC);\n          visibleWidgets.removeOne(toCC);\n          if (!visibleWidgets.contains(lineEdit))\n              fadeIn(lineEdit);\n          visibleWidgets.removeOne(lineEdit);\n          toCC->show();\n          lineEdit->show();\n          setTabOrder(formPredecessor(ui->envelopeLayout, toCC), toCC);\n          setTabOrder(toCC, lineEdit);\n          if (toCC == m_lastFocusedRecipient)\n              toCC->setFocus();\n          else if (lineEdit == m_lastFocusedRecipient)\n              lineEdit->setFocus();\n      }\n  \n      if (m_lastFocusedRecipient && !m_lastFocusedRecipient->hasFocus() && QApplication::focusWidget())\n          ui->envelopeWidget->setFocus();\n  \n      Q_FOREACH (QWidget *w, visibleWidgets) {\n          // was visible, is no longer -> stop animation so it won't conflict later ones\n          w->setGraphicsEffect(0); // deletes old one\n          if (QPropertyAnimation *pa = w->findChild<QPropertyAnimation*>(trojita_opacityAnimation))\n              pa->stop();\n      }\n      connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->value",
          "args": [],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "333-336",
          "snippet": "QByteArray QMimeMagicRule::value() const\n{\n    return d->value;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QByteArray QMimeMagicRule::value() const\n  {\n      return d->value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setValue",
          "args": [
            "osition*max/m_recipients.count())"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.count",
          "args": [],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Abs(",
          "args": [
            "eepInSight - position)"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.at",
          "args": [
            ")"
          ],
          "line": 579
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->isVisible",
          "args": [],
          "line": 575
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setVisible",
          "args": [
            "ax > 0)"
          ],
          "line": 574
        },
        "resolved": true,
        "details": {
          "function_name": "setVisible",
          "container": "FindBar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FindBar.cpp",
          "lines": "134-164",
          "snippet": "void FindBar::setVisible(bool visible)\n{\n    QWidget::setVisible(visible);\n\n    if (!m_associatedWebView)\n        return;\n\n    if (visible) {\n        const QString selectedText = m_associatedWebView->page()->selectedText();\n        if (!hasFocus() && !selectedText.isEmpty()) {\n            const QString previousText = m_lineEdit->text();\n            m_lineEdit->setText(selectedText);\n\n            if (m_lineEdit->text() != previousText) {\n                findPrevious();\n            } else {\n                updateHighlight();\n            }\n        } else if (selectedText.isEmpty()) {\n            emit searchString(m_lineEdit->text());\n        }\n\n        m_lineEdit->setFocus();\n        m_lineEdit->selectAll();\n    } else {\n        updateHighlight();\n\n        // Clear the selection\n        m_associatedWebView->page()->findText(QString());\n    }\n}",
          "includes": [
            "#include \"Gui/Util.h\"",
            "#include \"LineEdit.h\"",
            "#include <QWebView>",
            "#include <QWebFrame>",
            "#include <QToolButton>",
            "#include <QPushButton>",
            "#include <QLabel>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCheckBox>",
            "#include \"FindBar.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Gui/Util.h\"\n#include \"LineEdit.h\"\n#include <QWebView>\n#include <QWebFrame>\n#include <QToolButton>\n#include <QPushButton>\n#include <QLabel>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCheckBox>\n#include \"FindBar.h\"\n\nFindBar {\n  void FindBar::setVisible(bool visible)\n  {\n      QWidget::setVisible(visible);\n  \n      if (!m_associatedWebView)\n          return;\n  \n      if (visible) {\n          const QString selectedText = m_associatedWebView->page()->selectedText();\n          if (!hasFocus() && !selectedText.isEmpty()) {\n              const QString previousText = m_lineEdit->text();\n              m_lineEdit->setText(selectedText);\n  \n              if (m_lineEdit->text() != previousText) {\n                  findPrevious();\n              } else {\n                  updateHighlight();\n              }\n          } else if (selectedText.isEmpty()) {\n              emit searchString(m_lineEdit->text());\n          }\n  \n          m_lineEdit->setFocus();\n          m_lineEdit->selectAll();\n      } else {\n          updateHighlight();\n  \n          // Clear the selection\n          m_associatedWebView->page()->findText(QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setMaximum",
          "args": [
            "ax)"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Max(",
          "args": [
            ",",
            "_recipients.count() - m_maxVisibleRecipients)"
          ],
          "line": 572
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etTabOrder(",
          "args": [
            "ombo,",
            "dit)"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etTabOrder(",
          "args": [
            "ormPredecessor(ui->envelopeLayout, combo),",
            "ombo)"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ormPredecessor(",
          "args": [
            "i->envelopeLayout,",
            "ombo)"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->insertRow",
          "args": [
            "ctualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE),",
            "ombo,",
            "dit)"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ctualRow(",
          "args": [
            "i->envelopeLayout,",
            "osition + OFFSET_OF_FIRST_ADDRESSEE)"
          ],
          "line": 569
        },
        "resolved": true,
        "details": {
          "function_name": "ctualRow(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "456-467",
          "snippet": "tatic int actualRow(QFormLayout *form, int row)\n{\n    for (int i = 0, c = 0; i < form->rowCount(); ++i) {\n        if (c == row) {\n            return i;\n        }\n        if (form->itemAt(i, QFormLayout::LabelRole) || form->itemAt(i, QFormLayout::FieldRole) ||\n            form->itemAt(i, QFormLayout::SpanningRole))\n            ++c;\n    }\n    return form->rowCount(); // append\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\ntatic int actualRow(QFormLayout *form, int row)\n{\n    for (int i = 0, c = 0; i < form->rowCount(); ++i) {\n        if (c == row) {\n            return i;\n        }\n        if (form->itemAt(i, QFormLayout::LabelRole) || form->itemAt(i, QFormLayout::FieldRole) ||\n            form->itemAt(i, QFormLayout::SpanningRole))\n            ++c;\n    }\n    return form->rowCount(); // append\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->envelopeWidget->setUpdatesEnabled",
          "args": [
            "alse)"
          ],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.insert",
          "args": [
            "osition,",
            "ecipient(combo, edit))"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecipient(",
          "args": [
            "ombo,",
            "dit)"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "dit,",
            "IGNAL(textChanged(QString)),",
            "_recipientListUpdateTimer,",
            "LOT(start()))"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "tart())"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tart(",
          "args": [],
          "line": 566
        },
        "resolved": true,
        "details": {
          "function_name": "isConnectingEncryptedSinceStart(",
          "container": "ocket",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Streams/Socket.cpp",
          "lines": "31-34",
          "snippet": "ool Socket::isConnectingEncryptedSinceStart() const\n{\n    return false;\n}",
          "includes": [
            "include \"Socket.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Socket.h\"\n\nocket {\n  ool Socket::isConnectingEncryptedSinceStart() const\n  {\n      return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "extChanged(QString))"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "extChanged(",
          "args": [
            "String)"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "dit,",
            "IGNAL(editingFinished()),",
            "LOT(collapseRecipients()))"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "ollapseRecipients())"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ollapseRecipients(",
          "args": [],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "collapseRecipients(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "793-814",
          "snippet": "oid ComposeWidget::collapseRecipients()\n{\n    QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n    Q_ASSERT(edit);\n    if (edit->hasFocus() || !edit->text().isEmpty())\n        return; // nothing to clean up\n\n    // an empty recipient line just lost focus -> we \"place it at the end\", ie. simply remove it\n    // and append a clone\n    bool needEmpty = false;\n    Composer::RecipientKind carriedKind = recipientKindForNextRow(Composer::ADDRESS_TO);\n    for (int i = 0; i < m_recipients.count() - 1; ++i) { // sic! on the -1, no action if it trails anyway\n        if (m_recipients.at(i).second == edit) {\n            carriedKind = currentRecipient(m_recipients.last().first);\n            removeRecipient(i);\n            needEmpty = true;\n            break;\n        }\n    }\n    if (needEmpty)\n        addRecipient(m_recipients.count(), carriedKind, QString());\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::collapseRecipients()\n  {\n      QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n      Q_ASSERT(edit);\n      if (edit->hasFocus() || !edit->text().isEmpty())\n          return; // nothing to clean up\n  \n      // an empty recipient line just lost focus -> we \"place it at the end\", ie. simply remove it\n      // and append a clone\n      bool needEmpty = false;\n      Composer::RecipientKind carriedKind = recipientKindForNextRow(Composer::ADDRESS_TO);\n      for (int i = 0; i < m_recipients.count() - 1; ++i) { // sic! on the -1, no action if it trails anyway\n          if (m_recipients.at(i).second == edit) {\n              carriedKind = currentRecipient(m_recipients.last().first);\n              removeRecipient(i);\n              needEmpty = true;\n              break;\n          }\n      }\n      if (needEmpty)\n          addRecipient(m_recipients.count(), carriedKind, QString());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ditingFinished())"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ditingFinished(",
          "args": [],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "dit,",
            "IGNAL(textEdited(QString)),",
            "LOT(completeRecipients(QString)))"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "ompleteRecipients(QString))"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ompleteRecipients(",
          "args": [
            "String)"
          ],
          "line": 564
        },
        "resolved": true,
        "details": {
          "function_name": "completeRecipients(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "852-879",
          "snippet": "oid ComposeWidget::completeRecipients(const QString &text)\n{\n    if (text.isEmpty()) {\n        if (m_completionPopup) {\n            // if there's a popup close it and set back the receiver\n            m_completionPopup->close();\n            m_completionReceiver = 0;\n        }\n        return; // we do not suggest \"nothing\"\n    }\n    Q_ASSERT(sender());\n    QLineEdit *toEdit = static_cast<QLineEdit*>(sender());\n    QStringList contacts = m_mainWindow->addressBook()->complete(text, QStringList(), m_completionCount);\n    if (contacts.isEmpty() && m_completionPopup) {\n        m_completionPopup->close();\n        m_completionReceiver = 0;\n    }\n    else {\n        m_completionReceiver = toEdit;\n        m_completionPopup->setUpdatesEnabled(false);\n        m_completionPopup->clear();\n        Q_FOREACH(const QString &s, contacts)\n            m_completionPopup->addAction(s);\n        if (m_completionPopup->isHidden())\n            m_completionPopup->popup(toEdit->mapToGlobal(QPoint(0, toEdit->height())));\n        m_completionPopup->setUpdatesEnabled(true);\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::completeRecipients(const QString &text)\n  {\n      if (text.isEmpty()) {\n          if (m_completionPopup) {\n              // if there's a popup close it and set back the receiver\n              m_completionPopup->close();\n              m_completionReceiver = 0;\n          }\n          return; // we do not suggest \"nothing\"\n      }\n      Q_ASSERT(sender());\n      QLineEdit *toEdit = static_cast<QLineEdit*>(sender());\n      QStringList contacts = m_mainWindow->addressBook()->complete(text, QStringList(), m_completionCount);\n      if (contacts.isEmpty() && m_completionPopup) {\n          m_completionPopup->close();\n          m_completionReceiver = 0;\n      }\n      else {\n          m_completionReceiver = toEdit;\n          m_completionPopup->setUpdatesEnabled(false);\n          m_completionPopup->clear();\n          Q_FOREACH(const QString &s, contacts)\n              m_completionPopup->addAction(s);\n          if (m_completionPopup->isHidden())\n              m_completionPopup->popup(toEdit->mapToGlobal(QPoint(0, toEdit->height())));\n          m_completionPopup->setUpdatesEnabled(true);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "extEdited(QString))"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "extEdited(",
          "args": [
            "String)"
          ],
          "line": 564
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "dit,",
            "IGNAL(textChanged(QString)),",
            "his,",
            "LOT(slotCheckAddress()))"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotCheckAddress())"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotCheckAddress(",
          "args": [],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "slotCheckAddress(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "592-597",
          "snippet": "oid ComposeWidget::slotCheckAddress()\n{\n    QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n    Q_ASSERT(edit);\n    slotCheckAddress(edit);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::slotCheckAddress()\n  {\n      QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n      Q_ASSERT(edit);\n      slotCheckAddress(edit);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "extChanged(QString))"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "extChanged(",
          "args": [
            "String)"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ombo->setCurrentIndex",
          "args": [
            "ombo->findData(kind))"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ombo->findData",
          "args": [
            "ind)"
          ],
          "line": 560
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ombo->addItem",
          "args": [
            "r(\"Bcc\"),",
            "omposer::ADDRESS_BCC)"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Bcc\")"
          ],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ombo->addItem",
          "args": [
            "r(\"Cc\"),",
            "omposer::ADDRESS_CC)"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ombo->addItem",
          "args": [
            "r(\"To\"),",
            "omposer::ADDRESS_TO)"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n  {\n      QComboBox *combo = new QComboBox(this);\n      combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n      combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n      combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n      combo->setCurrentIndex(combo->findData(kind));\n      LineEdit *edit = new LineEdit(address, this);\n      slotCheckAddress(edit);\n      connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n      connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n      connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n      connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n      m_recipients.insert(position, Recipient(combo, edit));\n      ui->envelopeWidget->setUpdatesEnabled(false);\n      ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n      setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n      setTabOrder(combo, edit);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (ui->recipientSlider->isVisible()) {\n          const int v = ui->recipientSlider->value();\n          int keepInSight = ++position;\n          for (int i = 0; i < m_recipients.count(); ++i) {\n              if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                  keepInSight = i;\n                  break;\n              }\n          }\n          if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n              ui->recipientSlider->setValue(position*max/m_recipients.count());\n          if (v == ui->recipientSlider->value()) // force scroll update\n              scrollRecipients(v);\n      }\n      ui->envelopeWidget->setUpdatesEnabled(true);\n  }\n}"
  },
  {
    "function_name": "calculateMaxVisibleRecipients(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "511-552",
    "snippet": "oid ComposeWidget::calculateMaxVisibleRecipients()\n{\n    const int oldMaxVisibleRecipients = m_maxVisibleRecipients;\n    int spacing, bottom;\n    ui->envelopeLayout->getContentsMargins(&spacing, &spacing, &spacing, &bottom);\n    // we abuse the fact that there's always an addressee and that they all look the same\n    QRect itemRects[2];\n    for (int i = 0; i < 2; ++i) {\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::LabelRole)) {\n            itemRects[i] |= li->geometry();\n        }\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::FieldRole)) {\n            itemRects[i] |= li->geometry();\n        }\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::SpanningRole)) {\n            itemRects[i] |= li->geometry();\n        }\n    }\n    int itemHeight = itemRects[0].height();\n    spacing = qMax(0, itemRects[0].top() - itemRects[1].bottom() - 1); // QFormLayout::[vertical]spacing() is useless ...\n    int firstTop = itemRects[0].top();\n    const int subjectHeight = ui->subject->height();\n    const int height = ui->verticalSplitter->sizes().at(0) - // entire splitter area\n                       firstTop - // offset of first recipient\n                       (subjectHeight + spacing) - // for the subject\n                       bottom - // layout bottom padding\n                       2; // extra pixels padding to detect that the user wants to shrink\n    if (itemHeight + spacing == 0) {\n        m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS;\n    } else {\n        m_maxVisibleRecipients = height / (itemHeight + spacing);\n    }\n    if (m_maxVisibleRecipients < MIN_MAX_VISIBLE_RECIPIENTS)\n        m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS; // allow up to 4 recipients w/o need for a sliding\n    if (oldMaxVisibleRecipients != m_maxVisibleRecipients) {\n        const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n        int v = qRound(1.0f*(ui->recipientSlider->value()*m_maxVisibleRecipients)/oldMaxVisibleRecipients);\n        ui->recipientSlider->setMaximum(max);\n        ui->recipientSlider->setVisible(max > 0);\n        scrollRecipients(qMin(qMax(0, v), max));\n    }\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "crollRecipients(",
          "args": [
            "Min(qMax(0, v), max))"
          ],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "scrollRecipients(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "731-791",
          "snippet": "oid ComposeWidget::scrollRecipients(int value)\n{\n    // ignore focus changes caused by \"scrolling\"\n    disconnect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), this, SLOT(handleFocusChange()));\n\n    QList<QWidget*> visibleWidgets;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        // remove all widgets from the form because of vspacing - causes spurious padding\n\n        QWidget *toCC = m_recipients.at(i).first;\n        QWidget *lineEdit = m_recipients.at(i).second;\n        if (!m_lastFocusedRecipient) { // apply only _once_\n            if (toCC->hasFocus())\n                m_lastFocusedRecipient = toCC;\n            else if (lineEdit->hasFocus())\n                m_lastFocusedRecipient = lineEdit;\n        }\n        if (toCC->isVisible())\n            visibleWidgets << toCC;\n        if (lineEdit->isVisible())\n            visibleWidgets << lineEdit;\n        ui->envelopeLayout->removeWidget(toCC);\n        ui->envelopeLayout->removeWidget(lineEdit);\n        toCC->hide();\n        lineEdit->hide();\n    }\n\n    const int begin = qMin(m_recipients.count(), value);\n    const int end   = qMin(m_recipients.count(), value + m_maxVisibleRecipients);\n    for (int i = begin, j = 0; i < end; ++i, ++j) {\n        const int pos = actualRow(ui->envelopeLayout, j + OFFSET_OF_FIRST_ADDRESSEE);\n        QWidget *toCC = m_recipients.at(i).first;\n        QWidget *lineEdit = m_recipients.at(i).second;\n        ui->envelopeLayout->insertRow(pos, toCC, lineEdit);\n        if (!visibleWidgets.contains(toCC))\n            fadeIn(toCC);\n        visibleWidgets.removeOne(toCC);\n        if (!visibleWidgets.contains(lineEdit))\n            fadeIn(lineEdit);\n        visibleWidgets.removeOne(lineEdit);\n        toCC->show();\n        lineEdit->show();\n        setTabOrder(formPredecessor(ui->envelopeLayout, toCC), toCC);\n        setTabOrder(toCC, lineEdit);\n        if (toCC == m_lastFocusedRecipient)\n            toCC->setFocus();\n        else if (lineEdit == m_lastFocusedRecipient)\n            lineEdit->setFocus();\n    }\n\n    if (m_lastFocusedRecipient && !m_lastFocusedRecipient->hasFocus() && QApplication::focusWidget())\n        ui->envelopeWidget->setFocus();\n\n    Q_FOREACH (QWidget *w, visibleWidgets) {\n        // was visible, is no longer -> stop animation so it won't conflict later ones\n        w->setGraphicsEffect(0); // deletes old one\n        if (QPropertyAnimation *pa = w->findChild<QPropertyAnimation*>(trojita_opacityAnimation))\n            pa->stop();\n    }\n    connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::scrollRecipients(int value)\n  {\n      // ignore focus changes caused by \"scrolling\"\n      disconnect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), this, SLOT(handleFocusChange()));\n  \n      QList<QWidget*> visibleWidgets;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          // remove all widgets from the form because of vspacing - causes spurious padding\n  \n          QWidget *toCC = m_recipients.at(i).first;\n          QWidget *lineEdit = m_recipients.at(i).second;\n          if (!m_lastFocusedRecipient) { // apply only _once_\n              if (toCC->hasFocus())\n                  m_lastFocusedRecipient = toCC;\n              else if (lineEdit->hasFocus())\n                  m_lastFocusedRecipient = lineEdit;\n          }\n          if (toCC->isVisible())\n              visibleWidgets << toCC;\n          if (lineEdit->isVisible())\n              visibleWidgets << lineEdit;\n          ui->envelopeLayout->removeWidget(toCC);\n          ui->envelopeLayout->removeWidget(lineEdit);\n          toCC->hide();\n          lineEdit->hide();\n      }\n  \n      const int begin = qMin(m_recipients.count(), value);\n      const int end   = qMin(m_recipients.count(), value + m_maxVisibleRecipients);\n      for (int i = begin, j = 0; i < end; ++i, ++j) {\n          const int pos = actualRow(ui->envelopeLayout, j + OFFSET_OF_FIRST_ADDRESSEE);\n          QWidget *toCC = m_recipients.at(i).first;\n          QWidget *lineEdit = m_recipients.at(i).second;\n          ui->envelopeLayout->insertRow(pos, toCC, lineEdit);\n          if (!visibleWidgets.contains(toCC))\n              fadeIn(toCC);\n          visibleWidgets.removeOne(toCC);\n          if (!visibleWidgets.contains(lineEdit))\n              fadeIn(lineEdit);\n          visibleWidgets.removeOne(lineEdit);\n          toCC->show();\n          lineEdit->show();\n          setTabOrder(formPredecessor(ui->envelopeLayout, toCC), toCC);\n          setTabOrder(toCC, lineEdit);\n          if (toCC == m_lastFocusedRecipient)\n              toCC->setFocus();\n          else if (lineEdit == m_lastFocusedRecipient)\n              lineEdit->setFocus();\n      }\n  \n      if (m_lastFocusedRecipient && !m_lastFocusedRecipient->hasFocus() && QApplication::focusWidget())\n          ui->envelopeWidget->setFocus();\n  \n      Q_FOREACH (QWidget *w, visibleWidgets) {\n          // was visible, is no longer -> stop animation so it won't conflict later ones\n          w->setGraphicsEffect(0); // deletes old one\n          if (QPropertyAnimation *pa = w->findChild<QPropertyAnimation*>(trojita_opacityAnimation))\n              pa->stop();\n      }\n      connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Min(",
          "args": [
            "Max(0, v),",
            "ax)"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Max(",
          "args": [
            ",",
            ")"
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setVisible",
          "args": [
            "ax > 0)"
          ],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "setVisible",
          "container": "FindBar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FindBar.cpp",
          "lines": "134-164",
          "snippet": "void FindBar::setVisible(bool visible)\n{\n    QWidget::setVisible(visible);\n\n    if (!m_associatedWebView)\n        return;\n\n    if (visible) {\n        const QString selectedText = m_associatedWebView->page()->selectedText();\n        if (!hasFocus() && !selectedText.isEmpty()) {\n            const QString previousText = m_lineEdit->text();\n            m_lineEdit->setText(selectedText);\n\n            if (m_lineEdit->text() != previousText) {\n                findPrevious();\n            } else {\n                updateHighlight();\n            }\n        } else if (selectedText.isEmpty()) {\n            emit searchString(m_lineEdit->text());\n        }\n\n        m_lineEdit->setFocus();\n        m_lineEdit->selectAll();\n    } else {\n        updateHighlight();\n\n        // Clear the selection\n        m_associatedWebView->page()->findText(QString());\n    }\n}",
          "includes": [
            "#include \"Gui/Util.h\"",
            "#include \"LineEdit.h\"",
            "#include <QWebView>",
            "#include <QWebFrame>",
            "#include <QToolButton>",
            "#include <QPushButton>",
            "#include <QLabel>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCheckBox>",
            "#include \"FindBar.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Gui/Util.h\"\n#include \"LineEdit.h\"\n#include <QWebView>\n#include <QWebFrame>\n#include <QToolButton>\n#include <QPushButton>\n#include <QLabel>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCheckBox>\n#include \"FindBar.h\"\n\nFindBar {\n  void FindBar::setVisible(bool visible)\n  {\n      QWidget::setVisible(visible);\n  \n      if (!m_associatedWebView)\n          return;\n  \n      if (visible) {\n          const QString selectedText = m_associatedWebView->page()->selectedText();\n          if (!hasFocus() && !selectedText.isEmpty()) {\n              const QString previousText = m_lineEdit->text();\n              m_lineEdit->setText(selectedText);\n  \n              if (m_lineEdit->text() != previousText) {\n                  findPrevious();\n              } else {\n                  updateHighlight();\n              }\n          } else if (selectedText.isEmpty()) {\n              emit searchString(m_lineEdit->text());\n          }\n  \n          m_lineEdit->setFocus();\n          m_lineEdit->selectAll();\n      } else {\n          updateHighlight();\n  \n          // Clear the selection\n          m_associatedWebView->page()->findText(QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setMaximum",
          "args": [
            "ax)"
          ],
          "line": 548
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Round(",
          "args": [
            ".0f*(ui->recipientSlider->value()*m_maxVisibleRecipients)/oldMaxVisibleRecipients)"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->value",
          "args": [],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "333-336",
          "snippet": "QByteArray QMimeMagicRule::value() const\n{\n    return d->value;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QByteArray QMimeMagicRule::value() const\n  {\n      return d->value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Max(",
          "args": [
            ",",
            "_recipients.count() - m_maxVisibleRecipients)"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipients.count",
          "args": [],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "count",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "91-94",
          "snippet": "int FlowLayout::count() const\n{\n    return itemList.size();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  int FlowLayout::count() const\n  {\n      return itemList.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->verticalSplitter->sizes",
          "args": [
            ")"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->verticalSplitter->sizes",
          "args": [],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->height",
          "args": [],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temRects[0].top",
          "args": [],
          "line": 531
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Max(",
          "args": [
            ",",
            "temRects[0].top() - itemRects[1].bottom() - 1)"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temRects[1].bottom",
          "args": [],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temRects[0].top",
          "args": [],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temRects[0].height",
          "args": [],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->geometry",
          "args": [],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->itemAt",
          "args": [
            "FFSET_OF_FIRST_ADDRESSEE - i,",
            "FormLayout::SpanningRole)"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->geometry",
          "args": [],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->itemAt",
          "args": [
            "FFSET_OF_FIRST_ADDRESSEE - i,",
            "FormLayout::FieldRole)"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->geometry",
          "args": [],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->itemAt",
          "args": [
            "FFSET_OF_FIRST_ADDRESSEE - i,",
            "FormLayout::LabelRole)"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->getContentsMargins",
          "args": [
            "spacing,",
            "spacing,",
            "spacing,",
            "bottom)"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::calculateMaxVisibleRecipients()\n  {\n      const int oldMaxVisibleRecipients = m_maxVisibleRecipients;\n      int spacing, bottom;\n      ui->envelopeLayout->getContentsMargins(&spacing, &spacing, &spacing, &bottom);\n      // we abuse the fact that there's always an addressee and that they all look the same\n      QRect itemRects[2];\n      for (int i = 0; i < 2; ++i) {\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::LabelRole)) {\n              itemRects[i] |= li->geometry();\n          }\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::FieldRole)) {\n              itemRects[i] |= li->geometry();\n          }\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::SpanningRole)) {\n              itemRects[i] |= li->geometry();\n          }\n      }\n      int itemHeight = itemRects[0].height();\n      spacing = qMax(0, itemRects[0].top() - itemRects[1].bottom() - 1); // QFormLayout::[vertical]spacing() is useless ...\n      int firstTop = itemRects[0].top();\n      const int subjectHeight = ui->subject->height();\n      const int height = ui->verticalSplitter->sizes().at(0) - // entire splitter area\n                         firstTop - // offset of first recipient\n                         (subjectHeight + spacing) - // for the subject\n                         bottom - // layout bottom padding\n                         2; // extra pixels padding to detect that the user wants to shrink\n      if (itemHeight + spacing == 0) {\n          m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS;\n      } else {\n          m_maxVisibleRecipients = height / (itemHeight + spacing);\n      }\n      if (m_maxVisibleRecipients < MIN_MAX_VISIBLE_RECIPIENTS)\n          m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS; // allow up to 4 recipients w/o need for a sliding\n      if (oldMaxVisibleRecipients != m_maxVisibleRecipients) {\n          const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n          int v = qRound(1.0f*(ui->recipientSlider->value()*m_maxVisibleRecipients)/oldMaxVisibleRecipients);\n          ui->recipientSlider->setMaximum(max);\n          ui->recipientSlider->setVisible(max > 0);\n          scrollRecipients(qMin(qMax(0, v), max));\n      }\n  }\n}"
  },
  {
    "function_name": "ctualRow(",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "456-467",
    "snippet": "tatic int actualRow(QFormLayout *form, int row)\n{\n    for (int i = 0, c = 0; i < form->rowCount(); ++i) {\n        if (c == row) {\n            return i;\n        }\n        if (form->itemAt(i, QFormLayout::LabelRole) || form->itemAt(i, QFormLayout::FieldRole) ||\n            form->itemAt(i, QFormLayout::SpanningRole))\n            ++c;\n    }\n    return form->rowCount(); // append\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "orm->rowCount",
          "args": [],
          "line": 466
        },
        "resolved": true,
        "details": {
          "function_name": "rowCount",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "133-153",
          "snippet": "void ModelTest::rowCount()\n{\n    // check top row\n    QModelIndex topIndex = model->index(0, 0, QModelIndex());\n    int rows = model->rowCount(topIndex);\n    Q_ASSERT(rows >= 0);\n    if (rows > 0)\n        Q_ASSERT(model->hasChildren(topIndex) == true);\n\n    QModelIndex secondLevelIndex = model->index(0, 0, topIndex);\n    if (secondLevelIndex.isValid()) { // not the top level\n        // check a row count where parent is valid\n        rows = model->rowCount(secondLevelIndex);\n        Q_ASSERT(rows >= 0);\n        if (rows > 0)\n            Q_ASSERT(model->hasChildren(secondLevelIndex) == true);\n    }\n\n    // The models rowCount() is tested more extensively in checkChildren(),\n    // but this catches the big mistakes\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::rowCount()\n  {\n      // check top row\n      QModelIndex topIndex = model->index(0, 0, QModelIndex());\n      int rows = model->rowCount(topIndex);\n      Q_ASSERT(rows >= 0);\n      if (rows > 0)\n          Q_ASSERT(model->hasChildren(topIndex) == true);\n  \n      QModelIndex secondLevelIndex = model->index(0, 0, topIndex);\n      if (secondLevelIndex.isValid()) { // not the top level\n          // check a row count where parent is valid\n          rows = model->rowCount(secondLevelIndex);\n          Q_ASSERT(rows >= 0);\n          if (rows > 0)\n              Q_ASSERT(model->hasChildren(secondLevelIndex) == true);\n      }\n  \n      // The models rowCount() is tested more extensively in checkChildren(),\n      // but this catches the big mistakes\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "orm->itemAt",
          "args": [
            ",",
            "FormLayout::SpanningRole)"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orm->itemAt",
          "args": [
            ",",
            "FormLayout::FieldRole)"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "orm->itemAt",
          "args": [
            ",",
            "FormLayout::LabelRole)"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\ntatic int actualRow(QFormLayout *form, int row)\n{\n    for (int i = 0, c = 0; i < form->rowCount(); ++i) {\n        if (c == row) {\n            return i;\n        }\n        if (form->itemAt(i, QFormLayout::LabelRole) || form->itemAt(i, QFormLayout::FieldRole) ||\n            form->itemAt(i, QFormLayout::SpanningRole))\n            ++c;\n    }\n    return form->rowCount(); // append\n}"
  },
  {
    "function_name": "recipientKindForNextRow(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "423-444",
    "snippet": "omposer::RecipientKind ComposeWidget::recipientKindForNextRow(const Composer::RecipientKind kind)\n{\n    using namespace Imap::Mailbox;\n    switch (kind) {\n    case Composer::ADDRESS_TO:\n        // Heuristic: if the last one is \"to\", chances are that the next one shall not be \"to\" as well.\n        // Cc is reasonable here.\n        return Composer::ADDRESS_CC;\n    case Composer::ADDRESS_CC:\n    case Composer::ADDRESS_BCC:\n        // In any other case, it is probably better to just reuse the type of the last row\n        return kind;\n    case Composer::ADDRESS_FROM:\n    case Composer::ADDRESS_SENDER:\n    case Composer::ADDRESS_REPLY_TO:\n        // shall never be used here\n        Q_ASSERT(false);\n        return kind;\n    }\n    Q_ASSERT(false);\n    return Composer::ADDRESS_TO;\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "alse)"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "alse)"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  omposer::RecipientKind ComposeWidget::recipientKindForNextRow(const Composer::RecipientKind kind)\n  {\n      using namespace Imap::Mailbox;\n      switch (kind) {\n      case Composer::ADDRESS_TO:\n          // Heuristic: if the last one is \"to\", chances are that the next one shall not be \"to\" as well.\n          // Cc is reasonable here.\n          return Composer::ADDRESS_CC;\n      case Composer::ADDRESS_CC:\n      case Composer::ADDRESS_BCC:\n          // In any other case, it is probably better to just reuse the type of the last row\n          return kind;\n      case Composer::ADDRESS_FROM:\n      case Composer::ADDRESS_SENDER:\n      case Composer::ADDRESS_REPLY_TO:\n          // shall never be used here\n          Q_ASSERT(false);\n          return kind;\n      }\n      Q_ASSERT(false);\n      return Composer::ADDRESS_TO;\n  }\n}"
  },
  {
    "function_name": "setData(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "379-420",
    "snippet": "oid ComposeWidget::setData(const QList<QPair<Composer::RecipientKind, QString> > &recipients,\n                            const QString &subject, const QString &body, const QList<QByteArray> &inReplyTo,\n                            const QList<QByteArray> &references, const QModelIndex &replyingToMessage)\n{\n    for (int i = 0; i < recipients.size(); ++i) {\n        addRecipient(i, recipients.at(i).first, recipients.at(i).second);\n    }\n    updateRecipientList();\n    ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE, QFormLayout::FieldRole)->widget()->setFocus();\n    ui->subject->setText(subject);\n    const bool wasEdited = m_messageEverEdited;\n    ui->mailText->setText(body);\n    m_messageEverEdited = wasEdited;\n    m_inReplyTo = inReplyTo;\n    m_references = references;\n    m_replyingToMessage = replyingToMessage;\n    if (m_replyingToMessage.isValid()) {\n        m_markButton->show();\n        // Got to use trigger() so that the default action of the QToolButton is updated\n        m_actionInReplyTo->setToolTip(tr(\"This mail will be marked as a response<hr/>%1\").arg(\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n                                          m_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString().toHtmlEscaped()\n#else\n                                          Qt::escape(m_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString())\n#endif\n                                          ));\n        m_actionInReplyTo->trigger();\n    } else {\n        m_markButton->hide();\n        m_actionInReplyTo->setToolTip(QString());\n        m_actionStandalone->trigger();\n    }\n\n    int row = -1;\n    bool ok = Composer::Util::chooseSenderIdentityForReply(m_mainWindow->senderIdentitiesModel(), replyingToMessage, row);\n    if (ok) {\n        Q_ASSERT(row >= 0 && row < m_mainWindow->senderIdentitiesModel()->rowCount());\n        ui->sender->setCurrentIndex(row);\n    }\n\n    slotUpdateSignature();\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "lotUpdateSignature(",
          "args": [],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->setCurrentIndex",
          "args": [
            "ow)"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "ow >= 0 && row < m_mainWindow->senderIdentitiesModel()->rowCount())"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mainWindow->senderIdentitiesModel",
          "args": [],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mainWindow->senderIdentitiesModel",
          "args": [],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "omposer::Util::chooseSenderIdentityForReply(",
          "args": [
            "_mainWindow->senderIdentitiesModel(),",
            "eplyingToMessage,",
            "ow)"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mainWindow->senderIdentitiesModel",
          "args": [],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionStandalone->trigger",
          "args": [],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->setToolTip",
          "args": [
            "String())"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "asPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "261-266",
          "snippet": "String MailAddress::asPrettyString() const\n{\n    return name.isEmpty() ?\n                asSMTPMailbox() :\n                name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  String MailAddress::asPrettyString() const\n  {\n      return name.isEmpty() ?\n                  asSMTPMailbox() :\n                  name + QLatin1Char(' ') + QLatin1Char('<') + asSMTPMailbox() + QLatin1Char('>');\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_markButton->hide",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->trigger",
          "args": [],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->setToolTip",
          "args": [
            "r(\"This mail will be marked as a response<hr/>%1\").arg(\n#if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n                                          m_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString().toHtmlEscaped()\n#else\n                                          Qt::escape(m_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString())\n#endif\n                                          ))"
          ],
          "line": 398
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r",
          "args": [
            "if T_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n                                          m_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString().toHtmlEscaped()\n#else\n                                          Qt::escape(m_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString())\nendif"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "t::escape(",
          "args": [
            "_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString())"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_replyingToMessage.data",
          "args": [],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "ModelTest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/ModelTest/modeltest.cpp",
          "lines": "378-447",
          "snippet": "void ModelTest::data()\n{\n    // Invalid index should return an invalid qvariant\n    Q_ASSERT(!model->data(QModelIndex()).isValid());\n\n    if (model->rowCount() == 0)\n        return;\n\n    // A valid index should have a valid QVariant data\n    Q_ASSERT(model->index(0, 0).isValid());\n\n    // shouldn't be able to set data on an invalid index\n    Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n\n    // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n    // General Purpose roles that should return a QString\n    QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n    variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QString>(variant));\n    }\n\n    // General Purpose roles that should return a QSize\n    variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n    if (variant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QSize>(variant));\n    }\n\n    // General Purpose roles that should return a QFont\n    QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n    if (fontVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n    }\n\n    // Check that the alignment is one we know about\n    QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n    if (textAlignmentVariant.isValid()) {\n        int alignment = textAlignmentVariant.toInt();\n       Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n    }\n\n    // General Purpose roles that should return a QColor\n    QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n\n    colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n    if (colorVariant.isValid()) {\n        Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n    }\n#endif\n\n    // Check that the \"check state\" is one we know about.\n    QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n    if (checkStateVariant.isValid()) {\n        int state = checkStateVariant.toInt();\n        Q_ASSERT(state == Qt::Unchecked ||\n                 state == Qt::PartiallyChecked ||\n                 state == Qt::Checked);\n    }\n}",
          "includes": [
            "#include \"modeltest.h\"",
            "#include \"Imap/Model/ItemRoles.h\"",
            "#include <QtGui/QtGui>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modeltest.h\"\n#include \"Imap/Model/ItemRoles.h\"\n#include <QtGui/QtGui>\n\nModelTest {\n  void ModelTest::data()\n  {\n      // Invalid index should return an invalid qvariant\n      Q_ASSERT(!model->data(QModelIndex()).isValid());\n  \n      if (model->rowCount() == 0)\n          return;\n  \n      // A valid index should have a valid QVariant data\n      Q_ASSERT(model->index(0, 0).isValid());\n  \n      // shouldn't be able to set data on an invalid index\n      Q_ASSERT(model->setData(QModelIndex(), QLatin1String(\"foo\"), Qt::DisplayRole) == false);\n  \n      // TODO: would be cool to have proper support for Qt5 here; Qt5 deprecates qVariantCanConvert\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n      // General Purpose roles that should return a QString\n      QVariant variant = model->data(model->index(0, 0), Qt::ToolTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::StatusTipRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n      variant = model->data(model->index(0, 0), Qt::WhatsThisRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QString>(variant));\n      }\n  \n      // General Purpose roles that should return a QSize\n      variant = model->data(model->index(0, 0), Qt::SizeHintRole);\n      if (variant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QSize>(variant));\n      }\n  \n      // General Purpose roles that should return a QFont\n      QVariant fontVariant = model->data(model->index(0, 0), Qt::FontRole);\n      if (fontVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QFont>(fontVariant));\n      }\n  \n      // Check that the alignment is one we know about\n      QVariant textAlignmentVariant = model->data(model->index(0, 0), Qt::TextAlignmentRole);\n      if (textAlignmentVariant.isValid()) {\n          int alignment = textAlignmentVariant.toInt();\n         Q_ASSERT(alignment == (alignment & (Qt::AlignHorizontal_Mask | Qt::AlignVertical_Mask)));\n      }\n  \n      // General Purpose roles that should return a QColor\n      QVariant colorVariant = model->data(model->index(0, 0), Qt::BackgroundColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  \n      colorVariant = model->data(model->index(0, 0), Qt::TextColorRole);\n      if (colorVariant.isValid()) {\n          Q_ASSERT(qVariantCanConvert<QColor>(colorVariant));\n      }\n  #endif\n  \n      // Check that the \"check state\" is one we know about.\n      QVariant checkStateVariant = model->data(model->index(0, 0), Qt::CheckStateRole);\n      if (checkStateVariant.isValid()) {\n          int state = checkStateVariant.toInt();\n          Q_ASSERT(state == Qt::Unchecked ||\n                   state == Qt::PartiallyChecked ||\n                   state == Qt::Checked);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_replyingToMessage.data",
          "args": [
            "map::Mailbox::RoleMessageSubject)"
          ],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK",
          "args": [],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK",
          "args": [],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK",
          "args": [
            "map::Mailbox::RoleMessageSubject)"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 399
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markButton->show",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_replyingToMessage.isValid",
          "args": [],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->mailText->setText",
          "args": [
            "ody)"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->setText",
          "args": [
            "ubject)"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->itemAt",
          "args": [],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->itemAt",
          "args": [],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeLayout->itemAt",
          "args": [
            "FFSET_OF_FIRST_ADDRESSEE,",
            "FormLayout::FieldRole)"
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdateRecipientList(",
          "args": [],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "updateRecipientList(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "651-670",
          "snippet": "oid ComposeWidget::updateRecipientList()\n{\n    // we ensure there's always one empty available\n    bool haveEmpty = false;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        if (m_recipients.at(i).second->text().isEmpty()) {\n            if (haveEmpty) {\n                removeRecipient(i);\n            }\n            haveEmpty = true;\n        }\n    }\n    if (!haveEmpty) {\n        addRecipient(m_recipients.count(),\n                     m_recipients.isEmpty() ?\n                         Composer::ADDRESS_TO :\n                         recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                     QString());\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::updateRecipientList()\n  {\n      // we ensure there's always one empty available\n      bool haveEmpty = false;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          if (m_recipients.at(i).second->text().isEmpty()) {\n              if (haveEmpty) {\n                  removeRecipient(i);\n              }\n              haveEmpty = true;\n          }\n      }\n      if (!haveEmpty) {\n          addRecipient(m_recipients.count(),\n                       m_recipients.isEmpty() ?\n                           Composer::ADDRESS_TO :\n                           recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                       QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ddRecipient(",
          "args": [
            ",",
            "ecipients.at(i).first,",
            "ecipients.at(i).second)"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "addRecipient(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "554-590",
          "snippet": "oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n{\n    QComboBox *combo = new QComboBox(this);\n    combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n    combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n    combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n    combo->setCurrentIndex(combo->findData(kind));\n    LineEdit *edit = new LineEdit(address, this);\n    slotCheckAddress(edit);\n    connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n    connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n    connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n    connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n    m_recipients.insert(position, Recipient(combo, edit));\n    ui->envelopeWidget->setUpdatesEnabled(false);\n    ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n    setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n    setTabOrder(combo, edit);\n    const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n    ui->recipientSlider->setMaximum(max);\n    ui->recipientSlider->setVisible(max > 0);\n    if (ui->recipientSlider->isVisible()) {\n        const int v = ui->recipientSlider->value();\n        int keepInSight = ++position;\n        for (int i = 0; i < m_recipients.count(); ++i) {\n            if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                keepInSight = i;\n                break;\n            }\n        }\n        if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n            ui->recipientSlider->setValue(position*max/m_recipients.count());\n        if (v == ui->recipientSlider->value()) // force scroll update\n            scrollRecipients(v);\n    }\n    ui->envelopeWidget->setUpdatesEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::addRecipient(int position, Composer::RecipientKind kind, const QString &address)\n  {\n      QComboBox *combo = new QComboBox(this);\n      combo->addItem(tr(\"To\"), Composer::ADDRESS_TO);\n      combo->addItem(tr(\"Cc\"), Composer::ADDRESS_CC);\n      combo->addItem(tr(\"Bcc\"), Composer::ADDRESS_BCC);\n      combo->setCurrentIndex(combo->findData(kind));\n      LineEdit *edit = new LineEdit(address, this);\n      slotCheckAddress(edit);\n      connect(edit, SIGNAL(textChanged(QString)), this, SLOT(slotCheckAddress()));\n      connect(edit, SIGNAL(textEdited(QString)), SLOT(completeRecipients(QString)));\n      connect(edit, SIGNAL(editingFinished()), SLOT(collapseRecipients()));\n      connect(edit, SIGNAL(textChanged(QString)), m_recipientListUpdateTimer, SLOT(start()));\n      m_recipients.insert(position, Recipient(combo, edit));\n      ui->envelopeWidget->setUpdatesEnabled(false);\n      ui->envelopeLayout->insertRow(actualRow(ui->envelopeLayout, position + OFFSET_OF_FIRST_ADDRESSEE), combo, edit);\n      setTabOrder(formPredecessor(ui->envelopeLayout, combo), combo);\n      setTabOrder(combo, edit);\n      const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n      ui->recipientSlider->setMaximum(max);\n      ui->recipientSlider->setVisible(max > 0);\n      if (ui->recipientSlider->isVisible()) {\n          const int v = ui->recipientSlider->value();\n          int keepInSight = ++position;\n          for (int i = 0; i < m_recipients.count(); ++i) {\n              if (m_recipients.at(i).first->hasFocus() || m_recipients.at(i).second->hasFocus()) {\n                  keepInSight = i;\n                  break;\n              }\n          }\n          if (qAbs(keepInSight - position) < m_maxVisibleRecipients)\n              ui->recipientSlider->setValue(position*max/m_recipients.count());\n          if (v == ui->recipientSlider->value()) // force scroll update\n              scrollRecipients(v);\n      }\n      ui->envelopeWidget->setUpdatesEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecipients.at",
          "args": [
            ")"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecipients.at",
          "args": [
            ")"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecipients.size",
          "args": [],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::setData(const QList<QPair<Composer::RecipientKind, QString> > &recipients,\n                              const QString &subject, const QString &body, const QList<QByteArray> &inReplyTo,\n                              const QList<QByteArray> &references, const QModelIndex &replyingToMessage)\n  {\n      for (int i = 0; i < recipients.size(); ++i) {\n          addRecipient(i, recipients.at(i).first, recipients.at(i).second);\n      }\n      updateRecipientList();\n      ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE, QFormLayout::FieldRole)->widget()->setFocus();\n      ui->subject->setText(subject);\n      const bool wasEdited = m_messageEverEdited;\n      ui->mailText->setText(body);\n      m_messageEverEdited = wasEdited;\n      m_inReplyTo = inReplyTo;\n      m_references = references;\n      m_replyingToMessage = replyingToMessage;\n      if (m_replyingToMessage.isValid()) {\n          m_markButton->show();\n          // Got to use trigger() so that the default action of the QToolButton is updated\n          m_actionInReplyTo->setToolTip(tr(\"This mail will be marked as a response<hr/>%1\").arg(\n  #if QT_VERSION >= QT_VERSION_CHECK(5, 0, 0)\n                                            m_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString().toHtmlEscaped()\n  #else\n                                            Qt::escape(m_replyingToMessage.data(Imap::Mailbox::RoleMessageSubject).toString())\n  #endif\n                                            ));\n          m_actionInReplyTo->trigger();\n      } else {\n          m_markButton->hide();\n          m_actionInReplyTo->setToolTip(QString());\n          m_actionStandalone->trigger();\n      }\n  \n      int row = -1;\n      bool ok = Composer::Util::chooseSenderIdentityForReply(m_mainWindow->senderIdentitiesModel(), replyingToMessage, row);\n      if (ok) {\n          Q_ASSERT(row >= 0 && row < m_mainWindow->senderIdentitiesModel()->rowCount());\n          ui->sender->setCurrentIndex(row);\n      }\n  \n      slotUpdateSignature();\n  }\n}"
  },
  {
    "function_name": "setUiWidgetsEnabled(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "372-376",
    "snippet": "oid ComposeWidget::setUiWidgetsEnabled(const bool enabled)\n{\n    ui->splitter->setEnabled(enabled);\n    ui->buttonBox->setEnabled(enabled);\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "i->buttonBox->setEnabled",
          "args": [
            "nabled)"
          ],
          "line": 375
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->splitter->setEnabled",
          "args": [
            "nabled)"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::setUiWidgetsEnabled(const bool enabled)\n  {\n      ui->splitter->setEnabled(enabled);\n      ui->buttonBox->setEnabled(enabled);\n  }\n}"
  },
  {
    "function_name": "send(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "338-370",
    "snippet": "oid ComposeWidget::send()\n{\n    // Well, Trojita is of course rock solid and will never ever crash :), but experience has shown that every now and then,\n    // there is a subtle issue $somewhere. This means that it's probably a good idea to save the draft explicitly -- better\n    // than losing some work. It's cheap anyway.\n    saveDraft(m_autoSavePath);\n\n    if (!buildMessageData())\n        return;\n\n    m_submission->setImapOptions(m_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),\n                                 m_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),\n                                 m_settings->value(Common::SettingsNames::imapHostKey).toString(),\n                                 m_settings->value(Common::SettingsNames::imapUserKey).toString(),\n                                 m_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail);\n    m_submission->setSmtpOptions(m_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),\n                                 m_settings->value(Common::SettingsNames::smtpUserKey).toString());\n\n\n    ProgressPopUp *progress = new ProgressPopUp();\n    OverlayWidget *overlay = new OverlayWidget(progress, this);\n    overlay->show();\n    setUiWidgetsEnabled(false);\n\n    connect(m_submission, SIGNAL(progressMin(int)), progress, SLOT(setMinimum(int)));\n    connect(m_submission, SIGNAL(progressMax(int)), progress, SLOT(setMaximum(int)));\n    connect(m_submission, SIGNAL(progress(int)), progress, SLOT(setValue(int)));\n    connect(m_submission, SIGNAL(updateStatusMessage(QString)), progress, SLOT(setLabelText(QString)));\n    connect(m_submission, SIGNAL(succeeded()), overlay, SLOT(deleteLater()));\n    connect(m_submission, SIGNAL(failed(QString)), overlay, SLOT(deleteLater()));\n\n    m_submission->send();\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_submission->send",
          "args": [],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_submission,",
            "IGNAL(failed(QString)),",
            "verlay,",
            "LOT(deleteLater()))"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ailed(QString))"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailed(",
          "args": [
            "String)"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "authenticationFailed(const QS",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1103-1107",
          "snippet": "Window::authenticationFailed(const QString &message)\n{\n    m_ignoreStoredPassword = true;\n    QMessageBox::warning(this, tr(\"Login Failed\"), message);\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::authenticationFailed(const QString &message)\n  {\n      m_ignoreStoredPassword = true;\n      QMessageBox::warning(this, tr(\"Login Failed\"), message);\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_submission,",
            "IGNAL(succeeded()),",
            "verlay,",
            "LOT(deleteLater()))"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "eleteLater())"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eleteLater(",
          "args": [],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ucceeded())"
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ucceeded(",
          "args": [],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendSucceeded(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "347-364",
          "snippet": "oid Submission::slotAppendSucceeded()\n{\n    if (m_appendUid && m_appendUidValidity) {\n        // Only ever consider valid UIDVALIDITY/UID pair\n        m_appendUidReceived = true;\n\n        if (m_useBurl) {\n            slotAskForUrl();\n        } else {\n            slotInvokeMsaNow();\n        }\n    } else {\n        m_useBurl = false;\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                          QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n        slotInvokeMsaNow();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendSucceeded()\n  {\n      if (m_appendUid && m_appendUidValidity) {\n          // Only ever consider valid UIDVALIDITY/UID pair\n          m_appendUidReceived = true;\n  \n          if (m_useBurl) {\n              slotAskForUrl();\n          } else {\n              slotInvokeMsaNow();\n          }\n      } else {\n          m_useBurl = false;\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                            QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n          slotInvokeMsaNow();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_submission,",
            "IGNAL(updateStatusMessage(QString)),",
            "rogress,",
            "LOT(setLabelText(QString)))"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "etLabelText(QString))"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etLabelText(",
          "args": [
            "String)"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "setLabelText(",
          "container": "rogressPopUp",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ProgressPopUp.cpp",
          "lines": "67-70",
          "snippet": "oid ProgressPopUp::setLabelText(const QString &text)\n{\n    ui->label->setText(text);\n}",
          "includes": [
            "include \"ui_ProgressPopUp.h\"",
            "include \"ProgressPopUp.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"ui_ProgressPopUp.h\"\ninclude \"ProgressPopUp.h\"\n#\n\nrogressPopUp {\n  oid ProgressPopUp::setLabelText(const QString &text)\n  {\n      ui->label->setText(text);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "pdateStatusMessage(QString))"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdateStatusMessage(",
          "args": [
            "String)"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etUiWidgetsEnabled(",
          "args": [
            "alse)"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "setUiWidgetsEnabled(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "372-376",
          "snippet": "oid ComposeWidget::setUiWidgetsEnabled(const bool enabled)\n{\n    ui->splitter->setEnabled(enabled);\n    ui->buttonBox->setEnabled(enabled);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::setUiWidgetsEnabled(const bool enabled)\n  {\n      ui->splitter->setEnabled(enabled);\n      ui->buttonBox->setEnabled(enabled);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "verlay->show",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->setSmtpOptions",
          "args": [
            "_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),",
            "_settings->value(Common::SettingsNames::smtpUserKey).toString())"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_settings->value",
          "args": [],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "333-336",
          "snippet": "QByteArray QMimeMagicRule::value() const\n{\n    return d->value;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QByteArray QMimeMagicRule::value() const\n  {\n      return d->value;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_settings->value",
          "args": [
            "ommon::SettingsNames::smtpUserKey)"
          ],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "value",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "187-205",
          "snippet": "QVariant XSqlQuery::value(const QString & name) const\n{\n    if (name.isEmpty())\n        return QVariant();\n\n    if (_data && !_data->_currRecord.isEmpty())\n    {\n        int i = _data->_currRecord.indexOf(name);\n        if(i<0)\n        {\n            QString err = \"Column \" + name + \" not found in record\";\n            qWarning(\"%s\", err.toLocal8Bit().constData());\n            return QVariant(_nameErrorValue);\n        }\n        return value(_data->_currRecord.indexOf(name));\n    }\n\n    return QVariant();\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [
            "static QString _nameErrorValue;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nstatic QString _nameErrorValue;\n\nXSqlQuery {\n  QVariant XSqlQuery::value(const QString & name) const\n  {\n      if (name.isEmpty())\n          return QVariant();\n  \n      if (_data && !_data->_currRecord.isEmpty())\n      {\n          int i = _data->_currRecord.indexOf(name);\n          if(i<0)\n          {\n              QString err = \"Column \" + name + \" not found in record\";\n              qWarning(\"%s\", err.toLocal8Bit().constData());\n              return QVariant(_nameErrorValue);\n          }\n          return value(_data->_currRecord.indexOf(name));\n      }\n  \n      return QVariant();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_settings->value",
          "args": [
            "ommon::SettingsNames::smtpUseBurlKey,",
            "alse)"
          ],
          "line": 353
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->setImapOptions",
          "args": [
            "_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),",
            "_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),",
            "_settings->value(Common::SettingsNames::imapHostKey).toString(),",
            "_settings->value(Common::SettingsNames::imapUserKey).toString(),",
            "_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail)"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_settings->value",
          "args": [
            "ommon::SettingsNames::composerImapSentKey,",
            "r(\"Sent\"))"
          ],
          "line": 349
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Sent\")"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_settings->value",
          "args": [
            "ommon::SettingsNames::composerSaveToImapKey,",
            "rue)"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uildMessageData(",
          "args": [],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "buildMessageData(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "284-336",
          "snippet": "ool ComposeWidget::buildMessageData()\n{\n    QList<QPair<Composer::RecipientKind,Imap::Message::MailAddress> > recipients;\n    QString errorMessage;\n    if (!parseRecipients(recipients, errorMessage)) {\n        gotError(tr(\"Cannot parse recipients:\\n%1\").arg(errorMessage));\n        return false;\n    }\n    if (recipients.isEmpty()) {\n        gotError(tr(\"You haven't entered any recipients\"));\n        return false;\n    }\n    m_submission->composer()->setRecipients(recipients);\n\n    Imap::Message::MailAddress fromAddress;\n    if (!Imap::Message::MailAddress::fromPrettyString(fromAddress, ui->sender->currentText())) {\n        gotError(tr(\"The From: address does not look like a valid one\"));\n        return false;\n    }\n    if (ui->subject->text().isEmpty()) {\n        gotError(tr(\"You haven't entered any subject. Cannot send such a mail, sorry.\"));\n        ui->subject->setFocus();\n        return false;\n    }\n    m_submission->composer()->setFrom(fromAddress);\n\n    m_submission->composer()->setTimestamp(QDateTime::currentDateTime());\n    m_submission->composer()->setSubject(ui->subject->text());\n\n    QAbstractProxyModel *proxy = qobject_cast<QAbstractProxyModel*>(ui->sender->model());\n    Q_ASSERT(proxy);\n\n    if (ui->sender->findText(ui->sender->currentText()) != -1) {\n        QModelIndex proxyIndex = ui->sender->model()->index(ui->sender->currentIndex(), 0, ui->sender->rootModelIndex());\n        Q_ASSERT(proxyIndex.isValid());\n        m_submission->composer()->setOrganization(\n                    proxy->mapToSource(proxyIndex).sibling(proxyIndex.row(), Composer::SenderIdentitiesModel::COLUMN_ORGANIZATION)\n                    .data().toString());\n    }\n    m_submission->composer()->setText(ui->mailText->toPlainText());\n\n    if (m_actionInReplyTo->isChecked()) {\n        m_submission->composer()->setInReplyTo(m_inReplyTo);\n        m_submission->composer()->setReferences(m_references);\n        m_submission->composer()->setReplyingToMessage(m_replyingToMessage);\n    } else {\n        m_submission->composer()->setInReplyTo(QList<QByteArray>());\n        m_submission->composer()->setReferences(QList<QByteArray>());\n        m_submission->composer()->setReplyingToMessage(QModelIndex());\n    }\n\n    return m_submission->composer()->isReadyForSerialization();\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  ool ComposeWidget::buildMessageData()\n  {\n      QList<QPair<Composer::RecipientKind,Imap::Message::MailAddress> > recipients;\n      QString errorMessage;\n      if (!parseRecipients(recipients, errorMessage)) {\n          gotError(tr(\"Cannot parse recipients:\\n%1\").arg(errorMessage));\n          return false;\n      }\n      if (recipients.isEmpty()) {\n          gotError(tr(\"You haven't entered any recipients\"));\n          return false;\n      }\n      m_submission->composer()->setRecipients(recipients);\n  \n      Imap::Message::MailAddress fromAddress;\n      if (!Imap::Message::MailAddress::fromPrettyString(fromAddress, ui->sender->currentText())) {\n          gotError(tr(\"The From: address does not look like a valid one\"));\n          return false;\n      }\n      if (ui->subject->text().isEmpty()) {\n          gotError(tr(\"You haven't entered any subject. Cannot send such a mail, sorry.\"));\n          ui->subject->setFocus();\n          return false;\n      }\n      m_submission->composer()->setFrom(fromAddress);\n  \n      m_submission->composer()->setTimestamp(QDateTime::currentDateTime());\n      m_submission->composer()->setSubject(ui->subject->text());\n  \n      QAbstractProxyModel *proxy = qobject_cast<QAbstractProxyModel*>(ui->sender->model());\n      Q_ASSERT(proxy);\n  \n      if (ui->sender->findText(ui->sender->currentText()) != -1) {\n          QModelIndex proxyIndex = ui->sender->model()->index(ui->sender->currentIndex(), 0, ui->sender->rootModelIndex());\n          Q_ASSERT(proxyIndex.isValid());\n          m_submission->composer()->setOrganization(\n                      proxy->mapToSource(proxyIndex).sibling(proxyIndex.row(), Composer::SenderIdentitiesModel::COLUMN_ORGANIZATION)\n                      .data().toString());\n      }\n      m_submission->composer()->setText(ui->mailText->toPlainText());\n  \n      if (m_actionInReplyTo->isChecked()) {\n          m_submission->composer()->setInReplyTo(m_inReplyTo);\n          m_submission->composer()->setReferences(m_references);\n          m_submission->composer()->setReplyingToMessage(m_replyingToMessage);\n      } else {\n          m_submission->composer()->setInReplyTo(QList<QByteArray>());\n          m_submission->composer()->setReferences(QList<QByteArray>());\n          m_submission->composer()->setReplyingToMessage(QModelIndex());\n      }\n  \n      return m_submission->composer()->isReadyForSerialization();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "aveDraft(",
          "args": [
            "_autoSavePath)"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::send()\n  {\n      // Well, Trojita is of course rock solid and will never ever crash :), but experience has shown that every now and then,\n      // there is a subtle issue $somewhere. This means that it's probably a good idea to save the draft explicitly -- better\n      // than losing some work. It's cheap anyway.\n      saveDraft(m_autoSavePath);\n  \n      if (!buildMessageData())\n          return;\n  \n      m_submission->setImapOptions(m_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),\n                                   m_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),\n                                   m_settings->value(Common::SettingsNames::imapHostKey).toString(),\n                                   m_settings->value(Common::SettingsNames::imapUserKey).toString(),\n                                   m_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail);\n      m_submission->setSmtpOptions(m_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),\n                                   m_settings->value(Common::SettingsNames::smtpUserKey).toString());\n  \n  \n      ProgressPopUp *progress = new ProgressPopUp();\n      OverlayWidget *overlay = new OverlayWidget(progress, this);\n      overlay->show();\n      setUiWidgetsEnabled(false);\n  \n      connect(m_submission, SIGNAL(progressMin(int)), progress, SLOT(setMinimum(int)));\n      connect(m_submission, SIGNAL(progressMax(int)), progress, SLOT(setMaximum(int)));\n      connect(m_submission, SIGNAL(progress(int)), progress, SLOT(setValue(int)));\n      connect(m_submission, SIGNAL(updateStatusMessage(QString)), progress, SLOT(setLabelText(QString)));\n      connect(m_submission, SIGNAL(succeeded()), overlay, SLOT(deleteLater()));\n      connect(m_submission, SIGNAL(failed(QString)), overlay, SLOT(deleteLater()));\n  \n      m_submission->send();\n  }\n}"
  },
  {
    "function_name": "buildMessageData(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "284-336",
    "snippet": "ool ComposeWidget::buildMessageData()\n{\n    QList<QPair<Composer::RecipientKind,Imap::Message::MailAddress> > recipients;\n    QString errorMessage;\n    if (!parseRecipients(recipients, errorMessage)) {\n        gotError(tr(\"Cannot parse recipients:\\n%1\").arg(errorMessage));\n        return false;\n    }\n    if (recipients.isEmpty()) {\n        gotError(tr(\"You haven't entered any recipients\"));\n        return false;\n    }\n    m_submission->composer()->setRecipients(recipients);\n\n    Imap::Message::MailAddress fromAddress;\n    if (!Imap::Message::MailAddress::fromPrettyString(fromAddress, ui->sender->currentText())) {\n        gotError(tr(\"The From: address does not look like a valid one\"));\n        return false;\n    }\n    if (ui->subject->text().isEmpty()) {\n        gotError(tr(\"You haven't entered any subject. Cannot send such a mail, sorry.\"));\n        ui->subject->setFocus();\n        return false;\n    }\n    m_submission->composer()->setFrom(fromAddress);\n\n    m_submission->composer()->setTimestamp(QDateTime::currentDateTime());\n    m_submission->composer()->setSubject(ui->subject->text());\n\n    QAbstractProxyModel *proxy = qobject_cast<QAbstractProxyModel*>(ui->sender->model());\n    Q_ASSERT(proxy);\n\n    if (ui->sender->findText(ui->sender->currentText()) != -1) {\n        QModelIndex proxyIndex = ui->sender->model()->index(ui->sender->currentIndex(), 0, ui->sender->rootModelIndex());\n        Q_ASSERT(proxyIndex.isValid());\n        m_submission->composer()->setOrganization(\n                    proxy->mapToSource(proxyIndex).sibling(proxyIndex.row(), Composer::SenderIdentitiesModel::COLUMN_ORGANIZATION)\n                    .data().toString());\n    }\n    m_submission->composer()->setText(ui->mailText->toPlainText());\n\n    if (m_actionInReplyTo->isChecked()) {\n        m_submission->composer()->setInReplyTo(m_inReplyTo);\n        m_submission->composer()->setReferences(m_references);\n        m_submission->composer()->setReplyingToMessage(m_replyingToMessage);\n    } else {\n        m_submission->composer()->setInReplyTo(QList<QByteArray>());\n        m_submission->composer()->setReferences(QList<QByteArray>());\n        m_submission->composer()->setReplyingToMessage(QModelIndex());\n    }\n\n    return m_submission->composer()->isReadyForSerialization();\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "ModelIndex())"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ModelIndex(",
          "args": [],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "List<QByteArray>())"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "List<QByteArray>",
          "args": [],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "updateRecipientList(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "651-670",
          "snippet": "oid ComposeWidget::updateRecipientList()\n{\n    // we ensure there's always one empty available\n    bool haveEmpty = false;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        if (m_recipients.at(i).second->text().isEmpty()) {\n            if (haveEmpty) {\n                removeRecipient(i);\n            }\n            haveEmpty = true;\n        }\n    }\n    if (!haveEmpty) {\n        addRecipient(m_recipients.count(),\n                     m_recipients.isEmpty() ?\n                         Composer::ADDRESS_TO :\n                         recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                     QString());\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::updateRecipientList()\n  {\n      // we ensure there's always one empty available\n      bool haveEmpty = false;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          if (m_recipients.at(i).second->text().isEmpty()) {\n              if (haveEmpty) {\n                  removeRecipient(i);\n              }\n              haveEmpty = true;\n          }\n      }\n      if (!haveEmpty) {\n          addRecipient(m_recipients.count(),\n                       m_recipients.isEmpty() ?\n                           Composer::ADDRESS_TO :\n                           recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                       QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "List<QByteArray>())"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "_replyingToMessage)"
          ],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "_references)"
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "_inReplyTo)"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->isChecked",
          "args": [],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "i->mailText->toPlainText())"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->mailText->toPlainText",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "roxy->mapToSource(proxyIndex).sibling(proxyIndex.row(), Composer::SenderIdentitiesModel::COLUMN_ORGANIZATION)\n                    .data().toString())"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->mapToSource",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->mapToSource",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->mapToSource",
          "args": [
            "roxyIndex.row(),",
            "omposer::SenderIdentitiesModel::COLUMN_ORGANIZATION)"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.row",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->mapToSource",
          "args": [
            "roxyIndex)"
          ],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "roxyIndex.isValid())"
          ],
          "line": 318
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxyIndex.isValid",
          "args": [],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "isValid",
          "container": "QMimeXMLProvider",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimeprovider.cpp",
          "lines": "681-684",
          "snippet": "bool QMimeXMLProvider::isValid()\n{\n    return true;\n}",
          "includes": [
            "#include <QtEndian>",
            "#include <QDateTime>",
            "#include <QDebug>",
            "#include <QByteArrayMatcher>",
            "#include <QFile>",
            "#include <QDir>",
            "#include <QXmlStreamReader>",
            "#include \"qmimemagicrulematcher_p.h\"",
            "#include <qstandardpaths.h>",
            "#include \"qmimetypeparser_p.h\"",
            "#include \"qmimeprovider_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtEndian>\n#include <QDateTime>\n#include <QDebug>\n#include <QByteArrayMatcher>\n#include <QFile>\n#include <QDir>\n#include <QXmlStreamReader>\n#include \"qmimemagicrulematcher_p.h\"\n#include <qstandardpaths.h>\n#include \"qmimetypeparser_p.h\"\n#include \"qmimeprovider_p.h\"\n\nQMimeXMLProvider {\n  bool QMimeXMLProvider::isValid()\n  {\n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->sender->model",
          "args": [
            "i->sender->currentIndex(),",
            ",",
            "i->sender->rootModelIndex())"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->rootModelIndex",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->currentIndex",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->model",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->findText",
          "args": [
            "i->sender->currentText())"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->currentText",
          "args": [],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "roxy)"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "object_cast<QAbstractProxyModel*>",
          "args": [
            "i->sender->model())"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->model",
          "args": [],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "i->subject->text())"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->text",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "DateTime::currentDateTime())"
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTime::currentDateTime(",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "romAddress)"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->setFocus",
          "args": [],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "otError(",
          "args": [
            "r(\"You haven't entered any subject. Cannot send such a mail, sorry.\"))"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->subject->text",
          "args": [],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->text",
          "args": [],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "map::Message::MailAddress::fromPrettyString(",
          "args": [
            "romAddress,",
            "i->sender->currentText())"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "fromPrettyString(",
          "container": "ailAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/MailAddress.cpp",
          "lines": "41-52",
          "snippet": "ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n{\n    int offset = 0;\n\n    if (!parseOneAddress(into, address, offset))\n        return false;\n\n    if (offset < address.size())\n        return false;\n\n    return true;\n}",
          "includes": [
            "include \"../Parser/Rfc5322HeaderParser.h\"",
            "include \"../Encoders.h\"\n#",
            "include \"../Model/MailboxTree.h\"\n#",
            "include \"MailAddress.h\"\n#",
            "include <QTextCodec>\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QTextDocument>\n#",
            "include <typeinfo>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Parser/Rfc5322HeaderParser.h\"\ninclude \"../Encoders.h\"\n#\ninclude \"../Model/MailboxTree.h\"\n#\ninclude \"MailAddress.h\"\n#\ninclude <QTextCodec>\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QTextDocument>\n#\ninclude <typeinfo>\n\nailAddress {\n  ool MailAddress::fromPrettyString(MailAddress &into, const QString &address)\n  {\n      int offset = 0;\n  \n      if (!parseOneAddress(into, address, offset))\n          return false;\n  \n      if (offset < address.size())\n          return false;\n  \n      return true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->sender->currentText",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [
            "ecipients)"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecipients.isEmpty",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arseRecipients(",
          "args": [
            "ecipients,",
            "rrorMessage)"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "parseRecipients(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "830-850",
          "snippet": "ool ComposeWidget::parseRecipients(QList<QPair<Composer::RecipientKind, Imap::Message::MailAddress> > &results, QString &errorMessage)\n{\n    for (int i = 0; i < m_recipients.size(); ++i) {\n        Composer::RecipientKind kind = currentRecipient(m_recipients.at(i).first);\n\n        QString text = m_recipients.at(i).second->text();\n        if (text.isEmpty())\n            continue;\n        Imap::Message::MailAddress addr;\n        bool ok = Imap::Message::MailAddress::fromPrettyString(addr, text);\n        if (ok) {\n            // TODO: should we *really* learn every junk entered into a recipient field?\n            // m_mainWindow->addressBook()->learn(addr);\n            results << qMakePair(kind, addr);\n        } else {\n            errorMessage = tr(\"Can't parse \\\"%1\\\" as an e-mail address.\").arg(text);\n            return false;\n        }\n    }\n    return true;\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  ool ComposeWidget::parseRecipients(QList<QPair<Composer::RecipientKind, Imap::Message::MailAddress> > &results, QString &errorMessage)\n  {\n      for (int i = 0; i < m_recipients.size(); ++i) {\n          Composer::RecipientKind kind = currentRecipient(m_recipients.at(i).first);\n  \n          QString text = m_recipients.at(i).second->text();\n          if (text.isEmpty())\n              continue;\n          Imap::Message::MailAddress addr;\n          bool ok = Imap::Message::MailAddress::fromPrettyString(addr, text);\n          if (ok) {\n              // TODO: should we *really* learn every junk entered into a recipient field?\n              // m_mainWindow->addressBook()->learn(addr);\n              results << qMakePair(kind, addr);\n          } else {\n              errorMessage = tr(\"Can't parse \\\"%1\\\" as an e-mail address.\").arg(text);\n              return false;\n          }\n      }\n      return true;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  ool ComposeWidget::buildMessageData()\n  {\n      QList<QPair<Composer::RecipientKind,Imap::Message::MailAddress> > recipients;\n      QString errorMessage;\n      if (!parseRecipients(recipients, errorMessage)) {\n          gotError(tr(\"Cannot parse recipients:\\n%1\").arg(errorMessage));\n          return false;\n      }\n      if (recipients.isEmpty()) {\n          gotError(tr(\"You haven't entered any recipients\"));\n          return false;\n      }\n      m_submission->composer()->setRecipients(recipients);\n  \n      Imap::Message::MailAddress fromAddress;\n      if (!Imap::Message::MailAddress::fromPrettyString(fromAddress, ui->sender->currentText())) {\n          gotError(tr(\"The From: address does not look like a valid one\"));\n          return false;\n      }\n      if (ui->subject->text().isEmpty()) {\n          gotError(tr(\"You haven't entered any subject. Cannot send such a mail, sorry.\"));\n          ui->subject->setFocus();\n          return false;\n      }\n      m_submission->composer()->setFrom(fromAddress);\n  \n      m_submission->composer()->setTimestamp(QDateTime::currentDateTime());\n      m_submission->composer()->setSubject(ui->subject->text());\n  \n      QAbstractProxyModel *proxy = qobject_cast<QAbstractProxyModel*>(ui->sender->model());\n      Q_ASSERT(proxy);\n  \n      if (ui->sender->findText(ui->sender->currentText()) != -1) {\n          QModelIndex proxyIndex = ui->sender->model()->index(ui->sender->currentIndex(), 0, ui->sender->rootModelIndex());\n          Q_ASSERT(proxyIndex.isValid());\n          m_submission->composer()->setOrganization(\n                      proxy->mapToSource(proxyIndex).sibling(proxyIndex.row(), Composer::SenderIdentitiesModel::COLUMN_ORGANIZATION)\n                      .data().toString());\n      }\n      m_submission->composer()->setText(ui->mailText->toPlainText());\n  \n      if (m_actionInReplyTo->isChecked()) {\n          m_submission->composer()->setInReplyTo(m_inReplyTo);\n          m_submission->composer()->setReferences(m_references);\n          m_submission->composer()->setReplyingToMessage(m_replyingToMessage);\n      } else {\n          m_submission->composer()->setInReplyTo(QList<QByteArray>());\n          m_submission->composer()->setReferences(QList<QByteArray>());\n          m_submission->composer()->setReplyingToMessage(QModelIndex());\n      }\n  \n      return m_submission->composer()->isReadyForSerialization();\n  }\n}"
  },
  {
    "function_name": "passwordRequested(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "191-280",
    "snippet": "oid ComposeWidget::passwordRequested(const QString &user, const QString &host)\n{\n    bool ok;\n    const QString &password = Gui::PasswordDialog::getPassword(this, tr(\"Authentication Required\"),\n                                           tr(\"<p>Please provide SMTP password for user <b>%1</b> on <b>%2</b>:</p>\").arg(\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                                               Qt::escape(user),\n                                               Qt::escape(host)\n#else\n                                               user.toHtmlEscaped(),\n                                               host.toHtmlEscaped()\n#endif\n                                               ),\n                                           QString(), &ok);\n    if (ok)\n        m_submission->setPassword(password);\n    else\n        m_submission->cancelPassword();\n}\n\nvoid ComposeWidget::changeEvent(QEvent *e)\n{\n    QWidget::changeEvent(e);\n    switch (e->type()) {\n    case QEvent::LanguageChange:\n        ui->retranslateUi(this);\n        break;\n    default:\n        break;\n    }\n}\n\n/**\n * We capture the close event and check whether there's something to save\n * (not sent, not up-to-date or persistent autostore)\n * The offer the user to store or omit the message or not close at all\n */\n\nvoid ComposeWidget::closeEvent(QCloseEvent *ce)\n{\n    const bool noSaveRequired = m_sentMail || ui->mailText->document()->isEmpty() || !m_messageEverEdited ||\n                                (m_explicitDraft && !m_messageUpdated); // autosave to permanent draft and no update\n    if (!noSaveRequired) {  // save is required\n        QMessageBox msgBox(this);\n        msgBox.setWindowModality(Qt::WindowModal);\n        msgBox.setWindowTitle(tr(\"Save Draft?\"));\n        QString message(tr(\"The mail has not been sent.<br>Do you want to save the draft?\"));\n        if (ui->attachmentsView->model()->rowCount() > 0)\n            message += tr(\"<br><span style=\\\"color:red\\\">Warning: Attachments are <b>not</b> saved with the draft!</span>\");\n        msgBox.setText(message);\n        msgBox.setStandardButtons(QMessageBox::Save | QMessageBox::Discard | QMessageBox::Cancel);\n        msgBox.setDefaultButton(QMessageBox::Save);\n        int ret = msgBox.exec();\n        if (ret == QMessageBox::Save) {\n            if (m_explicitDraft) { // editing a present draft - override it\n                saveDraft(m_autoSavePath);\n            } else {\n                // Explicitly stored drafts should be saved in a location with proper i18n support, so let's make sure both main\n                // window and this code uses the same tr() calls\n                QString path(Common::writablePath(Common::LOCATION_DATA) + Gui::MainWindow::tr(\"Drafts\"));\n                QDir().mkpath(path);\n                QString filename = ui->subject->text();\n                if (filename.isEmpty()) {\n                    filename = QDateTime::currentDateTime().toString(Qt::ISODate);\n                }\n                // Some characters are best avoided in file names. This is probably not a definitive list, but the hope is that\n                // it's going to be more readable than an unformatted hash or similar stuff.  The list of characters was taken\n                // from http://en.wikipedia.org/wiki/Filename#Reserved_characters_and_words .\n                filename.replace(QRegExp(QLatin1String(\"[/\\\\\\\\:\\\"|<>*?]\")), QLatin1String(\"_\"));\n                path = QFileDialog::getSaveFileName(this, tr(\"Save as\"), path + QLatin1Char('/') + filename + QLatin1String(\".draft\"),\n                                                    tr(\"Drafts\") + QLatin1String(\" (*.draft)\"));\n                if (path.isEmpty()) { // cancelled save\n                    ret = QMessageBox::Cancel;\n                } else {\n                    m_explicitDraft = true;\n                    saveDraft(path);\n                    if (path != m_autoSavePath) // we can remove the temp save\n                        QFile::remove(m_autoSavePath);\n                }\n            }\n        }\n        if (ret == QMessageBox::Cancel) {\n            ce->ignore(); // don't close the window\n            return;\n        }\n    }\n    if (m_sentMail || !m_explicitDraft) // is the mail has been sent or the user does not want to store it\n        QFile::remove(m_autoSavePath); // get rid of draft\n    ce->accept(); // ultimately close the window\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "e->accept",
          "args": [],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "ShortcutHandler",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ShortcutHandler/ShortcutHandler.cpp",
          "lines": "175-178",
          "snippet": "void ShortcutHandler::accept()\n{\n    m_shortcutConfigWidget->accept();\n}",
          "includes": [
            "#include \"Common/SettingsCategoryGuard.h\"",
            "#include \"ShortcutConfigWidget.h\"",
            "#include \"ShortcutConfigDialog.h\"",
            "#include \"IconLoader.h\"",
            "#include <QSettings>",
            "#include <QAction>",
            "#include \"ShortcutHandler.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Common/SettingsCategoryGuard.h\"\n#include \"ShortcutConfigWidget.h\"\n#include \"ShortcutConfigDialog.h\"\n#include \"IconLoader.h\"\n#include <QSettings>\n#include <QAction>\n#include \"ShortcutHandler.h\"\n\nShortcutHandler {\n  void ShortcutHandler::accept()\n  {\n      m_shortcutConfigWidget->accept();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "File::remove(",
          "args": [
            "_autoSavePath)"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e->ignore",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "File::remove(",
          "args": [
            "_autoSavePath)"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aveDraft(",
          "args": [
            "ath)"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ath.isEmpty",
          "args": [],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FileDialog::getSaveFileName(",
          "args": [
            "his,",
            "r(\"Save as\"),",
            "ath + QLatin1Char('/') + filename + QLatin1String(\".draft\"),",
            "r(\"Drafts\") + QLatin1String(\" (*.draft)\"))"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "(*.draft)\")"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Drafts\")"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ".draft\")"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1Char(",
          "args": [
            "/')"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ilename.replace",
          "args": [
            "RegExp(QLatin1String(\"[/\\\\\\\\:\\\"|<>*?]\")),",
            "Latin1String(\"_\"))"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "_\")"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RegExp(",
          "args": [
            "Latin1String(\"[/\\\\\\\\:\\\"|<>*?]\"))"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "[/\\\\\\\\:\\\"|<>*?]\")"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTime::currentDateTime",
          "args": [
            "t::ISODate)"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTime::currentDateTime(",
          "args": [],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ilename.isEmpty",
          "args": [],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->subject->text",
          "args": [],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Dir",
          "args": [
            "ath)"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Dir(",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "kgDataDir(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Util.cpp",
          "lines": "113-120",
          "snippet": "String pkgDataDir()\n{\n#ifdef PKGDATADIR\n    return QLatin1String(PKGDATADIR);\n#else\n    return QString();\n#endif\n}",
          "includes": [
            "include \"Window.h\"",
            "include \"Util.h\"\n#",
            "include \"configure.cmake.h\"\n#",
            "include <QSettings>",
            "include <QProcess>\n#",
            "include <QIcon>\n#",
            "include <QGridLayout>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget> // for Util::centerWidgetOnScreen\n#",
            "include <QCursor> // for Util::centerWidgetOnScreen\n#",
            "include <QCheckBox>\n#",
            "include <QBuffer>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Window.h\"\ninclude \"Util.h\"\n#\ninclude \"configure.cmake.h\"\n#\ninclude <QSettings>\ninclude <QProcess>\n#\ninclude <QIcon>\n#\ninclude <QGridLayout>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget> // for Util::centerWidgetOnScreen\n#\ninclude <QCursor> // for Util::centerWidgetOnScreen\n#\ninclude <QCheckBox>\n#\ninclude <QBuffer>\n#\ninclude <QApplication>\n#\n\nString pkgDataDir()\n{\n#ifdef PKGDATADIR\n    return QLatin1String(PKGDATADIR);\n#else\n    return QString();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui::MainWindow::tr(",
          "args": [
            "Drafts\")"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ommon::writablePath(",
          "args": [
            "ommon::LOCATION_DATA)"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "aveDraft(",
          "args": [
            "_autoSavePath)"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sgBox.exec",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "exec",
          "container": "XSqlQuery",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/XtConnect/xsqlquery.cpp",
          "lines": "217-242",
          "snippet": "bool XSqlQuery::exec()\n{\n  bool returnValue = false;\n\n  if(_data && _data->_emulatePrepare)\n  {\n// In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n// caused several problems with all our code and the way it worked so this is a modified copy\n// of their code to use the implemented prepare if we have that option set so we can use the method\n// that works best in the case we are using it for.\n    if (lastError().isValid())\n      ((XSqlResultHelper*)result())->setLastError(QSqlError());\n\n    returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n  }\n  else\n    returnValue = QSqlQuery::exec();\n\n  if (_data)\n    _data->_currRecord = record();\n\n  if(false == returnValue)\n    notifyErrorListeners(this);\n\n  return returnValue;\n}",
          "includes": [
            "#include \"xsqlquery.h\"",
            "#include <QMap>",
            "#include <QCursor>",
            "#include <QSqlResult>",
            "#include <QSqlDriver>",
            "#include <QVariant>",
            "#include <QSqlError>",
            "#include <QSqlQuery>",
            "#include <QSqlRecord>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xsqlquery.h\"\n#include <QMap>\n#include <QCursor>\n#include <QSqlResult>\n#include <QSqlDriver>\n#include <QVariant>\n#include <QSqlError>\n#include <QSqlQuery>\n#include <QSqlRecord>\n\nXSqlQuery {\n  bool XSqlQuery::exec()\n  {\n    bool returnValue = false;\n  \n    if(_data && _data->_emulatePrepare)\n    {\n  // In 4.4.1 Qt started supporting true prepared queries on the PostgreSQL driver and this\n  // caused several problems with all our code and the way it worked so this is a modified copy\n  // of their code to use the implemented prepare if we have that option set so we can use the method\n  // that works best in the case we are using it for.\n      if (lastError().isValid())\n        ((XSqlResultHelper*)result())->setLastError(QSqlError());\n  \n      returnValue = ((XSqlResultHelper*)result())->XSqlResultHelper::exec();\n    }\n    else\n      returnValue = QSqlQuery::exec();\n  \n    if (_data)\n      _data->_currRecord = record();\n  \n    if(false == returnValue)\n      notifyErrorListeners(this);\n  \n    return returnValue;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sgBox.setDefaultButton",
          "args": [
            "MessageBox::Save)"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sgBox.setStandardButtons",
          "args": [
            "MessageBox::Save | QMessageBox::Discard | QMessageBox::Cancel)"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sgBox.setText",
          "args": [
            "essage)"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->attachmentsView->model",
          "args": [],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->attachmentsView->model",
          "args": [],
          "line": 238
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sgBox.setWindowTitle",
          "args": [
            "r(\"Save Draft?\"))"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sgBox.setWindowModality",
          "args": [
            "t::WindowModal)"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui::PasswordDialog::getPassword(",
          "args": [
            "his,",
            "r(\"Authentication Required\"),",
            "r(\"<p>Please provide SMTP password for user <b>%1</b> on <b>%2</b>:</p>\").arg(\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                                               Qt::escape(user),\n                                               Qt::escape(host)\n#else\n                                               user.toHtmlEscaped(),\n                                               host.toHtmlEscaped()\n#endif\n                                               ),\n                                           QString(), &ok);\n    if (ok)\n        m_submission->setPassword(password);\n    else\n        m_submission->cancelPassword();\n}\n\nvoid ComposeWidget::changeEvent(QEvent *e)\n{\n    QWidget::changeEvent(e);\n    switch (e->type()) {\n    case QEvent::LanguageChange:\n        ui->retranslateUi(this);\n        break;\n    default:\n        break;\n    }\n}\n\n/**\n * We capture the close event and check whether there's something to save\n * (not sent, not up-to-date or persistent autostore)\n * The offer the user to store or omit the message or not close at all\n */\n\nvoid ComposeWidget::closeEvent(QCloseEvent *ce)\n{\n    const bool noSaveRequired = m_sentMail || ui->mailText->document()->isEmpty() || !m_messageEverEdited ||\n                                (m_explicitDraft && !m_messageUpdated);"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->mailText->document",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->mailText->document",
          "args": [],
          "line": 231
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->retranslateUi",
          "args": [
            "his)"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "switch",
          "args": [
            "->type())"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "switchToMailbox(c",
          "container": "del",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Model.cpp",
          "lines": "1182-1191",
          "snippet": "id Model::switchToMailbox(const QModelIndex &mbox)\n{\n    if (! mbox.isValid())\n        return;\n\n    if (m_netPolicy == NETWORK_OFFLINE)\n        return;\n\n    findTaskResponsibleFor(mbox);\n}",
          "includes": [
            "include \"Streams/SocketFactory.h\"",
            "include \"Imap/Tasks/UpdateFlagsTask.h\"\n#",
            "include \"Imap/Tasks/OpenConnectionTask.h\"\n#",
            "include \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#",
            "include \"Imap/Tasks/GetAnyConnectionTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Common/FindWithUnknown.h\"\n#",
            "include \"TaskPresentationModel.h\"\n#",
            "include \"SpecialFlagNames.h\"\n#",
            "include \"QAIM_reset.h\"\n#",
            "include \"MailboxTree.h\"\n#",
            "include \"Model.h\"\n#",
            "include <QtAlgorithms>\n#",
            "include <QDebug>\n#",
            "include <QCoreApplication>\n#",
            "include <QAuthenticator>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Streams/SocketFactory.h\"\ninclude \"Imap/Tasks/UpdateFlagsTask.h\"\n#\ninclude \"Imap/Tasks/OpenConnectionTask.h\"\n#\ninclude \"Imap/Tasks/KeepMailboxOpenTask.h\"\n#\ninclude \"Imap/Tasks/GetAnyConnectionTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Common/FindWithUnknown.h\"\n#\ninclude \"TaskPresentationModel.h\"\n#\ninclude \"SpecialFlagNames.h\"\n#\ninclude \"QAIM_reset.h\"\n#\ninclude \"MailboxTree.h\"\n#\ninclude \"Model.h\"\n#\ninclude <QtAlgorithms>\n#\ninclude <QDebug>\n#\ninclude <QCoreApplication>\n#\ninclude <QAuthenticator>\n#\ninclude <QAbstractProxyModel>\n#\n\ndel {\n  id Model::switchToMailbox(const QModelIndex &mbox)\n  {\n      if (! mbox.isValid())\n          return;\n  \n      if (m_netPolicy == NETWORK_OFFLINE)\n          return;\n  \n      findTaskResponsibleFor(mbox);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "->type",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "type(",
          "container": "pinner",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Spinner.cpp",
          "lines": "73-76",
          "snippet": "pinner::Type Spinner::type() const\n{\n    return m_type;\n}",
          "includes": [
            "include <QtDebug>",
            "include <qmath.h>\n#",
            "include <QTimerEvent>\n#",
            "include <QTimer>\n#",
            "include <QPainter>\n#",
            "include <QFontMetricsF>\n#",
            "include \"Util.h\"",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Spinner.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QtDebug>\ninclude <qmath.h>\n#\ninclude <QTimerEvent>\n#\ninclude <QTimer>\n#\ninclude <QPainter>\n#\ninclude <QFontMetricsF>\n#\ninclude \"Util.h\"\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Spinner.h\"\n#\n\npinner {\n  pinner::Type Spinner::type() const\n  {\n      return m_type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Widget::changeEvent(",
          "args": [
            ")"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "changeEvent(",
          "container": "rogressPopUp",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ProgressPopUp.cpp",
          "lines": "40-50",
          "snippet": "oid ProgressPopUp::changeEvent(QEvent *e)\n{\n    QFrame::changeEvent(e);\n    switch (e->type()) {\n    case QEvent::LanguageChange:\n        ui->retranslateUi(this);\n        break;\n    default:\n        break;\n    }\n}",
          "includes": [
            "include \"ui_ProgressPopUp.h\"",
            "include \"ProgressPopUp.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"ui_ProgressPopUp.h\"\ninclude \"ProgressPopUp.h\"\n#\n\nrogressPopUp {\n  oid ProgressPopUp::changeEvent(QEvent *e)\n  {\n      QFrame::changeEvent(e);\n      switch (e->type()) {\n      case QEvent::LanguageChange:\n          ui->retranslateUi(this);\n          break;\n      default:\n          break;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "k);\n    if",
          "args": [],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "k);\n    if",
          "args": [
            "assword)"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "k)",
          "args": [
            "k)"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ost.toHtmlEscaped",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ser.toHtmlEscaped",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::passwordRequested(const QString &user, const QString &host)\n  {\n      bool ok;\n      const QString &password = Gui::PasswordDialog::getPassword(this, tr(\"Authentication Required\"),\n                                             tr(\"<p>Please provide SMTP password for user <b>%1</b> on <b>%2</b>:</p>\").arg(\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                                                 Qt::escape(user),\n                                                 Qt::escape(host)\n  #else\n                                                 user.toHtmlEscaped(),\n                                                 host.toHtmlEscaped()\n  #endif\n                                                 ),\n                                             QString(), &ok);\n      if (ok)\n          m_submission->setPassword(password);\n      else\n          m_submission->cancelPassword();\n  }\n  \n  void ComposeWidget::changeEvent(QEvent *e)\n  {\n      QWidget::changeEvent(e);\n      switch (e->type()) {\n      case QEvent::LanguageChange:\n          ui->retranslateUi(this);\n          break;\n      default:\n          break;\n      }\n  }\n  \n  /**\n   * We capture the close event and check whether there's something to save\n   * (not sent, not up-to-date or persistent autostore)\n   * The offer the user to store or omit the message or not close at all\n   */\n  \n  void ComposeWidget::closeEvent(QCloseEvent *ce)\n  {\n      const bool noSaveRequired = m_sentMail || ui->mailText->document()->isEmpty() || !m_messageEverEdited ||\n                                  (m_explicitDraft && !m_messageUpdated); // autosave to permanent draft and no update\n      if (!noSaveRequired) {  // save is required\n          QMessageBox msgBox(this);\n          msgBox.setWindowModality(Qt::WindowModal);\n          msgBox.setWindowTitle(tr(\"Save Draft?\"));\n          QString message(tr(\"The mail has not been sent.<br>Do you want to save the draft?\"));\n          if (ui->attachmentsView->model()->rowCount() > 0)\n              message += tr(\"<br><span style=\\\"color:red\\\">Warning: Attachments are <b>not</b> saved with the draft!</span>\");\n          msgBox.setText(message);\n          msgBox.setStandardButtons(QMessageBox::Save | QMessageBox::Discard | QMessageBox::Cancel);\n          msgBox.setDefaultButton(QMessageBox::Save);\n          int ret = msgBox.exec();\n          if (ret == QMessageBox::Save) {\n              if (m_explicitDraft) { // editing a present draft - override it\n                  saveDraft(m_autoSavePath);\n              } else {\n                  // Explicitly stored drafts should be saved in a location with proper i18n support, so let's make sure both main\n                  // window and this code uses the same tr() calls\n                  QString path(Common::writablePath(Common::LOCATION_DATA) + Gui::MainWindow::tr(\"Drafts\"));\n                  QDir().mkpath(path);\n                  QString filename = ui->subject->text();\n                  if (filename.isEmpty()) {\n                      filename = QDateTime::currentDateTime().toString(Qt::ISODate);\n                  }\n                  // Some characters are best avoided in file names. This is probably not a definitive list, but the hope is that\n                  // it's going to be more readable than an unformatted hash or similar stuff.  The list of characters was taken\n                  // from http://en.wikipedia.org/wiki/Filename#Reserved_characters_and_words .\n                  filename.replace(QRegExp(QLatin1String(\"[/\\\\\\\\:\\\"|<>*?]\")), QLatin1String(\"_\"));\n                  path = QFileDialog::getSaveFileName(this, tr(\"Save as\"), path + QLatin1Char('/') + filename + QLatin1String(\".draft\"),\n                                                      tr(\"Drafts\") + QLatin1String(\" (*.draft)\"));\n                  if (path.isEmpty()) { // cancelled save\n                      ret = QMessageBox::Cancel;\n                  } else {\n                      m_explicitDraft = true;\n                      saveDraft(path);\n                      if (path != m_autoSavePath) // we can remove the temp save\n                          QFile::remove(m_autoSavePath);\n                  }\n              }\n          }\n          if (ret == QMessageBox::Cancel) {\n              ce->ignore(); // don't close the window\n              return;\n          }\n      }\n      if (m_sentMail || !m_explicitDraft) // is the mail has been sent or the user does not want to store it\n          QFile::remove(m_autoSavePath); // get rid of draft\n      ce->accept(); // ultimately close the window\n  }\n}"
  },
  {
    "function_name": "~ComposeWidget(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "186-189",
    "snippet": "omposeWidget::~ComposeWidget()\n{\n    delete ui;\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  omposeWidget::~ComposeWidget()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "ComposeWidget(",
    "container": "omposeWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
    "lines": "72-184",
    "snippet": "omposeWidget::ComposeWidget(MainWindow *mainWindow, QSettings *settings, MSA::MSAFactory *msaFactory) :\n    QWidget(0, Qt::Window),\n    ui(new Ui::ComposeWidget),\n    m_maxVisibleRecipients(MIN_MAX_VISIBLE_RECIPIENTS),\n    m_sentMail(false),\n    m_messageUpdated(false),\n    m_messageEverEdited(false),\n    m_explicitDraft(false),\n    m_appendUidReceived(false), m_appendUidValidity(0), m_appendUid(0), m_genUrlAuthReceived(false),\n    m_mainWindow(mainWindow),\n    m_settings(settings)\n{\n    setAttribute(Qt::WA_DeleteOnClose, true);\n\n    QIcon winIcon;\n    winIcon.addFile(QLatin1String(\":/icons/trojita-edit-big.png\"), QSize(128, 128));\n    winIcon.addFile(QLatin1String(\":/icons/trojita-edit-small.png\"), QSize(22, 22));\n    setWindowIcon(winIcon);\n\n    Q_ASSERT(m_mainWindow);\n    m_submission = new Composer::Submission(this, m_mainWindow->imapModel(), msaFactory);\n    connect(m_submission, SIGNAL(succeeded()), this, SLOT(sent()));\n    connect(m_submission, SIGNAL(failed(QString)), this, SLOT(gotError(QString)));\n    connect(m_submission, SIGNAL(passwordRequested(QString,QString)), this, SLOT(passwordRequested(QString,QString)), Qt::QueuedConnection);\n\n    ui->setupUi(this);\n    ui->attachmentsView->setComposer(m_submission->composer());\n    sendButton = ui->buttonBox->addButton(tr(\"Send\"), QDialogButtonBox::AcceptRole);\n    connect(sendButton, SIGNAL(clicked()), this, SLOT(send()));\n    cancelButton = ui->buttonBox->addButton(QDialogButtonBox::Cancel);\n    connect(cancelButton, SIGNAL(clicked()), this, SLOT(close()));\n    connect(ui->attachButton, SIGNAL(clicked()), this, SLOT(slotAskForFileAttachment()));\n\n    m_completionPopup = new QMenu(this);\n    m_completionPopup->installEventFilter(this);\n    connect(m_completionPopup, SIGNAL(triggered(QAction*)), SLOT(completeRecipient(QAction*)));\n\n    // TODO: make this configurable?\n    m_completionCount = 8;\n\n    m_recipientListUpdateTimer = new QTimer(this);\n    m_recipientListUpdateTimer->setSingleShot(true);\n    m_recipientListUpdateTimer->setInterval(250);\n    connect(m_recipientListUpdateTimer, SIGNAL(timeout()), SLOT(updateRecipientList()));\n\n    connect(ui->verticalSplitter, SIGNAL(splitterMoved(int, int)), SLOT(calculateMaxVisibleRecipients()));\n    calculateMaxVisibleRecipients();\n\n    connect(ui->recipientSlider, SIGNAL(valueChanged(int)), SLOT(scrollRecipients(int)));\n    connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n    ui->recipientSlider->setMinimum(0);\n    ui->recipientSlider->setMaximum(0);\n    ui->recipientSlider->setVisible(false);\n    ui->envelopeWidget->installEventFilter(this);\n\n    m_markButton = new QToolButton(ui->buttonBox);\n    m_markButton->setPopupMode(QToolButton::MenuButtonPopup);\n    m_markButton->setToolButtonStyle(Qt::ToolButtonTextBesideIcon);\n    m_markAsReply = new QActionGroup(m_markButton);\n    m_markAsReply->setExclusive(true);\n    auto *asReplyMenu = new QMenu(m_markButton);\n    m_markButton->setMenu(asReplyMenu);\n    m_actionStandalone = asReplyMenu->addAction(Gui::loadIcon(QLatin1String(\"mail-view-flat\")), tr(\"New Thread\"));\n    m_actionStandalone->setActionGroup(m_markAsReply);\n    m_actionStandalone->setCheckable(true);\n    m_actionStandalone->setToolTip(tr(\"This mail will be sent as a standalone message.<hr/>Change to preserve the reply hierarchy.\"));\n    m_actionInReplyTo = asReplyMenu->addAction(Gui::loadIcon(QLatin1String(\"mail-view-threaded\")), tr(\"Threaded\"));\n    m_actionInReplyTo->setActionGroup(m_markAsReply);\n    m_actionInReplyTo->setCheckable(true);\n\n    // This is a \"quick shortcut action\". It shows the UI bits of the current option, but when the user clicks it,\n    // the *other* action is triggered.\n    m_actionToggleMarking = new QAction(m_markButton);\n    connect(m_actionToggleMarking, SIGNAL(triggered()), this, SLOT(toggleReplyMarking()));\n    m_markButton->setDefaultAction(m_actionToggleMarking);\n\n    // Unfortunately, there's no signal for toggled(QAction*), so we'll have to call QAction::trigger() to have this working\n    connect(m_markAsReply, SIGNAL(triggered(QAction*)), this, SLOT(updateReplyMarkingAction()));\n    m_actionStandalone->trigger();\n    // We want to have the button aligned to the left; the only \"portable\" way of this is the ResetRole\n    // (thanks to TL for mentioning this, and for the Qt's doc for providing pretty pictures on different platforms)\n    ui->buttonBox->addButton(m_markButton, QDialogButtonBox::ResetRole);\n    m_markButton->hide();\n\n    ui->mailText->setFont(Gui::Util::systemMonospaceFont());\n\n    connect(ui->mailText, SIGNAL(urlsAdded(QList<QUrl>)), SLOT(slotAttachFiles(QList<QUrl>)));\n    connect(ui->mailText, SIGNAL(sendRequest()), SLOT(send()));\n    connect(ui->mailText, SIGNAL(textChanged()), SLOT(setMessageUpdated()));\n    connect(ui->subject, SIGNAL(textChanged(QString)), SLOT(updateWindowTitle()));\n\n    FromAddressProxyModel *proxy = new FromAddressProxyModel(this);\n    proxy->setSourceModel(m_mainWindow->senderIdentitiesModel());\n    ui->sender->setModel(proxy);\n\n    connect(ui->sender, SIGNAL(currentIndexChanged(int)), SLOT(slotUpdateSignature()));\n    connect(ui->sender, SIGNAL(editTextChanged(QString)), SLOT(setMessageUpdated()));\n    connect(ui->sender->lineEdit(), SIGNAL(textChanged(QString)), SLOT(slotCheckAddress()));\n\n    QTimer *autoSaveTimer = new QTimer(this);\n    connect(autoSaveTimer, SIGNAL(timeout()), SLOT(autoSaveDraft()));\n    autoSaveTimer->start(30*1000);\n\n    // these are for the automatically saved drafts, i.e. no i18n for the dir name\n    m_autoSavePath = QString(Common::writablePath(Common::LOCATION_CACHE) + QLatin1String(\"Drafts/\"));\n    QDir().mkpath(m_autoSavePath);\n\n#if QT_VERSION < QT_VERSION_CHECK(4, 7, 0)\n    m_autoSavePath += QString::number(QDateTime(QDate(1970, 1, 1), QTime(0, 0, 0)).secsTo(QDateTime::currentDateTime())) + QLatin1String(\".draft\");\n#else\n    m_autoSavePath += QString::number(QDateTime::currentMSecsSinceEpoch()) + QLatin1String(\".draft\");\n#endif\n}",
    "includes": [
      "include \"Imap/Tasks/UidSubmitTask.h\"",
      "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
      "include \"Imap/Tasks/AppendTask.h\"\n#",
      "include \"Imap/Model/Model.h\"\n#",
      "include \"Imap/Model/ItemRoles.h\"\n#",
      "include \"Gui/Window.h\"\n#",
      "include \"Gui/Util.h\"\n#",
      "include \"Gui/ProgressPopUp.h\"\n#",
      "include \"Gui/PasswordDialog.h\"\n#",
      "include \"Gui/OverlayWidget.h\"\n#",
      "include \"Gui/LineEdit.h\"\n#",
      "include \"Gui/IconLoader.h\"\n#",
      "include \"Gui/FromAddressProxyModel.h\"\n#",
      "include \"Gui/ComposeWidget.h\"\n#",
      "include \"Gui/AutoCompletion.h\"\n#",
      "include \"Gui/AbstractAddressbook.h\"\n#",
      "include \"Common/SettingsNames.h\"\n#",
      "include \"Common/Paths.h\"\n#",
      "include \"Common/InvokeMethod.h\"\n#",
      "include \"Composer/Submission.h\"\n#",
      "include \"Composer/SenderIdentitiesModel.h\"\n#",
      "include \"Composer/ReplaceSignature.h\"\n#",
      "include \"Composer/MessageComposer.h\"\n#",
      "include \"ui_ComposeWidget.h\"\n#",
      "include <QToolButton>",
      "include <QTimer>\n#",
      "include <QSettings>\n#",
      "include <QPushButton>\n#",
      "include <QPropertyAnimation>\n#",
      "include <QProgressDialog>\n#",
      "include <QMessageBox>\n#",
      "include <QMenu>\n#",
      "include <QKeyEvent>\n#",
      "include <QGraphicsOpacityEffect>\n#",
      "include <QFileDialog>\n#",
      "include <QBuffer>\n#",
      "include <QAbstractProxyModel>\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ".draft\")"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::number(",
          "args": [
            "DateTime::currentMSecsSinceEpoch())"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTime::currentMSecsSinceEpoch(",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ".draft\")"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::number(",
          "args": [
            "DateTime(QDate(1970, 1, 1), QTime(0, 0, 0)).secsTo(QDateTime::currentDateTime()))"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTime",
          "args": [
            "DateTime::currentDateTime())"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "arseRFC2822DateTime(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/LowLevelParser.cpp",
          "lines": "391-456",
          "snippet": "DateTime parseRFC2822DateTime(const QString &string)\n{\n    QStringList monthNames = QStringList() << QLatin1String(\"jan\") << QLatin1String(\"feb\") << QLatin1String(\"mar\")\n                                           << QLatin1String(\"apr\") << QLatin1String(\"may\") << QLatin1String(\"jun\")\n                                           << QLatin1String(\"jul\") << QLatin1String(\"aug\") << QLatin1String(\"sep\")\n                                           << QLatin1String(\"oct\") << QLatin1String(\"nov\") << QLatin1String(\"dec\");\n\n    QRegExp rx(QString::fromUtf8(\"^(?:\\\\s*([A-Z][a-z]+)\\\\s*,\\\\s*)?\"   // date-of-week\n                                 \"(\\\\d{1,2})\\\\s+(%1)\\\\s+(\\\\d{2,4})\" // date\n                                 \"\\\\s+(\\\\d{1,2})\\\\s*:(\\\\d{1,2})\\\\s*(?::\\\\s*(\\\\d{1,2})\\\\s*)?\" // time\n                                 \"(\\\\s+(?:(?:([+-]?)(\\\\d{2})(\\\\d{2}))|(UT|GMT|EST|EDT|CST|CDT|MST|MDT|PST|PDT|[A-IK-Za-ik-z])))?\" // timezone\n                                 ).arg(monthNames.join(QLatin1String(\"|\"))), Qt::CaseInsensitive);\n    int pos = rx.indexIn(string);\n\n    if (pos == -1)\n        throw ParseError(\"Date format not recognized\");\n\n    QStringList list = rx.capturedTexts();\n\n    if (list.size() != 13)\n        throw ParseError(\"Date regular expression returned weird data (internal error?)\");\n\n    int year = list[4].toInt();\n    int month = monthNames.indexOf(list[3].toLower()) + 1;\n    if (month == 0)\n        throw ParseError(\"Invalid month name\");\n    int day = list[2].toInt();\n    int hours = list[5].toInt();\n    int minutes = list[6].toInt();\n    int seconds = list[7].toInt();\n    int shift = list[10].toInt() * 60 + list[11].toInt();\n    if (list[9] == QLatin1String(\"-\"))\n        shift *= 60;\n    else\n        shift *= -60;\n    if (! list[12].isEmpty()) {\n        const QString tz = list[12].toUpper();\n        if (tz == QLatin1String(\"UT\") || tz == QLatin1String(\"GMT\"))\n            shift = 0;\n        else if (tz == QLatin1String(\"EST\"))\n            shift = 5 * 3600;\n        else if (tz == QLatin1String(\"EDT\"))\n            shift = 4 * 3600;\n        else if (tz == QLatin1String(\"CST\"))\n            shift = 6 * 3600;\n        else if (tz == QLatin1String(\"CDT\"))\n            shift = 5 * 3600;\n        else if (tz == QLatin1String(\"MST\"))\n            shift = 7 * 3600;\n        else if (tz == QLatin1String(\"MDT\"))\n            shift = 6 * 3600;\n        else if (tz == QLatin1String(\"PST\"))\n            shift = 8 * 3600;\n        else if (tz == QLatin1String(\"PDT\"))\n            shift = 7 * 3600;\n        else if (tz.size() == 1)\n            shift = 0;\n        else\n            throw ParseError(\"Invalid TZ specification\");\n    }\n\n    QDateTime date(QDate(year, month, day), QTime(hours, minutes, seconds), Qt::UTC);\n    date = date.addSecs(shift);\n\n    return date;\n}",
          "includes": [
            "include \"Imap/Encoders.h\"",
            "include \"../Exceptions.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include <QDateTime>\n#",
            "include <QVariant>\n#",
            "include <QStringList>\n#",
            "include <QPair>\n#",
            "include <limits>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Encoders.h\"\ninclude \"../Exceptions.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude <QDateTime>\n#\ninclude <QVariant>\n#\ninclude <QStringList>\n#\ninclude <QPair>\n#\ninclude <limits>\n#\n\nDateTime parseRFC2822DateTime(const QString &string)\n{\n    QStringList monthNames = QStringList() << QLatin1String(\"jan\") << QLatin1String(\"feb\") << QLatin1String(\"mar\")\n                                           << QLatin1String(\"apr\") << QLatin1String(\"may\") << QLatin1String(\"jun\")\n                                           << QLatin1String(\"jul\") << QLatin1String(\"aug\") << QLatin1String(\"sep\")\n                                           << QLatin1String(\"oct\") << QLatin1String(\"nov\") << QLatin1String(\"dec\");\n\n    QRegExp rx(QString::fromUtf8(\"^(?:\\\\s*([A-Z][a-z]+)\\\\s*,\\\\s*)?\"   // date-of-week\n                                 \"(\\\\d{1,2})\\\\s+(%1)\\\\s+(\\\\d{2,4})\" // date\n                                 \"\\\\s+(\\\\d{1,2})\\\\s*:(\\\\d{1,2})\\\\s*(?::\\\\s*(\\\\d{1,2})\\\\s*)?\" // time\n                                 \"(\\\\s+(?:(?:([+-]?)(\\\\d{2})(\\\\d{2}))|(UT|GMT|EST|EDT|CST|CDT|MST|MDT|PST|PDT|[A-IK-Za-ik-z])))?\" // timezone\n                                 ).arg(monthNames.join(QLatin1String(\"|\"))), Qt::CaseInsensitive);\n    int pos = rx.indexIn(string);\n\n    if (pos == -1)\n        throw ParseError(\"Date format not recognized\");\n\n    QStringList list = rx.capturedTexts();\n\n    if (list.size() != 13)\n        throw ParseError(\"Date regular expression returned weird data (internal error?)\");\n\n    int year = list[4].toInt();\n    int month = monthNames.indexOf(list[3].toLower()) + 1;\n    if (month == 0)\n        throw ParseError(\"Invalid month name\");\n    int day = list[2].toInt();\n    int hours = list[5].toInt();\n    int minutes = list[6].toInt();\n    int seconds = list[7].toInt();\n    int shift = list[10].toInt() * 60 + list[11].toInt();\n    if (list[9] == QLatin1String(\"-\"))\n        shift *= 60;\n    else\n        shift *= -60;\n    if (! list[12].isEmpty()) {\n        const QString tz = list[12].toUpper();\n        if (tz == QLatin1String(\"UT\") || tz == QLatin1String(\"GMT\"))\n            shift = 0;\n        else if (tz == QLatin1String(\"EST\"))\n            shift = 5 * 3600;\n        else if (tz == QLatin1String(\"EDT\"))\n            shift = 4 * 3600;\n        else if (tz == QLatin1String(\"CST\"))\n            shift = 6 * 3600;\n        else if (tz == QLatin1String(\"CDT\"))\n            shift = 5 * 3600;\n        else if (tz == QLatin1String(\"MST\"))\n            shift = 7 * 3600;\n        else if (tz == QLatin1String(\"MDT\"))\n            shift = 6 * 3600;\n        else if (tz == QLatin1String(\"PST\"))\n            shift = 8 * 3600;\n        else if (tz == QLatin1String(\"PDT\"))\n            shift = 7 * 3600;\n        else if (tz.size() == 1)\n            shift = 0;\n        else\n            throw ParseError(\"Invalid TZ specification\");\n    }\n\n    QDateTime date(QDate(year, month, day), QTime(hours, minutes, seconds), Qt::UTC);\n    date = date.addSecs(shift);\n\n    return date;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DateTime::currentDateTime(",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DateTime(",
          "args": [
            "Date(1970, 1, 1),",
            "Time(0, 0, 0))"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Time(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Date(",
          "args": [
            "970,",
            ",",
            ")"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "T_VERSION_CHECK(",
          "args": [
            ",",
            ",",
            ")"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Dir",
          "args": [
            "_autoSavePath)"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Dir(",
          "args": [],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "kgDataDir(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Util.cpp",
          "lines": "113-120",
          "snippet": "String pkgDataDir()\n{\n#ifdef PKGDATADIR\n    return QLatin1String(PKGDATADIR);\n#else\n    return QString();\n#endif\n}",
          "includes": [
            "include \"Window.h\"",
            "include \"Util.h\"\n#",
            "include \"configure.cmake.h\"\n#",
            "include <QSettings>",
            "include <QProcess>\n#",
            "include <QIcon>\n#",
            "include <QGridLayout>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget> // for Util::centerWidgetOnScreen\n#",
            "include <QCursor> // for Util::centerWidgetOnScreen\n#",
            "include <QCheckBox>\n#",
            "include <QBuffer>\n#",
            "include <QApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Window.h\"\ninclude \"Util.h\"\n#\ninclude \"configure.cmake.h\"\n#\ninclude <QSettings>\ninclude <QProcess>\n#\ninclude <QIcon>\n#\ninclude <QGridLayout>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget> // for Util::centerWidgetOnScreen\n#\ninclude <QCursor> // for Util::centerWidgetOnScreen\n#\ninclude <QCheckBox>\n#\ninclude <QBuffer>\n#\ninclude <QApplication>\n#\n\nString pkgDataDir()\n{\n#ifdef PKGDATADIR\n    return QLatin1String(PKGDATADIR);\n#else\n    return QString();\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "ommon::writablePath(Common::LOCATION_CACHE) + QLatin1String(\"Drafts/\"))"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "ecodeRFC2047String(",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Encoders.cpp",
          "lines": "372-375",
          "snippet": "String decodeRFC2047String( const QByteArray& raw )\n{\n    return ::decodeWordSequence( raw );\n}",
          "includes": [
            "include \"Parser/3rdparty/kcodecs.h\"",
            "include \"Parser/3rdparty/rfccodecs.h\"\n#",
            "include \"Encoders.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Parser/3rdparty/kcodecs.h\"\ninclude \"Parser/3rdparty/rfccodecs.h\"\n#\ninclude \"Encoders.h\"\n#\n\nString decodeRFC2047String( const QByteArray& raw )\n{\n    return ::decodeWordSequence( raw );\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "Drafts/\")"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ommon::writablePath(",
          "args": [
            "ommon::LOCATION_CACHE)"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utoSaveTimer->start",
          "args": [
            "0*1000)"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "utoSaveTimer,",
            "IGNAL(timeout()),",
            "LOT(autoSaveDraft()))"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "utoSaveDraft())"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "utoSaveDraft(",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "imeout())"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "imeout(",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->sender->lineEdit(),",
            "IGNAL(textChanged(QString)),",
            "LOT(slotCheckAddress()))"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotCheckAddress())"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotCheckAddress(",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "slotCheckAddress(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "592-597",
          "snippet": "oid ComposeWidget::slotCheckAddress()\n{\n    QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n    Q_ASSERT(edit);\n    slotCheckAddress(edit);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::slotCheckAddress()\n  {\n      QLineEdit *edit = qobject_cast<QLineEdit*>(sender());\n      Q_ASSERT(edit);\n      slotCheckAddress(edit);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "extChanged(QString))"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "extChanged(",
          "args": [
            "String)"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->lineEdit",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->sender,",
            "IGNAL(editTextChanged(QString)),",
            "LOT(setMessageUpdated()))"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "etMessageUpdated())"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etMessageUpdated(",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ditTextChanged(QString))"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ditTextChanged(",
          "args": [
            "String)"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->sender,",
            "IGNAL(currentIndexChanged(int)),",
            "LOT(slotUpdateSignature()))"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotUpdateSignature())"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotUpdateSignature(",
          "args": [],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "urrentIndexChanged(int))"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urrentIndexChanged(",
          "args": [
            "nt)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->sender->setModel",
          "args": [
            "roxy)"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roxy->setSourceModel",
          "args": [
            "_mainWindow->senderIdentitiesModel())"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_mainWindow->senderIdentitiesModel",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->subject,",
            "IGNAL(textChanged(QString)),",
            "LOT(updateWindowTitle()))"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "pdateWindowTitle())"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdateWindowTitle(",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "slotUpdateWindowTitle()\n{",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "2064-2081",
          "snippet": "Window::slotUpdateWindowTitle()\n{\n    QModelIndex mailbox = qobject_cast<Imap::Mailbox::MsgListModel *>(m_imapAccess->msgListModel())->currentMailbox();\n    QString profileName = QString::fromUtf8(qgetenv(\"TROJITA_PROFILE\"));\n    if (!profileName.isEmpty())\n        profileName = QLatin1String(\" [\") + profileName + QLatin1Char(']');\n    if (mailbox.isValid()) {\n        if (mailbox.data(Imap::Mailbox::RoleUnreadMessageCount).toInt()) {\n            setWindowTitle(trUtf8(\"%1 - %2 unread - Trojit\")\n                           .arg(mailbox.data(Imap::Mailbox::RoleShortMailboxName).toString(),\n                                mailbox.data(Imap::Mailbox::RoleUnreadMessageCount).toString()) + profileName);\n        } else {\n            setWindowTitle(trUtf8(\"%1 - Trojit\").arg(mailbox.data(Imap::Mailbox::RoleShortMailboxName).toString()) + profileName);\n        }\n    } else {\n        setWindowTitle(trUtf8(\"Trojit\") + profileName);\n    }\n}\n\nvoid MainW",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::slotUpdateWindowTitle()\n  {\n      QModelIndex mailbox = qobject_cast<Imap::Mailbox::MsgListModel *>(m_imapAccess->msgListModel())->currentMailbox();\n      QString profileName = QString::fromUtf8(qgetenv(\"TROJITA_PROFILE\"));\n      if (!profileName.isEmpty())\n          profileName = QLatin1String(\" [\") + profileName + QLatin1Char(']');\n      if (mailbox.isValid()) {\n          if (mailbox.data(Imap::Mailbox::RoleUnreadMessageCount).toInt()) {\n              setWindowTitle(trUtf8(\"%1 - %2 unread - Trojit\")\n                             .arg(mailbox.data(Imap::Mailbox::RoleShortMailboxName).toString(),\n                                  mailbox.data(Imap::Mailbox::RoleUnreadMessageCount).toString()) + profileName);\n          } else {\n              setWindowTitle(trUtf8(\"%1 - Trojit\").arg(mailbox.data(Imap::Mailbox::RoleShortMailboxName).toString()) + profileName);\n          }\n      } else {\n          setWindowTitle(trUtf8(\"Trojit\") + profileName);\n      }\n  }\n  \n  void MainW\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "extChanged(QString))"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "extChanged(",
          "args": [
            "String)"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->mailText,",
            "IGNAL(textChanged()),",
            "LOT(setMessageUpdated()))"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "etMessageUpdated())"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etMessageUpdated(",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "extChanged())"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "extChanged(",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->mailText,",
            "IGNAL(sendRequest()),",
            "LOT(send()))"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "end())"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "end(",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "send(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "338-370",
          "snippet": "oid ComposeWidget::send()\n{\n    // Well, Trojita is of course rock solid and will never ever crash :), but experience has shown that every now and then,\n    // there is a subtle issue $somewhere. This means that it's probably a good idea to save the draft explicitly -- better\n    // than losing some work. It's cheap anyway.\n    saveDraft(m_autoSavePath);\n\n    if (!buildMessageData())\n        return;\n\n    m_submission->setImapOptions(m_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),\n                                 m_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),\n                                 m_settings->value(Common::SettingsNames::imapHostKey).toString(),\n                                 m_settings->value(Common::SettingsNames::imapUserKey).toString(),\n                                 m_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail);\n    m_submission->setSmtpOptions(m_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),\n                                 m_settings->value(Common::SettingsNames::smtpUserKey).toString());\n\n\n    ProgressPopUp *progress = new ProgressPopUp();\n    OverlayWidget *overlay = new OverlayWidget(progress, this);\n    overlay->show();\n    setUiWidgetsEnabled(false);\n\n    connect(m_submission, SIGNAL(progressMin(int)), progress, SLOT(setMinimum(int)));\n    connect(m_submission, SIGNAL(progressMax(int)), progress, SLOT(setMaximum(int)));\n    connect(m_submission, SIGNAL(progress(int)), progress, SLOT(setValue(int)));\n    connect(m_submission, SIGNAL(updateStatusMessage(QString)), progress, SLOT(setLabelText(QString)));\n    connect(m_submission, SIGNAL(succeeded()), overlay, SLOT(deleteLater()));\n    connect(m_submission, SIGNAL(failed(QString)), overlay, SLOT(deleteLater()));\n\n    m_submission->send();\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::send()\n  {\n      // Well, Trojita is of course rock solid and will never ever crash :), but experience has shown that every now and then,\n      // there is a subtle issue $somewhere. This means that it's probably a good idea to save the draft explicitly -- better\n      // than losing some work. It's cheap anyway.\n      saveDraft(m_autoSavePath);\n  \n      if (!buildMessageData())\n          return;\n  \n      m_submission->setImapOptions(m_settings->value(Common::SettingsNames::composerSaveToImapKey, true).toBool(),\n                                   m_settings->value(Common::SettingsNames::composerImapSentKey, tr(\"Sent\")).toString(),\n                                   m_settings->value(Common::SettingsNames::imapHostKey).toString(),\n                                   m_settings->value(Common::SettingsNames::imapUserKey).toString(),\n                                   m_settings->value(Common::SettingsNames::msaMethodKey).toString() == Common::SettingsNames::methodImapSendmail);\n      m_submission->setSmtpOptions(m_settings->value(Common::SettingsNames::smtpUseBurlKey, false).toBool(),\n                                   m_settings->value(Common::SettingsNames::smtpUserKey).toString());\n  \n  \n      ProgressPopUp *progress = new ProgressPopUp();\n      OverlayWidget *overlay = new OverlayWidget(progress, this);\n      overlay->show();\n      setUiWidgetsEnabled(false);\n  \n      connect(m_submission, SIGNAL(progressMin(int)), progress, SLOT(setMinimum(int)));\n      connect(m_submission, SIGNAL(progressMax(int)), progress, SLOT(setMaximum(int)));\n      connect(m_submission, SIGNAL(progress(int)), progress, SLOT(setValue(int)));\n      connect(m_submission, SIGNAL(updateStatusMessage(QString)), progress, SLOT(setLabelText(QString)));\n      connect(m_submission, SIGNAL(succeeded()), overlay, SLOT(deleteLater()));\n      connect(m_submission, SIGNAL(failed(QString)), overlay, SLOT(deleteLater()));\n  \n      m_submission->send();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "endRequest())"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "endRequest(",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->mailText,",
            "IGNAL(urlsAdded(QList<QUrl>)),",
            "LOT(slotAttachFiles(QList<QUrl>)))"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotAttachFiles(QList<QUrl>))"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotAttachFiles(",
          "args": [
            "List<QUrl>)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "rlsAdded(QList<QUrl>))"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rlsAdded(",
          "args": [
            "List<QUrl>)"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->mailText->setFont",
          "args": [
            "ui::Util::systemMonospaceFont())"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui::Util::systemMonospaceFont(",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markButton->hide",
          "args": [],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->buttonBox->addButton",
          "args": [
            "_markButton,",
            "DialogButtonBox::ResetRole)"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionStandalone->trigger",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markButton->setDefaultAction",
          "args": [
            "_actionToggleMarking)"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_actionToggleMarking,",
            "IGNAL(triggered()),",
            "his,",
            "LOT(toggleReplyMarking()))"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "oggleReplyMarking())"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "oggleReplyMarking(",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "riggered())"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "riggered(",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionInReplyTo->setActionGroup",
          "args": [
            "_markAsReply)"
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sReplyMenu->addAction",
          "args": [
            "ui::loadIcon(QLatin1String(\"mail-view-threaded\")),",
            "r(\"Threaded\"))"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r(",
          "args": [
            "Threaded\")"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "gotError(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "816-820",
          "snippet": "oid ComposeWidget::gotError(const QString &error)\n{\n    QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n    setUiWidgetsEnabled(true);\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::gotError(const QString &error)\n  {\n      QMessageBox::critical(this, tr(\"Failed to Send Mail\"), error);\n      setUiWidgetsEnabled(true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui::loadIcon(",
          "args": [
            "Latin1String(\"mail-view-threaded\"))"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mail-view-threaded\")"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionStandalone->setToolTip",
          "args": [
            "r(\"This mail will be sent as a standalone message.<hr/>Change to preserve the reply hierarchy.\"))"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionStandalone->setCheckable",
          "args": [
            "rue)"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_actionStandalone->setActionGroup",
          "args": [
            "_markAsReply)"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sReplyMenu->addAction",
          "args": [
            "ui::loadIcon(QLatin1String(\"mail-view-flat\")),",
            "r(\"New Thread\"))"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui::loadIcon(",
          "args": [
            "Latin1String(\"mail-view-flat\"))"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            "mail-view-flat\")"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markButton->setMenu",
          "args": [
            "sReplyMenu)"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markAsReply->setExclusive",
          "args": [
            "rue)"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markButton->setToolButtonStyle",
          "args": [
            "t::ToolButtonTextBesideIcon)"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_markButton->setPopupMode",
          "args": [
            "ToolButton::MenuButtonPopup)"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->envelopeWidget->installEventFilter",
          "args": [
            "his)"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setVisible",
          "args": [
            "alse)"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "setVisible",
          "container": "FindBar",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FindBar.cpp",
          "lines": "134-164",
          "snippet": "void FindBar::setVisible(bool visible)\n{\n    QWidget::setVisible(visible);\n\n    if (!m_associatedWebView)\n        return;\n\n    if (visible) {\n        const QString selectedText = m_associatedWebView->page()->selectedText();\n        if (!hasFocus() && !selectedText.isEmpty()) {\n            const QString previousText = m_lineEdit->text();\n            m_lineEdit->setText(selectedText);\n\n            if (m_lineEdit->text() != previousText) {\n                findPrevious();\n            } else {\n                updateHighlight();\n            }\n        } else if (selectedText.isEmpty()) {\n            emit searchString(m_lineEdit->text());\n        }\n\n        m_lineEdit->setFocus();\n        m_lineEdit->selectAll();\n    } else {\n        updateHighlight();\n\n        // Clear the selection\n        m_associatedWebView->page()->findText(QString());\n    }\n}",
          "includes": [
            "#include \"Gui/Util.h\"",
            "#include \"LineEdit.h\"",
            "#include <QWebView>",
            "#include <QWebFrame>",
            "#include <QToolButton>",
            "#include <QPushButton>",
            "#include <QLabel>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QCheckBox>",
            "#include \"FindBar.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Gui/Util.h\"\n#include \"LineEdit.h\"\n#include <QWebView>\n#include <QWebFrame>\n#include <QToolButton>\n#include <QPushButton>\n#include <QLabel>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QCheckBox>\n#include \"FindBar.h\"\n\nFindBar {\n  void FindBar::setVisible(bool visible)\n  {\n      QWidget::setVisible(visible);\n  \n      if (!m_associatedWebView)\n          return;\n  \n      if (visible) {\n          const QString selectedText = m_associatedWebView->page()->selectedText();\n          if (!hasFocus() && !selectedText.isEmpty()) {\n              const QString previousText = m_lineEdit->text();\n              m_lineEdit->setText(selectedText);\n  \n              if (m_lineEdit->text() != previousText) {\n                  findPrevious();\n              } else {\n                  updateHighlight();\n              }\n          } else if (selectedText.isEmpty()) {\n              emit searchString(m_lineEdit->text());\n          }\n  \n          m_lineEdit->setFocus();\n          m_lineEdit->selectAll();\n      } else {\n          updateHighlight();\n  \n          // Clear the selection\n          m_associatedWebView->page()->findText(QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setMaximum",
          "args": [
            ")"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->recipientSlider->setMinimum",
          "args": [
            ")"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->recipientSlider,",
            "IGNAL(valueChanged(int)),",
            "LOT(scrollRecipients(int)))"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "crollRecipients(int))"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crollRecipients(",
          "args": [
            "nt)"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "scrollRecipients(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "731-791",
          "snippet": "oid ComposeWidget::scrollRecipients(int value)\n{\n    // ignore focus changes caused by \"scrolling\"\n    disconnect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), this, SLOT(handleFocusChange()));\n\n    QList<QWidget*> visibleWidgets;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        // remove all widgets from the form because of vspacing - causes spurious padding\n\n        QWidget *toCC = m_recipients.at(i).first;\n        QWidget *lineEdit = m_recipients.at(i).second;\n        if (!m_lastFocusedRecipient) { // apply only _once_\n            if (toCC->hasFocus())\n                m_lastFocusedRecipient = toCC;\n            else if (lineEdit->hasFocus())\n                m_lastFocusedRecipient = lineEdit;\n        }\n        if (toCC->isVisible())\n            visibleWidgets << toCC;\n        if (lineEdit->isVisible())\n            visibleWidgets << lineEdit;\n        ui->envelopeLayout->removeWidget(toCC);\n        ui->envelopeLayout->removeWidget(lineEdit);\n        toCC->hide();\n        lineEdit->hide();\n    }\n\n    const int begin = qMin(m_recipients.count(), value);\n    const int end   = qMin(m_recipients.count(), value + m_maxVisibleRecipients);\n    for (int i = begin, j = 0; i < end; ++i, ++j) {\n        const int pos = actualRow(ui->envelopeLayout, j + OFFSET_OF_FIRST_ADDRESSEE);\n        QWidget *toCC = m_recipients.at(i).first;\n        QWidget *lineEdit = m_recipients.at(i).second;\n        ui->envelopeLayout->insertRow(pos, toCC, lineEdit);\n        if (!visibleWidgets.contains(toCC))\n            fadeIn(toCC);\n        visibleWidgets.removeOne(toCC);\n        if (!visibleWidgets.contains(lineEdit))\n            fadeIn(lineEdit);\n        visibleWidgets.removeOne(lineEdit);\n        toCC->show();\n        lineEdit->show();\n        setTabOrder(formPredecessor(ui->envelopeLayout, toCC), toCC);\n        setTabOrder(toCC, lineEdit);\n        if (toCC == m_lastFocusedRecipient)\n            toCC->setFocus();\n        else if (lineEdit == m_lastFocusedRecipient)\n            lineEdit->setFocus();\n    }\n\n    if (m_lastFocusedRecipient && !m_lastFocusedRecipient->hasFocus() && QApplication::focusWidget())\n        ui->envelopeWidget->setFocus();\n\n    Q_FOREACH (QWidget *w, visibleWidgets) {\n        // was visible, is no longer -> stop animation so it won't conflict later ones\n        w->setGraphicsEffect(0); // deletes old one\n        if (QPropertyAnimation *pa = w->findChild<QPropertyAnimation*>(trojita_opacityAnimation))\n            pa->stop();\n    }\n    connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::scrollRecipients(int value)\n  {\n      // ignore focus changes caused by \"scrolling\"\n      disconnect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), this, SLOT(handleFocusChange()));\n  \n      QList<QWidget*> visibleWidgets;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          // remove all widgets from the form because of vspacing - causes spurious padding\n  \n          QWidget *toCC = m_recipients.at(i).first;\n          QWidget *lineEdit = m_recipients.at(i).second;\n          if (!m_lastFocusedRecipient) { // apply only _once_\n              if (toCC->hasFocus())\n                  m_lastFocusedRecipient = toCC;\n              else if (lineEdit->hasFocus())\n                  m_lastFocusedRecipient = lineEdit;\n          }\n          if (toCC->isVisible())\n              visibleWidgets << toCC;\n          if (lineEdit->isVisible())\n              visibleWidgets << lineEdit;\n          ui->envelopeLayout->removeWidget(toCC);\n          ui->envelopeLayout->removeWidget(lineEdit);\n          toCC->hide();\n          lineEdit->hide();\n      }\n  \n      const int begin = qMin(m_recipients.count(), value);\n      const int end   = qMin(m_recipients.count(), value + m_maxVisibleRecipients);\n      for (int i = begin, j = 0; i < end; ++i, ++j) {\n          const int pos = actualRow(ui->envelopeLayout, j + OFFSET_OF_FIRST_ADDRESSEE);\n          QWidget *toCC = m_recipients.at(i).first;\n          QWidget *lineEdit = m_recipients.at(i).second;\n          ui->envelopeLayout->insertRow(pos, toCC, lineEdit);\n          if (!visibleWidgets.contains(toCC))\n              fadeIn(toCC);\n          visibleWidgets.removeOne(toCC);\n          if (!visibleWidgets.contains(lineEdit))\n              fadeIn(lineEdit);\n          visibleWidgets.removeOne(lineEdit);\n          toCC->show();\n          lineEdit->show();\n          setTabOrder(formPredecessor(ui->envelopeLayout, toCC), toCC);\n          setTabOrder(toCC, lineEdit);\n          if (toCC == m_lastFocusedRecipient)\n              toCC->setFocus();\n          else if (lineEdit == m_lastFocusedRecipient)\n              lineEdit->setFocus();\n      }\n  \n      if (m_lastFocusedRecipient && !m_lastFocusedRecipient->hasFocus() && QApplication::focusWidget())\n          ui->envelopeWidget->setFocus();\n  \n      Q_FOREACH (QWidget *w, visibleWidgets) {\n          // was visible, is no longer -> stop animation so it won't conflict later ones\n          w->setGraphicsEffect(0); // deletes old one\n          if (QPropertyAnimation *pa = w->findChild<QPropertyAnimation*>(trojita_opacityAnimation))\n              pa->stop();\n      }\n      connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "alueChanged(int))"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alueChanged(",
          "args": [
            "nt)"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alculateMaxVisibleRecipients(",
          "args": [],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "calculateMaxVisibleRecipients(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "511-552",
          "snippet": "oid ComposeWidget::calculateMaxVisibleRecipients()\n{\n    const int oldMaxVisibleRecipients = m_maxVisibleRecipients;\n    int spacing, bottom;\n    ui->envelopeLayout->getContentsMargins(&spacing, &spacing, &spacing, &bottom);\n    // we abuse the fact that there's always an addressee and that they all look the same\n    QRect itemRects[2];\n    for (int i = 0; i < 2; ++i) {\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::LabelRole)) {\n            itemRects[i] |= li->geometry();\n        }\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::FieldRole)) {\n            itemRects[i] |= li->geometry();\n        }\n        if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::SpanningRole)) {\n            itemRects[i] |= li->geometry();\n        }\n    }\n    int itemHeight = itemRects[0].height();\n    spacing = qMax(0, itemRects[0].top() - itemRects[1].bottom() - 1); // QFormLayout::[vertical]spacing() is useless ...\n    int firstTop = itemRects[0].top();\n    const int subjectHeight = ui->subject->height();\n    const int height = ui->verticalSplitter->sizes().at(0) - // entire splitter area\n                       firstTop - // offset of first recipient\n                       (subjectHeight + spacing) - // for the subject\n                       bottom - // layout bottom padding\n                       2; // extra pixels padding to detect that the user wants to shrink\n    if (itemHeight + spacing == 0) {\n        m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS;\n    } else {\n        m_maxVisibleRecipients = height / (itemHeight + spacing);\n    }\n    if (m_maxVisibleRecipients < MIN_MAX_VISIBLE_RECIPIENTS)\n        m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS; // allow up to 4 recipients w/o need for a sliding\n    if (oldMaxVisibleRecipients != m_maxVisibleRecipients) {\n        const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n        int v = qRound(1.0f*(ui->recipientSlider->value()*m_maxVisibleRecipients)/oldMaxVisibleRecipients);\n        ui->recipientSlider->setMaximum(max);\n        ui->recipientSlider->setVisible(max > 0);\n        scrollRecipients(qMin(qMax(0, v), max));\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::calculateMaxVisibleRecipients()\n  {\n      const int oldMaxVisibleRecipients = m_maxVisibleRecipients;\n      int spacing, bottom;\n      ui->envelopeLayout->getContentsMargins(&spacing, &spacing, &spacing, &bottom);\n      // we abuse the fact that there's always an addressee and that they all look the same\n      QRect itemRects[2];\n      for (int i = 0; i < 2; ++i) {\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::LabelRole)) {\n              itemRects[i] |= li->geometry();\n          }\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::FieldRole)) {\n              itemRects[i] |= li->geometry();\n          }\n          if (QLayoutItem *li = ui->envelopeLayout->itemAt(OFFSET_OF_FIRST_ADDRESSEE - i, QFormLayout::SpanningRole)) {\n              itemRects[i] |= li->geometry();\n          }\n      }\n      int itemHeight = itemRects[0].height();\n      spacing = qMax(0, itemRects[0].top() - itemRects[1].bottom() - 1); // QFormLayout::[vertical]spacing() is useless ...\n      int firstTop = itemRects[0].top();\n      const int subjectHeight = ui->subject->height();\n      const int height = ui->verticalSplitter->sizes().at(0) - // entire splitter area\n                         firstTop - // offset of first recipient\n                         (subjectHeight + spacing) - // for the subject\n                         bottom - // layout bottom padding\n                         2; // extra pixels padding to detect that the user wants to shrink\n      if (itemHeight + spacing == 0) {\n          m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS;\n      } else {\n          m_maxVisibleRecipients = height / (itemHeight + spacing);\n      }\n      if (m_maxVisibleRecipients < MIN_MAX_VISIBLE_RECIPIENTS)\n          m_maxVisibleRecipients = MIN_MAX_VISIBLE_RECIPIENTS; // allow up to 4 recipients w/o need for a sliding\n      if (oldMaxVisibleRecipients != m_maxVisibleRecipients) {\n          const int max = qMax(0, m_recipients.count() - m_maxVisibleRecipients);\n          int v = qRound(1.0f*(ui->recipientSlider->value()*m_maxVisibleRecipients)/oldMaxVisibleRecipients);\n          ui->recipientSlider->setMaximum(max);\n          ui->recipientSlider->setVisible(max > 0);\n          scrollRecipients(qMin(qMax(0, v), max));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->verticalSplitter,",
            "IGNAL(splitterMoved(int, int)),",
            "LOT(calculateMaxVisibleRecipients()))"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "alculateMaxVisibleRecipients())"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "plitterMoved(int, int))"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "plitterMoved(",
          "args": [
            "nt, int)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_recipientListUpdateTimer,",
            "IGNAL(timeout()),",
            "LOT(updateRecipientList()))"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "pdateRecipientList())"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pdateRecipientList(",
          "args": [],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "updateRecipientList(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "651-670",
          "snippet": "oid ComposeWidget::updateRecipientList()\n{\n    // we ensure there's always one empty available\n    bool haveEmpty = false;\n    for (int i = 0; i < m_recipients.count(); ++i) {\n        if (m_recipients.at(i).second->text().isEmpty()) {\n            if (haveEmpty) {\n                removeRecipient(i);\n            }\n            haveEmpty = true;\n        }\n    }\n    if (!haveEmpty) {\n        addRecipient(m_recipients.count(),\n                     m_recipients.isEmpty() ?\n                         Composer::ADDRESS_TO :\n                         recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                     QString());\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::updateRecipientList()\n  {\n      // we ensure there's always one empty available\n      bool haveEmpty = false;\n      for (int i = 0; i < m_recipients.count(); ++i) {\n          if (m_recipients.at(i).second->text().isEmpty()) {\n              if (haveEmpty) {\n                  removeRecipient(i);\n              }\n              haveEmpty = true;\n          }\n      }\n      if (!haveEmpty) {\n          addRecipient(m_recipients.count(),\n                       m_recipients.isEmpty() ?\n                           Composer::ADDRESS_TO :\n                           recipientKindForNextRow(currentRecipient(m_recipients.last().first)),\n                       QString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "imeout())"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "imeout(",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipientListUpdateTimer->setInterval",
          "args": [
            "50)"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_recipientListUpdateTimer->setSingleShot",
          "args": [
            "rue)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_completionPopup->installEventFilter",
          "args": [
            "his)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "i->attachButton,",
            "IGNAL(clicked()),",
            "his,",
            "LOT(slotAskForFileAttachment()))"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lotAskForFileAttachment())"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lotAskForFileAttachment(",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "slotAskForFileAttachment(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "945-952",
          "snippet": "oid ComposeWidget::slotAskForFileAttachment()\n{\n    QString fileName = QFileDialog::getOpenFileName(this, tr(\"Attach File...\"), QString(), QString(), 0,\n                                                    QFileDialog::DontResolveSymlinks);\n    if (!fileName.isEmpty()) {\n        m_submission->composer()->addFileAttachment(fileName);\n    }\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::slotAskForFileAttachment()\n  {\n      QString fileName = QFileDialog::getOpenFileName(this, tr(\"Attach File...\"), QString(), QString(), 0,\n                                                      QFileDialog::DontResolveSymlinks);\n      if (!fileName.isEmpty()) {\n          m_submission->composer()->addFileAttachment(fileName);\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "licked())"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "licked(",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "loadClicked(",
          "container": "oadablePartWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/LoadablePartWidget.cpp",
          "lines": "55-74",
          "snippet": "oid LoadablePartWidget::loadClicked()\n{\n    if (!partIndex.isValid()) {\n        if (loadButton) {\n            loadButton->setEnabled(false);\n        }\n        return;\n    }\n    if (loadButton) {\n        loadButton->deleteLater();\n        loadButton = 0;\n    }\n\n    // We have to disable any flags which might cause recursion here\n    realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                 (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                  | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n    addWidget(realPart);\n    setCurrentIndex(1);\n}",
          "includes": [
            "include <QPushButton>",
            "include \"Imap/Model/Utils.h\"",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#",
            "include \"LoadablePartWidget.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QPushButton>\ninclude \"Imap/Model/Utils.h\"\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/MessageView.h\" // so that the compiler knows that it's a QObject\n#\ninclude \"LoadablePartWidget.h\"\n#\n\noadablePartWidget {\n  oid LoadablePartWidget::loadClicked()\n  {\n      if (!partIndex.isValid()) {\n          if (loadButton) {\n              loadButton->setEnabled(false);\n          }\n          return;\n      }\n      if (loadButton) {\n          loadButton->deleteLater();\n          loadButton = 0;\n      }\n  \n      // We have to disable any flags which might cause recursion here\n      realPart = m_factory->create(partIndex, m_recursionDepth + 1,\n                                   (m_loadingMode | PartWidgetFactory::PART_IGNORE_CLICKTHROUGH\n                                    | PartWidgetFactory::PART_IGNORE_LOAD_ON_SHOW) ^ PartWidgetFactory::PART_IS_HIDDEN);\n      addWidget(realPart);\n      setCurrentIndex(1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "ancelButton,",
            "IGNAL(clicked()),",
            "his,",
            "LOT(close()))"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "lose())"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lose(",
          "args": [],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "close(",
          "container": "arser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Parser/Parser.cpp",
          "lines": "301-304",
          "snippet": "ommandHandle Parser::close()\n{\n    return queueCommand(Commands::ATOM, \"CLOSE\");\n}",
          "includes": [
            "include \"../Model/Utils.h\"",
            "include \"../../Streams/IODeviceSocket.h\"\n#",
            "include \"LowLevelParser.h\"\n#",
            "include \"Imap/Encoders.h\"\n#",
            "include \"Parser.h\"\n#",
            "include <QTimer>\n#",
            "include <QTime>\n#",
            "include <QSslError>\n#",
            "include <QProcess>\n#",
            "include <QMutexLocker>\n#",
            "include <QStringList>\n#",
            "include <QDebug>\n#",
            "include <algorithm>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"../Model/Utils.h\"\ninclude \"../../Streams/IODeviceSocket.h\"\n#\ninclude \"LowLevelParser.h\"\n#\ninclude \"Imap/Encoders.h\"\n#\ninclude \"Parser.h\"\n#\ninclude <QTimer>\n#\ninclude <QTime>\n#\ninclude <QSslError>\n#\ninclude <QProcess>\n#\ninclude <QMutexLocker>\n#\ninclude <QStringList>\n#\ninclude <QDebug>\n#\ninclude <algorithm>\n#\n\narser {\n  ommandHandle Parser::close()\n  {\n      return queueCommand(Commands::ATOM, \"CLOSE\");\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "licked())"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->buttonBox->addButton",
          "args": [
            "DialogButtonBox::Cancel)"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "endButton,",
            "IGNAL(clicked()),",
            "his,",
            "LOT(send()))"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "end())"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "licked())"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->buttonBox->addButton",
          "args": [
            "r(\"Send\"),",
            "DialogButtonBox::AcceptRole)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->attachmentsView->setComposer",
          "args": [
            "_submission->composer())"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_submission->composer",
          "args": [],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i->setupUi",
          "args": [
            "his)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_submission,",
            "IGNAL(passwordRequested(QString,QString)),",
            "his,",
            "LOT(passwordRequested(QString,QString)),",
            "t::QueuedConnection)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "asswordRequested(QString,QString))"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "asswordRequested(",
          "args": [
            "String,",
            "String)"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "passwordRequested(",
          "container": "omposeWidget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/ComposeWidget.cpp",
          "lines": "191-280",
          "snippet": "oid ComposeWidget::passwordRequested(const QString &user, const QString &host)\n{\n    bool ok;\n    const QString &password = Gui::PasswordDialog::getPassword(this, tr(\"Authentication Required\"),\n                                           tr(\"<p>Please provide SMTP password for user <b>%1</b> on <b>%2</b>:</p>\").arg(\n#if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                                               Qt::escape(user),\n                                               Qt::escape(host)\n#else\n                                               user.toHtmlEscaped(),\n                                               host.toHtmlEscaped()\n#endif\n                                               ),\n                                           QString(), &ok);\n    if (ok)\n        m_submission->setPassword(password);\n    else\n        m_submission->cancelPassword();\n}\n\nvoid ComposeWidget::changeEvent(QEvent *e)\n{\n    QWidget::changeEvent(e);\n    switch (e->type()) {\n    case QEvent::LanguageChange:\n        ui->retranslateUi(this);\n        break;\n    default:\n        break;\n    }\n}\n\n/**\n * We capture the close event and check whether there's something to save\n * (not sent, not up-to-date or persistent autostore)\n * The offer the user to store or omit the message or not close at all\n */\n\nvoid ComposeWidget::closeEvent(QCloseEvent *ce)\n{\n    const bool noSaveRequired = m_sentMail || ui->mailText->document()->isEmpty() || !m_messageEverEdited ||\n                                (m_explicitDraft && !m_messageUpdated); // autosave to permanent draft and no update\n    if (!noSaveRequired) {  // save is required\n        QMessageBox msgBox(this);\n        msgBox.setWindowModality(Qt::WindowModal);\n        msgBox.setWindowTitle(tr(\"Save Draft?\"));\n        QString message(tr(\"The mail has not been sent.<br>Do you want to save the draft?\"));\n        if (ui->attachmentsView->model()->rowCount() > 0)\n            message += tr(\"<br><span style=\\\"color:red\\\">Warning: Attachments are <b>not</b> saved with the draft!</span>\");\n        msgBox.setText(message);\n        msgBox.setStandardButtons(QMessageBox::Save | QMessageBox::Discard | QMessageBox::Cancel);\n        msgBox.setDefaultButton(QMessageBox::Save);\n        int ret = msgBox.exec();\n        if (ret == QMessageBox::Save) {\n            if (m_explicitDraft) { // editing a present draft - override it\n                saveDraft(m_autoSavePath);\n            } else {\n                // Explicitly stored drafts should be saved in a location with proper i18n support, so let's make sure both main\n                // window and this code uses the same tr() calls\n                QString path(Common::writablePath(Common::LOCATION_DATA) + Gui::MainWindow::tr(\"Drafts\"));\n                QDir().mkpath(path);\n                QString filename = ui->subject->text();\n                if (filename.isEmpty()) {\n                    filename = QDateTime::currentDateTime().toString(Qt::ISODate);\n                }\n                // Some characters are best avoided in file names. This is probably not a definitive list, but the hope is that\n                // it's going to be more readable than an unformatted hash or similar stuff.  The list of characters was taken\n                // from http://en.wikipedia.org/wiki/Filename#Reserved_characters_and_words .\n                filename.replace(QRegExp(QLatin1String(\"[/\\\\\\\\:\\\"|<>*?]\")), QLatin1String(\"_\"));\n                path = QFileDialog::getSaveFileName(this, tr(\"Save as\"), path + QLatin1Char('/') + filename + QLatin1String(\".draft\"),\n                                                    tr(\"Drafts\") + QLatin1String(\" (*.draft)\"));\n                if (path.isEmpty()) { // cancelled save\n                    ret = QMessageBox::Cancel;\n                } else {\n                    m_explicitDraft = true;\n                    saveDraft(path);\n                    if (path != m_autoSavePath) // we can remove the temp save\n                        QFile::remove(m_autoSavePath);\n                }\n            }\n        }\n        if (ret == QMessageBox::Cancel) {\n            ce->ignore(); // don't close the window\n            return;\n        }\n    }\n    if (m_sentMail || !m_explicitDraft) // is the mail has been sent or the user does not want to store it\n        QFile::remove(m_autoSavePath); // get rid of draft\n    ce->accept(); // ultimately close the window\n}",
          "includes": [
            "include \"Imap/Tasks/UidSubmitTask.h\"",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/ItemRoles.h\"\n#",
            "include \"Gui/Window.h\"\n#",
            "include \"Gui/Util.h\"\n#",
            "include \"Gui/ProgressPopUp.h\"\n#",
            "include \"Gui/PasswordDialog.h\"\n#",
            "include \"Gui/OverlayWidget.h\"\n#",
            "include \"Gui/LineEdit.h\"\n#",
            "include \"Gui/IconLoader.h\"\n#",
            "include \"Gui/FromAddressProxyModel.h\"\n#",
            "include \"Gui/ComposeWidget.h\"\n#",
            "include \"Gui/AutoCompletion.h\"\n#",
            "include \"Gui/AbstractAddressbook.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/InvokeMethod.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/ReplaceSignature.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"ui_ComposeWidget.h\"\n#",
            "include <QToolButton>",
            "include <QTimer>\n#",
            "include <QSettings>\n#",
            "include <QPushButton>\n#",
            "include <QPropertyAnimation>\n#",
            "include <QProgressDialog>\n#",
            "include <QMessageBox>\n#",
            "include <QMenu>\n#",
            "include <QKeyEvent>\n#",
            "include <QGraphicsOpacityEffect>\n#",
            "include <QFileDialog>\n#",
            "include <QBuffer>\n#",
            "include <QAbstractProxyModel>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  oid ComposeWidget::passwordRequested(const QString &user, const QString &host)\n  {\n      bool ok;\n      const QString &password = Gui::PasswordDialog::getPassword(this, tr(\"Authentication Required\"),\n                                             tr(\"<p>Please provide SMTP password for user <b>%1</b> on <b>%2</b>:</p>\").arg(\n  #if QT_VERSION < QT_VERSION_CHECK(5, 0, 0)\n                                                 Qt::escape(user),\n                                                 Qt::escape(host)\n  #else\n                                                 user.toHtmlEscaped(),\n                                                 host.toHtmlEscaped()\n  #endif\n                                                 ),\n                                             QString(), &ok);\n      if (ok)\n          m_submission->setPassword(password);\n      else\n          m_submission->cancelPassword();\n  }\n  \n  void ComposeWidget::changeEvent(QEvent *e)\n  {\n      QWidget::changeEvent(e);\n      switch (e->type()) {\n      case QEvent::LanguageChange:\n          ui->retranslateUi(this);\n          break;\n      default:\n          break;\n      }\n  }\n  \n  /**\n   * We capture the close event and check whether there's something to save\n   * (not sent, not up-to-date or persistent autostore)\n   * The offer the user to store or omit the message or not close at all\n   */\n  \n  void ComposeWidget::closeEvent(QCloseEvent *ce)\n  {\n      const bool noSaveRequired = m_sentMail || ui->mailText->document()->isEmpty() || !m_messageEverEdited ||\n                                  (m_explicitDraft && !m_messageUpdated); // autosave to permanent draft and no update\n      if (!noSaveRequired) {  // save is required\n          QMessageBox msgBox(this);\n          msgBox.setWindowModality(Qt::WindowModal);\n          msgBox.setWindowTitle(tr(\"Save Draft?\"));\n          QString message(tr(\"The mail has not been sent.<br>Do you want to save the draft?\"));\n          if (ui->attachmentsView->model()->rowCount() > 0)\n              message += tr(\"<br><span style=\\\"color:red\\\">Warning: Attachments are <b>not</b> saved with the draft!</span>\");\n          msgBox.setText(message);\n          msgBox.setStandardButtons(QMessageBox::Save | QMessageBox::Discard | QMessageBox::Cancel);\n          msgBox.setDefaultButton(QMessageBox::Save);\n          int ret = msgBox.exec();\n          if (ret == QMessageBox::Save) {\n              if (m_explicitDraft) { // editing a present draft - override it\n                  saveDraft(m_autoSavePath);\n              } else {\n                  // Explicitly stored drafts should be saved in a location with proper i18n support, so let's make sure both main\n                  // window and this code uses the same tr() calls\n                  QString path(Common::writablePath(Common::LOCATION_DATA) + Gui::MainWindow::tr(\"Drafts\"));\n                  QDir().mkpath(path);\n                  QString filename = ui->subject->text();\n                  if (filename.isEmpty()) {\n                      filename = QDateTime::currentDateTime().toString(Qt::ISODate);\n                  }\n                  // Some characters are best avoided in file names. This is probably not a definitive list, but the hope is that\n                  // it's going to be more readable than an unformatted hash or similar stuff.  The list of characters was taken\n                  // from http://en.wikipedia.org/wiki/Filename#Reserved_characters_and_words .\n                  filename.replace(QRegExp(QLatin1String(\"[/\\\\\\\\:\\\"|<>*?]\")), QLatin1String(\"_\"));\n                  path = QFileDialog::getSaveFileName(this, tr(\"Save as\"), path + QLatin1Char('/') + filename + QLatin1String(\".draft\"),\n                                                      tr(\"Drafts\") + QLatin1String(\" (*.draft)\"));\n                  if (path.isEmpty()) { // cancelled save\n                      ret = QMessageBox::Cancel;\n                  } else {\n                      m_explicitDraft = true;\n                      saveDraft(path);\n                      if (path != m_autoSavePath) // we can remove the temp save\n                          QFile::remove(m_autoSavePath);\n                  }\n              }\n          }\n          if (ret == QMessageBox::Cancel) {\n              ce->ignore(); // don't close the window\n              return;\n          }\n      }\n      if (m_sentMail || !m_explicitDraft) // is the mail has been sent or the user does not want to store it\n          QFile::remove(m_autoSavePath); // get rid of draft\n      ce->accept(); // ultimately close the window\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "asswordRequested(QString,QString))"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_submission,",
            "IGNAL(failed(QString)),",
            "his,",
            "LOT(gotError(QString)))"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "otError(QString))"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ailed(QString))"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ailed(",
          "args": [
            "String)"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "authenticationFailed(const QS",
          "container": "w",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/Window.cpp",
          "lines": "1103-1107",
          "snippet": "Window::authenticationFailed(const QString &message)\n{\n    m_ignoreStoredPassword = true;\n    QMessageBox::warning(this, tr(\"Login Failed\"), message);\n}\n\nvoid Ma",
          "includes": [
            "include \"Imap/Model/ModelTest/modeltest.h\"",
            "include \"ui_AboutDialog.h\"",
            "include \"ui_CreateMailboxDialog.h\"\n#",
            "include \"ShortcutHandler/ShortcutHandler.h\"",
            "include \"Window.h\"\n#",
            "include \"Util.h\"\n#",
            "include \"TaskProgressIndicator.h\"\n#",
            "include \"Streams/SocketFactory.h\"\n#",
            "include \"SimplePartWidget.h\"\n#",
            "include \"SettingsDialog.h\"\n#",
            "include \"ProtocolLoggerWidget.h\"\n#",
            "include \"PasswordDialog.h\"\n#",
            "include \"OnePanelAtTimeWidget.h\"\n#",
            "include \"MsgListView.h\"\n#",
            "include \"MessageSourceWidget.h\"\n#",
            "include \"MessageView.h\"\n#",
            "include \"MessageListWidget.h\"\n#",
            "include \"MailBoxTreeView.h\"\n#",
            "include \"IconLoader.h\"\n#",
            "include \"ComposeWidget.h\"\n#",
            "include \"CompleteMessageWidget.h\"\n#",
            "include \"Plugins/PluginManager.h\"\n#",
            "include \"MSA/SMTP.h\"\n#",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Network/FileDownloadManager.h\"\n#",
            "include \"Imap/Model/Utils.h\"\n#",
            "include \"Imap/Model/ThreadingMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMsgListModel.h\"\n#",
            "include \"Imap/Model/PrettyMailboxModel.h\"\n#",
            "include \"Imap/Model/NetworkWatcher.h\"\n#",
            "include \"Imap/Model/MsgListModel.h\"\n#",
            "include \"Imap/Model/ModelWatcher.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Imap/Model/MailboxTree.h\"\n#",
            "include \"Imap/Model/ImapAccess.h\"\n#",
            "include \"Composer/SenderIdentitiesModel.h\"\n#",
            "include \"Composer/Mailto.h\"\n#",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/PortNumbers.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include \"Common/Application.h\"\n#",
            "include \"AbookAddressbook/be-contacts.h\"\n#",
            "include \"AbookAddressbook/AbookAddressbook.h\"\n#",
            "include <QUrlQuery>\n#",
            "include <QUrl>\n#",
            "include <QToolButton>\n#",
            "include <QToolBar>\n#",
            "include <QTextDocument>\n#",
            "include <QStatusBar>\n#",
            "include <QStackedWidget>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSplitter>\n#",
            "include <QProgressBar>\n#",
            "include <QMessageBox>\n#",
            "include <QMenuBar>\n#",
            "include <QItemSelectionModel>\n#",
            "include <QHeaderView>\n#",
            "include <QFileDialog>\n#",
            "include <QDockWidget>\n#",
            "include <QDir>\n#",
            "include <QDesktopWidget>\n#",
            "include <QDesktopServices>\n#",
            "include <QAuthenticator>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"Imap/Model/ModelTest/modeltest.h\"\ninclude \"ui_AboutDialog.h\"\ninclude \"ui_CreateMailboxDialog.h\"\n#\ninclude \"ShortcutHandler/ShortcutHandler.h\"\ninclude \"Window.h\"\n#\ninclude \"Util.h\"\n#\ninclude \"TaskProgressIndicator.h\"\n#\ninclude \"Streams/SocketFactory.h\"\n#\ninclude \"SimplePartWidget.h\"\n#\ninclude \"SettingsDialog.h\"\n#\ninclude \"ProtocolLoggerWidget.h\"\n#\ninclude \"PasswordDialog.h\"\n#\ninclude \"OnePanelAtTimeWidget.h\"\n#\ninclude \"MsgListView.h\"\n#\ninclude \"MessageSourceWidget.h\"\n#\ninclude \"MessageView.h\"\n#\ninclude \"MessageListWidget.h\"\n#\ninclude \"MailBoxTreeView.h\"\n#\ninclude \"IconLoader.h\"\n#\ninclude \"ComposeWidget.h\"\n#\ninclude \"CompleteMessageWidget.h\"\n#\ninclude \"Plugins/PluginManager.h\"\n#\ninclude \"MSA/SMTP.h\"\n#\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Network/FileDownloadManager.h\"\n#\ninclude \"Imap/Model/Utils.h\"\n#\ninclude \"Imap/Model/ThreadingMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMsgListModel.h\"\n#\ninclude \"Imap/Model/PrettyMailboxModel.h\"\n#\ninclude \"Imap/Model/NetworkWatcher.h\"\n#\ninclude \"Imap/Model/MsgListModel.h\"\n#\ninclude \"Imap/Model/ModelWatcher.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/MailboxTree.h\"\n#\ninclude \"Imap/Model/ImapAccess.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/Mailto.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/PortNumbers.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/Application.h\"\n#\ninclude \"AbookAddressbook/be-contacts.h\"\n#\ninclude \"AbookAddressbook/AbookAddressbook.h\"\n#\ninclude <QUrlQuery>\n#\ninclude <QUrl>\n#\ninclude <QToolButton>\n#\ninclude <QToolBar>\n#\ninclude <QTextDocument>\n#\ninclude <QStatusBar>\n#\ninclude <QStackedWidget>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSplitter>\n#\ninclude <QProgressBar>\n#\ninclude <QMessageBox>\n#\ninclude <QMenuBar>\n#\ninclude <QItemSelectionModel>\n#\ninclude <QHeaderView>\n#\ninclude <QFileDialog>\n#\ninclude <QDockWidget>\n#\ninclude <QDir>\n#\ninclude <QDesktopWidget>\n#\ninclude <QDesktopServices>\n#\ninclude <QAuthenticator>\n#\n\nw {\n  Window::authenticationFailed(const QString &message)\n  {\n      m_ignoreStoredPassword = true;\n      QMessageBox::warning(this, tr(\"Login Failed\"), message);\n  }\n  \n  void Ma\n}"
        }
      },
      {
        "call_info": {
          "callee": "onnect(",
          "args": [
            "_submission,",
            "IGNAL(succeeded()),",
            "his,",
            "LOT(sent()))"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LOT(",
          "args": [
            "ent())"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IGNAL(",
          "args": [
            "ucceeded())"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ucceeded(",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "slotAppendSucceeded(",
          "container": "ubmission",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Composer/Submission.cpp",
          "lines": "347-364",
          "snippet": "oid Submission::slotAppendSucceeded()\n{\n    if (m_appendUid && m_appendUidValidity) {\n        // Only ever consider valid UIDVALIDITY/UID pair\n        m_appendUidReceived = true;\n\n        if (m_useBurl) {\n            slotAskForUrl();\n        } else {\n            slotInvokeMsaNow();\n        }\n    } else {\n        m_useBurl = false;\n        m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                          QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n        slotInvokeMsaNow();\n    }\n}",
          "includes": [
            "include \"MSA/SMTP.h\"",
            "include \"MSA/Sendmail.h\"\n#",
            "include \"Imap/Tasks/UidSubmitTask.h\"\n#",
            "include \"Imap/Tasks/GenUrlAuthTask.h\"\n#",
            "include \"Imap/Tasks/AppendTask.h\"\n#",
            "include \"Imap/Model/Model.h\"\n#",
            "include \"Composer/MessageComposer.h\"\n#",
            "include \"Composer/Submission.h\"\n#",
            "include <QSettings>\n#",
            "include <QBuffer>\n#",
            "include <QCoreApplication>\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include \"MSA/SMTP.h\"\ninclude \"MSA/Sendmail.h\"\n#\ninclude \"Imap/Tasks/UidSubmitTask.h\"\n#\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude <QSettings>\n#\ninclude <QBuffer>\n#\ninclude <QCoreApplication>\n#\n\nubmission {\n  oid Submission::slotAppendSucceeded()\n  {\n      if (m_appendUid && m_appendUidValidity) {\n          // Only ever consider valid UIDVALIDITY/UID pair\n          m_appendUidReceived = true;\n  \n          if (m_useBurl) {\n              slotAskForUrl();\n          } else {\n              slotInvokeMsaNow();\n          }\n      } else {\n          m_useBurl = false;\n          m_model->logTrace(0, Common::LOG_OTHER, QLatin1String(\"Submission\"),\n                            QLatin1String(\"APPEND does not contain APPENDUID or UIDVALIDITY, cannot use BURL or the SUBMIT command\"));\n          slotInvokeMsaNow();\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_mainWindow->imapModel",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_ASSERT(",
          "args": [
            "_mainWindow)"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etWindowIcon(",
          "args": [
            "inIcon)"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inIcon.addFile",
          "args": [
            "Latin1String(\":/icons/trojita-edit-small.png\"),",
            "Size(22, 22))"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Size(",
          "args": [
            "2,",
            "2)"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "prettySize(",
          "container": "rettySize",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Imap/Model/Utils.cpp",
          "lines": "50-76",
          "snippet": "String PrettySize::prettySize(uint bytes, const ShowBytesSuffix compactUnitFormat)\n{\n    if (bytes == 0) {\n        return tr(\"0\");\n    }\n    int order = std::log(static_cast<double>(bytes)) / std::log(1024.0);\n    double number = bytes / std::pow(1024.0, order);\n\n    QString suffix;\n    if (order <= 0) {\n        if (compactUnitFormat == COMPACT_FORM)\n            return QString::number(bytes);\n        else\n            return tr(\"%1 bytes\").arg(QString::number(bytes));\n    } else if (order == 1) {\n        suffix = tr(\"kB\");\n    } else if (order == 2) {\n        suffix = tr(\"MB\");\n    } else if (order == 3) {\n        suffix = tr(\"GB\");\n    } else {\n        // make sure not to show wrong size for those that have > 1024 TB e-mail messages\n        order = 4;\n        suffix = tr(\"TB\"); // shame on you for such mails\n    }\n    return tr(\"%1 %2\").arg(QString::number(number, 'f', number < 100 ? 1 : 0), suffix);\n}",
          "includes": [
            "include <QSystemDeviceInfo>\n#",
            "include \"Imap/Model/Model.h\"",
            "include \"Common/SettingsNames.h\"\n#",
            "include \"Common/Paths.h\"\n#",
            "include <QTextDocument>",
            "include <QSysInfo>\n#",
            "include <QSslKey>\n#",
            "include <QSslError>\n#",
            "include <QSettings>\n#",
            "include <QProcess>\n#",
            "include <QLocale>\n#",
            "include <QGuiApplication>\n#",
            "include <QDir>\n#",
            "include <QDateTime>\n#",
            "include <cmath>\n#",
            "include \"Utils.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QSystemDeviceInfo>\n#\ninclude \"Imap/Model/Model.h\"\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude <QTextDocument>\ninclude <QSysInfo>\n#\ninclude <QSslKey>\n#\ninclude <QSslError>\n#\ninclude <QSettings>\n#\ninclude <QProcess>\n#\ninclude <QLocale>\n#\ninclude <QGuiApplication>\n#\ninclude <QDir>\n#\ninclude <QDateTime>\n#\ninclude <cmath>\n#\ninclude \"Utils.h\"\n#\n\nrettySize {\n  String PrettySize::prettySize(uint bytes, const ShowBytesSuffix compactUnitFormat)\n  {\n      if (bytes == 0) {\n          return tr(\"0\");\n      }\n      int order = std::log(static_cast<double>(bytes)) / std::log(1024.0);\n      double number = bytes / std::pow(1024.0, order);\n  \n      QString suffix;\n      if (order <= 0) {\n          if (compactUnitFormat == COMPACT_FORM)\n              return QString::number(bytes);\n          else\n              return tr(\"%1 bytes\").arg(QString::number(bytes));\n      } else if (order == 1) {\n          suffix = tr(\"kB\");\n      } else if (order == 2) {\n          suffix = tr(\"MB\");\n      } else if (order == 3) {\n          suffix = tr(\"GB\");\n      } else {\n          // make sure not to show wrong size for those that have > 1024 TB e-mail messages\n          order = 4;\n          suffix = tr(\"TB\"); // shame on you for such mails\n      }\n      return tr(\"%1 %2\").arg(QString::number(number, 'f', number < 100 ? 1 : 0), suffix);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ":/icons/trojita-edit-small.png\")"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inIcon.addFile",
          "args": [
            "Latin1String(\":/icons/trojita-edit-big.png\"),",
            "Size(128, 128))"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Latin1String(",
          "args": [
            ":/icons/trojita-edit-big.png\")"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etAttribute(",
          "args": [
            "t::WA_DeleteOnClose,",
            "rue)"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include \"Imap/Tasks/UidSubmitTask.h\"\ninclude \"Imap/Tasks/GenUrlAuthTask.h\"\n#\ninclude \"Imap/Tasks/AppendTask.h\"\n#\ninclude \"Imap/Model/Model.h\"\n#\ninclude \"Imap/Model/ItemRoles.h\"\n#\ninclude \"Gui/Window.h\"\n#\ninclude \"Gui/Util.h\"\n#\ninclude \"Gui/ProgressPopUp.h\"\n#\ninclude \"Gui/PasswordDialog.h\"\n#\ninclude \"Gui/OverlayWidget.h\"\n#\ninclude \"Gui/LineEdit.h\"\n#\ninclude \"Gui/IconLoader.h\"\n#\ninclude \"Gui/FromAddressProxyModel.h\"\n#\ninclude \"Gui/ComposeWidget.h\"\n#\ninclude \"Gui/AutoCompletion.h\"\n#\ninclude \"Gui/AbstractAddressbook.h\"\n#\ninclude \"Common/SettingsNames.h\"\n#\ninclude \"Common/Paths.h\"\n#\ninclude \"Common/InvokeMethod.h\"\n#\ninclude \"Composer/Submission.h\"\n#\ninclude \"Composer/SenderIdentitiesModel.h\"\n#\ninclude \"Composer/ReplaceSignature.h\"\n#\ninclude \"Composer/MessageComposer.h\"\n#\ninclude \"ui_ComposeWidget.h\"\n#\ninclude <QToolButton>\ninclude <QTimer>\n#\ninclude <QSettings>\n#\ninclude <QPushButton>\n#\ninclude <QPropertyAnimation>\n#\ninclude <QProgressDialog>\n#\ninclude <QMessageBox>\n#\ninclude <QMenu>\n#\ninclude <QKeyEvent>\n#\ninclude <QGraphicsOpacityEffect>\n#\ninclude <QFileDialog>\n#\ninclude <QBuffer>\n#\ninclude <QAbstractProxyModel>\n#\n\nomposeWidget {\n  omposeWidget::ComposeWidget(MainWindow *mainWindow, QSettings *settings, MSA::MSAFactory *msaFactory) :\n      QWidget(0, Qt::Window),\n      ui(new Ui::ComposeWidget),\n      m_maxVisibleRecipients(MIN_MAX_VISIBLE_RECIPIENTS),\n      m_sentMail(false),\n      m_messageUpdated(false),\n      m_messageEverEdited(false),\n      m_explicitDraft(false),\n      m_appendUidReceived(false), m_appendUidValidity(0), m_appendUid(0), m_genUrlAuthReceived(false),\n      m_mainWindow(mainWindow),\n      m_settings(settings)\n  {\n      setAttribute(Qt::WA_DeleteOnClose, true);\n  \n      QIcon winIcon;\n      winIcon.addFile(QLatin1String(\":/icons/trojita-edit-big.png\"), QSize(128, 128));\n      winIcon.addFile(QLatin1String(\":/icons/trojita-edit-small.png\"), QSize(22, 22));\n      setWindowIcon(winIcon);\n  \n      Q_ASSERT(m_mainWindow);\n      m_submission = new Composer::Submission(this, m_mainWindow->imapModel(), msaFactory);\n      connect(m_submission, SIGNAL(succeeded()), this, SLOT(sent()));\n      connect(m_submission, SIGNAL(failed(QString)), this, SLOT(gotError(QString)));\n      connect(m_submission, SIGNAL(passwordRequested(QString,QString)), this, SLOT(passwordRequested(QString,QString)), Qt::QueuedConnection);\n  \n      ui->setupUi(this);\n      ui->attachmentsView->setComposer(m_submission->composer());\n      sendButton = ui->buttonBox->addButton(tr(\"Send\"), QDialogButtonBox::AcceptRole);\n      connect(sendButton, SIGNAL(clicked()), this, SLOT(send()));\n      cancelButton = ui->buttonBox->addButton(QDialogButtonBox::Cancel);\n      connect(cancelButton, SIGNAL(clicked()), this, SLOT(close()));\n      connect(ui->attachButton, SIGNAL(clicked()), this, SLOT(slotAskForFileAttachment()));\n  \n      m_completionPopup = new QMenu(this);\n      m_completionPopup->installEventFilter(this);\n      connect(m_completionPopup, SIGNAL(triggered(QAction*)), SLOT(completeRecipient(QAction*)));\n  \n      // TODO: make this configurable?\n      m_completionCount = 8;\n  \n      m_recipientListUpdateTimer = new QTimer(this);\n      m_recipientListUpdateTimer->setSingleShot(true);\n      m_recipientListUpdateTimer->setInterval(250);\n      connect(m_recipientListUpdateTimer, SIGNAL(timeout()), SLOT(updateRecipientList()));\n  \n      connect(ui->verticalSplitter, SIGNAL(splitterMoved(int, int)), SLOT(calculateMaxVisibleRecipients()));\n      calculateMaxVisibleRecipients();\n  \n      connect(ui->recipientSlider, SIGNAL(valueChanged(int)), SLOT(scrollRecipients(int)));\n      connect(qApp, SIGNAL(focusChanged(QWidget*,QWidget*)), SLOT(handleFocusChange()));\n      ui->recipientSlider->setMinimum(0);\n      ui->recipientSlider->setMaximum(0);\n      ui->recipientSlider->setVisible(false);\n      ui->envelopeWidget->installEventFilter(this);\n  \n      m_markButton = new QToolButton(ui->buttonBox);\n      m_markButton->setPopupMode(QToolButton::MenuButtonPopup);\n      m_markButton->setToolButtonStyle(Qt::ToolButtonTextBesideIcon);\n      m_markAsReply = new QActionGroup(m_markButton);\n      m_markAsReply->setExclusive(true);\n      auto *asReplyMenu = new QMenu(m_markButton);\n      m_markButton->setMenu(asReplyMenu);\n      m_actionStandalone = asReplyMenu->addAction(Gui::loadIcon(QLatin1String(\"mail-view-flat\")), tr(\"New Thread\"));\n      m_actionStandalone->setActionGroup(m_markAsReply);\n      m_actionStandalone->setCheckable(true);\n      m_actionStandalone->setToolTip(tr(\"This mail will be sent as a standalone message.<hr/>Change to preserve the reply hierarchy.\"));\n      m_actionInReplyTo = asReplyMenu->addAction(Gui::loadIcon(QLatin1String(\"mail-view-threaded\")), tr(\"Threaded\"));\n      m_actionInReplyTo->setActionGroup(m_markAsReply);\n      m_actionInReplyTo->setCheckable(true);\n  \n      // This is a \"quick shortcut action\". It shows the UI bits of the current option, but when the user clicks it,\n      // the *other* action is triggered.\n      m_actionToggleMarking = new QAction(m_markButton);\n      connect(m_actionToggleMarking, SIGNAL(triggered()), this, SLOT(toggleReplyMarking()));\n      m_markButton->setDefaultAction(m_actionToggleMarking);\n  \n      // Unfortunately, there's no signal for toggled(QAction*), so we'll have to call QAction::trigger() to have this working\n      connect(m_markAsReply, SIGNAL(triggered(QAction*)), this, SLOT(updateReplyMarkingAction()));\n      m_actionStandalone->trigger();\n      // We want to have the button aligned to the left; the only \"portable\" way of this is the ResetRole\n      // (thanks to TL for mentioning this, and for the Qt's doc for providing pretty pictures on different platforms)\n      ui->buttonBox->addButton(m_markButton, QDialogButtonBox::ResetRole);\n      m_markButton->hide();\n  \n      ui->mailText->setFont(Gui::Util::systemMonospaceFont());\n  \n      connect(ui->mailText, SIGNAL(urlsAdded(QList<QUrl>)), SLOT(slotAttachFiles(QList<QUrl>)));\n      connect(ui->mailText, SIGNAL(sendRequest()), SLOT(send()));\n      connect(ui->mailText, SIGNAL(textChanged()), SLOT(setMessageUpdated()));\n      connect(ui->subject, SIGNAL(textChanged(QString)), SLOT(updateWindowTitle()));\n  \n      FromAddressProxyModel *proxy = new FromAddressProxyModel(this);\n      proxy->setSourceModel(m_mainWindow->senderIdentitiesModel());\n      ui->sender->setModel(proxy);\n  \n      connect(ui->sender, SIGNAL(currentIndexChanged(int)), SLOT(slotUpdateSignature()));\n      connect(ui->sender, SIGNAL(editTextChanged(QString)), SLOT(setMessageUpdated()));\n      connect(ui->sender->lineEdit(), SIGNAL(textChanged(QString)), SLOT(slotCheckAddress()));\n  \n      QTimer *autoSaveTimer = new QTimer(this);\n      connect(autoSaveTimer, SIGNAL(timeout()), SLOT(autoSaveDraft()));\n      autoSaveTimer->start(30*1000);\n  \n      // these are for the automatically saved drafts, i.e. no i18n for the dir name\n      m_autoSavePath = QString(Common::writablePath(Common::LOCATION_CACHE) + QLatin1String(\"Drafts/\"));\n      QDir().mkpath(m_autoSavePath);\n  \n  #if QT_VERSION < QT_VERSION_CHECK(4, 7, 0)\n      m_autoSavePath += QString::number(QDateTime(QDate(1970, 1, 1), QTime(0, 0, 0)).secsTo(QDateTime::currentDateTime())) + QLatin1String(\".draft\");\n  #else\n      m_autoSavePath += QString::number(QDateTime::currentMSecsSinceEpoch()) + QLatin1String(\".draft\");\n  #endif\n  }\n}"
  }
]