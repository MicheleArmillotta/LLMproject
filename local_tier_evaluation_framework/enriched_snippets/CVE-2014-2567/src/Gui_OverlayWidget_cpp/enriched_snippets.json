[
  {
    "function_name": "eventFilter(",
    "container": "verlayWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/OverlayWidget.cpp",
    "lines": "45-55",
    "snippet": "ool OverlayWidget::eventFilter(QObject *obj, QEvent *event)\n{\n    if (obj != parent())\n        return false;\n\n    if (event->type() == QEvent::Resize) {\n        QResizeEvent *e = static_cast<QResizeEvent*>(event);\n        resize(e->size());\n    }\n    return false;\n}",
    "includes": [
      "include <QDebug>",
      "include <QHBoxLayout>",
      "include <QResizeEvent>\n#",
      "include \"OverlayWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "esize(",
          "args": [
            "->size())"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "->size",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "sizeHint",
          "container": "FlowLayout",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/FlowLayout.cpp",
          "lines": "131-134",
          "snippet": "QSize FlowLayout::sizeHint() const\n{\n    return minimumSize();\n}",
          "includes": [
            "#include \"FlowLayout.h\"",
            "#include <QWidget>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"FlowLayout.h\"\n#include <QWidget>\n\nFlowLayout {\n  QSize FlowLayout::sizeHint() const\n  {\n      return minimumSize();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tatic_cast<QResizeEvent*>",
          "args": [
            "vent)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vent->type",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "QMimeMagicRule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/mimetypes-qt4/mimetypes/qmimemagicrule.cpp",
          "lines": "328-331",
          "snippet": "QMimeMagicRule::Type QMimeMagicRule::type() const\n{\n    return d->type;\n}",
          "includes": [
            "#include <qendian.h>",
            "#include <QDebug>",
            "#include <QList>",
            "#include \"qmimemagicrule_p.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qendian.h>\n#include <QDebug>\n#include <QList>\n#include \"qmimemagicrule_p.h\"\n\nQMimeMagicRule {\n  QMimeMagicRule::Type QMimeMagicRule::type() const\n  {\n      return d->type;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "arent(",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "findScrollParent(",
          "container": "mbeddedWebView",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/EmbeddedWebView.cpp",
          "lines": "178-212",
          "snippet": "oid EmbeddedWebView::findScrollParent()\n{\n    if (m_scrollParent)\n        m_scrollParent->removeEventFilter(this);\n    m_scrollParent = 0;\n    m_scrollParentPadding = 4;\n    QWidget *runner = this;\n    int left, top, right, bottom;\n    while (runner) {\n        runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n        runner->getContentsMargins(&left, &top, &right, &bottom);\n        m_scrollParentPadding += left + right + 4;\n        if (runner->layout()) {\n            runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right;\n        }\n        QWidget *p = runner->parentWidget();\n        if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n            p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n            qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n            p->getContentsMargins(&left, &top, &right, &bottom);\n            m_scrollParentPadding += left + right + 4;\n            if (p->layout()) {\n                p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                m_scrollParentPadding += left + right;\n            }\n            m_scrollParent = p->parentWidget();\n            break; // then we have our actual message view\n        }\n        runner = p;\n    }\n    m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n    if (m_scrollParent)\n        m_scrollParent->installEventFilter(this);\n}",
          "includes": [
            "include <QDebug>",
            "include <QWebHistory>",
            "include <QWebFrame>\n#",
            "include <QStyleFactory>\n#",
            "include <QStyle>\n#",
            "include <QNetworkReply>\n#",
            "include <QLayout>\n#",
            "include <QDesktopServices>\n#",
            "include <QApplication>\n#",
            "include <QAction>\n#",
            "include <QAbstractScrollArea>\n#",
            "include \"Gui/Util.h\"",
            "include \"MessageView.h\"\n#",
            "include \"EmbeddedWebView.h\"\n#"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "include <QDebug>\ninclude <QWebHistory>\ninclude <QWebFrame>\n#\ninclude <QStyleFactory>\n#\ninclude <QStyle>\n#\ninclude <QNetworkReply>\n#\ninclude <QLayout>\n#\ninclude <QDesktopServices>\n#\ninclude <QApplication>\n#\ninclude <QAction>\n#\ninclude <QAbstractScrollArea>\n#\ninclude \"Gui/Util.h\"\ninclude \"MessageView.h\"\n#\ninclude \"EmbeddedWebView.h\"\n#\n\nmbeddedWebView {\n  oid EmbeddedWebView::findScrollParent()\n  {\n      if (m_scrollParent)\n          m_scrollParent->removeEventFilter(this);\n      m_scrollParent = 0;\n      m_scrollParentPadding = 4;\n      QWidget *runner = this;\n      int left, top, right, bottom;\n      while (runner) {\n          runner->setSizePolicy(QSizePolicy::Preferred, QSizePolicy::Preferred);\n          runner->getContentsMargins(&left, &top, &right, &bottom);\n          m_scrollParentPadding += left + right + 4;\n          if (runner->layout()) {\n              runner->layout()->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right;\n          }\n          QWidget *p = runner->parentWidget();\n          if (p && qobject_cast<MessageView*>(runner) && // is this a MessageView?\n              p->objectName() == \"qt_scrollarea_viewport\" && // in a viewport?\n              qobject_cast<QAbstractScrollArea*>(p->parentWidget())) { // that is used?\n              p->getContentsMargins(&left, &top, &right, &bottom);\n              m_scrollParentPadding += left + right + 4;\n              if (p->layout()) {\n                  p->layout()->getContentsMargins(&left, &top, &right, &bottom);\n                  m_scrollParentPadding += left + right;\n              }\n              m_scrollParent = p->parentWidget();\n              break; // then we have our actual message view\n          }\n          runner = p;\n      }\n      m_scrollParentPadding += style()->pixelMetric(QStyle::PM_ScrollBarExtent, 0, m_scrollParent);\n      if (m_scrollParent)\n          m_scrollParent->installEventFilter(this);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QHBoxLayout>\ninclude <QResizeEvent>\n#\ninclude \"OverlayWidget.h\"\n#\n\nverlayWidget {\n  ool OverlayWidget::eventFilter(QObject *obj, QEvent *event)\n  {\n      if (obj != parent())\n          return false;\n  \n      if (event->type() == QEvent::Resize) {\n          QResizeEvent *e = static_cast<QResizeEvent*>(event);\n          resize(e->size());\n      }\n      return false;\n  }\n}"
  },
  {
    "function_name": "OverlayWidget(",
    "container": "verlayWidget",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2014-2567/repo/src/Gui/OverlayWidget.cpp",
    "lines": "32-43",
    "snippet": "verlayWidget::OverlayWidget(QWidget *what, QWidget *parent): QWidget(parent), m_widget(what)\n{\n    m_widget->setParent(this);\n    QHBoxLayout *layout = new QHBoxLayout(this);\n    layout->addStretch(1);\n    layout->addWidget(m_widget);\n    layout->addStretch(1);\n    parent->installEventFilter(this);\n    resize(parent->size());\n    setAttribute(Qt::WA_TranslucentBackground);\n    setAttribute(Qt::WA_TransparentForMouseEvents);\n}",
    "includes": [
      "include <QDebug>",
      "include <QHBoxLayout>",
      "include <QResizeEvent>\n#",
      "include \"OverlayWidget.h\"\n#"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "etAttribute(",
          "args": [
            "t::WA_TransparentForMouseEvents)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "etAttribute(",
          "args": [
            "t::WA_TranslucentBackground)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "esize(",
          "args": [
            "arent->size())"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent->size",
          "args": [],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "arent->installEventFilter",
          "args": [
            "his)"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addStretch",
          "args": [
            ")"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addWidget",
          "args": [
            "_widget)"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ayout->addStretch",
          "args": [
            ")"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_widget->setParent",
          "args": [
            "his)"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "include <QDebug>\ninclude <QHBoxLayout>\ninclude <QResizeEvent>\n#\ninclude \"OverlayWidget.h\"\n#\n\nverlayWidget {\n  verlayWidget::OverlayWidget(QWidget *what, QWidget *parent): QWidget(parent), m_widget(what)\n  {\n      m_widget->setParent(this);\n      QHBoxLayout *layout = new QHBoxLayout(this);\n      layout->addStretch(1);\n      layout->addWidget(m_widget);\n      layout->addStretch(1);\n      parent->installEventFilter(this);\n      resize(parent->size());\n      setAttribute(Qt::WA_TranslucentBackground);\n      setAttribute(Qt::WA_TransparentForMouseEvents);\n  }\n}"
  }
]