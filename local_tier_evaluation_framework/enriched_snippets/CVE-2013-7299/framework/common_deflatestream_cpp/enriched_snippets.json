[
  {
    "function_name": "DeflateStream::end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
    "lines": "183-187",
    "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
    "includes": [
      "#include <string.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/deflatestream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setstate",
          "args": [
            "failbit"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "streambuf.end",
          "args": [],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nvoid DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }"
  },
  {
    "function_name": "DeflateStreamBuf::end",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
    "lines": "152-181",
    "snippet": "int DeflateStreamBuf::end()\n  {\n    char zbuffer[8192];\n    // initialize input-stream for\n    stream.next_in = reinterpret_cast<Bytef*>(&obuffer[0]);\n    stream.avail_in = pptr() - pbase();\n    while (true)\n    {\n      // initialize zbuffer\n      stream.next_out = (Bytef*)zbuffer;\n      stream.avail_out = sizeof(zbuffer);\n\n      int ret = checkError(::deflate(&stream, Z_FINISH), stream);\n\n      // copy zbuffer to sink\n      std::streamsize count = sizeof(zbuffer) - stream.avail_out;\n      if (count > 0)\n      {\n        std::streamsize n = sink->sputn(zbuffer, count);\n        if (n < count)\n          return -1;\n      }\n      if (ret == Z_STREAM_END)\n        break;\n    };\n\n    // reset outbuffer\n    setp(&obuffer[0], &obuffer[0] + obuffer.size());\n    return 0;\n  }",
    "includes": [
      "#include <string.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/deflatestream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setp",
          "args": [
            "&obuffer[0]",
            "&obuffer[0] + obuffer.size()"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "obuffer.size",
          "args": [],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sink->sputn",
          "args": [
            "zbuffer",
            "count"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkError",
          "args": [
            "::deflate(&stream, Z_FINISH)",
            "stream"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "checkError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "41-53",
          "snippet": "int checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nint checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "::deflate",
          "args": [
            "&stream",
            "Z_FINISH"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pbase",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pptr",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<Bytef*>",
          "args": [
            "&obuffer[0]"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nint DeflateStreamBuf::end()\n  {\n    char zbuffer[8192];\n    // initialize input-stream for\n    stream.next_in = reinterpret_cast<Bytef*>(&obuffer[0]);\n    stream.avail_in = pptr() - pbase();\n    while (true)\n    {\n      // initialize zbuffer\n      stream.next_out = (Bytef*)zbuffer;\n      stream.avail_out = sizeof(zbuffer);\n\n      int ret = checkError(::deflate(&stream, Z_FINISH), stream);\n\n      // copy zbuffer to sink\n      std::streamsize count = sizeof(zbuffer) - stream.avail_out;\n      if (count > 0)\n      {\n        std::streamsize n = sink->sputn(zbuffer, count);\n        if (n < count)\n          return -1;\n      }\n      if (ret == Z_STREAM_END)\n        break;\n    };\n\n    // reset outbuffer\n    setp(&obuffer[0], &obuffer[0] + obuffer.size());\n    return 0;\n  }"
  },
  {
    "function_name": "DeflateStreamBuf::sync",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
    "lines": "123-150",
    "snippet": "int DeflateStreamBuf::sync()\n  {\n    // initialize input-stream for\n    stream.next_in = reinterpret_cast<Bytef*>(&obuffer[0]);\n    stream.avail_in = pptr() - pbase();\n    char zbuffer[8192];\n    while (stream.avail_in > 0)\n    {\n      // initialize zbuffer\n      stream.next_out = (Bytef*)zbuffer;\n      stream.avail_out = sizeof(zbuffer);\n\n      checkError(::deflate(&stream, Z_SYNC_FLUSH), stream);\n\n      // copy zbuffer to sink\n      std::streamsize count = sizeof(zbuffer) - stream.avail_out;\n      if (count > 0)\n      {\n        std::streamsize n = sink->sputn(zbuffer, count);\n        if (n < count)\n          return -1;\n      }\n    };\n\n    // reset outbuffer\n    setp(&obuffer[0], &obuffer[0] + obuffer.size());\n    return 0;\n  }",
    "includes": [
      "#include <string.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/deflatestream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setp",
          "args": [
            "&obuffer[0]",
            "&obuffer[0] + obuffer.size()"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "obuffer.size",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sink->sputn",
          "args": [
            "zbuffer",
            "count"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkError",
          "args": [
            "::deflate(&stream, Z_SYNC_FLUSH)",
            "stream"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "checkError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "41-53",
          "snippet": "int checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nint checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "::deflate",
          "args": [
            "&stream",
            "Z_SYNC_FLUSH"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pbase",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pptr",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<Bytef*>",
          "args": [
            "&obuffer[0]"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nint DeflateStreamBuf::sync()\n  {\n    // initialize input-stream for\n    stream.next_in = reinterpret_cast<Bytef*>(&obuffer[0]);\n    stream.avail_in = pptr() - pbase();\n    char zbuffer[8192];\n    while (stream.avail_in > 0)\n    {\n      // initialize zbuffer\n      stream.next_out = (Bytef*)zbuffer;\n      stream.avail_out = sizeof(zbuffer);\n\n      checkError(::deflate(&stream, Z_SYNC_FLUSH), stream);\n\n      // copy zbuffer to sink\n      std::streamsize count = sizeof(zbuffer) - stream.avail_out;\n      if (count > 0)\n      {\n        std::streamsize n = sink->sputn(zbuffer, count);\n        if (n < count)\n          return -1;\n      }\n    };\n\n    // reset outbuffer\n    setp(&obuffer[0], &obuffer[0] + obuffer.size());\n    return 0;\n  }"
  },
  {
    "function_name": "DeflateStreamBuf::underflow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
    "lines": "118-121",
    "snippet": "DeflateStreamBuf::int_type DeflateStreamBuf::underflow()\n  {\n    return traits_type::eof();\n  }",
    "includes": [
      "#include <string.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/deflatestream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStreamBuf::int_type DeflateStreamBuf::underflow()\n  {\n    return traits_type::eof();\n  }"
  },
  {
    "function_name": "DeflateStreamBuf::overflow",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
    "lines": "83-116",
    "snippet": "DeflateStreamBuf::int_type DeflateStreamBuf::overflow(int_type c)\n  {\n    // initialize input-stream\n    stream.next_in = reinterpret_cast<Bytef*>(&obuffer[0]);\n    stream.avail_in = pptr() - &obuffer[0];\n\n    // initialize zbuffer for deflated data\n    char zbuffer[8192];\n    stream.next_out = reinterpret_cast<Bytef*>(zbuffer);\n    stream.avail_out = sizeof(zbuffer);\n\n    // deflate\n    checkError(::deflate(&stream, Z_NO_FLUSH), stream);\n\n    // copy zbuffer to sink / consume deflated data\n    std::streamsize count = sizeof(zbuffer) - stream.avail_out;\n    if (count > 0)\n    {\n      std::streamsize n = sink->sputn(zbuffer, count);\n      if (n < count)\n        return traits_type::eof();\n    }\n\n    // move remaining characters to start of obuffer\n    if (stream.avail_in > 0)\n      memmove(&obuffer[0], stream.next_in, stream.avail_in);\n\n    // reset outbuffer\n    setp(&obuffer[0] + stream.avail_in, &obuffer[0] + obuffer.size());\n    if (c != traits_type::eof())\n      sputc(traits_type::to_char_type(c));\n\n    return 0;\n  }",
    "includes": [
      "#include <string.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/deflatestream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sputc",
          "args": [
            "traits_type::to_char_type(c)"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traits_type::to_char_type",
          "args": [
            "c"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setp",
          "args": [
            "&obuffer[0] + stream.avail_in",
            "&obuffer[0] + obuffer.size()"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "obuffer.size",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memmove",
          "args": [
            "&obuffer[0]",
            "stream.next_in",
            "stream.avail_in"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sink->sputn",
          "args": [
            "zbuffer",
            "count"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkError",
          "args": [
            "::deflate(&stream, Z_NO_FLUSH)",
            "stream"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "checkError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "41-53",
          "snippet": "int checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nint checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "::deflate",
          "args": [
            "&stream",
            "Z_NO_FLUSH"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<Bytef*>",
          "args": [
            "zbuffer"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pptr",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<Bytef*>",
          "args": [
            "&obuffer[0]"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStreamBuf::int_type DeflateStreamBuf::overflow(int_type c)\n  {\n    // initialize input-stream\n    stream.next_in = reinterpret_cast<Bytef*>(&obuffer[0]);\n    stream.avail_in = pptr() - &obuffer[0];\n\n    // initialize zbuffer for deflated data\n    char zbuffer[8192];\n    stream.next_out = reinterpret_cast<Bytef*>(zbuffer);\n    stream.avail_out = sizeof(zbuffer);\n\n    // deflate\n    checkError(::deflate(&stream, Z_NO_FLUSH), stream);\n\n    // copy zbuffer to sink / consume deflated data\n    std::streamsize count = sizeof(zbuffer) - stream.avail_out;\n    if (count > 0)\n    {\n      std::streamsize n = sink->sputn(zbuffer, count);\n      if (n < count)\n        return traits_type::eof();\n    }\n\n    // move remaining characters to start of obuffer\n    if (stream.avail_in > 0)\n      memmove(&obuffer[0], stream.next_in, stream.avail_in);\n\n    // reset outbuffer\n    setp(&obuffer[0] + stream.avail_in, &obuffer[0] + obuffer.size());\n    if (c != traits_type::eof())\n      sputc(traits_type::to_char_type(c));\n\n    return 0;\n  }"
  },
  {
    "function_name": "DeflateStreamBuf::~DeflateStreamBuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
    "lines": "78-81",
    "snippet": "DeflateStreamBuf::~DeflateStreamBuf()\n  {\n    ::deflateEnd(&stream);\n  }",
    "includes": [
      "#include <string.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/deflatestream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::deflateEnd",
          "args": [
            "&stream"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStreamBuf::~DeflateStreamBuf()\n  {\n    ::deflateEnd(&stream);\n  }"
  },
  {
    "function_name": "DeflateStreamBuf::DeflateStreamBuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
    "lines": "56-76",
    "snippet": "DeflateStreamBuf::DeflateStreamBuf(std::streambuf* sink_, int level, unsigned bufsize_)\n    : obuffer(bufsize_),\n      sink(sink_)\n  {\n    memset(&stream, 0, sizeof(z_stream));\n    stream.zalloc = Z_NULL;\n    stream.zfree = Z_NULL;\n    stream.opaque = 0;\n    stream.total_out = 0;\n    stream.total_in = 0;\n    stream.next_in = Z_NULL;\n    stream.next_out = Z_NULL;\n    stream.avail_in = 0;\n    stream.avail_out = 0;\n\n    int strategy = Z_DEFAULT_STRATEGY;\n    level = 6;\n    checkError(::deflateInit2(&stream, level, Z_DEFLATED, -MAX_WBITS, 8, strategy), stream);\n\n    setp(&obuffer[0], &obuffer[0] + obuffer.size());\n  }",
    "includes": [
      "#include <string.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/deflatestream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setp",
          "args": [
            "&obuffer[0]",
            "&obuffer[0] + obuffer.size()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "obuffer.size",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "checkError",
          "args": [
            "::deflateInit2(&stream, level, Z_DEFLATED, -MAX_WBITS, 8, strategy)",
            "stream"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "checkError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "41-53",
          "snippet": "int checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nint checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "::deflateInit2",
          "args": [
            "&stream",
            "level",
            "Z_DEFLATED",
            "-MAX_WBITS",
            "8",
            "strategy"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&stream",
            "0",
            "sizeof(z_stream)"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStreamBuf::DeflateStreamBuf(std::streambuf* sink_, int level, unsigned bufsize_)\n    : obuffer(bufsize_),\n      sink(sink_)\n  {\n    memset(&stream, 0, sizeof(z_stream));\n    stream.zalloc = Z_NULL;\n    stream.zfree = Z_NULL;\n    stream.opaque = 0;\n    stream.total_out = 0;\n    stream.total_in = 0;\n    stream.next_in = Z_NULL;\n    stream.next_out = Z_NULL;\n    stream.avail_in = 0;\n    stream.avail_out = 0;\n\n    int strategy = Z_DEFAULT_STRATEGY;\n    level = 6;\n    checkError(::deflateInit2(&stream, level, Z_DEFLATED, -MAX_WBITS, 8, strategy), stream);\n\n    setp(&obuffer[0], &obuffer[0] + obuffer.size());\n  }"
  },
  {
    "function_name": "checkError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
    "lines": "41-53",
    "snippet": "int checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }",
    "includes": [
      "#include <string.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/deflatestream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DeflateError",
          "args": [
            "ret",
            "msg.str()"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "DeflateError",
          "container": "DeflateError",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/deflatestream.h",
          "lines": "45-48",
          "snippet": "DeflateError(int zRet_, const std::string& msg)\n        : std::runtime_error(msg),\n          zRet(zRet_)\n          { }",
          "includes": [
            "#include <vector>",
            "#include <zlib.h>",
            "#include <stdexcept>",
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <zlib.h>\n#include <stdexcept>\n#include <iostream>\n\nDeflateError {\n  DeflateError(int zRet_, const std::string& msg)\n          : std::runtime_error(msg),\n            zRet(zRet_)\n            { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "msg.str",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_error",
          "args": [
            "\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"'"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nint checkError(int ret, z_stream& stream)\n    {\n      if (ret != Z_OK && ret != Z_STREAM_END)\n      {\n        log_error(\"DeflateError \" << ret << \": \\\"\" << (stream.msg ? stream.msg : \"\") << '\"');\n        std::ostringstream msg;\n        msg << \"deflate-error \" << ret;\n        if (stream.msg)\n          msg << \": \" << stream.msg;\n        throw DeflateError(ret, msg.str());\n      }\n      return ret;\n    }"
  }
]