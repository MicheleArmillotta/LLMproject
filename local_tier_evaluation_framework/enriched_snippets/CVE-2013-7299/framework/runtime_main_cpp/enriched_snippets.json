[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "220-279",
    "snippet": "int main(int argc, char* argv[])\n{\n  std::ios::sync_with_stdio(false);\n\n  try\n  {\n    cxxtools::Arg<bool> version(argc, argv, \"--version\");\n    if (version)\n    {\n      std::cout << PACKAGE_STRING \"\\n\" << std::flush;\n      return 0;\n    }\n\n    cxxtools::Arg<bool> help1(argc, argv, 'h');\n    cxxtools::Arg<bool> help2(argc, argv, '?');\n\n    if (help1 || help2)\n    {\n      std::cout << \"usage: \" << argv[0] << \" configurationfile (default: \" TNTNET_CONF \")\"\n                << std::endl;\n      return 0;\n    }\n\n    cxxtools::Arg<bool> cmd(argc, argv, 'C');\n    if (cmd)\n    {\n      log_init(\"tntnet.xml\");\n\n      tnt::Cmd cmdapp(std::cout);\n\n      tnt::QueryParams queryParams;\n\n      while (true)\n      {\n        cxxtools::Arg<std::string> param(argc, argv, 'q');\n        if (!param.isSet())\n          break;\n        queryParams.parse_url(param);\n      }\n\n      for (int a = 1; a < argc; ++a)\n      {\n        log_info(\"calling component <\" << argv[a] << '>');\n        cmdapp.call(tnt::Compident(argv[a]), queryParams);\n      }\n    }\n    else\n    {\n      tnt::TntnetProcess app(argc, argv);\n\n      app.run();\n    }\n  }\n  catch(const std::exception& e)\n  {\n    log_fatal(e.what());\n    std::cerr << e.what() << std::endl;\n    return -1;\n  }\n}",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_fatal",
          "args": [
            "e.what()"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "app.run",
          "args": [],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "run",
          "container": "Process",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "312-350",
          "snippet": "void Process::run()\n  {\n    if (tnt::TntConfig::it().daemon)\n    {\n      log_debug(\"run daemon-mode\");\n\n      // We receive the writing-end of the notify pipe.\n      // After successful initialization we need to write a byte to this fd.\n      cxxtools::posix::Pipe mainPipe;\n      cxxtools::posix::Fork fork;\n      if (fork.parent())\n      {\n        log_debug(\"close write-fd of main-pipe\");\n        mainPipe.closeWriteFd();\n\n        log_debug(\"wait for child to initialize\");\n        mainPipe.read();\n\n        log_debug(\"child initialized\");\n\n        fork.setNowait();\n      }\n      else\n      {\n        log_debug(\"close read-fd of main-pipe\");\n        mainPipe.closeReadFd();\n\n        runMonitor(mainPipe);\n      }\n    }\n    else\n    {\n      log_debug(\"run\");\n      initWorker();\n\n      log_debug(\"do work\");\n      doWork();\n    }\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nProcess {\n  void Process::run()\n    {\n      if (tnt::TntConfig::it().daemon)\n      {\n        log_debug(\"run daemon-mode\");\n  \n        // We receive the writing-end of the notify pipe.\n        // After successful initialization we need to write a byte to this fd.\n        cxxtools::posix::Pipe mainPipe;\n        cxxtools::posix::Fork fork;\n        if (fork.parent())\n        {\n          log_debug(\"close write-fd of main-pipe\");\n          mainPipe.closeWriteFd();\n  \n          log_debug(\"wait for child to initialize\");\n          mainPipe.read();\n  \n          log_debug(\"child initialized\");\n  \n          fork.setNowait();\n        }\n        else\n        {\n          log_debug(\"close read-fd of main-pipe\");\n          mainPipe.closeReadFd();\n  \n          runMonitor(mainPipe);\n        }\n      }\n      else\n      {\n        log_debug(\"run\");\n        initWorker();\n  \n        log_debug(\"do work\");\n        doWork();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmdapp.call",
          "args": [
            "tnt::Compident(argv[a])",
            "queryParams"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "call",
          "container": "Component",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/component.cpp",
          "lines": "66-70",
          "snippet": "unsigned Component::call(HttpRequest& request, HttpReply& reply)\n  {\n    tnt::QueryParams qparam;\n    return call(request, reply, qparam);\n  }",
          "includes": [
            "#include <sstream>",
            "#include \"tnt/httprequest.h\"",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/http.h\"",
            "#include \"tnt/component.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sstream>\n#include \"tnt/httprequest.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/component.h\"\n\nComponent {\n  unsigned Component::call(HttpRequest& request, HttpReply& reply)\n    {\n      tnt::QueryParams qparam;\n      return call(request, reply, qparam);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tnt::Compident",
          "args": [
            "argv[a]"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "Compident",
          "container": "Compident",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/compident.cpp",
          "lines": "34-44",
          "snippet": "Compident::Compident(const std::string& ident)\n  {\n    std::string::size_type pos = ident.find('@');\n    if (pos == std::string::npos)\n      compname = ident;\n    else\n    {\n      compname = ident.substr(0, pos);\n      libname = ident.substr(pos + 1);\n    }\n  }",
          "includes": [
            "#include \"tnt/compident.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"tnt/compident.h\"\n\nCompident {\n  Compident::Compident(const std::string& ident)\n    {\n      std::string::size_type pos = ident.find('@');\n      if (pos == std::string::npos)\n        compname = ident;\n      else\n      {\n        compname = ident.substr(0, pos);\n        libname = ident.substr(pos + 1);\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"calling component <\" << argv[a] << '>'"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queryParams.parse_url",
          "args": [
            "param"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "param.isSet",
          "args": [],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_init",
          "args": [
            "\"tntnet.xml\""
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::ios::sync_with_stdio",
          "args": [
            "false"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nint main(int argc, char* argv[])\n{\n  std::ios::sync_with_stdio(false);\n\n  try\n  {\n    cxxtools::Arg<bool> version(argc, argv, \"--version\");\n    if (version)\n    {\n      std::cout << PACKAGE_STRING \"\\n\" << std::flush;\n      return 0;\n    }\n\n    cxxtools::Arg<bool> help1(argc, argv, 'h');\n    cxxtools::Arg<bool> help2(argc, argv, '?');\n\n    if (help1 || help2)\n    {\n      std::cout << \"usage: \" << argv[0] << \" configurationfile (default: \" TNTNET_CONF \")\"\n                << std::endl;\n      return 0;\n    }\n\n    cxxtools::Arg<bool> cmd(argc, argv, 'C');\n    if (cmd)\n    {\n      log_init(\"tntnet.xml\");\n\n      tnt::Cmd cmdapp(std::cout);\n\n      tnt::QueryParams queryParams;\n\n      while (true)\n      {\n        cxxtools::Arg<std::string> param(argc, argv, 'q');\n        if (!param.isSet())\n          break;\n        queryParams.parse_url(param);\n      }\n\n      for (int a = 1; a < argc; ++a)\n      {\n        log_info(\"calling component <\" << argv[a] << '>');\n        cmdapp.call(tnt::Compident(argv[a]), queryParams);\n      }\n    }\n    else\n    {\n      tnt::TntnetProcess app(argc, argv);\n\n      app.run();\n    }\n  }\n  catch(const std::exception& e)\n  {\n    log_fatal(e.what());\n    std::cerr << e.what() << std::endl;\n    return -1;\n  }\n}"
  },
  {
    "function_name": "doShutdown",
    "container": "TntnetProcess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "214-217",
    "snippet": "void TntnetProcess::doShutdown()\n  {\n    tnt::Tntnet::shutdown();\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tnt::Tntnet::shutdown",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "shutdown",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
          "lines": "323-327",
          "snippet": "void Tntnet::shutdown()\n  {\n    stop = true;\n    timerStopCondition.broadcast();\n  }",
          "includes": [
            "#include <config.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/net/tcpstream.h>",
            "#include \"tnt/stressjob.h\"",
            "#include \"tnt/util.h\"",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/sessionscope.h\"",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/http.h\"",
            "#include \"tnt/listener.h\"",
            "#include \"tnt/worker.h\"",
            "#include \"tnt/tntnet.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::shutdown()\n    {\n      stop = true;\n      timerStopCondition.broadcast();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nTntnetProcess {\n  void TntnetProcess::doShutdown()\n    {\n      tnt::Tntnet::shutdown();\n    }\n}"
  },
  {
    "function_name": "doWork",
    "container": "TntnetProcess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "206-212",
    "snippet": "void TntnetProcess::doWork()\n  {\n    if (!logall)\n      initializeLogging();\n\n    tntnet.run();\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tntnet.run",
          "args": [],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "run",
          "container": "Process",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "312-350",
          "snippet": "void Process::run()\n  {\n    if (tnt::TntConfig::it().daemon)\n    {\n      log_debug(\"run daemon-mode\");\n\n      // We receive the writing-end of the notify pipe.\n      // After successful initialization we need to write a byte to this fd.\n      cxxtools::posix::Pipe mainPipe;\n      cxxtools::posix::Fork fork;\n      if (fork.parent())\n      {\n        log_debug(\"close write-fd of main-pipe\");\n        mainPipe.closeWriteFd();\n\n        log_debug(\"wait for child to initialize\");\n        mainPipe.read();\n\n        log_debug(\"child initialized\");\n\n        fork.setNowait();\n      }\n      else\n      {\n        log_debug(\"close read-fd of main-pipe\");\n        mainPipe.closeReadFd();\n\n        runMonitor(mainPipe);\n      }\n    }\n    else\n    {\n      log_debug(\"run\");\n      initWorker();\n\n      log_debug(\"do work\");\n      doWork();\n    }\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nProcess {\n  void Process::run()\n    {\n      if (tnt::TntConfig::it().daemon)\n      {\n        log_debug(\"run daemon-mode\");\n  \n        // We receive the writing-end of the notify pipe.\n        // After successful initialization we need to write a byte to this fd.\n        cxxtools::posix::Pipe mainPipe;\n        cxxtools::posix::Fork fork;\n        if (fork.parent())\n        {\n          log_debug(\"close write-fd of main-pipe\");\n          mainPipe.closeWriteFd();\n  \n          log_debug(\"wait for child to initialize\");\n          mainPipe.read();\n  \n          log_debug(\"child initialized\");\n  \n          fork.setNowait();\n        }\n        else\n        {\n          log_debug(\"close read-fd of main-pipe\");\n          mainPipe.closeReadFd();\n  \n          runMonitor(mainPipe);\n        }\n      }\n      else\n      {\n        log_debug(\"run\");\n        initWorker();\n  \n        log_debug(\"do work\");\n        doWork();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "initializeLogging",
          "args": [],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "initializeLogging",
          "container": "TntnetProcess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "194-199",
          "snippet": "void TntnetProcess::initializeLogging()\n  {\n    const cxxtools::SerializationInfo* psi = TntConfig::it().config.findMember(\"logging\");\n    if (psi)\n      log_init(*psi);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <sstream>",
            "#include <glob.h>",
            "#include <set>",
            "#include <stdexcept>",
            "#include <iostream>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/jsondeserializer.h>",
            "#include <cxxtools/xml/xmldeserializer.h>",
            "#include <cxxtools/arg.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/cmd.h\"",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nTntnetProcess {\n  void TntnetProcess::initializeLogging()\n    {\n      const cxxtools::SerializationInfo* psi = TntConfig::it().config.findMember(\"logging\");\n      if (psi)\n        log_init(*psi);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nTntnetProcess {\n  void TntnetProcess::doWork()\n    {\n      if (!logall)\n        initializeLogging();\n  \n      tntnet.run();\n    }\n}"
  },
  {
    "function_name": "onInit",
    "container": "TntnetProcess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "201-204",
    "snippet": "void TntnetProcess::onInit()\n  {\n    tntnet.init(TntConfig::it());\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tntnet.init",
          "args": [
            "TntConfig::it()"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "init",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
          "lines": "92-148",
          "snippet": "void Tntnet::init(const TntConfig& config)\n  {\n    minthreads = config.minThreads;\n    maxthreads = config.maxThreads;\n\n    queue.setCapacity(config.queueSize);\n\n    for (TntConfig::EnvironmentType::const_iterator it = config.environment.begin(); it != config.environment.end(); ++it)\n    {\n      std::string name = it->first;\n      std::string value = it->second;\n#ifdef HAVE_SETENV\n      log_debug(\"setenv \" << name << \"=\\\"\" << value << '\"');\n      ::setenv(name.c_str(), value.c_str(), 1);\n#else\n      char* env = new char[name.size() + value.size() + 2];\n      name.copy(env, name.size());\n      env[name.size()] = '=';\n      value.copy(env + name.size() + 1, value.size());\n      env[name.size() + value.size() + 1] = '\\0';\n\n      log_debug(\"putenv(\" << env << ')');\n      ::putenv(env);\n#endif\n    }\n\n    configureDispatcher(dispatcher);\n\n    // initialize listeners\n    for (TntConfig::ListenersType::const_iterator it = config.listeners.begin(); it != config.listeners.end(); ++it)\n    {\n      listen(it->ip, it->port);\n    }\n\n#ifdef USE_SSL\n\n    for (TntConfig::SslListenersType::const_iterator it = config.ssllisteners.begin(); it != config.ssllisteners.end(); ++it)\n    {\n      sslListen(it->certificate, it->key, it->ip, it->port);\n    }\n\n#else\n\n    if (!config.ssllisteners.empty())\n      throwRuntimeError(\"SslListen is configured but SSL is not compiled into this tntnet\");\n\n#endif // USE_SSL\n\n#ifdef WITH_STRESSJOB\n    std::string stressJob = config.getValue(\"StressJob\");\n    if (!stressJob.empty())\n    {\n      log_debug(\"create stress job for url \\\"\" << stressJob << '\"');\n      queue.put(new StressJob(*this, stressJob));\n    }\n#endif\n  }",
          "includes": [
            "#include <config.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/net/tcpstream.h>",
            "#include \"tnt/stressjob.h\"",
            "#include \"tnt/util.h\"",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/sessionscope.h\"",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/http.h\"",
            "#include \"tnt/listener.h\"",
            "#include \"tnt/worker.h\"",
            "#include \"tnt/tntnet.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::init(const TntConfig& config)\n    {\n      minthreads = config.minThreads;\n      maxthreads = config.maxThreads;\n  \n      queue.setCapacity(config.queueSize);\n  \n      for (TntConfig::EnvironmentType::const_iterator it = config.environment.begin(); it != config.environment.end(); ++it)\n      {\n        std::string name = it->first;\n        std::string value = it->second;\n  #ifdef HAVE_SETENV\n        log_debug(\"setenv \" << name << \"=\\\"\" << value << '\"');\n        ::setenv(name.c_str(), value.c_str(), 1);\n  #else\n        char* env = new char[name.size() + value.size() + 2];\n        name.copy(env, name.size());\n        env[name.size()] = '=';\n        value.copy(env + name.size() + 1, value.size());\n        env[name.size() + value.size() + 1] = '\\0';\n  \n        log_debug(\"putenv(\" << env << ')');\n        ::putenv(env);\n  #endif\n      }\n  \n      configureDispatcher(dispatcher);\n  \n      // initialize listeners\n      for (TntConfig::ListenersType::const_iterator it = config.listeners.begin(); it != config.listeners.end(); ++it)\n      {\n        listen(it->ip, it->port);\n      }\n  \n  #ifdef USE_SSL\n  \n      for (TntConfig::SslListenersType::const_iterator it = config.ssllisteners.begin(); it != config.ssllisteners.end(); ++it)\n      {\n        sslListen(it->certificate, it->key, it->ip, it->port);\n      }\n  \n  #else\n  \n      if (!config.ssllisteners.empty())\n        throwRuntimeError(\"SslListen is configured but SSL is not compiled into this tntnet\");\n  \n  #endif // USE_SSL\n  \n  #ifdef WITH_STRESSJOB\n      std::string stressJob = config.getValue(\"StressJob\");\n      if (!stressJob.empty())\n      {\n        log_debug(\"create stress job for url \\\"\" << stressJob << '\"');\n        queue.put(new StressJob(*this, stressJob));\n      }\n  #endif\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nTntnetProcess {\n  void TntnetProcess::onInit()\n    {\n      tntnet.init(TntConfig::it());\n    }\n}"
  },
  {
    "function_name": "initializeLogging",
    "container": "TntnetProcess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "194-199",
    "snippet": "void TntnetProcess::initializeLogging()\n  {\n    const cxxtools::SerializationInfo* psi = TntConfig::it().config.findMember(\"logging\");\n    if (psi)\n      log_init(*psi);\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_init",
          "args": [
            "*psi"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [
            "\"logging\""
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nTntnetProcess {\n  void TntnetProcess::initializeLogging()\n    {\n      const cxxtools::SerializationInfo* psi = TntConfig::it().config.findMember(\"logging\");\n      if (psi)\n        log_init(*psi);\n    }\n}"
  },
  {
    "function_name": "TntnetProcess",
    "container": "TntnetProcess",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "154-192",
    "snippet": "TntnetProcess::TntnetProcess(int& argc, char* argv[])\n    : logall(cxxtools::Arg<bool>(argc, argv, \"--logall\"))\n  {\n    std::string configFile;\n\n    cxxtools::Arg<bool> jsonConfig(argc, argv, 'j');\n\n    // check for argument -c\n    cxxtools::Arg<const char*> conf(argc, argv, 'c');\n    if (conf.isSet())\n      configFile = conf;\n    else\n    {\n      // read 1st parameter from argument-list\n      cxxtools::Arg<const char*> conf(argc, argv);\n      if (conf.isSet())\n        configFile = conf;\n      else\n      {\n        // check environment-variable TNTNET_CONF\n        const char* tntnetConf = ::getenv(\"TNTNET_CONF\");\n        if (tntnetConf)\n          configFile = tntnetConf;\n        else if (getuid() != 0)\n          configFile = \"tntnet.xml\";\n        else\n          configFile = TNTNET_CONF;  // take default\n      }\n    }\n\n    std::set<std::string> filesProcessed;\n    if (jsonConfig)\n      processConfigFile<cxxtools::JsonDeserializer>(configFile, filesProcessed);\n    else\n      processConfigFile<cxxtools::xml::XmlDeserializer>(configFile, filesProcessed);\n\n    if (logall)\n      initializeLogging();\n  }",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "initializeLogging",
          "args": [],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "initializeLogging",
          "container": "TntnetProcess",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "194-199",
          "snippet": "void TntnetProcess::initializeLogging()\n  {\n    const cxxtools::SerializationInfo* psi = TntConfig::it().config.findMember(\"logging\");\n    if (psi)\n      log_init(*psi);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <sstream>",
            "#include <glob.h>",
            "#include <set>",
            "#include <stdexcept>",
            "#include <iostream>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/jsondeserializer.h>",
            "#include <cxxtools/xml/xmldeserializer.h>",
            "#include <cxxtools/arg.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/cmd.h\"",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nTntnetProcess {\n  void TntnetProcess::initializeLogging()\n    {\n      const cxxtools::SerializationInfo* psi = TntConfig::it().config.findMember(\"logging\");\n      if (psi)\n        log_init(*psi);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "processConfigFile<cxxtools::xml::XmlDeserializer>",
          "args": [
            "configFile",
            "filesProcessed"
          ],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "processConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "111-135",
          "snippet": "void processConfigFile(const std::string& configFile, std::set<std::string>& filesProcessed)\n    {\n      TntConfig& config = TntConfig::it();\n\n      std::ifstream in(configFile.c_str());\n      if (!in)\n        throw std::runtime_error(\"failed to open configuration file \\\"\" + configFile + '\"');\n\n      Deserializer deserializer(in);\n      deserializer.deserialize(config);\n\n      in.close();\n\n      filesProcessed.insert(configFile);\n\n      for (std::vector<std::string>::size_type n = 0; n < config.includes.size(); ++n)\n      {\n        for (Glob glob(config.includes[n]); glob.current(); glob.next())\n        {\n          std::string configFile = glob.current();\n          if (filesProcessed.find(configFile) == filesProcessed.end())\n            processConfigFile<Deserializer>(glob.current(), filesProcessed);\n        }\n      }\n    }",
          "includes": [
            "#include \"config.h\"",
            "#include <sstream>",
            "#include <glob.h>",
            "#include <set>",
            "#include <stdexcept>",
            "#include <iostream>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/jsondeserializer.h>",
            "#include <cxxtools/xml/xmldeserializer.h>",
            "#include <cxxtools/arg.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/cmd.h\"",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nvoid processConfigFile(const std::string& configFile, std::set<std::string>& filesProcessed)\n    {\n      TntConfig& config = TntConfig::it();\n\n      std::ifstream in(configFile.c_str());\n      if (!in)\n        throw std::runtime_error(\"failed to open configuration file \\\"\" + configFile + '\"');\n\n      Deserializer deserializer(in);\n      deserializer.deserialize(config);\n\n      in.close();\n\n      filesProcessed.insert(configFile);\n\n      for (std::vector<std::string>::size_type n = 0; n < config.includes.size(); ++n)\n      {\n        for (Glob glob(config.includes[n]); glob.current(); glob.next())\n        {\n          std::string configFile = glob.current();\n          if (filesProcessed.find(configFile) == filesProcessed.end())\n            processConfigFile<Deserializer>(glob.current(), filesProcessed);\n        }\n      }\n    }"
        }
      },
      {
        "call_info": {
          "callee": "getuid",
          "args": [],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::getenv",
          "args": [
            "\"TNTNET_CONF\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conf.isSet",
          "args": [],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "conf.isSet",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::Arg<bool>",
          "args": [
            "argc",
            "argv",
            "\"--logall\""
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nTntnetProcess {\n  TntnetProcess::TntnetProcess(int& argc, char* argv[])\n      : logall(cxxtools::Arg<bool>(argc, argv, \"--logall\"))\n    {\n      std::string configFile;\n  \n      cxxtools::Arg<bool> jsonConfig(argc, argv, 'j');\n  \n      // check for argument -c\n      cxxtools::Arg<const char*> conf(argc, argv, 'c');\n      if (conf.isSet())\n        configFile = conf;\n      else\n      {\n        // read 1st parameter from argument-list\n        cxxtools::Arg<const char*> conf(argc, argv);\n        if (conf.isSet())\n          configFile = conf;\n        else\n        {\n          // check environment-variable TNTNET_CONF\n          const char* tntnetConf = ::getenv(\"TNTNET_CONF\");\n          if (tntnetConf)\n            configFile = tntnetConf;\n          else if (getuid() != 0)\n            configFile = \"tntnet.xml\";\n          else\n            configFile = TNTNET_CONF;  // take default\n        }\n      }\n  \n      std::set<std::string> filesProcessed;\n      if (jsonConfig)\n        processConfigFile<cxxtools::JsonDeserializer>(configFile, filesProcessed);\n      else\n        processConfigFile<cxxtools::xml::XmlDeserializer>(configFile, filesProcessed);\n  \n      if (logall)\n        initializeLogging();\n    }\n}"
  },
  {
    "function_name": "processConfigFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "111-135",
    "snippet": "void processConfigFile(const std::string& configFile, std::set<std::string>& filesProcessed)\n    {\n      TntConfig& config = TntConfig::it();\n\n      std::ifstream in(configFile.c_str());\n      if (!in)\n        throw std::runtime_error(\"failed to open configuration file \\\"\" + configFile + '\"');\n\n      Deserializer deserializer(in);\n      deserializer.deserialize(config);\n\n      in.close();\n\n      filesProcessed.insert(configFile);\n\n      for (std::vector<std::string>::size_type n = 0; n < config.includes.size(); ++n)\n      {\n        for (Glob glob(config.includes[n]); glob.current(); glob.next())\n        {\n          std::string configFile = glob.current();\n          if (filesProcessed.find(configFile) == filesProcessed.end())\n            processConfigFile<Deserializer>(glob.current(), filesProcessed);\n        }\n      }\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "processConfigFile<Deserializer>",
          "args": [
            "glob.current()",
            "filesProcessed"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "processConfigFile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "111-135",
          "snippet": "void processConfigFile(const std::string& configFile, std::set<std::string>& filesProcessed)\n    {\n      TntConfig& config = TntConfig::it();\n\n      std::ifstream in(configFile.c_str());\n      if (!in)\n        throw std::runtime_error(\"failed to open configuration file \\\"\" + configFile + '\"');\n\n      Deserializer deserializer(in);\n      deserializer.deserialize(config);\n\n      in.close();\n\n      filesProcessed.insert(configFile);\n\n      for (std::vector<std::string>::size_type n = 0; n < config.includes.size(); ++n)\n      {\n        for (Glob glob(config.includes[n]); glob.current(); glob.next())\n        {\n          std::string configFile = glob.current();\n          if (filesProcessed.find(configFile) == filesProcessed.end())\n            processConfigFile<Deserializer>(glob.current(), filesProcessed);\n        }\n      }\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "glob.current",
          "args": [],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filesProcessed.end",
          "args": [],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filesProcessed.find",
          "args": [
            "configFile"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "glob.current",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glob.next",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "glob.current",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "config.includes.size",
          "args": [],
          "line": 126
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "filesProcessed.insert",
          "args": [
            "configFile"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.close",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "close",
          "container": "unzipFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/unzipfile.cpp",
          "lines": "118-126",
          "snippet": "void unzipFile::close()\n  {\n    if (file)\n    {\n      unzClose(file->file);\n      delete file;\n      file = 0;\n    }\n  }",
          "includes": [
            "#include \"unzip.h\"",
            "#include <sstream>",
            "#include \"tnt/unzipfile.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"unzip.h\"\n#include <sstream>\n#include \"tnt/unzipfile.h\"\n\nunzipFile {\n  void unzipFile::close()\n    {\n      if (file)\n      {\n        unzClose(file->file);\n        delete file;\n        file = 0;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "deserializer.deserialize",
          "args": [
            "config"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"failed to open configuration file \\\"\" + configFile + '\"'"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "configFile.c_str",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nvoid processConfigFile(const std::string& configFile, std::set<std::string>& filesProcessed)\n    {\n      TntConfig& config = TntConfig::it();\n\n      std::ifstream in(configFile.c_str());\n      if (!in)\n        throw std::runtime_error(\"failed to open configuration file \\\"\" + configFile + '\"');\n\n      Deserializer deserializer(in);\n      deserializer.deserialize(config);\n\n      in.close();\n\n      filesProcessed.insert(configFile);\n\n      for (std::vector<std::string>::size_type n = 0; n < config.includes.size(); ++n)\n      {\n        for (Glob glob(config.includes[n]); glob.current(); glob.next())\n        {\n          std::string configFile = glob.current();\n          if (filesProcessed.find(configFile) == filesProcessed.end())\n            processConfigFile<Deserializer>(glob.current(), filesProcessed);\n        }\n      }\n    }"
  },
  {
    "function_name": "~Glob",
    "container": "Glob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "104-108",
    "snippet": "Glob::~Glob()\n    {\n      if (gl.gl_pathv)\n        globfree(&gl);\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "globfree",
          "args": [
            "&gl"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nGlob {\n  Glob::~Glob()\n      {\n        if (gl.gl_pathv)\n          globfree(&gl);\n      }\n}"
  },
  {
    "function_name": "Glob",
    "container": "Glob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
    "lines": "88-102",
    "snippet": "Glob::Glob(const std::string& pattern, int flags)\n      : n(0)\n    {\n      int ret = ::glob(pattern.c_str(), flags, 0, &gl);\n      if (ret == GLOB_NOMATCH)\n      {\n        gl.gl_pathv = 0;\n      }\n      else if (ret != 0)\n      {\n        std::ostringstream msg;\n        msg << \"failed to process glob pattern <\" << pattern << \"> errorcode \" << ret;\n        throw std::runtime_error(msg.str());\n      }\n    }",
    "includes": [
      "#include \"config.h\"",
      "#include <sstream>",
      "#include <glob.h>",
      "#include <set>",
      "#include <stdexcept>",
      "#include <iostream>",
      "#include <sys/stat.h>",
      "#include <stdlib.h>",
      "#include <cxxtools/jsondeserializer.h>",
      "#include <cxxtools/xml/xmldeserializer.h>",
      "#include <cxxtools/arg.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/cmd.h\"",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "msg.str()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msg.str",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::glob",
          "args": [
            "pattern.c_str()",
            "flags",
            "0",
            "&gl"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pattern.c_str",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nGlob {\n  Glob::Glob(const std::string& pattern, int flags)\n        : n(0)\n      {\n        int ret = ::glob(pattern.c_str(), flags, 0, &gl);\n        if (ret == GLOB_NOMATCH)\n        {\n          gl.gl_pathv = 0;\n        }\n        else if (ret != 0)\n        {\n          std::ostringstream msg;\n          msg << \"failed to process glob pattern <\" << pattern << \"> errorcode \" << ret;\n          throw std::runtime_error(msg.str());\n        }\n      }\n}"
  }
]