[
  {
    "function_name": "registerFactory",
    "container": "ComponentLibrary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
    "lines": "109-110",
    "snippet": "void registerFactory(const std::string& component_name, ComponentFactory* factory)\n        { factoryMap.insert(factoryMapType::value_type(component_name, factory)); }",
    "includes": [
      "#include <dlfcn.h>",
      "#include <utility>",
      "#include <string>",
      "#include <list>",
      "#include <map>",
      "#include <tnt/langlib.h>",
      "#include <tnt/urlmapper.h>",
      "#include <cxxtools/smartptr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "factoryMap.insert",
          "args": [
            "factoryMapType::value_type(component_name, factory)"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "factoryMapType::value_type",
          "args": [
            "component_name",
            "factory"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nComponentLibrary {\n  void registerFactory(const std::string& component_name, ComponentFactory* factory)\n          { factoryMap.insert(factoryMapType::value_type(component_name, factory)); }\n}"
  },
  {
    "function_name": "ComponentLibrary",
    "container": "ComponentLibrary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
    "lines": "98-100",
    "snippet": "ComponentLibrary(const std::string& name, bool local)\n        : libname(name)\n        { init(name, local); }",
    "includes": [
      "#include <dlfcn.h>",
      "#include <utility>",
      "#include <string>",
      "#include <list>",
      "#include <map>",
      "#include <tnt/langlib.h>",
      "#include <tnt/urlmapper.h>",
      "#include <cxxtools/smartptr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init",
          "args": [
            "name",
            "local"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "ComponentLibrary::init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/comploader.cpp",
          "lines": "95-100",
          "snippet": "void ComponentLibrary::init(const std::string& name, bool local)\n{\n  void* handle = dlopen(name, local);\n  if (handle)\n    handlePtr = new HandleType(handle);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <cxxtools/dlloader.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/componentfactory.h>",
            "#include <tnt/comploader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <cxxtools/dlloader.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/componentfactory.h>\n#include <tnt/comploader.h>\n\nvoid ComponentLibrary::init(const std::string& name, bool local)\n{\n  void* handle = dlopen(name, local);\n  if (handle)\n    handlePtr = new HandleType(handle);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nComponentLibrary {\n  ComponentLibrary(const std::string& name, bool local)\n          : libname(name)\n          { init(name, local); }\n}"
  },
  {
    "function_name": "ComponentLibrary",
    "container": "ComponentLibrary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
    "lines": "93-96",
    "snippet": "ComponentLibrary(const std::string& path_, const std::string& name, bool local)\n        : libname(name),\n          path(path_)\n        { init(path_ + '/' + name, local); }",
    "includes": [
      "#include <dlfcn.h>",
      "#include <utility>",
      "#include <string>",
      "#include <list>",
      "#include <map>",
      "#include <tnt/langlib.h>",
      "#include <tnt/urlmapper.h>",
      "#include <cxxtools/smartptr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "init",
          "args": [
            "path_ + '/' + name",
            "local"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "ComponentLibrary::init",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/comploader.cpp",
          "lines": "95-100",
          "snippet": "void ComponentLibrary::init(const std::string& name, bool local)\n{\n  void* handle = dlopen(name, local);\n  if (handle)\n    handlePtr = new HandleType(handle);\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <cxxtools/dlloader.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/componentfactory.h>",
            "#include <tnt/comploader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <cxxtools/dlloader.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/componentfactory.h>\n#include <tnt/comploader.h>\n\nvoid ComponentLibrary::init(const std::string& name, bool local)\n{\n  void* handle = dlopen(name, local);\n  if (handle)\n    handlePtr = new HandleType(handle);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nComponentLibrary {\n  ComponentLibrary(const std::string& path_, const std::string& name, bool local)\n          : libname(name),\n            path(path_)\n          { init(path_ + '/' + name, local); }\n}"
  },
  {
    "function_name": "ComponentLibrary",
    "container": "ComponentLibrary",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
    "lines": "90-91",
    "snippet": "ComponentLibrary()\n        { }",
    "includes": [
      "#include <dlfcn.h>",
      "#include <utility>",
      "#include <string>",
      "#include <list>",
      "#include <map>",
      "#include <tnt/langlib.h>",
      "#include <tnt/urlmapper.h>",
      "#include <cxxtools/smartptr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nComponentLibrary {\n  ComponentLibrary()\n          { }\n}"
  },
  {
    "function_name": "destroy",
    "container": "Dlcloser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
    "lines": "62-66",
    "snippet": "void destroy(objectType* ptr)\n      {\n        ::dlclose(*ptr);\n        delete ptr;\n      }",
    "includes": [
      "#include <dlfcn.h>",
      "#include <utility>",
      "#include <string>",
      "#include <list>",
      "#include <map>",
      "#include <tnt/langlib.h>",
      "#include <tnt/urlmapper.h>",
      "#include <cxxtools/smartptr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::dlclose",
          "args": [
            "*ptr"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nDlcloser {\n  void destroy(objectType* ptr)\n        {\n          ::dlclose(*ptr);\n          delete ptr;\n        }\n}"
  },
  {
    "function_name": "LibraryNotFound",
    "container": "LibraryNotFound",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
    "lines": "52-54",
    "snippet": "explicit LibraryNotFound(const std::string& libname_)\n        : libname(libname_)\n        { }",
    "includes": [
      "#include <dlfcn.h>",
      "#include <utility>",
      "#include <string>",
      "#include <list>",
      "#include <map>",
      "#include <tnt/langlib.h>",
      "#include <tnt/urlmapper.h>",
      "#include <cxxtools/smartptr.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nLibraryNotFound {\n  explicit LibraryNotFound(const std::string& libname_)\n          : libname(libname_)\n          { }\n}"
  }
]