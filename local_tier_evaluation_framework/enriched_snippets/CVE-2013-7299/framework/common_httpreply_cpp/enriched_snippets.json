[
  {
    "function_name": "keepAlive",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "515-529",
    "snippet": "bool HttpReply::keepAlive() const\n  {\n    if (isDirectMode())\n    {\n      header_type::const_iterator it = header.find(httpheader::connection);\n      return it != header.end() &&\n        tnt::StringCompareIgnoreCase<const char*>(\n            it->second,\n            httpheader::connectionKeepAlive) == 0;\n    }\n    else\n    {\n      return TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0;\n    }\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getKeepAliveCounter",
          "args": [],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "getKeepAliveCounter",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "252-255",
          "snippet": "unsigned HttpReply::getKeepAliveCounter() const\n  {\n    return impl->keepAliveCounter;\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  unsigned HttpReply::getKeepAliveCounter() const\n    {\n      return impl->keepAliveCounter;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::StringCompareIgnoreCase<const char*>",
          "args": [
            "it->second",
            "httpheader::connectionKeepAlive"
          ],
          "line": 521
        },
        "resolved": true,
        "details": {
          "function_name": "StringCompareIgnoreCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/stringlessignorecase.h",
          "lines": "66-69",
          "snippet": "inline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }",
          "includes": [
            "#include <cctype>",
            "#include <functional>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cctype>\n#include <functional>\n#include <string>\n\ninline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "header.end",
          "args": [],
          "line": 520
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "header.find",
          "args": [
            "httpheader::connection"
          ],
          "line": 519
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isDirectMode",
          "args": [],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "isDirectMode",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "232-235",
          "snippet": "bool HttpReply::isDirectMode() const\n  {\n    return current_outstream == impl->socket;\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::isDirectMode() const\n    {\n      return current_outstream == impl->socket;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::keepAlive() const\n    {\n      if (isDirectMode())\n      {\n        header_type::const_iterator it = header.find(httpheader::connection);\n        return it != header.end() &&\n          tnt::StringCompareIgnoreCase<const char*>(\n              it->second,\n              httpheader::connectionKeepAlive) == 0;\n      }\n      else\n      {\n        return TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0;\n      }\n    }\n}"
  },
  {
    "function_name": "clearCookie",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "507-513",
    "snippet": "void HttpReply::clearCookie(const std::string& name)\n  {\n    log_debug(\"clearCookie(\\\"\" << name << \"\\\")\");\n    tnt::Cookie cookie;\n    cookie.setPath(\"/\");\n    httpcookies.clearCookie(name, cookie);\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "httpcookies.clearCookie",
          "args": [
            "name",
            "cookie"
          ],
          "line": 512
        },
        "resolved": true,
        "details": {
          "function_name": "clearCookie",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpreply.h",
          "lines": "114-115",
          "snippet": "void clearCookie(const std::string& name, const Cookie& c)\n        { httpcookies.clearCookie(name, c); }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "cookie.setPath",
          "args": [
            "\"/\""
          ],
          "line": 511
        },
        "resolved": true,
        "details": {
          "function_name": "setPath",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "111-111",
          "snippet": "void setPath(const std::string& value_)    { setAttr(path, value_); }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  void setPath(const std::string& value_)    { setAttr(path, value_); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"clearCookie(\\\"\" << name << \"\\\")\""
          ],
          "line": 509
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::clearCookie(const std::string& name)\n    {\n      log_debug(\"clearCookie(\\\"\" << name << \"\\\")\");\n      tnt::Cookie cookie;\n      cookie.setPath(\"/\");\n      httpcookies.clearCookie(name, cookie);\n    }\n}"
  },
  {
    "function_name": "setCookie",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "498-505",
    "snippet": "void HttpReply::setCookie(const std::string& name, const Cookie& value)\n  {\n    log_debug(\"setCookie(\\\"\" << name << \"\\\",\\\"\" << value.getValue() << \"\\\")\");\n    tnt::Cookie cookie(value);\n    if (!cookie.hasPath())\n      cookie.setPath(\"/\");\n    httpcookies.setCookie(name, cookie);\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "httpcookies.setCookie",
          "args": [
            "name",
            "cookie"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "setCookie",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "498-505",
          "snippet": "void HttpReply::setCookie(const std::string& name, const Cookie& value)\n  {\n    log_debug(\"setCookie(\\\"\" << name << \"\\\",\\\"\" << value.getValue() << \"\\\")\");\n    tnt::Cookie cookie(value);\n    if (!cookie.hasPath())\n      cookie.setPath(\"/\");\n    httpcookies.setCookie(name, cookie);\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "cookie.setPath",
          "args": [
            "\"/\""
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "setPath",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "111-111",
          "snippet": "void setPath(const std::string& value_)    { setAttr(path, value_); }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  void setPath(const std::string& value_)    { setAttr(path, value_); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cookie.hasPath",
          "args": [],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "hasPath",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "119-119",
          "snippet": "bool hasPath() const                       { return hasAttr(path); }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  bool hasPath() const                       { return hasAttr(path); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"setCookie(\\\"\" << name << \"\\\",\\\"\" << value.getValue() << \"\\\")\""
          ],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.getValue",
          "args": [],
          "line": 500
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setCookie(const std::string& name, const Cookie& value)\n    {\n      log_debug(\"setCookie(\\\"\" << name << \"\\\",\\\"\" << value.getValue() << \"\\\")\");\n      tnt::Cookie cookie(value);\n      if (!cookie.hasPath())\n        cookie.setPath(\"/\");\n      httpcookies.setCookie(name, cookie);\n    }\n}"
  },
  {
    "function_name": "setDirectModeNoFlush",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "492-496",
    "snippet": "void HttpReply::setDirectModeNoFlush()\n  {\n    current_outstream = impl->socket;\n    impl->safe_outstream.setSink(*impl->socket);\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl->safe_outstream.setSink",
          "args": [
            "*impl->socket"
          ],
          "line": 495
        },
        "resolved": true,
        "details": {
          "function_name": "setSink",
          "container": "UrlEscOstream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/urlescostream.h",
          "lines": "70-71",
          "snippet": "void setSink(std::streambuf* sink)\n        { streambuf.setSink(sink); }",
          "includes": [
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n\nUrlEscOstream {\n  void setSink(std::streambuf* sink)\n          { streambuf.setSink(sink); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setDirectModeNoFlush()\n    {\n      current_outstream = impl->socket;\n      impl->safe_outstream.setSink(*impl->socket);\n    }\n}"
  },
  {
    "function_name": "setDirectMode",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "482-490",
    "snippet": "void HttpReply::setDirectMode(unsigned ret, const char* msg)\n  {\n    if (!isDirectMode())\n    {\n      send(ret, msg, false);\n      current_outstream = impl->socket;\n      impl->safe_outstream.setSink(*impl->socket);\n    }\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl->safe_outstream.setSink",
          "args": [
            "*impl->socket"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "setSink",
          "container": "UrlEscOstream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/urlescostream.h",
          "lines": "70-71",
          "snippet": "void setSink(std::streambuf* sink)\n        { streambuf.setSink(sink); }",
          "includes": [
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n\nUrlEscOstream {\n  void setSink(std::streambuf* sink)\n          { streambuf.setSink(sink); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "send",
          "args": [
            "ret",
            "msg",
            "false"
          ],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "send",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "286-394",
          "snippet": "void HttpReply::send(unsigned ret, const char* msg, bool ready) const\n  {\n    std::string body = impl->outstream.str();\n\n    std::ostream hsocket(impl->socket->rdbuf());\n    hsocket.imbue(std::locale::classic());\n\n    // send header\n\n    if (impl->sendStatusLine)\n    {\n      log_debug(\"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n             << ' ' << ret << ' ' << msg);\n      hsocket << \"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n              << ' ' << ret << ' ' << msg << \"\\r\\n\";\n    }\n\n    if (!hasHeader(httpheader::date))\n    {\n      std::string current = htdateCurrent();\n      log_debug(httpheader::date << ' ' << current);\n      hsocket << httpheader::date << ' ' << current << \"\\r\\n\";\n    }\n\n    if (!TntConfig::it().server.empty()\n      && TntConfig::it().hasServer\n      && !hasHeader(httpheader::server))\n    {\n      log_debug(httpheader::server << ' ' << TntConfig::it().server);\n      hsocket << httpheader::server << ' ' << TntConfig::it().server << \"\\r\\n\";\n    }\n\n    if (ready)\n    {\n      if (body.size() >= TntConfig::it().minCompressSize\n        && !hasHeader(httpheader::contentEncoding)\n        && impl->acceptEncoding.accept(\"gzip\")\n        && tryCompress(body))\n      {\n        log_debug(httpheader::contentEncoding << \" gzip\");\n        hsocket << httpheader::contentEncoding << \" gzip\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::contentLength))\n      {\n        log_debug(httpheader::contentLength << ' ' << body.size());\n        hsocket << httpheader::contentLength << ' ' << body.size() << \"\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::contentType))\n      {\n        log_debug(httpheader::contentType << ' ' << TntConfig::it().defaultContentType);\n        hsocket << httpheader::contentType << ' ' << TntConfig::it().defaultContentType << \"\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::connection))\n      {\n        if (TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0)\n        {\n          log_debug(httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter());\n          log_debug(httpheader::connection << ' ' << httpheader::connectionKeepAlive);\n          hsocket << httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter() << \"\\r\\n\"\n                  << httpheader::connection << ' ' << httpheader::connectionKeepAlive << \"\\r\\n\";\n        }\n        else\n        {\n          log_debug(httpheader::connection << ' ' << httpheader::connectionClose);\n          hsocket << httpheader::connection << ' ' << httpheader::connectionClose << \"\\r\\n\";\n        }\n      }\n    }\n\n    for (header_type::const_iterator it = header.begin();\n         it != header.end(); ++it)\n    {\n      log_debug(it->first << ' ' << it->second);\n      hsocket << it->first << ' ' << it->second << \"\\r\\n\";\n    }\n\n    if (hasCookies())\n    {\n      log_debug(httpheader::setCookie << ' ' << httpcookies);\n\n      for (Cookies::cookies_type::const_iterator it = httpcookies.data.begin();\n        it != httpcookies.data.end(); ++it)\n      {\n        hsocket << httpheader::setCookie << ' ';\n        it->second.write(hsocket, it->first);\n        hsocket << \"\\r\\n\";\n      }\n    }\n\n    hsocket << \"\\r\\n\";\n\n    // send body\n\n    if (impl->headRequest)\n      log_debug(\"HEAD-request - empty body\");\n    else\n    {\n      log_debug(\"send \" << body.size() << \" bytes body\");\n      // We send in chunks just to leave to ostream operator from time to time.\n      // There are iostream libraries, which do have a global lock, which\n      // block other iostreams while writing.\n      const unsigned chunkSize = 65536;\n      for (unsigned n = 0; n < body.size(); n += chunkSize)\n        hsocket.write(body.data() + n, std::min(static_cast<unsigned>(body.size() - n), chunkSize));\n    }\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::send(unsigned ret, const char* msg, bool ready) const\n    {\n      std::string body = impl->outstream.str();\n  \n      std::ostream hsocket(impl->socket->rdbuf());\n      hsocket.imbue(std::locale::classic());\n  \n      // send header\n  \n      if (impl->sendStatusLine)\n      {\n        log_debug(\"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n               << ' ' << ret << ' ' << msg);\n        hsocket << \"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n                << ' ' << ret << ' ' << msg << \"\\r\\n\";\n      }\n  \n      if (!hasHeader(httpheader::date))\n      {\n        std::string current = htdateCurrent();\n        log_debug(httpheader::date << ' ' << current);\n        hsocket << httpheader::date << ' ' << current << \"\\r\\n\";\n      }\n  \n      if (!TntConfig::it().server.empty()\n        && TntConfig::it().hasServer\n        && !hasHeader(httpheader::server))\n      {\n        log_debug(httpheader::server << ' ' << TntConfig::it().server);\n        hsocket << httpheader::server << ' ' << TntConfig::it().server << \"\\r\\n\";\n      }\n  \n      if (ready)\n      {\n        if (body.size() >= TntConfig::it().minCompressSize\n          && !hasHeader(httpheader::contentEncoding)\n          && impl->acceptEncoding.accept(\"gzip\")\n          && tryCompress(body))\n        {\n          log_debug(httpheader::contentEncoding << \" gzip\");\n          hsocket << httpheader::contentEncoding << \" gzip\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::contentLength))\n        {\n          log_debug(httpheader::contentLength << ' ' << body.size());\n          hsocket << httpheader::contentLength << ' ' << body.size() << \"\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::contentType))\n        {\n          log_debug(httpheader::contentType << ' ' << TntConfig::it().defaultContentType);\n          hsocket << httpheader::contentType << ' ' << TntConfig::it().defaultContentType << \"\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::connection))\n        {\n          if (TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0)\n          {\n            log_debug(httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter());\n            log_debug(httpheader::connection << ' ' << httpheader::connectionKeepAlive);\n            hsocket << httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter() << \"\\r\\n\"\n                    << httpheader::connection << ' ' << httpheader::connectionKeepAlive << \"\\r\\n\";\n          }\n          else\n          {\n            log_debug(httpheader::connection << ' ' << httpheader::connectionClose);\n            hsocket << httpheader::connection << ' ' << httpheader::connectionClose << \"\\r\\n\";\n          }\n        }\n      }\n  \n      for (header_type::const_iterator it = header.begin();\n           it != header.end(); ++it)\n      {\n        log_debug(it->first << ' ' << it->second);\n        hsocket << it->first << ' ' << it->second << \"\\r\\n\";\n      }\n  \n      if (hasCookies())\n      {\n        log_debug(httpheader::setCookie << ' ' << httpcookies);\n  \n        for (Cookies::cookies_type::const_iterator it = httpcookies.data.begin();\n          it != httpcookies.data.end(); ++it)\n        {\n          hsocket << httpheader::setCookie << ' ';\n          it->second.write(hsocket, it->first);\n          hsocket << \"\\r\\n\";\n        }\n      }\n  \n      hsocket << \"\\r\\n\";\n  \n      // send body\n  \n      if (impl->headRequest)\n        log_debug(\"HEAD-request - empty body\");\n      else\n      {\n        log_debug(\"send \" << body.size() << \" bytes body\");\n        // We send in chunks just to leave to ostream operator from time to time.\n        // There are iostream libraries, which do have a global lock, which\n        // block other iostreams while writing.\n        const unsigned chunkSize = 65536;\n        for (unsigned n = 0; n < body.size(); n += chunkSize)\n          hsocket.write(body.data() + n, std::min(static_cast<unsigned>(body.size() - n), chunkSize));\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isDirectMode",
          "args": [],
          "line": 484
        },
        "resolved": true,
        "details": {
          "function_name": "isDirectMode",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "232-235",
          "snippet": "bool HttpReply::isDirectMode() const\n  {\n    return current_outstream == impl->socket;\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::isDirectMode() const\n    {\n      return current_outstream == impl->socket;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setDirectMode(unsigned ret, const char* msg)\n    {\n      if (!isDirectMode())\n      {\n        send(ret, msg, false);\n        current_outstream = impl->socket;\n        impl->safe_outstream.setSink(*impl->socket);\n      }\n    }\n}"
  },
  {
    "function_name": "setMaxAgeHeader",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "464-480",
    "snippet": "void HttpReply::setMaxAgeHeader(unsigned seconds)\n  {\n    if (seconds > 0)\n    {\n      char buffer[64];\n      snprintf(buffer, sizeof(buffer), \"max-age=%u\", seconds);\n      header.setHeader(httpheader::cacheControl, buffer, true);\n      header.setHeader(httpheader::age, \"0\", true);\n      header.setHeader(httpheader::cacheControl, buffer, true);\n    }\n    else\n    {\n      header.setHeader(httpheader::cacheControl, \"no-cache\", true);\n      header.setHeader(httpheader::pragma, \"no-cache\", true);\n      header.setHeader(httpheader::expires, \"-1\", true);\n    }\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "header.setHeader",
          "args": [
            "httpheader::expires",
            "\"-1\"",
            "true"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "setHeader",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "101-126",
          "snippet": "void Messageheader::setHeader(const char* key, const char* value, bool replace)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    if (replace)\n      removeHeader(key);\n\n    char* p = getEnd();\n\n    size_t lk = std::strlen(key);     // length of key\n    size_t lk2 = key[lk-1] == ':' ? lk + 1 : lk + 2;  // length of key including trailing ':' and terminator\n    size_t lv = std::strlen(value);   // length of value\n\n    if (p - rawdata + lk2 + lv + 3 > MAXHEADERSIZE)\n      throw std::runtime_error(\"message header too big\");\n\n    std::strcpy(p, key);   // copy key\n    p += lk2;\n    *(p - 2) = ':';        // make sure, key is prepended by ':'\n    *(p - 1) = '\\0';\n    std::strcpy(p, value); // copy value\n    p[lv + 1] = '\\0';      // put new message end marker in place\n\n    endOffset = (p + lv + 1) - rawdata;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  void Messageheader::setHeader(const char* key, const char* value, bool replace)\n    {\n      if (!*key)\n        throw std::runtime_error(\"empty key not allowed in messageheader\");\n  \n      if (replace)\n        removeHeader(key);\n  \n      char* p = getEnd();\n  \n      size_t lk = std::strlen(key);     // length of key\n      size_t lk2 = key[lk-1] == ':' ? lk + 1 : lk + 2;  // length of key including trailing ':' and terminator\n      size_t lv = std::strlen(value);   // length of value\n  \n      if (p - rawdata + lk2 + lv + 3 > MAXHEADERSIZE)\n        throw std::runtime_error(\"message header too big\");\n  \n      std::strcpy(p, key);   // copy key\n      p += lk2;\n      *(p - 2) = ':';        // make sure, key is prepended by ':'\n      *(p - 1) = '\\0';\n      std::strcpy(p, value); // copy value\n      p[lv + 1] = '\\0';      // put new message end marker in place\n  \n      endOffset = (p + lv + 1) - rawdata;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "\"max-age=%u\"",
            "seconds"
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setMaxAgeHeader(unsigned seconds)\n    {\n      if (seconds > 0)\n      {\n        char buffer[64];\n        snprintf(buffer, sizeof(buffer), \"max-age=%u\", seconds);\n        header.setHeader(httpheader::cacheControl, buffer, true);\n        header.setHeader(httpheader::age, \"0\", true);\n        header.setHeader(httpheader::cacheControl, buffer, true);\n      }\n      else\n      {\n        header.setHeader(httpheader::cacheControl, \"no-cache\", true);\n        header.setHeader(httpheader::pragma, \"no-cache\", true);\n        header.setHeader(httpheader::expires, \"-1\", true);\n      }\n    }\n}"
  },
  {
    "function_name": "setKeepAliveHeader",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "444-462",
    "snippet": "void HttpReply::setKeepAliveHeader()\n  {\n    log_debug(\"setKeepAliveHeader()\");\n    removeHeader(httpheader::connection);\n    removeHeader(httpheader::keepAlive);\n    if (TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0)\n    {\n      char buffer[64];\n      snprintf(buffer, sizeof(buffer),\n        \"timeout=%lu, max=%u\",\n        static_cast<unsigned long>(TntConfig::it().keepAliveTimeout),\n        static_cast<unsigned>(getKeepAliveCounter()));\n      header.setHeader(httpheader::keepAlive, buffer, true);\n\n      header.setHeader(httpheader::connection, httpheader::connectionKeepAlive, true);\n    }\n    else\n      header.setHeader(httpheader::connection, httpheader::connectionClose, true);\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "header.setHeader",
          "args": [
            "httpheader::connection",
            "httpheader::connectionClose",
            "true"
          ],
          "line": 461
        },
        "resolved": true,
        "details": {
          "function_name": "setHeader",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "101-126",
          "snippet": "void Messageheader::setHeader(const char* key, const char* value, bool replace)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    if (replace)\n      removeHeader(key);\n\n    char* p = getEnd();\n\n    size_t lk = std::strlen(key);     // length of key\n    size_t lk2 = key[lk-1] == ':' ? lk + 1 : lk + 2;  // length of key including trailing ':' and terminator\n    size_t lv = std::strlen(value);   // length of value\n\n    if (p - rawdata + lk2 + lv + 3 > MAXHEADERSIZE)\n      throw std::runtime_error(\"message header too big\");\n\n    std::strcpy(p, key);   // copy key\n    p += lk2;\n    *(p - 2) = ':';        // make sure, key is prepended by ':'\n    *(p - 1) = '\\0';\n    std::strcpy(p, value); // copy value\n    p[lv + 1] = '\\0';      // put new message end marker in place\n\n    endOffset = (p + lv + 1) - rawdata;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  void Messageheader::setHeader(const char* key, const char* value, bool replace)\n    {\n      if (!*key)\n        throw std::runtime_error(\"empty key not allowed in messageheader\");\n  \n      if (replace)\n        removeHeader(key);\n  \n      char* p = getEnd();\n  \n      size_t lk = std::strlen(key);     // length of key\n      size_t lk2 = key[lk-1] == ':' ? lk + 1 : lk + 2;  // length of key including trailing ':' and terminator\n      size_t lv = std::strlen(value);   // length of value\n  \n      if (p - rawdata + lk2 + lv + 3 > MAXHEADERSIZE)\n        throw std::runtime_error(\"message header too big\");\n  \n      std::strcpy(p, key);   // copy key\n      p += lk2;\n      *(p - 2) = ':';        // make sure, key is prepended by ':'\n      *(p - 1) = '\\0';\n      std::strcpy(p, value); // copy value\n      p[lv + 1] = '\\0';      // put new message end marker in place\n  \n      endOffset = (p + lv + 1) - rawdata;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "\"timeout=%lu, max=%u\"",
            "static_cast<unsigned long>(TntConfig::it().keepAliveTimeout)",
            "static_cast<unsigned>(getKeepAliveCounter())"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<unsigned>",
          "args": [
            "getKeepAliveCounter()"
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getKeepAliveCounter",
          "args": [],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "getKeepAliveCounter",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "252-255",
          "snippet": "unsigned HttpReply::getKeepAliveCounter() const\n  {\n    return impl->keepAliveCounter;\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  unsigned HttpReply::getKeepAliveCounter() const\n    {\n      return impl->keepAliveCounter;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<unsigned long>",
          "args": [
            "TntConfig::it().keepAliveTimeout"
          ],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "removeHeader",
          "args": [
            "httpheader::keepAlive"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "removeHeader",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "51-79",
          "snippet": "void Messageheader::removeHeader(const char* key)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    char* p = getEnd();\n\n    const_iterator it = begin();\n    while (it != end())\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n      {\n        unsigned slen = it->second - it->first + std::strlen(it->second) + 1;\n\n        std::memmove(\n            const_cast<char*>(it->first),\n            it->first + slen,\n            p - it->first + slen);\n\n        p -= slen;\n\n        it.fixup();\n      }\n      else\n        ++it;\n    }\n\n    endOffset = p - rawdata;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  void Messageheader::removeHeader(const char* key)\n    {\n      if (!*key)\n        throw std::runtime_error(\"empty key not allowed in messageheader\");\n  \n      char* p = getEnd();\n  \n      const_iterator it = begin();\n      while (it != end())\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        {\n          unsigned slen = it->second - it->first + std::strlen(it->second) + 1;\n  \n          std::memmove(\n              const_cast<char*>(it->first),\n              it->first + slen,\n              p - it->first + slen);\n  \n          p -= slen;\n  \n          it.fixup();\n        }\n        else\n          ++it;\n      }\n  \n      endOffset = p - rawdata;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"setKeepAliveHeader()\""
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setKeepAliveHeader()\n    {\n      log_debug(\"setKeepAliveHeader()\");\n      removeHeader(httpheader::connection);\n      removeHeader(httpheader::keepAlive);\n      if (TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0)\n      {\n        char buffer[64];\n        snprintf(buffer, sizeof(buffer),\n          \"timeout=%lu, max=%u\",\n          static_cast<unsigned long>(TntConfig::it().keepAliveTimeout),\n          static_cast<unsigned>(getKeepAliveCounter()));\n        header.setHeader(httpheader::keepAlive, buffer, true);\n  \n        header.setHeader(httpheader::connection, httpheader::connectionKeepAlive, true);\n      }\n      else\n        header.setHeader(httpheader::connection, httpheader::connectionClose, true);\n    }\n}"
  },
  {
    "function_name": "setContentLengthHeader",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "437-442",
    "snippet": "void HttpReply::setContentLengthHeader(size_t size)\n  {\n    char buffer[32];\n    snprintf(buffer, sizeof(buffer), \"%lu\", static_cast<unsigned long>(size));\n    header.setHeader(httpheader::contentLength, buffer, true);\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "header.setHeader",
          "args": [
            "httpheader::contentLength",
            "buffer",
            "true"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "setHeader",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "101-126",
          "snippet": "void Messageheader::setHeader(const char* key, const char* value, bool replace)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    if (replace)\n      removeHeader(key);\n\n    char* p = getEnd();\n\n    size_t lk = std::strlen(key);     // length of key\n    size_t lk2 = key[lk-1] == ':' ? lk + 1 : lk + 2;  // length of key including trailing ':' and terminator\n    size_t lv = std::strlen(value);   // length of value\n\n    if (p - rawdata + lk2 + lv + 3 > MAXHEADERSIZE)\n      throw std::runtime_error(\"message header too big\");\n\n    std::strcpy(p, key);   // copy key\n    p += lk2;\n    *(p - 2) = ':';        // make sure, key is prepended by ':'\n    *(p - 1) = '\\0';\n    std::strcpy(p, value); // copy value\n    p[lv + 1] = '\\0';      // put new message end marker in place\n\n    endOffset = (p + lv + 1) - rawdata;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  void Messageheader::setHeader(const char* key, const char* value, bool replace)\n    {\n      if (!*key)\n        throw std::runtime_error(\"empty key not allowed in messageheader\");\n  \n      if (replace)\n        removeHeader(key);\n  \n      char* p = getEnd();\n  \n      size_t lk = std::strlen(key);     // length of key\n      size_t lk2 = key[lk-1] == ':' ? lk + 1 : lk + 2;  // length of key including trailing ':' and terminator\n      size_t lv = std::strlen(value);   // length of value\n  \n      if (p - rawdata + lk2 + lv + 3 > MAXHEADERSIZE)\n        throw std::runtime_error(\"message header too big\");\n  \n      std::strcpy(p, key);   // copy key\n      p += lk2;\n      *(p - 2) = ':';        // make sure, key is prepended by ':'\n      *(p - 1) = '\\0';\n      std::strcpy(p, value); // copy value\n      p[lv + 1] = '\\0';      // put new message end marker in place\n  \n      endOffset = (p + lv + 1) - rawdata;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buffer",
            "sizeof(buffer)",
            "\"%lu\"",
            "static_cast<unsigned long>(size)"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<unsigned long>",
          "args": [
            "size"
          ],
          "line": 440
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setContentLengthHeader(size_t size)\n    {\n      char buffer[32];\n      snprintf(buffer, sizeof(buffer), \"%lu\", static_cast<unsigned long>(size));\n      header.setHeader(httpheader::contentLength, buffer, true);\n    }\n}"
  },
  {
    "function_name": "notAuthorized",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "425-435",
    "snippet": "unsigned HttpReply::notAuthorized(const std::string& realm)\n  {\n    setHeader(httpheader::wwwAuthenticate, \"Basic realm=\\\"\" + realm + '\"');\n\n    impl->outstream.str(std::string());\n    impl->outstream << \"<html><body><h1>not authorized</h1></body></html>\";\n\n    throw HttpReturn(HTTP_UNAUTHORIZED, \"not authorized\");\n\n    return HTTP_UNAUTHORIZED;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HttpReturn",
          "args": [
            "HTTP_UNAUTHORIZED",
            "\"not authorized\""
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "HttpReturn",
          "container": "HttpReturn",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "132-136",
          "snippet": "HttpReturn::HttpReturn(unsigned returncode_, const char* msg_)\n    : returncode(returncode_),\n      msg(msg_)\n  {\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpReturn {\n  HttpReturn::HttpReturn(unsigned returncode_, const char* msg_)\n      : returncode(returncode_),\n        msg(msg_)\n    {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [
            "std::string()"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setHeader",
          "args": [
            "httpheader::wwwAuthenticate",
            "\"Basic realm=\\\"\" + realm + '\"'"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "setHeader",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "91-92",
          "snippet": "void setHeader(const std::string& key, const std::string& value, bool replace = true)\n        { header.setHeader(key, value, replace); }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  void setHeader(const std::string& key, const std::string& value, bool replace = true)\n          { header.setHeader(key, value, replace); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  unsigned HttpReply::notAuthorized(const std::string& realm)\n    {\n      setHeader(httpheader::wwwAuthenticate, \"Basic realm=\\\"\" + realm + '\"');\n  \n      impl->outstream.str(std::string());\n      impl->outstream << \"<html><body><h1>not authorized</h1></body></html>\";\n  \n      throw HttpReturn(HTTP_UNAUTHORIZED, \"not authorized\");\n  \n      return HTTP_UNAUTHORIZED;\n    }\n}"
  },
  {
    "function_name": "redirect",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "412-423",
    "snippet": "unsigned HttpReply::redirect(const std::string& newLocation, Redirect type)\n  {\n    setHeader(httpheader::location, newLocation);\n\n    impl->outstream.str(std::string());\n    impl->outstream << \"<html><body>moved to <a href=\\\"\" << newLocation << \"\\\">\" << newLocation << \"</a></body></html>\";\n\n    unsigned httpCode = static_cast<unsigned>(type);\n    throw HttpReturn(httpCode, HttpReturn::httpMessage(httpCode));\n\n    return httpCode;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HttpReturn",
          "args": [
            "httpCode",
            "HttpReturn::httpMessage(httpCode)"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "HttpReturn",
          "container": "HttpReturn",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "132-136",
          "snippet": "HttpReturn::HttpReturn(unsigned returncode_, const char* msg_)\n    : returncode(returncode_),\n      msg(msg_)\n  {\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpReturn {\n  HttpReturn::HttpReturn(unsigned returncode_, const char* msg_)\n      : returncode(returncode_),\n        msg(msg_)\n    {\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "HttpReturn::httpMessage",
          "args": [
            "httpCode"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<unsigned>",
          "args": [
            "type"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [
            "std::string()"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setHeader",
          "args": [
            "httpheader::location",
            "newLocation"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "setHeader",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "91-92",
          "snippet": "void setHeader(const std::string& key, const std::string& value, bool replace = true)\n        { header.setHeader(key, value, replace); }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  void setHeader(const std::string& key, const std::string& value, bool replace = true)\n          { header.setHeader(key, value, replace); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  unsigned HttpReply::redirect(const std::string& newLocation, Redirect type)\n    {\n      setHeader(httpheader::location, newLocation);\n  \n      impl->outstream.str(std::string());\n      impl->outstream << \"<html><body>moved to <a href=\\\"\" << newLocation << \"\\\">\" << newLocation << \"</a></body></html>\";\n  \n      unsigned httpCode = static_cast<unsigned>(type);\n      throw HttpReturn(httpCode, HttpReturn::httpMessage(httpCode));\n  \n      return httpCode;\n    }\n}"
  },
  {
    "function_name": "setMd5Sum",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "405-410",
    "snippet": "void HttpReply::setMd5Sum()\n  {\n    cxxtools::Md5stream md5;\n    md5 << impl->outstream.str().size();\n    setHeader(httpheader::contentMD5, md5.getHexDigest());\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setHeader",
          "args": [
            "httpheader::contentMD5",
            "md5.getHexDigest()"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "setHeader",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "91-92",
          "snippet": "void setHeader(const std::string& key, const std::string& value, bool replace = true)\n        { header.setHeader(key, value, replace); }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  void setHeader(const std::string& key, const std::string& value, bool replace = true)\n          { header.setHeader(key, value, replace); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "md5.getHexDigest",
          "args": [],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setMd5Sum()\n    {\n      cxxtools::Md5stream md5;\n      md5 << impl->outstream.str().size();\n      setHeader(httpheader::contentMD5, md5.getHexDigest());\n    }\n}"
  },
  {
    "function_name": "sendReply",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "396-403",
    "snippet": "void HttpReply::sendReply(unsigned ret, const char* msg)\n  {\n    if (!isDirectMode())\n    {\n      send(ret, msg, true);\n      impl->socket->flush();\n    }\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl->socket->flush",
          "args": [],
          "line": 401
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "send",
          "args": [
            "ret",
            "msg",
            "true"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "send",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "286-394",
          "snippet": "void HttpReply::send(unsigned ret, const char* msg, bool ready) const\n  {\n    std::string body = impl->outstream.str();\n\n    std::ostream hsocket(impl->socket->rdbuf());\n    hsocket.imbue(std::locale::classic());\n\n    // send header\n\n    if (impl->sendStatusLine)\n    {\n      log_debug(\"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n             << ' ' << ret << ' ' << msg);\n      hsocket << \"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n              << ' ' << ret << ' ' << msg << \"\\r\\n\";\n    }\n\n    if (!hasHeader(httpheader::date))\n    {\n      std::string current = htdateCurrent();\n      log_debug(httpheader::date << ' ' << current);\n      hsocket << httpheader::date << ' ' << current << \"\\r\\n\";\n    }\n\n    if (!TntConfig::it().server.empty()\n      && TntConfig::it().hasServer\n      && !hasHeader(httpheader::server))\n    {\n      log_debug(httpheader::server << ' ' << TntConfig::it().server);\n      hsocket << httpheader::server << ' ' << TntConfig::it().server << \"\\r\\n\";\n    }\n\n    if (ready)\n    {\n      if (body.size() >= TntConfig::it().minCompressSize\n        && !hasHeader(httpheader::contentEncoding)\n        && impl->acceptEncoding.accept(\"gzip\")\n        && tryCompress(body))\n      {\n        log_debug(httpheader::contentEncoding << \" gzip\");\n        hsocket << httpheader::contentEncoding << \" gzip\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::contentLength))\n      {\n        log_debug(httpheader::contentLength << ' ' << body.size());\n        hsocket << httpheader::contentLength << ' ' << body.size() << \"\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::contentType))\n      {\n        log_debug(httpheader::contentType << ' ' << TntConfig::it().defaultContentType);\n        hsocket << httpheader::contentType << ' ' << TntConfig::it().defaultContentType << \"\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::connection))\n      {\n        if (TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0)\n        {\n          log_debug(httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter());\n          log_debug(httpheader::connection << ' ' << httpheader::connectionKeepAlive);\n          hsocket << httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter() << \"\\r\\n\"\n                  << httpheader::connection << ' ' << httpheader::connectionKeepAlive << \"\\r\\n\";\n        }\n        else\n        {\n          log_debug(httpheader::connection << ' ' << httpheader::connectionClose);\n          hsocket << httpheader::connection << ' ' << httpheader::connectionClose << \"\\r\\n\";\n        }\n      }\n    }\n\n    for (header_type::const_iterator it = header.begin();\n         it != header.end(); ++it)\n    {\n      log_debug(it->first << ' ' << it->second);\n      hsocket << it->first << ' ' << it->second << \"\\r\\n\";\n    }\n\n    if (hasCookies())\n    {\n      log_debug(httpheader::setCookie << ' ' << httpcookies);\n\n      for (Cookies::cookies_type::const_iterator it = httpcookies.data.begin();\n        it != httpcookies.data.end(); ++it)\n      {\n        hsocket << httpheader::setCookie << ' ';\n        it->second.write(hsocket, it->first);\n        hsocket << \"\\r\\n\";\n      }\n    }\n\n    hsocket << \"\\r\\n\";\n\n    // send body\n\n    if (impl->headRequest)\n      log_debug(\"HEAD-request - empty body\");\n    else\n    {\n      log_debug(\"send \" << body.size() << \" bytes body\");\n      // We send in chunks just to leave to ostream operator from time to time.\n      // There are iostream libraries, which do have a global lock, which\n      // block other iostreams while writing.\n      const unsigned chunkSize = 65536;\n      for (unsigned n = 0; n < body.size(); n += chunkSize)\n        hsocket.write(body.data() + n, std::min(static_cast<unsigned>(body.size() - n), chunkSize));\n    }\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::send(unsigned ret, const char* msg, bool ready) const\n    {\n      std::string body = impl->outstream.str();\n  \n      std::ostream hsocket(impl->socket->rdbuf());\n      hsocket.imbue(std::locale::classic());\n  \n      // send header\n  \n      if (impl->sendStatusLine)\n      {\n        log_debug(\"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n               << ' ' << ret << ' ' << msg);\n        hsocket << \"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n                << ' ' << ret << ' ' << msg << \"\\r\\n\";\n      }\n  \n      if (!hasHeader(httpheader::date))\n      {\n        std::string current = htdateCurrent();\n        log_debug(httpheader::date << ' ' << current);\n        hsocket << httpheader::date << ' ' << current << \"\\r\\n\";\n      }\n  \n      if (!TntConfig::it().server.empty()\n        && TntConfig::it().hasServer\n        && !hasHeader(httpheader::server))\n      {\n        log_debug(httpheader::server << ' ' << TntConfig::it().server);\n        hsocket << httpheader::server << ' ' << TntConfig::it().server << \"\\r\\n\";\n      }\n  \n      if (ready)\n      {\n        if (body.size() >= TntConfig::it().minCompressSize\n          && !hasHeader(httpheader::contentEncoding)\n          && impl->acceptEncoding.accept(\"gzip\")\n          && tryCompress(body))\n        {\n          log_debug(httpheader::contentEncoding << \" gzip\");\n          hsocket << httpheader::contentEncoding << \" gzip\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::contentLength))\n        {\n          log_debug(httpheader::contentLength << ' ' << body.size());\n          hsocket << httpheader::contentLength << ' ' << body.size() << \"\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::contentType))\n        {\n          log_debug(httpheader::contentType << ' ' << TntConfig::it().defaultContentType);\n          hsocket << httpheader::contentType << ' ' << TntConfig::it().defaultContentType << \"\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::connection))\n        {\n          if (TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0)\n          {\n            log_debug(httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter());\n            log_debug(httpheader::connection << ' ' << httpheader::connectionKeepAlive);\n            hsocket << httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter() << \"\\r\\n\"\n                    << httpheader::connection << ' ' << httpheader::connectionKeepAlive << \"\\r\\n\";\n          }\n          else\n          {\n            log_debug(httpheader::connection << ' ' << httpheader::connectionClose);\n            hsocket << httpheader::connection << ' ' << httpheader::connectionClose << \"\\r\\n\";\n          }\n        }\n      }\n  \n      for (header_type::const_iterator it = header.begin();\n           it != header.end(); ++it)\n      {\n        log_debug(it->first << ' ' << it->second);\n        hsocket << it->first << ' ' << it->second << \"\\r\\n\";\n      }\n  \n      if (hasCookies())\n      {\n        log_debug(httpheader::setCookie << ' ' << httpcookies);\n  \n        for (Cookies::cookies_type::const_iterator it = httpcookies.data.begin();\n          it != httpcookies.data.end(); ++it)\n        {\n          hsocket << httpheader::setCookie << ' ';\n          it->second.write(hsocket, it->first);\n          hsocket << \"\\r\\n\";\n        }\n      }\n  \n      hsocket << \"\\r\\n\";\n  \n      // send body\n  \n      if (impl->headRequest)\n        log_debug(\"HEAD-request - empty body\");\n      else\n      {\n        log_debug(\"send \" << body.size() << \" bytes body\");\n        // We send in chunks just to leave to ostream operator from time to time.\n        // There are iostream libraries, which do have a global lock, which\n        // block other iostreams while writing.\n        const unsigned chunkSize = 65536;\n        for (unsigned n = 0; n < body.size(); n += chunkSize)\n          hsocket.write(body.data() + n, std::min(static_cast<unsigned>(body.size() - n), chunkSize));\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isDirectMode",
          "args": [],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "isDirectMode",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "232-235",
          "snippet": "bool HttpReply::isDirectMode() const\n  {\n    return current_outstream == impl->socket;\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::isDirectMode() const\n    {\n      return current_outstream == impl->socket;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::sendReply(unsigned ret, const char* msg)\n    {\n      if (!isDirectMode())\n      {\n        send(ret, msg, true);\n        impl->socket->flush();\n      }\n    }\n}"
  },
  {
    "function_name": "send",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "286-394",
    "snippet": "void HttpReply::send(unsigned ret, const char* msg, bool ready) const\n  {\n    std::string body = impl->outstream.str();\n\n    std::ostream hsocket(impl->socket->rdbuf());\n    hsocket.imbue(std::locale::classic());\n\n    // send header\n\n    if (impl->sendStatusLine)\n    {\n      log_debug(\"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n             << ' ' << ret << ' ' << msg);\n      hsocket << \"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n              << ' ' << ret << ' ' << msg << \"\\r\\n\";\n    }\n\n    if (!hasHeader(httpheader::date))\n    {\n      std::string current = htdateCurrent();\n      log_debug(httpheader::date << ' ' << current);\n      hsocket << httpheader::date << ' ' << current << \"\\r\\n\";\n    }\n\n    if (!TntConfig::it().server.empty()\n      && TntConfig::it().hasServer\n      && !hasHeader(httpheader::server))\n    {\n      log_debug(httpheader::server << ' ' << TntConfig::it().server);\n      hsocket << httpheader::server << ' ' << TntConfig::it().server << \"\\r\\n\";\n    }\n\n    if (ready)\n    {\n      if (body.size() >= TntConfig::it().minCompressSize\n        && !hasHeader(httpheader::contentEncoding)\n        && impl->acceptEncoding.accept(\"gzip\")\n        && tryCompress(body))\n      {\n        log_debug(httpheader::contentEncoding << \" gzip\");\n        hsocket << httpheader::contentEncoding << \" gzip\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::contentLength))\n      {\n        log_debug(httpheader::contentLength << ' ' << body.size());\n        hsocket << httpheader::contentLength << ' ' << body.size() << \"\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::contentType))\n      {\n        log_debug(httpheader::contentType << ' ' << TntConfig::it().defaultContentType);\n        hsocket << httpheader::contentType << ' ' << TntConfig::it().defaultContentType << \"\\r\\n\";\n      }\n\n      if (!hasHeader(httpheader::connection))\n      {\n        if (TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0)\n        {\n          log_debug(httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter());\n          log_debug(httpheader::connection << ' ' << httpheader::connectionKeepAlive);\n          hsocket << httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter() << \"\\r\\n\"\n                  << httpheader::connection << ' ' << httpheader::connectionKeepAlive << \"\\r\\n\";\n        }\n        else\n        {\n          log_debug(httpheader::connection << ' ' << httpheader::connectionClose);\n          hsocket << httpheader::connection << ' ' << httpheader::connectionClose << \"\\r\\n\";\n        }\n      }\n    }\n\n    for (header_type::const_iterator it = header.begin();\n         it != header.end(); ++it)\n    {\n      log_debug(it->first << ' ' << it->second);\n      hsocket << it->first << ' ' << it->second << \"\\r\\n\";\n    }\n\n    if (hasCookies())\n    {\n      log_debug(httpheader::setCookie << ' ' << httpcookies);\n\n      for (Cookies::cookies_type::const_iterator it = httpcookies.data.begin();\n        it != httpcookies.data.end(); ++it)\n      {\n        hsocket << httpheader::setCookie << ' ';\n        it->second.write(hsocket, it->first);\n        hsocket << \"\\r\\n\";\n      }\n    }\n\n    hsocket << \"\\r\\n\";\n\n    // send body\n\n    if (impl->headRequest)\n      log_debug(\"HEAD-request - empty body\");\n    else\n    {\n      log_debug(\"send \" << body.size() << \" bytes body\");\n      // We send in chunks just to leave to ostream operator from time to time.\n      // There are iostream libraries, which do have a global lock, which\n      // block other iostreams while writing.\n      const unsigned chunkSize = 65536;\n      for (unsigned n = 0; n < body.size(); n += chunkSize)\n        hsocket.write(body.data() + n, std::min(static_cast<unsigned>(body.size() - n), chunkSize));\n    }\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hsocket.write",
          "args": [
            "body.data() + n",
            "std::min(static_cast<unsigned>(body.size() - n), chunkSize)"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "474-491",
          "snippet": "void Cookie::write(std::ostream& out, const std::string& name) const\n  {\n    // print name (Customer=\"WILE_E_COYOTE\")\n    out << name << '=';\n    UrlEscOstream u(out);\n    u << getValue();\n\n    // print secure-attribute\n    if (secureFlag)\n      out << \"; \" << Cookie::secure;\n\n    // print attributes\n    for (Cookie::attrs_type::const_iterator a = attrs.begin();\n         a != attrs.end(); ++a)\n      out << \"; \" << a->first << '=' << a->second;\n    if (attrs.find(Cookie::version) == attrs.end())\n      out << \";Version=1\";\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookie {\n  void Cookie::write(std::ostream& out, const std::string& name) const\n    {\n      // print name (Customer=\"WILE_E_COYOTE\")\n      out << name << '=';\n      UrlEscOstream u(out);\n      u << getValue();\n  \n      // print secure-attribute\n      if (secureFlag)\n        out << \"; \" << Cookie::secure;\n  \n      // print attributes\n      for (Cookie::attrs_type::const_iterator a = attrs.begin();\n           a != attrs.end(); ++a)\n        out << \"; \" << a->first << '=' << a->second;\n      if (attrs.find(Cookie::version) == attrs.end())\n        out << \";Version=1\";\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::min",
          "args": [
            "static_cast<unsigned>(body.size() - n)",
            "chunkSize"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<unsigned>",
          "args": [
            "body.size() - n"
          ],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "body.size",
          "args": [],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "body.data",
          "args": [],
          "line": 392
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"send \" << body.size() << \" bytes body\""
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"HEAD-request - empty body\""
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "httpcookies.data.end",
          "args": [],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "httpcookies.data.begin",
          "args": [],
          "line": 369
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::setCookie << ' ' << httpcookies"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hasCookies",
          "args": [],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "hasCookies",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpreply.h",
          "lines": "116-117",
          "snippet": "bool hasCookies() const\n        { return httpcookies.hasCookies(); }",
          "includes": [
            "#include <iosfwd>",
            "#include <tnt/http.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iosfwd>\n#include <tnt/http.h>\n#include <tnt/httpmessage.h>\n\nHttpReply {\n  bool hasCookies() const\n          { return httpcookies.hasCookies(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "it->first << ' ' << it->second"
          ],
          "line": 361
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "header.end",
          "args": [],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::connection << ' ' << httpheader::connectionClose"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getKeepAliveCounter",
          "args": [],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "getKeepAliveCounter",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "252-255",
          "snippet": "unsigned HttpReply::getKeepAliveCounter() const\n  {\n    return impl->keepAliveCounter;\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  unsigned HttpReply::getKeepAliveCounter() const\n    {\n      return impl->keepAliveCounter;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::connection << ' ' << httpheader::connectionKeepAlive"
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter()"
          ],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 345
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hasHeader",
          "args": [
            "httpheader::connection"
          ],
          "line": 341
        },
        "resolved": true,
        "details": {
          "function_name": "hasHeader",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "139-140",
          "snippet": "bool hasHeader(const std::string& key) const\n        { return hasHeader(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  bool hasHeader(const std::string& key) const\n          { return hasHeader(key.c_str()); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::contentType << ' ' << TntConfig::it().defaultContentType"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::contentLength << ' ' << body.size()"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::contentEncoding << \" gzip\""
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tryCompress",
          "args": [
            "body"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "tryCompress",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "262-279",
          "snippet": "bool HttpReply::tryCompress(std::string& body)\n  {\n    log_debug(\"gzip\");\n\n    std::string cbody = doCompress(body);\n\n    std::string::size_type oldSize = body.size();\n    // only send compressed data, if the data is compressed more than 1/8th\n    if (oldSize - (oldSize >> 3) > cbody.size())\n    {\n      body = cbody;\n      log_info(\"gzip body \" << oldSize << \" bytes to \" << body.size() << \" bytes\");\n\n      return true;\n    }\n\n    return false;\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::tryCompress(std::string& body)\n    {\n      log_debug(\"gzip\");\n  \n      std::string cbody = doCompress(body);\n  \n      std::string::size_type oldSize = body.size();\n      // only send compressed data, if the data is compressed more than 1/8th\n      if (oldSize - (oldSize >> 3) > cbody.size())\n      {\n        body = cbody;\n        log_info(\"gzip body \" << oldSize << \" bytes to \" << body.size() << \" bytes\");\n  \n        return true;\n      }\n  \n      return false;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "impl->acceptEncoding.accept",
          "args": [
            "\"gzip\""
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "Encoding",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/encoding.cpp",
          "lines": "162-177",
          "snippet": "unsigned Encoding::accept(const std::string& encoding) const\n  {\n    // check, if encoding is specified\n\n    encodingMapType::const_iterator it =  encodingMap.find(encoding);\n    if (it != encodingMap.end())\n      return it->second;\n\n    // check, if a wildcard-rule is specified\n    it = encodingMap.find(\"*\");\n    if (it != encodingMap.end())\n      return it->second;\n\n    // return 10 (accept), if encoding is identity, 0 otherwise\n    return encoding == \"identity\" ? 10 : 0;\n  }",
          "includes": [
            "#include <cctype>",
            "#include \"tnt/util.h\"",
            "#include \"tnt/encoding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cctype>\n#include \"tnt/util.h\"\n#include \"tnt/encoding.h\"\n\nEncoding {\n  unsigned Encoding::accept(const std::string& encoding) const\n    {\n      // check, if encoding is specified\n  \n      encodingMapType::const_iterator it =  encodingMap.find(encoding);\n      if (it != encodingMap.end())\n        return it->second;\n  \n      // check, if a wildcard-rule is specified\n      it = encodingMap.find(\"*\");\n      if (it != encodingMap.end())\n        return it->second;\n  \n      // return 10 (accept), if encoding is identity, 0 otherwise\n      return encoding == \"identity\" ? 10 : 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 320
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::server << ' ' << TntConfig::it().server"
          ],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "httpheader::date << ' ' << current"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "htdateCurrent",
          "args": [],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "htdateCurrent",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "89-129",
          "snippet": "std::string HttpMessage::htdateCurrent()\n  {\n    static struct ::tm lastTm;\n    static time_t lastDay = 0;\n    static time_t lastTime = 0;\n    static std::string lastHtdate;\n    static cxxtools::Mutex mutex;\n\n    /*\n     * we cache the last split tm-struct here, because it is pretty expensive\n     * to calculate the date with gmtime_r.\n     */\n\n    time_t t;\n    time(&t);\n\n    cxxtools::MutexLock lock(mutex);\n\n    if (lastTime != t)\n    {\n      time_t day = t / (24*60*60);\n      if (day != lastDay)\n      {\n        // Day differs, we calculate new date.\n        gmtime_r(&t, &lastTm);\n        lastDay = day;\n      }\n\n      lastTm.tm_sec = t % 60;\n      t /= 60;\n      lastTm.tm_min = t % 60;\n      t /= 60;\n      lastTm.tm_hour = t % 24;\n      lastHtdate = htdate(&lastTm);\n      lastTime = t;\n    }\n\n    // we do a copy of lastHtdate first to make sure we have the lock\n    std::string ret = lastHtdate;\n    return ret;\n  }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nHttpMessage {\n  std::string HttpMessage::htdateCurrent()\n    {\n      static struct ::tm lastTm;\n      static time_t lastDay = 0;\n      static time_t lastTime = 0;\n      static std::string lastHtdate;\n      static cxxtools::Mutex mutex;\n  \n      /*\n       * we cache the last split tm-struct here, because it is pretty expensive\n       * to calculate the date with gmtime_r.\n       */\n  \n      time_t t;\n      time(&t);\n  \n      cxxtools::MutexLock lock(mutex);\n  \n      if (lastTime != t)\n      {\n        time_t day = t / (24*60*60);\n        if (day != lastDay)\n        {\n          // Day differs, we calculate new date.\n          gmtime_r(&t, &lastTm);\n          lastDay = day;\n        }\n  \n        lastTm.tm_sec = t % 60;\n        t /= 60;\n        lastTm.tm_min = t % 60;\n        t /= 60;\n        lastTm.tm_hour = t % 24;\n        lastHtdate = htdate(&lastTm);\n        lastTime = t;\n      }\n  \n      // we do a copy of lastHtdate first to make sure we have the lock\n      std::string ret = lastHtdate;\n      return ret;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getMinorVersion",
          "args": [],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "getMinorVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "76-77",
          "snippet": "unsigned short getMinorVersion() const\n        { return minorVersion; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  unsigned short getMinorVersion() const\n          { return minorVersion; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getMajorVersion",
          "args": [],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "getMajorVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "73-74",
          "snippet": "unsigned short getMajorVersion() const\n        { return majorVersion; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  unsigned short getMajorVersion() const\n          { return majorVersion; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n             << ' ' << ret << ' ' << msg"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hsocket.imbue",
          "args": [
            "std::locale::classic()"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::locale::classic",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->socket->rdbuf",
          "args": [],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::send(unsigned ret, const char* msg, bool ready) const\n    {\n      std::string body = impl->outstream.str();\n  \n      std::ostream hsocket(impl->socket->rdbuf());\n      hsocket.imbue(std::locale::classic());\n  \n      // send header\n  \n      if (impl->sendStatusLine)\n      {\n        log_debug(\"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n               << ' ' << ret << ' ' << msg);\n        hsocket << \"HTTP/\" << getMajorVersion() << '.' << getMinorVersion()\n                << ' ' << ret << ' ' << msg << \"\\r\\n\";\n      }\n  \n      if (!hasHeader(httpheader::date))\n      {\n        std::string current = htdateCurrent();\n        log_debug(httpheader::date << ' ' << current);\n        hsocket << httpheader::date << ' ' << current << \"\\r\\n\";\n      }\n  \n      if (!TntConfig::it().server.empty()\n        && TntConfig::it().hasServer\n        && !hasHeader(httpheader::server))\n      {\n        log_debug(httpheader::server << ' ' << TntConfig::it().server);\n        hsocket << httpheader::server << ' ' << TntConfig::it().server << \"\\r\\n\";\n      }\n  \n      if (ready)\n      {\n        if (body.size() >= TntConfig::it().minCompressSize\n          && !hasHeader(httpheader::contentEncoding)\n          && impl->acceptEncoding.accept(\"gzip\")\n          && tryCompress(body))\n        {\n          log_debug(httpheader::contentEncoding << \" gzip\");\n          hsocket << httpheader::contentEncoding << \" gzip\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::contentLength))\n        {\n          log_debug(httpheader::contentLength << ' ' << body.size());\n          hsocket << httpheader::contentLength << ' ' << body.size() << \"\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::contentType))\n        {\n          log_debug(httpheader::contentType << ' ' << TntConfig::it().defaultContentType);\n          hsocket << httpheader::contentType << ' ' << TntConfig::it().defaultContentType << \"\\r\\n\";\n        }\n  \n        if (!hasHeader(httpheader::connection))\n        {\n          if (TntConfig::it().keepAliveTimeout > 0 && getKeepAliveCounter() > 0)\n          {\n            log_debug(httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter());\n            log_debug(httpheader::connection << ' ' << httpheader::connectionKeepAlive);\n            hsocket << httpheader::keepAlive << \" timeout=\" << TntConfig::it().keepAliveTimeout << \", max=\" << getKeepAliveCounter() << \"\\r\\n\"\n                    << httpheader::connection << ' ' << httpheader::connectionKeepAlive << \"\\r\\n\";\n          }\n          else\n          {\n            log_debug(httpheader::connection << ' ' << httpheader::connectionClose);\n            hsocket << httpheader::connection << ' ' << httpheader::connectionClose << \"\\r\\n\";\n          }\n        }\n      }\n  \n      for (header_type::const_iterator it = header.begin();\n           it != header.end(); ++it)\n      {\n        log_debug(it->first << ' ' << it->second);\n        hsocket << it->first << ' ' << it->second << \"\\r\\n\";\n      }\n  \n      if (hasCookies())\n      {\n        log_debug(httpheader::setCookie << ' ' << httpcookies);\n  \n        for (Cookies::cookies_type::const_iterator it = httpcookies.data.begin();\n          it != httpcookies.data.end(); ++it)\n        {\n          hsocket << httpheader::setCookie << ' ';\n          it->second.write(hsocket, it->first);\n          hsocket << \"\\r\\n\";\n        }\n      }\n  \n      hsocket << \"\\r\\n\";\n  \n      // send body\n  \n      if (impl->headRequest)\n        log_debug(\"HEAD-request - empty body\");\n      else\n      {\n        log_debug(\"send \" << body.size() << \" bytes body\");\n        // We send in chunks just to leave to ostream operator from time to time.\n        // There are iostream libraries, which do have a global lock, which\n        // block other iostreams while writing.\n        const unsigned chunkSize = 65536;\n        for (unsigned n = 0; n < body.size(); n += chunkSize)\n          hsocket.write(body.data() + n, std::min(static_cast<unsigned>(body.size() - n), chunkSize));\n      }\n    }\n}"
  },
  {
    "function_name": "postRunCleanup",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "281-284",
    "snippet": "void HttpReply::postRunCleanup()\n  {\n    Impl::pool.clear();\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Impl::pool.clear",
          "args": [],
          "line": 283
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpReply::Impl::Pool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "171-177",
          "snippet": "void HttpReply::Impl::Pool::clear()\n  {\n    cxxtools::MutexLock lock(poolMutex);\n    for (unsigned n = 0; n < pool.size(); ++n)\n      delete pool[n];\n    pool.clear();\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  Impl {\n    Pool {\n      void HttpReply::Impl::Pool::clear()\n        {\n          cxxtools::MutexLock lock(poolMutex);\n          for (unsigned n = 0; n < pool.size(); ++n)\n            delete pool[n];\n          pool.clear();\n        }\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::postRunCleanup()\n    {\n      Impl::pool.clear();\n    }\n}"
  },
  {
    "function_name": "tryCompress",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "262-279",
    "snippet": "bool HttpReply::tryCompress(std::string& body)\n  {\n    log_debug(\"gzip\");\n\n    std::string cbody = doCompress(body);\n\n    std::string::size_type oldSize = body.size();\n    // only send compressed data, if the data is compressed more than 1/8th\n    if (oldSize - (oldSize >> 3) > cbody.size())\n    {\n      body = cbody;\n      log_info(\"gzip body \" << oldSize << \" bytes to \" << body.size() << \" bytes\");\n\n      return true;\n    }\n\n    return false;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"gzip body \" << oldSize << \" bytes to \" << body.size() << \" bytes\""
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "body.size",
          "args": [],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "doCompress",
          "args": [
            "body"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "doCompress",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "56-84",
          "snippet": "std::string doCompress(const std::string& body)\n    {\n      std::string ret;\n\n      std::ostringstream b;\n      char f[] = \"\\x1f\\x8b\\x08\\x00\"\n           \"\\x00\\x00\\x00\\x00\"\n           \"\\x04\\x03\";\n      b.write(f, sizeof(f) - 1);\n\n      DeflateStream deflator(b);\n      deflator.write(body.data(), body.size());\n      deflator.end();\n\n      uLong crc = crc32(0, reinterpret_cast<const Bytef*>(body.data()), body.size());\n      uint32_t u = crc;\n      b.put(static_cast<char>(u & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n\n      u = body.size();\n      b.put(static_cast<char>(u & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n\n      return b.str();\n    }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nstd::string doCompress(const std::string& body)\n    {\n      std::string ret;\n\n      std::ostringstream b;\n      char f[] = \"\\x1f\\x8b\\x08\\x00\"\n           \"\\x00\\x00\\x00\\x00\"\n           \"\\x04\\x03\";\n      b.write(f, sizeof(f) - 1);\n\n      DeflateStream deflator(b);\n      deflator.write(body.data(), body.size());\n      deflator.end();\n\n      uLong crc = crc32(0, reinterpret_cast<const Bytef*>(body.data()), body.size());\n      uint32_t u = crc;\n      b.put(static_cast<char>(u & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n\n      u = body.size();\n      b.put(static_cast<char>(u & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n\n      return b.str();\n    }"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gzip\""
          ],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::tryCompress(std::string& body)\n    {\n      log_debug(\"gzip\");\n  \n      std::string cbody = doCompress(body);\n  \n      std::string::size_type oldSize = body.size();\n      // only send compressed data, if the data is compressed more than 1/8th\n      if (oldSize - (oldSize >> 3) > cbody.size())\n      {\n        body = cbody;\n        log_info(\"gzip body \" << oldSize << \" bytes to \" << body.size() << \" bytes\");\n  \n        return true;\n      }\n  \n      return false;\n    }\n}"
  },
  {
    "function_name": "setAcceptEncoding",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "257-260",
    "snippet": "void HttpReply::setAcceptEncoding(const Encoding& enc)\n  {\n    impl->acceptEncoding = enc;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setAcceptEncoding(const Encoding& enc)\n    {\n      impl->acceptEncoding = enc;\n    }\n}"
  },
  {
    "function_name": "getKeepAliveCounter",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "252-255",
    "snippet": "unsigned HttpReply::getKeepAliveCounter() const\n  {\n    return impl->keepAliveCounter;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  unsigned HttpReply::getKeepAliveCounter() const\n    {\n      return impl->keepAliveCounter;\n    }\n}"
  },
  {
    "function_name": "setKeepAliveCounter",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "247-250",
    "snippet": "void HttpReply::setKeepAliveCounter(unsigned c)\n  {\n    impl->keepAliveCounter = c;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setKeepAliveCounter(unsigned c)\n    {\n      impl->keepAliveCounter = c;\n    }\n}"
  },
  {
    "function_name": "getContentSize",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "237-240",
    "snippet": "std::string::size_type HttpReply::getContentSize() const\n  {\n    return impl->outstream.str().size();\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  std::string::size_type HttpReply::getContentSize() const\n    {\n      return impl->outstream.str().size();\n    }\n}"
  },
  {
    "function_name": "isDirectMode",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "232-235",
    "snippet": "bool HttpReply::isDirectMode() const\n  {\n    return current_outstream == impl->socket;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::isDirectMode() const\n    {\n      return current_outstream == impl->socket;\n    }\n}"
  },
  {
    "function_name": "rollbackContent",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "226-230",
    "snippet": "void HttpReply::rollbackContent(unsigned size)\n  {\n    impl->outstream.str( impl->outstream.str().substr(0, size) );\n    impl->outstream.seekp(size);\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl->outstream.seekp",
          "args": [
            "size"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [
            "impl->outstream.str().substr(0, size)"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [
            "0",
            "size"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::rollbackContent(unsigned size)\n    {\n      impl->outstream.str( impl->outstream.str().substr(0, size) );\n      impl->outstream.seekp(size);\n    }\n}"
  },
  {
    "function_name": "resetContent",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "221-224",
    "snippet": "void HttpReply::resetContent()\n  {\n    impl->outstream.str(std::string());\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl->outstream.str",
          "args": [
            "std::string()"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::resetContent()\n    {\n      impl->outstream.str(std::string());\n    }\n}"
  },
  {
    "function_name": "isClearSession",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "216-219",
    "snippet": "bool HttpReply::isClearSession() const\n  {\n    return impl->clearSession;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::isClearSession() const\n    {\n      return impl->clearSession;\n    }\n}"
  },
  {
    "function_name": "clearSession",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "211-214",
    "snippet": "void HttpReply::clearSession()\n  {\n    impl->clearSession = true;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::clearSession()\n    {\n      impl->clearSession = true;\n    }\n}"
  },
  {
    "function_name": "setHeadRequest",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "206-209",
    "snippet": "void HttpReply::setHeadRequest(bool sw)\n  {\n    impl->headRequest = sw;\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setHeadRequest(bool sw)\n    {\n      impl->headRequest = sw;\n    }\n}"
  },
  {
    "function_name": "~HttpReply",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "201-204",
    "snippet": "HttpReply::~HttpReply()\n  {\n    Impl::pool.releaseInstance(impl);\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Impl::pool.releaseInstance",
          "args": [
            "impl"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "releaseInstance",
          "container": "HttpReply::Impl::Pool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "154-169",
          "snippet": "void HttpReply::Impl::Pool::releaseInstance(Impl* inst)\n  {\n    cxxtools::MutexLock lock(poolMutex);\n    if (pool.size() < 64)\n    {\n      inst->outstream.clear();\n      inst->outstream.str(std::string());\n      inst->safe_outstream.clear();\n      inst->url_outstream.clear();\n      pool.push_back(inst);\n    }\n    else\n    {\n      delete inst;\n    }\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  Impl {\n    Pool {\n      void HttpReply::Impl::Pool::releaseInstance(Impl* inst)\n        {\n          cxxtools::MutexLock lock(poolMutex);\n          if (pool.size() < 64)\n          {\n            inst->outstream.clear();\n            inst->outstream.str(std::string());\n            inst->safe_outstream.clear();\n            inst->url_outstream.clear();\n            pool.push_back(inst);\n          }\n          else\n          {\n            delete inst;\n          }\n        }\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  HttpReply::~HttpReply()\n    {\n      Impl::pool.releaseInstance(impl);\n    }\n}"
  },
  {
    "function_name": "HttpReply",
    "container": "HttpReply",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "193-199",
    "snippet": "HttpReply::HttpReply(std::ostream& s, bool sendStatusLine_)\n    : impl(Impl::pool.getInstance(s, sendStatusLine_)),\n      current_outstream(&impl->outstream),\n      safe_outstream(&impl->safe_outstream),\n      url_outstream(&impl->url_outstream)\n  {\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Impl::pool.getInstance",
          "args": [
            "s",
            "sendStatusLine_"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  HttpReply::HttpReply(std::ostream& s, bool sendStatusLine_)\n      : impl(Impl::pool.getInstance(s, sendStatusLine_)),\n        current_outstream(&impl->outstream),\n        safe_outstream(&impl->safe_outstream),\n        url_outstream(&impl->url_outstream)\n    {\n    }\n}"
  },
  {
    "function_name": "Impl",
    "container": "HttpReply::Impl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "179-188",
    "snippet": "HttpReply::Impl::Impl(std::ostream& s, bool sendStatusLine_)\n    : socket(&s),\n      safe_outstream(outstream),\n      url_outstream(outstream),\n      keepAliveCounter(0),\n      sendStatusLine(sendStatusLine_),\n      headRequest(false),\n      clearSession(false)\n  {\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  Impl {\n    HttpReply::Impl::Impl(std::ostream& s, bool sendStatusLine_)\n        : socket(&s),\n          safe_outstream(outstream),\n          url_outstream(outstream),\n          keepAliveCounter(0),\n          sendStatusLine(sendStatusLine_),\n          headRequest(false),\n          clearSession(false)\n      {\n      }\n  }\n}"
  },
  {
    "function_name": "clear",
    "container": "HttpReply::Impl::Pool",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "171-177",
    "snippet": "void HttpReply::Impl::Pool::clear()\n  {\n    cxxtools::MutexLock lock(poolMutex);\n    for (unsigned n = 0; n < pool.size(); ++n)\n      delete pool[n];\n    pool.clear();\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pool.clear",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpReply::Impl::Pool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "171-177",
          "snippet": "void HttpReply::Impl::Pool::clear()\n  {\n    cxxtools::MutexLock lock(poolMutex);\n    for (unsigned n = 0; n < pool.size(); ++n)\n      delete pool[n];\n    pool.clear();\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "pool.size",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  Impl {\n    Pool {\n      void HttpReply::Impl::Pool::clear()\n        {\n          cxxtools::MutexLock lock(poolMutex);\n          for (unsigned n = 0; n < pool.size(); ++n)\n            delete pool[n];\n          pool.clear();\n        }\n    }\n  }\n}"
  },
  {
    "function_name": "releaseInstance",
    "container": "HttpReply::Impl::Pool",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "154-169",
    "snippet": "void HttpReply::Impl::Pool::releaseInstance(Impl* inst)\n  {\n    cxxtools::MutexLock lock(poolMutex);\n    if (pool.size() < 64)\n    {\n      inst->outstream.clear();\n      inst->outstream.str(std::string());\n      inst->safe_outstream.clear();\n      inst->url_outstream.clear();\n      pool.push_back(inst);\n    }\n    else\n    {\n      delete inst;\n    }\n  }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pool.push_back",
          "args": [
            "inst"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inst->url_outstream.clear",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpReply::Impl::Pool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "171-177",
          "snippet": "void HttpReply::Impl::Pool::clear()\n  {\n    cxxtools::MutexLock lock(poolMutex);\n    for (unsigned n = 0; n < pool.size(); ++n)\n      delete pool[n];\n    pool.clear();\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  Impl {\n    Pool {\n      void HttpReply::Impl::Pool::clear()\n        {\n          cxxtools::MutexLock lock(poolMutex);\n          for (unsigned n = 0; n < pool.size(); ++n)\n            delete pool[n];\n          pool.clear();\n        }\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "inst->outstream.str",
          "args": [
            "std::string()"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pool.size",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  Impl {\n    Pool {\n      void HttpReply::Impl::Pool::releaseInstance(Impl* inst)\n        {\n          cxxtools::MutexLock lock(poolMutex);\n          if (pool.size() < 64)\n          {\n            inst->outstream.clear();\n            inst->outstream.str(std::string());\n            inst->safe_outstream.clear();\n            inst->url_outstream.clear();\n            pool.push_back(inst);\n          }\n          else\n          {\n            delete inst;\n          }\n        }\n    }\n  }\n}"
  },
  {
    "function_name": "doCompress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
    "lines": "56-84",
    "snippet": "std::string doCompress(const std::string& body)\n    {\n      std::string ret;\n\n      std::ostringstream b;\n      char f[] = \"\\x1f\\x8b\\x08\\x00\"\n           \"\\x00\\x00\\x00\\x00\"\n           \"\\x04\\x03\";\n      b.write(f, sizeof(f) - 1);\n\n      DeflateStream deflator(b);\n      deflator.write(body.data(), body.size());\n      deflator.end();\n\n      uLong crc = crc32(0, reinterpret_cast<const Bytef*>(body.data()), body.size());\n      uint32_t u = crc;\n      b.put(static_cast<char>(u & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n\n      u = body.size();\n      b.put(static_cast<char>(u & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n\n      return b.str();\n    }",
    "includes": [
      "#include <netinet/in.h>",
      "#include <zlib.h>",
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/encoding.h>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/htmlescostream.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/deflatestream.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httpreply.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b.str",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.put",
          "args": [
            "static_cast<char>((u >>= 8) & 0xFF)"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "(u >>= 8) & 0xFF"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.put",
          "args": [
            "static_cast<char>((u >>= 8) & 0xFF)"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "(u >>= 8) & 0xFF"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.put",
          "args": [
            "static_cast<char>((u >>= 8) & 0xFF)"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "(u >>= 8) & 0xFF"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.put",
          "args": [
            "static_cast<char>(u & 0xFF)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "u & 0xFF"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "body.size",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b.put",
          "args": [
            "static_cast<char>((u >>= 8) & 0xFF)"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "(u >>= 8) & 0xFF"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.put",
          "args": [
            "static_cast<char>((u >>= 8) & 0xFF)"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "(u >>= 8) & 0xFF"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.put",
          "args": [
            "static_cast<char>((u >>= 8) & 0xFF)"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "(u >>= 8) & 0xFF"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "b.put",
          "args": [
            "static_cast<char>(u & 0xFF)"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "u & 0xFF"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "crc32",
          "args": [
            "0",
            "reinterpret_cast<const Bytef*>(body.data())",
            "body.size()"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<const Bytef*>",
          "args": [
            "body.data()"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "body.data",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deflator.end",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "deflator.write",
          "args": [
            "body.data()",
            "body.size()"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "474-491",
          "snippet": "void Cookie::write(std::ostream& out, const std::string& name) const\n  {\n    // print name (Customer=\"WILE_E_COYOTE\")\n    out << name << '=';\n    UrlEscOstream u(out);\n    u << getValue();\n\n    // print secure-attribute\n    if (secureFlag)\n      out << \"; \" << Cookie::secure;\n\n    // print attributes\n    for (Cookie::attrs_type::const_iterator a = attrs.begin();\n         a != attrs.end(); ++a)\n      out << \"; \" << a->first << '=' << a->second;\n    if (attrs.find(Cookie::version) == attrs.end())\n      out << \";Version=1\";\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookie {\n  void Cookie::write(std::ostream& out, const std::string& name) const\n    {\n      // print name (Customer=\"WILE_E_COYOTE\")\n      out << name << '=';\n      UrlEscOstream u(out);\n      u << getValue();\n  \n      // print secure-attribute\n      if (secureFlag)\n        out << \"; \" << Cookie::secure;\n  \n      // print attributes\n      for (Cookie::attrs_type::const_iterator a = attrs.begin();\n           a != attrs.end(); ++a)\n        out << \"; \" << a->first << '=' << a->second;\n      if (attrs.find(Cookie::version) == attrs.end())\n        out << \";Version=1\";\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "body.data",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nstd::string doCompress(const std::string& body)\n    {\n      std::string ret;\n\n      std::ostringstream b;\n      char f[] = \"\\x1f\\x8b\\x08\\x00\"\n           \"\\x00\\x00\\x00\\x00\"\n           \"\\x04\\x03\";\n      b.write(f, sizeof(f) - 1);\n\n      DeflateStream deflator(b);\n      deflator.write(body.data(), body.size());\n      deflator.end();\n\n      uLong crc = crc32(0, reinterpret_cast<const Bytef*>(body.data()), body.size());\n      uint32_t u = crc;\n      b.put(static_cast<char>(u & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n\n      u = body.size();\n      b.put(static_cast<char>(u & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n      b.put(static_cast<char>((u >>= 8) & 0xFF));\n\n      return b.str();\n    }"
  }
]