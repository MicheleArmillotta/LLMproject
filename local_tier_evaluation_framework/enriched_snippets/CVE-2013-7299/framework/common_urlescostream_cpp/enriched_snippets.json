[
  {
    "function_name": "urlEscape",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/urlescostream.cpp",
    "lines": "61-67",
    "snippet": "std::string urlEscape(const std::string& str)\n  {\n    std::ostringstream s;\n    UrlEscOstream e(s);\n    e << str;\n    return s.str();\n  }",
    "includes": [
      "#include <sstream>",
      "#include \"tnt/urlescostream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s.str",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sstream>\n#include \"tnt/urlescostream.h\"\n\nstd::string urlEscape(const std::string& str)\n  {\n    std::ostringstream s;\n    UrlEscOstream e(s);\n    e << str;\n    return s.str();\n  }"
  },
  {
    "function_name": "sync",
    "container": "UrlEscStreamBuf",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/urlescostream.cpp",
    "lines": "56-59",
    "snippet": "int UrlEscStreamBuf::sync()\n  {\n    return sink->pubsync();\n  }",
    "includes": [
      "#include <sstream>",
      "#include \"tnt/urlescostream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sink->pubsync",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sstream>\n#include \"tnt/urlescostream.h\"\n\nUrlEscStreamBuf {\n  int UrlEscStreamBuf::sync()\n    {\n      return sink->pubsync();\n    }\n}"
  },
  {
    "function_name": "underflow",
    "container": "UrlEscStreamBuf",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/urlescostream.cpp",
    "lines": "51-54",
    "snippet": "std::streambuf::int_type UrlEscStreamBuf::underflow()\n  {\n    return traits_type::eof();\n  }",
    "includes": [
      "#include <sstream>",
      "#include \"tnt/urlescostream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sstream>\n#include \"tnt/urlescostream.h\"\n\nUrlEscStreamBuf {\n  std::streambuf::int_type UrlEscStreamBuf::underflow()\n    {\n      return traits_type::eof();\n    }\n}"
  },
  {
    "function_name": "overflow",
    "container": "UrlEscStreamBuf",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/urlescostream.cpp",
    "lines": "35-49",
    "snippet": "std::streambuf::int_type UrlEscStreamBuf::overflow(std::streambuf::int_type ch)\n  {\n    static char hex[] = \"0123456789ABCDEF\";\n    if (ch > 32 && ch < 127 && ch != '%' && ch != '+' && ch != '=' && ch != '&')\n      sink->sputc(ch);\n    else if (ch == ' ')\n      sink->sputc('+');\n    else\n    {\n      sink->sputc('%');\n      sink->sputc(hex[(ch >> 4) & 0x0f]);\n      sink->sputc(hex[ch & 0x0f]);\n    }\n    return 0;\n  }",
    "includes": [
      "#include <sstream>",
      "#include \"tnt/urlescostream.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sink->sputc",
          "args": [
            "hex[ch & 0x0f]"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sink->sputc",
          "args": [
            "hex[(ch >> 4) & 0x0f]"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sink->sputc",
          "args": [
            "'%'"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sink->sputc",
          "args": [
            "'+'"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sink->sputc",
          "args": [
            "ch"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <sstream>\n#include \"tnt/urlescostream.h\"\n\nUrlEscStreamBuf {\n  std::streambuf::int_type UrlEscStreamBuf::overflow(std::streambuf::int_type ch)\n    {\n      static char hex[] = \"0123456789ABCDEF\";\n      if (ch > 32 && ch < 127 && ch != '%' && ch != '+' && ch != '=' && ch != '&')\n        sink->sputc(ch);\n      else if (ch == ' ')\n        sink->sputc('+');\n      else\n      {\n        sink->sputc('%');\n        sink->sputc(hex[(ch >> 4) & 0x0f]);\n        sink->sputc(hex[ch & 0x0f]);\n      }\n      return 0;\n    }\n}"
  }
]