[
  {
    "function_name": "Savepoint::rollback",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/savepoint.cpp",
    "lines": "51-61",
    "snippet": "void Savepoint::rollback()\n  {\n    if (active)\n    {\n      log_debug(\"rollback to Savepoint \" << pos);\n      reply.rollbackContent(pos);\n      active = false;\n    }\n    else\n      log_error(\"not rolling back not active Savepoint\");\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/savepoint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_error",
          "args": [
            "\"not rolling back not active Savepoint\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.rollbackContent",
          "args": [
            "pos"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"rollback to Savepoint \" << pos"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/savepoint.h>\n\nvoid Savepoint::rollback()\n  {\n    if (active)\n    {\n      log_debug(\"rollback to Savepoint \" << pos);\n      reply.rollbackContent(pos);\n      active = false;\n    }\n    else\n      log_error(\"not rolling back not active Savepoint\");\n  }"
  },
  {
    "function_name": "Savepoint::commit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/savepoint.cpp",
    "lines": "45-49",
    "snippet": "void Savepoint::commit()\n  {\n    log_debug(\"commit Savepoint \" << pos);\n    active = false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/savepoint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"commit Savepoint \" << pos"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/savepoint.h>\n\nvoid Savepoint::commit()\n  {\n    log_debug(\"commit Savepoint \" << pos);\n    active = false;\n  }"
  },
  {
    "function_name": "Savepoint::save",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/savepoint.cpp",
    "lines": "37-43",
    "snippet": "void Savepoint::save()\n  {\n    pos = reply.getContentSize();\n    active = true;\n\n    log_debug(\"set Savepoint \" << pos);\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/savepoint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"set Savepoint \" << pos"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.getContentSize",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "getContentSize",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "240-241",
          "snippet": "size_t getContentSize() const\n        { return contentSize; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  size_t getContentSize() const\n          { return contentSize; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/savepoint.h>\n\nvoid Savepoint::save()\n  {\n    pos = reply.getContentSize();\n    active = true;\n\n    log_debug(\"set Savepoint \" << pos);\n  }"
  }
]