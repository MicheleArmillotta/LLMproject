[
  {
    "function_name": "rollback",
    "container": "Savepoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/savepoint.cpp",
    "lines": "51-61",
    "snippet": "void Savepoint::rollback()\n  {\n    if (active)\n    {\n      log_debug(\"rollback to Savepoint \" << pos);\n      reply.rollbackContent(pos);\n      active = false;\n    }\n    else\n      log_error(\"not rolling back not active Savepoint\");\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/savepoint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_error",
          "args": [
            "\"not rolling back not active Savepoint\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.rollbackContent",
          "args": [
            "pos"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "rollbackContent",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "226-230",
          "snippet": "void HttpReply::rollbackContent(unsigned size)\n  {\n    impl->outstream.str( impl->outstream.str().substr(0, size) );\n    impl->outstream.seekp(size);\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::rollbackContent(unsigned size)\n    {\n      impl->outstream.str( impl->outstream.str().substr(0, size) );\n      impl->outstream.seekp(size);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"rollback to Savepoint \" << pos"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/savepoint.h>\n\nSavepoint {\n  void Savepoint::rollback()\n    {\n      if (active)\n      {\n        log_debug(\"rollback to Savepoint \" << pos);\n        reply.rollbackContent(pos);\n        active = false;\n      }\n      else\n        log_error(\"not rolling back not active Savepoint\");\n    }\n}"
  },
  {
    "function_name": "commit",
    "container": "Savepoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/savepoint.cpp",
    "lines": "45-49",
    "snippet": "void Savepoint::commit()\n  {\n    log_debug(\"commit Savepoint \" << pos);\n    active = false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/savepoint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"commit Savepoint \" << pos"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/savepoint.h>\n\nSavepoint {\n  void Savepoint::commit()\n    {\n      log_debug(\"commit Savepoint \" << pos);\n      active = false;\n    }\n}"
  },
  {
    "function_name": "save",
    "container": "Savepoint",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/savepoint.cpp",
    "lines": "37-43",
    "snippet": "void Savepoint::save()\n  {\n    pos = reply.getContentSize();\n    active = true;\n\n    log_debug(\"set Savepoint \" << pos);\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/savepoint.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"set Savepoint \" << pos"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.getContentSize",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "getContentSize",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "237-240",
          "snippet": "std::string::size_type HttpReply::getContentSize() const\n  {\n    return impl->outstream.str().size();\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  std::string::size_type HttpReply::getContentSize() const\n    {\n      return impl->outstream.str().size();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/savepoint.h>\n\nSavepoint {\n  void Savepoint::save()\n    {\n      pos = reply.getContentSize();\n      active = true;\n  \n      log_debug(\"set Savepoint \" << pos);\n    }\n}"
  }
]