[
  {
    "function_name": "doThrow",
    "container": "ConversionError",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/query_params.cpp",
    "lines": "25-47",
    "snippet": "void ConversionError::doThrow(const std::string& argname, unsigned argnum, const char* typeto, const std::string& value)\n  {\n    std::ostringstream msg;\n\n    msg << \"Cannot convert \\\"'\" << value << '\"';\n\n    if (typeto)\n      msg << \" to <\" << typeto << '>';\n\n    if (!argname.empty())\n    {\n      msg << \" for argument \\\"\" << argname;\n      if (argnum > 0)\n        msg << '[' << argnum << ']';\n      msg << '\"';\n    }\n    else if (argnum > 0)\n    {\n      msg << \" for argument \" << argnum;\n    }\n\n    throw ConversionError(msg.str());\n  }",
    "includes": [
      "#include <sstream>",
      "#include <tnt/query_params.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ConversionError",
          "args": [
            "msg.str()"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "ConversionError",
          "container": "ConversionError",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/query_params.h",
          "lines": "47-49",
          "snippet": "explicit ConversionError(const std::string& msg)\n        : std::runtime_error(msg)\n      { }",
          "includes": [
            "#include <vector>",
            "#include <sstream>",
            "#include <stdexcept>",
            "#include <locale>",
            "#include <tnt/scope.h>",
            "#include <cxxtools/query_params.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <sstream>\n#include <stdexcept>\n#include <locale>\n#include <tnt/scope.h>\n#include <cxxtools/query_params.h>\n\nConversionError {\n  explicit ConversionError(const std::string& msg)\n          : std::runtime_error(msg)\n        { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "msg.str",
          "args": [],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "argname.empty",
          "args": [],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <sstream>\n#include <tnt/query_params.h>\n\nConversionError {\n  void ConversionError::doThrow(const std::string& argname, unsigned argnum, const char* typeto, const std::string& value)\n    {\n      std::ostringstream msg;\n  \n      msg << \"Cannot convert \\\"'\" << value << '\"';\n  \n      if (typeto)\n        msg << \" to <\" << typeto << '>';\n  \n      if (!argname.empty())\n      {\n        msg << \" for argument \\\"\" << argname;\n        if (argnum > 0)\n          msg << '[' << argnum << ']';\n        msg << '\"';\n      }\n      else if (argnum > 0)\n      {\n        msg << \" for argument \" << argnum;\n      }\n  \n      throw ConversionError(msg.str());\n    }\n}"
  }
]