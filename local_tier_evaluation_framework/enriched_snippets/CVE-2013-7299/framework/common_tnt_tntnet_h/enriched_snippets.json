[
  {
    "function_name": "setAccessLog",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "181-182",
    "snippet": "void setAccessLog(const std::string& accesslog)\n      { accessLog.open(accesslog.c_str(), std::ios::out | std::ios::app); }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "accessLog.open",
          "args": [
            "accesslog.c_str()",
            "std::ios::out | std::ios::app"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "accesslog.c_str",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  void setAccessLog(const std::string& accesslog)\n        { accessLog.open(accesslog.c_str(), std::ios::out | std::ios::app); }\n}"
  },
  {
    "function_name": "setAppName",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "176-177",
    "snippet": "void setAppName(const std::string& appname_)\n        { appname = appname_; }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  void setAppName(const std::string& appname_)\n          { appname = appname_; }\n}"
  },
  {
    "function_name": "mapUrl",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "152-157",
    "snippet": "void mapUrl(const std::string& url, const std::string& pathinfo, const std::string& ci_)\n      {\n        Maptarget ci(ci_);\n        ci.setPathInfo(pathinfo);\n        dispatcher.addUrlMapEntry(std::string(), url, ci);\n      }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dispatcher.addUrlMapEntry",
          "args": [
            "std::string()",
            "url",
            "ci"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci.setPathInfo",
          "args": [
            "pathinfo"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "setPathInfo",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "153-153",
          "snippet": "void setPathInfo(const std::string& p)       { pathinfo = p; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setPathInfo(const std::string& p)       { pathinfo = p; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  void mapUrl(const std::string& url, const std::string& pathinfo, const std::string& ci_)\n        {\n          Maptarget ci(ci_);\n          ci.setPathInfo(pathinfo);\n          dispatcher.addUrlMapEntry(std::string(), url, ci);\n        }\n}"
  },
  {
    "function_name": "setMaxThreads",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "145-145",
    "snippet": "void setMaxThreads(unsigned n)          { maxthreads = n; }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  void setMaxThreads(unsigned n)          { maxthreads = n; }\n}"
  },
  {
    "function_name": "getMaxThreads",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "143-143",
    "snippet": "unsigned getMaxThreads() const          { return maxthreads; }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  unsigned getMaxThreads() const          { return maxthreads; }\n}"
  },
  {
    "function_name": "getMinThreads",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "138-138",
    "snippet": "unsigned getMinThreads() const          { return minthreads; }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  unsigned getMinThreads() const          { return minthreads; }\n}"
  },
  {
    "function_name": "shouldStop",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "126-126",
    "snippet": "static bool shouldStop()   { return stop; }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  static bool shouldStop()   { return stop; }\n}"
  },
  {
    "function_name": "sslListen",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "113-114",
    "snippet": "void sslListen(const std::string& certificateFile, const std::string& keyFile, unsigned short int port)\n      { sslListen(certificateFile, keyFile, std::string(), port); }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sslListen",
          "args": [
            "certificateFile",
            "keyFile",
            "std::string()",
            "port"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "sslListen",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
          "lines": "158-169",
          "snippet": "void Tntnet::sslListen(const std::string& certificateFile, const std::string& keyFile, const std::string& ip, unsigned short int port)\n  {\n#ifdef USE_SSL\n    log_debug(\"listen on ip \" << ip << \" port \" << port << \" (ssl)\");\n    ListenerBase* listener = new Ssllistener(*this, certificateFile.c_str(),\n        keyFile.c_str(), ip, port, queue);\n    listeners.insert(listener);\n    allListeners.insert(listener);\n#else\n    log_error(\"cannot add ssl listener - ssl is not compiled into tntnet\");\n#endif // USE_SSL\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  void sslListen(const std::string& certificateFile, const std::string& keyFile, unsigned short int port)\n        { sslListen(certificateFile, keyFile, std::string(), port); }\n}"
  },
  {
    "function_name": "listen",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
    "lines": "105-106",
    "snippet": "void listen(unsigned short int port)\n      { listen(std::string(), port); }",
    "includes": [
      "#include <fstream>",
      "#include <set>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/condition.h>",
      "#include <tnt/scopemanager.h>",
      "#include <tnt/maptarget.h>",
      "#include <tnt/dispatcher.h>",
      "#include <tnt/poller.h>",
      "#include <tnt/job.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "listen",
          "args": [
            "std::string()",
            "port"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "listen",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
          "lines": "150-156",
          "snippet": "void Tntnet::listen(const std::string& ip, unsigned short int port)\n  {\n    log_debug(\"listen on ip \" << ip << \" port \" << port);\n    ListenerBase* listener = new Listener(*this, ip, port, queue);\n    listeners.insert(listener);\n    allListeners.insert(listener);\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  void listen(unsigned short int port)\n        { listen(std::string(), port); }\n}"
  }
]