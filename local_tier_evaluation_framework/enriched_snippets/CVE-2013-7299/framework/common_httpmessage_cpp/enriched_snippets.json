[
  {
    "function_name": "HttpMessage::checkUrl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "175-207",
    "snippet": "bool HttpMessage::checkUrl(const std::string& url)\n  {\n    unsigned level = 0;\n    const char* p = url.data();\n    const char* e = p + url.size();\n    Pstr str(p, p);\n    for (; p != e; ++p)\n    {\n      if (*p == '/')\n      {\n        str.setEnd(p);\n        if (!str.empty())\n        {\n          if (str == \".\")\n            ;\n          else if (str == \"..\")\n          {\n            if (level == 0)\n              return false;\n            --level;\n          }\n          else\n            ++level;\n        }\n        str.setStart(p + 1);\n      }\n    }\n\n    if (level == 0 && (str.setEnd(p), str == \"..\"))\n      return false;\n\n    return true;\n  }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "str.setEnd",
          "args": [
            "p"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "setEnd",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "150-153",
          "snippet": "void setEnd(const char* e)\n        {\n          end = e;\n        }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  void setEnd(const char* e)\n          {\n            end = e;\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.setStart",
          "args": [
            "p + 1"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "setStart",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "145-148",
          "snippet": "void setStart(const char* s)\n        {\n          start = s;\n        }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  void setStart(const char* s)\n          {\n            start = s;\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.empty",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "url.size",
          "args": [],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "url.data",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nbool HttpMessage::checkUrl(const std::string& url)\n  {\n    unsigned level = 0;\n    const char* p = url.data();\n    const char* e = p + url.size();\n    Pstr str(p, p);\n    for (; p != e; ++p)\n    {\n      if (*p == '/')\n      {\n        str.setEnd(p);\n        if (!str.empty())\n        {\n          if (str == \".\")\n            ;\n          else if (str == \"..\")\n          {\n            if (level == 0)\n              return false;\n            --level;\n          }\n          else\n            ++level;\n        }\n        str.setStart(p + 1);\n      }\n    }\n\n    if (level == 0 && (str.setEnd(p), str == \"..\"))\n      return false;\n\n    return true;\n  }"
  },
  {
    "function_name": "empty",
    "container": "Pstr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "156-156",
    "snippet": "bool empty() const      { return start == end; }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
  },
  {
    "function_name": "size",
    "container": "Pstr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "155-155",
    "snippet": "size_type size() const  { return end - start; }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
  },
  {
    "function_name": "setEnd",
    "container": "Pstr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "150-153",
    "snippet": "void setEnd(const char* e)\n        {\n          end = e;\n        }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  void setEnd(const char* e)\n          {\n            end = e;\n          }\n}"
  },
  {
    "function_name": "setStart",
    "container": "Pstr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "145-148",
    "snippet": "void setStart(const char* s)\n        {\n          start = s;\n        }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  void setStart(const char* s)\n          {\n            start = s;\n          }\n}"
  },
  {
    "function_name": "Pstr",
    "container": "Pstr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "141-143",
    "snippet": "Pstr(const char* s, const char* e)\n          : start(s), end(e)\n          { }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  Pstr(const char* s, const char* e)\n            : start(s), end(e)\n            { }\n}"
  },
  {
    "function_name": "HttpMessage::htdateCurrent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "89-129",
    "snippet": "std::string HttpMessage::htdateCurrent()\n  {\n    static struct ::tm lastTm;\n    static time_t lastDay = 0;\n    static time_t lastTime = 0;\n    static std::string lastHtdate;\n    static cxxtools::Mutex mutex;\n\n    /*\n     * we cache the last split tm-struct here, because it is pretty expensive\n     * to calculate the date with gmtime_r.\n     */\n\n    time_t t;\n    time(&t);\n\n    cxxtools::MutexLock lock(mutex);\n\n    if (lastTime != t)\n    {\n      time_t day = t / (24*60*60);\n      if (day != lastDay)\n      {\n        // Day differs, we calculate new date.\n        gmtime_r(&t, &lastTm);\n        lastDay = day;\n      }\n\n      lastTm.tm_sec = t % 60;\n      t /= 60;\n      lastTm.tm_min = t % 60;\n      t /= 60;\n      lastTm.tm_hour = t % 24;\n      lastHtdate = htdate(&lastTm);\n      lastTime = t;\n    }\n\n    // we do a copy of lastHtdate first to make sure we have the lock\n    std::string ret = lastHtdate;\n    return ret;\n  }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "htdate",
          "args": [
            "&lastTm"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "HttpMessage::htdate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "76-87",
          "snippet": "std::string HttpMessage::htdate(struct ::tm* tm)\n  {\n    static const char* wday[] = {\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"};\n    static const char* monthn[] = {\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                            \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"};\n    char buffer[80];\n\n    sprintf(buffer, \"%s, %02d %s %d %02d:%02d:%02d GMT\",\n      wday[tm->tm_wday], tm->tm_mday, monthn[tm->tm_mon], tm->tm_year + 1900,\n      tm->tm_hour, tm->tm_min, tm->tm_sec);\n    return buffer;\n  }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nstd::string HttpMessage::htdate(struct ::tm* tm)\n  {\n    static const char* wday[] = {\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"};\n    static const char* monthn[] = {\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                            \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"};\n    char buffer[80];\n\n    sprintf(buffer, \"%s, %02d %s %d %02d:%02d:%02d GMT\",\n      wday[tm->tm_wday], tm->tm_mday, monthn[tm->tm_mon], tm->tm_year + 1900,\n      tm->tm_hour, tm->tm_min, tm->tm_sec);\n    return buffer;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "gmtime_r",
          "args": [
            "&t",
            "&lastTm"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&t"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nstd::string HttpMessage::htdateCurrent()\n  {\n    static struct ::tm lastTm;\n    static time_t lastDay = 0;\n    static time_t lastTime = 0;\n    static std::string lastHtdate;\n    static cxxtools::Mutex mutex;\n\n    /*\n     * we cache the last split tm-struct here, because it is pretty expensive\n     * to calculate the date with gmtime_r.\n     */\n\n    time_t t;\n    time(&t);\n\n    cxxtools::MutexLock lock(mutex);\n\n    if (lastTime != t)\n    {\n      time_t day = t / (24*60*60);\n      if (day != lastDay)\n      {\n        // Day differs, we calculate new date.\n        gmtime_r(&t, &lastTm);\n        lastDay = day;\n      }\n\n      lastTm.tm_sec = t % 60;\n      t /= 60;\n      lastTm.tm_min = t % 60;\n      t /= 60;\n      lastTm.tm_hour = t % 24;\n      lastHtdate = htdate(&lastTm);\n      lastTime = t;\n    }\n\n    // we do a copy of lastHtdate first to make sure we have the lock\n    std::string ret = lastHtdate;\n    return ret;\n  }"
  },
  {
    "function_name": "HttpMessage::htdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "76-87",
    "snippet": "std::string HttpMessage::htdate(struct ::tm* tm)\n  {\n    static const char* wday[] = {\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"};\n    static const char* monthn[] = {\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                            \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"};\n    char buffer[80];\n\n    sprintf(buffer, \"%s, %02d %s %d %02d:%02d:%02d GMT\",\n      wday[tm->tm_wday], tm->tm_mday, monthn[tm->tm_mon], tm->tm_year + 1900,\n      tm->tm_hour, tm->tm_min, tm->tm_sec);\n    return buffer;\n  }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sprintf",
          "args": [
            "buffer",
            "\"%s, %02d %s %d %02d:%02d:%02d GMT\"",
            "wday[tm->tm_wday]",
            "tm->tm_mday",
            "monthn[tm->tm_mon]",
            "tm->tm_year + 1900",
            "tm->tm_hour",
            "tm->tm_min",
            "tm->tm_sec"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nstd::string HttpMessage::htdate(struct ::tm* tm)\n  {\n    static const char* wday[] = {\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"};\n    static const char* monthn[] = {\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                            \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"};\n    char buffer[80];\n\n    sprintf(buffer, \"%s, %02d %s %d %02d:%02d:%02d GMT\",\n      wday[tm->tm_wday], tm->tm_mday, monthn[tm->tm_mon], tm->tm_year + 1900,\n      tm->tm_hour, tm->tm_min, tm->tm_sec);\n    return buffer;\n  }"
  },
  {
    "function_name": "HttpMessage::htdate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "69-74",
    "snippet": "std::string HttpMessage::htdate(time_t t)\n  {\n    struct ::tm tm;\n    gmtime_r(&t, &tm);\n    return htdate(&tm);\n  }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gmtime_r",
          "args": [
            "&t",
            "&tm"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nstd::string HttpMessage::htdate(time_t t)\n  {\n    struct ::tm tm;\n    gmtime_r(&t, &tm);\n    return htdate(&tm);\n  }"
  },
  {
    "function_name": "HttpMessage::dumpHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "62-67",
    "snippet": "void HttpMessage::dumpHeader(std::ostream& out) const\n  {\n    for (header_type::const_iterator it = header.begin();\n         it != header.end(); ++it)\n      out << it->first << ' ' << it->second << '\\n';\n  }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "header.end",
          "args": [],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "header.begin",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nvoid HttpMessage::dumpHeader(std::ostream& out) const\n  {\n    for (header_type::const_iterator it = header.begin();\n         it != header.end(); ++it)\n      out << it->first << ' ' << it->second << '\\n';\n  }"
  },
  {
    "function_name": "HttpMessage::dumpHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "55-60",
    "snippet": "std::string HttpMessage::dumpHeader() const\n  {\n    std::ostringstream h;\n    dumpHeader(h);\n    return h.str();\n  }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "h.str",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nstd::string HttpMessage::dumpHeader() const\n  {\n    std::ostringstream h;\n    dumpHeader(h);\n    return h.str();\n  }"
  },
  {
    "function_name": "HttpMessage::clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
    "lines": "42-47",
    "snippet": "void HttpMessage::clear()\n  {\n    header.clear();\n    majorVersion = 1;\n    minorVersion = 0;\n  }",
    "includes": [
      "#include <stdio.h>",
      "#include <sstream>",
      "#include <list>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpmessage.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "header.clear",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "Messageheader::clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "92-99",
          "snippet": "void Messageheader::clear()\n  {\n#ifdef DEBUG\n    std::memset(rawdata, '\\xfe', sizeof(rawdata));\n#endif\n    rawdata[0] = rawdata[1] = '\\0';\n    endOffset = 0;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nvoid Messageheader::clear()\n  {\n#ifdef DEBUG\n    std::memset(rawdata, '\\xfe', sizeof(rawdata));\n#endif\n    rawdata[0] = rawdata[1] = '\\0';\n    endOffset = 0;\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nvoid HttpMessage::clear()\n  {\n    header.clear();\n    majorVersion = 1;\n    minorVersion = 0;\n  }"
  }
]