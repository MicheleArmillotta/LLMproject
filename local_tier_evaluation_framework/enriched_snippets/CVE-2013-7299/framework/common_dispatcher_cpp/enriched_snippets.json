[
  {
    "function_name": "Dispatcher::PosType::getNext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/dispatcher.cpp",
    "lines": "213-221",
    "snippet": "Maptarget Dispatcher::PosType::getNext()\n{\n  if (first)\n    first = false;\n  else\n    ++pos;\n\n  return dis.mapCompNext(request, pos);\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <iterator>",
      "#include <functional>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httprequest.h>",
      "#include <tnt/httperror.h>",
      "#include \"tnt/dispatcher.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dis.mapCompNext",
          "args": [
            "request",
            "pos"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <iterator>\n#include <functional>\n#include <tnt/tntconfig.h>\n#include <tnt/httprequest.h>\n#include <tnt/httperror.h>\n#include \"tnt/dispatcher.h\"\n\nMaptarget Dispatcher::PosType::getNext()\n{\n  if (first)\n    first = false;\n  else\n    ++pos;\n\n  return dis.mapCompNext(request, pos);\n}"
  },
  {
    "function_name": "Dispatcher::mapCompNext",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/dispatcher.cpp",
    "lines": "136-211",
    "snippet": "Maptarget Dispatcher::mapCompNext(const HttpRequest& request,\n  Dispatcher::urlmap_type::size_type& pos) const\n{\n  std::string vhost = request.getHost();\n  std::string compUrl = request.getUrl();\n\n  if (pos < urlmap.size())\n  {\n    // check cache\n    cxxtools::ReadLock lock(urlMapCacheMutex, false);\n\n    urlMapCacheType::key_type cacheKey(request, pos);\n    log_debug(\"host=\\\"\" << cacheKey.getHost() << \"\\\" url=\\\"\" << cacheKey.getUrl() << \"\\\" method=\\\"\" << cacheKey.getMethod() << \"\\\" ssl=\" << cacheKey.getSsl() << \" pos=\" << cacheKey.getPos());\n\n    if (TntConfig::it().maxUrlMapCache > 0)\n    {\n      lock.lock();\n      urlMapCacheType::const_iterator um = urlMapCache.find(cacheKey);\n      if (um != urlMapCache.end())\n      {\n        pos = um->second.pos;\n        log_debug(\"match <\" << urlmap[pos] << \"> => \" << um->second.ci << \" (cached)\");\n        return um->second.ci;\n      }\n\n      log_debug(\"entry not found in cache\");\n    }\n    else\n      log_debug(\"cache disabled\");\n\n    // no cache hit\n    regmatch_formatter formatter;\n\n    for (; pos < urlmap.size(); ++pos)\n    {\n      if (urlmap[pos].match(request, formatter.what))\n      {\n        const Maptarget& src = urlmap[pos].getTarget();\n\n        Maptarget ci;\n        ci.libname = formatter(src.libname);\n        ci.compname = formatter(src.compname);\n\n        if (src.hasPathInfo())\n          ci.setPathInfo(formatter(src.getPathInfo()));\n\n        for (Maptarget::args_type::const_iterator it = src.getArgs().begin(); it != src.getArgs().end(); ++it)\n          ci.args[it->first] = formatter(it->second);\n\n        if (TntConfig::it().maxUrlMapCache > 0)\n        {\n          lock.unlock();\n          cxxtools::WriteLock wlock(urlMapCacheMutex);\n\n          // clear cache after maxUrlMapCache distinct requests\n          if (urlMapCache.size() > TntConfig::it().maxUrlMapCache)\n          {\n            log_warn(\"clear url-map-cache\");\n            urlMapCache.clear();\n          }\n\n          urlMapCache.insert(urlMapCacheType::value_type(cacheKey, UrlMapCacheValue(ci, pos)));\n        }\n\n        log_debug(\"match <\" << urlmap[pos] << \"> => \" << ci);\n        return ci;\n      }\n      else\n      {\n        log_debug(\"no match <\" << urlmap[pos] << '>');\n      }\n    }\n  }\n\n  throw NotFoundException(compUrl, vhost);\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <iterator>",
      "#include <functional>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httprequest.h>",
      "#include <tnt/httperror.h>",
      "#include \"tnt/dispatcher.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NotFoundException",
          "args": [
            "compUrl",
            "vhost"
          ],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "NotFoundException::NotFoundException",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "201-206",
          "snippet": "NotFoundException::NotFoundException(const std::string& url_, const std::string& vhost_)\n    : HttpError(HTTP_NOT_FOUND, notFoundMsg(url_, vhost_)),\n      url(url_),\n      vhost(vhost_)\n  {\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nNotFoundException::NotFoundException(const std::string& url_, const std::string& vhost_)\n    : HttpError(HTTP_NOT_FOUND, notFoundMsg(url_, vhost_)),\n      url(url_),\n      vhost(vhost_)\n  {\n  }"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"no match <\" << urlmap[pos] << '>'"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"match <\" << urlmap[pos] << \"> => \" << ci"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urlMapCache.insert",
          "args": [
            "urlMapCacheType::value_type(cacheKey, UrlMapCacheValue(ci, pos))"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urlMapCacheType::value_type",
          "args": [
            "cacheKey",
            "UrlMapCacheValue(ci, pos)"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UrlMapCacheValue",
          "args": [
            "ci",
            "pos"
          ],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "UrlMapCacheValue",
          "container": "Dispatcher::UrlMapCacheValue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/dispatcher.h",
          "lines": "136-139",
          "snippet": "UrlMapCacheValue(const Maptarget& ci_, urlmap_type::size_type pos_)\n          : ci(ci_),\n            pos(pos_)\n          { }",
          "includes": [
            "#include <cxxtools/regex.h>",
            "#include <map>",
            "#include <vector>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/urlmapper.h>",
            "#include <cxxtools/mutex.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/regex.h>\n#include <map>\n#include <vector>\n#include <tnt/tntconfig.h>\n#include <tnt/maptarget.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/mutex.h>\n\nDispatcher {\n  UrlMapCacheValue {\n    UrlMapCacheValue(const Maptarget& ci_, urlmap_type::size_type pos_)\n              : ci(ci_),\n                pos(pos_)\n              { }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "urlMapCache.clear",
          "args": [],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Compident",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/compident.h",
          "lines": "76-77",
          "snippet": "void clear()\n    { libname.clear(); compname.clear(); }",
          "includes": [
            "#include <iostream>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n#include <string>\n\nCompident {\n  void clear()\n      { libname.clear(); compname.clear(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"clear url-map-cache\""
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urlMapCache.size",
          "args": [],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lock.unlock",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "unlock",
          "container": "ApplicationUnlocker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/applicationunlocker.h",
          "lines": "62-66",
          "snippet": "void unlock()\n      {\n        request.releaseApplicationScopeLock();\n        locked = false;\n      }",
          "includes": [
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/httprequest.h>\n\nApplicationUnlocker {\n  void unlock()\n        {\n          request.releaseApplicationScopeLock();\n          locked = false;\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatter",
          "args": [
            "it->second"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.getArgs",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.getArgs",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.getArgs",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.getArgs",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci.setPathInfo",
          "args": [
            "formatter(src.getPathInfo())"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "setPathInfo",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "153-153",
          "snippet": "void setPathInfo(const std::string& p)       { pathinfo = p; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setPathInfo(const std::string& p)       { pathinfo = p; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "formatter",
          "args": [
            "src.getPathInfo()"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.getPathInfo",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.hasPathInfo",
          "args": [],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "hasPathInfo",
          "container": "Maptarget",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/maptarget.h",
          "lines": "66-67",
          "snippet": "bool hasPathInfo() const\n        { return pathinfo_set; }",
          "includes": [
            "#include <string>",
            "#include <map>",
            "#include <tnt/compident.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <map>\n#include <tnt/compident.h>\n\nMaptarget {\n  bool hasPathInfo() const\n          { return pathinfo_set; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "formatter",
          "args": [
            "src.compname"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "formatter",
          "args": [
            "src.libname"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urlmap[pos].getTarget",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urlmap[pos].match",
          "args": [
            "request",
            "formatter.what"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"cache disabled\""
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"entry not found in cache\""
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"match <\" << urlmap[pos] << \"> => \" << um->second.ci << \" (cached)\""
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "urlMapCache.end",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "urlMapCache.find",
          "args": [
            "cacheKey"
          ],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lock.lock",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "lock",
          "container": "ApplicationUnlocker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/applicationunlocker.h",
          "lines": "68-72",
          "snippet": "void lock()\n      {\n        request.ensureApplicationScopeLock();\n        locked = true;\n      }",
          "includes": [
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/httprequest.h>\n\nApplicationUnlocker {\n  void lock()\n        {\n          request.ensureApplicationScopeLock();\n          locked = true;\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"host=\\\"\" << cacheKey.getHost() << \"\\\" url=\\\"\" << cacheKey.getUrl() << \"\\\" method=\\\"\" << cacheKey.getMethod() << \"\\\" ssl=\" << cacheKey.getSsl() << \" pos=\" << cacheKey.getPos()"
          ],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cacheKey.getPos",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "getPos",
          "container": "Dispatcher::UrlMapCacheKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/dispatcher.h",
          "lines": "127-127",
          "snippet": "urlmap_type::size_type getPos() const  { return pos; }",
          "includes": [
            "#include <cxxtools/regex.h>",
            "#include <map>",
            "#include <vector>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/urlmapper.h>",
            "#include <cxxtools/mutex.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/regex.h>\n#include <map>\n#include <vector>\n#include <tnt/tntconfig.h>\n#include <tnt/maptarget.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/mutex.h>\n\nDispatcher {\n  UrlMapCacheKey {\n    urlmap_type::size_type getPos() const  { return pos; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cacheKey.getSsl",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "getSsl",
          "container": "Dispatcher::UrlMapCacheKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/dispatcher.h",
          "lines": "126-126",
          "snippet": "bool getSsl() const  { return ssl; }",
          "includes": [
            "#include <cxxtools/regex.h>",
            "#include <map>",
            "#include <vector>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/urlmapper.h>",
            "#include <cxxtools/mutex.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/regex.h>\n#include <map>\n#include <vector>\n#include <tnt/tntconfig.h>\n#include <tnt/maptarget.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/mutex.h>\n\nDispatcher {\n  UrlMapCacheKey {\n    bool getSsl() const  { return ssl; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cacheKey.getMethod",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "getMethod",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "134-134",
          "snippet": "std::string getMethod() const             { return method; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  std::string getMethod() const             { return method; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cacheKey.getUrl",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cacheKey.getHost",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getUrl",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getHost",
          "args": [],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <iterator>\n#include <functional>\n#include <tnt/tntconfig.h>\n#include <tnt/httprequest.h>\n#include <tnt/httperror.h>\n#include \"tnt/dispatcher.h\"\n\nMaptarget Dispatcher::mapCompNext(const HttpRequest& request,\n  Dispatcher::urlmap_type::size_type& pos) const\n{\n  std::string vhost = request.getHost();\n  std::string compUrl = request.getUrl();\n\n  if (pos < urlmap.size())\n  {\n    // check cache\n    cxxtools::ReadLock lock(urlMapCacheMutex, false);\n\n    urlMapCacheType::key_type cacheKey(request, pos);\n    log_debug(\"host=\\\"\" << cacheKey.getHost() << \"\\\" url=\\\"\" << cacheKey.getUrl() << \"\\\" method=\\\"\" << cacheKey.getMethod() << \"\\\" ssl=\" << cacheKey.getSsl() << \" pos=\" << cacheKey.getPos());\n\n    if (TntConfig::it().maxUrlMapCache > 0)\n    {\n      lock.lock();\n      urlMapCacheType::const_iterator um = urlMapCache.find(cacheKey);\n      if (um != urlMapCache.end())\n      {\n        pos = um->second.pos;\n        log_debug(\"match <\" << urlmap[pos] << \"> => \" << um->second.ci << \" (cached)\");\n        return um->second.ci;\n      }\n\n      log_debug(\"entry not found in cache\");\n    }\n    else\n      log_debug(\"cache disabled\");\n\n    // no cache hit\n    regmatch_formatter formatter;\n\n    for (; pos < urlmap.size(); ++pos)\n    {\n      if (urlmap[pos].match(request, formatter.what))\n      {\n        const Maptarget& src = urlmap[pos].getTarget();\n\n        Maptarget ci;\n        ci.libname = formatter(src.libname);\n        ci.compname = formatter(src.compname);\n\n        if (src.hasPathInfo())\n          ci.setPathInfo(formatter(src.getPathInfo()));\n\n        for (Maptarget::args_type::const_iterator it = src.getArgs().begin(); it != src.getArgs().end(); ++it)\n          ci.args[it->first] = formatter(it->second);\n\n        if (TntConfig::it().maxUrlMapCache > 0)\n        {\n          lock.unlock();\n          cxxtools::WriteLock wlock(urlMapCacheMutex);\n\n          // clear cache after maxUrlMapCache distinct requests\n          if (urlMapCache.size() > TntConfig::it().maxUrlMapCache)\n          {\n            log_warn(\"clear url-map-cache\");\n            urlMapCache.clear();\n          }\n\n          urlMapCache.insert(urlMapCacheType::value_type(cacheKey, UrlMapCacheValue(ci, pos)));\n        }\n\n        log_debug(\"match <\" << urlmap[pos] << \"> => \" << ci);\n        return ci;\n      }\n      else\n      {\n        log_debug(\"no match <\" << urlmap[pos] << '>');\n      }\n    }\n  }\n\n  throw NotFoundException(compUrl, vhost);\n}"
  },
  {
    "function_name": "Dispatcher::UrlMapCacheKey::operator<",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/dispatcher.cpp",
    "lines": "94-114",
    "snippet": "bool Dispatcher::UrlMapCacheKey::operator< (const UrlMapCacheKey& other) const\n{\n  int c;\n\n  c = vhost.compare(other.vhost);\n  if (c != 0)\n    return c < 0;\n\n  c = url.compare(other.url);\n  if (c != 0)\n    return c < 0;\n\n  c = method.compare(other.method);\n  if (c != 0)\n    return c < 0;\n\n  if (ssl != other.ssl)\n    return ssl < other.ssl;\n\n  return pos < other.pos;\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <iterator>",
      "#include <functional>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httprequest.h>",
      "#include <tnt/httperror.h>",
      "#include \"tnt/dispatcher.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "method.compare",
          "args": [
            "other.method"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "url.compare",
          "args": [
            "other.url"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vhost.compare",
          "args": [
            "other.vhost"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <iterator>\n#include <functional>\n#include <tnt/tntconfig.h>\n#include <tnt/httprequest.h>\n#include <tnt/httperror.h>\n#include \"tnt/dispatcher.h\"\n\nbool Dispatcher::UrlMapCacheKey::operator< (const UrlMapCacheKey& other) const\n{\n  int c;\n\n  c = vhost.compare(other.vhost);\n  if (c != 0)\n    return c < 0;\n\n  c = url.compare(other.url);\n  if (c != 0)\n    return c < 0;\n\n  c = method.compare(other.method);\n  if (c != 0)\n    return c < 0;\n\n  if (ssl != other.ssl)\n    return ssl < other.ssl;\n\n  return pos < other.pos;\n}"
  },
  {
    "function_name": "Dispatcher::UrlMapCacheKey::UrlMapCacheKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/dispatcher.cpp",
    "lines": "85-92",
    "snippet": "Dispatcher::UrlMapCacheKey::UrlMapCacheKey(const HttpRequest& request, urlmap_type::size_type pos_)\n  : vhost(request.getHost()),\n    url(request.getUrl()),\n    method(request.getMethod()),\n    ssl(request.isSsl()),\n    pos(pos_)\n{\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <iterator>",
      "#include <functional>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httprequest.h>",
      "#include <tnt/httperror.h>",
      "#include \"tnt/dispatcher.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request.isSsl",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "isSsl",
          "container": "Cmd::NullSocketIf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cmd.h",
          "lines": "60-61",
          "snippet": "bool isSsl() const\n          { return false; }",
          "includes": [
            "#include <tnt/component.h>",
            "#include <tnt/compident.h>",
            "#include <tnt/comploader.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include <tnt/tntnet.h>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/component.h>\n#include <tnt/compident.h>\n#include <tnt/comploader.h>\n#include <tnt/scopemanager.h>\n#include <tnt/scope.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include <tnt/tntnet.h>\n#include <iosfwd>\n\nCmd {\n  NullSocketIf {\n    bool isSsl() const\n              { return false; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.getMethod",
          "args": [],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "getMethod",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "134-134",
          "snippet": "std::string getMethod() const             { return method; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  std::string getMethod() const             { return method; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.getUrl",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getHost",
          "args": [],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <iterator>\n#include <functional>\n#include <tnt/tntconfig.h>\n#include <tnt/httprequest.h>\n#include <tnt/httperror.h>\n#include \"tnt/dispatcher.h\"\n\nDispatcher::UrlMapCacheKey::UrlMapCacheKey(const HttpRequest& request, urlmap_type::size_type pos_)\n  : vhost(request.getHost()),\n    url(request.getUrl()),\n    method(request.getMethod()),\n    ssl(request.isSsl()),\n    pos(pos_)\n{\n}"
  },
  {
    "function_name": "Mapping::match",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/dispatcher.cpp",
    "lines": "75-83",
    "snippet": "bool Mapping::match(const HttpRequest& request, cxxtools::RegexSMatch& smatch) const\n{\n  return (vhost.empty() || r_vhost.match(request.getHost()))\n      && (url.empty() || r_url.match(request.getUrl(), smatch))\n      && (method.empty() || r_method.match(request.getMethod()))\n      && (ssl == SSL_ALL\n          || (ssl == SSL_YES && request.isSsl())\n          || (ssl == SSL_NO && !request.isSsl()));\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <iterator>",
      "#include <functional>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httprequest.h>",
      "#include <tnt/httperror.h>",
      "#include \"tnt/dispatcher.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request.isSsl",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "isSsl",
          "container": "Cmd::NullSocketIf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cmd.h",
          "lines": "60-61",
          "snippet": "bool isSsl() const\n          { return false; }",
          "includes": [
            "#include <tnt/component.h>",
            "#include <tnt/compident.h>",
            "#include <tnt/comploader.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include <tnt/tntnet.h>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/component.h>\n#include <tnt/compident.h>\n#include <tnt/comploader.h>\n#include <tnt/scopemanager.h>\n#include <tnt/scope.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include <tnt/tntnet.h>\n#include <iosfwd>\n\nCmd {\n  NullSocketIf {\n    bool isSsl() const\n              { return false; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r_method.match",
          "args": [
            "request.getMethod()"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getMethod",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "getMethod",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "134-134",
          "snippet": "std::string getMethod() const             { return method; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  std::string getMethod() const             { return method; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "method.empty",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "r_url.match",
          "args": [
            "request.getUrl()",
            "smatch"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getUrl",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r_vhost.match",
          "args": [
            "request.getHost()"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getHost",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <iterator>\n#include <functional>\n#include <tnt/tntconfig.h>\n#include <tnt/httprequest.h>\n#include <tnt/httperror.h>\n#include \"tnt/dispatcher.h\"\n\nbool Mapping::match(const HttpRequest& request, cxxtools::RegexSMatch& smatch) const\n{\n  return (vhost.empty() || r_vhost.match(request.getHost()))\n      && (url.empty() || r_url.match(request.getUrl(), smatch))\n      && (method.empty() || r_method.match(request.getMethod()))\n      && (ssl == SSL_ALL\n          || (ssl == SSL_YES && request.isSsl())\n          || (ssl == SSL_NO && !request.isSsl()));\n}"
  },
  {
    "function_name": "Mapping::Mapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/dispatcher.cpp",
    "lines": "63-73",
    "snippet": "Mapping::Mapping(const std::string& vhost_, const std::string& url_,\n    const std::string& method_, int ssl_, const Maptarget& target_)\n  : vhost(vhost_),\n    url(url_),\n    method(method_),\n    ssl(ssl_),\n    r_vhost(vhost_),\n    r_url(url_),\n    r_method(method_),\n    target(target_)\n{ }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <iterator>",
      "#include <functional>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httprequest.h>",
      "#include <tnt/httperror.h>",
      "#include \"tnt/dispatcher.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <iterator>\n#include <functional>\n#include <tnt/tntconfig.h>\n#include <tnt/httprequest.h>\n#include <tnt/httperror.h>\n#include \"tnt/dispatcher.h\"\n\nMapping::Mapping(const std::string& vhost_, const std::string& url_,\n    const std::string& method_, int ssl_, const Maptarget& target_)\n  : vhost(vhost_),\n    url(url_),\n    method(method_),\n    ssl(ssl_),\n    r_vhost(vhost_),\n    r_url(url_),\n    r_method(method_),\n    target(target_)\n{ }"
  }
]