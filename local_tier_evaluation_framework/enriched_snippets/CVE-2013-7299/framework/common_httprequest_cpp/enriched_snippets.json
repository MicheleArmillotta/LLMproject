[
  {
    "function_name": "HttpRequest::postRunCleanup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "620-625",
    "snippet": "void HttpRequest::postRunCleanup()\n  {\n#ifdef ENABLE_LOCALE\n    tnt::clearLocaleCache();\n#endif\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tnt::clearLocaleCache",
          "args": [],
          "line": 623
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::postRunCleanup()\n  {\n#ifdef ENABLE_LOCALE\n    tnt::clearLocaleCache();\n#endif\n  }"
  },
  {
    "function_name": "HttpRequest::hasSecureSessionScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "615-618",
    "snippet": "bool HttpRequest::hasSecureSessionScope() const\n  {\n    return secureSessionScope != 0 && !secureSessionScope->empty();\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "secureSessionScope->empty",
          "args": [],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nbool HttpRequest::hasSecureSessionScope() const\n  {\n    return secureSessionScope != 0 && !secureSessionScope->empty();\n  }"
  },
  {
    "function_name": "HttpRequest::hasSessionScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "610-613",
    "snippet": "bool HttpRequest::hasSessionScope() const\n  {\n    return sessionScope != 0 && !sessionScope->empty();\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sessionScope->empty",
          "args": [],
          "line": 612
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nbool HttpRequest::hasSessionScope() const\n  {\n    return sessionScope != 0 && !sessionScope->empty();\n  }"
  },
  {
    "function_name": "HttpRequest::releaseSessionScopeLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "559-572",
    "snippet": "void HttpRequest::releaseSessionScopeLock()\n  {\n    if (secureSessionScope && secureSessionScopeLocked)\n    {\n      secureSessionScopeLocked = false;\n      secureSessionScope->unlock();\n    }\n\n    if (sessionScope && sessionScopeLocked)\n    {\n      sessionScopeLocked = false;\n      sessionScope->unlock();\n    }\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sessionScope->unlock",
          "args": [],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "unlock",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "70-70",
          "snippet": "void unlock() { mutex.unlock(); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void unlock() { mutex.unlock(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::releaseSessionScopeLock()\n  {\n    if (secureSessionScope && secureSessionScopeLocked)\n    {\n      secureSessionScopeLocked = false;\n      secureSessionScope->unlock();\n    }\n\n    if (sessionScope && sessionScopeLocked)\n    {\n      sessionScopeLocked = false;\n      sessionScope->unlock();\n    }\n  }"
  },
  {
    "function_name": "HttpRequest::releaseApplicationScopeLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "548-557",
    "snippet": "void HttpRequest::releaseApplicationScopeLock()\n  {\n    releaseSessionScopeLock();\n\n    if (applicationScope && applicationScopeLocked)\n    {\n      applicationScopeLocked = false;\n      applicationScope->unlock();\n    }\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "applicationScope->unlock",
          "args": [],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "unlock",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "70-70",
          "snippet": "void unlock() { mutex.unlock(); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void unlock() { mutex.unlock(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "releaseSessionScopeLock",
          "args": [],
          "line": 550
        },
        "resolved": true,
        "details": {
          "function_name": "HttpRequest::releaseSessionScopeLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "559-572",
          "snippet": "void HttpRequest::releaseSessionScopeLock()\n  {\n    if (secureSessionScope && secureSessionScopeLocked)\n    {\n      secureSessionScopeLocked = false;\n      secureSessionScope->unlock();\n    }\n\n    if (sessionScope && sessionScopeLocked)\n    {\n      sessionScopeLocked = false;\n      sessionScope->unlock();\n    }\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::releaseSessionScopeLock()\n  {\n    if (secureSessionScope && secureSessionScopeLocked)\n    {\n      secureSessionScopeLocked = false;\n      secureSessionScope->unlock();\n    }\n\n    if (sessionScope && sessionScopeLocked)\n    {\n      sessionScopeLocked = false;\n      sessionScope->unlock();\n    }\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::releaseApplicationScopeLock()\n  {\n    releaseSessionScopeLock();\n\n    if (applicationScope && applicationScopeLocked)\n    {\n      applicationScopeLocked = false;\n      applicationScope->unlock();\n    }\n  }"
  },
  {
    "function_name": "HttpRequest::ensureSessionScopeLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "532-546",
    "snippet": "void HttpRequest::ensureSessionScopeLock()\n  {\n    if (sessionScope && !sessionScopeLocked)\n    {\n      sessionScope->lock();\n      sessionScopeLocked = true;\n    }\n\n    if (secureSessionScope && !secureSessionScopeLocked)\n    {\n      secureSessionScope->lock();\n      secureSessionScopeLocked = true;\n    }\n\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "secureSessionScope->lock",
          "args": [],
          "line": 542
        },
        "resolved": true,
        "details": {
          "function_name": "lock",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "69-69",
          "snippet": "void lock()   { mutex.lock(); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void lock()   { mutex.lock(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::ensureSessionScopeLock()\n  {\n    if (sessionScope && !sessionScopeLocked)\n    {\n      sessionScope->lock();\n      sessionScopeLocked = true;\n    }\n\n    if (secureSessionScope && !secureSessionScopeLocked)\n    {\n      secureSessionScope->lock();\n      secureSessionScopeLocked = true;\n    }\n\n  }"
  },
  {
    "function_name": "HttpRequest::ensureApplicationScopeLock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "522-530",
    "snippet": "void HttpRequest::ensureApplicationScopeLock()\n  {\n    ensureSessionScopeLock();\n    if (applicationScope && !applicationScopeLocked)\n    {\n      applicationScope->lock();\n      applicationScopeLocked = true;\n    }\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "applicationScope->lock",
          "args": [],
          "line": 527
        },
        "resolved": true,
        "details": {
          "function_name": "lock",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "69-69",
          "snippet": "void lock()   { mutex.lock(); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void lock()   { mutex.lock(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ensureSessionScopeLock",
          "args": [],
          "line": 524
        },
        "resolved": true,
        "details": {
          "function_name": "HttpRequest::ensureSessionScopeLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "532-546",
          "snippet": "void HttpRequest::ensureSessionScopeLock()\n  {\n    if (sessionScope && !sessionScopeLocked)\n    {\n      sessionScope->lock();\n      sessionScopeLocked = true;\n    }\n\n    if (secureSessionScope && !secureSessionScopeLocked)\n    {\n      secureSessionScope->lock();\n      secureSessionScopeLocked = true;\n    }\n\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::ensureSessionScopeLock()\n  {\n    if (sessionScope && !sessionScopeLocked)\n    {\n      sessionScope->lock();\n      sessionScopeLocked = true;\n    }\n\n    if (secureSessionScope && !secureSessionScopeLocked)\n    {\n      secureSessionScope->lock();\n      secureSessionScopeLocked = true;\n    }\n\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::ensureApplicationScopeLock()\n  {\n    ensureSessionScopeLock();\n    if (applicationScope && !applicationScopeLocked)\n    {\n      applicationScope->lock();\n      applicationScopeLocked = true;\n    }\n  }"
  },
  {
    "function_name": "HttpRequest::setSecureSessionScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "500-520",
    "snippet": "void HttpRequest::setSecureSessionScope(Sessionscope* s)\n  {\n    if (secureSessionScope == s)\n      return;\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScopeLocked)\n      {\n        secureSessionScope->unlock();\n        secureSessionScopeLocked = false;\n      }\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n    }\n\n    if (s)\n      s->addRef();\n\n    secureSessionScope = s;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s->addRef",
          "args": [],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secureSessionScope->release",
          "args": [],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "secureSessionScope->unlock",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "unlock",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "70-70",
          "snippet": "void unlock() { mutex.unlock(); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void unlock() { mutex.unlock(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::setSecureSessionScope(Sessionscope* s)\n  {\n    if (secureSessionScope == s)\n      return;\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScopeLocked)\n      {\n        secureSessionScope->unlock();\n        secureSessionScopeLocked = false;\n      }\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n    }\n\n    if (s)\n      s->addRef();\n\n    secureSessionScope = s;\n  }"
  },
  {
    "function_name": "HttpRequest::setSessionScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "478-498",
    "snippet": "void HttpRequest::setSessionScope(Sessionscope* s)\n  {\n    if (sessionScope == s)\n      return;\n\n    if (sessionScope)\n    {\n      if (sessionScopeLocked)\n      {\n        sessionScope->unlock();\n        sessionScopeLocked = false;\n      }\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n    }\n\n    if (s)\n      s->addRef();\n\n    sessionScope = s;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s->addRef",
          "args": [],
          "line": 495
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScope->release",
          "args": [],
          "line": 490
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScope->unlock",
          "args": [],
          "line": 487
        },
        "resolved": true,
        "details": {
          "function_name": "unlock",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "70-70",
          "snippet": "void unlock() { mutex.unlock(); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void unlock() { mutex.unlock(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::setSessionScope(Sessionscope* s)\n  {\n    if (sessionScope == s)\n      return;\n\n    if (sessionScope)\n    {\n      if (sessionScopeLocked)\n      {\n        sessionScope->unlock();\n        sessionScopeLocked = false;\n      }\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n    }\n\n    if (s)\n      s->addRef();\n\n    sessionScope = s;\n  }"
  },
  {
    "function_name": "HttpRequest::setApplicationScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "461-476",
    "snippet": "void HttpRequest::setApplicationScope(Scope* s)\n  {\n    if (applicationScope == s)\n      return;\n\n    if (applicationScope)\n    {\n      releaseApplicationScopeLock();\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n    }\n\n    if (s)\n      s->addRef();\n    applicationScope = s;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s->addRef",
          "args": [],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "applicationScope->release",
          "args": [],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "releaseApplicationScopeLock",
          "args": [],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "HttpRequest::releaseApplicationScopeLock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "548-557",
          "snippet": "void HttpRequest::releaseApplicationScopeLock()\n  {\n    releaseSessionScopeLock();\n\n    if (applicationScope && applicationScopeLocked)\n    {\n      applicationScopeLocked = false;\n      applicationScope->unlock();\n    }\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::releaseApplicationScopeLock()\n  {\n    releaseSessionScopeLock();\n\n    if (applicationScope && applicationScopeLocked)\n    {\n      applicationScopeLocked = false;\n      applicationScope->unlock();\n    }\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::setApplicationScope(Scope* s)\n  {\n    if (applicationScope == s)\n      return;\n\n    if (applicationScope)\n    {\n      releaseApplicationScopeLock();\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n    }\n\n    if (s)\n      s->addRef();\n    applicationScope = s;\n  }"
  },
  {
    "function_name": "HttpRequest::keepAlive",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "442-452",
    "snippet": "bool HttpRequest::keepAlive() const\n  {\n    // request is keep alive when either a connection header is explicitely set to keep alive\n    // or the http version is 1.1\n    Messageheader::const_iterator it = header.find(httpheader::connection);\n\n    return it == header.end()\n               ? getMinorVersion() >= 1 && getMajorVersion() >= 1\n               : tnt::StringCompareIgnoreCase<const char*>(it->second,\n                    httpheader::connectionKeepAlive) == 0;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tnt::StringCompareIgnoreCase<const char*>",
          "args": [
            "it->second",
            "httpheader::connectionKeepAlive"
          ],
          "line": 450
        },
        "resolved": true,
        "details": {
          "function_name": "StringCompareIgnoreCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/stringlessignorecase.h",
          "lines": "66-69",
          "snippet": "inline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }",
          "includes": [
            "#include <cctype>",
            "#include <functional>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cctype>\n#include <functional>\n#include <string>\n\ninline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "getMajorVersion",
          "args": [],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "getMajorVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "73-74",
          "snippet": "unsigned short getMajorVersion() const\n        { return majorVersion; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  unsigned short getMajorVersion() const\n          { return majorVersion; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getMinorVersion",
          "args": [],
          "line": 449
        },
        "resolved": true,
        "details": {
          "function_name": "getMinorVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "76-77",
          "snippet": "unsigned short getMinorVersion() const\n        { return minorVersion; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  unsigned short getMinorVersion() const\n          { return minorVersion; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "header.end",
          "args": [],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "header.find",
          "args": [
            "httpheader::connection"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nbool HttpRequest::keepAlive() const\n  {\n    // request is keep alive when either a connection header is explicitely set to keep alive\n    // or the http version is 1.1\n    Messageheader::const_iterator it = header.find(httpheader::connection);\n\n    return it == header.end()\n               ? getMinorVersion() >= 1 && getMajorVersion() >= 1\n               : tnt::StringCompareIgnoreCase<const char*>(it->second,\n                    httpheader::connectionKeepAlive) == 0;\n  }"
  },
  {
    "function_name": "HttpRequest::verifyPassword",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "436-440",
    "snippet": "bool HttpRequest::verifyPassword(const std::string& password_) const\n  {\n    getUsername();\n    return password == password_;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getUsername",
          "args": [],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nbool HttpRequest::verifyPassword(const std::string& password_) const\n  {\n    getUsername();\n    return password == password_;\n  }"
  },
  {
    "function_name": "HttpRequest::setLang",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "384-391",
    "snippet": "void HttpRequest::setLang(const std::string& lang_)\n  {\n#ifdef ENABLE_LOCALE\n    lang = lang_;\n    qparam.locale(getCacheLocale(lang_));\n    locale_init = true;\n#endif\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "qparam.locale",
          "args": [
            "getCacheLocale(lang_)"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "locale",
          "container": "QueryParams",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/query_params.h",
          "lines": "169-169",
          "snippet": "void locale(const std::locale& loc)   { _locale = loc; }",
          "includes": [
            "#include <vector>",
            "#include <sstream>",
            "#include <stdexcept>",
            "#include <locale>",
            "#include <tnt/scope.h>",
            "#include <cxxtools/query_params.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <sstream>\n#include <stdexcept>\n#include <locale>\n#include <tnt/scope.h>\n#include <cxxtools/query_params.h>\n\nQueryParams {\n  void locale(const std::locale& loc)   { _locale = loc; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getCacheLocale",
          "args": [
            "lang_"
          ],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::setLang(const std::string& lang_)\n  {\n#ifdef ENABLE_LOCALE\n    lang = lang_;\n    qparam.locale(getCacheLocale(lang_));\n    locale_init = true;\n#endif\n  }"
  },
  {
    "function_name": "HttpRequest::setLocale",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "375-382",
    "snippet": "void HttpRequest::setLocale(const std::locale& loc)\n  {\n#ifdef ENABLE_LOCALE\n    locale_init = true;\n    qparam.locale(loc);\n    lang = loc.name();\n#endif\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "loc.name",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qparam.locale",
          "args": [
            "loc"
          ],
          "line": 379
        },
        "resolved": true,
        "details": {
          "function_name": "locale",
          "container": "QueryParams",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/query_params.h",
          "lines": "169-169",
          "snippet": "void locale(const std::locale& loc)   { _locale = loc; }",
          "includes": [
            "#include <vector>",
            "#include <sstream>",
            "#include <stdexcept>",
            "#include <locale>",
            "#include <tnt/scope.h>",
            "#include <cxxtools/query_params.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <sstream>\n#include <stdexcept>\n#include <locale>\n#include <tnt/scope.h>\n#include <cxxtools/query_params.h>\n\nQueryParams {\n  void locale(const std::locale& loc)   { _locale = loc; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::setLocale(const std::locale& loc)\n  {\n#ifdef ENABLE_LOCALE\n    locale_init = true;\n    qparam.locale(loc);\n    lang = loc.name();\n#endif\n  }"
  },
  {
    "function_name": "clearLocaleCache",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "345-352",
    "snippet": "void clearLocaleCache()\n    {\n      cxxtools::MutexLock lock(locale_monitor);\n      locale_map.clear();\n      delete stdlocalePtr;\n      stdlocalePtr = 0;\n      stdlocale = 0;\n    }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "locale_map.clear",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Compident",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/compident.h",
          "lines": "76-77",
          "snippet": "void clear()\n    { libname.clear(); compname.clear(); }",
          "includes": [
            "#include <iostream>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n#include <string>\n\nCompident {\n  void clear()\n      { libname.clear(); compname.clear(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid clearLocaleCache()\n    {\n      cxxtools::MutexLock lock(locale_monitor);\n      locale_map.clear();\n      delete stdlocalePtr;\n      stdlocalePtr = 0;\n      stdlocale = 0;\n    }"
  },
  {
    "function_name": "HttpRequest::doPostParse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "250-291",
    "snippet": "void HttpRequest::doPostParse()\n  {\n    if (hasHeader(\"Expect:\"))\n      throw HttpError(HTTP_EXPECTATION_FAILED, \"expectation failed\", \"Expect not supported by this server\");\n\n    getparam.parse_url(getQueryString());\n\n    if (isMethodPOST())\n    {\n      std::istringstream in(getHeader(httpheader::contentType));\n      in >> ct;\n\n      if (in)\n      {\n        if (ct.isMultipart())\n        {\n          mp.set(ct.getBoundary(), getBody());\n          for (Multipart::const_iterator it = mp.begin();\n               it != mp.end(); ++it)\n          {\n            // don't copy uploaded files into qparam to prevent unnecessery\n            // copies of large chunks\n            if (it->getFilename().empty())\n            {\n              std::string multipartBody(it->getBodyBegin(), it->getBodyEnd());\n              postparam.add(it->getName(), multipartBody);\n            }\n          }\n        }\n        else if (ct.getType() == \"application\"\n              && ct.getSubtype() == \"x-www-form-urlencoded\")\n        {\n          postparam.parse_url(getBody());\n        }\n      }\n    }\n\n    qparam.add(getparam);\n    qparam.add(postparam);\n\n    serial = cxxtools::atomicIncrement(serial_);\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::atomicIncrement",
          "args": [
            "serial_"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qparam.add",
          "args": [
            "postparam"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "qparam.add",
          "args": [
            "getparam"
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "postparam.parse_url",
          "args": [
            "getBody()"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getBody",
          "args": [],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "getBody",
          "container": "Part",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/multipart.h",
          "lines": "102-103",
          "snippet": "std::string getBody() const\n        { return std::string(getBodyBegin(), getBodyEnd()); }",
          "includes": [
            "#include <iterator>",
            "#include <vector>",
            "#include <tnt/contentdisposition.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iterator>\n#include <vector>\n#include <tnt/contentdisposition.h>\n#include <tnt/messageheader.h>\n\nPart {\n  std::string getBody() const\n          { return std::string(getBodyBegin(), getBodyEnd()); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ct.getSubtype",
          "args": [],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ct.getType",
          "args": [],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "postparam.add",
          "args": [
            "it->getName()",
            "multipartBody"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it->getName",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it->getBodyEnd",
          "args": [],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "getBodyEnd",
          "container": "Part",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/multipart.h",
          "lines": "99-100",
          "snippet": "const_iterator getBodyEnd() const\n        { return bodyEnd; }",
          "includes": [
            "#include <iterator>",
            "#include <vector>",
            "#include <tnt/contentdisposition.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iterator>\n#include <vector>\n#include <tnt/contentdisposition.h>\n#include <tnt/messageheader.h>\n\nPart {\n  const_iterator getBodyEnd() const\n          { return bodyEnd; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->getBodyBegin",
          "args": [],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "getBodyBegin",
          "container": "Part",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/multipart.h",
          "lines": "96-97",
          "snippet": "const_iterator getBodyBegin() const\n        { return bodyBegin; }",
          "includes": [
            "#include <iterator>",
            "#include <vector>",
            "#include <tnt/contentdisposition.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iterator>\n#include <vector>\n#include <tnt/contentdisposition.h>\n#include <tnt/messageheader.h>\n\nPart {\n  const_iterator getBodyBegin() const\n          { return bodyBegin; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->getFilename",
          "args": [],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it->getFilename",
          "args": [],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mp.end",
          "args": [],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mp.begin",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mp.set",
          "args": [
            "ct.getBoundary()",
            "getBody()"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ct.getBoundary",
          "args": [],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ct.isMultipart",
          "args": [],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "isMultipart",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "184-184",
          "snippet": "bool isMultipart() const               { return getContentType().isMultipart(); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  bool isMultipart() const               { return getContentType().isMultipart(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "isMethodPOST",
          "args": [],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "isMethodPOST",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "137-137",
          "snippet": "bool isMethodPOST() const                 { return std::strcmp(method, \"POST\") == 0; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  bool isMethodPOST() const                 { return std::strcmp(method, \"POST\") == 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getparam.parse_url",
          "args": [
            "getQueryString()"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getQueryString",
          "args": [],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HttpError",
          "args": [
            "HTTP_EXPECTATION_FAILED",
            "\"expectation failed\"",
            "\"Expect not supported by this server\""
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "HttpError::HttpError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "172-176",
          "snippet": "HttpError::HttpError(unsigned errcode, const std::string& m, const std::string& b)\n    : msg(httpErrorFormat(errcode, m)),\n      body(b)\n  {\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpError::HttpError(unsigned errcode, const std::string& m, const std::string& b)\n    : msg(httpErrorFormat(errcode, m)),\n      body(b)\n  {\n  }"
        }
      },
      {
        "call_info": {
          "callee": "hasHeader",
          "args": [
            "\"Expect:\""
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "hasHeader",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "139-140",
          "snippet": "bool hasHeader(const std::string& key) const\n        { return hasHeader(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  bool hasHeader(const std::string& key) const\n          { return hasHeader(key.c_str()); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::doPostParse()\n  {\n    if (hasHeader(\"Expect:\"))\n      throw HttpError(HTTP_EXPECTATION_FAILED, \"expectation failed\", \"Expect not supported by this server\");\n\n    getparam.parse_url(getQueryString());\n\n    if (isMethodPOST())\n    {\n      std::istringstream in(getHeader(httpheader::contentType));\n      in >> ct;\n\n      if (in)\n      {\n        if (ct.isMultipart())\n        {\n          mp.set(ct.getBoundary(), getBody());\n          for (Multipart::const_iterator it = mp.begin();\n               it != mp.end(); ++it)\n          {\n            // don't copy uploaded files into qparam to prevent unnecessery\n            // copies of large chunks\n            if (it->getFilename().empty())\n            {\n              std::string multipartBody(it->getBodyBegin(), it->getBodyEnd());\n              postparam.add(it->getName(), multipartBody);\n            }\n          }\n        }\n        else if (ct.getType() == \"application\"\n              && ct.getSubtype() == \"x-www-form-urlencoded\")\n        {\n          postparam.parse_url(getBody());\n        }\n      }\n    }\n\n    qparam.add(getparam);\n    qparam.add(postparam);\n\n    serial = cxxtools::atomicIncrement(serial_);\n  }"
  },
  {
    "function_name": "HttpRequest::parse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "242-248",
    "snippet": "void HttpRequest::parse(std::istream& in)\n  {\n    Parser p(*this);\n    p.parse(in);\n    if (!p.failed())\n      doPostParse();\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "doPostParse",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "p.failed",
          "args": [],
          "line": 246
        },
        "resolved": true,
        "details": {
          "function_name": "failed",
          "container": "Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/parser.h",
          "lines": "104-107",
          "snippet": "bool failed() const\n      {\n        return failedFlag;\n      }",
          "includes": [
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n\nParser {\n  bool failed() const\n        {\n          return failedFlag;\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "p.parse",
          "args": [
            "in"
          ],
          "line": 245
        },
        "resolved": true,
        "details": {
          "function_name": "parse",
          "container": "Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/parser.h",
          "lines": "93-102",
          "snippet": "bool parse(std::istream& in)\n      {\n        std::streambuf* buf = in.rdbuf();\n        while (buf->sgetc() != std::ios::traits_type::eof())\n          if ( parse(buf->sbumpc()) )\n            return true;\n\n        in.setstate(std::ios::eofbit);\n        return false;\n      }",
          "includes": [
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n\nParser {\n  bool parse(std::istream& in)\n        {\n          std::streambuf* buf = in.rdbuf();\n          while (buf->sgetc() != std::ios::traits_type::eof())\n            if ( parse(buf->sbumpc()) )\n              return true;\n  \n          in.setstate(std::ios::eofbit);\n          return false;\n        }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::parse(std::istream& in)\n  {\n    Parser p(*this);\n    p.parse(in);\n    if (!p.failed())\n      doPostParse();\n  }"
  },
  {
    "function_name": "HttpRequest::getArg",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "236-240",
    "snippet": "std::string HttpRequest::getArg(const std::string& name, const std::string& def) const\n  {\n    args_type::const_iterator it = args.find(name);\n    return it == args.end() ? def : it->second;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "args.end",
          "args": [],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "args.find",
          "args": [
            "name"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nstd::string HttpRequest::getArg(const std::string& name, const std::string& def) const\n  {\n    args_type::const_iterator it = args.find(name);\n    return it == args.end() ? def : it->second;\n  }"
  },
  {
    "function_name": "HttpRequest::getArgDef",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "229-234",
    "snippet": "std::string HttpRequest::getArgDef(args_type::size_type n, const std::string& def) const\n  {\n    std::ostringstream k;\n    k << \"arg\" << n;\n    return getArg(k.str(), def);\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getArg",
          "args": [
            "k.str()",
            "def"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "HttpRequest::getArg",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "236-240",
          "snippet": "std::string HttpRequest::getArg(const std::string& name, const std::string& def) const\n  {\n    args_type::const_iterator it = args.find(name);\n    return it == args.end() ? def : it->second;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nstd::string HttpRequest::getArg(const std::string& name, const std::string& def) const\n  {\n    args_type::const_iterator it = args.find(name);\n    return it == args.end() ? def : it->second;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "k.str",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nstd::string HttpRequest::getArgDef(args_type::size_type n, const std::string& def) const\n  {\n    std::ostringstream k;\n    k << \"arg\" << n;\n    return getArg(k.str(), def);\n  }"
  },
  {
    "function_name": "HttpRequest::setMethod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "222-227",
    "snippet": "void HttpRequest::setMethod(const char* m)\n  {\n    if (strlen(m) >= 7)\n      throw HttpError(HTTP_BAD_REQUEST, \"invalid method\");\n    std::strcpy(method, m);\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::strcpy",
          "args": [
            "method",
            "m"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HttpError",
          "args": [
            "HTTP_BAD_REQUEST",
            "\"invalid method\""
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "HttpError::HttpError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "146-158",
          "snippet": "HttpError::HttpError(unsigned errcode)\n    : msg(HttpReturn::httpMessage(errcode))\n  {\n    std::ostringstream b;\n    HtmlEscOstream sb(b);\n\n    b << \"<html><body><h1>Error</h1><p>\";\n    sb << msg;\n    b << \"</p></body></html>\";\n    body = b.str();\n\n    msg = httpErrorFormat(errcode, msg);\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpError::HttpError(unsigned errcode)\n    : msg(HttpReturn::httpMessage(errcode))\n  {\n    std::ostringstream b;\n    HtmlEscOstream sb(b);\n\n    b << \"<html><body><h1>Error</h1><p>\";\n    sb << msg;\n    b << \"</p></body></html>\";\n    body = b.str();\n\n    msg = httpErrorFormat(errcode, msg);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "m"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::setMethod(const char* m)\n  {\n    if (strlen(m) >= 7)\n      throw HttpError(HTTP_BAD_REQUEST, \"invalid method\");\n    std::strcpy(method, m);\n  }"
  },
  {
    "function_name": "HttpRequest::clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "168-220",
    "snippet": "void HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "secureSessionScope->release",
          "args": [],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScope->release",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "applicationScope->release",
          "args": [],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "releaseLocks",
          "args": [],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "releaseLocks",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "111-111",
          "snippet": "void releaseLocks() { releaseApplicationScopeLock(); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void releaseLocks() { releaseApplicationScopeLock(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "password.clear",
          "args": [],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Compident",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/compident.h",
          "lines": "76-77",
          "snippet": "void clear()\n    { libname.clear(); compname.clear(); }",
          "includes": [
            "#include <iostream>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n#include <string>\n\nCompident {\n  void clear()\n      { libname.clear(); compname.clear(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "requestScope->release",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Multipart",
          "args": [],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "isMultipart",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "184-184",
          "snippet": "bool isMultipart() const               { return getContentType().isMultipart(); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  bool isMultipart() const               { return getContentType().isMultipart(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Contenttype",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "parameter_end",
          "container": "Contenttype",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/contenttype.h",
          "lines": "72-73",
          "snippet": "parameter_iterator parameter_end() const\n        { return parameter.end(); }",
          "includes": [
            "#include <map>",
            "#include <tnt/messageattribute.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <map>\n#include <tnt/messageattribute.h>\n\nContenttype {\n  parameter_iterator parameter_end() const\n          { return parameter.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "HttpMessage::clear",
          "args": [],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "HttpMessage::clear",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "42-47",
          "snippet": "void HttpMessage::clear()\n  {\n    header.clear();\n    majorVersion = 1;\n    minorVersion = 0;\n  }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nvoid HttpMessage::clear()\n  {\n    header.clear();\n    majorVersion = 1;\n    minorVersion = 0;\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }"
  },
  {
    "function_name": "HttpRequest::~HttpRequest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "121-133",
    "snippet": "HttpRequest::~HttpRequest()\n  {\n    releaseLocks();\n\n    if (requestScope && requestScope->release() == 0)\n      delete requestScope;\n    if (applicationScope && applicationScope->release() == 0)\n      delete applicationScope;\n    if (sessionScope && sessionScope->release() == 0)\n      delete sessionScope;\n    if (secureSessionScope && secureSessionScope->release() == 0)\n      delete secureSessionScope;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "secureSessionScope->release",
          "args": [],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScope->release",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "applicationScope->release",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "requestScope->release",
          "args": [],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "releaseLocks",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "releaseLocks",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "111-111",
          "snippet": "void releaseLocks() { releaseApplicationScopeLock(); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void releaseLocks() { releaseApplicationScopeLock(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest::~HttpRequest()\n  {\n    releaseLocks();\n\n    if (requestScope && requestScope->release() == 0)\n      delete requestScope;\n    if (applicationScope && applicationScope->release() == 0)\n      delete applicationScope;\n    if (sessionScope && sessionScope->release() == 0)\n      delete sessionScope;\n    if (secureSessionScope && secureSessionScope->release() == 0)\n      delete secureSessionScope;\n  }"
  },
  {
    "function_name": "HttpRequest::HttpRequest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "89-119",
    "snippet": "HttpRequest::HttpRequest(const HttpRequest& r)\n    : methodLen(0),\n      pathinfo(r.pathinfo),\n      args(r.args),\n      getparam(r.getparam),\n      postparam(r.postparam),\n      qparam(r.qparam),\n      socketIf(r.socketIf),\n      ct(r.ct),\n      mp(r.mp),\n      serial(r.serial),\n      locale_init(r.locale_init),\n      requestScope(r.requestScope),\n      applicationScope(r.applicationScope),\n      sessionScope(r.sessionScope),\n      secureSessionScope(r.secureSessionScope),\n      threadContext(r.threadContext),\n      applicationScopeLocked(false),\n      sessionScopeLocked(false),\n      secureSessionScopeLocked(false),\n      application(r.application)\n  {\n    if (requestScope)\n      requestScope->addRef();\n    if (applicationScope)\n      applicationScope->addRef();\n    if (sessionScope)\n      sessionScope->addRef();\n    if (secureSessionScope)\n      secureSessionScope->addRef();\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "secureSessionScope->addRef",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScope->addRef",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "applicationScope->addRef",
          "args": [],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "requestScope->addRef",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest::HttpRequest(const HttpRequest& r)\n    : methodLen(0),\n      pathinfo(r.pathinfo),\n      args(r.args),\n      getparam(r.getparam),\n      postparam(r.postparam),\n      qparam(r.qparam),\n      socketIf(r.socketIf),\n      ct(r.ct),\n      mp(r.mp),\n      serial(r.serial),\n      locale_init(r.locale_init),\n      requestScope(r.requestScope),\n      applicationScope(r.applicationScope),\n      sessionScope(r.sessionScope),\n      secureSessionScope(r.secureSessionScope),\n      threadContext(r.threadContext),\n      applicationScopeLocked(false),\n      sessionScopeLocked(false),\n      secureSessionScopeLocked(false),\n      application(r.application)\n  {\n    if (requestScope)\n      requestScope->addRef();\n    if (applicationScope)\n      applicationScope->addRef();\n    if (sessionScope)\n      sessionScope->addRef();\n    if (secureSessionScope)\n      secureSessionScope->addRef();\n  }"
  },
  {
    "function_name": "HttpRequest::HttpRequest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "72-87",
    "snippet": "HttpRequest::HttpRequest(Tntnet& application_, const std::string& url_, const SocketIf* socketIf_)\n    : socketIf(socketIf_),\n      locale_init(false),\n      requestScope(0),\n      applicationScope(0),\n      sessionScope(0),\n      secureSessionScope(0),\n      threadContext(0),\n      applicationScopeLocked(false),\n      sessionScopeLocked(false),\n      secureSessionScopeLocked(false),\n      application(application_)\n  {\n    std::istringstream s(\"GET \" + url_ + \" HTTP/1.1\\r\\n\\r\\n\");\n    parse(s);\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parse",
          "args": [
            "s"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "HttpRequest::parse",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "242-248",
          "snippet": "void HttpRequest::parse(std::istream& in)\n  {\n    Parser p(*this);\n    p.parse(in);\n    if (!p.failed())\n      doPostParse();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nvoid HttpRequest::parse(std::istream& in)\n  {\n    Parser p(*this);\n    p.parse(in);\n    if (!p.failed())\n      doPostParse();\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest::HttpRequest(Tntnet& application_, const std::string& url_, const SocketIf* socketIf_)\n    : socketIf(socketIf_),\n      locale_init(false),\n      requestScope(0),\n      applicationScope(0),\n      sessionScope(0),\n      secureSessionScope(0),\n      threadContext(0),\n      applicationScopeLocked(false),\n      sessionScopeLocked(false),\n      secureSessionScopeLocked(false),\n      application(application_)\n  {\n    std::istringstream s(\"GET \" + url_ + \" HTTP/1.1\\r\\n\\r\\n\");\n    parse(s);\n  }"
  },
  {
    "function_name": "HttpRequest::HttpRequest",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
    "lines": "56-70",
    "snippet": "HttpRequest::HttpRequest(Tntnet& application_, const SocketIf* socketIf_)\n    : socketIf(socketIf_),\n      locale_init(false),\n      encodingRead(false),\n      requestScope(0),\n      applicationScope(0),\n      sessionScope(0),\n      secureSessionScope(0),\n      threadContext(0),\n      applicationScopeLocked(false),\n      sessionScopeLocked(false),\n      secureSessionScopeLocked(false),\n      application(application_)\n  {\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include \"config.h\"",
      "#include <pthread.h>",
      "#include <tnt/socketif.h>",
      "#include <tnt/sessionscope.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <cxxtools/base64stream.h>",
      "#include <cxxtools/mutex.h>",
      "#include <cxxtools/log.h>",
      "#include <sstream>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>",
      "#include <tnt/httprequest.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest::HttpRequest(Tntnet& application_, const SocketIf* socketIf_)\n    : socketIf(socketIf_),\n      locale_init(false),\n      encodingRead(false),\n      requestScope(0),\n      applicationScope(0),\n      sessionScope(0),\n      secureSessionScope(0),\n      threadContext(0),\n      applicationScopeLocked(false),\n      sessionScopeLocked(false),\n      secureSessionScopeLocked(false),\n      application(application_)\n  {\n  }"
  }
]