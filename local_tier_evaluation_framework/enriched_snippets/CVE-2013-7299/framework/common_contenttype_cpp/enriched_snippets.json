[
  {
    "function_name": "Contenttype::onParameter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/contenttype.cpp",
    "lines": "89-101",
    "snippet": "Contenttype::return_type Contenttype::onParameter(\n    const std::string& attribute, const std::string& value)\n  {\n    log_debug(\"Contenttype::onParameter \" << attribute << \", \" << value);\n    std::string att = attribute;\n    std::transform(att.begin(), att.end(), att.begin(),\n      ::tolower);\n\n    parameter.insert(parameter_type::value_type(att, value));\n    if (attribute == \"boundary\")\n      boundary = value;\n    return OK;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <ctype.h>",
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <tnt/util.h>",
      "#include <tnt/contenttype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parameter.insert",
          "args": [
            "parameter_type::value_type(att, value)"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameter_type::value_type",
          "args": [
            "att",
            "value"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::transform",
          "args": [
            "att.begin()",
            "att.end()",
            "att.begin()",
            "::tolower"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "att.begin",
          "args": [],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "att.end",
          "args": [],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"Contenttype::onParameter \" << attribute << \", \" << value"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <ctype.h>\n#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <tnt/util.h>\n#include <tnt/contenttype.h>\n\nContenttype::return_type Contenttype::onParameter(\n    const std::string& attribute, const std::string& value)\n  {\n    log_debug(\"Contenttype::onParameter \" << attribute << \", \" << value);\n    std::string att = attribute;\n    std::transform(att.begin(), att.end(), att.begin(),\n      ::tolower);\n\n    parameter.insert(parameter_type::value_type(att, value));\n    if (attribute == \"boundary\")\n      boundary = value;\n    return OK;\n  }"
  },
  {
    "function_name": "Contenttype::onType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/contenttype.cpp",
    "lines": "71-87",
    "snippet": "Contenttype::return_type Contenttype::onType(\n    const std::string& t, const std::string& s)\n  {\n    log_debug(\"Contenttype::onType \" << t << \", \" << s);\n    if (s.empty())\n      return FAIL;\n\n    type = t;\n    subtype = s;\n\n    std::transform(type.begin(), type.end(), type.begin(),\n      ::tolower);\n    std::transform(subtype.begin(), subtype.end(), subtype.begin(),\n      ::tolower);\n\n    return OK;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <ctype.h>",
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <tnt/util.h>",
      "#include <tnt/contenttype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::transform",
          "args": [
            "subtype.begin()",
            "subtype.end()",
            "subtype.begin()",
            "::tolower"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "subtype.begin",
          "args": [],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "subtype.end",
          "args": [],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::transform",
          "args": [
            "type.begin()",
            "type.end()",
            "type.begin()",
            "::tolower"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.empty",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"Contenttype::onType \" << t << \", \" << s"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <ctype.h>\n#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <tnt/util.h>\n#include <tnt/contenttype.h>\n\nContenttype::return_type Contenttype::onType(\n    const std::string& t, const std::string& s)\n  {\n    log_debug(\"Contenttype::onType \" << t << \", \" << s);\n    if (s.empty())\n      return FAIL;\n\n    type = t;\n    subtype = s;\n\n    std::transform(type.begin(), type.end(), type.begin(),\n      ::tolower);\n    std::transform(subtype.begin(), subtype.end(), subtype.begin(),\n      ::tolower);\n\n    return OK;\n  }"
  },
  {
    "function_name": "Contenttype::Contenttype",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/contenttype.cpp",
    "lines": "43-69",
    "snippet": "Contenttype::Contenttype(const std::string& ct)\n  {\n    log_debug(\"Contenttype <= \" << ct);\n\n    std::istringstream in(ct);\n\n    in >> *this;\n    if (!in)\n    {\n      std::ostringstream msg;\n      msg << \"error 1 parsing content-type-header at \"\n          << in.tellg()\n          << \": \"\n          << ct;\n      throwRuntimeError(msg.str());\n    }\n\n    if (in.get() != std::ios::traits_type::eof())\n    {\n      std::ostringstream msg;\n      msg << \"error 2 parsing content-type-header at \"\n          << in.tellg()\n          << \": \"\n          << ct;\n      throwRuntimeError(msg.str());\n    }\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <algorithm>",
      "#include <ctype.h>",
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <tnt/util.h>",
      "#include <tnt/contenttype.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "throwRuntimeError",
          "args": [
            "msg.str()"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "throwRuntimeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/util.cpp",
          "lines": "39-42",
          "snippet": "void throwRuntimeError(const char* msg)\n  {\n    throwRuntimeError(std::string(msg));\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <tnt/util.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <tnt/util.h>\n\nvoid throwRuntimeError(const char* msg)\n  {\n    throwRuntimeError(std::string(msg));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "msg.str",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.tellg",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::ios::traits_type::eof",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.get",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "msg.str",
          "args": [],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.tellg",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"Contenttype <= \" << ct"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <ctype.h>\n#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <tnt/util.h>\n#include <tnt/contenttype.h>\n\nContenttype::Contenttype(const std::string& ct)\n  {\n    log_debug(\"Contenttype <= \" << ct);\n\n    std::istringstream in(ct);\n\n    in >> *this;\n    if (!in)\n    {\n      std::ostringstream msg;\n      msg << \"error 1 parsing content-type-header at \"\n          << in.tellg()\n          << \": \"\n          << ct;\n      throwRuntimeError(msg.str());\n    }\n\n    if (in.get() != std::ios::traits_type::eof())\n    {\n      std::ostringstream msg;\n      msg << \"error 2 parsing content-type-header at \"\n          << in.tellg()\n          << \": \"\n          << ct;\n      throwRuntimeError(msg.str());\n    }\n  }"
  }
]