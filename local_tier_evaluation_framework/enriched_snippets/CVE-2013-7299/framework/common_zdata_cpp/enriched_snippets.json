[
  {
    "function_name": "release",
    "container": "Zdata",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
    "lines": "62-70",
    "snippet": "void Zdata::release()\n  {\n    if (cxxtools::atomicDecrement(refs) == 0)\n    {\n      log_debug(\"release \" << data_len << \" uncompressed bytes\");\n      delete[] data;\n      data = 0;\n    }\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <stdexcept>",
      "#include <zlib.h>",
      "#include <tnt/util.h>",
      "#include <tnt/zdata.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"release \" << data_len << \" uncompressed bytes\""
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::atomicDecrement",
          "args": [
            "refs"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nZdata {\n  void Zdata::release()\n    {\n      if (cxxtools::atomicDecrement(refs) == 0)\n      {\n        log_debug(\"release \" << data_len << \" uncompressed bytes\");\n        delete[] data;\n        data = 0;\n      }\n    }\n}"
  },
  {
    "function_name": "addRef",
    "container": "Zdata",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
    "lines": "40-60",
    "snippet": "void Zdata::addRef()\n  {\n    if (cxxtools::atomicIncrement(refs) == 1)\n    {\n      // allocate uncompressed data\n      data = new char[data_len];\n\n      // uncompress Zdata => data\n      log_debug(\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\");\n      uLong dest_len = data_len;\n      int z_ret = uncompress((Bytef*)data, &dest_len, (const Bytef*)zptr, zdata_len);\n      if (z_ret != Z_OK)\n      {\n        throwRuntimeError(std::string(\"error uncompressing data: \") +\n          (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n           z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n           z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\"));\n      }\n      log_debug(\"uncompress ready\");\n    }\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <stdexcept>",
      "#include <zlib.h>",
      "#include <tnt/util.h>",
      "#include <tnt/zdata.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"uncompress ready\""
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "throwRuntimeError",
          "args": [
            "std::string(\"error uncompressing data: \") +\n          (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n           z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n           z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\")"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "throwRuntimeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/util.cpp",
          "lines": "39-42",
          "snippet": "void throwRuntimeError(const char* msg)\n  {\n    throwRuntimeError(std::string(msg));\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <tnt/util.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <tnt/util.h>\n\nvoid throwRuntimeError(const char* msg)\n  {\n    throwRuntimeError(std::string(msg));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"error uncompressing data: \""
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uncompress",
          "args": [
            "(Bytef*)data",
            "&dest_len",
            "(const Bytef*)zptr",
            "zdata_len"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\""
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::atomicIncrement",
          "args": [
            "refs"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nZdata {\n  void Zdata::addRef()\n    {\n      if (cxxtools::atomicIncrement(refs) == 1)\n      {\n        // allocate uncompressed data\n        data = new char[data_len];\n  \n        // uncompress Zdata => data\n        log_debug(\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\");\n        uLong dest_len = data_len;\n        int z_ret = uncompress((Bytef*)data, &dest_len, (const Bytef*)zptr, zdata_len);\n        if (z_ret != Z_OK)\n        {\n          throwRuntimeError(std::string(\"error uncompressing data: \") +\n            (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n             z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n             z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\"));\n        }\n        log_debug(\"uncompress ready\");\n      }\n    }\n}"
  }
]