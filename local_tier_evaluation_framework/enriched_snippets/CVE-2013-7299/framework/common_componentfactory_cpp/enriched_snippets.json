[
  {
    "function_name": "ComponentFactory::~ComponentFactory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/componentfactory.cpp",
    "lines": "48-51",
    "snippet": "ComponentFactory::~ComponentFactory()\n  {\n    delete theComponent;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/comploader.h\"",
      "#include \"tnt/componentfactory.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/comploader.h\"\n#include \"tnt/componentfactory.h\"\n\nComponentFactory::~ComponentFactory()\n  {\n    delete theComponent;\n  }"
  },
  {
    "function_name": "ComponentFactory::ComponentFactory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/componentfactory.cpp",
    "lines": "41-46",
    "snippet": "ComponentFactory::ComponentFactory(const std::string& componentName)\n    : theComponent(0)\n  {\n    log_debug(\"create componentfactory for \" << componentName);\n    Comploader::registerFactory(componentName, this);\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/comploader.h\"",
      "#include \"tnt/componentfactory.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Comploader::registerFactory",
          "args": [
            "componentName",
            "this"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "Comploader::registerFactory",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/comploader.cpp",
          "lines": "291-312",
          "snippet": "void Comploader::registerFactory(const std::string& component_name,\n  ComponentFactory* factory)\n{\n  log_debug(\"Comploader::registerFactory(\" << component_name << \", \" << factory << ')');\n\n  if (currentFactoryMap)\n    currentFactoryMap->insert(ComponentLibrary::factoryMapType::value_type(component_name, factory));\n  else\n  {\n    librarymap_type& librarymap = getLibrarymap();\n    log_debug(\"register component without library-name\");\n    librarymap_type::iterator it = librarymap.find(std::string());\n    if (it == librarymap.end())\n    {\n      // empty library not in map - create a new empty library-object\n      it = librarymap.insert(\n        librarymap_type::value_type(std::string(),\n                                    ComponentLibrary())).first;\n    }\n    it->second.registerFactory(component_name, factory);\n  }\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include <cxxtools/dlloader.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/componentfactory.h>",
            "#include <tnt/comploader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <cxxtools/dlloader.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/componentfactory.h>\n#include <tnt/comploader.h>\n\nvoid Comploader::registerFactory(const std::string& component_name,\n  ComponentFactory* factory)\n{\n  log_debug(\"Comploader::registerFactory(\" << component_name << \", \" << factory << ')');\n\n  if (currentFactoryMap)\n    currentFactoryMap->insert(ComponentLibrary::factoryMapType::value_type(component_name, factory));\n  else\n  {\n    librarymap_type& librarymap = getLibrarymap();\n    log_debug(\"register component without library-name\");\n    librarymap_type::iterator it = librarymap.find(std::string());\n    if (it == librarymap.end())\n    {\n      // empty library not in map - create a new empty library-object\n      it = librarymap.insert(\n        librarymap_type::value_type(std::string(),\n                                    ComponentLibrary())).first;\n    }\n    it->second.registerFactory(component_name, factory);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"create componentfactory for \" << componentName"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/comploader.h\"\n#include \"tnt/componentfactory.h\"\n\nComponentFactory::ComponentFactory(const std::string& componentName)\n    : theComponent(0)\n  {\n    log_debug(\"create componentfactory for \" << componentName);\n    Comploader::registerFactory(componentName, this);\n  }"
  }
]