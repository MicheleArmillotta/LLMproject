[
  {
    "function_name": "onParameter",
    "container": "Contentdisposition",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/contentdisposition.cpp",
    "lines": "50-62",
    "snippet": "Contentdisposition::return_type Contentdisposition::onParameter(\n    const std::string& attribute,\n    const std::string& value)\n  {\n    if (attribute == \"name\")\n    {\n      name = value;\n    }\n    else if (attribute == \"filename\")\n      filename = value;\n\n    return OK;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <ctype.h>",
      "#include <tnt/contentdisposition.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <ctype.h>\n#include <tnt/contentdisposition.h>\n\nContentdisposition {\n  Contentdisposition::return_type Contentdisposition::onParameter(\n      const std::string& attribute,\n      const std::string& value)\n    {\n      if (attribute == \"name\")\n      {\n        name = value;\n      }\n      else if (attribute == \"filename\")\n        filename = value;\n  \n      return OK;\n    }\n}"
  },
  {
    "function_name": "onType",
    "container": "Contentdisposition",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/contentdisposition.cpp",
    "lines": "36-48",
    "snippet": "Contentdisposition::return_type Contentdisposition::onType(\n    const std::string& t,\n    const std::string& subtype)\n  {\n    if (!subtype.empty())\n      return FAIL;\n\n    type = t;\n    std::transform(type.begin(), type.end(), type.begin(),\n      ::tolower);\n\n    return OK;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <ctype.h>",
      "#include <tnt/contentdisposition.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::transform",
          "args": [
            "type.begin()",
            "type.end()",
            "type.begin()",
            "::tolower"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.begin",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "type.end",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "subtype.empty",
          "args": [],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <ctype.h>\n#include <tnt/contentdisposition.h>\n\nContentdisposition {\n  Contentdisposition::return_type Contentdisposition::onType(\n      const std::string& t,\n      const std::string& subtype)\n    {\n      if (!subtype.empty())\n        return FAIL;\n  \n      type = t;\n      std::transform(type.begin(), type.end(), type.begin(),\n        ::tolower);\n  \n      return OK;\n    }\n}"
  }
]