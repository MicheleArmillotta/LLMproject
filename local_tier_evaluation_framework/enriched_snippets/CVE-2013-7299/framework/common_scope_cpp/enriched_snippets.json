[
  {
    "function_name": "Scope::privatePut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scope.cpp",
    "lines": "43-46",
    "snippet": "void Scope::privatePut(const std::string& key, Scope::pointer_type o)\n  {\n    data.insert(container_type::value_type(key, o));\n  }",
    "includes": [
      "#include <tnt/scope.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "data.insert",
          "args": [
            "container_type::value_type(key, o)"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "container_type::value_type",
          "args": [
            "key",
            "o"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <tnt/scope.h>\n\nvoid Scope::privatePut(const std::string& key, Scope::pointer_type o)\n  {\n    data.insert(container_type::value_type(key, o));\n  }"
  },
  {
    "function_name": "Scope::~Scope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scope.cpp",
    "lines": "39-41",
    "snippet": "Scope::~Scope()\n  {\n  }",
    "includes": [
      "#include <tnt/scope.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <tnt/scope.h>\n\nScope::~Scope()\n  {\n  }"
  },
  {
    "function_name": "Scope::Scope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scope.cpp",
    "lines": "34-37",
    "snippet": "Scope::Scope()\n  {\n    addRef();\n  }",
    "includes": [
      "#include <tnt/scope.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addRef",
          "args": [],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "Zdata::addRef",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
          "lines": "40-60",
          "snippet": "void Zdata::addRef()\n  {\n    if (cxxtools::atomicIncrement(refs) == 1)\n    {\n      // allocate uncompressed data\n      data = new char[data_len];\n\n      // uncompress Zdata => data\n      log_debug(\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\");\n      uLong dest_len = data_len;\n      int z_ret = uncompress((Bytef*)data, &dest_len, (const Bytef*)zptr, zdata_len);\n      if (z_ret != Z_OK)\n      {\n        throwRuntimeError(std::string(\"error uncompressing data: \") +\n          (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n           z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n           z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\"));\n      }\n      log_debug(\"uncompress ready\");\n    }\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <stdexcept>",
            "#include <zlib.h>",
            "#include <tnt/util.h>",
            "#include <tnt/zdata.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nvoid Zdata::addRef()\n  {\n    if (cxxtools::atomicIncrement(refs) == 1)\n    {\n      // allocate uncompressed data\n      data = new char[data_len];\n\n      // uncompress Zdata => data\n      log_debug(\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\");\n      uLong dest_len = data_len;\n      int z_ret = uncompress((Bytef*)data, &dest_len, (const Bytef*)zptr, zdata_len);\n      if (z_ret != Z_OK)\n      {\n        throwRuntimeError(std::string(\"error uncompressing data: \") +\n          (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n           z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n           z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\"));\n      }\n      log_debug(\"uncompress ready\");\n    }\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <tnt/scope.h>\n\nScope::Scope()\n  {\n    addRef();\n  }"
  }
]