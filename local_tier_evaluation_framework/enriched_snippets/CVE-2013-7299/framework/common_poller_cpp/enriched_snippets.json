[
  {
    "function_name": "addIdleJob",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "386-394",
    "snippet": "void PollerImpl::addIdleJob(Jobqueue::JobPtr job)\n  {\n    {\n      cxxtools::MutexLock lock(mutex);\n      new_jobs.push_back(job);\n    }\n\n    notify_pipe.write('A');\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "notify_pipe.write",
          "args": [
            "'A'"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_jobs.push_back",
          "args": [
            "job"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::addIdleJob(Jobqueue::JobPtr job)\n    {\n      {\n        cxxtools::MutexLock lock(mutex);\n        new_jobs.push_back(job);\n      }\n  \n      notify_pipe.write('A');\n    }\n}"
  },
  {
    "function_name": "remove",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "371-384",
    "snippet": "void PollerImpl::remove(jobs_type::size_type n)\n  {\n    // replace job with last job in poller-list\n    jobs_type::size_type last = current_jobs.size() - 1;\n\n    if (n != last)\n    {\n      pollfds[n + 1] = pollfds[last + 1];\n      current_jobs[n] = current_jobs[last];\n    }\n\n    pollfds.pop_back();\n    current_jobs.pop_back();\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_jobs.pop_back",
          "args": [],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollfds.pop_back",
          "args": [],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_jobs.size",
          "args": [],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::remove(jobs_type::size_type n)\n    {\n      // replace job with last job in poller-list\n      jobs_type::size_type last = current_jobs.size() - 1;\n  \n      if (n != last)\n      {\n        pollfds[n + 1] = pollfds[last + 1];\n        current_jobs[n] = current_jobs[last];\n      }\n  \n      pollfds.pop_back();\n      current_jobs.pop_back();\n    }\n}"
  },
  {
    "function_name": "dispatch",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "343-369",
    "snippet": "void PollerImpl::dispatch()\n  {\n    time_t currentTime;\n    time(&currentTime);\n    for (unsigned i = 0; i < current_jobs.size(); )\n    {\n      if (pollfds[i + 1].revents & POLLIN)\n      {\n        // put job into work-queue\n        queue.put(current_jobs[i]);\n        remove(i);\n      }\n      else if (pollfds[i + 1].revents != 0)\n        remove(i);\n      else\n      {\n        // check timeout\n        int msec = current_jobs[i]->msecToTimeout(currentTime);\n        if (msec <= 0)\n          remove(i);\n        else if (poll_timeout < 0 || msec < poll_timeout)\n          poll_timeout = msec;\n\n        ++i;\n      }\n    }\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "remove",
          "args": [
            "i"
          ],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "remove",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "371-384",
          "snippet": "void PollerImpl::remove(jobs_type::size_type n)\n  {\n    // replace job with last job in poller-list\n    jobs_type::size_type last = current_jobs.size() - 1;\n\n    if (n != last)\n    {\n      pollfds[n + 1] = pollfds[last + 1];\n      current_jobs[n] = current_jobs[last];\n    }\n\n    pollfds.pop_back();\n    current_jobs.pop_back();\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::remove(jobs_type::size_type n)\n    {\n      // replace job with last job in poller-list\n      jobs_type::size_type last = current_jobs.size() - 1;\n  \n      if (n != last)\n      {\n        pollfds[n + 1] = pollfds[last + 1];\n        current_jobs[n] = current_jobs[last];\n      }\n  \n      pollfds.pop_back();\n      current_jobs.pop_back();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_jobs[i]->msecToTimeout",
          "args": [
            "currentTime"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "msecToTimeout",
          "container": "Job",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "62-67",
          "snippet": "int Job::msecToTimeout(time_t currentTime) const\n  {\n    return (lastAccessTime - currentTime + 1) * 1000\n         + TntConfig::it().keepAliveTimeout\n         - TntConfig::it().socketReadTimeout;\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJob {\n  int Job::msecToTimeout(time_t currentTime) const\n    {\n      return (lastAccessTime - currentTime + 1) * 1000\n           + TntConfig::it().keepAliveTimeout\n           - TntConfig::it().socketReadTimeout;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "queue.put",
          "args": [
            "current_jobs[i]"
          ],
          "line": 352
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_jobs.size",
          "args": [],
          "line": 347
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&currentTime"
          ],
          "line": 346
        },
        "resolved": true,
        "details": {
          "function_name": "livetime",
          "container": "BackgroundTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
          "lines": "148-154",
          "snippet": "void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _livetime = livetime;\n    if (_progress >= 100)\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n}",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/backgroundworker.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nBackgroundTask {\n  void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n  {\n      cxxtools::MutexLock lock(_mutex);\n      _livetime = livetime;\n      if (_progress >= 100)\n          _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::dispatch()\n    {\n      time_t currentTime;\n      time(&currentTime);\n      for (unsigned i = 0; i < current_jobs.size(); )\n      {\n        if (pollfds[i + 1].revents & POLLIN)\n        {\n          // put job into work-queue\n          queue.put(current_jobs[i]);\n          remove(i);\n        }\n        else if (pollfds[i + 1].revents != 0)\n          remove(i);\n        else\n        {\n          // check timeout\n          int msec = current_jobs[i]->msecToTimeout(currentTime);\n          if (msec <= 0)\n            remove(i);\n          else if (poll_timeout < 0 || msec < poll_timeout)\n            poll_timeout = msec;\n  \n          ++i;\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "doStop",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "338-341",
    "snippet": "void PollerImpl::doStop()\n  {\n    notify_pipe.write('A');\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "notify_pipe.write",
          "args": [
            "'A'"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::doStop()\n    {\n      notify_pipe.write('A');\n    }\n}"
  },
  {
    "function_name": "run",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "303-336",
    "snippet": "void PollerImpl::run()\n  {\n    while (!Tntnet::shouldStop())\n    {\n      usleep(100);\n      append_new_jobs();\n\n      try\n      {\n        ::poll(&pollfds[0], pollfds.size(), poll_timeout);\n        poll_timeout = -1;\n\n        if (pollfds[0].revents != 0)\n        {\n          if (Tntnet::shouldStop())\n          {\n            log_info(\"stop poller\");\n            break;\n          }\n\n          char buffer[64];\n          notify_pipe.read(buffer, sizeof(buffer));\n          pollfds[0].revents = 0;\n        }\n\n        if (current_jobs.size() > 0)\n          dispatch();\n      }\n      catch (const std::exception& e)\n      {\n        log_error(\"error in poll-loop: \" << e.what());\n      }\n    }\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_error",
          "args": [
            "\"error in poll-loop: \" << e.what()"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dispatch",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "dispatch",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "343-369",
          "snippet": "void PollerImpl::dispatch()\n  {\n    time_t currentTime;\n    time(&currentTime);\n    for (unsigned i = 0; i < current_jobs.size(); )\n    {\n      if (pollfds[i + 1].revents & POLLIN)\n      {\n        // put job into work-queue\n        queue.put(current_jobs[i]);\n        remove(i);\n      }\n      else if (pollfds[i + 1].revents != 0)\n        remove(i);\n      else\n      {\n        // check timeout\n        int msec = current_jobs[i]->msecToTimeout(currentTime);\n        if (msec <= 0)\n          remove(i);\n        else if (poll_timeout < 0 || msec < poll_timeout)\n          poll_timeout = msec;\n\n        ++i;\n      }\n    }\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::dispatch()\n    {\n      time_t currentTime;\n      time(&currentTime);\n      for (unsigned i = 0; i < current_jobs.size(); )\n      {\n        if (pollfds[i + 1].revents & POLLIN)\n        {\n          // put job into work-queue\n          queue.put(current_jobs[i]);\n          remove(i);\n        }\n        else if (pollfds[i + 1].revents != 0)\n          remove(i);\n        else\n        {\n          // check timeout\n          int msec = current_jobs[i]->msecToTimeout(currentTime);\n          if (msec <= 0)\n            remove(i);\n          else if (poll_timeout < 0 || msec < poll_timeout)\n            poll_timeout = msec;\n  \n          ++i;\n        }\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_jobs.size",
          "args": [],
          "line": 328
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "notify_pipe.read",
          "args": [
            "buffer",
            "sizeof(buffer)"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"stop poller\""
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tntnet::shouldStop",
          "args": [],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "shouldStop",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
          "lines": "126-126",
          "snippet": "static bool shouldStop()   { return stop; }",
          "includes": [
            "#include <fstream>",
            "#include <set>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/condition.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/dispatcher.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/job.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  static bool shouldStop()   { return stop; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "::poll",
          "args": [
            "&pollfds[0]",
            "pollfds.size()",
            "poll_timeout"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "append_new_jobs",
          "args": [],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "append_new_jobs",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "273-292",
          "snippet": "void PollerImpl::append_new_jobs()\n  {\n    cxxtools::MutexLock lock(mutex);\n    if (!new_jobs.empty())\n    {\n      // append new jobs to current\n      time_t currentTime;\n      time(&currentTime);\n      for (jobs_type::iterator it = new_jobs.begin();\n           it != new_jobs.end(); ++it)\n      {\n        append(*it);\n        int msec = (*it)->msecToTimeout(currentTime);\n        if (poll_timeout < 0 || msec < poll_timeout)\n          poll_timeout = msec;\n      }\n\n      new_jobs.clear();\n    }\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::append_new_jobs()\n    {\n      cxxtools::MutexLock lock(mutex);\n      if (!new_jobs.empty())\n      {\n        // append new jobs to current\n        time_t currentTime;\n        time(&currentTime);\n        for (jobs_type::iterator it = new_jobs.begin();\n             it != new_jobs.end(); ++it)\n        {\n          append(*it);\n          int msec = (*it)->msecToTimeout(currentTime);\n          if (poll_timeout < 0 || msec < poll_timeout)\n            poll_timeout = msec;\n        }\n  \n        new_jobs.clear();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "100"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::run()\n    {\n      while (!Tntnet::shouldStop())\n      {\n        usleep(100);\n        append_new_jobs();\n  \n        try\n        {\n          ::poll(&pollfds[0], pollfds.size(), poll_timeout);\n          poll_timeout = -1;\n  \n          if (pollfds[0].revents != 0)\n          {\n            if (Tntnet::shouldStop())\n            {\n              log_info(\"stop poller\");\n              break;\n            }\n  \n            char buffer[64];\n            notify_pipe.read(buffer, sizeof(buffer));\n            pollfds[0].revents = 0;\n          }\n  \n          if (current_jobs.size() > 0)\n            dispatch();\n        }\n        catch (const std::exception& e)\n        {\n          log_error(\"error in poll-loop: \" << e.what());\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "append",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "294-301",
    "snippet": "void PollerImpl::append(Jobqueue::JobPtr& job)\n  {\n    current_jobs.push_back(job);\n\n    pollfds.push_back(pollfd());\n    pollfds.back().fd = job->getFd();\n    pollfds.back().events = POLLIN;\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pollfds.back",
          "args": [],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "job->getFd",
          "args": [],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "214-217",
          "snippet": "int SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  int SslTcpjob::getFd() const\n    {\n      return socket.getFd();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pollfds.back",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollfds.push_back",
          "args": [
            "pollfd()"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollfd",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "current_jobs.push_back",
          "args": [
            "job"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::append(Jobqueue::JobPtr& job)\n    {\n      current_jobs.push_back(job);\n  \n      pollfds.push_back(pollfd());\n      pollfds.back().fd = job->getFd();\n      pollfds.back().events = POLLIN;\n    }\n}"
  },
  {
    "function_name": "append_new_jobs",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "273-292",
    "snippet": "void PollerImpl::append_new_jobs()\n  {\n    cxxtools::MutexLock lock(mutex);\n    if (!new_jobs.empty())\n    {\n      // append new jobs to current\n      time_t currentTime;\n      time(&currentTime);\n      for (jobs_type::iterator it = new_jobs.begin();\n           it != new_jobs.end(); ++it)\n      {\n        append(*it);\n        int msec = (*it)->msecToTimeout(currentTime);\n        if (poll_timeout < 0 || msec < poll_timeout)\n          poll_timeout = msec;\n      }\n\n      new_jobs.clear();\n    }\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "new_jobs.clear",
          "args": [],
          "line": 290
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "168-220",
          "snippet": "void HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::clear()\n    {\n      HttpMessage::clear();\n      body.clear();\n      methodLen = 0;\n      method[0] = '\\0';\n      url.clear();\n      queryString.clear();\n      contentSize = 0;\n      pathinfo.clear();\n      args.clear();\n      getparam.clear();\n      postparam.clear();\n      qparam.clear();\n      ct = Contenttype();\n      mp = Multipart();\n      locale_init = false;\n      if (requestScope)\n      {\n        if (requestScope->release() == 0)\n          delete requestScope;\n        requestScope = 0;\n      }\n      httpcookies.clear();\n      encodingRead = false;\n      username.clear();\n      password.clear();\n  \n      releaseLocks();\n  \n      if (applicationScope)\n      {\n        if (applicationScope->release() == 0)\n          delete applicationScope;\n        applicationScope = 0;\n      }\n  \n      if (sessionScope)\n      {\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n        sessionScope = 0;\n      }\n  \n      if (secureSessionScope)\n      {\n        if (secureSessionScope->release() == 0)\n          delete secureSessionScope;\n        secureSessionScope = 0;\n      }\n  \n      threadContext = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "currentTime"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "append",
          "args": [
            "*it"
          ],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "append",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "294-301",
          "snippet": "void PollerImpl::append(Jobqueue::JobPtr& job)\n  {\n    current_jobs.push_back(job);\n\n    pollfds.push_back(pollfd());\n    pollfds.back().fd = job->getFd();\n    pollfds.back().events = POLLIN;\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::append(Jobqueue::JobPtr& job)\n    {\n      current_jobs.push_back(job);\n  \n      pollfds.push_back(pollfd());\n      pollfds.back().fd = job->getFd();\n      pollfds.back().events = POLLIN;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_jobs.end",
          "args": [],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_jobs.begin",
          "args": [],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&currentTime"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "livetime",
          "container": "BackgroundTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
          "lines": "148-154",
          "snippet": "void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _livetime = livetime;\n    if (_progress >= 100)\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n}",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/backgroundworker.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nBackgroundTask {\n  void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n  {\n      cxxtools::MutexLock lock(_mutex);\n      _livetime = livetime;\n      if (_progress >= 100)\n          _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_jobs.empty",
          "args": [],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::append_new_jobs()\n    {\n      cxxtools::MutexLock lock(mutex);\n      if (!new_jobs.empty())\n      {\n        // append new jobs to current\n        time_t currentTime;\n        time(&currentTime);\n        for (jobs_type::iterator it = new_jobs.begin();\n             it != new_jobs.end(); ++it)\n        {\n          append(*it);\n          int msec = (*it)->msecToTimeout(currentTime);\n          if (poll_timeout < 0 || msec < poll_timeout)\n            poll_timeout = msec;\n        }\n  \n        new_jobs.clear();\n      }\n    }\n}"
  },
  {
    "function_name": "PollerImpl",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "261-271",
    "snippet": "PollerImpl::PollerImpl(Jobqueue& q)\n    : queue(q),\n      poll_timeout(-1)\n  {\n    fcntl(notify_pipe.getReadFd(), F_SETFL, O_NONBLOCK);\n\n    pollfds.push_back(pollfd());\n    pollfds.back().fd = notify_pipe.getReadFd();\n    pollfds.back().events = POLLIN;\n    pollfds.back().revents = 0;\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pollfds.back",
          "args": [],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollfds.back",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notify_pipe.getReadFd",
          "args": [],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollfds.back",
          "args": [],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollfds.push_back",
          "args": [
            "pollfd()"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollfd",
          "args": [],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "notify_pipe.getReadFd()",
            "F_SETFL",
            "O_NONBLOCK"
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notify_pipe.getReadFd",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  PollerImpl::PollerImpl(Jobqueue& q)\n      : queue(q),\n        poll_timeout(-1)\n    {\n      fcntl(notify_pipe.getReadFd(), F_SETFL, O_NONBLOCK);\n  \n      pollfds.push_back(pollfd());\n      pollfds.back().fd = notify_pipe.getReadFd();\n      pollfds.back().events = POLLIN;\n      pollfds.back().revents = 0;\n    }\n}"
  },
  {
    "function_name": "run",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "141-257",
    "snippet": "void PollerImpl::run()\n  {\n    epoll_event events[16];\n\n    time_t pollTime;\n    time(&pollTime);\n    while (!Tntnet::shouldStop())\n    {\n      usleep(100);\n\n      append_new_jobs();\n\n      if (jobs.size() == 0)\n        poll_timeout = -1;\n\n      int ret = ::epoll_wait(pollFd, events, 16, poll_timeout);\n\n      if (ret < 0)\n      {\n        if (errno != EINTR)\n          throw cxxtools::SystemError(\"epoll_wait\");\n      }\n      else if (ret == 0)\n      {\n        // timeout reached - check for timed out requests and get next timeout\n\n        poll_timeout = -1;\n        time_t currentTime;\n        time(&currentTime);\n        for (jobs_type::iterator it = jobs.begin(); it != jobs.end(); )\n        {\n          int msec = it->second->msecToTimeout(currentTime);\n          if (msec <= 0)\n          {\n            log_debug(\"timeout for fd \" << it->second->getFd() << \" reached\");\n            jobs_type::iterator it2 = it++;\n            jobs.erase(it2);\n          }\n          else\n          {\n            if (poll_timeout < 0 || msec < poll_timeout)\n              poll_timeout = msec;\n            ++it;\n          }\n        }\n      }\n      else\n      {\n        time_t currentTime;\n        time(&currentTime);\n        poll_timeout -= (currentTime - pollTime) * 1000;\n        if (poll_timeout <= 0)\n          poll_timeout = 100;\n\n        pollTime = currentTime;\n\n        // no timeout - process events\n\n        bool rebuildPollFd = false;\n\n        for (int i = 0; i < ret; ++i)\n        {\n          if (events[i].data.fd == notify_pipe.getReadFd())\n          {\n            if (Tntnet::shouldStop())\n            {\n              log_info(\"stop poller\");\n              break;\n            }\n\n            char buffer[64];\n            notify_pipe.read(buffer, sizeof(buffer));\n          }\n          else\n          {\n            jobs_type::iterator it = jobs.find(events[i].data.fd);\n            if (it == jobs.end())\n            {\n              log_fatal(\"internal error: job for fd \" << events[i].data.fd << \" not found in jobs-list\");\n              ::close(events[i].data.fd);\n              rebuildPollFd = true;\n            }\n            else\n            {\n              Jobqueue::JobPtr j = it->second;\n              int ev = events[i].events;  \n              jobs.erase(it);\n\n              if (!removeFd(events[i].data.fd))\n                rebuildPollFd = true;\n\n              if (ev & EPOLLIN)\n                queue.put(j);\n            }\n          }\n        }\n\n        if (rebuildPollFd)\n        {\n          // rebuild poll-structure\n          log_warn(\"need to rebuild poll structure\");\n          close(pollFd);\n          pollFd = ::epoll_create(256);\n          if (pollFd < 0)\n            throw cxxtools::SystemError(\"epoll_create\");\n\n          int ret = fcntl(notify_pipe.getReadFd(), F_SETFL, O_NONBLOCK);\n          if (ret < 0)\n            throw cxxtools::SystemError(\"fcntl\");\n\n          addFd(notify_pipe.getReadFd());\n          for (jobs_type::iterator it = jobs.begin(); it != jobs.end(); ++it)\n            addFd(it->first);\n        }\n      }\n    }\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addFd",
          "args": [
            "it->first"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "addFd",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "78-86",
          "snippet": "void PollerImpl::addFd(int fd)\n  {\n    epoll_event e;\n    e.events = EPOLLIN;\n    e.data.fd = fd;\n    int ret = ::epoll_ctl(pollFd, EPOLL_CTL_ADD, fd, &e);\n    if (ret < 0)\n      throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_ADD)\");\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::addFd(int fd)\n    {\n      epoll_event e;\n      e.events = EPOLLIN;\n      e.data.fd = fd;\n      int ret = ::epoll_ctl(pollFd, EPOLL_CTL_ADD, fd, &e);\n      if (ret < 0)\n        throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_ADD)\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "jobs.end",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "jobs.begin",
          "args": [],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "notify_pipe.getReadFd",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"fcntl\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "notify_pipe.getReadFd()",
            "F_SETFL",
            "O_NONBLOCK"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notify_pipe.getReadFd",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"epoll_create\""
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::epoll_create",
          "args": [
            "256"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "pollFd"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "destroy",
          "container": "Dlcloser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
          "lines": "62-66",
          "snippet": "void destroy(objectType* ptr)\n      {\n        ::dlclose(*ptr);\n        delete ptr;\n      }",
          "includes": [
            "#include <dlfcn.h>",
            "#include <utility>",
            "#include <string>",
            "#include <list>",
            "#include <map>",
            "#include <tnt/langlib.h>",
            "#include <tnt/urlmapper.h>",
            "#include <cxxtools/smartptr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nDlcloser {\n  void destroy(objectType* ptr)\n        {\n          ::dlclose(*ptr);\n          delete ptr;\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"need to rebuild poll structure\""
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue.put",
          "args": [
            "j"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "removeFd",
          "args": [
            "events[i].data.fd"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "removeFd",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "88-102",
          "snippet": "bool PollerImpl::removeFd(int fd)\n  {\n    epoll_event e;\n    e.data.fd = fd;\n    int ret = ::epoll_ctl(pollFd, EPOLL_CTL_DEL, fd, &e);\n    if (ret < 0)\n    {\n      if (errno == EBADF || errno == ENOENT)\n        return false;\n      else\n        throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_DEL)\");\n    }\n\n    return true;\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  bool PollerImpl::removeFd(int fd)\n    {\n      epoll_event e;\n      e.data.fd = fd;\n      int ret = ::epoll_ctl(pollFd, EPOLL_CTL_DEL, fd, &e);\n      if (ret < 0)\n      {\n        if (errno == EBADF || errno == ENOENT)\n          return false;\n        else\n          throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_DEL)\");\n      }\n  \n      return true;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "jobs.erase",
          "args": [
            "it"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_fatal",
          "args": [
            "\"internal error: job for fd \" << events[i].data.fd << \" not found in jobs-list\""
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.find",
          "args": [
            "events[i].data.fd"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "notify_pipe.read",
          "args": [
            "buffer",
            "sizeof(buffer)"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"stop poller\""
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tntnet::shouldStop",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "shouldStop",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
          "lines": "126-126",
          "snippet": "static bool shouldStop()   { return stop; }",
          "includes": [
            "#include <fstream>",
            "#include <set>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/condition.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/dispatcher.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/job.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  static bool shouldStop()   { return stop; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "notify_pipe.getReadFd",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&currentTime"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "livetime",
          "container": "BackgroundTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
          "lines": "148-154",
          "snippet": "void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _livetime = livetime;\n    if (_progress >= 100)\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n}",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/backgroundworker.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nBackgroundTask {\n  void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n  {\n      cxxtools::MutexLock lock(_mutex);\n      _livetime = livetime;\n      if (_progress >= 100)\n          _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"timeout for fd \" << it->second->getFd() << \" reached\""
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it->second->getFd",
          "args": [],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "214-217",
          "snippet": "int SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  int SslTcpjob::getFd() const\n    {\n      return socket.getFd();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->second->msecToTimeout",
          "args": [
            "currentTime"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "msecToTimeout",
          "container": "Job",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "62-67",
          "snippet": "int Job::msecToTimeout(time_t currentTime) const\n  {\n    return (lastAccessTime - currentTime + 1) * 1000\n         + TntConfig::it().keepAliveTimeout\n         - TntConfig::it().socketReadTimeout;\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJob {\n  int Job::msecToTimeout(time_t currentTime) const\n    {\n      return (lastAccessTime - currentTime + 1) * 1000\n           + TntConfig::it().keepAliveTimeout\n           - TntConfig::it().socketReadTimeout;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"epoll_wait\""
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::epoll_wait",
          "args": [
            "pollFd",
            "events",
            "16",
            "poll_timeout"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.size",
          "args": [],
          "line": 153
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "append_new_jobs",
          "args": [],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "append_new_jobs",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "273-292",
          "snippet": "void PollerImpl::append_new_jobs()\n  {\n    cxxtools::MutexLock lock(mutex);\n    if (!new_jobs.empty())\n    {\n      // append new jobs to current\n      time_t currentTime;\n      time(&currentTime);\n      for (jobs_type::iterator it = new_jobs.begin();\n           it != new_jobs.end(); ++it)\n      {\n        append(*it);\n        int msec = (*it)->msecToTimeout(currentTime);\n        if (poll_timeout < 0 || msec < poll_timeout)\n          poll_timeout = msec;\n      }\n\n      new_jobs.clear();\n    }\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::append_new_jobs()\n    {\n      cxxtools::MutexLock lock(mutex);\n      if (!new_jobs.empty())\n      {\n        // append new jobs to current\n        time_t currentTime;\n        time(&currentTime);\n        for (jobs_type::iterator it = new_jobs.begin();\n             it != new_jobs.end(); ++it)\n        {\n          append(*it);\n          int msec = (*it)->msecToTimeout(currentTime);\n          if (poll_timeout < 0 || msec < poll_timeout)\n            poll_timeout = msec;\n        }\n  \n        new_jobs.clear();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "100"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::run()\n    {\n      epoll_event events[16];\n  \n      time_t pollTime;\n      time(&pollTime);\n      while (!Tntnet::shouldStop())\n      {\n        usleep(100);\n  \n        append_new_jobs();\n  \n        if (jobs.size() == 0)\n          poll_timeout = -1;\n  \n        int ret = ::epoll_wait(pollFd, events, 16, poll_timeout);\n  \n        if (ret < 0)\n        {\n          if (errno != EINTR)\n            throw cxxtools::SystemError(\"epoll_wait\");\n        }\n        else if (ret == 0)\n        {\n          // timeout reached - check for timed out requests and get next timeout\n  \n          poll_timeout = -1;\n          time_t currentTime;\n          time(&currentTime);\n          for (jobs_type::iterator it = jobs.begin(); it != jobs.end(); )\n          {\n            int msec = it->second->msecToTimeout(currentTime);\n            if (msec <= 0)\n            {\n              log_debug(\"timeout for fd \" << it->second->getFd() << \" reached\");\n              jobs_type::iterator it2 = it++;\n              jobs.erase(it2);\n            }\n            else\n            {\n              if (poll_timeout < 0 || msec < poll_timeout)\n                poll_timeout = msec;\n              ++it;\n            }\n          }\n        }\n        else\n        {\n          time_t currentTime;\n          time(&currentTime);\n          poll_timeout -= (currentTime - pollTime) * 1000;\n          if (poll_timeout <= 0)\n            poll_timeout = 100;\n  \n          pollTime = currentTime;\n  \n          // no timeout - process events\n  \n          bool rebuildPollFd = false;\n  \n          for (int i = 0; i < ret; ++i)\n          {\n            if (events[i].data.fd == notify_pipe.getReadFd())\n            {\n              if (Tntnet::shouldStop())\n              {\n                log_info(\"stop poller\");\n                break;\n              }\n  \n              char buffer[64];\n              notify_pipe.read(buffer, sizeof(buffer));\n            }\n            else\n            {\n              jobs_type::iterator it = jobs.find(events[i].data.fd);\n              if (it == jobs.end())\n              {\n                log_fatal(\"internal error: job for fd \" << events[i].data.fd << \" not found in jobs-list\");\n                ::close(events[i].data.fd);\n                rebuildPollFd = true;\n              }\n              else\n              {\n                Jobqueue::JobPtr j = it->second;\n                int ev = events[i].events;  \n                jobs.erase(it);\n  \n                if (!removeFd(events[i].data.fd))\n                  rebuildPollFd = true;\n  \n                if (ev & EPOLLIN)\n                  queue.put(j);\n              }\n            }\n          }\n  \n          if (rebuildPollFd)\n          {\n            // rebuild poll-structure\n            log_warn(\"need to rebuild poll structure\");\n            close(pollFd);\n            pollFd = ::epoll_create(256);\n            if (pollFd < 0)\n              throw cxxtools::SystemError(\"epoll_create\");\n  \n            int ret = fcntl(notify_pipe.getReadFd(), F_SETFL, O_NONBLOCK);\n            if (ret < 0)\n              throw cxxtools::SystemError(\"fcntl\");\n  \n            addFd(notify_pipe.getReadFd());\n            for (jobs_type::iterator it = jobs.begin(); it != jobs.end(); ++it)\n              addFd(it->first);\n          }\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "append_new_jobs",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "116-139",
    "snippet": "void PollerImpl::append_new_jobs()\n  {\n    cxxtools::MutexLock lock(mutex);\n    if (!new_jobs.empty())\n    {\n      // append new jobs to current\n      time_t currentTime;\n      time(&currentTime);\n      for (new_jobs_type::iterator it = new_jobs.begin();\n           it != new_jobs.end(); ++it)\n      {\n        addFd((*it)->getFd());\n        jobs[(*it)->getFd()] = *it;\n\n        int msec = (*it)->msecToTimeout(currentTime);\n        if (poll_timeout < 0)\n          poll_timeout = msec;\n        else if (msec < poll_timeout)\n          poll_timeout = msec;\n      }\n\n      new_jobs.clear();\n    }\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "new_jobs.clear",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "168-220",
          "snippet": "void HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::clear()\n    {\n      HttpMessage::clear();\n      body.clear();\n      methodLen = 0;\n      method[0] = '\\0';\n      url.clear();\n      queryString.clear();\n      contentSize = 0;\n      pathinfo.clear();\n      args.clear();\n      getparam.clear();\n      postparam.clear();\n      qparam.clear();\n      ct = Contenttype();\n      mp = Multipart();\n      locale_init = false;\n      if (requestScope)\n      {\n        if (requestScope->release() == 0)\n          delete requestScope;\n        requestScope = 0;\n      }\n      httpcookies.clear();\n      encodingRead = false;\n      username.clear();\n      password.clear();\n  \n      releaseLocks();\n  \n      if (applicationScope)\n      {\n        if (applicationScope->release() == 0)\n          delete applicationScope;\n        applicationScope = 0;\n      }\n  \n      if (sessionScope)\n      {\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n        sessionScope = 0;\n      }\n  \n      if (secureSessionScope)\n      {\n        if (secureSessionScope->release() == 0)\n          delete secureSessionScope;\n        secureSessionScope = 0;\n      }\n  \n      threadContext = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "currentTime"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "addFd",
          "args": [
            "(*it)->getFd()"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "addFd",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "78-86",
          "snippet": "void PollerImpl::addFd(int fd)\n  {\n    epoll_event e;\n    e.events = EPOLLIN;\n    e.data.fd = fd;\n    int ret = ::epoll_ctl(pollFd, EPOLL_CTL_ADD, fd, &e);\n    if (ret < 0)\n      throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_ADD)\");\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::addFd(int fd)\n    {\n      epoll_event e;\n      e.events = EPOLLIN;\n      e.data.fd = fd;\n      int ret = ::epoll_ctl(pollFd, EPOLL_CTL_ADD, fd, &e);\n      if (ret < 0)\n        throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_ADD)\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_jobs.end",
          "args": [],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_jobs.begin",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&currentTime"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "livetime",
          "container": "BackgroundTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
          "lines": "148-154",
          "snippet": "void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _livetime = livetime;\n    if (_progress >= 100)\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n}",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/backgroundworker.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nBackgroundTask {\n  void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n  {\n      cxxtools::MutexLock lock(_mutex);\n      _livetime = livetime;\n      if (_progress >= 100)\n          _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_jobs.empty",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::append_new_jobs()\n    {\n      cxxtools::MutexLock lock(mutex);\n      if (!new_jobs.empty())\n      {\n        // append new jobs to current\n        time_t currentTime;\n        time(&currentTime);\n        for (new_jobs_type::iterator it = new_jobs.begin();\n             it != new_jobs.end(); ++it)\n        {\n          addFd((*it)->getFd());\n          jobs[(*it)->getFd()] = *it;\n  \n          int msec = (*it)->msecToTimeout(currentTime);\n          if (poll_timeout < 0)\n            poll_timeout = msec;\n          else if (msec < poll_timeout)\n            poll_timeout = msec;\n        }\n  \n        new_jobs.clear();\n      }\n    }\n}"
  },
  {
    "function_name": "addIdleJob",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "109-114",
    "snippet": "void PollerImpl::addIdleJob(Jobqueue::JobPtr job)\n  {\n    cxxtools::MutexLock lock(mutex);\n    new_jobs.push_back(job);\n    notify_pipe.write('A');\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "notify_pipe.write",
          "args": [
            "'A'"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "new_jobs.push_back",
          "args": [
            "job"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::addIdleJob(Jobqueue::JobPtr job)\n    {\n      cxxtools::MutexLock lock(mutex);\n      new_jobs.push_back(job);\n      notify_pipe.write('A');\n    }\n}"
  },
  {
    "function_name": "doStop",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "104-107",
    "snippet": "void PollerImpl::doStop()\n  {\n    notify_pipe.write('A');\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "notify_pipe.write",
          "args": [
            "'A'"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::doStop()\n    {\n      notify_pipe.write('A');\n    }\n}"
  },
  {
    "function_name": "removeFd",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "88-102",
    "snippet": "bool PollerImpl::removeFd(int fd)\n  {\n    epoll_event e;\n    e.data.fd = fd;\n    int ret = ::epoll_ctl(pollFd, EPOLL_CTL_DEL, fd, &e);\n    if (ret < 0)\n    {\n      if (errno == EBADF || errno == ENOENT)\n        return false;\n      else\n        throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_DEL)\");\n    }\n\n    return true;\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"epoll_ctl(EPOLL_CTL_DEL)\""
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::epoll_ctl",
          "args": [
            "pollFd",
            "EPOLL_CTL_DEL",
            "fd",
            "&e"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  bool PollerImpl::removeFd(int fd)\n    {\n      epoll_event e;\n      e.data.fd = fd;\n      int ret = ::epoll_ctl(pollFd, EPOLL_CTL_DEL, fd, &e);\n      if (ret < 0)\n      {\n        if (errno == EBADF || errno == ENOENT)\n          return false;\n        else\n          throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_DEL)\");\n      }\n  \n      return true;\n    }\n}"
  },
  {
    "function_name": "addFd",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "78-86",
    "snippet": "void PollerImpl::addFd(int fd)\n  {\n    epoll_event e;\n    e.events = EPOLLIN;\n    e.data.fd = fd;\n    int ret = ::epoll_ctl(pollFd, EPOLL_CTL_ADD, fd, &e);\n    if (ret < 0)\n      throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_ADD)\");\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"epoll_ctl(EPOLL_CTL_ADD)\""
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::epoll_ctl",
          "args": [
            "pollFd",
            "EPOLL_CTL_ADD",
            "fd",
            "&e"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::addFd(int fd)\n    {\n      epoll_event e;\n      e.events = EPOLLIN;\n      e.data.fd = fd;\n      int ret = ::epoll_ctl(pollFd, EPOLL_CTL_ADD, fd, &e);\n      if (ret < 0)\n        throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_ADD)\");\n    }\n}"
  },
  {
    "function_name": "~PollerImpl",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "73-76",
    "snippet": "PollerImpl::~PollerImpl()\n  {\n    close(pollFd);\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "pollFd"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "destroy",
          "container": "Dlcloser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
          "lines": "62-66",
          "snippet": "void destroy(objectType* ptr)\n      {\n        ::dlclose(*ptr);\n        delete ptr;\n      }",
          "includes": [
            "#include <dlfcn.h>",
            "#include <utility>",
            "#include <string>",
            "#include <list>",
            "#include <map>",
            "#include <tnt/langlib.h>",
            "#include <tnt/urlmapper.h>",
            "#include <cxxtools/smartptr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nDlcloser {\n  void destroy(objectType* ptr)\n        {\n          ::dlclose(*ptr);\n          delete ptr;\n        }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  PollerImpl::~PollerImpl()\n    {\n      close(pollFd);\n    }\n}"
  },
  {
    "function_name": "PollerImpl",
    "container": "PollerImpl",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "61-71",
    "snippet": "PollerImpl::PollerImpl(Jobqueue& q)\n    : queue(q),\n      pollFd(-1)\n  {\n    pollFd = ::epoll_create(256);\n    if (pollFd < 0)\n      throw cxxtools::SystemError(\"epoll_create\");\n\n    fcntl(notify_pipe.getReadFd(), F_SETFL, O_NONBLOCK);\n    addFd(notify_pipe.getReadFd());\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "addFd",
          "args": [
            "notify_pipe.getReadFd()"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "addFd",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "78-86",
          "snippet": "void PollerImpl::addFd(int fd)\n  {\n    epoll_event e;\n    e.events = EPOLLIN;\n    e.data.fd = fd;\n    int ret = ::epoll_ctl(pollFd, EPOLL_CTL_ADD, fd, &e);\n    if (ret < 0)\n      throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_ADD)\");\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::addFd(int fd)\n    {\n      epoll_event e;\n      e.events = EPOLLIN;\n      e.data.fd = fd;\n      int ret = ::epoll_ctl(pollFd, EPOLL_CTL_ADD, fd, &e);\n      if (ret < 0)\n        throw cxxtools::SystemError(\"epoll_ctl(EPOLL_CTL_ADD)\");\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "notify_pipe.getReadFd",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "notify_pipe.getReadFd()",
            "F_SETFL",
            "O_NONBLOCK"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notify_pipe.getReadFd",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"epoll_create\""
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::epoll_create",
          "args": [
            "256"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  PollerImpl::PollerImpl(Jobqueue& q)\n      : queue(q),\n        pollFd(-1)\n    {\n      pollFd = ::epoll_create(256);\n      if (pollFd < 0)\n        throw cxxtools::SystemError(\"epoll_create\");\n  \n      fcntl(notify_pipe.getReadFd(), F_SETFL, O_NONBLOCK);\n      addFd(notify_pipe.getReadFd());\n    }\n}"
  },
  {
    "function_name": "run",
    "container": "Poller",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "54-57",
    "snippet": "void Poller::run()\n  {\n    impl->run();\n  }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "impl->run",
          "args": [],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "run",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "303-336",
          "snippet": "void PollerImpl::run()\n  {\n    while (!Tntnet::shouldStop())\n    {\n      usleep(100);\n      append_new_jobs();\n\n      try\n      {\n        ::poll(&pollfds[0], pollfds.size(), poll_timeout);\n        poll_timeout = -1;\n\n        if (pollfds[0].revents != 0)\n        {\n          if (Tntnet::shouldStop())\n          {\n            log_info(\"stop poller\");\n            break;\n          }\n\n          char buffer[64];\n          notify_pipe.read(buffer, sizeof(buffer));\n          pollfds[0].revents = 0;\n        }\n\n        if (current_jobs.size() > 0)\n          dispatch();\n      }\n      catch (const std::exception& e)\n      {\n        log_error(\"error in poll-loop: \" << e.what());\n      }\n    }\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::run()\n    {\n      while (!Tntnet::shouldStop())\n      {\n        usleep(100);\n        append_new_jobs();\n  \n        try\n        {\n          ::poll(&pollfds[0], pollfds.size(), poll_timeout);\n          poll_timeout = -1;\n  \n          if (pollfds[0].revents != 0)\n          {\n            if (Tntnet::shouldStop())\n            {\n              log_info(\"stop poller\");\n              break;\n            }\n  \n            char buffer[64];\n            notify_pipe.read(buffer, sizeof(buffer));\n            pollfds[0].revents = 0;\n          }\n  \n          if (current_jobs.size() > 0)\n            dispatch();\n        }\n        catch (const std::exception& e)\n        {\n          log_error(\"error in poll-loop: \" << e.what());\n        }\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPoller {\n  void Poller::run()\n    {\n      impl->run();\n    }\n}"
  },
  {
    "function_name": "Poller",
    "container": "Poller",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "50-52",
    "snippet": "Poller::Poller(Jobqueue& q)\n    : impl(new PollerImpl(q))\n  { }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPoller {\n  Poller::Poller(Jobqueue& q)\n      : impl(new PollerImpl(q))\n    { }\n}"
  },
  {
    "function_name": "~PollerIf",
    "container": "PollerIf",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
    "lines": "47-48",
    "snippet": "PollerIf::~PollerIf()\n  { }",
    "includes": [
      "#include <errno.h>",
      "#include <sys/epoll.h>",
      "#include <fcntl.h>",
      "#include <unistd.h>",
      "#include <ios>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/pollerimpl.h\"",
      "#include \"tnt/poller.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerIf {\n  PollerIf::~PollerIf()\n    { }\n}"
  }
]