[
  {
    "function_name": "Process::restart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "357-361",
    "snippet": "void Process::restart()\n  {\n    exitRestart = true;\n    doShutdown();\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "doShutdown",
          "args": [],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "TntnetProcess::doShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "214-217",
          "snippet": "void TntnetProcess::doShutdown()\n  {\n    tnt::Tntnet::shutdown();\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <sstream>",
            "#include <glob.h>",
            "#include <set>",
            "#include <stdexcept>",
            "#include <iostream>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/jsondeserializer.h>",
            "#include <cxxtools/xml/xmldeserializer.h>",
            "#include <cxxtools/arg.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/cmd.h\"",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nvoid TntnetProcess::doShutdown()\n  {\n    tnt::Tntnet::shutdown();\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid Process::restart()\n  {\n    exitRestart = true;\n    doShutdown();\n  }"
  },
  {
    "function_name": "Process::shutdown",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "352-355",
    "snippet": "void Process::shutdown()\n  {\n    doShutdown();\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "doShutdown",
          "args": [],
          "line": 354
        },
        "resolved": true,
        "details": {
          "function_name": "TntnetProcess::doShutdown",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "214-217",
          "snippet": "void TntnetProcess::doShutdown()\n  {\n    tnt::Tntnet::shutdown();\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <sstream>",
            "#include <glob.h>",
            "#include <set>",
            "#include <stdexcept>",
            "#include <iostream>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/jsondeserializer.h>",
            "#include <cxxtools/xml/xmldeserializer.h>",
            "#include <cxxtools/arg.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/cmd.h\"",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nvoid TntnetProcess::doShutdown()\n  {\n    tnt::Tntnet::shutdown();\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid Process::shutdown()\n  {\n    doShutdown();\n  }"
  },
  {
    "function_name": "Process::run",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "312-350",
    "snippet": "void Process::run()\n  {\n    if (tnt::TntConfig::it().daemon)\n    {\n      log_debug(\"run daemon-mode\");\n\n      // We receive the writing-end of the notify pipe.\n      // After successful initialization we need to write a byte to this fd.\n      cxxtools::posix::Pipe mainPipe;\n      cxxtools::posix::Fork fork;\n      if (fork.parent())\n      {\n        log_debug(\"close write-fd of main-pipe\");\n        mainPipe.closeWriteFd();\n\n        log_debug(\"wait for child to initialize\");\n        mainPipe.read();\n\n        log_debug(\"child initialized\");\n\n        fork.setNowait();\n      }\n      else\n      {\n        log_debug(\"close read-fd of main-pipe\");\n        mainPipe.closeReadFd();\n\n        runMonitor(mainPipe);\n      }\n    }\n    else\n    {\n      log_debug(\"run\");\n      initWorker();\n\n      log_debug(\"do work\");\n      doWork();\n    }\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "doWork",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "TntnetProcess::doWork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "206-212",
          "snippet": "void TntnetProcess::doWork()\n  {\n    if (!logall)\n      initializeLogging();\n\n    tntnet.run();\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <sstream>",
            "#include <glob.h>",
            "#include <set>",
            "#include <stdexcept>",
            "#include <iostream>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/jsondeserializer.h>",
            "#include <cxxtools/xml/xmldeserializer.h>",
            "#include <cxxtools/arg.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/cmd.h\"",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nvoid TntnetProcess::doWork()\n  {\n    if (!logall)\n      initializeLogging();\n\n    tntnet.run();\n  }"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"do work\""
          ],
          "line": 347
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initWorker",
          "args": [],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "Process::initWorker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "276-310",
          "snippet": "void Process::initWorker()\n  {\n    log_debug(\"init worker\");\n\n    log_debug(\"onInit\");\n    onInit();\n\n    if (!tnt::TntConfig::it().group.empty())\n    {\n      log_debug(\"set group to \\\"\" << tnt::TntConfig::it().group << '\"');\n      ::setGroup(tnt::TntConfig::it().group);\n    }\n\n    if (!tnt::TntConfig::it().user.empty())\n    {\n      log_debug(\"set user to \\\"\" << tnt::TntConfig::it().user << '\"');\n      ::setUser(tnt::TntConfig::it().user);\n    }\n\n    if (!tnt::TntConfig::it().dir.empty())\n    {\n      log_debug(\"set dir to \\\"\" << tnt::TntConfig::it().dir << '\"');\n      ::setDir(tnt::TntConfig::it().dir);\n    }\n\n    if (!tnt::TntConfig::it().chrootdir.empty())\n    {\n      log_debug(\"change root to \\\"\" << tnt::TntConfig::it().chrootdir << '\"');\n      ::setRootdir(tnt::TntConfig::it().chrootdir);\n    }\n\n    signal(SIGTERM, sigEnd);\n    signal(SIGINT, sigEnd);\n    signal(SIGHUP, sigReload);\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid Process::initWorker()\n  {\n    log_debug(\"init worker\");\n\n    log_debug(\"onInit\");\n    onInit();\n\n    if (!tnt::TntConfig::it().group.empty())\n    {\n      log_debug(\"set group to \\\"\" << tnt::TntConfig::it().group << '\"');\n      ::setGroup(tnt::TntConfig::it().group);\n    }\n\n    if (!tnt::TntConfig::it().user.empty())\n    {\n      log_debug(\"set user to \\\"\" << tnt::TntConfig::it().user << '\"');\n      ::setUser(tnt::TntConfig::it().user);\n    }\n\n    if (!tnt::TntConfig::it().dir.empty())\n    {\n      log_debug(\"set dir to \\\"\" << tnt::TntConfig::it().dir << '\"');\n      ::setDir(tnt::TntConfig::it().dir);\n    }\n\n    if (!tnt::TntConfig::it().chrootdir.empty())\n    {\n      log_debug(\"change root to \\\"\" << tnt::TntConfig::it().chrootdir << '\"');\n      ::setRootdir(tnt::TntConfig::it().chrootdir);\n    }\n\n    signal(SIGTERM, sigEnd);\n    signal(SIGINT, sigEnd);\n    signal(SIGHUP, sigReload);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"run\""
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "runMonitor",
          "args": [
            "mainPipe"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainPipe.closeReadFd",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"close read-fd of main-pipe\""
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fork.setNowait",
          "args": [],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"child initialized\""
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainPipe.read",
          "args": [],
          "line": 328
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"wait for child to initialize\""
          ],
          "line": 327
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainPipe.closeWriteFd",
          "args": [],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"close write-fd of main-pipe\""
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fork.parent",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"run daemon-mode\""
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 314
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid Process::run()\n  {\n    if (tnt::TntConfig::it().daemon)\n    {\n      log_debug(\"run daemon-mode\");\n\n      // We receive the writing-end of the notify pipe.\n      // After successful initialization we need to write a byte to this fd.\n      cxxtools::posix::Pipe mainPipe;\n      cxxtools::posix::Fork fork;\n      if (fork.parent())\n      {\n        log_debug(\"close write-fd of main-pipe\");\n        mainPipe.closeWriteFd();\n\n        log_debug(\"wait for child to initialize\");\n        mainPipe.read();\n\n        log_debug(\"child initialized\");\n\n        fork.setNowait();\n      }\n      else\n      {\n        log_debug(\"close read-fd of main-pipe\");\n        mainPipe.closeReadFd();\n\n        runMonitor(mainPipe);\n      }\n    }\n    else\n    {\n      log_debug(\"run\");\n      initWorker();\n\n      log_debug(\"do work\");\n      doWork();\n    }\n  }"
  },
  {
    "function_name": "Process::initWorker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "276-310",
    "snippet": "void Process::initWorker()\n  {\n    log_debug(\"init worker\");\n\n    log_debug(\"onInit\");\n    onInit();\n\n    if (!tnt::TntConfig::it().group.empty())\n    {\n      log_debug(\"set group to \\\"\" << tnt::TntConfig::it().group << '\"');\n      ::setGroup(tnt::TntConfig::it().group);\n    }\n\n    if (!tnt::TntConfig::it().user.empty())\n    {\n      log_debug(\"set user to \\\"\" << tnt::TntConfig::it().user << '\"');\n      ::setUser(tnt::TntConfig::it().user);\n    }\n\n    if (!tnt::TntConfig::it().dir.empty())\n    {\n      log_debug(\"set dir to \\\"\" << tnt::TntConfig::it().dir << '\"');\n      ::setDir(tnt::TntConfig::it().dir);\n    }\n\n    if (!tnt::TntConfig::it().chrootdir.empty())\n    {\n      log_debug(\"change root to \\\"\" << tnt::TntConfig::it().chrootdir << '\"');\n      ::setRootdir(tnt::TntConfig::it().chrootdir);\n    }\n\n    signal(SIGTERM, sigEnd);\n    signal(SIGINT, sigEnd);\n    signal(SIGHUP, sigReload);\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "signal",
          "args": [
            "SIGHUP",
            "sigReload"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signal",
          "args": [
            "SIGINT",
            "sigEnd"
          ],
          "line": 308
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signal",
          "args": [
            "SIGTERM",
            "sigEnd"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::setRootdir",
          "args": [
            "tnt::TntConfig::it().chrootdir"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "setRootdir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "95-99",
          "snippet": "void setRootdir(const std::string& dir)\n  {\n    if (!::chroot(dir.c_str()) == -1)\n      throw cxxtools::SystemError(\"chroot\");\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid setRootdir(const std::string& dir)\n  {\n    if (!::chroot(dir.c_str()) == -1)\n      throw cxxtools::SystemError(\"chroot\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"change root to \\\"\" << tnt::TntConfig::it().chrootdir << '\"'"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::setDir",
          "args": [
            "tnt::TntConfig::it().dir"
          ],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "setDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "88-93",
          "snippet": "void setDir(const std::string& dir)\n  {\n    log_debug(\"chdir(\" << dir << ')');\n    if (::chdir(dir.c_str()) == -1)\n      throw cxxtools::SystemError(\"chdir\");\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid setDir(const std::string& dir)\n  {\n    log_debug(\"chdir(\" << dir << ')');\n    if (::chdir(dir.c_str()) == -1)\n      throw cxxtools::SystemError(\"chdir\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"set dir to \\\"\" << tnt::TntConfig::it().dir << '\"'"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::setUser",
          "args": [
            "tnt::TntConfig::it().user"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "setUser",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "75-86",
          "snippet": "void setUser(const std::string& user)\n  {\n    struct passwd * pw = getpwnam(user.c_str());\n    if (pw == 0)\n      throw std::runtime_error(\"unknown user \" + user);\n\n    log_debug(\"change user to \" << user << '(' << pw->pw_uid << ')');\n\n    int ret = ::setuid(pw->pw_uid);\n    if (ret != 0)\n      throw cxxtools::SystemError(\"getuid\");\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid setUser(const std::string& user)\n  {\n    struct passwd * pw = getpwnam(user.c_str());\n    if (pw == 0)\n      throw std::runtime_error(\"unknown user \" + user);\n\n    log_debug(\"change user to \" << user << '(' << pw->pw_uid << ')');\n\n    int ret = ::setuid(pw->pw_uid);\n    if (ret != 0)\n      throw cxxtools::SystemError(\"getuid\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"set user to \\\"\" << tnt::TntConfig::it().user << '\"'"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::setGroup",
          "args": [
            "tnt::TntConfig::it().group"
          ],
          "line": 286
        },
        "resolved": true,
        "details": {
          "function_name": "setGroup",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "62-73",
          "snippet": "void setGroup(const std::string& group)\n  {\n    struct group * gr = ::getgrnam(group.c_str());\n    if (gr == 0)\n      throw std::runtime_error(\"unknown group \" + group);\n\n    log_debug(\"change group to \" << group << '(' << gr->gr_gid << ')');\n\n    int ret = ::setgid(gr->gr_gid);\n    if (ret != 0)\n      throw cxxtools::SystemError(\"setgid\");\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid setGroup(const std::string& group)\n  {\n    struct group * gr = ::getgrnam(group.c_str());\n    if (gr == 0)\n      throw std::runtime_error(\"unknown group \" + group);\n\n    log_debug(\"change group to \" << group << '(' << gr->gr_gid << ')');\n\n    int ret = ::setgid(gr->gr_gid);\n    if (ret != 0)\n      throw cxxtools::SystemError(\"setgid\");\n  }"
        }
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"set group to \\\"\" << tnt::TntConfig::it().group << '\"'"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onInit",
          "args": [],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "TntnetProcess::onInit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "201-204",
          "snippet": "void TntnetProcess::onInit()\n  {\n    tntnet.init(TntConfig::it());\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <sstream>",
            "#include <glob.h>",
            "#include <set>",
            "#include <stdexcept>",
            "#include <iostream>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/jsondeserializer.h>",
            "#include <cxxtools/xml/xmldeserializer.h>",
            "#include <cxxtools/arg.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/cmd.h\"",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nvoid TntnetProcess::onInit()\n  {\n    tntnet.init(TntConfig::it());\n  }"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"onInit\""
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"init worker\""
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid Process::initWorker()\n  {\n    log_debug(\"init worker\");\n\n    log_debug(\"onInit\");\n    onInit();\n\n    if (!tnt::TntConfig::it().group.empty())\n    {\n      log_debug(\"set group to \\\"\" << tnt::TntConfig::it().group << '\"');\n      ::setGroup(tnt::TntConfig::it().group);\n    }\n\n    if (!tnt::TntConfig::it().user.empty())\n    {\n      log_debug(\"set user to \\\"\" << tnt::TntConfig::it().user << '\"');\n      ::setUser(tnt::TntConfig::it().user);\n    }\n\n    if (!tnt::TntConfig::it().dir.empty())\n    {\n      log_debug(\"set dir to \\\"\" << tnt::TntConfig::it().dir << '\"');\n      ::setDir(tnt::TntConfig::it().dir);\n    }\n\n    if (!tnt::TntConfig::it().chrootdir.empty())\n    {\n      log_debug(\"change root to \\\"\" << tnt::TntConfig::it().chrootdir << '\"');\n      ::setRootdir(tnt::TntConfig::it().chrootdir);\n    }\n\n    signal(SIGTERM, sigEnd);\n    signal(SIGINT, sigEnd);\n    signal(SIGHUP, sigReload);\n  }"
  },
  {
    "function_name": "Process::runMonitor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "182-274",
    "snippet": "void Process::runMonitor(cxxtools::posix::Pipe& mainPipe)\n  {\n    log_debug(\"run monitor\");\n\n    // setsid\n    if (setsid() == -1)\n      throw cxxtools::SystemError(\"setsid\");\n\n    bool first = true;\n\n    while (true)\n    {\n      cxxtools::posix::Pipe monitorPipe;\n\n      cxxtools::posix::Fork fork;\n\n      if (fork.child())\n      {\n        // worker-process\n\n        log_debug(\"close read-fd of monitor-pipe\");\n        monitorPipe.closeReadFd();\n\n        initWorker();\n        if (first)\n        {\n          log_debug(\"signal initialization ready\");\n          mainPipe.write('1');\n          log_debug(\"close write-fd of main-pipe\");\n          mainPipe.closeWriteFd();\n        }\n\n        log_debug(\"close standard-handles\");\n        closeStdHandles(tnt::TntConfig::it().errorLog);\n\n        exitRestart = false;\n        log_debug(\"do work\");\n        doWork();\n\n        // normal shutdown\n        if (exitRestart)\n          log_debug(\"restart\");\n        else\n        {\n          log_debug(\"signal shutdown\");\n          try\n          {\n            monitorPipe.write('s');\n          }\n          catch (const std::exception& e)\n          {\n            log_debug(\"ingore exception from monitor pipe: \" << e.what());\n          }\n        }\n        return;\n      }\n\n      // monitor-process\n\n      log_debug(\"write pid \" << fork.getPid() << \" to \\\"\" << tnt::TntConfig::it().pidfile << '\"');\n      PidFile p(tnt::TntConfig::it().pidfile, fork.getPid());\n\n      if (first)\n      {\n        log_debug(\"close standard-handles\");\n        closeStdHandles();\n        first = false;\n      }\n\n      monitorPipe.closeWriteFd();\n      try\n      {\n        log_debug(\"monitor child\");\n        char dummy;\n        size_t c = monitorPipe.read(&dummy, 1);\n        if (c > 0)\n        {\n          log_debug(\"child terminated normally\");\n          return;\n        }\n        log_debug(\"nothing read from monitor-pipe - restart child\");\n      }\n      catch (const cxxtools::SystemError&)\n      {\n        log_debug(\"child exited without notification\");\n      }\n\n      log_debug(\"wait for child-termination\");\n      fork.wait();\n\n      ::sleep(1);\n    }\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::sleep",
          "args": [
            "1"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fork.wait",
          "args": [],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"wait for child-termination\""
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"child exited without notification\""
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"nothing read from monitor-pipe - restart child\""
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"child terminated normally\""
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "monitorPipe.read",
          "args": [
            "&dummy",
            "1"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"monitor child\""
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "monitorPipe.closeWriteFd",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "closeStdHandles",
          "args": [],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "closeStdHandles",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "152-165",
          "snippet": "void closeStdHandles(const std::string& errorLog = std::string())\n  {\n    if (::freopen(\"/dev/null\", \"r\", stdin) == 0)\n      throw cxxtools::SystemError(\"freopen(stdin)\");\n\n    if (::freopen(\"/dev/null\", \"w\", stdout) == 0)\n      throw cxxtools::SystemError(\"freopen(stdout)\");\n\n    if (!errorLog.empty())\n    {\n      if (::freopen(errorLog.c_str(), \"a+\", stderr) == 0)\n        throw cxxtools::SystemError(\"freopen(stderr)\");\n    }\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid closeStdHandles(const std::string& errorLog = std::string())\n  {\n    if (::freopen(\"/dev/null\", \"r\", stdin) == 0)\n      throw cxxtools::SystemError(\"freopen(stdin)\");\n\n    if (::freopen(\"/dev/null\", \"w\", stdout) == 0)\n      throw cxxtools::SystemError(\"freopen(stdout)\");\n\n    if (!errorLog.empty())\n    {\n      if (::freopen(errorLog.c_str(), \"a+\", stderr) == 0)\n        throw cxxtools::SystemError(\"freopen(stderr)\");\n    }\n  }"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"close standard-handles\""
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fork.getPid",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"write pid \" << fork.getPid() << \" to \\\"\" << tnt::TntConfig::it().pidfile << '\"'"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fork.getPid",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"ingore exception from monitor pipe: \" << e.what()"
          ],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "monitorPipe.write",
          "args": [
            "'s'"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"signal shutdown\""
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"restart\""
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "doWork",
          "args": [],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "TntnetProcess::doWork",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/main.cpp",
          "lines": "206-212",
          "snippet": "void TntnetProcess::doWork()\n  {\n    if (!logall)\n      initializeLogging();\n\n    tntnet.run();\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <sstream>",
            "#include <glob.h>",
            "#include <set>",
            "#include <stdexcept>",
            "#include <iostream>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/jsondeserializer.h>",
            "#include <cxxtools/xml/xmldeserializer.h>",
            "#include <cxxtools/arg.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/cmd.h\"",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <sstream>\n#include <glob.h>\n#include <set>\n#include <stdexcept>\n#include <iostream>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <cxxtools/jsondeserializer.h>\n#include <cxxtools/xml/xmldeserializer.h>\n#include <cxxtools/arg.h>\n#include <cxxtools/log.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/cmd.h\"\n#include \"tnt/tntnet.h\"\n#include \"tnt/process.h\"\n\nvoid TntnetProcess::doWork()\n  {\n    if (!logall)\n      initializeLogging();\n\n    tntnet.run();\n  }"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"do work\""
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "closeStdHandles",
          "args": [
            "tnt::TntConfig::it().errorLog"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt::TntConfig::it",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"close standard-handles\""
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainPipe.closeWriteFd",
          "args": [],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"close write-fd of main-pipe\""
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mainPipe.write",
          "args": [
            "'1'"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"signal initialization ready\""
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initWorker",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "Process::initWorker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
          "lines": "276-310",
          "snippet": "void Process::initWorker()\n  {\n    log_debug(\"init worker\");\n\n    log_debug(\"onInit\");\n    onInit();\n\n    if (!tnt::TntConfig::it().group.empty())\n    {\n      log_debug(\"set group to \\\"\" << tnt::TntConfig::it().group << '\"');\n      ::setGroup(tnt::TntConfig::it().group);\n    }\n\n    if (!tnt::TntConfig::it().user.empty())\n    {\n      log_debug(\"set user to \\\"\" << tnt::TntConfig::it().user << '\"');\n      ::setUser(tnt::TntConfig::it().user);\n    }\n\n    if (!tnt::TntConfig::it().dir.empty())\n    {\n      log_debug(\"set dir to \\\"\" << tnt::TntConfig::it().dir << '\"');\n      ::setDir(tnt::TntConfig::it().dir);\n    }\n\n    if (!tnt::TntConfig::it().chrootdir.empty())\n    {\n      log_debug(\"change root to \\\"\" << tnt::TntConfig::it().chrootdir << '\"');\n      ::setRootdir(tnt::TntConfig::it().chrootdir);\n    }\n\n    signal(SIGTERM, sigEnd);\n    signal(SIGINT, sigEnd);\n    signal(SIGHUP, sigReload);\n  }",
          "includes": [
            "#include <signal.h>",
            "#include <errno.h>",
            "#include <fstream>",
            "#include <vector>",
            "#include <cxxtools/log.h>",
            "#include <grp.h>",
            "#include <pwd.h>",
            "#include <cxxtools/posix/fork.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/process.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid Process::initWorker()\n  {\n    log_debug(\"init worker\");\n\n    log_debug(\"onInit\");\n    onInit();\n\n    if (!tnt::TntConfig::it().group.empty())\n    {\n      log_debug(\"set group to \\\"\" << tnt::TntConfig::it().group << '\"');\n      ::setGroup(tnt::TntConfig::it().group);\n    }\n\n    if (!tnt::TntConfig::it().user.empty())\n    {\n      log_debug(\"set user to \\\"\" << tnt::TntConfig::it().user << '\"');\n      ::setUser(tnt::TntConfig::it().user);\n    }\n\n    if (!tnt::TntConfig::it().dir.empty())\n    {\n      log_debug(\"set dir to \\\"\" << tnt::TntConfig::it().dir << '\"');\n      ::setDir(tnt::TntConfig::it().dir);\n    }\n\n    if (!tnt::TntConfig::it().chrootdir.empty())\n    {\n      log_debug(\"change root to \\\"\" << tnt::TntConfig::it().chrootdir << '\"');\n      ::setRootdir(tnt::TntConfig::it().chrootdir);\n    }\n\n    signal(SIGTERM, sigEnd);\n    signal(SIGINT, sigEnd);\n    signal(SIGHUP, sigReload);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "monitorPipe.closeReadFd",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"close read-fd of monitor-pipe\""
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fork.child",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"setsid\""
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setsid",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"run monitor\""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid Process::runMonitor(cxxtools::posix::Pipe& mainPipe)\n  {\n    log_debug(\"run monitor\");\n\n    // setsid\n    if (setsid() == -1)\n      throw cxxtools::SystemError(\"setsid\");\n\n    bool first = true;\n\n    while (true)\n    {\n      cxxtools::posix::Pipe monitorPipe;\n\n      cxxtools::posix::Fork fork;\n\n      if (fork.child())\n      {\n        // worker-process\n\n        log_debug(\"close read-fd of monitor-pipe\");\n        monitorPipe.closeReadFd();\n\n        initWorker();\n        if (first)\n        {\n          log_debug(\"signal initialization ready\");\n          mainPipe.write('1');\n          log_debug(\"close write-fd of main-pipe\");\n          mainPipe.closeWriteFd();\n        }\n\n        log_debug(\"close standard-handles\");\n        closeStdHandles(tnt::TntConfig::it().errorLog);\n\n        exitRestart = false;\n        log_debug(\"do work\");\n        doWork();\n\n        // normal shutdown\n        if (exitRestart)\n          log_debug(\"restart\");\n        else\n        {\n          log_debug(\"signal shutdown\");\n          try\n          {\n            monitorPipe.write('s');\n          }\n          catch (const std::exception& e)\n          {\n            log_debug(\"ingore exception from monitor pipe: \" << e.what());\n          }\n        }\n        return;\n      }\n\n      // monitor-process\n\n      log_debug(\"write pid \" << fork.getPid() << \" to \\\"\" << tnt::TntConfig::it().pidfile << '\"');\n      PidFile p(tnt::TntConfig::it().pidfile, fork.getPid());\n\n      if (first)\n      {\n        log_debug(\"close standard-handles\");\n        closeStdHandles();\n        first = false;\n      }\n\n      monitorPipe.closeWriteFd();\n      try\n      {\n        log_debug(\"monitor child\");\n        char dummy;\n        size_t c = monitorPipe.read(&dummy, 1);\n        if (c > 0)\n        {\n          log_debug(\"child terminated normally\");\n          return;\n        }\n        log_debug(\"nothing read from monitor-pipe - restart child\");\n      }\n      catch (const cxxtools::SystemError&)\n      {\n        log_debug(\"child exited without notification\");\n      }\n\n      log_debug(\"wait for child-termination\");\n      fork.wait();\n\n      ::sleep(1);\n    }\n  }"
  },
  {
    "function_name": "Process::~Process",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "176-180",
    "snippet": "Process::~Process()\n  {\n    if (theProcess == this)\n      theProcess = 0;\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nProcess::~Process()\n  {\n    if (theProcess == this)\n      theProcess = 0;\n  }"
  },
  {
    "function_name": "Process::Process",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "171-174",
    "snippet": "Process::Process()\n  {\n    theProcess = this;\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nProcess::Process()\n  {\n    theProcess = this;\n  }"
  },
  {
    "function_name": "closeStdHandles",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "152-165",
    "snippet": "void closeStdHandles(const std::string& errorLog = std::string())\n  {\n    if (::freopen(\"/dev/null\", \"r\", stdin) == 0)\n      throw cxxtools::SystemError(\"freopen(stdin)\");\n\n    if (::freopen(\"/dev/null\", \"w\", stdout) == 0)\n      throw cxxtools::SystemError(\"freopen(stdout)\");\n\n    if (!errorLog.empty())\n    {\n      if (::freopen(errorLog.c_str(), \"a+\", stderr) == 0)\n        throw cxxtools::SystemError(\"freopen(stderr)\");\n    }\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"freopen(stderr)\""
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::freopen",
          "args": [
            "errorLog.c_str()",
            "\"a+\"",
            "stderr"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errorLog.c_str",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "errorLog.empty",
          "args": [],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"freopen(stdout)\""
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::freopen",
          "args": [
            "\"/dev/null\"",
            "\"w\"",
            "stdout"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"freopen(stdin)\""
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::freopen",
          "args": [
            "\"/dev/null\"",
            "\"r\"",
            "stdin"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid closeStdHandles(const std::string& errorLog = std::string())\n  {\n    if (::freopen(\"/dev/null\", \"r\", stdin) == 0)\n      throw cxxtools::SystemError(\"freopen(stdin)\");\n\n    if (::freopen(\"/dev/null\", \"w\", stdout) == 0)\n      throw cxxtools::SystemError(\"freopen(stdout)\");\n\n    if (!errorLog.empty())\n    {\n      if (::freopen(errorLog.c_str(), \"a+\", stderr) == 0)\n        throw cxxtools::SystemError(\"freopen(stderr)\");\n    }\n  }"
  },
  {
    "function_name": "PidFile::~PidFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "146-150",
    "snippet": "PidFile::~PidFile()\n  {\n    if (!pidFileName.empty())\n      ::unlink(pidFileName.c_str());\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::unlink",
          "args": [
            "pidFileName.c_str()"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pidFileName.c_str",
          "args": [],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pidFileName.empty",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nPidFile::~PidFile()\n  {\n    if (!pidFileName.empty())\n      ::unlink(pidFileName.c_str());\n  }"
  },
  {
    "function_name": "PidFile::PidFile",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "111-144",
    "snippet": "PidFile::PidFile(const std::string& pidFileName_, pid_t pid)\n    : pidFileName(pidFileName_)\n  {\n    if (pidFileName.empty())\n      return;\n\n    if (pidFileName[0] != '/')\n    {\n      // prepend current working-directory to pidfilename if not absolute\n      std::vector<char> buf(256);\n      const char* cwd;\n      while (true)\n      {\n        cwd = ::getcwd(&buf[0], buf.size());\n        if (cwd)\n          break;\n        else if (errno == ERANGE)\n          buf.resize(buf.size() * 2);\n        else\n          throw cxxtools::SystemError(\"getcwd\");\n      }\n      pidFileName = std::string(cwd) + '/' + pidFileName;\n      log_debug(\"pidfile=\" << pidFileName);\n    }\n\n    std::ofstream pidfile(pidFileName.c_str());\n    if (pidfile.fail())\n      throw std::runtime_error(\"unable to open pid-file \" + pidFileName);\n\n    pidfile << pid;\n\n    if (pidfile.fail())\n      throw std::runtime_error(\"error writing to pid-file \" + pidFileName);\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"error writing to pid-file \" + pidFileName"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pidfile.fail",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"unable to open pid-file \" + pidFileName"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pidfile.fail",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pidFileName.c_str",
          "args": [],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"pidfile=\" << pidFileName"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "cwd"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"getcwd\""
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf.resize",
          "args": [
            "buf.size() * 2"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf.size",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "::getcwd",
          "args": [
            "&buf[0]",
            "buf.size()"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pidFileName.empty",
          "args": [],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nPidFile::PidFile(const std::string& pidFileName_, pid_t pid)\n    : pidFileName(pidFileName_)\n  {\n    if (pidFileName.empty())\n      return;\n\n    if (pidFileName[0] != '/')\n    {\n      // prepend current working-directory to pidfilename if not absolute\n      std::vector<char> buf(256);\n      const char* cwd;\n      while (true)\n      {\n        cwd = ::getcwd(&buf[0], buf.size());\n        if (cwd)\n          break;\n        else if (errno == ERANGE)\n          buf.resize(buf.size() * 2);\n        else\n          throw cxxtools::SystemError(\"getcwd\");\n      }\n      pidFileName = std::string(cwd) + '/' + pidFileName;\n      log_debug(\"pidfile=\" << pidFileName);\n    }\n\n    std::ofstream pidfile(pidFileName.c_str());\n    if (pidfile.fail())\n      throw std::runtime_error(\"unable to open pid-file \" + pidFileName);\n\n    pidfile << pid;\n\n    if (pidfile.fail())\n      throw std::runtime_error(\"error writing to pid-file \" + pidFileName);\n  }"
  },
  {
    "function_name": "releasePidFile",
    "container": "PidFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "108-108",
    "snippet": "void releasePidFile()  { pidFileName.clear(); }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pidFileName.clear",
          "args": [],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Compident",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/compident.h",
          "lines": "76-77",
          "snippet": "void clear()\n    { libname.clear(); compname.clear(); }",
          "includes": [
            "#include <iostream>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n#include <string>\n\nCompident {\n  void clear()\n      { libname.clear(); compname.clear(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nPidFile {\n  void releasePidFile()  { pidFileName.clear(); }\n}"
  },
  {
    "function_name": "setRootdir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "95-99",
    "snippet": "void setRootdir(const std::string& dir)\n  {\n    if (!::chroot(dir.c_str()) == -1)\n      throw cxxtools::SystemError(\"chroot\");\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"chroot\""
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::chroot",
          "args": [
            "dir.c_str()"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.c_str",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid setRootdir(const std::string& dir)\n  {\n    if (!::chroot(dir.c_str()) == -1)\n      throw cxxtools::SystemError(\"chroot\");\n  }"
  },
  {
    "function_name": "setDir",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "88-93",
    "snippet": "void setDir(const std::string& dir)\n  {\n    log_debug(\"chdir(\" << dir << ')');\n    if (::chdir(dir.c_str()) == -1)\n      throw cxxtools::SystemError(\"chdir\");\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"chdir\""
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::chdir",
          "args": [
            "dir.c_str()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.c_str",
          "args": [],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"chdir(\" << dir << ')'"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid setDir(const std::string& dir)\n  {\n    log_debug(\"chdir(\" << dir << ')');\n    if (::chdir(dir.c_str()) == -1)\n      throw cxxtools::SystemError(\"chdir\");\n  }"
  },
  {
    "function_name": "setUser",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "75-86",
    "snippet": "void setUser(const std::string& user)\n  {\n    struct passwd * pw = getpwnam(user.c_str());\n    if (pw == 0)\n      throw std::runtime_error(\"unknown user \" + user);\n\n    log_debug(\"change user to \" << user << '(' << pw->pw_uid << ')');\n\n    int ret = ::setuid(pw->pw_uid);\n    if (ret != 0)\n      throw cxxtools::SystemError(\"getuid\");\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"getuid\""
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::setuid",
          "args": [
            "pw->pw_uid"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"change user to \" << user << '(' << pw->pw_uid << ')'"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"unknown user \" + user"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getpwnam",
          "args": [
            "user.c_str()"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "user.c_str",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid setUser(const std::string& user)\n  {\n    struct passwd * pw = getpwnam(user.c_str());\n    if (pw == 0)\n      throw std::runtime_error(\"unknown user \" + user);\n\n    log_debug(\"change user to \" << user << '(' << pw->pw_uid << ')');\n\n    int ret = ::setuid(pw->pw_uid);\n    if (ret != 0)\n      throw cxxtools::SystemError(\"getuid\");\n  }"
  },
  {
    "function_name": "setGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "62-73",
    "snippet": "void setGroup(const std::string& group)\n  {\n    struct group * gr = ::getgrnam(group.c_str());\n    if (gr == 0)\n      throw std::runtime_error(\"unknown group \" + group);\n\n    log_debug(\"change group to \" << group << '(' << gr->gr_gid << ')');\n\n    int ret = ::setgid(gr->gr_gid);\n    if (ret != 0)\n      throw cxxtools::SystemError(\"setgid\");\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::SystemError",
          "args": [
            "\"setgid\""
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::setgid",
          "args": [
            "gr->gr_gid"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"change group to \" << group << '(' << gr->gr_gid << ')'"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"unknown group \" + group"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::getgrnam",
          "args": [
            "group.c_str()"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group.c_str",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid setGroup(const std::string& group)\n  {\n    struct group * gr = ::getgrnam(group.c_str());\n    if (gr == 0)\n      throw std::runtime_error(\"unknown group \" + group);\n\n    log_debug(\"change group to \" << group << '(' << gr->gr_gid << ')');\n\n    int ret = ::setgid(gr->gr_gid);\n    if (ret != 0)\n      throw cxxtools::SystemError(\"setgid\");\n  }"
  },
  {
    "function_name": "sigReload",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "55-60",
    "snippet": "void sigReload(int)\n  {\n    signal(SIGHUP, sigReload);\n    if (theProcess)\n      theProcess->restart();\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "theProcess->restart",
          "args": [],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signal",
          "args": [
            "SIGHUP",
            "sigReload"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid sigReload(int)\n  {\n    signal(SIGHUP, sigReload);\n    if (theProcess)\n      theProcess->restart();\n  }"
  },
  {
    "function_name": "sigEnd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/runtime/process.cpp",
    "lines": "48-53",
    "snippet": "void sigEnd(int)\n  {\n    signal(SIGTERM, sigEnd);\n    if (theProcess)\n      theProcess->shutdown();\n  }",
    "includes": [
      "#include <signal.h>",
      "#include <errno.h>",
      "#include <fstream>",
      "#include <vector>",
      "#include <cxxtools/log.h>",
      "#include <grp.h>",
      "#include <pwd.h>",
      "#include <cxxtools/posix/fork.h>",
      "#include <cxxtools/systemerror.h>",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/process.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "theProcess->shutdown",
          "args": [],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "signal",
          "args": [
            "SIGTERM",
            "sigEnd"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <signal.h>\n#include <errno.h>\n#include <fstream>\n#include <vector>\n#include <cxxtools/log.h>\n#include <grp.h>\n#include <pwd.h>\n#include <cxxtools/posix/fork.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntconfig.h\"\n#include \"tnt/process.h\"\n\nvoid sigEnd(int)\n  {\n    signal(SIGTERM, sigEnd);\n    if (theProcess)\n      theProcess->shutdown();\n  }"
  }
]