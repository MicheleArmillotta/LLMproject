[
  {
    "function_name": "MbComponent::doCall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/mbcomponent.cpp",
    "lines": "71-165",
    "snippet": "unsigned MbComponent::doCall(tnt::HttpRequest& request, tnt::HttpReply& reply, tnt::QueryParams& qparam, bool top)\n  {\n    log_trace(\"MbComponent \" << getCompident());\n\n    tnt::DataChunks data(rawData);\n\n    unsigned url_idx = 0;\n    if (urls)\n    {\n      const char* url = request.getPathInfo().c_str();\n\n      log_debug(\"search for \\\"\" << url << '\"');\n\n      const char** urls_end = urls + data.size();\n      const char** it = std::lower_bound(urls, urls_end, url, charpLess);\n      if (it == urls_end || std::strcmp(url, *it) != 0)\n      {\n        log_debug(\"file \\\"\" << url << \"\\\" not found\");\n        return DECLINED;\n      }\n\n      url_idx = it - urls;\n\n      log_debug(\"file \\\"\" << url << \"\\\" found; idx=\" << url_idx);\n    }\n\n    if (top)\n    {\n      reply.setKeepAliveHeader();\n      reply.setContentType(mimetypes[url_idx]);\n\n      std::string maxAgeStr = request.getArg(\"maxAge\");\n      unsigned maxAge = maxAgeStr.empty() ? 14400 : cxxtools::convert<unsigned>(maxAgeStr);\n      reply.setMaxAgeHeader(maxAge);\n\n      std::string s = request.getHeader(tnt::httpheader::ifModifiedSince);\n      if (s == ctimes[url_idx])\n        return HTTP_NOT_MODIFIED;\n\n      reply.setHeader(tnt::httpheader::lastModified, ctimes[url_idx]);\n\n      if (request.getEncoding().accept(\"gzip\"))\n      {\n        cxxtools::ReadLock lock(mutex);\n        if (compressedData[url_idx].empty())\n        {\n          lock.unlock();\n          cxxtools::WriteLock wlock(mutex);\n\n          if (compressedData[url_idx].empty())\n          {\n            // check for compression\n            std::string body(data[url_idx].getData(), data[url_idx].getLength());\n            log_info(\"try compress\");\n            if (reply.tryCompress(body))\n            {\n              log_info(\"compressed successfully from \" << data[url_idx].getLength() << \" to \" << body.size());\n              compressedData[url_idx] = body;\n            }\n            else\n            {\n              log_info(\"not compressed \" << data[url_idx].getLength());\n              compressedData[url_idx] = \"-\";\n            }\n          }\n        }\n\n        if (compressedData[url_idx] != \"-\")\n        {\n          log_debug(\"compressed data found; content size \" << data[url_idx].getLength() << \" to \" << compressedData[url_idx].size());\n          reply.setContentLengthHeader(compressedData[url_idx].size());\n          reply.setHeader(httpheader::contentEncoding, \"gzip\");\n          if (!request.isMethodHEAD())\n          {\n            reply.setDirectMode();\n            reply.out() << compressedData[url_idx];\n          }\n          return HTTP_OK;\n        }\n      }\n\n      reply.setContentLengthHeader(data.size(url_idx));\n\n      if (!request.isMethodHEAD())\n      {\n        log_debug(\"send data\");\n        reply.setDirectMode();\n      }\n    }\n\n    if (!request.isMethodHEAD())\n      reply.out() << data[url_idx];\n\n    return HTTP_OK;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <cxxtools/convert.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpreply.h>",
      "#include <tnt/http.h>",
      "#include <tnt/data.h>",
      "#include <tnt/mbcomponent.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reply.out",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.isMethodHEAD",
          "args": [],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "isMethodHEAD",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "138-138",
          "snippet": "bool isMethodHEAD() const                 { return std::strcmp(method, \"HEAD\") == 0; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  bool isMethodHEAD() const                 { return std::strcmp(method, \"HEAD\") == 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reply.setDirectMode",
          "args": [],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"send data\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.setContentLengthHeader",
          "args": [
            "data.size(url_idx)"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [
            "url_idx"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "DataChunks",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/data.h",
          "lines": "93-94",
          "snippet": "unsigned size(unsigned n) const\n      { return udata()[n + 1] - udata()[n]; }",
          "includes": [
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n\nDataChunks {\n  unsigned size(unsigned n) const\n        { return udata()[n + 1] - udata()[n]; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reply.out",
          "args": [],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.setDirectMode",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.setHeader",
          "args": [
            "httpheader::contentEncoding",
            "\"gzip\""
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "setHeader",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "91-92",
          "snippet": "void setHeader(const std::string& key, const std::string& value, bool replace = true)\n        { header.setHeader(key, value, replace); }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  void setHeader(const std::string& key, const std::string& value, bool replace = true)\n          { header.setHeader(key, value, replace); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reply.setContentLengthHeader",
          "args": [
            "compressedData[url_idx].size()"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compressedData[url_idx].size",
          "args": [],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"compressed data found; content size \" << data[url_idx].getLength() << \" to \" << compressedData[url_idx].size()"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data[url_idx].getLength",
          "args": [],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "getLength",
          "container": "DataChunk",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/data.h",
          "lines": "54-54",
          "snippet": "unsigned getLength() const   { return len; }",
          "includes": [
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n\nDataChunk {\n  unsigned getLength() const   { return len; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"not compressed \" << data[url_idx].getLength()"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"compressed successfully from \" << data[url_idx].getLength() << \" to \" << body.size()"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.tryCompress",
          "args": [
            "body"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"try compress\""
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data[url_idx].getData",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "compressedData[url_idx].empty",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "lock.unlock",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "unlock",
          "container": "ApplicationUnlocker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/applicationunlocker.h",
          "lines": "62-66",
          "snippet": "void unlock()\n      {\n        request.releaseApplicationScopeLock();\n        locked = false;\n      }",
          "includes": [
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/httprequest.h>\n\nApplicationUnlocker {\n  void unlock()\n        {\n          request.releaseApplicationScopeLock();\n          locked = false;\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.getEncoding",
          "args": [
            "\"gzip\""
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getEncoding",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getHeader",
          "args": [
            "tnt::httpheader::ifModifiedSince"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.setMaxAgeHeader",
          "args": [
            "maxAge"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::convert<unsigned>",
          "args": [
            "maxAgeStr"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getArg",
          "args": [
            "\"maxAge\""
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "getArg",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "163-163",
          "snippet": "std::string getArg(args_type::size_type n) const { return getArgDef(n); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  std::string getArg(args_type::size_type n) const { return getArgDef(n); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reply.setContentType",
          "args": [
            "mimetypes[url_idx]"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "setContentType",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpreply.h",
          "lines": "61-61",
          "snippet": "void setContentType(const std::string& t)     { setHeader(httpheader::contentType, t); }",
          "includes": [
            "#include <iosfwd>",
            "#include <tnt/http.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iosfwd>\n#include <tnt/http.h>\n#include <tnt/httpmessage.h>\n\nHttpReply {\n  void setContentType(const std::string& t)     { setHeader(httpheader::contentType, t); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reply.setKeepAliveHeader",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"file \\\"\" << url << \"\\\" found; idx=\" << url_idx"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"file \\\"\" << url << \"\\\" not found\""
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::strcmp",
          "args": [
            "url",
            "*it"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::lower_bound",
          "args": [
            "urls",
            "urls_end",
            "url",
            "charpLess"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"search for \\\"\" << url << '\"'"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getPathInfo",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getPathInfo",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_trace",
          "args": [
            "\"MbComponent \" << getCompident()"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getCompident",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "getCompident",
          "container": "EcppSubComponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/ecpp.h",
          "lines": "177-178",
          "snippet": "Subcompident getCompident() const\n        { return Subcompident(main.getCompident(), subcompname); }",
          "includes": [
            "#include <set>",
            "#include <map>",
            "#include <tnt/http.h>",
            "#include <tnt/httprequest.h>",
            "#include <tnt/sessionscope.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/componentfactory.h>",
            "#include <tnt/component.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <set>\n#include <map>\n#include <tnt/http.h>\n#include <tnt/httprequest.h>\n#include <tnt/sessionscope.h>\n#include <tnt/scope.h>\n#include <tnt/componentfactory.h>\n#include <tnt/component.h>\n\nEcppSubComponent {\n  Subcompident getCompident() const\n          { return Subcompident(main.getCompident(), subcompname); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cxxtools/convert.h>\n#include <cxxtools/log.h>\n#include <tnt/httpreply.h>\n#include <tnt/http.h>\n#include <tnt/data.h>\n#include <tnt/mbcomponent.h>\n\nunsigned MbComponent::doCall(tnt::HttpRequest& request, tnt::HttpReply& reply, tnt::QueryParams& qparam, bool top)\n  {\n    log_trace(\"MbComponent \" << getCompident());\n\n    tnt::DataChunks data(rawData);\n\n    unsigned url_idx = 0;\n    if (urls)\n    {\n      const char* url = request.getPathInfo().c_str();\n\n      log_debug(\"search for \\\"\" << url << '\"');\n\n      const char** urls_end = urls + data.size();\n      const char** it = std::lower_bound(urls, urls_end, url, charpLess);\n      if (it == urls_end || std::strcmp(url, *it) != 0)\n      {\n        log_debug(\"file \\\"\" << url << \"\\\" not found\");\n        return DECLINED;\n      }\n\n      url_idx = it - urls;\n\n      log_debug(\"file \\\"\" << url << \"\\\" found; idx=\" << url_idx);\n    }\n\n    if (top)\n    {\n      reply.setKeepAliveHeader();\n      reply.setContentType(mimetypes[url_idx]);\n\n      std::string maxAgeStr = request.getArg(\"maxAge\");\n      unsigned maxAge = maxAgeStr.empty() ? 14400 : cxxtools::convert<unsigned>(maxAgeStr);\n      reply.setMaxAgeHeader(maxAge);\n\n      std::string s = request.getHeader(tnt::httpheader::ifModifiedSince);\n      if (s == ctimes[url_idx])\n        return HTTP_NOT_MODIFIED;\n\n      reply.setHeader(tnt::httpheader::lastModified, ctimes[url_idx]);\n\n      if (request.getEncoding().accept(\"gzip\"))\n      {\n        cxxtools::ReadLock lock(mutex);\n        if (compressedData[url_idx].empty())\n        {\n          lock.unlock();\n          cxxtools::WriteLock wlock(mutex);\n\n          if (compressedData[url_idx].empty())\n          {\n            // check for compression\n            std::string body(data[url_idx].getData(), data[url_idx].getLength());\n            log_info(\"try compress\");\n            if (reply.tryCompress(body))\n            {\n              log_info(\"compressed successfully from \" << data[url_idx].getLength() << \" to \" << body.size());\n              compressedData[url_idx] = body;\n            }\n            else\n            {\n              log_info(\"not compressed \" << data[url_idx].getLength());\n              compressedData[url_idx] = \"-\";\n            }\n          }\n        }\n\n        if (compressedData[url_idx] != \"-\")\n        {\n          log_debug(\"compressed data found; content size \" << data[url_idx].getLength() << \" to \" << compressedData[url_idx].size());\n          reply.setContentLengthHeader(compressedData[url_idx].size());\n          reply.setHeader(httpheader::contentEncoding, \"gzip\");\n          if (!request.isMethodHEAD())\n          {\n            reply.setDirectMode();\n            reply.out() << compressedData[url_idx];\n          }\n          return HTTP_OK;\n        }\n      }\n\n      reply.setContentLengthHeader(data.size(url_idx));\n\n      if (!request.isMethodHEAD())\n      {\n        log_debug(\"send data\");\n        reply.setDirectMode();\n      }\n    }\n\n    if (!request.isMethodHEAD())\n      reply.out() << data[url_idx];\n\n    return HTTP_OK;\n  }"
  },
  {
    "function_name": "MbComponent::topCall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/mbcomponent.cpp",
    "lines": "66-69",
    "snippet": "unsigned MbComponent::topCall(tnt::HttpRequest& request, tnt::HttpReply& reply, tnt::QueryParams& qparam)\n  {\n    return doCall(request, reply, qparam, true);\n  }",
    "includes": [
      "#include <cstring>",
      "#include <cxxtools/convert.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpreply.h>",
      "#include <tnt/http.h>",
      "#include <tnt/data.h>",
      "#include <tnt/mbcomponent.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "doCall",
          "args": [
            "request",
            "reply",
            "qparam",
            "true"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cxxtools/convert.h>\n#include <cxxtools/log.h>\n#include <tnt/httpreply.h>\n#include <tnt/http.h>\n#include <tnt/data.h>\n#include <tnt/mbcomponent.h>\n\nunsigned MbComponent::topCall(tnt::HttpRequest& request, tnt::HttpReply& reply, tnt::QueryParams& qparam)\n  {\n    return doCall(request, reply, qparam, true);\n  }"
  },
  {
    "function_name": "MbComponent::operator()",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/mbcomponent.cpp",
    "lines": "61-64",
    "snippet": "unsigned MbComponent::operator() (tnt::HttpRequest& request, tnt::HttpReply& reply, tnt::QueryParams& qparam)\n  {\n    return doCall(request, reply, qparam, false);\n  }",
    "includes": [
      "#include <cstring>",
      "#include <cxxtools/convert.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpreply.h>",
      "#include <tnt/http.h>",
      "#include <tnt/data.h>",
      "#include <tnt/mbcomponent.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "doCall",
          "args": [
            "request",
            "reply",
            "qparam",
            "false"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cxxtools/convert.h>\n#include <cxxtools/log.h>\n#include <tnt/httpreply.h>\n#include <tnt/http.h>\n#include <tnt/data.h>\n#include <tnt/mbcomponent.h>\n\nunsigned MbComponent::operator() (tnt::HttpRequest& request, tnt::HttpReply& reply, tnt::QueryParams& qparam)\n  {\n    return doCall(request, reply, qparam, false);\n  }"
  },
  {
    "function_name": "MbComponent::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/mbcomponent.cpp",
    "lines": "49-59",
    "snippet": "void MbComponent::init(const char* rawData_, const char** urls_,\n                         const char** mimetypes_, const char** ctimes_)\n  {\n    rawData   = rawData_;\n    urls      = urls_;\n    mimetypes = mimetypes_;\n    ctimes    = ctimes_;\n\n    tnt::DataChunks data(rawData);\n    compressedData.resize(data.size());\n  }",
    "includes": [
      "#include <cstring>",
      "#include <cxxtools/convert.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpreply.h>",
      "#include <tnt/http.h>",
      "#include <tnt/data.h>",
      "#include <tnt/mbcomponent.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "compressedData.resize",
          "args": [
            "data.size()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cxxtools/convert.h>\n#include <cxxtools/log.h>\n#include <tnt/httpreply.h>\n#include <tnt/http.h>\n#include <tnt/data.h>\n#include <tnt/mbcomponent.h>\n\nvoid MbComponent::init(const char* rawData_, const char** urls_,\n                         const char** mimetypes_, const char** ctimes_)\n  {\n    rawData   = rawData_;\n    urls      = urls_;\n    mimetypes = mimetypes_;\n    ctimes    = ctimes_;\n\n    tnt::DataChunks data(rawData);\n    compressedData.resize(data.size());\n  }"
  },
  {
    "function_name": "charpLess",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/mbcomponent.cpp",
    "lines": "43-46",
    "snippet": "inline bool charpLess(const char* a, const char* b)\n    {\n      return std::strcmp(a, b) < 0;\n    }",
    "includes": [
      "#include <cstring>",
      "#include <cxxtools/convert.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/httpreply.h>",
      "#include <tnt/http.h>",
      "#include <tnt/data.h>",
      "#include <tnt/mbcomponent.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::strcmp",
          "args": [
            "a",
            "b"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <cxxtools/convert.h>\n#include <cxxtools/log.h>\n#include <tnt/httpreply.h>\n#include <tnt/http.h>\n#include <tnt/data.h>\n#include <tnt/mbcomponent.h>\n\ninline bool charpLess(const char* a, const char* b)\n    {\n      return std::strcmp(a, b) < 0;\n    }"
  }
]