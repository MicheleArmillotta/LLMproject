[
  {
    "function_name": "parse",
    "container": "MessageattributeParser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageattribute.cpp",
    "lines": "53-307",
    "snippet": "void MessageattributeParser::parse(std::istream& in)\n  {\n    enum state_type\n    {\n      state_0,\n      state_type0,\n      state_type_sp,\n      state_subtype0,\n      state_subtype,\n      state_subtype_sp,\n      state_attribute0,\n      state_attribute,\n      state_attribute_sp,\n      state_value0,\n      state_value,\n      state_qvalue,\n      state_end\n    };\n\n    state_type state = state_0;\n    std::streambuf* buf = in.rdbuf();\n\n    std::string type, subtype, attribute, value;\n\n    while (state != state_end && buf->sgetc() != std::ios::traits_type::eof())\n    {\n      char ch = buf->sgetc();\n      switch (state)\n      {\n        case state_0:\n          if (istokenchar(ch))\n          {\n            type.clear();\n            type.reserve(16);\n            type += ch;\n            state = state_type0;\n          }\n          else if (std::isspace(ch))\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_type0:\n          if (tnt_isblank(ch))\n            state = state_type_sp;\n          else if (ch == '/')\n            state = state_subtype0;\n          else if (ch == ';')\n          {\n            switch (onType(type, std::string()))\n            {\n              case OK:   state = state_attribute0; break;\n              case FAIL: in.setstate(std::ios::failbit); break;\n              case END:  state = state_end;  break;\n            }\n          }\n          else if (istokenchar(ch))\n            type += ch;\n          else\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_type_sp:\n          if (ch == '/')\n            state = state_subtype0;\n          else if (ch == ';')\n          {\n            switch (onType(type, std::string()))\n            {\n              case OK:   state = state_attribute0; break;\n              case FAIL: in.setstate(std::ios::failbit); break;\n              case END:  state = state_end;  break;\n            }\n          }\n          else if (!tnt_isblank(ch))\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_subtype0:\n          if (istokenchar(ch))\n          {\n            subtype = ch;\n            state = state_subtype;\n          }\n          else if (!tnt_isblank(ch))\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_subtype:\n          if (ch == ';')\n          {\n            switch (onType(type, subtype))\n            {\n              case OK:   state = state_attribute0; break;\n              case FAIL: in.setstate(std::ios::failbit); break;\n              case END:  state = state_end;  break;\n            }\n          }\n          else if (tnt_isblank(ch))\n          {\n            switch (onType(type, subtype))\n            {\n              case OK:   state = state_subtype_sp; break;\n              case FAIL: in.setstate(std::ios::failbit); break;\n              case END:  state = state_end;  break;\n            }\n          }\n          else if (istokenchar(ch))\n            subtype += ch;\n          else\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_subtype_sp:\n          if (ch == ';')\n            state = state_attribute0;\n          else if (!tnt_isblank(ch))\n            state = state_end;\n          break;\n\n        case state_attribute0:\n          if (istokenchar(ch))\n          {\n            attribute = ch;\n            state = state_attribute;\n          }\n          break;\n\n        case state_attribute:\n          if (istokenchar(ch))\n            attribute += ch;\n          else if (tnt_isblank(ch))\n            state = state_attribute_sp;\n          else if (ch == '=')\n            state = state_value0;\n          else\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_attribute_sp:\n          if (ch == '=')\n            state = state_value0;\n          else if (!tnt_isblank(ch))\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_value0:\n          if (ch == '\"')\n            state = state_qvalue;\n          else if (istokenchar(ch))\n          {\n            value.clear();\n            value.reserve(16);\n            value += ch;\n            state = state_value;\n          }\n          else\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_qvalue:\n          if (ch == '\"')\n          {\n            switch (onParameter(attribute, value))\n            {\n              case OK:   state = state_subtype_sp;\n                         attribute.clear();\n                         value.clear();\n                         break;\n              case FAIL: in.setstate(std::ios::failbit); break;\n              case END:  state = state_end;  break;\n            }\n          }\n          else\n            value += ch;\n          break;\n\n        case state_value:\n          if (istokenchar(ch))\n            value += ch;\n          else if (tnt_isblank(ch))\n          {\n            switch (onParameter(attribute, value))\n            {\n              case OK:   state = state_subtype_sp;\n                         attribute.clear();\n                         value.clear();\n                         break;\n              case FAIL: in.setstate(std::ios::failbit); break;\n              case END:  state = state_end;  break;\n            }\n          }\n          else if (ch == ';')\n          {\n            switch (onParameter(attribute, value))\n            {\n              case OK:   state = state_attribute0;\n                         attribute.clear();\n                         value.clear();\n                         break;\n              case FAIL: in.setstate(std::ios::failbit); break;\n              case END:  state = state_end;  break;\n            }\n          }\n          else\n            in.setstate(std::ios::failbit);\n          break;\n\n        case state_end:\n          break;\n      }\n\n      if (state != state_end)\n        buf->sbumpc();\n    }\n\n    // process last parameter\n    if (in.fail())\n      return;\n\n    switch (state)\n    {\n      case state_0:\n      case state_type0:\n        break;\n\n      case state_type_sp:\n      case state_subtype0:\n      case state_subtype:\n        if (onType(type, subtype) == FAIL)\n          in.setstate(std::ios::failbit);\n        break;\n\n      case state_subtype_sp:\n      case state_attribute0:\n        break;\n\n      case state_attribute:\n      case state_attribute_sp:\n      case state_value0:\n      case state_qvalue:\n        in.setstate(std::ios::failbit);\n        break;\n\n      case state_value:\n        if(onParameter(attribute, value) == FAIL)\n          in.setstate(std::ios::failbit);\n        break;\n\n      case state_end:\n        break;\n    };\n\n    if (buf->sgetc() == std::ios::traits_type::eof())\n      in.setstate(std::ios::eofbit);\n  }",
    "includes": [
      "#include <iostream>",
      "#include <cctype>",
      "#include <tnt/messageattribute.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::eofbit"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::ios::traits_type::eof",
          "args": [],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf->sgetc",
          "args": [],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onParameter",
          "args": [
            "attribute",
            "value"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "onParameter",
          "container": "Contenttype",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/contenttype.cpp",
          "lines": "89-101",
          "snippet": "Contenttype::return_type Contenttype::onParameter(\n    const std::string& attribute, const std::string& value)\n  {\n    log_debug(\"Contenttype::onParameter \" << attribute << \", \" << value);\n    std::string att = attribute;\n    std::transform(att.begin(), att.end(), att.begin(),\n      ::tolower);\n\n    parameter.insert(parameter_type::value_type(att, value));\n    if (attribute == \"boundary\")\n      boundary = value;\n    return OK;\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <algorithm>",
            "#include <ctype.h>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/util.h>",
            "#include <tnt/contenttype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <ctype.h>\n#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <tnt/util.h>\n#include <tnt/contenttype.h>\n\nContenttype {\n  Contenttype::return_type Contenttype::onParameter(\n      const std::string& attribute, const std::string& value)\n    {\n      log_debug(\"Contenttype::onParameter \" << attribute << \", \" << value);\n      std::string att = attribute;\n      std::transform(att.begin(), att.end(), att.begin(),\n        ::tolower);\n  \n      parameter.insert(parameter_type::value_type(att, value));\n      if (attribute == \"boundary\")\n        boundary = value;\n      return OK;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "onType",
          "args": [
            "type",
            "subtype"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "onType",
          "container": "Contenttype",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/contenttype.cpp",
          "lines": "71-87",
          "snippet": "Contenttype::return_type Contenttype::onType(\n    const std::string& t, const std::string& s)\n  {\n    log_debug(\"Contenttype::onType \" << t << \", \" << s);\n    if (s.empty())\n      return FAIL;\n\n    type = t;\n    subtype = s;\n\n    std::transform(type.begin(), type.end(), type.begin(),\n      ::tolower);\n    std::transform(subtype.begin(), subtype.end(), subtype.begin(),\n      ::tolower);\n\n    return OK;\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <algorithm>",
            "#include <ctype.h>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/util.h>",
            "#include <tnt/contenttype.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <algorithm>\n#include <ctype.h>\n#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <tnt/util.h>\n#include <tnt/contenttype.h>\n\nContenttype {\n  Contenttype::return_type Contenttype::onType(\n      const std::string& t, const std::string& s)\n    {\n      log_debug(\"Contenttype::onType \" << t << \", \" << s);\n      if (s.empty())\n        return FAIL;\n  \n      type = t;\n      subtype = s;\n  \n      std::transform(type.begin(), type.end(), type.begin(),\n        ::tolower);\n      std::transform(subtype.begin(), subtype.end(), subtype.begin(),\n        ::tolower);\n  \n      return OK;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "in.fail",
          "args": [],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf->sbumpc",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.clear",
          "args": [],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "168-220",
          "snippet": "void HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::clear()\n    {\n      HttpMessage::clear();\n      body.clear();\n      methodLen = 0;\n      method[0] = '\\0';\n      url.clear();\n      queryString.clear();\n      contentSize = 0;\n      pathinfo.clear();\n      args.clear();\n      getparam.clear();\n      postparam.clear();\n      qparam.clear();\n      ct = Contenttype();\n      mp = Multipart();\n      locale_init = false;\n      if (requestScope)\n      {\n        if (requestScope->release() == 0)\n          delete requestScope;\n        requestScope = 0;\n      }\n      httpcookies.clear();\n      encodingRead = false;\n      username.clear();\n      password.clear();\n  \n      releaseLocks();\n  \n      if (applicationScope)\n      {\n        if (applicationScope->release() == 0)\n          delete applicationScope;\n        applicationScope = 0;\n      }\n  \n      if (sessionScope)\n      {\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n        sessionScope = 0;\n      }\n  \n      if (secureSessionScope)\n      {\n        if (secureSessionScope->release() == 0)\n          delete secureSessionScope;\n        secureSessionScope = 0;\n      }\n  \n      threadContext = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tnt_isblank",
          "args": [
            "ch"
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "tnt_isblank",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageattribute.cpp",
          "lines": "47-50",
          "snippet": "static inline bool tnt_isblank(char ch)\n    {\n      return ch == ' ' || ch == '\\t';\n    }",
          "includes": [
            "#include <iostream>",
            "#include <cctype>",
            "#include <tnt/messageattribute.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n#include <cctype>\n#include <tnt/messageattribute.h>\n\nstatic inline bool tnt_isblank(char ch)\n    {\n      return ch == ' ' || ch == '\\t';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "istokenchar",
          "args": [
            "ch"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "istokenchar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageattribute.cpp",
          "lines": "38-45",
          "snippet": "static inline bool istokenchar(char ch)\n    {\n      return ch >= 33\n          && ch <= 126\n          && ch != '(' && ch != ')' && ch != '<' && ch != '>'  && ch != '@'\n          && ch != ',' && ch != ';' && ch != ':' && ch != '\\\\' && ch != '\"'\n          && ch != '/' && ch != '[' && ch != ']' && ch != '?'  && ch != '=';\n    }",
          "includes": [
            "#include <iostream>",
            "#include <cctype>",
            "#include <tnt/messageattribute.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n#include <cctype>\n#include <tnt/messageattribute.h>\n\nstatic inline bool istokenchar(char ch)\n    {\n      return ch >= 33\n          && ch <= 126\n          && ch != '(' && ch != ')' && ch != '<' && ch != '>'  && ch != '@'\n          && ch != ',' && ch != ';' && ch != ':' && ch != '\\\\' && ch != '\"'\n          && ch != '/' && ch != '[' && ch != ']' && ch != '?'  && ch != '=';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.reserve",
          "args": [
            "16"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.setstate",
          "args": [
            "std::ios::failbit"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "type.reserve",
          "args": [
            "16"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf->sgetc",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::ios::traits_type::eof",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buf->sgetc",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "in.rdbuf",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iostream>\n#include <cctype>\n#include <tnt/messageattribute.h>\n\nMessageattributeParser {\n  void MessageattributeParser::parse(std::istream& in)\n    {\n      enum state_type\n      {\n        state_0,\n        state_type0,\n        state_type_sp,\n        state_subtype0,\n        state_subtype,\n        state_subtype_sp,\n        state_attribute0,\n        state_attribute,\n        state_attribute_sp,\n        state_value0,\n        state_value,\n        state_qvalue,\n        state_end\n      };\n  \n      state_type state = state_0;\n      std::streambuf* buf = in.rdbuf();\n  \n      std::string type, subtype, attribute, value;\n  \n      while (state != state_end && buf->sgetc() != std::ios::traits_type::eof())\n      {\n        char ch = buf->sgetc();\n        switch (state)\n        {\n          case state_0:\n            if (istokenchar(ch))\n            {\n              type.clear();\n              type.reserve(16);\n              type += ch;\n              state = state_type0;\n            }\n            else if (std::isspace(ch))\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_type0:\n            if (tnt_isblank(ch))\n              state = state_type_sp;\n            else if (ch == '/')\n              state = state_subtype0;\n            else if (ch == ';')\n            {\n              switch (onType(type, std::string()))\n              {\n                case OK:   state = state_attribute0; break;\n                case FAIL: in.setstate(std::ios::failbit); break;\n                case END:  state = state_end;  break;\n              }\n            }\n            else if (istokenchar(ch))\n              type += ch;\n            else\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_type_sp:\n            if (ch == '/')\n              state = state_subtype0;\n            else if (ch == ';')\n            {\n              switch (onType(type, std::string()))\n              {\n                case OK:   state = state_attribute0; break;\n                case FAIL: in.setstate(std::ios::failbit); break;\n                case END:  state = state_end;  break;\n              }\n            }\n            else if (!tnt_isblank(ch))\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_subtype0:\n            if (istokenchar(ch))\n            {\n              subtype = ch;\n              state = state_subtype;\n            }\n            else if (!tnt_isblank(ch))\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_subtype:\n            if (ch == ';')\n            {\n              switch (onType(type, subtype))\n              {\n                case OK:   state = state_attribute0; break;\n                case FAIL: in.setstate(std::ios::failbit); break;\n                case END:  state = state_end;  break;\n              }\n            }\n            else if (tnt_isblank(ch))\n            {\n              switch (onType(type, subtype))\n              {\n                case OK:   state = state_subtype_sp; break;\n                case FAIL: in.setstate(std::ios::failbit); break;\n                case END:  state = state_end;  break;\n              }\n            }\n            else if (istokenchar(ch))\n              subtype += ch;\n            else\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_subtype_sp:\n            if (ch == ';')\n              state = state_attribute0;\n            else if (!tnt_isblank(ch))\n              state = state_end;\n            break;\n  \n          case state_attribute0:\n            if (istokenchar(ch))\n            {\n              attribute = ch;\n              state = state_attribute;\n            }\n            break;\n  \n          case state_attribute:\n            if (istokenchar(ch))\n              attribute += ch;\n            else if (tnt_isblank(ch))\n              state = state_attribute_sp;\n            else if (ch == '=')\n              state = state_value0;\n            else\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_attribute_sp:\n            if (ch == '=')\n              state = state_value0;\n            else if (!tnt_isblank(ch))\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_value0:\n            if (ch == '\"')\n              state = state_qvalue;\n            else if (istokenchar(ch))\n            {\n              value.clear();\n              value.reserve(16);\n              value += ch;\n              state = state_value;\n            }\n            else\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_qvalue:\n            if (ch == '\"')\n            {\n              switch (onParameter(attribute, value))\n              {\n                case OK:   state = state_subtype_sp;\n                           attribute.clear();\n                           value.clear();\n                           break;\n                case FAIL: in.setstate(std::ios::failbit); break;\n                case END:  state = state_end;  break;\n              }\n            }\n            else\n              value += ch;\n            break;\n  \n          case state_value:\n            if (istokenchar(ch))\n              value += ch;\n            else if (tnt_isblank(ch))\n            {\n              switch (onParameter(attribute, value))\n              {\n                case OK:   state = state_subtype_sp;\n                           attribute.clear();\n                           value.clear();\n                           break;\n                case FAIL: in.setstate(std::ios::failbit); break;\n                case END:  state = state_end;  break;\n              }\n            }\n            else if (ch == ';')\n            {\n              switch (onParameter(attribute, value))\n              {\n                case OK:   state = state_attribute0;\n                           attribute.clear();\n                           value.clear();\n                           break;\n                case FAIL: in.setstate(std::ios::failbit); break;\n                case END:  state = state_end;  break;\n              }\n            }\n            else\n              in.setstate(std::ios::failbit);\n            break;\n  \n          case state_end:\n            break;\n        }\n  \n        if (state != state_end)\n          buf->sbumpc();\n      }\n  \n      // process last parameter\n      if (in.fail())\n        return;\n  \n      switch (state)\n      {\n        case state_0:\n        case state_type0:\n          break;\n  \n        case state_type_sp:\n        case state_subtype0:\n        case state_subtype:\n          if (onType(type, subtype) == FAIL)\n            in.setstate(std::ios::failbit);\n          break;\n  \n        case state_subtype_sp:\n        case state_attribute0:\n          break;\n  \n        case state_attribute:\n        case state_attribute_sp:\n        case state_value0:\n        case state_qvalue:\n          in.setstate(std::ios::failbit);\n          break;\n  \n        case state_value:\n          if(onParameter(attribute, value) == FAIL)\n            in.setstate(std::ios::failbit);\n          break;\n  \n        case state_end:\n          break;\n      };\n  \n      if (buf->sgetc() == std::ios::traits_type::eof())\n        in.setstate(std::ios::eofbit);\n    }\n}"
  },
  {
    "function_name": "tnt_isblank",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageattribute.cpp",
    "lines": "47-50",
    "snippet": "static inline bool tnt_isblank(char ch)\n    {\n      return ch == ' ' || ch == '\\t';\n    }",
    "includes": [
      "#include <iostream>",
      "#include <cctype>",
      "#include <tnt/messageattribute.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iostream>\n#include <cctype>\n#include <tnt/messageattribute.h>\n\nstatic inline bool tnt_isblank(char ch)\n    {\n      return ch == ' ' || ch == '\\t';\n    }"
  },
  {
    "function_name": "istokenchar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageattribute.cpp",
    "lines": "38-45",
    "snippet": "static inline bool istokenchar(char ch)\n    {\n      return ch >= 33\n          && ch <= 126\n          && ch != '(' && ch != ')' && ch != '<' && ch != '>'  && ch != '@'\n          && ch != ',' && ch != ';' && ch != ':' && ch != '\\\\' && ch != '\"'\n          && ch != '/' && ch != '[' && ch != ']' && ch != '?'  && ch != '=';\n    }",
    "includes": [
      "#include <iostream>",
      "#include <cctype>",
      "#include <tnt/messageattribute.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iostream>\n#include <cctype>\n#include <tnt/messageattribute.h>\n\nstatic inline bool istokenchar(char ch)\n    {\n      return ch >= 33\n          && ch <= 126\n          && ch != '(' && ch != ')' && ch != '<' && ch != '>'  && ch != '@'\n          && ch != ',' && ch != ';' && ch != ':' && ch != '\\\\' && ch != '\"'\n          && ch != '/' && ch != '[' && ch != ']' && ch != '?'  && ch != '=';\n    }"
  }
]