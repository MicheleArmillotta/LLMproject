[
  {
    "function_name": "checkSessionTimeout",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "319-343",
    "snippet": "void ScopeManager::checkSessionTimeout()\n  {\n    time_t currentTime;\n    time(&currentTime);\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.begin();\n    unsigned count = 0;\n    while (it != sessionScopes.end())\n    {\n      Sessionscope* s = it->second;\n      if (static_cast <unsigned> (currentTime - s->getAtime()) > s->getTimeout())\n      {\n        log_info(\"sessiontimeout for session \" << it->first << \" reached\");\n        sessionscopes_type::iterator it2 = it;\n        ++it;\n        if (s->release() == 0)\n          delete s;\n        sessionScopes.erase(it2);\n        ++count;\n      }\n      else\n        ++it;\n    }\n\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sessionScopes.erase",
          "args": [
            "it2"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s->release",
          "args": [],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "release",
          "container": "Zdata",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
          "lines": "62-70",
          "snippet": "void Zdata::release()\n  {\n    if (cxxtools::atomicDecrement(refs) == 0)\n    {\n      log_debug(\"release \" << data_len << \" uncompressed bytes\");\n      delete[] data;\n      data = 0;\n    }\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <stdexcept>",
            "#include <zlib.h>",
            "#include <tnt/util.h>",
            "#include <tnt/zdata.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nZdata {\n  void Zdata::release()\n    {\n      if (cxxtools::atomicDecrement(refs) == 0)\n      {\n        log_debug(\"release \" << data_len << \" uncompressed bytes\");\n        delete[] data;\n        data = 0;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"sessiontimeout for session \" << it->first << \" reached\""
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s->getTimeout",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "getTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "51-51",
          "snippet": "unsigned getTimeout() const                { return timeout; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  unsigned getTimeout() const                { return timeout; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast <unsigned>",
          "args": [
            "currentTime - s->getAtime()"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s->getAtime",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "getAtime",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "50-50",
          "snippet": "time_t getAtime() const                    { return atime; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  time_t getAtime() const                    { return atime; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.begin",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&currentTime"
          ],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "livetime",
          "container": "BackgroundTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
          "lines": "148-154",
          "snippet": "void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _livetime = livetime;\n    if (_progress >= 100)\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n}",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/backgroundworker.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nBackgroundTask {\n  void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n  {\n      cxxtools::MutexLock lock(_mutex);\n      _livetime = livetime;\n      if (_progress >= 100)\n          _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  void ScopeManager::checkSessionTimeout()\n    {\n      time_t currentTime;\n      time(&currentTime);\n      cxxtools::MutexLock lock(sessionScopesMutex);\n      sessionscopes_type::iterator it = sessionScopes.begin();\n      unsigned count = 0;\n      while (it != sessionScopes.end())\n      {\n        Sessionscope* s = it->second;\n        if (static_cast <unsigned> (currentTime - s->getAtime()) > s->getTimeout())\n        {\n          log_info(\"sessiontimeout for session \" << it->first << \" reached\");\n          sessionscopes_type::iterator it2 = it;\n          ++it;\n          if (s->release() == 0)\n            delete s;\n          sessionScopes.erase(it2);\n          ++count;\n        }\n        else\n          ++it;\n      }\n  \n    }\n}"
  },
  {
    "function_name": "postCall",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "246-317",
    "snippet": "std::string ScopeManager::postCall(HttpRequest& request, HttpReply& reply, const std::string& app)\n  {\n    std::string currentSessionCookieName = app.empty() ? std::string(\"tntnet\") : \"tntnet.\" + app;\n    std::string currentSecureSessionCookieName = app.empty() ? std::string(\"stntnet\") : \"stntnet.\" + app;\n\n    std::string sessionId;\n\n    if (reply.isClearSession())\n    {\n      sessionId = request.getCookie(currentSessionCookieName);\n      if (!sessionId.empty())\n        removeSessionScope(sessionId);\n\n      std::string secureSessionId = request.getCookie(currentSecureSessionCookieName);\n      if (!secureSessionId.empty())\n        removeSessionScope(secureSessionId);\n    }\n    else\n    {\n      if (request.hasSessionScope())\n      {\n        // request has session scope\n        sessionId = request.getCookie(currentSessionCookieName);\n        if (sessionId.empty())\n        {\n          // client has no sessionId\n\n          cxxtools::Md5stream c;\n          c << request.getSerial() << '-' << ::pthread_self() << '-' << rand();\n          sessionId = c.getHexDigest();\n          log_info(\"create new session \" << sessionId);\n          reply.setCookie(currentSessionCookieName, sessionId);\n          putSessionScope(sessionId, &request.getSessionScope());\n        }\n        else if (!hasSessionScope(sessionId))\n        {\n          // client has a sessionId but no associated session\n          // this may happen, when tntnet is restarted while the browser has a session\n\n          putSessionScope(sessionId, &request.getSessionScope());\n        }\n      }\n\n      if (request.isSsl() && request.hasSecureSessionScope())\n      {\n        // request has secure session scope\n        std::string sessionId = request.getCookie(currentSecureSessionCookieName);\n        if (sessionId.empty())\n        {\n          // client has no sessionId\n\n          cxxtools::Md5stream c;\n          c << request.getSerial() << '-' << ::pthread_self() << '-' << rand();\n          sessionId = c.getHexDigest();\n          log_info(\"create new secure session \" << sessionId);\n          tnt::Cookie cookie(sessionId);\n          cookie.setSecure();\n          reply.setCookie(currentSecureSessionCookieName, cookie);\n          putSessionScope(sessionId, &request.getSecureSessionScope());\n        }\n        else if (!hasSessionScope(sessionId))\n        {\n          // client has a sessionId but no associated session\n          // this may happen, when tntnet is restarted while the browser has a session\n\n          putSessionScope(sessionId, &request.getSecureSessionScope());\n        }\n      }\n    }\n\n    return sessionId;\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "putSessionScope",
          "args": [
            "sessionId",
            "&request.getSecureSessionScope()"
          ],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "putSessionScope",
          "container": "ScopeManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
          "lines": "99-113",
          "snippet": "void ScopeManager::putSessionScope(const std::string& sessioncookie, Sessionscope* s)\n  {\n    s->addRef();\n\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    if (it != sessionScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      it->second = s;\n    }\n    else\n      sessionScopes[sessioncookie] = s;\n  }",
          "includes": [
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/httprequest.h\"",
            "#include \"tnt/sessionscope.h\"",
            "#include \"tnt/scopemanager.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  void ScopeManager::putSessionScope(const std::string& sessioncookie, Sessionscope* s)\n    {\n      s->addRef();\n  \n      cxxtools::MutexLock lock(sessionScopesMutex);\n      sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n      if (it != sessionScopes.end())\n      {\n        if (it->second->release() == 0)\n          delete it->second;\n        it->second = s;\n      }\n      else\n        sessionScopes[sessioncookie] = s;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.getSecureSessionScope",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hasSessionScope",
          "args": [
            "sessionId"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "hasSessionScope",
          "container": "ScopeManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
          "lines": "92-97",
          "snippet": "bool ScopeManager::hasSessionScope(const std::string& sessioncookie)\n  {\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    return it != sessionScopes.end();\n  }",
          "includes": [
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/httprequest.h\"",
            "#include \"tnt/sessionscope.h\"",
            "#include \"tnt/scopemanager.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  bool ScopeManager::hasSessionScope(const std::string& sessioncookie)\n    {\n      cxxtools::MutexLock lock(sessionScopesMutex);\n      sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n      return it != sessionScopes.end();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.getSecureSessionScope",
          "args": [],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.setCookie",
          "args": [
            "currentSecureSessionCookieName",
            "cookie"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "setCookie",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "498-505",
          "snippet": "void HttpReply::setCookie(const std::string& name, const Cookie& value)\n  {\n    log_debug(\"setCookie(\\\"\" << name << \"\\\",\\\"\" << value.getValue() << \"\\\")\");\n    tnt::Cookie cookie(value);\n    if (!cookie.hasPath())\n      cookie.setPath(\"/\");\n    httpcookies.setCookie(name, cookie);\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::setCookie(const std::string& name, const Cookie& value)\n    {\n      log_debug(\"setCookie(\\\"\" << name << \"\\\",\\\"\" << value.getValue() << \"\\\")\");\n      tnt::Cookie cookie(value);\n      if (!cookie.hasPath())\n        cookie.setPath(\"/\");\n      httpcookies.setCookie(name, cookie);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cookie.setSecure",
          "args": [],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "setSecure",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "114-114",
          "snippet": "void setSecure(bool f = true)              { secureFlag = f; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  void setSecure(bool f = true)              { secureFlag = f; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"create new secure session \" << sessionId"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getHexDigest",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::pthread_self",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSerial",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "getSerial",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "187-187",
          "snippet": "cxxtools::atomic_t getSerial() const   { return serial; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  cxxtools::atomic_t getSerial() const   { return serial; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionId.empty",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.getCookie",
          "args": [
            "currentSecureSessionCookieName"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "getCookie",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "205-206",
          "snippet": "Cookie getCookie(const std::string& name) const\n        { return getCookies().getCookie(name); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  Cookie getCookie(const std::string& name) const\n          { return getCookies().getCookie(name); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.hasSecureSessionScope",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "hasSecureSessionScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "615-618",
          "snippet": "bool HttpRequest::hasSecureSessionScope() const\n  {\n    return secureSessionScope != 0 && !secureSessionScope->empty();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  bool HttpRequest::hasSecureSessionScope() const\n    {\n      return secureSessionScope != 0 && !secureSessionScope->empty();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.isSsl",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "isSsl",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "158-161",
          "snippet": "bool SslTcpjob::isSsl() const\n  {\n    return true;\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  bool SslTcpjob::isSsl() const\n    {\n      return true;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.getSessionScope",
          "args": [],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSessionScope",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"create new session \" << sessionId"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getHexDigest",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::pthread_self",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.hasSessionScope",
          "args": [],
          "line": 265
        },
        "resolved": true,
        "details": {
          "function_name": "hasSessionScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "610-613",
          "snippet": "bool HttpRequest::hasSessionScope() const\n  {\n    return sessionScope != 0 && !sessionScope->empty();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  bool HttpRequest::hasSessionScope() const\n    {\n      return sessionScope != 0 && !sessionScope->empty();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "removeSessionScope",
          "args": [
            "secureSessionId"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "removeSessionScope",
          "container": "ScopeManager",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
          "lines": "128-138",
          "snippet": "void ScopeManager::removeSessionScope(const std::string& sessioncookie)\n  {\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    if (it != sessionScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      sessionScopes.erase(it);\n    }\n  }",
          "includes": [
            "#include <stdlib.h>",
            "#include <pthread.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/httprequest.h\"",
            "#include \"tnt/sessionscope.h\"",
            "#include \"tnt/scopemanager.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  void ScopeManager::removeSessionScope(const std::string& sessioncookie)\n    {\n      cxxtools::MutexLock lock(sessionScopesMutex);\n      sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n      if (it != sessionScopes.end())\n      {\n        if (it->second->release() == 0)\n          delete it->second;\n        sessionScopes.erase(it);\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reply.isClearSession",
          "args": [],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "isClearSession",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "216-219",
          "snippet": "bool HttpReply::isClearSession() const\n  {\n    return impl->clearSession;\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  bool HttpReply::isClearSession() const\n    {\n      return impl->clearSession;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"stntnet\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"tntnet\""
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  std::string ScopeManager::postCall(HttpRequest& request, HttpReply& reply, const std::string& app)\n    {\n      std::string currentSessionCookieName = app.empty() ? std::string(\"tntnet\") : \"tntnet.\" + app;\n      std::string currentSecureSessionCookieName = app.empty() ? std::string(\"stntnet\") : \"stntnet.\" + app;\n  \n      std::string sessionId;\n  \n      if (reply.isClearSession())\n      {\n        sessionId = request.getCookie(currentSessionCookieName);\n        if (!sessionId.empty())\n          removeSessionScope(sessionId);\n  \n        std::string secureSessionId = request.getCookie(currentSecureSessionCookieName);\n        if (!secureSessionId.empty())\n          removeSessionScope(secureSessionId);\n      }\n      else\n      {\n        if (request.hasSessionScope())\n        {\n          // request has session scope\n          sessionId = request.getCookie(currentSessionCookieName);\n          if (sessionId.empty())\n          {\n            // client has no sessionId\n  \n            cxxtools::Md5stream c;\n            c << request.getSerial() << '-' << ::pthread_self() << '-' << rand();\n            sessionId = c.getHexDigest();\n            log_info(\"create new session \" << sessionId);\n            reply.setCookie(currentSessionCookieName, sessionId);\n            putSessionScope(sessionId, &request.getSessionScope());\n          }\n          else if (!hasSessionScope(sessionId))\n          {\n            // client has a sessionId but no associated session\n            // this may happen, when tntnet is restarted while the browser has a session\n  \n            putSessionScope(sessionId, &request.getSessionScope());\n          }\n        }\n  \n        if (request.isSsl() && request.hasSecureSessionScope())\n        {\n          // request has secure session scope\n          std::string sessionId = request.getCookie(currentSecureSessionCookieName);\n          if (sessionId.empty())\n          {\n            // client has no sessionId\n  \n            cxxtools::Md5stream c;\n            c << request.getSerial() << '-' << ::pthread_self() << '-' << rand();\n            sessionId = c.getHexDigest();\n            log_info(\"create new secure session \" << sessionId);\n            tnt::Cookie cookie(sessionId);\n            cookie.setSecure();\n            reply.setCookie(currentSecureSessionCookieName, cookie);\n            putSessionScope(sessionId, &request.getSecureSessionScope());\n          }\n          else if (!hasSessionScope(sessionId))\n          {\n            // client has a sessionId but no associated session\n            // this may happen, when tntnet is restarted while the browser has a session\n  \n            putSessionScope(sessionId, &request.getSecureSessionScope());\n          }\n        }\n      }\n  \n      return sessionId;\n    }\n}"
  },
  {
    "function_name": "setSessionId",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "229-244",
    "snippet": "void ScopeManager::setSessionId(HttpRequest& request, const std::string& sessionId)\n  {\n    if (sessionId.empty())\n    {\n      request.setSessionScope(0);\n    }\n    else\n    {\n      Sessionscope* sessionScope = getSessionScope(sessionId);\n      if (sessionScope != 0)\n      {\n        log_debug(\"session found\");\n        request.setSessionScope(sessionScope);\n      }\n    }\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request.setSessionScope",
          "args": [
            "sessionScope"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "setSessionScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "478-498",
          "snippet": "void HttpRequest::setSessionScope(Sessionscope* s)\n  {\n    if (sessionScope == s)\n      return;\n\n    if (sessionScope)\n    {\n      if (sessionScopeLocked)\n      {\n        sessionScope->unlock();\n        sessionScopeLocked = false;\n      }\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n    }\n\n    if (s)\n      s->addRef();\n\n    sessionScope = s;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::setSessionScope(Sessionscope* s)\n    {\n      if (sessionScope == s)\n        return;\n  \n      if (sessionScope)\n      {\n        if (sessionScopeLocked)\n        {\n          sessionScope->unlock();\n          sessionScopeLocked = false;\n        }\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n      }\n  \n      if (s)\n        s->addRef();\n  \n      sessionScope = s;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session found\""
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSessionScope",
          "args": [
            "sessionId"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionId.empty",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  void ScopeManager::setSessionId(HttpRequest& request, const std::string& sessionId)\n    {\n      if (sessionId.empty())\n      {\n        request.setSessionScope(0);\n      }\n      else\n      {\n        Sessionscope* sessionScope = getSessionScope(sessionId);\n        if (sessionScope != 0)\n        {\n          log_debug(\"session found\");\n          request.setSessionScope(sessionScope);\n        }\n      }\n    }\n}"
  },
  {
    "function_name": "preCall",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "140-227",
    "snippet": "void ScopeManager::preCall(HttpRequest& request, const std::string& app)\n  {\n    // check session-cookie\n    std::string currentSessionCookieName = app.empty() ? std::string(\"tntnet\") : \"tntnet.\" + app;\n    std::string currentSecureSessionCookieName = app.empty() ? std::string(\"stntnet\") : \"stntnet.\" + app;\n\n    Cookie c = request.getCookie(currentSessionCookieName);\n    if (c.getValue().empty())\n    {\n      /*\n      cxxtools::MutexLock lock(sessionScopesMutex);\n      log_debug(sessionScopes.size() << \" sessions available\");\n      for (sessionscopes_type::iterator it = sessionScopes.begin(); it != sessionScopes.end(); ++it)\n        log_debug(\"available session \" << it->first << \" value \" << it->second);\n        */\n\n      log_debug(\"session cookie \" << currentSessionCookieName << \" not found - keep session\");\n    }\n    else\n    {\n      log_debug(\"session cookie \" << currentSessionCookieName << \" found: \" << c.getValue());\n\n      cxxtools::MutexLock lock(sessionScopesMutex);\n\n      Sessionscope* sessionScope;\n\n      sessionscopes_type::iterator it = sessionScopes.find(c.getValue());\n      if (it == sessionScopes.end())\n      {\n        log_debug(\"session not found - create new\");\n        sessionScope = new Sessionscope();\n        sessionScope->addRef();\n        sessionScopes.insert(sessionscopes_type::value_type(c.getValue(), sessionScope));\n      }\n      else\n      {\n        log_debug(\"session found\");\n        sessionScope = it->second;\n        sessionScope->touch();\n      }\n\n      request.setSessionScope(sessionScope);\n    }\n\n    if (request.isSsl())\n    {\n      c = request.getCookie(currentSecureSessionCookieName);\n      if (c.getValue().empty())\n      {\n        log_debug(\"secure session cookie \" << currentSessionCookieName\n            << \" not found - keep session\");\n      }\n      else if (request.isSsl())\n      {\n        log_debug(\"secure session cookie \" << currentSessionCookieName\n            << \" found: \" << c.getValue());\n\n        cxxtools::MutexLock lock(sessionScopesMutex);\n\n        Sessionscope* sessionScope;\n\n        sessionscopes_type::iterator it = sessionScopes.find(c.getValue());\n        if (it == sessionScopes.end())\n        {\n          log_debug(\"session not found - create new\");\n          sessionScope = new Sessionscope();\n          sessionScope->addRef();\n          sessionScopes.insert(sessionscopes_type::value_type(c.getValue(), sessionScope));\n        }\n        else\n        {\n          log_debug(\"session found\");\n          sessionScope = it->second;\n          sessionScope->touch();\n        }\n\n        request.setSecureSessionScope(sessionScope);\n      }\n    }\n    else\n    {\n      log_debug(\"secure session cookie \" << currentSessionCookieName\n          << \" not checked in non ssl request\");\n    }\n\n    // set application-scope\n    request.setApplicationScope(getApplicationScope(app));\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request.setApplicationScope",
          "args": [
            "getApplicationScope(app)"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "setApplicationScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "461-476",
          "snippet": "void HttpRequest::setApplicationScope(Scope* s)\n  {\n    if (applicationScope == s)\n      return;\n\n    if (applicationScope)\n    {\n      releaseApplicationScopeLock();\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n    }\n\n    if (s)\n      s->addRef();\n    applicationScope = s;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::setApplicationScope(Scope* s)\n    {\n      if (applicationScope == s)\n        return;\n  \n      if (applicationScope)\n      {\n        releaseApplicationScopeLock();\n        if (applicationScope->release() == 0)\n          delete applicationScope;\n      }\n  \n      if (s)\n        s->addRef();\n      applicationScope = s;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getApplicationScope",
          "args": [
            "app"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"secure session cookie \" << currentSessionCookieName\n          << \" not checked in non ssl request\""
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.setSecureSessionScope",
          "args": [
            "sessionScope"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "setSecureSessionScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "500-520",
          "snippet": "void HttpRequest::setSecureSessionScope(Sessionscope* s)\n  {\n    if (secureSessionScope == s)\n      return;\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScopeLocked)\n      {\n        secureSessionScope->unlock();\n        secureSessionScopeLocked = false;\n      }\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n    }\n\n    if (s)\n      s->addRef();\n\n    secureSessionScope = s;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::setSecureSessionScope(Sessionscope* s)\n    {\n      if (secureSessionScope == s)\n        return;\n  \n      if (secureSessionScope)\n      {\n        if (secureSessionScopeLocked)\n        {\n          secureSessionScope->unlock();\n          secureSessionScopeLocked = false;\n        }\n        if (secureSessionScope->release() == 0)\n          delete secureSessionScope;\n      }\n  \n      if (s)\n        s->addRef();\n  \n      secureSessionScope = s;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScope->touch",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "touch",
          "container": "Worker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/worker.cpp",
          "lines": "522-525",
          "snippet": "void Worker::touch()\n  {\n    time(&lastWaitTime);\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <string.h>",
            "#include <pthread.h>",
            "#include <cxxtools/net/tcpserver.h>",
            "#include <cxxtools/atomicity.h>",
            "#include <cxxtools/ioerror.h>",
            "#include <cxxtools/dlloader.h>",
            "#include <sys/poll.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include \"tnt/job.h\"",
            "#include \"tnt/dispatcher.h\"",
            "#include \"tnt/worker.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <string.h>\n#include <pthread.h>\n#include <cxxtools/net/tcpserver.h>\n#include <cxxtools/atomicity.h>\n#include <cxxtools/ioerror.h>\n#include <cxxtools/dlloader.h>\n#include <sys/poll.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/poller.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include \"tnt/job.h\"\n#include \"tnt/dispatcher.h\"\n#include \"tnt/worker.h\"\n\nWorker {\n  void Worker::touch()\n    {\n      time(&lastWaitTime);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session found\""
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScopes.insert",
          "args": [
            "sessionscopes_type::value_type(c.getValue(), sessionScope)"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionscopes_type::value_type",
          "args": [
            "c.getValue()",
            "sessionScope"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScope->addRef",
          "args": [],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "Zdata",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
          "lines": "40-60",
          "snippet": "void Zdata::addRef()\n  {\n    if (cxxtools::atomicIncrement(refs) == 1)\n    {\n      // allocate uncompressed data\n      data = new char[data_len];\n\n      // uncompress Zdata => data\n      log_debug(\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\");\n      uLong dest_len = data_len;\n      int z_ret = uncompress((Bytef*)data, &dest_len, (const Bytef*)zptr, zdata_len);\n      if (z_ret != Z_OK)\n      {\n        throwRuntimeError(std::string(\"error uncompressing data: \") +\n          (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n           z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n           z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\"));\n      }\n      log_debug(\"uncompress ready\");\n    }\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <stdexcept>",
            "#include <zlib.h>",
            "#include <tnt/util.h>",
            "#include <tnt/zdata.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nZdata {\n  void Zdata::addRef()\n    {\n      if (cxxtools::atomicIncrement(refs) == 1)\n      {\n        // allocate uncompressed data\n        data = new char[data_len];\n  \n        // uncompress Zdata => data\n        log_debug(\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\");\n        uLong dest_len = data_len;\n        int z_ret = uncompress((Bytef*)data, &dest_len, (const Bytef*)zptr, zdata_len);\n        if (z_ret != Z_OK)\n        {\n          throwRuntimeError(std::string(\"error uncompressing data: \") +\n            (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n             z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n             z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\"));\n        }\n        log_debug(\"uncompress ready\");\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session not found - create new\""
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.find",
          "args": [
            "c.getValue()"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"secure session cookie \" << currentSessionCookieName\n            << \" found: \" << c.getValue()"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.isSsl",
          "args": [],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "isSsl",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "158-161",
          "snippet": "bool SslTcpjob::isSsl() const\n  {\n    return true;\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  bool SslTcpjob::isSsl() const\n    {\n      return true;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"secure session cookie \" << currentSessionCookieName\n            << \" not found - keep session\""
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getCookie",
          "args": [
            "currentSecureSessionCookieName"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "getCookie",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "205-206",
          "snippet": "Cookie getCookie(const std::string& name) const\n        { return getCookies().getCookie(name); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  Cookie getCookie(const std::string& name) const\n          { return getCookies().getCookie(name); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.setSessionScope",
          "args": [
            "sessionScope"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "setSessionScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "478-498",
          "snippet": "void HttpRequest::setSessionScope(Sessionscope* s)\n  {\n    if (sessionScope == s)\n      return;\n\n    if (sessionScope)\n    {\n      if (sessionScopeLocked)\n      {\n        sessionScope->unlock();\n        sessionScopeLocked = false;\n      }\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n    }\n\n    if (s)\n      s->addRef();\n\n    sessionScope = s;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::setSessionScope(Sessionscope* s)\n    {\n      if (sessionScope == s)\n        return;\n  \n      if (sessionScope)\n      {\n        if (sessionScopeLocked)\n        {\n          sessionScope->unlock();\n          sessionScopeLocked = false;\n        }\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n      }\n  \n      if (s)\n        s->addRef();\n  \n      sessionScope = s;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session found\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScopes.insert",
          "args": [
            "sessionscopes_type::value_type(c.getValue(), sessionScope)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionscopes_type::value_type",
          "args": [
            "c.getValue()",
            "sessionScope"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session not found - create new\""
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session cookie \" << currentSessionCookieName << \" found: \" << c.getValue()"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session cookie \" << currentSessionCookieName << \" not found - keep session\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"stntnet\""
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "app.empty",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"tntnet\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  void ScopeManager::preCall(HttpRequest& request, const std::string& app)\n    {\n      // check session-cookie\n      std::string currentSessionCookieName = app.empty() ? std::string(\"tntnet\") : \"tntnet.\" + app;\n      std::string currentSecureSessionCookieName = app.empty() ? std::string(\"stntnet\") : \"stntnet.\" + app;\n  \n      Cookie c = request.getCookie(currentSessionCookieName);\n      if (c.getValue().empty())\n      {\n        /*\n        cxxtools::MutexLock lock(sessionScopesMutex);\n        log_debug(sessionScopes.size() << \" sessions available\");\n        for (sessionscopes_type::iterator it = sessionScopes.begin(); it != sessionScopes.end(); ++it)\n          log_debug(\"available session \" << it->first << \" value \" << it->second);\n          */\n  \n        log_debug(\"session cookie \" << currentSessionCookieName << \" not found - keep session\");\n      }\n      else\n      {\n        log_debug(\"session cookie \" << currentSessionCookieName << \" found: \" << c.getValue());\n  \n        cxxtools::MutexLock lock(sessionScopesMutex);\n  \n        Sessionscope* sessionScope;\n  \n        sessionscopes_type::iterator it = sessionScopes.find(c.getValue());\n        if (it == sessionScopes.end())\n        {\n          log_debug(\"session not found - create new\");\n          sessionScope = new Sessionscope();\n          sessionScope->addRef();\n          sessionScopes.insert(sessionscopes_type::value_type(c.getValue(), sessionScope));\n        }\n        else\n        {\n          log_debug(\"session found\");\n          sessionScope = it->second;\n          sessionScope->touch();\n        }\n  \n        request.setSessionScope(sessionScope);\n      }\n  \n      if (request.isSsl())\n      {\n        c = request.getCookie(currentSecureSessionCookieName);\n        if (c.getValue().empty())\n        {\n          log_debug(\"secure session cookie \" << currentSessionCookieName\n              << \" not found - keep session\");\n        }\n        else if (request.isSsl())\n        {\n          log_debug(\"secure session cookie \" << currentSessionCookieName\n              << \" found: \" << c.getValue());\n  \n          cxxtools::MutexLock lock(sessionScopesMutex);\n  \n          Sessionscope* sessionScope;\n  \n          sessionscopes_type::iterator it = sessionScopes.find(c.getValue());\n          if (it == sessionScopes.end())\n          {\n            log_debug(\"session not found - create new\");\n            sessionScope = new Sessionscope();\n            sessionScope->addRef();\n            sessionScopes.insert(sessionscopes_type::value_type(c.getValue(), sessionScope));\n          }\n          else\n          {\n            log_debug(\"session found\");\n            sessionScope = it->second;\n            sessionScope->touch();\n          }\n  \n          request.setSecureSessionScope(sessionScope);\n        }\n      }\n      else\n      {\n        log_debug(\"secure session cookie \" << currentSessionCookieName\n            << \" not checked in non ssl request\");\n      }\n  \n      // set application-scope\n      request.setApplicationScope(getApplicationScope(app));\n    }\n}"
  },
  {
    "function_name": "removeSessionScope",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "128-138",
    "snippet": "void ScopeManager::removeSessionScope(const std::string& sessioncookie)\n  {\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    if (it != sessionScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      sessionScopes.erase(it);\n    }\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sessionScopes.erase",
          "args": [
            "it"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->second->release",
          "args": [],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "release",
          "container": "Zdata",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
          "lines": "62-70",
          "snippet": "void Zdata::release()\n  {\n    if (cxxtools::atomicDecrement(refs) == 0)\n    {\n      log_debug(\"release \" << data_len << \" uncompressed bytes\");\n      delete[] data;\n      data = 0;\n    }\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <stdexcept>",
            "#include <zlib.h>",
            "#include <tnt/util.h>",
            "#include <tnt/zdata.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nZdata {\n  void Zdata::release()\n    {\n      if (cxxtools::atomicDecrement(refs) == 0)\n      {\n        log_debug(\"release \" << data_len << \" uncompressed bytes\");\n        delete[] data;\n        data = 0;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.find",
          "args": [
            "sessioncookie"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  void ScopeManager::removeSessionScope(const std::string& sessioncookie)\n    {\n      cxxtools::MutexLock lock(sessionScopesMutex);\n      sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n      if (it != sessionScopes.end())\n      {\n        if (it->second->release() == 0)\n          delete it->second;\n        sessionScopes.erase(it);\n      }\n    }\n}"
  },
  {
    "function_name": "removeApplicationScope",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "116-126",
    "snippet": "void ScopeManager::removeApplicationScope(const std::string& appname)\n  {\n    cxxtools::MutexLock lock(applicationScopesMutex);\n    scopes_type::iterator it = applicationScopes.find(appname);\n    if (it != applicationScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      applicationScopes.erase(it);\n    }\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "applicationScopes.erase",
          "args": [
            "it"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->second->release",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "release",
          "container": "Zdata",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
          "lines": "62-70",
          "snippet": "void Zdata::release()\n  {\n    if (cxxtools::atomicDecrement(refs) == 0)\n    {\n      log_debug(\"release \" << data_len << \" uncompressed bytes\");\n      delete[] data;\n      data = 0;\n    }\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <stdexcept>",
            "#include <zlib.h>",
            "#include <tnt/util.h>",
            "#include <tnt/zdata.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nZdata {\n  void Zdata::release()\n    {\n      if (cxxtools::atomicDecrement(refs) == 0)\n      {\n        log_debug(\"release \" << data_len << \" uncompressed bytes\");\n        delete[] data;\n        data = 0;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "applicationScopes.end",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "applicationScopes.find",
          "args": [
            "appname"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  void ScopeManager::removeApplicationScope(const std::string& appname)\n    {\n      cxxtools::MutexLock lock(applicationScopesMutex);\n      scopes_type::iterator it = applicationScopes.find(appname);\n      if (it != applicationScopes.end())\n      {\n        if (it->second->release() == 0)\n          delete it->second;\n        applicationScopes.erase(it);\n      }\n    }\n}"
  },
  {
    "function_name": "putSessionScope",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "99-113",
    "snippet": "void ScopeManager::putSessionScope(const std::string& sessioncookie, Sessionscope* s)\n  {\n    s->addRef();\n\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    if (it != sessionScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      it->second = s;\n    }\n    else\n      sessionScopes[sessioncookie] = s;\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "it->second->release",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "release",
          "container": "Zdata",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
          "lines": "62-70",
          "snippet": "void Zdata::release()\n  {\n    if (cxxtools::atomicDecrement(refs) == 0)\n    {\n      log_debug(\"release \" << data_len << \" uncompressed bytes\");\n      delete[] data;\n      data = 0;\n    }\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <stdexcept>",
            "#include <zlib.h>",
            "#include <tnt/util.h>",
            "#include <tnt/zdata.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nZdata {\n  void Zdata::release()\n    {\n      if (cxxtools::atomicDecrement(refs) == 0)\n      {\n        log_debug(\"release \" << data_len << \" uncompressed bytes\");\n        delete[] data;\n        data = 0;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.find",
          "args": [
            "sessioncookie"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s->addRef",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "addRef",
          "container": "Zdata",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/zdata.cpp",
          "lines": "40-60",
          "snippet": "void Zdata::addRef()\n  {\n    if (cxxtools::atomicIncrement(refs) == 1)\n    {\n      // allocate uncompressed data\n      data = new char[data_len];\n\n      // uncompress Zdata => data\n      log_debug(\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\");\n      uLong dest_len = data_len;\n      int z_ret = uncompress((Bytef*)data, &dest_len, (const Bytef*)zptr, zdata_len);\n      if (z_ret != Z_OK)\n      {\n        throwRuntimeError(std::string(\"error uncompressing data: \") +\n          (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n           z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n           z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\"));\n      }\n      log_debug(\"uncompress ready\");\n    }\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <stdexcept>",
            "#include <zlib.h>",
            "#include <tnt/util.h>",
            "#include <tnt/zdata.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <stdexcept>\n#include <zlib.h>\n#include <tnt/util.h>\n#include <tnt/zdata.h>\n\nZdata {\n  void Zdata::addRef()\n    {\n      if (cxxtools::atomicIncrement(refs) == 1)\n      {\n        // allocate uncompressed data\n        data = new char[data_len];\n  \n        // uncompress Zdata => data\n        log_debug(\"uncompress \" << zdata_len << \" to \" << data_len << \" bytes\");\n        uLong dest_len = data_len;\n        int z_ret = uncompress((Bytef*)data, &dest_len, (const Bytef*)zptr, zdata_len);\n        if (z_ret != Z_OK)\n        {\n          throwRuntimeError(std::string(\"error uncompressing data: \") +\n            (z_ret == Z_MEM_ERROR ? \"Z_MEM_ERROR\" :\n             z_ret == Z_BUF_ERROR ? \"Z_BUF_ERROR\" :\n             z_ret == Z_DATA_ERROR ? \"Z_DATA_ERROR\" : \"unknown error\"));\n        }\n        log_debug(\"uncompress ready\");\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  void ScopeManager::putSessionScope(const std::string& sessioncookie, Sessionscope* s)\n    {\n      s->addRef();\n  \n      cxxtools::MutexLock lock(sessionScopesMutex);\n      sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n      if (it != sessionScopes.end())\n      {\n        if (it->second->release() == 0)\n          delete it->second;\n        it->second = s;\n      }\n      else\n        sessionScopes[sessioncookie] = s;\n    }\n}"
  },
  {
    "function_name": "hasSessionScope",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "92-97",
    "snippet": "bool ScopeManager::hasSessionScope(const std::string& sessioncookie)\n  {\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    return it != sessionScopes.end();\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.find",
          "args": [
            "sessioncookie"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  bool ScopeManager::hasSessionScope(const std::string& sessioncookie)\n    {\n      cxxtools::MutexLock lock(sessionScopesMutex);\n      sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n      return it != sessionScopes.end();\n    }\n}"
  },
  {
    "function_name": "~ScopeManager",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "47-53",
    "snippet": "ScopeManager::~ScopeManager()\n  {\n    for (sessionscopes_type::iterator it = sessionScopes.begin(); it != sessionScopes.end(); ++it)\n      delete it->second;\n    for (scopes_type::iterator it = applicationScopes.begin(); it != applicationScopes.end(); ++it)\n      delete it->second;\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "applicationScopes.end",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "applicationScopes.begin",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  ScopeManager::~ScopeManager()\n    {\n      for (sessionscopes_type::iterator it = sessionScopes.begin(); it != sessionScopes.end(); ++it)\n        delete it->second;\n      for (scopes_type::iterator it = applicationScopes.begin(); it != applicationScopes.end(); ++it)\n        delete it->second;\n    }\n}"
  },
  {
    "function_name": "ScopeManager",
    "container": "ScopeManager",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "43-45",
    "snippet": "ScopeManager::ScopeManager()\n  {\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager {\n  ScopeManager::ScopeManager()\n    {\n    }\n}"
  }
]