[
  {
    "function_name": "ScopeManager::checkSessionTimeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "319-343",
    "snippet": "void ScopeManager::checkSessionTimeout()\n  {\n    time_t currentTime;\n    time(&currentTime);\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.begin();\n    unsigned count = 0;\n    while (it != sessionScopes.end())\n    {\n      Sessionscope* s = it->second;\n      if (static_cast <unsigned> (currentTime - s->getAtime()) > s->getTimeout())\n      {\n        log_info(\"sessiontimeout for session \" << it->first << \" reached\");\n        sessionscopes_type::iterator it2 = it;\n        ++it;\n        if (s->release() == 0)\n          delete s;\n        sessionScopes.erase(it2);\n        ++count;\n      }\n      else\n        ++it;\n    }\n\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sessionScopes.erase",
          "args": [
            "it2"
          ],
          "line": 336
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s->release",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"sessiontimeout for session \" << it->first << \" reached\""
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s->getTimeout",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "getTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "51-51",
          "snippet": "unsigned getTimeout() const                { return timeout; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  unsigned getTimeout() const                { return timeout; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast <unsigned>",
          "args": [
            "currentTime - s->getAtime()"
          ],
          "line": 329
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s->getAtime",
          "args": [],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "getAtime",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "50-50",
          "snippet": "time_t getAtime() const                    { return atime; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  time_t getAtime() const                    { return atime; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.begin",
          "args": [],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "&currentTime"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nvoid ScopeManager::checkSessionTimeout()\n  {\n    time_t currentTime;\n    time(&currentTime);\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.begin();\n    unsigned count = 0;\n    while (it != sessionScopes.end())\n    {\n      Sessionscope* s = it->second;\n      if (static_cast <unsigned> (currentTime - s->getAtime()) > s->getTimeout())\n      {\n        log_info(\"sessiontimeout for session \" << it->first << \" reached\");\n        sessionscopes_type::iterator it2 = it;\n        ++it;\n        if (s->release() == 0)\n          delete s;\n        sessionScopes.erase(it2);\n        ++count;\n      }\n      else\n        ++it;\n    }\n\n  }"
  },
  {
    "function_name": "ScopeManager::postCall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "246-317",
    "snippet": "std::string ScopeManager::postCall(HttpRequest& request, HttpReply& reply, const std::string& app)\n  {\n    std::string currentSessionCookieName = app.empty() ? std::string(\"tntnet\") : \"tntnet.\" + app;\n    std::string currentSecureSessionCookieName = app.empty() ? std::string(\"stntnet\") : \"stntnet.\" + app;\n\n    std::string sessionId;\n\n    if (reply.isClearSession())\n    {\n      sessionId = request.getCookie(currentSessionCookieName);\n      if (!sessionId.empty())\n        removeSessionScope(sessionId);\n\n      std::string secureSessionId = request.getCookie(currentSecureSessionCookieName);\n      if (!secureSessionId.empty())\n        removeSessionScope(secureSessionId);\n    }\n    else\n    {\n      if (request.hasSessionScope())\n      {\n        // request has session scope\n        sessionId = request.getCookie(currentSessionCookieName);\n        if (sessionId.empty())\n        {\n          // client has no sessionId\n\n          cxxtools::Md5stream c;\n          c << request.getSerial() << '-' << ::pthread_self() << '-' << rand();\n          sessionId = c.getHexDigest();\n          log_info(\"create new session \" << sessionId);\n          reply.setCookie(currentSessionCookieName, sessionId);\n          putSessionScope(sessionId, &request.getSessionScope());\n        }\n        else if (!hasSessionScope(sessionId))\n        {\n          // client has a sessionId but no associated session\n          // this may happen, when tntnet is restarted while the browser has a session\n\n          putSessionScope(sessionId, &request.getSessionScope());\n        }\n      }\n\n      if (request.isSsl() && request.hasSecureSessionScope())\n      {\n        // request has secure session scope\n        std::string sessionId = request.getCookie(currentSecureSessionCookieName);\n        if (sessionId.empty())\n        {\n          // client has no sessionId\n\n          cxxtools::Md5stream c;\n          c << request.getSerial() << '-' << ::pthread_self() << '-' << rand();\n          sessionId = c.getHexDigest();\n          log_info(\"create new secure session \" << sessionId);\n          tnt::Cookie cookie(sessionId);\n          cookie.setSecure();\n          reply.setCookie(currentSecureSessionCookieName, cookie);\n          putSessionScope(sessionId, &request.getSecureSessionScope());\n        }\n        else if (!hasSessionScope(sessionId))\n        {\n          // client has a sessionId but no associated session\n          // this may happen, when tntnet is restarted while the browser has a session\n\n          putSessionScope(sessionId, &request.getSecureSessionScope());\n        }\n      }\n    }\n\n    return sessionId;\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "putSessionScope",
          "args": [
            "sessionId",
            "&request.getSecureSessionScope()"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSecureSessionScope",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hasSessionScope",
          "args": [
            "sessionId"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "putSessionScope",
          "args": [
            "sessionId",
            "&request.getSecureSessionScope()"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSecureSessionScope",
          "args": [],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.setCookie",
          "args": [
            "currentSecureSessionCookieName",
            "cookie"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "setCookie",
          "container": "Cookies",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "145-146",
          "snippet": "void setCookie(const std::string& name, const Cookie& value_)\n        { data[name] = value_; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookies {\n  void setCookie(const std::string& name, const Cookie& value_)\n          { data[name] = value_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cookie.setSecure",
          "args": [],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "setSecure",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "114-114",
          "snippet": "void setSecure(bool f = true)              { secureFlag = f; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  void setSecure(bool f = true)              { secureFlag = f; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"create new secure session \" << sessionId"
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getHexDigest",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::pthread_self",
          "args": [],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSerial",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "getSerial",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "187-187",
          "snippet": "cxxtools::atomic_t getSerial() const   { return serial; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  cxxtools::atomic_t getSerial() const   { return serial; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionId.empty",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.getCookie",
          "args": [
            "currentSecureSessionCookieName"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "getCookie",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "205-206",
          "snippet": "Cookie getCookie(const std::string& name) const\n        { return getCookies().getCookie(name); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  Cookie getCookie(const std::string& name) const\n          { return getCookies().getCookie(name); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.hasSecureSessionScope",
          "args": [],
          "line": 289
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.isSsl",
          "args": [],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "isSsl",
          "container": "Cmd::NullSocketIf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cmd.h",
          "lines": "60-61",
          "snippet": "bool isSsl() const\n          { return false; }",
          "includes": [
            "#include <tnt/component.h>",
            "#include <tnt/compident.h>",
            "#include <tnt/comploader.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include <tnt/tntnet.h>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/component.h>\n#include <tnt/compident.h>\n#include <tnt/comploader.h>\n#include <tnt/scopemanager.h>\n#include <tnt/scope.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include <tnt/tntnet.h>\n#include <iosfwd>\n\nCmd {\n  NullSocketIf {\n    bool isSsl() const\n              { return false; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "putSessionScope",
          "args": [
            "sessionId",
            "&request.getSessionScope()"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSessionScope",
          "args": [],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hasSessionScope",
          "args": [
            "sessionId"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "putSessionScope",
          "args": [
            "sessionId",
            "&request.getSessionScope()"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getSessionScope",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"create new session \" << sessionId"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getHexDigest",
          "args": [],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rand",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::pthread_self",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.hasSessionScope",
          "args": [],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "removeSessionScope",
          "args": [
            "secureSessionId"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "removeSessionScope",
          "args": [
            "sessionId"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reply.isClearSession",
          "args": [],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"stntnet\""
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"tntnet\""
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nstd::string ScopeManager::postCall(HttpRequest& request, HttpReply& reply, const std::string& app)\n  {\n    std::string currentSessionCookieName = app.empty() ? std::string(\"tntnet\") : \"tntnet.\" + app;\n    std::string currentSecureSessionCookieName = app.empty() ? std::string(\"stntnet\") : \"stntnet.\" + app;\n\n    std::string sessionId;\n\n    if (reply.isClearSession())\n    {\n      sessionId = request.getCookie(currentSessionCookieName);\n      if (!sessionId.empty())\n        removeSessionScope(sessionId);\n\n      std::string secureSessionId = request.getCookie(currentSecureSessionCookieName);\n      if (!secureSessionId.empty())\n        removeSessionScope(secureSessionId);\n    }\n    else\n    {\n      if (request.hasSessionScope())\n      {\n        // request has session scope\n        sessionId = request.getCookie(currentSessionCookieName);\n        if (sessionId.empty())\n        {\n          // client has no sessionId\n\n          cxxtools::Md5stream c;\n          c << request.getSerial() << '-' << ::pthread_self() << '-' << rand();\n          sessionId = c.getHexDigest();\n          log_info(\"create new session \" << sessionId);\n          reply.setCookie(currentSessionCookieName, sessionId);\n          putSessionScope(sessionId, &request.getSessionScope());\n        }\n        else if (!hasSessionScope(sessionId))\n        {\n          // client has a sessionId but no associated session\n          // this may happen, when tntnet is restarted while the browser has a session\n\n          putSessionScope(sessionId, &request.getSessionScope());\n        }\n      }\n\n      if (request.isSsl() && request.hasSecureSessionScope())\n      {\n        // request has secure session scope\n        std::string sessionId = request.getCookie(currentSecureSessionCookieName);\n        if (sessionId.empty())\n        {\n          // client has no sessionId\n\n          cxxtools::Md5stream c;\n          c << request.getSerial() << '-' << ::pthread_self() << '-' << rand();\n          sessionId = c.getHexDigest();\n          log_info(\"create new secure session \" << sessionId);\n          tnt::Cookie cookie(sessionId);\n          cookie.setSecure();\n          reply.setCookie(currentSecureSessionCookieName, cookie);\n          putSessionScope(sessionId, &request.getSecureSessionScope());\n        }\n        else if (!hasSessionScope(sessionId))\n        {\n          // client has a sessionId but no associated session\n          // this may happen, when tntnet is restarted while the browser has a session\n\n          putSessionScope(sessionId, &request.getSecureSessionScope());\n        }\n      }\n    }\n\n    return sessionId;\n  }"
  },
  {
    "function_name": "ScopeManager::setSessionId",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "229-244",
    "snippet": "void ScopeManager::setSessionId(HttpRequest& request, const std::string& sessionId)\n  {\n    if (sessionId.empty())\n    {\n      request.setSessionScope(0);\n    }\n    else\n    {\n      Sessionscope* sessionScope = getSessionScope(sessionId);\n      if (sessionScope != 0)\n      {\n        log_debug(\"session found\");\n        request.setSessionScope(sessionScope);\n      }\n    }\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request.setSessionScope",
          "args": [
            "sessionScope"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "setSessionScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "225-225",
          "snippet": "void setSessionScope(Sessionscope& s)      { setSessionScope(&s); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setSessionScope(Sessionscope& s)      { setSessionScope(&s); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session found\""
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getSessionScope",
          "args": [
            "sessionId"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionId.empty",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nvoid ScopeManager::setSessionId(HttpRequest& request, const std::string& sessionId)\n  {\n    if (sessionId.empty())\n    {\n      request.setSessionScope(0);\n    }\n    else\n    {\n      Sessionscope* sessionScope = getSessionScope(sessionId);\n      if (sessionScope != 0)\n      {\n        log_debug(\"session found\");\n        request.setSessionScope(sessionScope);\n      }\n    }\n  }"
  },
  {
    "function_name": "ScopeManager::preCall",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "140-227",
    "snippet": "void ScopeManager::preCall(HttpRequest& request, const std::string& app)\n  {\n    // check session-cookie\n    std::string currentSessionCookieName = app.empty() ? std::string(\"tntnet\") : \"tntnet.\" + app;\n    std::string currentSecureSessionCookieName = app.empty() ? std::string(\"stntnet\") : \"stntnet.\" + app;\n\n    Cookie c = request.getCookie(currentSessionCookieName);\n    if (c.getValue().empty())\n    {\n      /*\n      cxxtools::MutexLock lock(sessionScopesMutex);\n      log_debug(sessionScopes.size() << \" sessions available\");\n      for (sessionscopes_type::iterator it = sessionScopes.begin(); it != sessionScopes.end(); ++it)\n        log_debug(\"available session \" << it->first << \" value \" << it->second);\n        */\n\n      log_debug(\"session cookie \" << currentSessionCookieName << \" not found - keep session\");\n    }\n    else\n    {\n      log_debug(\"session cookie \" << currentSessionCookieName << \" found: \" << c.getValue());\n\n      cxxtools::MutexLock lock(sessionScopesMutex);\n\n      Sessionscope* sessionScope;\n\n      sessionscopes_type::iterator it = sessionScopes.find(c.getValue());\n      if (it == sessionScopes.end())\n      {\n        log_debug(\"session not found - create new\");\n        sessionScope = new Sessionscope();\n        sessionScope->addRef();\n        sessionScopes.insert(sessionscopes_type::value_type(c.getValue(), sessionScope));\n      }\n      else\n      {\n        log_debug(\"session found\");\n        sessionScope = it->second;\n        sessionScope->touch();\n      }\n\n      request.setSessionScope(sessionScope);\n    }\n\n    if (request.isSsl())\n    {\n      c = request.getCookie(currentSecureSessionCookieName);\n      if (c.getValue().empty())\n      {\n        log_debug(\"secure session cookie \" << currentSessionCookieName\n            << \" not found - keep session\");\n      }\n      else if (request.isSsl())\n      {\n        log_debug(\"secure session cookie \" << currentSessionCookieName\n            << \" found: \" << c.getValue());\n\n        cxxtools::MutexLock lock(sessionScopesMutex);\n\n        Sessionscope* sessionScope;\n\n        sessionscopes_type::iterator it = sessionScopes.find(c.getValue());\n        if (it == sessionScopes.end())\n        {\n          log_debug(\"session not found - create new\");\n          sessionScope = new Sessionscope();\n          sessionScope->addRef();\n          sessionScopes.insert(sessionscopes_type::value_type(c.getValue(), sessionScope));\n        }\n        else\n        {\n          log_debug(\"session found\");\n          sessionScope = it->second;\n          sessionScope->touch();\n        }\n\n        request.setSecureSessionScope(sessionScope);\n      }\n    }\n    else\n    {\n      log_debug(\"secure session cookie \" << currentSessionCookieName\n          << \" not checked in non ssl request\");\n    }\n\n    // set application-scope\n    request.setApplicationScope(getApplicationScope(app));\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request.setApplicationScope",
          "args": [
            "getApplicationScope(app)"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "setApplicationScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "222-222",
          "snippet": "void setApplicationScope(Scope& s)  { setApplicationScope(&s); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setApplicationScope(Scope& s)  { setApplicationScope(&s); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getApplicationScope",
          "args": [
            "app"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"secure session cookie \" << currentSessionCookieName\n          << \" not checked in non ssl request\""
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.setSecureSessionScope",
          "args": [
            "sessionScope"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "setSecureSessionScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "227-227",
          "snippet": "void setSecureSessionScope(Sessionscope& s)      { setSecureSessionScope(&s); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setSecureSessionScope(Sessionscope& s)      { setSecureSessionScope(&s); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScope->touch",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "touch",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "49-49",
          "snippet": "void touch()                               { time(&atime); }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void touch()                               { time(&atime); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session found\""
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScopes.insert",
          "args": [
            "sessionscopes_type::value_type(c.getValue(), sessionScope)"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionscopes_type::value_type",
          "args": [
            "c.getValue()",
            "sessionScope"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScope->addRef",
          "args": [],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session not found - create new\""
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.find",
          "args": [
            "c.getValue()"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"secure session cookie \" << currentSessionCookieName\n            << \" found: \" << c.getValue()"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.isSsl",
          "args": [],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "isSsl",
          "container": "Cmd::NullSocketIf",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cmd.h",
          "lines": "60-61",
          "snippet": "bool isSsl() const\n          { return false; }",
          "includes": [
            "#include <tnt/component.h>",
            "#include <tnt/compident.h>",
            "#include <tnt/comploader.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include <tnt/tntnet.h>",
            "#include <iosfwd>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/component.h>\n#include <tnt/compident.h>\n#include <tnt/comploader.h>\n#include <tnt/scopemanager.h>\n#include <tnt/scope.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include <tnt/tntnet.h>\n#include <iosfwd>\n\nCmd {\n  NullSocketIf {\n    bool isSsl() const\n              { return false; }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"secure session cookie \" << currentSessionCookieName\n            << \" not found - keep session\""
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getCookie",
          "args": [
            "currentSecureSessionCookieName"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "getCookie",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "205-206",
          "snippet": "Cookie getCookie(const std::string& name) const\n        { return getCookies().getCookie(name); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  Cookie getCookie(const std::string& name) const\n          { return getCookies().getCookie(name); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.setSessionScope",
          "args": [
            "sessionScope"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "setSessionScope",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "225-225",
          "snippet": "void setSessionScope(Sessionscope& s)      { setSessionScope(&s); }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setSessionScope(Sessionscope& s)      { setSessionScope(&s); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session found\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScopes.insert",
          "args": [
            "sessionscopes_type::value_type(c.getValue(), sessionScope)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionscopes_type::value_type",
          "args": [
            "c.getValue()",
            "sessionScope"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScope->addRef",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session not found - create new\""
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session cookie \" << currentSessionCookieName << \" found: \" << c.getValue()"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"session cookie \" << currentSessionCookieName << \" not found - keep session\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.getValue",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"stntnet\""
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "app.empty",
          "args": [],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"tntnet\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nvoid ScopeManager::preCall(HttpRequest& request, const std::string& app)\n  {\n    // check session-cookie\n    std::string currentSessionCookieName = app.empty() ? std::string(\"tntnet\") : \"tntnet.\" + app;\n    std::string currentSecureSessionCookieName = app.empty() ? std::string(\"stntnet\") : \"stntnet.\" + app;\n\n    Cookie c = request.getCookie(currentSessionCookieName);\n    if (c.getValue().empty())\n    {\n      /*\n      cxxtools::MutexLock lock(sessionScopesMutex);\n      log_debug(sessionScopes.size() << \" sessions available\");\n      for (sessionscopes_type::iterator it = sessionScopes.begin(); it != sessionScopes.end(); ++it)\n        log_debug(\"available session \" << it->first << \" value \" << it->second);\n        */\n\n      log_debug(\"session cookie \" << currentSessionCookieName << \" not found - keep session\");\n    }\n    else\n    {\n      log_debug(\"session cookie \" << currentSessionCookieName << \" found: \" << c.getValue());\n\n      cxxtools::MutexLock lock(sessionScopesMutex);\n\n      Sessionscope* sessionScope;\n\n      sessionscopes_type::iterator it = sessionScopes.find(c.getValue());\n      if (it == sessionScopes.end())\n      {\n        log_debug(\"session not found - create new\");\n        sessionScope = new Sessionscope();\n        sessionScope->addRef();\n        sessionScopes.insert(sessionscopes_type::value_type(c.getValue(), sessionScope));\n      }\n      else\n      {\n        log_debug(\"session found\");\n        sessionScope = it->second;\n        sessionScope->touch();\n      }\n\n      request.setSessionScope(sessionScope);\n    }\n\n    if (request.isSsl())\n    {\n      c = request.getCookie(currentSecureSessionCookieName);\n      if (c.getValue().empty())\n      {\n        log_debug(\"secure session cookie \" << currentSessionCookieName\n            << \" not found - keep session\");\n      }\n      else if (request.isSsl())\n      {\n        log_debug(\"secure session cookie \" << currentSessionCookieName\n            << \" found: \" << c.getValue());\n\n        cxxtools::MutexLock lock(sessionScopesMutex);\n\n        Sessionscope* sessionScope;\n\n        sessionscopes_type::iterator it = sessionScopes.find(c.getValue());\n        if (it == sessionScopes.end())\n        {\n          log_debug(\"session not found - create new\");\n          sessionScope = new Sessionscope();\n          sessionScope->addRef();\n          sessionScopes.insert(sessionscopes_type::value_type(c.getValue(), sessionScope));\n        }\n        else\n        {\n          log_debug(\"session found\");\n          sessionScope = it->second;\n          sessionScope->touch();\n        }\n\n        request.setSecureSessionScope(sessionScope);\n      }\n    }\n    else\n    {\n      log_debug(\"secure session cookie \" << currentSessionCookieName\n          << \" not checked in non ssl request\");\n    }\n\n    // set application-scope\n    request.setApplicationScope(getApplicationScope(app));\n  }"
  },
  {
    "function_name": "ScopeManager::removeSessionScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "128-138",
    "snippet": "void ScopeManager::removeSessionScope(const std::string& sessioncookie)\n  {\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    if (it != sessionScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      sessionScopes.erase(it);\n    }\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sessionScopes.erase",
          "args": [
            "it"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->second->release",
          "args": [],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.find",
          "args": [
            "sessioncookie"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nvoid ScopeManager::removeSessionScope(const std::string& sessioncookie)\n  {\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    if (it != sessionScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      sessionScopes.erase(it);\n    }\n  }"
  },
  {
    "function_name": "ScopeManager::removeApplicationScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "116-126",
    "snippet": "void ScopeManager::removeApplicationScope(const std::string& appname)\n  {\n    cxxtools::MutexLock lock(applicationScopesMutex);\n    scopes_type::iterator it = applicationScopes.find(appname);\n    if (it != applicationScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      applicationScopes.erase(it);\n    }\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "applicationScopes.erase",
          "args": [
            "it"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->second->release",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "applicationScopes.end",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "applicationScopes.find",
          "args": [
            "appname"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nvoid ScopeManager::removeApplicationScope(const std::string& appname)\n  {\n    cxxtools::MutexLock lock(applicationScopesMutex);\n    scopes_type::iterator it = applicationScopes.find(appname);\n    if (it != applicationScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      applicationScopes.erase(it);\n    }\n  }"
  },
  {
    "function_name": "ScopeManager::putSessionScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "99-113",
    "snippet": "void ScopeManager::putSessionScope(const std::string& sessioncookie, Sessionscope* s)\n  {\n    s->addRef();\n\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    if (it != sessionScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      it->second = s;\n    }\n    else\n      sessionScopes[sessioncookie] = s;\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "it->second->release",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.find",
          "args": [
            "sessioncookie"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s->addRef",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nvoid ScopeManager::putSessionScope(const std::string& sessioncookie, Sessionscope* s)\n  {\n    s->addRef();\n\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    if (it != sessionScopes.end())\n    {\n      if (it->second->release() == 0)\n        delete it->second;\n      it->second = s;\n    }\n    else\n      sessionScopes[sessioncookie] = s;\n  }"
  },
  {
    "function_name": "ScopeManager::hasSessionScope",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "92-97",
    "snippet": "bool ScopeManager::hasSessionScope(const std::string& sessioncookie)\n  {\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    return it != sessionScopes.end();\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sessionScopes.end",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "sessionScopes.find",
          "args": [
            "sessioncookie"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nbool ScopeManager::hasSessionScope(const std::string& sessioncookie)\n  {\n    cxxtools::MutexLock lock(sessionScopesMutex);\n    sessionscopes_type::iterator it = sessionScopes.find(sessioncookie);\n    return it != sessionScopes.end();\n  }"
  },
  {
    "function_name": "ScopeManager::~ScopeManager",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "47-53",
    "snippet": "ScopeManager::~ScopeManager()\n  {\n    for (sessionscopes_type::iterator it = sessionScopes.begin(); it != sessionScopes.end(); ++it)\n      delete it->second;\n    for (scopes_type::iterator it = applicationScopes.begin(); it != applicationScopes.end(); ++it)\n      delete it->second;\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "applicationScopes.end",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "applicationScopes.begin",
          "args": [],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager::~ScopeManager()\n  {\n    for (sessionscopes_type::iterator it = sessionScopes.begin(); it != sessionScopes.end(); ++it)\n      delete it->second;\n    for (scopes_type::iterator it = applicationScopes.begin(); it != applicationScopes.end(); ++it)\n      delete it->second;\n  }"
  },
  {
    "function_name": "ScopeManager::ScopeManager",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/scopemanager.cpp",
    "lines": "43-45",
    "snippet": "ScopeManager::ScopeManager()\n  {\n  }",
    "includes": [
      "#include <stdlib.h>",
      "#include <pthread.h>",
      "#include <cxxtools/md5stream.h>",
      "#include <cxxtools/log.h>",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/httprequest.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/scopemanager.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdlib.h>\n#include <pthread.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include \"tnt/httpreply.h\"\n#include \"tnt/httprequest.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/scopemanager.h\"\n\nScopeManager::ScopeManager()\n  {\n  }"
  }
]