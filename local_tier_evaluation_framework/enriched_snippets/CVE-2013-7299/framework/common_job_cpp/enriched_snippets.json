[
  {
    "function_name": "Jobqueue::get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "260-283",
    "snippet": "Jobqueue::JobPtr Jobqueue::get()\n  {\n    cxxtools::MutexLock lock(mutex);\n\n    // wait, until a job is available\n    ++waitThreads;\n\n    while (jobs.empty())\n      notEmpty.wait(lock);\n\n    --waitThreads;\n\n    // take next job (queue is locked)\n    JobPtr j = jobs.front();\n    jobs.pop_front();\n\n    // if there are threads waiting, wake another\n    if (!jobs.empty() && waitThreads > 0)\n      notEmpty.signal();\n\n    notFull.signal();\n\n    return j;\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "notFull.signal",
          "args": [],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notEmpty.signal",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.empty",
          "args": [],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Jobqueue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/job.h",
          "lines": "132-133",
          "snippet": "bool empty() const\n        { return jobs.empty(); }",
          "includes": [
            "#include <cxxtools/smartptr.h>",
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/condition.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/smartptr.h>\n#include <cxxtools/refcounted.h>\n#include <cxxtools/condition.h>\n#include <cxxtools/mutex.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n#include <deque>\n\nJobqueue {\n  bool empty() const\n          { return jobs.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "jobs.pop_front",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.front",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notEmpty.wait",
          "args": [
            "lock"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJobqueue::JobPtr Jobqueue::get()\n  {\n    cxxtools::MutexLock lock(mutex);\n\n    // wait, until a job is available\n    ++waitThreads;\n\n    while (jobs.empty())\n      notEmpty.wait(lock);\n\n    --waitThreads;\n\n    // take next job (queue is locked)\n    JobPtr j = jobs.front();\n    jobs.pop_front();\n\n    // if there are threads waiting, wake another\n    if (!jobs.empty() && waitThreads > 0)\n      notEmpty.signal();\n\n    notFull.signal();\n\n    return j;\n  }"
  },
  {
    "function_name": "Jobqueue::put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "234-258",
    "snippet": "void Jobqueue::put(JobPtr& j, bool force)\n  {\n    j->touch();\n\n    cxxtools::MutexLock lock(mutex);\n\n    if (!force && capacity > 0)\n    {\n      while (jobs.size() >= capacity)\n      {\n        log_warn(\"Jobqueue full\");\n        notFull.wait(lock);\n      }\n    }\n\n    jobs.push_back(j);\n    // We have to drop ownership before releasing the lock of the queue.\n    // Therefore we set the smart pointer to 0.\n    j = 0;\n\n    if (waitThreads == 0)\n      noWaitThreads.signal();\n\n    notEmpty.signal();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "notEmpty.signal",
          "args": [],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "noWaitThreads.signal",
          "args": [],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.push_back",
          "args": [
            "j"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notFull.wait",
          "args": [
            "lock"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"Jobqueue full\""
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.size",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "j->touch",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "touch",
          "container": "Job",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/job.h",
          "lines": "97-97",
          "snippet": "void touch()     { time(&lastAccessTime); }",
          "includes": [
            "#include <cxxtools/smartptr.h>",
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/condition.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/smartptr.h>\n#include <cxxtools/refcounted.h>\n#include <cxxtools/condition.h>\n#include <cxxtools/mutex.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n#include <deque>\n\nJob {\n  void touch()     { time(&lastAccessTime); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid Jobqueue::put(JobPtr& j, bool force)\n  {\n    j->touch();\n\n    cxxtools::MutexLock lock(mutex);\n\n    if (!force && capacity > 0)\n    {\n      while (jobs.size() >= capacity)\n      {\n        log_warn(\"Jobqueue full\");\n        notFull.wait(lock);\n      }\n    }\n\n    jobs.push_back(j);\n    // We have to drop ownership before releasing the lock of the queue.\n    // Therefore we set the smart pointer to 0.\n    j = 0;\n\n    if (waitThreads == 0)\n      noWaitThreads.signal();\n\n    notEmpty.signal();\n  }"
  },
  {
    "function_name": "SslTcpjob::setWrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "224-227",
    "snippet": "void SslTcpjob::setWrite()\n  {\n    socket.setTimeout(TntConfig::it().socketWriteTimeout);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.setTimeout",
          "args": [
            "TntConfig::it().socketWriteTimeout"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "52-52",
          "snippet": "void setTimeout(unsigned t)                { timeout = t; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void setTimeout(unsigned t)                { timeout = t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid SslTcpjob::setWrite()\n  {\n    socket.setTimeout(TntConfig::it().socketWriteTimeout);\n  }"
  },
  {
    "function_name": "SslTcpjob::setRead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "219-222",
    "snippet": "void SslTcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.setTimeout",
          "args": [
            "TntConfig::it().socketReadTimeout"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "52-52",
          "snippet": "void setTimeout(unsigned t)                { timeout = t; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void setTimeout(unsigned t)                { timeout = t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid SslTcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }"
  },
  {
    "function_name": "SslTcpjob::getFd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "214-217",
    "snippet": "int SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getFd",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "Fdfile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/defcomp/static.cpp",
          "lines": "202-202",
          "snippet": "int getFd() const  { return fd; }",
          "includes": [
            "#include <errno.h>",
            "#include <typeinfo>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/net/tcpstream.h>",
            "#include <sys/sendfile.h>",
            "#include <fcntl.h>",
            "#include <limits>",
            "#include <config.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/convert.h>",
            "#include <cxxtools/ioerror.h>",
            "#include <cxxtools/systemerror.h>",
            "#include <cxxtools/log.h>",
            "#include <fstream>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/comploader.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include \"mimehandler.h\"",
            "#include \"static.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <typeinfo>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <cxxtools/net/tcpstream.h>\n#include <sys/sendfile.h>\n#include <fcntl.h>\n#include <limits>\n#include <config.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <cxxtools/convert.h>\n#include <cxxtools/ioerror.h>\n#include <cxxtools/systemerror.h>\n#include <cxxtools/log.h>\n#include <fstream>\n#include <tnt/tntconfig.h>\n#include <tnt/comploader.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include \"mimehandler.h\"\n#include \"static.h\"\n\nFdfile {\n  int getFd() const  { return fd; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nint SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }"
  },
  {
    "function_name": "SslTcpjob::regenerateJob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "177-187",
    "snippet": "void SslTcpjob::regenerateJob()\n  {\n    Jobqueue::JobPtr p;\n\n    if (Tntnet::shouldStop())\n      p = this;\n    else\n      p = new SslTcpjob(getRequest().getApplication(), listener, queue);\n\n    queue.put(p);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue.put",
          "args": [
            "p"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getRequest",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getRequest",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tntnet::shouldStop",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "shouldStop",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
          "lines": "126-126",
          "snippet": "static bool shouldStop()   { return stop; }",
          "includes": [
            "#include <fstream>",
            "#include <set>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/condition.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/dispatcher.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/job.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  static bool shouldStop()   { return stop; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid SslTcpjob::regenerateJob()\n  {\n    Jobqueue::JobPtr p;\n\n    if (Tntnet::shouldStop())\n      p = this;\n    else\n      p = new SslTcpjob(getRequest().getApplication(), listener, queue);\n\n    queue.put(p);\n  }"
  },
  {
    "function_name": "SslTcpjob::handshake",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "168-175",
    "snippet": "void SslTcpjob::handshake()\n  {\n    socket.handshake(listener);\n\n    fcntl(socket.getFd(), F_SETFD, FD_CLOEXEC);\n\n    setRead();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setRead",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "SslTcpjob::setRead",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "219-222",
          "snippet": "void SslTcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid SslTcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "socket.getFd()",
            "F_SETFD",
            "FD_CLOEXEC"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket.getFd",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "Fdfile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/defcomp/static.cpp",
          "lines": "202-202",
          "snippet": "int getFd() const  { return fd; }",
          "includes": [
            "#include <errno.h>",
            "#include <typeinfo>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/net/tcpstream.h>",
            "#include <sys/sendfile.h>",
            "#include <fcntl.h>",
            "#include <limits>",
            "#include <config.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/convert.h>",
            "#include <cxxtools/ioerror.h>",
            "#include <cxxtools/systemerror.h>",
            "#include <cxxtools/log.h>",
            "#include <fstream>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/comploader.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include \"mimehandler.h\"",
            "#include \"static.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <typeinfo>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <cxxtools/net/tcpstream.h>\n#include <sys/sendfile.h>\n#include <fcntl.h>\n#include <limits>\n#include <config.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <cxxtools/convert.h>\n#include <cxxtools/ioerror.h>\n#include <cxxtools/systemerror.h>\n#include <cxxtools/log.h>\n#include <fstream>\n#include <tnt/tntconfig.h>\n#include <tnt/comploader.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include \"mimehandler.h\"\n#include \"static.h\"\n\nFdfile {\n  int getFd() const  { return fd; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket.handshake",
          "args": [
            "listener"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid SslTcpjob::handshake()\n  {\n    socket.handshake(listener);\n\n    fcntl(socket.getFd(), F_SETFD, FD_CLOEXEC);\n\n    setRead();\n  }"
  },
  {
    "function_name": "SslTcpjob::accept",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "163-166",
    "snippet": "void SslTcpjob::accept()\n  {\n    socket.accept(listener, cxxtools::net::TcpSocket::DEFER_ACCEPT);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.accept",
          "args": [
            "listener",
            "cxxtools::net::TcpSocket::DEFER_ACCEPT"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid SslTcpjob::accept()\n  {\n    socket.accept(listener, cxxtools::net::TcpSocket::DEFER_ACCEPT);\n  }"
  },
  {
    "function_name": "SslTcpjob::isSsl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "158-161",
    "snippet": "bool SslTcpjob::isSsl() const\n  {\n    return true;\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nbool SslTcpjob::isSsl() const\n  {\n    return true;\n  }"
  },
  {
    "function_name": "SslTcpjob::getServerIp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "153-156",
    "snippet": "std::string SslTcpjob::getServerIp() const\n  {\n    return socket.getSockAddr();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getSockAddr",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nstd::string SslTcpjob::getServerIp() const\n  {\n    return socket.getSockAddr();\n  }"
  },
  {
    "function_name": "SslTcpjob::getPeerIp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "148-151",
    "snippet": "std::string SslTcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getPeerAddr",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nstd::string SslTcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }"
  },
  {
    "function_name": "Tcpjob::setWrite",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "138-141",
    "snippet": "void Tcpjob::setWrite()\n  {\n    socket.setTimeout(TntConfig::it().socketWriteTimeout);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.setTimeout",
          "args": [
            "TntConfig::it().socketWriteTimeout"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "52-52",
          "snippet": "void setTimeout(unsigned t)                { timeout = t; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void setTimeout(unsigned t)                { timeout = t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid Tcpjob::setWrite()\n  {\n    socket.setTimeout(TntConfig::it().socketWriteTimeout);\n  }"
  },
  {
    "function_name": "Tcpjob::setRead",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "133-136",
    "snippet": "void Tcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.setTimeout",
          "args": [
            "TntConfig::it().socketReadTimeout"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "52-52",
          "snippet": "void setTimeout(unsigned t)                { timeout = t; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void setTimeout(unsigned t)                { timeout = t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid Tcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }"
  },
  {
    "function_name": "Tcpjob::getFd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "128-131",
    "snippet": "int Tcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getFd",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "Fdfile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/defcomp/static.cpp",
          "lines": "202-202",
          "snippet": "int getFd() const  { return fd; }",
          "includes": [
            "#include <errno.h>",
            "#include <typeinfo>",
            "#include <unistd.h>",
            "#include <sys/poll.h>",
            "#include <netinet/tcp.h>",
            "#include <netinet/in.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/net/tcpstream.h>",
            "#include <sys/sendfile.h>",
            "#include <fcntl.h>",
            "#include <limits>",
            "#include <config.h>",
            "#include <sys/stat.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/convert.h>",
            "#include <cxxtools/ioerror.h>",
            "#include <cxxtools/systemerror.h>",
            "#include <cxxtools/log.h>",
            "#include <fstream>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/comploader.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include \"mimehandler.h\"",
            "#include \"static.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <typeinfo>\n#include <unistd.h>\n#include <sys/poll.h>\n#include <netinet/tcp.h>\n#include <netinet/in.h>\n#include <sys/socket.h>\n#include <cxxtools/net/tcpstream.h>\n#include <sys/sendfile.h>\n#include <fcntl.h>\n#include <limits>\n#include <config.h>\n#include <sys/stat.h>\n#include <sys/types.h>\n#include <cxxtools/convert.h>\n#include <cxxtools/ioerror.h>\n#include <cxxtools/systemerror.h>\n#include <cxxtools/log.h>\n#include <fstream>\n#include <tnt/tntconfig.h>\n#include <tnt/comploader.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include \"mimehandler.h\"\n#include \"static.h\"\n\nFdfile {\n  int getFd() const  { return fd; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nint Tcpjob::getFd() const\n  {\n    return socket.getFd();\n  }"
  },
  {
    "function_name": "Tcpjob::regenerateJob",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "94-104",
    "snippet": "void Tcpjob::regenerateJob()\n  {\n    Jobqueue::JobPtr p;\n\n    if (Tntnet::shouldStop())\n      p = this;\n    else\n      p = new Tcpjob(getRequest().getApplication(), listener, queue);\n\n    queue.put(p);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue.put",
          "args": [
            "p"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getRequest",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getRequest",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tntnet::shouldStop",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "shouldStop",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
          "lines": "126-126",
          "snippet": "static bool shouldStop()   { return stop; }",
          "includes": [
            "#include <fstream>",
            "#include <set>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/condition.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/dispatcher.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/job.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  static bool shouldStop()   { return stop; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid Tcpjob::regenerateJob()\n  {\n    Jobqueue::JobPtr p;\n\n    if (Tntnet::shouldStop())\n      p = this;\n    else\n      p = new Tcpjob(getRequest().getApplication(), listener, queue);\n\n    queue.put(p);\n  }"
  },
  {
    "function_name": "Tcpjob::accept",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "88-92",
    "snippet": "void Tcpjob::accept()\n  {\n    socket.accept(listener);\n    log_debug(\"connection accepted from \" << getPeerIp());\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"connection accepted from \" << getPeerIp()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getPeerIp",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "SslTcpjob::getPeerIp",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "148-151",
          "snippet": "std::string SslTcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nstd::string SslTcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }"
        }
      },
      {
        "call_info": {
          "callee": "socket.accept",
          "args": [
            "listener"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid Tcpjob::accept()\n  {\n    socket.accept(listener);\n    log_debug(\"connection accepted from \" << getPeerIp());\n  }"
  },
  {
    "function_name": "Tcpjob::isSsl",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "83-86",
    "snippet": "bool Tcpjob::isSsl() const\n  {\n    return false;\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nbool Tcpjob::isSsl() const\n  {\n    return false;\n  }"
  },
  {
    "function_name": "Tcpjob::getServerIp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "78-81",
    "snippet": "std::string Tcpjob::getServerIp() const\n  {\n    return socket.getSockAddr();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getSockAddr",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nstd::string Tcpjob::getServerIp() const\n  {\n    return socket.getSockAddr();\n  }"
  },
  {
    "function_name": "Tcpjob::getPeerIp",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "73-76",
    "snippet": "std::string Tcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getPeerAddr",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nstd::string Tcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }"
  },
  {
    "function_name": "Job::msecToTimeout",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "62-67",
    "snippet": "int Job::msecToTimeout(time_t currentTime) const\n  {\n    return (lastAccessTime - currentTime + 1) * 1000\n         + TntConfig::it().keepAliveTimeout\n         - TntConfig::it().socketReadTimeout;\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nint Job::msecToTimeout(time_t currentTime) const\n  {\n    return (lastAccessTime - currentTime + 1) * 1000\n         + TntConfig::it().keepAliveTimeout\n         - TntConfig::it().socketReadTimeout;\n  }"
  },
  {
    "function_name": "Job::clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "56-60",
    "snippet": "void Job::clear()\n  {\n    parser.reset();\n    request.clear();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request.clear",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Compident",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/compident.h",
          "lines": "76-77",
          "snippet": "void clear()\n    { libname.clear(); compname.clear(); }",
          "includes": [
            "#include <iostream>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n#include <string>\n\nCompident {\n  void clear()\n      { libname.clear(); compname.clear(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parser.reset",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "reset",
          "container": "RequestSizeMonitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpparser.h",
          "lines": "58-58",
          "snippet": "void reset()  { requestSize = 0; }",
          "includes": [
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/parser.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/messageheaderparser.h>\n#include <tnt/parser.h>\n#include <tnt/http.h>\n#include <tnt/httprequest.h>\n\nRequestSizeMonitor {\n  void reset()  { requestSize = 0; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nvoid Job::clear()\n  {\n    parser.reset();\n    request.clear();\n  }"
  },
  {
    "function_name": "Job::~Job",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "53-54",
    "snippet": "Job::~Job()\n  { }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJob::~Job()\n  { }"
  },
  {
    "function_name": "Job::Job",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "46-51",
    "snippet": "Job::Job(Tntnet& app_, const SocketIf* socketIf_)\n    : keepAliveCounter(TntConfig::it().keepAliveMax),\n      request(app_, socketIf_),\n      parser(request),\n      lastAccessTime(0)\n    { }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJob::Job(Tntnet& app_, const SocketIf* socketIf_)\n    : keepAliveCounter(TntConfig::it().keepAliveMax),\n      request(app_, socketIf_),\n      parser(request),\n      lastAccessTime(0)\n    { }"
  }
]