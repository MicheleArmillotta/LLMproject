[
  {
    "function_name": "get",
    "container": "Jobqueue",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "260-283",
    "snippet": "Jobqueue::JobPtr Jobqueue::get()\n  {\n    cxxtools::MutexLock lock(mutex);\n\n    // wait, until a job is available\n    ++waitThreads;\n\n    while (jobs.empty())\n      notEmpty.wait(lock);\n\n    --waitThreads;\n\n    // take next job (queue is locked)\n    JobPtr j = jobs.front();\n    jobs.pop_front();\n\n    // if there are threads waiting, wake another\n    if (!jobs.empty() && waitThreads > 0)\n      notEmpty.signal();\n\n    notFull.signal();\n\n    return j;\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "notFull.signal",
          "args": [],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notEmpty.signal",
          "args": [],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.empty",
          "args": [],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Jobqueue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/job.h",
          "lines": "132-133",
          "snippet": "bool empty() const\n        { return jobs.empty(); }",
          "includes": [
            "#include <cxxtools/smartptr.h>",
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/condition.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/smartptr.h>\n#include <cxxtools/refcounted.h>\n#include <cxxtools/condition.h>\n#include <cxxtools/mutex.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n#include <deque>\n\nJobqueue {\n  bool empty() const\n          { return jobs.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "jobs.pop_front",
          "args": [],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.front",
          "args": [],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notEmpty.wait",
          "args": [
            "lock"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJobqueue {\n  Jobqueue::JobPtr Jobqueue::get()\n    {\n      cxxtools::MutexLock lock(mutex);\n  \n      // wait, until a job is available\n      ++waitThreads;\n  \n      while (jobs.empty())\n        notEmpty.wait(lock);\n  \n      --waitThreads;\n  \n      // take next job (queue is locked)\n      JobPtr j = jobs.front();\n      jobs.pop_front();\n  \n      // if there are threads waiting, wake another\n      if (!jobs.empty() && waitThreads > 0)\n        notEmpty.signal();\n  \n      notFull.signal();\n  \n      return j;\n    }\n}"
  },
  {
    "function_name": "put",
    "container": "Jobqueue",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "234-258",
    "snippet": "void Jobqueue::put(JobPtr& j, bool force)\n  {\n    j->touch();\n\n    cxxtools::MutexLock lock(mutex);\n\n    if (!force && capacity > 0)\n    {\n      while (jobs.size() >= capacity)\n      {\n        log_warn(\"Jobqueue full\");\n        notFull.wait(lock);\n      }\n    }\n\n    jobs.push_back(j);\n    // We have to drop ownership before releasing the lock of the queue.\n    // Therefore we set the smart pointer to 0.\n    j = 0;\n\n    if (waitThreads == 0)\n      noWaitThreads.signal();\n\n    notEmpty.signal();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "notEmpty.signal",
          "args": [],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "noWaitThreads.signal",
          "args": [],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.push_back",
          "args": [
            "j"
          ],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "notFull.wait",
          "args": [
            "lock"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"Jobqueue full\""
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "jobs.size",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "j->touch",
          "args": [],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "touch",
          "container": "Job",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/job.h",
          "lines": "97-97",
          "snippet": "void touch()     { time(&lastAccessTime); }",
          "includes": [
            "#include <cxxtools/smartptr.h>",
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/condition.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/smartptr.h>\n#include <cxxtools/refcounted.h>\n#include <cxxtools/condition.h>\n#include <cxxtools/mutex.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n#include <deque>\n\nJob {\n  void touch()     { time(&lastAccessTime); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJobqueue {\n  void Jobqueue::put(JobPtr& j, bool force)\n    {\n      j->touch();\n  \n      cxxtools::MutexLock lock(mutex);\n  \n      if (!force && capacity > 0)\n      {\n        while (jobs.size() >= capacity)\n        {\n          log_warn(\"Jobqueue full\");\n          notFull.wait(lock);\n        }\n      }\n  \n      jobs.push_back(j);\n      // We have to drop ownership before releasing the lock of the queue.\n      // Therefore we set the smart pointer to 0.\n      j = 0;\n  \n      if (waitThreads == 0)\n        noWaitThreads.signal();\n  \n      notEmpty.signal();\n    }\n}"
  },
  {
    "function_name": "setWrite",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "224-227",
    "snippet": "void SslTcpjob::setWrite()\n  {\n    socket.setTimeout(TntConfig::it().socketWriteTimeout);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.setTimeout",
          "args": [
            "TntConfig::it().socketWriteTimeout"
          ],
          "line": 226
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "52-52",
          "snippet": "void setTimeout(unsigned t)                { timeout = t; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void setTimeout(unsigned t)                { timeout = t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  void SslTcpjob::setWrite()\n    {\n      socket.setTimeout(TntConfig::it().socketWriteTimeout);\n    }\n}"
  },
  {
    "function_name": "setRead",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "219-222",
    "snippet": "void SslTcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.setTimeout",
          "args": [
            "TntConfig::it().socketReadTimeout"
          ],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "52-52",
          "snippet": "void setTimeout(unsigned t)                { timeout = t; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void setTimeout(unsigned t)                { timeout = t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  void SslTcpjob::setRead()\n    {\n      socket.setTimeout(TntConfig::it().socketReadTimeout);\n    }\n}"
  },
  {
    "function_name": "getFd",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "214-217",
    "snippet": "int SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getFd",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "214-217",
          "snippet": "int SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  int SslTcpjob::getFd() const\n    {\n      return socket.getFd();\n    }\n}"
  },
  {
    "function_name": "regenerateJob",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "177-187",
    "snippet": "void SslTcpjob::regenerateJob()\n  {\n    Jobqueue::JobPtr p;\n\n    if (Tntnet::shouldStop())\n      p = this;\n    else\n      p = new SslTcpjob(getRequest().getApplication(), listener, queue);\n\n    queue.put(p);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue.put",
          "args": [
            "p"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getRequest",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getRequest",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tntnet::shouldStop",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "shouldStop",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
          "lines": "126-126",
          "snippet": "static bool shouldStop()   { return stop; }",
          "includes": [
            "#include <fstream>",
            "#include <set>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/condition.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/dispatcher.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/job.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  static bool shouldStop()   { return stop; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  void SslTcpjob::regenerateJob()\n    {\n      Jobqueue::JobPtr p;\n  \n      if (Tntnet::shouldStop())\n        p = this;\n      else\n        p = new SslTcpjob(getRequest().getApplication(), listener, queue);\n  \n      queue.put(p);\n    }\n}"
  },
  {
    "function_name": "handshake",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "168-175",
    "snippet": "void SslTcpjob::handshake()\n  {\n    socket.handshake(listener);\n\n    fcntl(socket.getFd(), F_SETFD, FD_CLOEXEC);\n\n    setRead();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setRead",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "setRead",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "219-222",
          "snippet": "void SslTcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  void SslTcpjob::setRead()\n    {\n      socket.setTimeout(TntConfig::it().socketReadTimeout);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "socket.getFd()",
            "F_SETFD",
            "FD_CLOEXEC"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "socket.getFd",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "214-217",
          "snippet": "int SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  int SslTcpjob::getFd() const\n    {\n      return socket.getFd();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket.handshake",
          "args": [
            "listener"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "handshake",
          "container": "OpensslStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/openssl.cpp",
          "lines": "209-222",
          "snippet": "void OpensslStream::handshake(const OpensslServer& server)\n  {\n    log_debug(\"tcp-connection established - build ssltunnel\");\n\n    log_debug(\"SSL_new(\" << server.getSslContext().getPointer() << ')');\n    ssl = SSL_new( server.getSslContext().getPointer() );\n    checkSslError();\n\n    log_debug(\"SSL_set_fd(\" << ssl << \", \" << getFd() << ')');\n    SSL_set_fd(ssl, getFd());\n\n    log_debug(\"SSL_set_accept_state(\" << ssl << ')');\n    SSL_set_accept_state(ssl);\n  }",
          "includes": [
            "#include <pthread.h>",
            "#include <sys/poll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <cxxtools/ioerror.h>",
            "#include <cxxtools/log.h>",
            "#include <openssl/err.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/openssl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <pthread.h>\n#include <sys/poll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <cxxtools/ioerror.h>\n#include <cxxtools/log.h>\n#include <openssl/err.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/openssl.h\"\n\nOpensslStream {\n  void OpensslStream::handshake(const OpensslServer& server)\n    {\n      log_debug(\"tcp-connection established - build ssltunnel\");\n  \n      log_debug(\"SSL_new(\" << server.getSslContext().getPointer() << ')');\n      ssl = SSL_new( server.getSslContext().getPointer() );\n      checkSslError();\n  \n      log_debug(\"SSL_set_fd(\" << ssl << \", \" << getFd() << ')');\n      SSL_set_fd(ssl, getFd());\n  \n      log_debug(\"SSL_set_accept_state(\" << ssl << ')');\n      SSL_set_accept_state(ssl);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  void SslTcpjob::handshake()\n    {\n      socket.handshake(listener);\n  \n      fcntl(socket.getFd(), F_SETFD, FD_CLOEXEC);\n  \n      setRead();\n    }\n}"
  },
  {
    "function_name": "accept",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "163-166",
    "snippet": "void SslTcpjob::accept()\n  {\n    socket.accept(listener, cxxtools::net::TcpSocket::DEFER_ACCEPT);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.accept",
          "args": [
            "listener",
            "cxxtools::net::TcpSocket::DEFER_ACCEPT"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "OpensslStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/openssl.cpp",
          "lines": "203-207",
          "snippet": "void OpensslStream::accept(const OpensslServer& server, bool inherit)\n  {\n    log_trace(\"accept\");\n    cxxtools::net::TcpSocket::accept(server, inherit);\n  }",
          "includes": [
            "#include <pthread.h>",
            "#include <sys/poll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <cxxtools/ioerror.h>",
            "#include <cxxtools/log.h>",
            "#include <openssl/err.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/openssl.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <pthread.h>\n#include <sys/poll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <cxxtools/ioerror.h>\n#include <cxxtools/log.h>\n#include <openssl/err.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/openssl.h\"\n\nOpensslStream {\n  void OpensslStream::accept(const OpensslServer& server, bool inherit)\n    {\n      log_trace(\"accept\");\n      cxxtools::net::TcpSocket::accept(server, inherit);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  void SslTcpjob::accept()\n    {\n      socket.accept(listener, cxxtools::net::TcpSocket::DEFER_ACCEPT);\n    }\n}"
  },
  {
    "function_name": "isSsl",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "158-161",
    "snippet": "bool SslTcpjob::isSsl() const\n  {\n    return true;\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  bool SslTcpjob::isSsl() const\n    {\n      return true;\n    }\n}"
  },
  {
    "function_name": "getServerIp",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "153-156",
    "snippet": "std::string SslTcpjob::getServerIp() const\n  {\n    return socket.getSockAddr();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getSockAddr",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  std::string SslTcpjob::getServerIp() const\n    {\n      return socket.getSockAddr();\n    }\n}"
  },
  {
    "function_name": "getPeerIp",
    "container": "SslTcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "148-151",
    "snippet": "std::string SslTcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getPeerAddr",
          "args": [],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  std::string SslTcpjob::getPeerIp() const\n    {\n      return socket.getPeerAddr();\n    }\n}"
  },
  {
    "function_name": "setWrite",
    "container": "Tcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "138-141",
    "snippet": "void Tcpjob::setWrite()\n  {\n    socket.setTimeout(TntConfig::it().socketWriteTimeout);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.setTimeout",
          "args": [
            "TntConfig::it().socketWriteTimeout"
          ],
          "line": 140
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "52-52",
          "snippet": "void setTimeout(unsigned t)                { timeout = t; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void setTimeout(unsigned t)                { timeout = t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nTcpjob {\n  void Tcpjob::setWrite()\n    {\n      socket.setTimeout(TntConfig::it().socketWriteTimeout);\n    }\n}"
  },
  {
    "function_name": "setRead",
    "container": "Tcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "133-136",
    "snippet": "void Tcpjob::setRead()\n  {\n    socket.setTimeout(TntConfig::it().socketReadTimeout);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.setTimeout",
          "args": [
            "TntConfig::it().socketReadTimeout"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "52-52",
          "snippet": "void setTimeout(unsigned t)                { timeout = t; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  void setTimeout(unsigned t)                { timeout = t; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nTcpjob {\n  void Tcpjob::setRead()\n    {\n      socket.setTimeout(TntConfig::it().socketReadTimeout);\n    }\n}"
  },
  {
    "function_name": "getFd",
    "container": "Tcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "128-131",
    "snippet": "int Tcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getFd",
          "args": [],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "214-217",
          "snippet": "int SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  int SslTcpjob::getFd() const\n    {\n      return socket.getFd();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nTcpjob {\n  int Tcpjob::getFd() const\n    {\n      return socket.getFd();\n    }\n}"
  },
  {
    "function_name": "regenerateJob",
    "container": "Tcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "94-104",
    "snippet": "void Tcpjob::regenerateJob()\n  {\n    Jobqueue::JobPtr p;\n\n    if (Tntnet::shouldStop())\n      p = this;\n    else\n      p = new Tcpjob(getRequest().getApplication(), listener, queue);\n\n    queue.put(p);\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue.put",
          "args": [
            "p"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getRequest",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getRequest",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Tntnet::shouldStop",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "shouldStop",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/tntnet.h",
          "lines": "126-126",
          "snippet": "static bool shouldStop()   { return stop; }",
          "includes": [
            "#include <fstream>",
            "#include <set>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/condition.h>",
            "#include <tnt/scopemanager.h>",
            "#include <tnt/maptarget.h>",
            "#include <tnt/dispatcher.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/job.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fstream>\n#include <set>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <tnt/scopemanager.h>\n#include <tnt/maptarget.h>\n#include <tnt/dispatcher.h>\n#include <tnt/poller.h>\n#include <tnt/job.h>\n\nTntnet {\n  static bool shouldStop()   { return stop; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nTcpjob {\n  void Tcpjob::regenerateJob()\n    {\n      Jobqueue::JobPtr p;\n  \n      if (Tntnet::shouldStop())\n        p = this;\n      else\n        p = new Tcpjob(getRequest().getApplication(), listener, queue);\n  \n      queue.put(p);\n    }\n}"
  },
  {
    "function_name": "accept",
    "container": "Tcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "88-92",
    "snippet": "void Tcpjob::accept()\n  {\n    socket.accept(listener);\n    log_debug(\"connection accepted from \" << getPeerIp());\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"connection accepted from \" << getPeerIp()"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getPeerIp",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "getPeerIp",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "148-151",
          "snippet": "std::string SslTcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  std::string SslTcpjob::getPeerIp() const\n    {\n      return socket.getPeerAddr();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "socket.accept",
          "args": [
            "listener"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "Encoding",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/encoding.cpp",
          "lines": "162-177",
          "snippet": "unsigned Encoding::accept(const std::string& encoding) const\n  {\n    // check, if encoding is specified\n\n    encodingMapType::const_iterator it =  encodingMap.find(encoding);\n    if (it != encodingMap.end())\n      return it->second;\n\n    // check, if a wildcard-rule is specified\n    it = encodingMap.find(\"*\");\n    if (it != encodingMap.end())\n      return it->second;\n\n    // return 10 (accept), if encoding is identity, 0 otherwise\n    return encoding == \"identity\" ? 10 : 0;\n  }",
          "includes": [
            "#include <cctype>",
            "#include \"tnt/util.h\"",
            "#include \"tnt/encoding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cctype>\n#include \"tnt/util.h\"\n#include \"tnt/encoding.h\"\n\nEncoding {\n  unsigned Encoding::accept(const std::string& encoding) const\n    {\n      // check, if encoding is specified\n  \n      encodingMapType::const_iterator it =  encodingMap.find(encoding);\n      if (it != encodingMap.end())\n        return it->second;\n  \n      // check, if a wildcard-rule is specified\n      it = encodingMap.find(\"*\");\n      if (it != encodingMap.end())\n        return it->second;\n  \n      // return 10 (accept), if encoding is identity, 0 otherwise\n      return encoding == \"identity\" ? 10 : 0;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nTcpjob {\n  void Tcpjob::accept()\n    {\n      socket.accept(listener);\n      log_debug(\"connection accepted from \" << getPeerIp());\n    }\n}"
  },
  {
    "function_name": "isSsl",
    "container": "Tcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "83-86",
    "snippet": "bool Tcpjob::isSsl() const\n  {\n    return false;\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nTcpjob {\n  bool Tcpjob::isSsl() const\n    {\n      return false;\n    }\n}"
  },
  {
    "function_name": "getServerIp",
    "container": "Tcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "78-81",
    "snippet": "std::string Tcpjob::getServerIp() const\n  {\n    return socket.getSockAddr();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getSockAddr",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nTcpjob {\n  std::string Tcpjob::getServerIp() const\n    {\n      return socket.getSockAddr();\n    }\n}"
  },
  {
    "function_name": "getPeerIp",
    "container": "Tcpjob",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "73-76",
    "snippet": "std::string Tcpjob::getPeerIp() const\n  {\n    return socket.getPeerAddr();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "socket.getPeerAddr",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nTcpjob {\n  std::string Tcpjob::getPeerIp() const\n    {\n      return socket.getPeerAddr();\n    }\n}"
  },
  {
    "function_name": "msecToTimeout",
    "container": "Job",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "62-67",
    "snippet": "int Job::msecToTimeout(time_t currentTime) const\n  {\n    return (lastAccessTime - currentTime + 1) * 1000\n         + TntConfig::it().keepAliveTimeout\n         - TntConfig::it().socketReadTimeout;\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJob {\n  int Job::msecToTimeout(time_t currentTime) const\n    {\n      return (lastAccessTime - currentTime + 1) * 1000\n           + TntConfig::it().keepAliveTimeout\n           - TntConfig::it().socketReadTimeout;\n    }\n}"
  },
  {
    "function_name": "clear",
    "container": "Job",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "56-60",
    "snippet": "void Job::clear()\n  {\n    parser.reset();\n    request.clear();\n  }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "request.clear",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Job",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "56-60",
          "snippet": "void Job::clear()\n  {\n    parser.reset();\n    request.clear();\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "parser.reset",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "reset",
          "container": "HttpRequest::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "91-99",
          "snippet": "void HttpRequest::Parser::reset()\n  {\n    message.clear();\n    SET_STATE(state_cmd0);\n    httpCode = HTTP_OK;\n    failedFlag = false;\n    RequestSizeMonitor::reset();\n    headerParser.reset();\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    void HttpRequest::Parser::reset()\n      {\n        message.clear();\n        SET_STATE(state_cmd0);\n        httpCode = HTTP_OK;\n        failedFlag = false;\n        RequestSizeMonitor::reset();\n        headerParser.reset();\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJob {\n  void Job::clear()\n    {\n      parser.reset();\n      request.clear();\n    }\n}"
  },
  {
    "function_name": "~Job",
    "container": "Job",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "53-54",
    "snippet": "Job::~Job()\n  { }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJob {\n  Job::~Job()\n    { }\n}"
  },
  {
    "function_name": "Job",
    "container": "Job",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
    "lines": "46-51",
    "snippet": "Job::Job(Tntnet& app_, const SocketIf* socketIf_)\n    : keepAliveCounter(TntConfig::it().keepAliveMax),\n      request(app_, socketIf_),\n      parser(request),\n      lastAccessTime(0)\n    { }",
    "includes": [
      "#include <fcntl.h>",
      "#include <config.h>",
      "#include <arpa/inet.h>",
      "#include <sys/socket.h>",
      "#include <sys/types.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/ssl.h>",
      "#include <tnt/httpreply.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/tcpjob.h\"",
      "#include \"tnt/job.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nJob {\n  Job::Job(Tntnet& app_, const SocketIf* socketIf_)\n      : keepAliveCounter(TntConfig::it().keepAliveMax),\n        request(app_, socketIf_),\n        parser(request),\n        lastAccessTime(0)\n      { }\n}"
  }
]