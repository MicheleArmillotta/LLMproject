[
  {
    "function_name": "sync",
    "container": "GnuTls_streambuf",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "449-468",
    "snippet": "int GnuTls_streambuf::sync()\n  {\n    try\n    {\n      if (pptr() != pbase())\n      {\n        int n = m_stream.sslWrite(pbase(), pptr() - pbase());\n        if (n <= 0)\n          return -1;\n        else\n          setp(m_buffer, m_buffer + m_bufsize);\n      }\n      return 0;\n    }\n    catch (const std::exception& e)\n    {\n      log_error(\"error in GnuTls_streambuf::sync(): \" << e.what());\n      return traits_type::eof();\n    }\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_error",
          "args": [
            "\"error in GnuTls_streambuf::sync(): \" << e.what()"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setp",
          "args": [
            "m_buffer",
            "m_buffer + m_bufsize"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_stream.sslWrite",
          "args": [
            "pbase()",
            "pptr() - pbase()"
          ],
          "line": 455
        },
        "resolved": true,
        "details": {
          "function_name": "sslWrite",
          "container": "GnuTlsStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "344-369",
          "snippet": "int GnuTlsStream::sslWrite(const char* buffer, int bufsize) const\n  {\n    int ret;\n\n    fdInfo.timeout = getTimeout();\n\n    // non-blocking/with timeout\n\n    while (true)\n    {\n      log_debug(\"gnutls_record_send\");\n      ret = gnutls_record_send(session, buffer, bufsize);\n      log_debug(\"gnutls_record_send => \" << ret);\n\n      if (ret > 0)\n        break;\n\n      if (ret == GNUTLS_E_AGAIN)\n        throw cxxtools::IOTimeout();\n\n      if (ret != GNUTLS_E_INTERRUPTED)\n        throw GnuTlsException(\"gnutls_record_send\", ret);\n    }\n\n    return ret;\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  int GnuTlsStream::sslWrite(const char* buffer, int bufsize) const\n    {\n      int ret;\n  \n      fdInfo.timeout = getTimeout();\n  \n      // non-blocking/with timeout\n  \n      while (true)\n      {\n        log_debug(\"gnutls_record_send\");\n        ret = gnutls_record_send(session, buffer, bufsize);\n        log_debug(\"gnutls_record_send => \" << ret);\n  \n        if (ret > 0)\n          break;\n  \n        if (ret == GNUTLS_E_AGAIN)\n          throw cxxtools::IOTimeout();\n  \n        if (ret != GNUTLS_E_INTERRUPTED)\n          throw GnuTlsException(\"gnutls_record_send\", ret);\n      }\n  \n      return ret;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pbase",
          "args": [],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pptr",
          "args": [],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pbase",
          "args": [],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pbase",
          "args": [],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pptr",
          "args": [],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTls_streambuf {\n  int GnuTls_streambuf::sync()\n    {\n      try\n      {\n        if (pptr() != pbase())\n        {\n          int n = m_stream.sslWrite(pbase(), pptr() - pbase());\n          if (n <= 0)\n            return -1;\n          else\n            setp(m_buffer, m_buffer + m_bufsize);\n        }\n        return 0;\n      }\n      catch (const std::exception& e)\n      {\n        log_error(\"error in GnuTls_streambuf::sync(): \" << e.what());\n        return traits_type::eof();\n      }\n    }\n}"
  },
  {
    "function_name": "underflow",
    "container": "GnuTls_streambuf",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "439-447",
    "snippet": "GnuTls_streambuf::int_type GnuTls_streambuf::underflow()\n  {\n    int n = m_stream.sslRead(m_buffer, m_bufsize);\n    if (n <= 0)\n      return traits_type::eof();\n\n    setg(m_buffer, m_buffer, m_buffer + n);\n    return (int_type)(unsigned char)m_buffer[0];\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setg",
          "args": [
            "m_buffer",
            "m_buffer",
            "m_buffer + n"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 443
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_stream.sslRead",
          "args": [
            "m_buffer",
            "m_bufsize"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "sslRead",
          "container": "GnuTlsStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "313-342",
          "snippet": "int GnuTlsStream::sslRead(char* buffer, int bufsize) const\n  {\n    int ret;\n\n    fdInfo.timeout = getTimeout();\n\n    // non-blocking/with timeout\n\n    while (true)\n    {\n      log_debug(\"gnutls_record_recv (\" << bufsize << ')');\n      ret = gnutls_record_recv(session, buffer, bufsize);\n      log_debug(\"gnutls_record_recv => \" << ret);\n\n      // report GNUTLS_E_REHANDSHAKE as eof\n      if (ret == GNUTLS_E_REHANDSHAKE)\n        return 0;\n\n      if (ret >= 0)\n        break;\n\n      if (ret == GNUTLS_E_AGAIN)\n        throw cxxtools::IOTimeout();\n\n      if (ret < 0 && ret != GNUTLS_E_INTERRUPTED)\n        throw GnuTlsException(\"gnutls_record_recv\", ret);\n  }\n\n    return ret;\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  int GnuTlsStream::sslRead(char* buffer, int bufsize) const\n    {\n      int ret;\n  \n      fdInfo.timeout = getTimeout();\n  \n      // non-blocking/with timeout\n  \n      while (true)\n      {\n        log_debug(\"gnutls_record_recv (\" << bufsize << ')');\n        ret = gnutls_record_recv(session, buffer, bufsize);\n        log_debug(\"gnutls_record_recv => \" << ret);\n  \n        // report GNUTLS_E_REHANDSHAKE as eof\n        if (ret == GNUTLS_E_REHANDSHAKE)\n          return 0;\n  \n        if (ret >= 0)\n          break;\n  \n        if (ret == GNUTLS_E_AGAIN)\n          throw cxxtools::IOTimeout();\n  \n        if (ret < 0 && ret != GNUTLS_E_INTERRUPTED)\n          throw GnuTlsException(\"gnutls_record_recv\", ret);\n    }\n  \n      return ret;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTls_streambuf {\n  GnuTls_streambuf::int_type GnuTls_streambuf::underflow()\n    {\n      int n = m_stream.sslRead(m_buffer, m_bufsize);\n      if (n <= 0)\n        return traits_type::eof();\n  \n      setg(m_buffer, m_buffer, m_buffer + n);\n      return (int_type)(unsigned char)m_buffer[0];\n    }\n}"
  },
  {
    "function_name": "overflow",
    "container": "GnuTls_streambuf",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "412-437",
    "snippet": "GnuTls_streambuf::int_type GnuTls_streambuf::overflow(GnuTls_streambuf::int_type c)\n  {\n    try\n    {\n      if (pptr() != pbase())\n      {\n        int n = m_stream.sslWrite(pbase(), pptr() - pbase());\n        if (n <= 0)\n          return traits_type::eof();\n      }\n\n      setp(m_buffer, m_buffer + m_bufsize);\n      if (c != traits_type::eof())\n      {\n        *pptr() = (char_type)c;\n        pbump(1);\n      }\n\n      return 0;\n    }\n    catch (const std::exception& e)\n    {\n      log_error(\"error int GnuTls_streambuf::overflow: \" << e.what());\n      return traits_type::eof();\n    }\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_error",
          "args": [
            "\"error int GnuTls_streambuf::overflow: \" << e.what()"
          ],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pbump",
          "args": [
            "1"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pptr",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 424
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setp",
          "args": [
            "m_buffer",
            "m_buffer + m_bufsize"
          ],
          "line": 423
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "traits_type::eof",
          "args": [],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_stream.sslWrite",
          "args": [
            "pbase()",
            "pptr() - pbase()"
          ],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "sslWrite",
          "container": "GnuTlsStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "344-369",
          "snippet": "int GnuTlsStream::sslWrite(const char* buffer, int bufsize) const\n  {\n    int ret;\n\n    fdInfo.timeout = getTimeout();\n\n    // non-blocking/with timeout\n\n    while (true)\n    {\n      log_debug(\"gnutls_record_send\");\n      ret = gnutls_record_send(session, buffer, bufsize);\n      log_debug(\"gnutls_record_send => \" << ret);\n\n      if (ret > 0)\n        break;\n\n      if (ret == GNUTLS_E_AGAIN)\n        throw cxxtools::IOTimeout();\n\n      if (ret != GNUTLS_E_INTERRUPTED)\n        throw GnuTlsException(\"gnutls_record_send\", ret);\n    }\n\n    return ret;\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  int GnuTlsStream::sslWrite(const char* buffer, int bufsize) const\n    {\n      int ret;\n  \n      fdInfo.timeout = getTimeout();\n  \n      // non-blocking/with timeout\n  \n      while (true)\n      {\n        log_debug(\"gnutls_record_send\");\n        ret = gnutls_record_send(session, buffer, bufsize);\n        log_debug(\"gnutls_record_send => \" << ret);\n  \n        if (ret > 0)\n          break;\n  \n        if (ret == GNUTLS_E_AGAIN)\n          throw cxxtools::IOTimeout();\n  \n        if (ret != GNUTLS_E_INTERRUPTED)\n          throw GnuTlsException(\"gnutls_record_send\", ret);\n      }\n  \n      return ret;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pbase",
          "args": [],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pptr",
          "args": [],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pbase",
          "args": [],
          "line": 418
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pbase",
          "args": [],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pptr",
          "args": [],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTls_streambuf {\n  GnuTls_streambuf::int_type GnuTls_streambuf::overflow(GnuTls_streambuf::int_type c)\n    {\n      try\n      {\n        if (pptr() != pbase())\n        {\n          int n = m_stream.sslWrite(pbase(), pptr() - pbase());\n          if (n <= 0)\n            return traits_type::eof();\n        }\n  \n        setp(m_buffer, m_buffer + m_bufsize);\n        if (c != traits_type::eof())\n        {\n          *pptr() = (char_type)c;\n          pbump(1);\n        }\n  \n        return 0;\n      }\n      catch (const std::exception& e)\n      {\n        log_error(\"error int GnuTls_streambuf::overflow: \" << e.what());\n        return traits_type::eof();\n      }\n    }\n}"
  },
  {
    "function_name": "GnuTls_streambuf",
    "container": "GnuTls_streambuf",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "404-410",
    "snippet": "GnuTls_streambuf::GnuTls_streambuf(GnuTlsStream& stream, unsigned bufsize, int timeout)\n    : m_stream(stream),\n      m_buffer(new char_type[bufsize]),\n      m_bufsize(bufsize)\n  {\n    setTimeout(timeout);\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setTimeout",
          "args": [
            "timeout"
          ],
          "line": 409
        },
        "resolved": true,
        "details": {
          "function_name": "setTimeout",
          "container": "GnuTls_iostream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/gnutls.h",
          "lines": "165-165",
          "snippet": "void setTimeout(int timeout)  { m_buffer.setTimeout(timeout); }",
          "includes": [
            "#include <gnutls/gnutls.h>",
            "#include <cxxtools/net/tcpstream.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/gnutls.h>\n#include <cxxtools/net/tcpstream.h>\n\nGnuTls_iostream {\n  void setTimeout(int timeout)  { m_buffer.setTimeout(timeout); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTls_streambuf {\n  GnuTls_streambuf::GnuTls_streambuf(GnuTlsStream& stream, unsigned bufsize, int timeout)\n      : m_stream(stream),\n        m_buffer(new char_type[bufsize]),\n        m_bufsize(bufsize)\n    {\n      setTimeout(timeout);\n    }\n}"
  },
  {
    "function_name": "shutdown",
    "container": "GnuTlsStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "371-399",
    "snippet": "void GnuTlsStream::shutdown()\n  {\n    int ret;\n\n    fdInfo.timeout = 1000;\n\n    // non-blocking/with timeout\n\n    while (true)\n    {\n      log_debug(\"gnutls_bye\");\n      ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);\n      log_debug(\"gnutls_bye => \" << ret);\n\n      if (ret == 0)\n      {\n        connected = false;\n        break;\n      }\n\n      if (ret < 0\n        && ret != GNUTLS_E_INTERRUPTED\n        && ret != GNUTLS_E_AGAIN)\n          throw GnuTlsException(\"gnutls_bye\", ret);\n\n      log_debug(\"poll\");\n      poll(POLLIN);\n    }\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "poll",
          "args": [
            "POLLIN"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"poll\""
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GnuTlsException",
          "args": [
            "\"gnutls_bye\"",
            "ret"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "formatMessage",
          "container": "GnuTlsException",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "129-136",
          "snippet": "std::string GnuTlsException::formatMessage(const char* function,\n    int code)\n  {\n    std::ostringstream msg;\n    msg << \"error \" << code << \" in function \" << function\n        << \": \" << gnutls_strerror(code);\n    return msg.str();\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsException {\n  std::string GnuTlsException::formatMessage(const char* function,\n      int code)\n    {\n      std::ostringstream msg;\n      msg << \"error \" << code << \" in function \" << function\n          << \": \" << gnutls_strerror(code);\n      return msg.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_bye => \" << ret"
          ],
          "line": 383
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_bye",
          "args": [
            "session",
            "GNUTLS_SHUT_RDWR"
          ],
          "line": 382
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_bye\""
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  void GnuTlsStream::shutdown()\n    {\n      int ret;\n  \n      fdInfo.timeout = 1000;\n  \n      // non-blocking/with timeout\n  \n      while (true)\n      {\n        log_debug(\"gnutls_bye\");\n        ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);\n        log_debug(\"gnutls_bye => \" << ret);\n  \n        if (ret == 0)\n        {\n          connected = false;\n          break;\n        }\n  \n        if (ret < 0\n          && ret != GNUTLS_E_INTERRUPTED\n          && ret != GNUTLS_E_AGAIN)\n            throw GnuTlsException(\"gnutls_bye\", ret);\n  \n        log_debug(\"poll\");\n        poll(POLLIN);\n      }\n    }\n}"
  },
  {
    "function_name": "sslWrite",
    "container": "GnuTlsStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "344-369",
    "snippet": "int GnuTlsStream::sslWrite(const char* buffer, int bufsize) const\n  {\n    int ret;\n\n    fdInfo.timeout = getTimeout();\n\n    // non-blocking/with timeout\n\n    while (true)\n    {\n      log_debug(\"gnutls_record_send\");\n      ret = gnutls_record_send(session, buffer, bufsize);\n      log_debug(\"gnutls_record_send => \" << ret);\n\n      if (ret > 0)\n        break;\n\n      if (ret == GNUTLS_E_AGAIN)\n        throw cxxtools::IOTimeout();\n\n      if (ret != GNUTLS_E_INTERRUPTED)\n        throw GnuTlsException(\"gnutls_record_send\", ret);\n    }\n\n    return ret;\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GnuTlsException",
          "args": [
            "\"gnutls_record_send\"",
            "ret"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "formatMessage",
          "container": "GnuTlsException",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "129-136",
          "snippet": "std::string GnuTlsException::formatMessage(const char* function,\n    int code)\n  {\n    std::ostringstream msg;\n    msg << \"error \" << code << \" in function \" << function\n        << \": \" << gnutls_strerror(code);\n    return msg.str();\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsException {\n  std::string GnuTlsException::formatMessage(const char* function,\n      int code)\n    {\n      std::ostringstream msg;\n      msg << \"error \" << code << \" in function \" << function\n          << \": \" << gnutls_strerror(code);\n      return msg.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cxxtools::IOTimeout",
          "args": [],
          "line": 362
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_record_send => \" << ret"
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_record_send",
          "args": [
            "session",
            "buffer",
            "bufsize"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_record_send\""
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getTimeout",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "getTimeout",
          "container": "GnuTls_iostream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/gnutls.h",
          "lines": "166-166",
          "snippet": "int getTimeout() const        { return m_buffer.getTimeout(); }",
          "includes": [
            "#include <gnutls/gnutls.h>",
            "#include <cxxtools/net/tcpstream.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/gnutls.h>\n#include <cxxtools/net/tcpstream.h>\n\nGnuTls_iostream {\n  int getTimeout() const        { return m_buffer.getTimeout(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  int GnuTlsStream::sslWrite(const char* buffer, int bufsize) const\n    {\n      int ret;\n  \n      fdInfo.timeout = getTimeout();\n  \n      // non-blocking/with timeout\n  \n      while (true)\n      {\n        log_debug(\"gnutls_record_send\");\n        ret = gnutls_record_send(session, buffer, bufsize);\n        log_debug(\"gnutls_record_send => \" << ret);\n  \n        if (ret > 0)\n          break;\n  \n        if (ret == GNUTLS_E_AGAIN)\n          throw cxxtools::IOTimeout();\n  \n        if (ret != GNUTLS_E_INTERRUPTED)\n          throw GnuTlsException(\"gnutls_record_send\", ret);\n      }\n  \n      return ret;\n    }\n}"
  },
  {
    "function_name": "sslRead",
    "container": "GnuTlsStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "313-342",
    "snippet": "int GnuTlsStream::sslRead(char* buffer, int bufsize) const\n  {\n    int ret;\n\n    fdInfo.timeout = getTimeout();\n\n    // non-blocking/with timeout\n\n    while (true)\n    {\n      log_debug(\"gnutls_record_recv (\" << bufsize << ')');\n      ret = gnutls_record_recv(session, buffer, bufsize);\n      log_debug(\"gnutls_record_recv => \" << ret);\n\n      // report GNUTLS_E_REHANDSHAKE as eof\n      if (ret == GNUTLS_E_REHANDSHAKE)\n        return 0;\n\n      if (ret >= 0)\n        break;\n\n      if (ret == GNUTLS_E_AGAIN)\n        throw cxxtools::IOTimeout();\n\n      if (ret < 0 && ret != GNUTLS_E_INTERRUPTED)\n        throw GnuTlsException(\"gnutls_record_recv\", ret);\n  }\n\n    return ret;\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GnuTlsException",
          "args": [
            "\"gnutls_record_recv\"",
            "ret"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "formatMessage",
          "container": "GnuTlsException",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "129-136",
          "snippet": "std::string GnuTlsException::formatMessage(const char* function,\n    int code)\n  {\n    std::ostringstream msg;\n    msg << \"error \" << code << \" in function \" << function\n        << \": \" << gnutls_strerror(code);\n    return msg.str();\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsException {\n  std::string GnuTlsException::formatMessage(const char* function,\n      int code)\n    {\n      std::ostringstream msg;\n      msg << \"error \" << code << \" in function \" << function\n          << \": \" << gnutls_strerror(code);\n      return msg.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cxxtools::IOTimeout",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_record_recv => \" << ret"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_record_recv",
          "args": [
            "session",
            "buffer",
            "bufsize"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_record_recv (\" << bufsize << ')'"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getTimeout",
          "args": [],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "getTimeout",
          "container": "GnuTls_iostream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/gnutls.h",
          "lines": "166-166",
          "snippet": "int getTimeout() const        { return m_buffer.getTimeout(); }",
          "includes": [
            "#include <gnutls/gnutls.h>",
            "#include <cxxtools/net/tcpstream.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/gnutls.h>\n#include <cxxtools/net/tcpstream.h>\n\nGnuTls_iostream {\n  int getTimeout() const        { return m_buffer.getTimeout(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  int GnuTlsStream::sslRead(char* buffer, int bufsize) const\n    {\n      int ret;\n  \n      fdInfo.timeout = getTimeout();\n  \n      // non-blocking/with timeout\n  \n      while (true)\n      {\n        log_debug(\"gnutls_record_recv (\" << bufsize << ')');\n        ret = gnutls_record_recv(session, buffer, bufsize);\n        log_debug(\"gnutls_record_recv => \" << ret);\n  \n        // report GNUTLS_E_REHANDSHAKE as eof\n        if (ret == GNUTLS_E_REHANDSHAKE)\n          return 0;\n  \n        if (ret >= 0)\n          break;\n  \n        if (ret == GNUTLS_E_AGAIN)\n          throw cxxtools::IOTimeout();\n  \n        if (ret < 0 && ret != GNUTLS_E_INTERRUPTED)\n          throw GnuTlsException(\"gnutls_record_recv\", ret);\n    }\n  \n      return ret;\n    }\n}"
  },
  {
    "function_name": "handshake",
    "container": "GnuTlsStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "263-311",
    "snippet": "void GnuTlsStream::handshake(const GnuTlsServer& server)\n  {\n    log_debug(\"gnutls_init(session, GNUTLS_SERVER)\");\n    int ret = gnutls_init(&session, GNUTLS_SERVER);\n    if (ret != 0)\n      throw GnuTlsException(\"gnutls_init\", ret);\n\n    log_debug(\"gnutls_set_default_priority\");\n    ret = gnutls_set_default_priority(session);\n    if (ret != 0)\n      throw GnuTlsException(\"gnutls_set_default_priority\", ret);\n\n    log_debug(\"gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, \"\n      << server.getCred() << ')');\n    ret = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, server.getCred());\n    if (ret != 0)\n      throw GnuTlsException(\"gnutls_credentials_set\", ret);\n\n    log_debug(\"gnutls_dh_set_prime_bits(session, 1024)\");\n    gnutls_dh_set_prime_bits(session, 1024);\n\n    fdInfo.fd = getFd();\n    fdInfo.timeout = getTimeout();\n\n    log_debug(\"gnutls_transport_set_ptr(ptr)\");\n    gnutls_transport_set_ptr(session, static_cast<gnutls_transport_ptr_t>(&fdInfo));\n\n    log_debug(\"gnutls_transport_set_pull_function()\");\n    gnutls_transport_set_pull_function(session, pull_func);\n\n    log_debug(\"gnutls_transport_set_push_function()\");\n    gnutls_transport_set_push_function(session, push_func);\n\n    // non-blocking/with timeout\n\n    fdInfo.timeout = 10000;\n\n    log_debug(\"gnutls_handshake\");\n    ret = gnutls_handshake(session);\n    log_debug(\"gnutls_handshake => \" << ret);\n\n    if (ret != 0)\n      throw GnuTlsException(\"gnutls_handshake\", ret);\n\n    connected = true;\n    fdInfo.timeout = getTimeout();\n\n    log_debug(\"ssl-handshake was completed\");\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"ssl-handshake was completed\""
          ],
          "line": 310
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getTimeout",
          "args": [],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "getTimeout",
          "container": "GnuTls_iostream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/gnutls.h",
          "lines": "166-166",
          "snippet": "int getTimeout() const        { return m_buffer.getTimeout(); }",
          "includes": [
            "#include <gnutls/gnutls.h>",
            "#include <cxxtools/net/tcpstream.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/gnutls.h>\n#include <cxxtools/net/tcpstream.h>\n\nGnuTls_iostream {\n  int getTimeout() const        { return m_buffer.getTimeout(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GnuTlsException",
          "args": [
            "\"gnutls_handshake\"",
            "ret"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "formatMessage",
          "container": "GnuTlsException",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "129-136",
          "snippet": "std::string GnuTlsException::formatMessage(const char* function,\n    int code)\n  {\n    std::ostringstream msg;\n    msg << \"error \" << code << \" in function \" << function\n        << \": \" << gnutls_strerror(code);\n    return msg.str();\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsException {\n  std::string GnuTlsException::formatMessage(const char* function,\n      int code)\n    {\n      std::ostringstream msg;\n      msg << \"error \" << code << \" in function \" << function\n          << \": \" << gnutls_strerror(code);\n      return msg.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_handshake => \" << ret"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_handshake",
          "args": [
            "session"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_handshake\""
          ],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_transport_set_push_function",
          "args": [
            "session",
            "push_func"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_transport_set_push_function()\""
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_transport_set_pull_function",
          "args": [
            "session",
            "pull_func"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_transport_set_pull_function()\""
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_transport_set_ptr",
          "args": [
            "session",
            "static_cast<gnutls_transport_ptr_t>(&fdInfo)"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<gnutls_transport_ptr_t>",
          "args": [
            "&fdInfo"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_transport_set_ptr(ptr)\""
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getFd",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "getFd",
          "container": "SslTcpjob",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/job.cpp",
          "lines": "214-217",
          "snippet": "int SslTcpjob::getFd() const\n  {\n    return socket.getFd();\n  }",
          "includes": [
            "#include <fcntl.h>",
            "#include <config.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/ssl.h>",
            "#include <tnt/httpreply.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/tcpjob.h\"",
            "#include \"tnt/job.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <fcntl.h>\n#include <config.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <cxxtools/log.h>\n#include <tnt/ssl.h>\n#include <tnt/httpreply.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/tcpjob.h\"\n#include \"tnt/job.h\"\n\nSslTcpjob {\n  int SslTcpjob::getFd() const\n    {\n      return socket.getFd();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "gnutls_dh_set_prime_bits",
          "args": [
            "session",
            "1024"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_dh_set_prime_bits(session, 1024)\""
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_credentials_set",
          "args": [
            "session",
            "GNUTLS_CRD_CERTIFICATE",
            "server.getCred()"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "server.getCred",
          "args": [],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "getCred",
          "container": "GnuTlsServer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/gnutls.h",
          "lines": "90-90",
          "snippet": "gnutls_certificate_credentials getCred() const  { return cred; }",
          "includes": [
            "#include <gnutls/gnutls.h>",
            "#include <cxxtools/net/tcpstream.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/gnutls.h>\n#include <cxxtools/net/tcpstream.h>\n\nGnuTlsServer {\n  gnutls_certificate_credentials getCred() const  { return cred; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, \"\n      << server.getCred() << ')'"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_set_default_priority",
          "args": [
            "session"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_set_default_priority\""
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_init",
          "args": [
            "&session",
            "GNUTLS_SERVER"
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_init(session, GNUTLS_SERVER)\""
          ],
          "line": 265
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  void GnuTlsStream::handshake(const GnuTlsServer& server)\n    {\n      log_debug(\"gnutls_init(session, GNUTLS_SERVER)\");\n      int ret = gnutls_init(&session, GNUTLS_SERVER);\n      if (ret != 0)\n        throw GnuTlsException(\"gnutls_init\", ret);\n  \n      log_debug(\"gnutls_set_default_priority\");\n      ret = gnutls_set_default_priority(session);\n      if (ret != 0)\n        throw GnuTlsException(\"gnutls_set_default_priority\", ret);\n  \n      log_debug(\"gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, \"\n        << server.getCred() << ')');\n      ret = gnutls_credentials_set(session, GNUTLS_CRD_CERTIFICATE, server.getCred());\n      if (ret != 0)\n        throw GnuTlsException(\"gnutls_credentials_set\", ret);\n  \n      log_debug(\"gnutls_dh_set_prime_bits(session, 1024)\");\n      gnutls_dh_set_prime_bits(session, 1024);\n  \n      fdInfo.fd = getFd();\n      fdInfo.timeout = getTimeout();\n  \n      log_debug(\"gnutls_transport_set_ptr(ptr)\");\n      gnutls_transport_set_ptr(session, static_cast<gnutls_transport_ptr_t>(&fdInfo));\n  \n      log_debug(\"gnutls_transport_set_pull_function()\");\n      gnutls_transport_set_pull_function(session, pull_func);\n  \n      log_debug(\"gnutls_transport_set_push_function()\");\n      gnutls_transport_set_push_function(session, push_func);\n  \n      // non-blocking/with timeout\n  \n      fdInfo.timeout = 10000;\n  \n      log_debug(\"gnutls_handshake\");\n      ret = gnutls_handshake(session);\n      log_debug(\"gnutls_handshake => \" << ret);\n  \n      if (ret != 0)\n        throw GnuTlsException(\"gnutls_handshake\", ret);\n  \n      connected = true;\n      fdInfo.timeout = getTimeout();\n  \n      log_debug(\"ssl-handshake was completed\");\n    }\n}"
  },
  {
    "function_name": "accept",
    "container": "GnuTlsStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "257-261",
    "snippet": "void GnuTlsStream::accept(const GnuTlsServer& server, bool inherit)\n  {\n    log_debug(\"accept\");\n    cxxtools::net::TcpSocket::accept(server, inherit);\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::net::TcpSocket::accept",
          "args": [
            "server",
            "inherit"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "GnuTlsStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "257-261",
          "snippet": "void GnuTlsStream::accept(const GnuTlsServer& server, bool inherit)\n  {\n    log_debug(\"accept\");\n    cxxtools::net::TcpSocket::accept(server, inherit);\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"accept\""
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  void GnuTlsStream::accept(const GnuTlsServer& server, bool inherit)\n    {\n      log_debug(\"accept\");\n      cxxtools::net::TcpSocket::accept(server, inherit);\n    }\n}"
  },
  {
    "function_name": "~GnuTlsStream",
    "container": "GnuTlsStream",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "236-255",
    "snippet": "GnuTlsStream::~GnuTlsStream()\n  {\n    if (session)\n    {\n      if (connected)\n      {\n        try\n        {\n          shutdown();\n        }\n        catch (const std::exception& e)\n        {\n          log_debug(\"error shutting down ssl-conneciton: \" << e.what());\n        }\n      }\n\n      log_debug(\"gnutls_deinit(session)\");\n      gnutls_deinit(session);\n    }\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gnutls_deinit",
          "args": [
            "session"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_deinit(session)\""
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"error shutting down ssl-conneciton: \" << e.what()"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "shutdown",
          "args": [],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "shutdown",
          "container": "GnuTlsStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "371-399",
          "snippet": "void GnuTlsStream::shutdown()\n  {\n    int ret;\n\n    fdInfo.timeout = 1000;\n\n    // non-blocking/with timeout\n\n    while (true)\n    {\n      log_debug(\"gnutls_bye\");\n      ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);\n      log_debug(\"gnutls_bye => \" << ret);\n\n      if (ret == 0)\n      {\n        connected = false;\n        break;\n      }\n\n      if (ret < 0\n        && ret != GNUTLS_E_INTERRUPTED\n        && ret != GNUTLS_E_AGAIN)\n          throw GnuTlsException(\"gnutls_bye\", ret);\n\n      log_debug(\"poll\");\n      poll(POLLIN);\n    }\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  void GnuTlsStream::shutdown()\n    {\n      int ret;\n  \n      fdInfo.timeout = 1000;\n  \n      // non-blocking/with timeout\n  \n      while (true)\n      {\n        log_debug(\"gnutls_bye\");\n        ret = gnutls_bye(session, GNUTLS_SHUT_RDWR);\n        log_debug(\"gnutls_bye => \" << ret);\n  \n        if (ret == 0)\n        {\n          connected = false;\n          break;\n        }\n  \n        if (ret < 0\n          && ret != GNUTLS_E_INTERRUPTED\n          && ret != GNUTLS_E_AGAIN)\n            throw GnuTlsException(\"gnutls_bye\", ret);\n  \n        log_debug(\"poll\");\n        poll(POLLIN);\n      }\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsStream {\n  GnuTlsStream::~GnuTlsStream()\n    {\n      if (session)\n      {\n        if (connected)\n        {\n          try\n          {\n            shutdown();\n          }\n          catch (const std::exception& e)\n          {\n            log_debug(\"error shutting down ssl-conneciton: \" << e.what());\n          }\n        }\n  \n        log_debug(\"gnutls_deinit(session)\");\n        gnutls_deinit(session);\n      }\n    }\n}"
  },
  {
    "function_name": "GnuTlsServer",
    "container": "GnuTlsServer",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "227-230",
    "snippet": "GnuTlsServer::GnuTlsServer(const char* certificateFile, const char* privateKeyFile)\n    : cred(certificateFile, privateKeyFile)\n  {\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsServer {\n  GnuTlsServer::GnuTlsServer(const char* certificateFile, const char* privateKeyFile)\n      : cred(certificateFile, privateKeyFile)\n    {\n    }\n}"
  },
  {
    "function_name": "~GnuTlsX509Cred",
    "container": "GnuTlsX509Cred",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "217-221",
    "snippet": "GnuTlsX509Cred::~GnuTlsX509Cred()\n  {\n    log_debug(\"gnutls_certificate_free_credentials\");\n    gnutls_certificate_free_credentials(x509_cred);\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gnutls_certificate_free_credentials",
          "args": [
            "x509_cred"
          ],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_certificate_free_credentials\""
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsX509Cred {\n  GnuTlsX509Cred::~GnuTlsX509Cred()\n    {\n      log_debug(\"gnutls_certificate_free_credentials\");\n      gnutls_certificate_free_credentials(x509_cred);\n    }\n}"
  },
  {
    "function_name": "GnuTlsX509Cred",
    "container": "GnuTlsX509Cred",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "182-215",
    "snippet": "GnuTlsX509Cred::GnuTlsX509Cred(const char* certificateFile,\n    const char* privateKeyFile)\n  {\n    int ret;\n\n    log_debug(\"gnutls_certificate_allocate_credentials\");\n    ret = gnutls_certificate_allocate_credentials(&x509_cred);\n    if (ret != 0)\n      throw GnuTlsException(\"gnutls_certificate_allocate_credentials\", ret);\n    log_debug(\"gnutls_certificate_allocate_credentials => \" << x509_cred);\n\n    // gnutls_certificate_set_x509_trust_file(x509_cred, caFile, GNUTLS_X509_FMT_PEM);\n    // gnutls_certificate_set_x509_crl_file(x509_cred, crlFile, GNUTLS_X509_FMT_PEM);\n\n    try\n    {\n      log_debug(\"gnutls_certificate_set_x509_key_file(x509_cred, \\\"\"\n        << certificateFile << \"\\\", \\\"\" << privateKeyFile\n        << \"\\\", GNUTLS_X509_FMT_PEM)\");\n      ret = gnutls_certificate_set_x509_key_file(x509_cred, certificateFile,\n        privateKeyFile, GNUTLS_X509_FMT_PEM);\n      if (ret < 0)\n        throw GnuTlsException(\"gnutls_certificate_set_x509_key_file\", ret);\n\n      log_debug(\"gnutls_certificate_set_dh_params\");\n      gnutls_certificate_set_dh_params(x509_cred, init.getDhParams());\n    }\n    catch (...)\n    {\n      log_debug(\"gnutls_certificate_free_credentials\");\n      gnutls_certificate_free_credentials(x509_cred);\n      throw;\n    }\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gnutls_certificate_free_credentials",
          "args": [
            "x509_cred"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_certificate_free_credentials\""
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_certificate_set_dh_params",
          "args": [
            "x509_cred",
            "init.getDhParams()"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "init.getDhParams",
          "args": [],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "getDhParams",
          "container": "GnuTlsInit",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/gnutls.h",
          "lines": "68-68",
          "snippet": "gnutls_dh_params getDhParams() const  { return dhParams; }",
          "includes": [
            "#include <gnutls/gnutls.h>",
            "#include <cxxtools/net/tcpstream.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <gnutls/gnutls.h>\n#include <cxxtools/net/tcpstream.h>\n\nGnuTlsInit {\n  gnutls_dh_params getDhParams() const  { return dhParams; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_certificate_set_dh_params\""
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GnuTlsException",
          "args": [
            "\"gnutls_certificate_set_x509_key_file\"",
            "ret"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "formatMessage",
          "container": "GnuTlsException",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "129-136",
          "snippet": "std::string GnuTlsException::formatMessage(const char* function,\n    int code)\n  {\n    std::ostringstream msg;\n    msg << \"error \" << code << \" in function \" << function\n        << \": \" << gnutls_strerror(code);\n    return msg.str();\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsException {\n  std::string GnuTlsException::formatMessage(const char* function,\n      int code)\n    {\n      std::ostringstream msg;\n      msg << \"error \" << code << \" in function \" << function\n          << \": \" << gnutls_strerror(code);\n      return msg.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "gnutls_certificate_set_x509_key_file",
          "args": [
            "x509_cred",
            "certificateFile",
            "privateKeyFile",
            "GNUTLS_X509_FMT_PEM"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_certificate_set_x509_key_file(x509_cred, \\\"\"\n        << certificateFile << \"\\\", \\\"\" << privateKeyFile\n        << \"\\\", GNUTLS_X509_FMT_PEM)\""
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_certificate_allocate_credentials => \" << x509_cred"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_certificate_allocate_credentials",
          "args": [
            "&x509_cred"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_certificate_allocate_credentials\""
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsX509Cred {\n  GnuTlsX509Cred::GnuTlsX509Cred(const char* certificateFile,\n      const char* privateKeyFile)\n    {\n      int ret;\n  \n      log_debug(\"gnutls_certificate_allocate_credentials\");\n      ret = gnutls_certificate_allocate_credentials(&x509_cred);\n      if (ret != 0)\n        throw GnuTlsException(\"gnutls_certificate_allocate_credentials\", ret);\n      log_debug(\"gnutls_certificate_allocate_credentials => \" << x509_cred);\n  \n      // gnutls_certificate_set_x509_trust_file(x509_cred, caFile, GNUTLS_X509_FMT_PEM);\n      // gnutls_certificate_set_x509_crl_file(x509_cred, crlFile, GNUTLS_X509_FMT_PEM);\n  \n      try\n      {\n        log_debug(\"gnutls_certificate_set_x509_key_file(x509_cred, \\\"\"\n          << certificateFile << \"\\\", \\\"\" << privateKeyFile\n          << \"\\\", GNUTLS_X509_FMT_PEM)\");\n        ret = gnutls_certificate_set_x509_key_file(x509_cred, certificateFile,\n          privateKeyFile, GNUTLS_X509_FMT_PEM);\n        if (ret < 0)\n          throw GnuTlsException(\"gnutls_certificate_set_x509_key_file\", ret);\n  \n        log_debug(\"gnutls_certificate_set_dh_params\");\n        gnutls_certificate_set_dh_params(x509_cred, init.getDhParams());\n      }\n      catch (...)\n      {\n        log_debug(\"gnutls_certificate_free_credentials\");\n        gnutls_certificate_free_credentials(x509_cred);\n        throw;\n      }\n    }\n}"
  },
  {
    "function_name": "~GnuTlsInit",
    "container": "GnuTlsInit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "169-177",
    "snippet": "GnuTlsInit::~GnuTlsInit()\n  {\n    cxxtools::MutexLock lock(mutex);\n    if (--initCount == 0)\n    {\n      log_debug(\"gnutls_global_deinit()\");\n      gnutls_global_deinit();\n    }\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gnutls_global_deinit",
          "args": [],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_global_deinit()\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsInit {\n  GnuTlsInit::~GnuTlsInit()\n    {\n      cxxtools::MutexLock lock(mutex);\n      if (--initCount == 0)\n      {\n        log_debug(\"gnutls_global_deinit()\");\n        gnutls_global_deinit();\n      }\n    }\n}"
  },
  {
    "function_name": "GnuTlsInit",
    "container": "GnuTlsInit",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "145-167",
    "snippet": "GnuTlsInit::GnuTlsInit()\n  {\n    int ret;\n\n    cxxtools::MutexLock lock(mutex);\n    if (initCount++ == 0)\n    {\n      log_debug(\"gnutls_global_init()\");\n      ret = gnutls_global_init();\n      if (ret != 0)\n        throw GnuTlsException(\"gnutls_global_init\", ret);\n\n      log_debug(\"gnutls_dh_params_init(dhParams)\");\n      ret = gnutls_dh_params_init(&dhParams);\n      if (ret != 0)\n        throw GnuTlsException(\"gnutls_dh_params_init\", ret);\n\n      log_debug(\"gnutls_dh_params_generate2(dh_params, 1024)\");\n      ret = gnutls_dh_params_generate2(dhParams, 1024);\n      if (ret != 0)\n        throw GnuTlsException(\"gnutls_dh_params_generate2\", ret);\n    }\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GnuTlsException",
          "args": [
            "\"gnutls_dh_params_generate2\"",
            "ret"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "formatMessage",
          "container": "GnuTlsException",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
          "lines": "129-136",
          "snippet": "std::string GnuTlsException::formatMessage(const char* function,\n    int code)\n  {\n    std::ostringstream msg;\n    msg << \"error \" << code << \" in function \" << function\n        << \": \" << gnutls_strerror(code);\n    return msg.str();\n  }",
          "includes": [
            "#include <cxxtools/ioerror.h>",
            "#include <errno.h>",
            "#include <sys/poll.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/mutex.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/gnutls.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsException {\n  std::string GnuTlsException::formatMessage(const char* function,\n      int code)\n    {\n      std::ostringstream msg;\n      msg << \"error \" << code << \" in function \" << function\n          << \": \" << gnutls_strerror(code);\n      return msg.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "gnutls_dh_params_generate2",
          "args": [
            "dhParams",
            "1024"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_dh_params_generate2(dh_params, 1024)\""
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_dh_params_init",
          "args": [
            "&dhParams"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_dh_params_init(dhParams)\""
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_global_init",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"gnutls_global_init()\""
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsInit {\n  GnuTlsInit::GnuTlsInit()\n    {\n      int ret;\n  \n      cxxtools::MutexLock lock(mutex);\n      if (initCount++ == 0)\n      {\n        log_debug(\"gnutls_global_init()\");\n        ret = gnutls_global_init();\n        if (ret != 0)\n          throw GnuTlsException(\"gnutls_global_init\", ret);\n  \n        log_debug(\"gnutls_dh_params_init(dhParams)\");\n        ret = gnutls_dh_params_init(&dhParams);\n        if (ret != 0)\n          throw GnuTlsException(\"gnutls_dh_params_init\", ret);\n  \n        log_debug(\"gnutls_dh_params_generate2(dh_params, 1024)\");\n        ret = gnutls_dh_params_generate2(dhParams, 1024);\n        if (ret != 0)\n          throw GnuTlsException(\"gnutls_dh_params_generate2\", ret);\n      }\n    }\n}"
  },
  {
    "function_name": "formatMessage",
    "container": "GnuTlsException",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "129-136",
    "snippet": "std::string GnuTlsException::formatMessage(const char* function,\n    int code)\n  {\n    std::ostringstream msg;\n    msg << \"error \" << code << \" in function \" << function\n        << \": \" << gnutls_strerror(code);\n    return msg.str();\n  }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "msg.str",
          "args": [],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gnutls_strerror",
          "args": [
            "code"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nGnuTlsException {\n  std::string GnuTlsException::formatMessage(const char* function,\n      int code)\n    {\n      std::ostringstream msg;\n      msg << \"error \" << code << \" in function \" << function\n          << \": \" << gnutls_strerror(code);\n      return msg.str();\n    }\n}"
  },
  {
    "function_name": "push_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "87-122",
    "snippet": "ssize_t push_func(gnutls_transport_ptr_t ptr, const void* buffer, size_t bufsize)\n    {\n      const GnuTlsStream::FdInfo& fdInfo = *static_cast<const GnuTlsStream::FdInfo*>(ptr);\n\n      while (true)\n      {\n        log_debug(\"write fd=\" << fdInfo.fd << \"; size=\" << bufsize);\n        ssize_t n = ::write(fdInfo.fd, buffer, bufsize);\n        log_debug(\"write returns \" << n);\n\n        if (n > 0)\n          return n;\n        else if (n == 0 || errno == ECONNRESET)\n          return 0;\n        else if (errno == EAGAIN)\n        {\n          // poll\n          struct pollfd fds;\n          fds.fd = fdInfo.fd;\n          fds.events = POLLOUT;\n\n          int p = ::poll(&fds, 1, fdInfo.timeout);\n          if (p == 0)\n          {\n            errno = EAGAIN;\n            return -1;\n          }\n          else if (p < 0)\n            return p;\n        }\n        else if (errno != EINTR)\n          return -1;\n      }\n\n      return -1;\n    }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::poll",
          "args": [
            "&fds",
            "1",
            "fdInfo.timeout"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"write returns \" << n"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::write",
          "args": [
            "fdInfo.fd",
            "buffer",
            "bufsize"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"write fd=\" << fdInfo.fd << \"; size=\" << bufsize"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<const GnuTlsStream::FdInfo*>",
          "args": [
            "ptr"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nssize_t push_func(gnutls_transport_ptr_t ptr, const void* buffer, size_t bufsize)\n    {\n      const GnuTlsStream::FdInfo& fdInfo = *static_cast<const GnuTlsStream::FdInfo*>(ptr);\n\n      while (true)\n      {\n        log_debug(\"write fd=\" << fdInfo.fd << \"; size=\" << bufsize);\n        ssize_t n = ::write(fdInfo.fd, buffer, bufsize);\n        log_debug(\"write returns \" << n);\n\n        if (n > 0)\n          return n;\n        else if (n == 0 || errno == ECONNRESET)\n          return 0;\n        else if (errno == EAGAIN)\n        {\n          // poll\n          struct pollfd fds;\n          fds.fd = fdInfo.fd;\n          fds.events = POLLOUT;\n\n          int p = ::poll(&fds, 1, fdInfo.timeout);\n          if (p == 0)\n          {\n            errno = EAGAIN;\n            return -1;\n          }\n          else if (p < 0)\n            return p;\n        }\n        else if (errno != EINTR)\n          return -1;\n      }\n\n      return -1;\n    }"
  },
  {
    "function_name": "pull_func",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/gnutls.cpp",
    "lines": "48-84",
    "snippet": "ssize_t pull_func(gnutls_transport_ptr_t ptr, void* buffer, size_t bufsize)\n    {\n      const GnuTlsStream::FdInfo& fdInfo = *static_cast<const GnuTlsStream::FdInfo*>(ptr);\n\n      while (true)\n      {\n        log_debug(\"read fd=\" << fdInfo.fd << \"; size=\" << bufsize);\n        ssize_t n = ::read(fdInfo.fd, buffer, bufsize);\n        log_debug(\"read returns \" << n << \" errno=\" << errno);\n\n        if (n > 0)\n          return n;\n        else if (n == 0 || errno == ECONNRESET)\n          return 0;\n        else if (errno == EAGAIN)\n        {\n          // poll\n          struct pollfd fds;\n          fds.fd = fdInfo.fd;\n          fds.events = POLLIN;\n\n          log_debug(\"poll; timeout \" << fdInfo.timeout);\n          int p = ::poll(&fds, 1, fdInfo.timeout);\n          if (p == 0)\n          {\n            errno = EAGAIN;\n            return -1;\n          }\n          else if (p < 0)\n            return p;\n        }\n        else if (errno != EINTR)\n          return -1;\n      }\n\n      return -1;\n    }",
    "includes": [
      "#include <cxxtools/ioerror.h>",
      "#include <errno.h>",
      "#include <sys/poll.h>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/mutex.h>",
      "#include \"tnt/tntnet.h\"",
      "#include \"tnt/gnutls.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "::poll",
          "args": [
            "&fds",
            "1",
            "fdInfo.timeout"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"poll; timeout \" << fdInfo.timeout"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"read returns \" << n << \" errno=\" << errno"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::read",
          "args": [
            "fdInfo.fd",
            "buffer",
            "bufsize"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"read fd=\" << fdInfo.fd << \"; size=\" << bufsize"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<const GnuTlsStream::FdInfo*>",
          "args": [
            "ptr"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/ioerror.h>\n#include <errno.h>\n#include <sys/poll.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <cxxtools/mutex.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/gnutls.h\"\n\nssize_t pull_func(gnutls_transport_ptr_t ptr, void* buffer, size_t bufsize)\n    {\n      const GnuTlsStream::FdInfo& fdInfo = *static_cast<const GnuTlsStream::FdInfo*>(ptr);\n\n      while (true)\n      {\n        log_debug(\"read fd=\" << fdInfo.fd << \"; size=\" << bufsize);\n        ssize_t n = ::read(fdInfo.fd, buffer, bufsize);\n        log_debug(\"read returns \" << n << \" errno=\" << errno);\n\n        if (n > 0)\n          return n;\n        else if (n == 0 || errno == ECONNRESET)\n          return 0;\n        else if (errno == EAGAIN)\n        {\n          // poll\n          struct pollfd fds;\n          fds.fd = fdInfo.fd;\n          fds.events = POLLIN;\n\n          log_debug(\"poll; timeout \" << fdInfo.timeout);\n          int p = ::poll(&fds, 1, fdInfo.timeout);\n          if (p == 0)\n          {\n            errno = EAGAIN;\n            return -1;\n          }\n          else if (p < 0)\n            return p;\n        }\n        else if (errno != EINTR)\n          return -1;\n      }\n\n      return -1;\n    }"
  }
]