[
  {
    "function_name": "Comploader::registerFactory",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/comploader.cpp",
    "lines": "291-312",
    "snippet": "void Comploader::registerFactory(const std::string& component_name,\n  ComponentFactory* factory)\n{\n  log_debug(\"Comploader::registerFactory(\" << component_name << \", \" << factory << ')');\n\n  if (currentFactoryMap)\n    currentFactoryMap->insert(ComponentLibrary::factoryMapType::value_type(component_name, factory));\n  else\n  {\n    librarymap_type& librarymap = getLibrarymap();\n    log_debug(\"register component without library-name\");\n    librarymap_type::iterator it = librarymap.find(std::string());\n    if (it == librarymap.end())\n    {\n      // empty library not in map - create a new empty library-object\n      it = librarymap.insert(\n        librarymap_type::value_type(std::string(),\n                                    ComponentLibrary())).first;\n    }\n    it->second.registerFactory(component_name, factory);\n  }\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <cxxtools/dlloader.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/componentfactory.h>",
      "#include <tnt/comploader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "it->second.registerFactory",
          "args": [
            "component_name",
            "factory"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "registerFactory",
          "container": "ComponentLibrary",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
          "lines": "109-110",
          "snippet": "void registerFactory(const std::string& component_name, ComponentFactory* factory)\n        { factoryMap.insert(factoryMapType::value_type(component_name, factory)); }",
          "includes": [
            "#include <dlfcn.h>",
            "#include <utility>",
            "#include <string>",
            "#include <list>",
            "#include <map>",
            "#include <tnt/langlib.h>",
            "#include <tnt/urlmapper.h>",
            "#include <cxxtools/smartptr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nComponentLibrary {\n  void registerFactory(const std::string& component_name, ComponentFactory* factory)\n          { factoryMap.insert(factoryMapType::value_type(component_name, factory)); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "librarymap.insert",
          "args": [
            "librarymap_type::value_type(std::string(),\n                                    ComponentLibrary())"
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "librarymap_type::value_type",
          "args": [
            "std::string()",
            "ComponentLibrary()"
          ],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ComponentLibrary",
          "args": [],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "ComponentLibrary",
          "container": "ComponentLibrary",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/comploader.h",
          "lines": "90-91",
          "snippet": "ComponentLibrary()\n        { }",
          "includes": [
            "#include <dlfcn.h>",
            "#include <utility>",
            "#include <string>",
            "#include <list>",
            "#include <map>",
            "#include <tnt/langlib.h>",
            "#include <tnt/urlmapper.h>",
            "#include <cxxtools/smartptr.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <dlfcn.h>\n#include <utility>\n#include <string>\n#include <list>\n#include <map>\n#include <tnt/langlib.h>\n#include <tnt/urlmapper.h>\n#include <cxxtools/smartptr.h>\n\nComponentLibrary {\n  ComponentLibrary()\n          { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 307
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "librarymap.end",
          "args": [],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "librarymap.find",
          "args": [
            "std::string()"
          ],
          "line": 302
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"register component without library-name\""
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getLibrarymap",
          "args": [],
          "line": 300
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "currentFactoryMap->insert",
          "args": [
            "ComponentLibrary::factoryMapType::value_type(component_name, factory)"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ComponentLibrary::factoryMapType::value_type",
          "args": [
            "component_name",
            "factory"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"Comploader::registerFactory(\" << component_name << \", \" << factory << ')'"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <cxxtools/dlloader.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/componentfactory.h>\n#include <tnt/comploader.h>\n\nvoid Comploader::registerFactory(const std::string& component_name,\n  ComponentFactory* factory)\n{\n  log_debug(\"Comploader::registerFactory(\" << component_name << \", \" << factory << ')');\n\n  if (currentFactoryMap)\n    currentFactoryMap->insert(ComponentLibrary::factoryMapType::value_type(component_name, factory));\n  else\n  {\n    librarymap_type& librarymap = getLibrarymap();\n    log_debug(\"register component without library-name\");\n    librarymap_type::iterator it = librarymap.find(std::string());\n    if (it == librarymap.end())\n    {\n      // empty library not in map - create a new empty library-object\n      it = librarymap.insert(\n        librarymap_type::value_type(std::string(),\n                                    ComponentLibrary())).first;\n    }\n    it->second.registerFactory(component_name, factory);\n  }\n}"
  },
  {
    "function_name": "ValueResetter",
    "container": "ValueResetter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/comploader.cpp",
    "lines": "218-221",
    "snippet": "explicit ValueResetter(T& value_, T null_ = T())\n        : value(value_),\n          null(null_)\n          { }",
    "includes": [
      "#include <stdlib.h>",
      "#include <cxxtools/dlloader.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/componentfactory.h>",
      "#include <tnt/comploader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "T",
          "args": [],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "getTimeout",
          "container": "Sessionscope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/sessionscope.h",
          "lines": "51-51",
          "snippet": "unsigned getTimeout() const                { return timeout; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/scope.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/tntconfig.h>\n#include <tnt/scope.h>\n\nSessionscope {\n  unsigned getTimeout() const                { return timeout; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <cxxtools/dlloader.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/componentfactory.h>\n#include <tnt/comploader.h>\n\nValueResetter {\n  explicit ValueResetter(T& value_, T null_ = T())\n          : value(value_),\n            null(null_)\n            { }\n}"
  },
  {
    "function_name": "ComponentLibrary::getLangLib",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/comploader.cpp",
    "lines": "124-146",
    "snippet": "LangLib::PtrType ComponentLibrary::getLangLib(const std::string& lang)\n{\n  cxxtools::ReadLock rlock(mutex);\n  langlibsType::const_iterator it = langlibs.find(lang);\n  if (it != langlibs.end())\n    return it->second;\n\n  rlock.unlock();\n  cxxtools::WriteLock wlock(mutex);\n\n  LangLib::PtrType l;\n  try\n  {\n    std::string n = (path.empty() ? libname : (path + '/' + libname));\n    l = new LangLib(n, lang);\n  }\n  catch (const unzipError& e)\n  {\n    log_warn(\"unzipError: \" << e.what());\n  }\n  langlibs[lang] = l;\n  return l;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <cxxtools/dlloader.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/componentfactory.h>",
      "#include <tnt/comploader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"unzipError: \" << e.what()"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "path.empty",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "rlock.unlock",
          "args": [],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "unlock",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "70-70",
          "snippet": "void unlock() { mutex.unlock(); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void unlock() { mutex.unlock(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "langlibs.end",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "langlibs.find",
          "args": [
            "lang"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "134-135",
          "snippet": "const_iterator find(const std::string& key) const\n        { return find(key.c_str()); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator find(const std::string& key) const\n          { return find(key.c_str()); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <cxxtools/dlloader.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/componentfactory.h>\n#include <tnt/comploader.h>\n\nLangLib::PtrType ComponentLibrary::getLangLib(const std::string& lang)\n{\n  cxxtools::ReadLock rlock(mutex);\n  langlibsType::const_iterator it = langlibs.find(lang);\n  if (it != langlibs.end())\n    return it->second;\n\n  rlock.unlock();\n  cxxtools::WriteLock wlock(mutex);\n\n  LangLib::PtrType l;\n  try\n  {\n    std::string n = (path.empty() ? libname : (path + '/' + libname));\n    l = new LangLib(n, lang);\n  }\n  catch (const unzipError& e)\n  {\n    log_warn(\"unzipError: \" << e.what());\n  }\n  langlibs[lang] = l;\n  return l;\n}"
  },
  {
    "function_name": "ComponentLibrary::init",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/comploader.cpp",
    "lines": "95-100",
    "snippet": "void ComponentLibrary::init(const std::string& name, bool local)\n{\n  void* handle = dlopen(name, local);\n  if (handle)\n    handlePtr = new HandleType(handle);\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include <cxxtools/dlloader.h>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/util.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/componentfactory.h>",
      "#include <tnt/comploader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dlopen",
          "args": [
            "name",
            "local"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include <cxxtools/dlloader.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/componentfactory.h>\n#include <tnt/comploader.h>\n\nvoid ComponentLibrary::init(const std::string& name, bool local)\n{\n  void* handle = dlopen(name, local);\n  if (handle)\n    handlePtr = new HandleType(handle);\n}"
  }
]