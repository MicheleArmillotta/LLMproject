[
  {
    "function_name": "requestSizeExceeded",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "446-451",
    "snippet": "void HttpRequest::Parser::requestSizeExceeded()\n  {\n    log_warn(\"max request size \" << TntConfig::it().maxRequestSize << \" exceeded\");\n    httpCode = HTTP_REQUEST_ENTITY_TOO_LARGE;\n    failedFlag = true;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"max request size \" << TntConfig::it().maxRequestSize << \" exceeded\""
          ],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    void HttpRequest::Parser::requestSizeExceeded()\n      {\n        log_warn(\"max request size \" << TntConfig::it().maxRequestSize << \" exceeded\");\n        httpCode = HTTP_REQUEST_ENTITY_TOO_LARGE;\n        failedFlag = true;\n      }\n  }\n}"
  },
  {
    "function_name": "state_body",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "440-444",
    "snippet": "bool HttpRequest::Parser::state_body(char ch)\n  {\n    message.body += ch;\n    return --bodySize == 0;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_body(char ch)\n      {\n        message.body += ch;\n        return --bodySize == 0;\n      }\n  }\n}"
  },
  {
    "function_name": "state_header",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "394-438",
    "snippet": "bool HttpRequest::Parser::state_header(char ch)\n  {\n    if (headerParser.parse(ch))\n    {\n      if (headerParser.failed())\n      {\n        httpCode = HTTP_BAD_REQUEST;\n        failedFlag = true;\n        return true;\n      }\n\n      const char* content_length_header = message.getHeader(httpheader::contentLength);\n      if (*content_length_header)\n      {\n        bodySize = 0;\n        for (const char* c = content_length_header; *c; ++c)\n        {\n          if (*c > '9' || *c < '0')\n            throw HttpError(HTTP_BAD_REQUEST, \"invalid Content-Length\");\n          bodySize = bodySize * 10 + *c - '0';\n        }\n\n        if (TntConfig::it().maxRequestSize > 0\n          && getCurrentRequestSize() + bodySize > TntConfig::it().maxRequestSize)\n        {\n          requestSizeExceeded();\n          return true;\n        }\n\n        message.contentSize = bodySize;\n        if (bodySize == 0)\n          return true;\n        else\n        {\n          SET_STATE(state_body);\n          message.body.reserve(bodySize);\n          return false;\n        }\n      }\n\n      return true;\n    }\n\n    return false;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "message.body.reserve",
          "args": [
            "bodySize"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_body"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "requestSizeExceeded",
          "args": [],
          "line": 419
        },
        "resolved": true,
        "details": {
          "function_name": "requestSizeExceeded",
          "container": "HttpRequest::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "446-451",
          "snippet": "void HttpRequest::Parser::requestSizeExceeded()\n  {\n    log_warn(\"max request size \" << TntConfig::it().maxRequestSize << \" exceeded\");\n    httpCode = HTTP_REQUEST_ENTITY_TOO_LARGE;\n    failedFlag = true;\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    void HttpRequest::Parser::requestSizeExceeded()\n      {\n        log_warn(\"max request size \" << TntConfig::it().maxRequestSize << \" exceeded\");\n        httpCode = HTTP_REQUEST_ENTITY_TOO_LARGE;\n        failedFlag = true;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 417
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getCurrentRequestSize",
          "args": [],
          "line": 417
        },
        "resolved": true,
        "details": {
          "function_name": "getCurrentRequestSize",
          "container": "RequestSizeMonitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpparser.h",
          "lines": "57-57",
          "snippet": "size_t getCurrentRequestSize() const  { return requestSize; }",
          "includes": [
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/parser.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/messageheaderparser.h>\n#include <tnt/parser.h>\n#include <tnt/http.h>\n#include <tnt/httprequest.h>\n\nRequestSizeMonitor {\n  size_t getCurrentRequestSize() const  { return requestSize; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HttpError",
          "args": [
            "HTTP_BAD_REQUEST",
            "\"invalid Content-Length\""
          ],
          "line": 412
        },
        "resolved": true,
        "details": {
          "function_name": "HttpError",
          "container": "HttpError",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "160-170",
          "snippet": "HttpError::HttpError(unsigned errcode, const std::string& m)\n    : msg(httpErrorFormat(errcode, m))\n  {\n    std::ostringstream b;\n    HtmlEscOstream sb(b);\n\n    b << \"<html><body><h1>Error</h1><p>\";\n    sb << m;\n    b << \"</p></body></html>\";\n    body = b.str();\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpError {\n  HttpError::HttpError(unsigned errcode, const std::string& m)\n      : msg(httpErrorFormat(errcode, m))\n    {\n      std::ostringstream b;\n      HtmlEscOstream sb(b);\n  \n      b << \"<html><body><h1>Error</h1><p>\";\n      sb << m;\n      b << \"</p></body></html>\";\n      body = b.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.getHeader",
          "args": [
            "httpheader::contentLength"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "getHeader",
          "container": "Part",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/multipart.cpp",
          "lines": "112-118",
          "snippet": "std::string Part::getHeader(const std::string& key) const\n  {\n    Messageheader::const_iterator it = header.find(key);\n    if (it != header.end())\n      return it->second;\n    return std::string();\n  }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <streambuf>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/multipart.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <streambuf>\n#include <stdexcept>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httpheader.h>\n#include <tnt/multipart.h>\n\nPart {\n  std::string Part::getHeader(const std::string& key) const\n    {\n      Messageheader::const_iterator it = header.find(key);\n      if (it != header.end())\n        return it->second;\n      return std::string();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "headerParser.failed",
          "args": [],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "failed",
          "container": "Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/parser.h",
          "lines": "104-107",
          "snippet": "bool failed() const\n      {\n        return failedFlag;\n      }",
          "includes": [
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n\nParser {\n  bool failed() const\n        {\n          return failedFlag;\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "headerParser.parse",
          "args": [
            "ch"
          ],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "parse",
          "container": "CookieParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "206-472",
          "snippet": "void CookieParser::parse(const std::string& header)\n  {\n    // Cookie: $Version=\"1\"; Customer=\"WILE_E_COYOTE\"; $Path=\"/acme\"\n\n    enum state_type\n    {\n      state_0,\n      state_name,\n      state_eq,\n      state_value0,\n      state_value,\n      state_valueh1,\n      state_valueh2,\n      state_valuee,\n      state_qvalue,\n      state_qvalueh1,\n      state_qvalueh2,\n      state_qvaluee\n    };\n\n    state_type state = state_0;\n    char h = '\\0';\n\n    for (std::string::const_iterator it = header.begin();\n         it != header.end(); ++it)\n    {\n      char ch = *it;\n      switch(state)\n      {\n        case state_0:\n          if (ch == '$')\n          {\n            attr = true;\n            name.clear();\n            state = state_name;\n          }\n          else if (!std::isspace(ch))\n          {\n            attr = false;\n            name = ch;\n            state = state_name;\n          }\n          break;\n\n        case state_name:\n          if (std::isspace(ch))\n            state = (name == Cookie::secure ? state_valuee : state_eq);\n          else if (ch == '=')\n          {\n            if (name == Cookie::secure)\n              state = state_valuee;\n            else\n            {\n              value.clear();\n              value.reserve(32);\n              state = state_value0;\n            }\n          }\n          else if (ch == ';' && name == Cookie::secure)\n            state = state_valuee;\n          else\n            name += ch;\n          break;\n\n        case state_eq:\n          if (ch == '=')\n          {\n            value.clear();\n            value.reserve(32);\n            state = state_value0;\n          }\n          else if (!std::isspace(ch))\n          {\n            log_warn(\"invalid cookie: \" << header << \" - '=' expected\");\n            throwInvalidCookie(header);\n          }\n          break;\n\n        case state_value0:\n          if (ch == '\"')\n            state = state_qvalue;\n          else if (ch == '%')\n            state = state_valueh1;\n          else if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (!std::isspace(ch))\n          {\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_value:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '%')\n            state = state_valueh1;\n          else if (ch == '+')\n            value += ' ';\n          else\n            value += ch;\n          break;\n\n        case state_valueh1:\n          if (ishexdigit(ch))\n          {\n            h = ch;\n            state = state_valueh2;\n          }\n          else if (ch == ';')\n          {\n            value += '%';\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n          {\n            value += '%';\n            value += ' ';\n            state = state_value;\n          }\n          else\n          {\n            value += '%';\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_valueh2:\n          if (ishexdigit(ch))\n          {\n            value += hexvalue(h, ch);\n            state = state_value;\n          }\n          else if (ch == ';')\n          {\n            value += '%';\n            value += h;\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n          {\n            value += hexvalue(h);\n            value += ' ';\n            state = state_value;\n          }\n          else\n          {\n            value += hexvalue(h);\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_valuee:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n            value += ' ';\n          else if (std::isspace(ch))\n            state = state_valuee;\n          else\n          {\n            log_warn(\"invalid cookie: \" << header << \" - semicolon expected after value\");\n            throwInvalidCookie(header);\n          }\n          break;\n\n        case state_qvalue:\n          if (ch == '\"')\n            state = state_qvaluee;\n          else if (ch == '%')\n            state = state_qvalueh1;\n          else if (ch == '+')\n            value += ' ';\n          else\n            value += ch;\n          break;\n\n        case state_qvalueh1:\n          if (ishexdigit(ch))\n          {\n            h = ch;\n            state = state_qvalueh2;\n          }\n          else if (ch == '\"')\n          {\n            value += '%';\n            state = state_qvaluee;\n          }\n          else if (ch == '+')\n          {\n            value += '%';\n            value += ' ';\n            state = state_qvalue;\n          }\n          else\n          {\n            value += '%';\n            value += ch;\n            state = state_qvalue;\n          }\n          break;\n\n        case state_qvalueh2:\n          if (ishexdigit(ch))\n          {\n            value += hexvalue(h, ch);\n            state = state_qvalue;\n          }\n          else if (ch == '\"')\n          {\n            value += '%';\n            value += h;\n            state = state_qvaluee;\n          }\n          else if (ch == '+')\n          {\n            value += hexvalue(h);\n            value += ' ';\n            state = state_qvalue;\n          }\n          else\n          {\n            value += hexvalue(h);\n            value += ch;\n            state = state_qvalue;\n          }\n          break;\n\n        case state_qvaluee:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (!std::isspace(ch))\n          {\n            log_warn(\"invalid cookie: \" << header << \" - semicolon expected\");\n            throwInvalidCookie(header);\n          }\n          break;\n      }\n    }\n\n    if (state == state_qvaluee || state == state_value || state == state_value0)\n      process_nv();\n    else if (state != state_0)\n    {\n      log_warn(\"invalid cookie: \" << header << \" - invalid state \" << state);\n      throwInvalidCookie(header);\n    }\n\n    if (!current_cookie.value.empty())\n      store_cookie();\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  void CookieParser::parse(const std::string& header)\n    {\n      // Cookie: $Version=\"1\"; Customer=\"WILE_E_COYOTE\"; $Path=\"/acme\"\n  \n      enum state_type\n      {\n        state_0,\n        state_name,\n        state_eq,\n        state_value0,\n        state_value,\n        state_valueh1,\n        state_valueh2,\n        state_valuee,\n        state_qvalue,\n        state_qvalueh1,\n        state_qvalueh2,\n        state_qvaluee\n      };\n  \n      state_type state = state_0;\n      char h = '\\0';\n  \n      for (std::string::const_iterator it = header.begin();\n           it != header.end(); ++it)\n      {\n        char ch = *it;\n        switch(state)\n        {\n          case state_0:\n            if (ch == '$')\n            {\n              attr = true;\n              name.clear();\n              state = state_name;\n            }\n            else if (!std::isspace(ch))\n            {\n              attr = false;\n              name = ch;\n              state = state_name;\n            }\n            break;\n  \n          case state_name:\n            if (std::isspace(ch))\n              state = (name == Cookie::secure ? state_valuee : state_eq);\n            else if (ch == '=')\n            {\n              if (name == Cookie::secure)\n                state = state_valuee;\n              else\n              {\n                value.clear();\n                value.reserve(32);\n                state = state_value0;\n              }\n            }\n            else if (ch == ';' && name == Cookie::secure)\n              state = state_valuee;\n            else\n              name += ch;\n            break;\n  \n          case state_eq:\n            if (ch == '=')\n            {\n              value.clear();\n              value.reserve(32);\n              state = state_value0;\n            }\n            else if (!std::isspace(ch))\n            {\n              log_warn(\"invalid cookie: \" << header << \" - '=' expected\");\n              throwInvalidCookie(header);\n            }\n            break;\n  \n          case state_value0:\n            if (ch == '\"')\n              state = state_qvalue;\n            else if (ch == '%')\n              state = state_valueh1;\n            else if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (!std::isspace(ch))\n            {\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_value:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '%')\n              state = state_valueh1;\n            else if (ch == '+')\n              value += ' ';\n            else\n              value += ch;\n            break;\n  \n          case state_valueh1:\n            if (ishexdigit(ch))\n            {\n              h = ch;\n              state = state_valueh2;\n            }\n            else if (ch == ';')\n            {\n              value += '%';\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n            {\n              value += '%';\n              value += ' ';\n              state = state_value;\n            }\n            else\n            {\n              value += '%';\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_valueh2:\n            if (ishexdigit(ch))\n            {\n              value += hexvalue(h, ch);\n              state = state_value;\n            }\n            else if (ch == ';')\n            {\n              value += '%';\n              value += h;\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n            {\n              value += hexvalue(h);\n              value += ' ';\n              state = state_value;\n            }\n            else\n            {\n              value += hexvalue(h);\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_valuee:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n              value += ' ';\n            else if (std::isspace(ch))\n              state = state_valuee;\n            else\n            {\n              log_warn(\"invalid cookie: \" << header << \" - semicolon expected after value\");\n              throwInvalidCookie(header);\n            }\n            break;\n  \n          case state_qvalue:\n            if (ch == '\"')\n              state = state_qvaluee;\n            else if (ch == '%')\n              state = state_qvalueh1;\n            else if (ch == '+')\n              value += ' ';\n            else\n              value += ch;\n            break;\n  \n          case state_qvalueh1:\n            if (ishexdigit(ch))\n            {\n              h = ch;\n              state = state_qvalueh2;\n            }\n            else if (ch == '\"')\n            {\n              value += '%';\n              state = state_qvaluee;\n            }\n            else if (ch == '+')\n            {\n              value += '%';\n              value += ' ';\n              state = state_qvalue;\n            }\n            else\n            {\n              value += '%';\n              value += ch;\n              state = state_qvalue;\n            }\n            break;\n  \n          case state_qvalueh2:\n            if (ishexdigit(ch))\n            {\n              value += hexvalue(h, ch);\n              state = state_qvalue;\n            }\n            else if (ch == '\"')\n            {\n              value += '%';\n              value += h;\n              state = state_qvaluee;\n            }\n            else if (ch == '+')\n            {\n              value += hexvalue(h);\n              value += ' ';\n              state = state_qvalue;\n            }\n            else\n            {\n              value += hexvalue(h);\n              value += ch;\n              state = state_qvalue;\n            }\n            break;\n  \n          case state_qvaluee:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (!std::isspace(ch))\n            {\n              log_warn(\"invalid cookie: \" << header << \" - semicolon expected\");\n              throwInvalidCookie(header);\n            }\n            break;\n        }\n      }\n  \n      if (state == state_qvaluee || state == state_value || state == state_value0)\n        process_nv();\n      else if (state != state_0)\n      {\n        log_warn(\"invalid cookie: \" << header << \" - invalid state \" << state);\n        throwInvalidCookie(header);\n      }\n  \n      if (!current_cookie.value.empty())\n        store_cookie();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_header(char ch)\n      {\n        if (headerParser.parse(ch))\n        {\n          if (headerParser.failed())\n          {\n            httpCode = HTTP_BAD_REQUEST;\n            failedFlag = true;\n            return true;\n          }\n    \n          const char* content_length_header = message.getHeader(httpheader::contentLength);\n          if (*content_length_header)\n          {\n            bodySize = 0;\n            for (const char* c = content_length_header; *c; ++c)\n            {\n              if (*c > '9' || *c < '0')\n                throw HttpError(HTTP_BAD_REQUEST, \"invalid Content-Length\");\n              bodySize = bodySize * 10 + *c - '0';\n            }\n    \n            if (TntConfig::it().maxRequestSize > 0\n              && getCurrentRequestSize() + bodySize > TntConfig::it().maxRequestSize)\n            {\n              requestSizeExceeded();\n              return true;\n            }\n    \n            message.contentSize = bodySize;\n            if (bodySize == 0)\n              return true;\n            else\n            {\n              SET_STATE(state_body);\n              message.body.reserve(bodySize);\n              return false;\n            }\n          }\n    \n          return true;\n        }\n    \n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_end0",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "381-392",
    "snippet": "bool HttpRequest::Parser::state_end0(char ch)\n  {\n    if (ch == '\\n')\n      SET_STATE(state_header);\n    else if (ch != ' ' && ch != '\\t')\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in end\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in end\""
          ],
          "line": 387
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_header"
          ],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_end0(char ch)\n      {\n        if (ch == '\\n')\n          SET_STATE(state_header);\n        else if (ch != ' ' && ch != '\\t')\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in end\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_version_minor",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "364-379",
    "snippet": "bool HttpRequest::Parser::state_version_minor(char ch)\n  {\n    if (ch == '\\n')\n      SET_STATE(state_header);\n    else if (ch == ' ' || ch == '\\t' || ch == '\\r')\n      SET_STATE(state_end0);\n    else if (std::isdigit(ch))\n      message.setVersion(message.getMajorVersion(), message.getMinorVersion() * 10 + (ch - '0'));\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in version-minor\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in version-minor\""
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 374
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "message.setVersion",
          "args": [
            "message.getMajorVersion()",
            "message.getMinorVersion() * 10 + (ch - '0')"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "setVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "79-80",
          "snippet": "void setVersion(unsigned short major, unsigned short minor)\n        { majorVersion = major; minorVersion = minor; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  void setVersion(unsigned short major, unsigned short minor)\n          { majorVersion = major; minorVersion = minor; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.getMinorVersion",
          "args": [],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "getMinorVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "76-77",
          "snippet": "unsigned short getMinorVersion() const\n        { return minorVersion; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  unsigned short getMinorVersion() const\n          { return minorVersion; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.getMajorVersion",
          "args": [],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "getMajorVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "73-74",
          "snippet": "unsigned short getMajorVersion() const\n        { return majorVersion; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  unsigned short getMajorVersion() const\n          { return majorVersion; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::isdigit",
          "args": [
            "ch"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_end0"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_header"
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_version_minor(char ch)\n      {\n        if (ch == '\\n')\n          SET_STATE(state_header);\n        else if (ch == ' ' || ch == '\\t' || ch == '\\r')\n          SET_STATE(state_end0);\n        else if (std::isdigit(ch))\n          message.setVersion(message.getMajorVersion(), message.getMinorVersion() * 10 + (ch - '0'));\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in version-minor\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_version_minor0",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "358-362",
    "snippet": "bool HttpRequest::Parser::state_version_minor0(char ch)\n  {\n    return ch == ' ' || ch == '\\t' ? failedFlag\n                                   : state_version_minor(ch);\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "state_version_minor",
          "args": [
            "ch"
          ],
          "line": 361
        },
        "resolved": true,
        "details": {
          "function_name": "state_version_minor",
          "container": "HttpRequest::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "364-379",
          "snippet": "bool HttpRequest::Parser::state_version_minor(char ch)\n  {\n    if (ch == '\\n')\n      SET_STATE(state_header);\n    else if (ch == ' ' || ch == '\\t' || ch == '\\r')\n      SET_STATE(state_end0);\n    else if (std::isdigit(ch))\n      message.setVersion(message.getMajorVersion(), message.getMinorVersion() * 10 + (ch - '0'));\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in version-minor\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_version_minor(char ch)\n      {\n        if (ch == '\\n')\n          SET_STATE(state_header);\n        else if (ch == ' ' || ch == '\\t' || ch == '\\r')\n          SET_STATE(state_end0);\n        else if (std::isdigit(ch))\n          message.setVersion(message.getMajorVersion(), message.getMinorVersion() * 10 + (ch - '0'));\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in version-minor\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_version_minor0(char ch)\n      {\n        return ch == ' ' || ch == '\\t' ? failedFlag\n                                       : state_version_minor(ch);\n      }\n  }\n}"
  },
  {
    "function_name": "state_version_major_sp",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "345-356",
    "snippet": "bool HttpRequest::Parser::state_version_major_sp(char ch)\n  {\n    if (ch == '.')\n      SET_STATE(state_version_minor0);\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in version-major\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in version-major\""
          ],
          "line": 351
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_version_minor0"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_version_major_sp(char ch)\n      {\n        if (ch == '.')\n          SET_STATE(state_version_minor0);\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in version-major\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_version_major",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "328-343",
    "snippet": "bool HttpRequest::Parser::state_version_major(char ch)\n  {\n    if (ch == '.')\n      SET_STATE(state_version_minor0);\n    else if (std::isdigit(ch))\n      message.setVersion(message.getMajorVersion() * 10 + (ch - '0'), message.getMinorVersion());\n    else if (ch == ' ' || ch == '\\t')\n      SET_STATE(state_version_major_sp);\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in version-major\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in version-major\""
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_version_major_sp"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.setVersion",
          "args": [
            "message.getMajorVersion() * 10 + (ch - '0')",
            "message.getMinorVersion()"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "setVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "79-80",
          "snippet": "void setVersion(unsigned short major, unsigned short minor)\n        { majorVersion = major; minorVersion = minor; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  void setVersion(unsigned short major, unsigned short minor)\n          { majorVersion = major; minorVersion = minor; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.getMinorVersion",
          "args": [],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "getMinorVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "76-77",
          "snippet": "unsigned short getMinorVersion() const\n        { return minorVersion; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  unsigned short getMinorVersion() const\n          { return minorVersion; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.getMajorVersion",
          "args": [],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "getMajorVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "73-74",
          "snippet": "unsigned short getMajorVersion() const\n        { return majorVersion; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  unsigned short getMajorVersion() const\n          { return majorVersion; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::isdigit",
          "args": [
            "ch"
          ],
          "line": 332
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_version_minor0"
          ],
          "line": 331
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_version_major(char ch)\n      {\n        if (ch == '.')\n          SET_STATE(state_version_minor0);\n        else if (std::isdigit(ch))\n          message.setVersion(message.getMajorVersion() * 10 + (ch - '0'), message.getMinorVersion());\n        else if (ch == ' ' || ch == '\\t')\n          SET_STATE(state_version_major_sp);\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in version-major\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_version",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "312-326",
    "snippet": "bool HttpRequest::Parser::state_version(char ch)\n  {\n    if (ch == '/')\n    {\n      message.setVersion(0, 0);\n      skipWs(&Parser::state_version_major);\n    }\n    else if (ch == '\\r')\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in version\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in version\""
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 321
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "skipWs",
          "args": [
            "&Parser::state_version_major"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "skipWs",
          "container": "Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/parser.h",
          "lines": "66-70",
          "snippet": "void skipWs(state_type nextState_)\n      {\n        state = &Parser::state_skipws;\n        nextState = nextState_;\n      }",
          "includes": [
            "#include <iostream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iostream>\n\nParser {\n  void skipWs(state_type nextState_)\n        {\n          state = &Parser::state_skipws;\n          nextState = nextState_;\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message.setVersion",
          "args": [
            "0",
            "0"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "setVersion",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httpmessage.h",
          "lines": "79-80",
          "snippet": "void setVersion(unsigned short major, unsigned short minor)\n        { majorVersion = major; minorVersion = minor; }",
          "includes": [
            "#include <time.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <tnt/cookie.h>\n#include <tnt/httpheader.h>\n#include <tnt/messageheader.h>\n\nHttpMessage {\n  void setVersion(unsigned short major, unsigned short minor)\n          { majorVersion = major; minorVersion = minor; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_version(char ch)\n      {\n        if (ch == '/')\n        {\n          message.setVersion(0, 0);\n          skipWs(&Parser::state_version_major);\n        }\n        else if (ch == '\\r')\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in version\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_qparam",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "300-310",
    "snippet": "bool HttpRequest::Parser::state_qparam(char ch)\n  {\n    if (ch == ' ' || ch == '\\t')\n    {\n      log_debug(\"queryString=\" << message.queryString);\n      SET_STATE(state_version);\n    }\n    else\n      message.queryString += ch;\n    return false;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_version"
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"queryString=\" << message.queryString"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_qparam(char ch)\n      {\n        if (ch == ' ' || ch == '\\t')\n        {\n          log_debug(\"queryString=\" << message.queryString);\n          SET_STATE(state_version);\n        }\n        else\n          message.queryString += ch;\n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_urlesc",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "274-298",
    "snippet": "bool HttpRequest::Parser::state_urlesc(char ch)\n  {\n    if (isHexDigit(ch))\n    {\n      if (message.url.size() >= 2 && message.url[message.url.size() - 2] == '%')\n      {\n        unsigned v = (valueOfHexDigit(message.url[message.url.size() - 1]) << 4) | valueOfHexDigit(ch);\n        if (v == 0)\n          throw HttpError(HTTP_BAD_REQUEST, \"invalid value in url\");\n        message.url[message.url.size() - 2] = static_cast<char>(v);\n        message.url.resize(message.url.size() - 1);\n        SET_STATE(state_url);\n      }\n      else\n      {\n        message.url += ch;\n      }\n      return false;\n    }\n    else\n    {\n      SET_STATE(state_url);\n      return state_url(ch);\n    }\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "state_url",
          "args": [
            "ch"
          ],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "state_urlesc",
          "container": "HttpRequest::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "274-298",
          "snippet": "bool HttpRequest::Parser::state_urlesc(char ch)\n  {\n    if (isHexDigit(ch))\n    {\n      if (message.url.size() >= 2 && message.url[message.url.size() - 2] == '%')\n      {\n        unsigned v = (valueOfHexDigit(message.url[message.url.size() - 1]) << 4) | valueOfHexDigit(ch);\n        if (v == 0)\n          throw HttpError(HTTP_BAD_REQUEST, \"invalid value in url\");\n        message.url[message.url.size() - 2] = static_cast<char>(v);\n        message.url.resize(message.url.size() - 1);\n        SET_STATE(state_url);\n      }\n      else\n      {\n        message.url += ch;\n      }\n      return false;\n    }\n    else\n    {\n      SET_STATE(state_url);\n      return state_url(ch);\n    }\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_url"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_url"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.url.resize",
          "args": [
            "message.url.size() - 1"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.url.size",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<char>",
          "args": [
            "v"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HttpError",
          "args": [
            "HTTP_BAD_REQUEST",
            "\"invalid value in url\""
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "HttpError",
          "container": "HttpError",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "160-170",
          "snippet": "HttpError::HttpError(unsigned errcode, const std::string& m)\n    : msg(httpErrorFormat(errcode, m))\n  {\n    std::ostringstream b;\n    HtmlEscOstream sb(b);\n\n    b << \"<html><body><h1>Error</h1><p>\";\n    sb << m;\n    b << \"</p></body></html>\";\n    body = b.str();\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpError {\n  HttpError::HttpError(unsigned errcode, const std::string& m)\n      : msg(httpErrorFormat(errcode, m))\n    {\n      std::ostringstream b;\n      HtmlEscOstream sb(b);\n  \n      b << \"<html><body><h1>Error</h1><p>\";\n      sb << m;\n      b << \"</p></body></html>\";\n      body = b.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "valueOfHexDigit",
          "args": [
            "ch"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "valueOfHexDigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "66-72",
          "snippet": "inline unsigned valueOfHexDigit(char ch)\n    {\n      return ch >= '0' && ch <= '9' ? ch - '0'\n           : ch >= 'a' && ch <= 'z' ? ch - 'a' + 10\n           : ch >= 'A' && ch <= 'Z' ? ch - 'A' + 10\n           : 0;\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\ninline unsigned valueOfHexDigit(char ch)\n    {\n      return ch >= '0' && ch <= '9' ? ch - '0'\n           : ch >= 'a' && ch <= 'z' ? ch - 'a' + 10\n           : ch >= 'A' && ch <= 'Z' ? ch - 'A' + 10\n           : 0;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "isHexDigit",
          "args": [
            "ch"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "isHexDigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "59-64",
          "snippet": "inline bool isHexDigit(char ch)\n    {\n      return (ch >= '0' && ch <= '9')\n          || (ch >= 'A' && ch <= 'F')\n          || (ch >= 'a' && ch <= 'f');\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\ninline bool isHexDigit(char ch)\n    {\n      return (ch >= '0' && ch <= '9')\n          || (ch >= 'A' && ch <= 'F')\n          || (ch >= 'a' && ch <= 'f');\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_urlesc(char ch)\n      {\n        if (isHexDigit(ch))\n        {\n          if (message.url.size() >= 2 && message.url[message.url.size() - 2] == '%')\n          {\n            unsigned v = (valueOfHexDigit(message.url[message.url.size() - 1]) << 4) | valueOfHexDigit(ch);\n            if (v == 0)\n              throw HttpError(HTTP_BAD_REQUEST, \"invalid value in url\");\n            message.url[message.url.size() - 2] = static_cast<char>(v);\n            message.url.resize(message.url.size() - 1);\n            SET_STATE(state_url);\n          }\n          else\n          {\n            message.url += ch;\n          }\n          return false;\n        }\n        else\n        {\n          SET_STATE(state_url);\n          return state_url(ch);\n        }\n      }\n  }\n}"
  },
  {
    "function_name": "state_url",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "236-272",
    "snippet": "bool HttpRequest::Parser::state_url(char ch)\n  {\n    if (ch == '?')\n    {\n      log_debug(\"url=\" << message.url);\n      SET_STATE(state_qparam);\n    }\n    else if (ch == '\\r')\n    {\n      log_debug(\"url=\" << message.url);\n      SET_STATE(state_end0);\n    }\n    else if (ch == '\\n')\n    {\n      log_debug(\"url=\" << message.url);\n      SET_STATE(state_header);\n    }\n    else if (ch == ' ' || ch == '\\t')\n    {\n      log_debug(\"url=\" << message.url);\n      SET_STATE(state_version);\n    }\n    else if (ch == '%')\n    {\n      SET_STATE(state_urlesc);\n      message.url += ch;\n    }\n    else if (ch > ' ')\n      message.url += ch;\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in url\""
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_urlesc"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_version"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"url=\" << message.url"
          ],
          "line": 255
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_header"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"url=\" << message.url"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_end0"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"url=\" << message.url"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_qparam"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"url=\" << message.url"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_url(char ch)\n      {\n        if (ch == '?')\n        {\n          log_debug(\"url=\" << message.url);\n          SET_STATE(state_qparam);\n        }\n        else if (ch == '\\r')\n        {\n          log_debug(\"url=\" << message.url);\n          SET_STATE(state_end0);\n        }\n        else if (ch == '\\n')\n        {\n          log_debug(\"url=\" << message.url);\n          SET_STATE(state_header);\n        }\n        else if (ch == ' ' || ch == '\\t')\n        {\n          log_debug(\"url=\" << message.url);\n          SET_STATE(state_version);\n        }\n        else if (ch == '%')\n        {\n          SET_STATE(state_urlesc);\n          message.url += ch;\n        }\n        else if (ch > ' ')\n          message.url += ch;\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_protocol_host",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "212-234",
    "snippet": "bool HttpRequest::Parser::state_protocol_host(char ch)\n  {\n    if (ch == '/')\n    {\n      message.url.clear();\n      message.url.reserve(32);\n      message.url += ch;\n      SET_STATE(state_url);\n    }\n    else if (!std::isalpha(ch)\n           && !std::isdigit(ch)\n           && ch != '['\n           && ch != ']'\n           && ch != '.'\n           && ch != ':')\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in url\""
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "std::isdigit",
          "args": [
            "ch"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isalpha",
          "args": [
            "ch"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_url"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.url.reserve",
          "args": [
            "32"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.url.clear",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "168-220",
          "snippet": "void HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::clear()\n    {\n      HttpMessage::clear();\n      body.clear();\n      methodLen = 0;\n      method[0] = '\\0';\n      url.clear();\n      queryString.clear();\n      contentSize = 0;\n      pathinfo.clear();\n      args.clear();\n      getparam.clear();\n      postparam.clear();\n      qparam.clear();\n      ct = Contenttype();\n      mp = Multipart();\n      locale_init = false;\n      if (requestScope)\n      {\n        if (requestScope->release() == 0)\n          delete requestScope;\n        requestScope = 0;\n      }\n      httpcookies.clear();\n      encodingRead = false;\n      username.clear();\n      password.clear();\n  \n      releaseLocks();\n  \n      if (applicationScope)\n      {\n        if (applicationScope->release() == 0)\n          delete applicationScope;\n        applicationScope = 0;\n      }\n  \n      if (sessionScope)\n      {\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n        sessionScope = 0;\n      }\n  \n      if (secureSessionScope)\n      {\n        if (secureSessionScope->release() == 0)\n          delete secureSessionScope;\n        secureSessionScope = 0;\n      }\n  \n      threadContext = 0;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_protocol_host(char ch)\n      {\n        if (ch == '/')\n        {\n          message.url.clear();\n          message.url.reserve(32);\n          message.url += ch;\n          SET_STATE(state_url);\n        }\n        else if (!std::isalpha(ch)\n               && !std::isdigit(ch)\n               && ch != '['\n               && ch != ']'\n               && ch != '.'\n               && ch != ':')\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n    \n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_protocol_slash2",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "198-210",
    "snippet": "bool HttpRequest::Parser::state_protocol_slash2(char ch)\n  {\n    if (ch == '/')\n      SET_STATE(state_protocol_host);\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in url\""
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_protocol_host"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_protocol_slash2(char ch)\n      {\n        if (ch == '/')\n          SET_STATE(state_protocol_host);\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n    \n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_protocol_slash1",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "184-196",
    "snippet": "bool HttpRequest::Parser::state_protocol_slash1(char ch)\n  {\n    if (ch == '/')\n      SET_STATE(state_protocol_slash2);\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in url\""
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_protocol_slash2"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_protocol_slash1(char ch)\n      {\n        if (ch == '/')\n          SET_STATE(state_protocol_slash2);\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n    \n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_protocol",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "170-182",
    "snippet": "bool HttpRequest::Parser::state_protocol(char ch)\n  {\n    if (ch == ':')\n      SET_STATE(state_protocol_slash1);\n    else if (!std::isalpha(ch))\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in url\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "std::isalpha",
          "args": [
            "ch"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_protocol_slash1"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_protocol(char ch)\n      {\n        if (ch == ':')\n          SET_STATE(state_protocol_slash1);\n        else if (!std::isalpha(ch))\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n    \n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_url0",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "144-168",
    "snippet": "bool HttpRequest::Parser::state_url0(char ch)\n  {\n    if (ch == ' ' || ch == '\\t')\n    {\n    }\n    else if (ch == '/')\n    {\n      message.url.clear();\n      message.url.reserve(32);\n      message.url += ch;\n      SET_STATE(state_url);\n    }\n    else if (std::isalpha(ch))\n    {\n      SET_STATE(state_protocol);\n    }\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in url\""
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_protocol"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isalpha",
          "args": [
            "ch"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_url"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.url.reserve",
          "args": [
            "32"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.url.clear",
          "args": [],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "168-220",
          "snippet": "void HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::clear()\n    {\n      HttpMessage::clear();\n      body.clear();\n      methodLen = 0;\n      method[0] = '\\0';\n      url.clear();\n      queryString.clear();\n      contentSize = 0;\n      pathinfo.clear();\n      args.clear();\n      getparam.clear();\n      postparam.clear();\n      qparam.clear();\n      ct = Contenttype();\n      mp = Multipart();\n      locale_init = false;\n      if (requestScope)\n      {\n        if (requestScope->release() == 0)\n          delete requestScope;\n        requestScope = 0;\n      }\n      httpcookies.clear();\n      encodingRead = false;\n      username.clear();\n      password.clear();\n  \n      releaseLocks();\n  \n      if (applicationScope)\n      {\n        if (applicationScope->release() == 0)\n          delete applicationScope;\n        applicationScope = 0;\n      }\n  \n      if (sessionScope)\n      {\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n        sessionScope = 0;\n      }\n  \n      if (secureSessionScope)\n      {\n        if (secureSessionScope->release() == 0)\n          delete secureSessionScope;\n        secureSessionScope = 0;\n      }\n  \n      threadContext = 0;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_url0(char ch)\n      {\n        if (ch == ' ' || ch == '\\t')\n        {\n        }\n        else if (ch == '/')\n        {\n          message.url.clear();\n          message.url.reserve(32);\n          message.url += ch;\n          SET_STATE(state_url);\n        }\n        else if (std::isalpha(ch))\n        {\n          SET_STATE(state_protocol);\n        }\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in url\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n    \n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_cmd",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "118-142",
    "snippet": "bool HttpRequest::Parser::state_cmd(char ch)\n  {\n    if (istokenchar(ch))\n    {\n      if (message.methodLen >= sizeof(message.method) - 1)\n      {\n        log_debug(\"invalid method field; method=\" << std::string(message.method, message.methodLen) << \", len=\" << message.methodLen);\n        throw HttpError(HTTP_BAD_REQUEST, \"invalid method field\");\n      }\n      message.method[message.methodLen++] = ch;\n    }\n    else if (ch == ' ')\n    {\n      message.method[message.methodLen] = '\\0';\n      log_debug(\"method=\" << message.method);\n      SET_STATE(state_url0);\n    }\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in method\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in method\""
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_url0"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"method=\" << message.method"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HttpError",
          "args": [
            "HTTP_BAD_REQUEST",
            "\"invalid method field\""
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "HttpError",
          "container": "HttpError",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "160-170",
          "snippet": "HttpError::HttpError(unsigned errcode, const std::string& m)\n    : msg(httpErrorFormat(errcode, m))\n  {\n    std::ostringstream b;\n    HtmlEscOstream sb(b);\n\n    b << \"<html><body><h1>Error</h1><p>\";\n    sb << m;\n    b << \"</p></body></html>\";\n    body = b.str();\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpError {\n  HttpError::HttpError(unsigned errcode, const std::string& m)\n      : msg(httpErrorFormat(errcode, m))\n    {\n      std::ostringstream b;\n      HtmlEscOstream sb(b);\n  \n      b << \"<html><body><h1>Error</h1><p>\";\n      sb << m;\n      b << \"</p></body></html>\";\n      body = b.str();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"invalid method field; method=\" << std::string(message.method, message.methodLen) << \", len=\" << message.methodLen"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "message.method",
            "message.methodLen"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "istokenchar",
          "args": [
            "ch"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "istokenchar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "53-57",
          "snippet": "inline bool istokenchar(char ch)\n    {\n      static const char s[] = \"\\\"(),/:;<=>?@[\\\\]{}\";\n      return std::isalpha(ch) || std::binary_search(s, s + sizeof(s) - 1, ch);\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\ninline bool istokenchar(char ch)\n    {\n      static const char s[] = \"\\\"(),/:;<=>?@[\\\\]{}\";\n      return std::isalpha(ch) || std::binary_search(s, s + sizeof(s) - 1, ch);\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_cmd(char ch)\n      {\n        if (istokenchar(ch))\n        {\n          if (message.methodLen >= sizeof(message.method) - 1)\n          {\n            log_debug(\"invalid method field; method=\" << std::string(message.method, message.methodLen) << \", len=\" << message.methodLen);\n            throw HttpError(HTTP_BAD_REQUEST, \"invalid method field\");\n          }\n          message.method[message.methodLen++] = ch;\n        }\n        else if (ch == ' ')\n        {\n          message.method[message.methodLen] = '\\0';\n          log_debug(\"method=\" << message.method);\n          SET_STATE(state_url0);\n        }\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in method\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "state_cmd0",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "101-116",
    "snippet": "bool HttpRequest::Parser::state_cmd0(char ch)\n  {\n    if (istokenchar(ch))\n    {\n      message.method[0] = ch;\n      message.methodLen = 1;\n      SET_STATE(state_cmd);\n    }\n    else if (ch != ' ' && ch != '\\t')\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in method\");\n      httpCode = HTTP_BAD_REQUEST;\n      failedFlag = true;\n    }\n    return failedFlag;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in method\""
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "44-51",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_cmd"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "istokenchar",
          "args": [
            "ch"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "istokenchar",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "53-57",
          "snippet": "inline bool istokenchar(char ch)\n    {\n      static const char s[] = \"\\\"(),/:;<=>?@[\\\\]{}\";\n      return std::isalpha(ch) || std::binary_search(s, s + sizeof(s) - 1, ch);\n    }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\ninline bool istokenchar(char ch)\n    {\n      static const char s[] = \"\\\"(),/:;<=>?@[\\\\]{}\";\n      return std::isalpha(ch) || std::binary_search(s, s + sizeof(s) - 1, ch);\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    bool HttpRequest::Parser::state_cmd0(char ch)\n      {\n        if (istokenchar(ch))\n        {\n          message.method[0] = ch;\n          message.methodLen = 1;\n          SET_STATE(state_cmd);\n        }\n        else if (ch != ' ' && ch != '\\t')\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in method\");\n          httpCode = HTTP_BAD_REQUEST;\n          failedFlag = true;\n        }\n        return failedFlag;\n      }\n  }\n}"
  },
  {
    "function_name": "reset",
    "container": "HttpRequest::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "91-99",
    "snippet": "void HttpRequest::Parser::reset()\n  {\n    message.clear();\n    SET_STATE(state_cmd0);\n    httpCode = HTTP_OK;\n    failedFlag = false;\n    RequestSizeMonitor::reset();\n    headerParser.reset();\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "headerParser.reset",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "reset",
          "container": "HttpRequest::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "91-99",
          "snippet": "void HttpRequest::Parser::reset()\n  {\n    message.clear();\n    SET_STATE(state_cmd0);\n    httpCode = HTTP_OK;\n    failedFlag = false;\n    RequestSizeMonitor::reset();\n    headerParser.reset();\n  }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_cmd0"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "message.clear",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "168-220",
          "snippet": "void HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::clear()\n    {\n      HttpMessage::clear();\n      body.clear();\n      methodLen = 0;\n      method[0] = '\\0';\n      url.clear();\n      queryString.clear();\n      contentSize = 0;\n      pathinfo.clear();\n      args.clear();\n      getparam.clear();\n      postparam.clear();\n      qparam.clear();\n      ct = Contenttype();\n      mp = Multipart();\n      locale_init = false;\n      if (requestScope)\n      {\n        if (requestScope->release() == 0)\n          delete requestScope;\n        requestScope = 0;\n      }\n      httpcookies.clear();\n      encodingRead = false;\n      username.clear();\n      password.clear();\n  \n      releaseLocks();\n  \n      if (applicationScope)\n      {\n        if (applicationScope->release() == 0)\n          delete applicationScope;\n        applicationScope = 0;\n      }\n  \n      if (sessionScope)\n      {\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n        sessionScope = 0;\n      }\n  \n      if (secureSessionScope)\n      {\n        if (secureSessionScope->release() == 0)\n          delete secureSessionScope;\n        secureSessionScope = 0;\n      }\n  \n      threadContext = 0;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    void HttpRequest::Parser::reset()\n      {\n        message.clear();\n        SET_STATE(state_cmd0);\n        httpCode = HTTP_OK;\n        failedFlag = false;\n        RequestSizeMonitor::reset();\n        headerParser.reset();\n      }\n  }\n}"
  },
  {
    "function_name": "requestSizeExceeded",
    "container": "RequestSizeMonitor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "88-89",
    "snippet": "void RequestSizeMonitor::requestSizeExceeded()\n  { }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nRequestSizeMonitor {\n  void RequestSizeMonitor::requestSizeExceeded()\n    { }\n}"
  },
  {
    "function_name": "post",
    "container": "RequestSizeMonitor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "77-86",
    "snippet": "bool RequestSizeMonitor::post(bool ret)\n  {\n    if (++requestSize > TntConfig::it().maxRequestSize\n      && TntConfig::it().maxRequestSize > 0)\n    {\n      requestSizeExceeded();\n      return true;\n    }\n    return ret;\n  }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "requestSizeExceeded",
          "args": [],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "requestSizeExceeded",
          "container": "HttpRequest::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
          "lines": "446-451",
          "snippet": "void HttpRequest::Parser::requestSizeExceeded()\n  {\n    log_warn(\"max request size \" << TntConfig::it().maxRequestSize << \" exceeded\");\n    httpCode = HTTP_REQUEST_ENTITY_TOO_LARGE;\n    failedFlag = true;\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nHttpRequest {\n  Parser {\n    void HttpRequest::Parser::requestSizeExceeded()\n      {\n        log_warn(\"max request size \" << TntConfig::it().maxRequestSize << \" exceeded\");\n        httpCode = HTTP_REQUEST_ENTITY_TOO_LARGE;\n        failedFlag = true;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nRequestSizeMonitor {\n  bool RequestSizeMonitor::post(bool ret)\n    {\n      if (++requestSize > TntConfig::it().maxRequestSize\n        && TntConfig::it().maxRequestSize > 0)\n      {\n        requestSizeExceeded();\n        return true;\n      }\n      return ret;\n    }\n}"
  },
  {
    "function_name": "valueOfHexDigit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "66-72",
    "snippet": "inline unsigned valueOfHexDigit(char ch)\n    {\n      return ch >= '0' && ch <= '9' ? ch - '0'\n           : ch >= 'a' && ch <= 'z' ? ch - 'a' + 10\n           : ch >= 'A' && ch <= 'Z' ? ch - 'A' + 10\n           : 0;\n    }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\ninline unsigned valueOfHexDigit(char ch)\n    {\n      return ch >= '0' && ch <= '9' ? ch - '0'\n           : ch >= 'a' && ch <= 'z' ? ch - 'a' + 10\n           : ch >= 'A' && ch <= 'Z' ? ch - 'A' + 10\n           : 0;\n    }"
  },
  {
    "function_name": "isHexDigit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "59-64",
    "snippet": "inline bool isHexDigit(char ch)\n    {\n      return (ch >= '0' && ch <= '9')\n          || (ch >= 'A' && ch <= 'F')\n          || (ch >= 'a' && ch <= 'f');\n    }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\ninline bool isHexDigit(char ch)\n    {\n      return (ch >= '0' && ch <= '9')\n          || (ch >= 'A' && ch <= 'F')\n          || (ch >= 'a' && ch <= 'f');\n    }"
  },
  {
    "function_name": "istokenchar",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "53-57",
    "snippet": "inline bool istokenchar(char ch)\n    {\n      static const char s[] = \"\\\"(),/:;<=>?@[\\\\]{}\";\n      return std::isalpha(ch) || std::binary_search(s, s + sizeof(s) - 1, ch);\n    }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::binary_search",
          "args": [
            "s",
            "s + sizeof(s) - 1",
            "ch"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isalpha",
          "args": [
            "ch"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\ninline bool istokenchar(char ch)\n    {\n      static const char s[] = \"\\\"(),/:;<=>?@[\\\\]{}\";\n      return std::isalpha(ch) || std::binary_search(s, s + sizeof(s) - 1, ch);\n    }"
  },
  {
    "function_name": "chartoprint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpparser.cpp",
    "lines": "44-51",
    "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }",
    "includes": [
      "#include <algorithm>",
      "#include <sstream>",
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/httpheader.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/httpparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"'\\\\x\""
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "1",
            "'\\''"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isprint",
          "args": [
            "ch"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httpheader.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[(ch >> 4) & 0xf] + hex[ch & 0xf] + '\\'';\n    }"
  }
]