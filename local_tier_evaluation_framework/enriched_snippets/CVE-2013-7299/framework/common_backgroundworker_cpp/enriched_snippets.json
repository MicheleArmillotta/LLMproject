[
  {
    "function_name": "BackgroundWorker::removeTask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "179-190",
    "snippet": "void BackgroundWorker::removeTask(unsigned id)\n{\n    cxxtools::MutexLock lock(_mutex);\n    for (Tasks::iterator it = tasks.begin(); it != tasks.end(); )\n    {\n        if ((*it)->id() == id)\n        {\n            tasks.erase(it);\n            break;\n        }\n    }\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tasks.erase",
          "args": [
            "it"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tasks.end",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tasks.begin",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nvoid BackgroundWorker::removeTask(unsigned id)\n{\n    cxxtools::MutexLock lock(_mutex);\n    for (Tasks::iterator it = tasks.begin(); it != tasks.end(); )\n    {\n        if ((*it)->id() == id)\n        {\n            tasks.erase(it);\n            break;\n        }\n    }\n}"
  },
  {
    "function_name": "BackgroundWorker::getTask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "165-177",
    "snippet": "BackgroundTask::Pointer BackgroundWorker::getTask(unsigned id) const\n{\n    cxxtools::MutexLock lock(_mutex);\n    for (Tasks::const_iterator it = tasks.begin(); it != tasks.end(); ++it)\n    {\n        if ((*it)->id() == id)\n        {\n            BackgroundTask::Pointer ret = *it;\n            return ret;\n        }\n    }\n    return 0;\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tasks.end",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tasks.begin",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nBackgroundTask::Pointer BackgroundWorker::getTask(unsigned id) const\n{\n    cxxtools::MutexLock lock(_mutex);\n    for (Tasks::const_iterator it = tasks.begin(); it != tasks.end(); ++it)\n    {\n        if ((*it)->id() == id)\n        {\n            BackgroundTask::Pointer ret = *it;\n            return ret;\n        }\n    }\n    return 0;\n}"
  },
  {
    "function_name": "BackgroundWorker::runTask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "156-163",
    "snippet": "unsigned BackgroundWorker::runTask(BackgroundTask::Pointer task)\n{\n    cxxtools::MutexLock lock(_mutex);\n    task->_jobReady = &_jobReady;\n    tasks.push_back(task);\n    _threadPool.schedule(cxxtools::callable(*task.getPointer(), &BackgroundTask::doTask));\n    return task->id();\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "task->id",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "id",
          "container": "BackgroundTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/backgroundworker.h",
          "lines": "59-60",
          "snippet": "unsigned id() const\n              { return _id; }",
          "includes": [
            "#include <list>",
            "#include <cxxtools/clock.h>",
            "#include <cxxtools/timespan.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/condition.h>",
            "#include <cxxtools/threadpool.h>",
            "#include <cxxtools/smartptr.h>",
            "#include <cxxtools/refcounted.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <cxxtools/clock.h>\n#include <cxxtools/timespan.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <cxxtools/threadpool.h>\n#include <cxxtools/smartptr.h>\n#include <cxxtools/refcounted.h>\n\nBackgroundTask {\n  unsigned id() const\n                { return _id; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_threadPool.schedule",
          "args": [
            "cxxtools::callable(*task.getPointer(), &BackgroundTask::doTask)"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::callable",
          "args": [
            "*task.getPointer()",
            "&BackgroundTask::doTask"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "task.getPointer",
          "args": [],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tasks.push_back",
          "args": [
            "task"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nunsigned BackgroundWorker::runTask(BackgroundTask::Pointer task)\n{\n    cxxtools::MutexLock lock(_mutex);\n    task->_jobReady = &_jobReady;\n    tasks.push_back(task);\n    _threadPool.schedule(cxxtools::callable(*task.getPointer(), &BackgroundTask::doTask));\n    return task->id();\n}"
  },
  {
    "function_name": "BackgroundTask::livetime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "148-154",
    "snippet": "void BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _livetime = livetime;\n    if (_progress >= 100)\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::Clock::getSystemTime",
          "args": [],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nvoid BackgroundTask::livetime(const cxxtools::Timespan& livetime)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _livetime = livetime;\n    if (_progress >= 100)\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n}"
  },
  {
    "function_name": "BackgroundTask::updateProgress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "136-146",
    "snippet": "void BackgroundTask::updateProgress(unsigned p)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _progress = p;\n    if (_progress >= 100)\n    {\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n        log_debug(\"signal job ready\");\n        _jobReady->signal();\n    }\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_jobReady->signal",
          "args": [],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"signal job ready\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::Clock::getSystemTime",
          "args": [],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nvoid BackgroundTask::updateProgress(unsigned p)\n{\n    cxxtools::MutexLock lock(_mutex);\n    _progress = p;\n    if (_progress >= 100)\n    {\n        _timeoutTime = cxxtools::Clock::getSystemTime() + _livetime;\n        log_debug(\"signal job ready\");\n        _jobReady->signal();\n    }\n}"
  },
  {
    "function_name": "BackgroundTask::doTask",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "125-134",
    "snippet": "void BackgroundTask::doTask()\n{\n    log_debug(\"job id \" << id() << \" started\");\n    execute();\n\n    if (progress() < 100)\n        updateProgress(100);\n\n    log_debug(\"job id \" << id() << \" finished\");\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"job id \" << id() << \" finished\""
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "id",
          "args": [],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "id",
          "container": "BackgroundTask",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/backgroundworker.h",
          "lines": "59-60",
          "snippet": "unsigned id() const\n              { return _id; }",
          "includes": [
            "#include <list>",
            "#include <cxxtools/clock.h>",
            "#include <cxxtools/timespan.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/condition.h>",
            "#include <cxxtools/threadpool.h>",
            "#include <cxxtools/smartptr.h>",
            "#include <cxxtools/refcounted.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <cxxtools/clock.h>\n#include <cxxtools/timespan.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/condition.h>\n#include <cxxtools/threadpool.h>\n#include <cxxtools/smartptr.h>\n#include <cxxtools/refcounted.h>\n\nBackgroundTask {\n  unsigned id() const\n                { return _id; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "updateProgress",
          "args": [
            "100"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "progress",
          "args": [],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "execute",
          "args": [],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"job id \" << id() << \" started\""
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nvoid BackgroundTask::doTask()\n{\n    log_debug(\"job id \" << id() << \" started\");\n    execute();\n\n    if (progress() < 100)\n        updateProgress(100);\n\n    log_debug(\"job id \" << id() << \" finished\");\n}"
  },
  {
    "function_name": "BackgroundTask::progress",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "119-123",
    "snippet": "unsigned BackgroundTask::progress() const\n{\n    cxxtools::MutexLock lock(_mutex);\n    return _progress;\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nunsigned BackgroundTask::progress() const\n{\n    cxxtools::MutexLock lock(_mutex);\n    return _progress;\n}"
  },
  {
    "function_name": "BackgroundWorker::timeoutCheckerFunc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "78-117",
    "snippet": "void BackgroundWorker::timeoutCheckerFunc()\n{\n    while (_running)\n    {\n        cxxtools::MutexLock lock(_mutex);\n\n        if (!_running)\n            break;\n\n        cxxtools::DateTime current = cxxtools::Clock::getSystemTime();\n        cxxtools::DateTime nextTimeout = current + cxxtools::Timespan(3600, 0);\n\n        for (Tasks::iterator it = tasks.begin(); it != tasks.end(); )\n        {\n            // check if timed out\n            bool ready = (*it)->ready();\n\n            if (ready && current >= (*it)->timeoutTime())\n            {\n                log_info(\"timeout reached for job \" << (*it)->id());\n                it = tasks.erase(it);\n            }\n            else\n            {\n                // check for next timeout\n                if (ready\n                    && (*it)->timeoutTime() < nextTimeout)\n                {\n                    nextTimeout = (*it)->timeoutTime();\n                }\n\n                ++it;\n            }\n        }\n\n        _jobReady.wait(_mutex, (nextTimeout - current).totalMSecs());\n    }\n\n    log_debug(\"timeoutCheckerFunc end\");\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"timeoutCheckerFunc end\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_jobReady.wait",
          "args": [
            "_mutex",
            "(nextTimeout - current).totalMSecs()"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tasks.erase",
          "args": [
            "it"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"timeout reached for job \" << (*it)->id()"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tasks.end",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tasks.begin",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cxxtools::Timespan",
          "args": [
            "3600",
            "0"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::Clock::getSystemTime",
          "args": [],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nvoid BackgroundWorker::timeoutCheckerFunc()\n{\n    while (_running)\n    {\n        cxxtools::MutexLock lock(_mutex);\n\n        if (!_running)\n            break;\n\n        cxxtools::DateTime current = cxxtools::Clock::getSystemTime();\n        cxxtools::DateTime nextTimeout = current + cxxtools::Timespan(3600, 0);\n\n        for (Tasks::iterator it = tasks.begin(); it != tasks.end(); )\n        {\n            // check if timed out\n            bool ready = (*it)->ready();\n\n            if (ready && current >= (*it)->timeoutTime())\n            {\n                log_info(\"timeout reached for job \" << (*it)->id());\n                it = tasks.erase(it);\n            }\n            else\n            {\n                // check for next timeout\n                if (ready\n                    && (*it)->timeoutTime() < nextTimeout)\n                {\n                    nextTimeout = (*it)->timeoutTime();\n                }\n\n                ++it;\n            }\n        }\n\n        _jobReady.wait(_mutex, (nextTimeout - current).totalMSecs());\n    }\n\n    log_debug(\"timeoutCheckerFunc end\");\n}"
  },
  {
    "function_name": "BackgroundWorker::~BackgroundWorker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "66-76",
    "snippet": "BackgroundWorker::~BackgroundWorker()\n{\n    _running = false;\n    cxxtools::MutexLock lock(_mutex);\n    _jobReady.signal();\n    lock.unlock();\n\n    log_info(\"wait for background jobs to finish\");\n    _threadPool.stop(true);\n    log_info(\"background jobs finished\");\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"background jobs finished\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_threadPool.stop",
          "args": [
            "true"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"wait for background jobs to finish\""
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lock.unlock",
          "args": [],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "unlock",
          "container": "ApplicationUnlocker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/applicationunlocker.h",
          "lines": "62-66",
          "snippet": "void unlock()\n      {\n        request.releaseApplicationScopeLock();\n        locked = false;\n      }",
          "includes": [
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/httprequest.h>\n\nApplicationUnlocker {\n  void unlock()\n        {\n          request.releaseApplicationScopeLock();\n          locked = false;\n        }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_jobReady.signal",
          "args": [],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nBackgroundWorker::~BackgroundWorker()\n{\n    _running = false;\n    cxxtools::MutexLock lock(_mutex);\n    _jobReady.signal();\n    lock.unlock();\n\n    log_info(\"wait for background jobs to finish\");\n    _threadPool.stop(true);\n    log_info(\"background jobs finished\");\n}"
  },
  {
    "function_name": "BackgroundWorker::BackgroundWorker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/backgroundworker.cpp",
    "lines": "59-64",
    "snippet": "BackgroundWorker::BackgroundWorker()\n    : _threadPool(TntConfig::it().backgroundTasks + 1),\n      _running(true)\n{\n    _threadPool.schedule(cxxtools::callable(*this, &BackgroundWorker::timeoutCheckerFunc));\n}",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <tnt/tntconfig.h>",
      "#include <tnt/backgroundworker.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_threadPool.schedule",
          "args": [
            "cxxtools::callable(*this, &BackgroundWorker::timeoutCheckerFunc)"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::callable",
          "args": [
            "*this",
            "&BackgroundWorker::timeoutCheckerFunc"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/backgroundworker.h>\n\nBackgroundWorker::BackgroundWorker()\n    : _threadPool(TntConfig::it().backgroundTasks + 1),\n      _running(true)\n{\n    _threadPool.schedule(cxxtools::callable(*this, &BackgroundWorker::timeoutCheckerFunc));\n}"
  }
]