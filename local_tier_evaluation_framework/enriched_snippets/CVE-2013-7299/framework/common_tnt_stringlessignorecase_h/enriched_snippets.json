[
  {
    "function_name": "StringCompareIgnoreCase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/stringlessignorecase.h",
    "lines": "66-69",
    "snippet": "inline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }",
    "includes": [
      "#include <cctype>",
      "#include <functional>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "StringCompareIgnoreCase<std::string>",
          "args": [
            "s1",
            "s2"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "StringCompareIgnoreCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/stringlessignorecase.h",
          "lines": "66-69",
          "snippet": "inline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <cctype>\n#include <functional>\n#include <string>\n\ninline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }"
  },
  {
    "function_name": "StringCompareIgnoreCase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/stringlessignorecase.h",
    "lines": "40-61",
    "snippet": "int StringCompareIgnoreCase(const stringType& s1, const stringType& s2)\n  {\n    typename stringType::const_iterator it1 = s1.begin();\n    typename stringType::const_iterator it2 = s2.begin();\n    while (it1 != s1.end() && it2 != s2.end())\n    {\n        if (*it1 != *it2)\n        {\n            char c1 = std::toupper(*it1);\n            char c2 = std::toupper(*it2);\n            if (c1 < c2)\n                return -1;\n            else if (c2 < c1)\n                return 1;\n        }\n        ++it1;\n        ++it2;\n    }\n\n    return it1 == s1.end() ? (it2 != s2.end()) ? -1 : 0\n                           : 1;\n  }",
    "includes": [
      "#include <cctype>",
      "#include <functional>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "s2.end",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::toupper",
          "args": [
            "*it2"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::toupper",
          "args": [
            "*it1"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s2.begin",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cctype>\n#include <functional>\n#include <string>\n\nint StringCompareIgnoreCase(const stringType& s1, const stringType& s2)\n  {\n    typename stringType::const_iterator it1 = s1.begin();\n    typename stringType::const_iterator it2 = s2.begin();\n    while (it1 != s1.end() && it2 != s2.end())\n    {\n        if (*it1 != *it2)\n        {\n            char c1 = std::toupper(*it1);\n            char c2 = std::toupper(*it2);\n            if (c1 < c2)\n                return -1;\n            else if (c2 < c1)\n                return 1;\n        }\n        ++it1;\n        ++it2;\n    }\n\n    return it1 == s1.end() ? (it2 != s2.end()) ? -1 : 0\n                           : 1;\n  }"
  }
]