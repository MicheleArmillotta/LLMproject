[
  {
    "function_name": "write",
    "container": "Cookie",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "474-491",
    "snippet": "void Cookie::write(std::ostream& out, const std::string& name) const\n  {\n    // print name (Customer=\"WILE_E_COYOTE\")\n    out << name << '=';\n    UrlEscOstream u(out);\n    u << getValue();\n\n    // print secure-attribute\n    if (secureFlag)\n      out << \"; \" << Cookie::secure;\n\n    // print attributes\n    for (Cookie::attrs_type::const_iterator a = attrs.begin();\n         a != attrs.end(); ++a)\n      out << \"; \" << a->first << '=' << a->second;\n    if (attrs.find(Cookie::version) == attrs.end())\n      out << \";Version=1\";\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "attrs.end",
          "args": [],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "attrs.find",
          "args": [
            "Cookie::version"
          ],
          "line": 489
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "attrs.begin",
          "args": [],
          "line": 486
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getValue",
          "args": [],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookie {\n  void Cookie::write(std::ostream& out, const std::string& name) const\n    {\n      // print name (Customer=\"WILE_E_COYOTE\")\n      out << name << '=';\n      UrlEscOstream u(out);\n      u << getValue();\n  \n      // print secure-attribute\n      if (secureFlag)\n        out << \"; \" << Cookie::secure;\n  \n      // print attributes\n      for (Cookie::attrs_type::const_iterator a = attrs.begin();\n           a != attrs.end(); ++a)\n        out << \"; \" << a->first << '=' << a->second;\n      if (attrs.find(Cookie::version) == attrs.end())\n        out << \";Version=1\";\n    }\n}"
  },
  {
    "function_name": "parse",
    "container": "CookieParser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "206-472",
    "snippet": "void CookieParser::parse(const std::string& header)\n  {\n    // Cookie: $Version=\"1\"; Customer=\"WILE_E_COYOTE\"; $Path=\"/acme\"\n\n    enum state_type\n    {\n      state_0,\n      state_name,\n      state_eq,\n      state_value0,\n      state_value,\n      state_valueh1,\n      state_valueh2,\n      state_valuee,\n      state_qvalue,\n      state_qvalueh1,\n      state_qvalueh2,\n      state_qvaluee\n    };\n\n    state_type state = state_0;\n    char h = '\\0';\n\n    for (std::string::const_iterator it = header.begin();\n         it != header.end(); ++it)\n    {\n      char ch = *it;\n      switch(state)\n      {\n        case state_0:\n          if (ch == '$')\n          {\n            attr = true;\n            name.clear();\n            state = state_name;\n          }\n          else if (!std::isspace(ch))\n          {\n            attr = false;\n            name = ch;\n            state = state_name;\n          }\n          break;\n\n        case state_name:\n          if (std::isspace(ch))\n            state = (name == Cookie::secure ? state_valuee : state_eq);\n          else if (ch == '=')\n          {\n            if (name == Cookie::secure)\n              state = state_valuee;\n            else\n            {\n              value.clear();\n              value.reserve(32);\n              state = state_value0;\n            }\n          }\n          else if (ch == ';' && name == Cookie::secure)\n            state = state_valuee;\n          else\n            name += ch;\n          break;\n\n        case state_eq:\n          if (ch == '=')\n          {\n            value.clear();\n            value.reserve(32);\n            state = state_value0;\n          }\n          else if (!std::isspace(ch))\n          {\n            log_warn(\"invalid cookie: \" << header << \" - '=' expected\");\n            throwInvalidCookie(header);\n          }\n          break;\n\n        case state_value0:\n          if (ch == '\"')\n            state = state_qvalue;\n          else if (ch == '%')\n            state = state_valueh1;\n          else if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (!std::isspace(ch))\n          {\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_value:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '%')\n            state = state_valueh1;\n          else if (ch == '+')\n            value += ' ';\n          else\n            value += ch;\n          break;\n\n        case state_valueh1:\n          if (ishexdigit(ch))\n          {\n            h = ch;\n            state = state_valueh2;\n          }\n          else if (ch == ';')\n          {\n            value += '%';\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n          {\n            value += '%';\n            value += ' ';\n            state = state_value;\n          }\n          else\n          {\n            value += '%';\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_valueh2:\n          if (ishexdigit(ch))\n          {\n            value += hexvalue(h, ch);\n            state = state_value;\n          }\n          else if (ch == ';')\n          {\n            value += '%';\n            value += h;\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n          {\n            value += hexvalue(h);\n            value += ' ';\n            state = state_value;\n          }\n          else\n          {\n            value += hexvalue(h);\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_valuee:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n            value += ' ';\n          else if (std::isspace(ch))\n            state = state_valuee;\n          else\n          {\n            log_warn(\"invalid cookie: \" << header << \" - semicolon expected after value\");\n            throwInvalidCookie(header);\n          }\n          break;\n\n        case state_qvalue:\n          if (ch == '\"')\n            state = state_qvaluee;\n          else if (ch == '%')\n            state = state_qvalueh1;\n          else if (ch == '+')\n            value += ' ';\n          else\n            value += ch;\n          break;\n\n        case state_qvalueh1:\n          if (ishexdigit(ch))\n          {\n            h = ch;\n            state = state_qvalueh2;\n          }\n          else if (ch == '\"')\n          {\n            value += '%';\n            state = state_qvaluee;\n          }\n          else if (ch == '+')\n          {\n            value += '%';\n            value += ' ';\n            state = state_qvalue;\n          }\n          else\n          {\n            value += '%';\n            value += ch;\n            state = state_qvalue;\n          }\n          break;\n\n        case state_qvalueh2:\n          if (ishexdigit(ch))\n          {\n            value += hexvalue(h, ch);\n            state = state_qvalue;\n          }\n          else if (ch == '\"')\n          {\n            value += '%';\n            value += h;\n            state = state_qvaluee;\n          }\n          else if (ch == '+')\n          {\n            value += hexvalue(h);\n            value += ' ';\n            state = state_qvalue;\n          }\n          else\n          {\n            value += hexvalue(h);\n            value += ch;\n            state = state_qvalue;\n          }\n          break;\n\n        case state_qvaluee:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (!std::isspace(ch))\n          {\n            log_warn(\"invalid cookie: \" << header << \" - semicolon expected\");\n            throwInvalidCookie(header);\n          }\n          break;\n      }\n    }\n\n    if (state == state_qvaluee || state == state_value || state == state_value0)\n      process_nv();\n    else if (state != state_0)\n    {\n      log_warn(\"invalid cookie: \" << header << \" - invalid state \" << state);\n      throwInvalidCookie(header);\n    }\n\n    if (!current_cookie.value.empty())\n      store_cookie();\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "store_cookie",
          "args": [],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "store_cookie",
          "container": "CookieParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "159-164",
          "snippet": "void CookieParser::store_cookie()\n  {\n    if (!mycookies.hasCookie(current_cookie_name))\n      mycookies.setCookie(current_cookie_name, current_cookie);\n    current_cookie.value.clear();\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  void CookieParser::store_cookie()\n    {\n      if (!mycookies.hasCookie(current_cookie_name))\n        mycookies.setCookie(current_cookie_name, current_cookie);\n      current_cookie.value.clear();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cookie.value.empty",
          "args": [],
          "line": 470
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "throwInvalidCookie",
          "args": [
            "header"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "throwInvalidCookie",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "200-203",
          "snippet": "void throwInvalidCookie(const std::string& cookie)\n    {\n      throw HttpError(HTTP_BAD_REQUEST, \"invalid cookie: \" + cookie);\n    }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nvoid throwInvalidCookie(const std::string& cookie)\n    {\n      throw HttpError(HTTP_BAD_REQUEST, \"invalid cookie: \" + cookie);\n    }"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid cookie: \" << header << \" - invalid state \" << state"
          ],
          "line": 466
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "process_nv",
          "args": [],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "process_nv",
          "container": "CookieParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "166-196",
          "snippet": "void CookieParser::process_nv()\n  {\n    if (attr)\n    {\n      if (name == Cookie::secure)\n      {\n        log_debug(\"attribute: secure\");\n        current_cookie.secureFlag = true;\n      }\n      else\n      {\n        log_debug(\"attribute: \" << name << '=' << value);\n        current_attrs->insert(\n          Cookie::attrs_type::value_type(name, value));\n      }\n    }\n    else\n    {\n      if (!current_cookie_name.empty())\n        store_cookie();\n\n      log_debug(\"Cookie: \" << name << '=' << value);\n\n      current_cookie_name = name;\n      current_cookie.value = value;\n      current_cookie.secureFlag = false;\n      name.clear();\n      current_attrs = &current_cookie.attrs;\n      current_cookie.attrs = common_attrs;\n    }\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  void CookieParser::process_nv()\n    {\n      if (attr)\n      {\n        if (name == Cookie::secure)\n        {\n          log_debug(\"attribute: secure\");\n          current_cookie.secureFlag = true;\n        }\n        else\n        {\n          log_debug(\"attribute: \" << name << '=' << value);\n          current_attrs->insert(\n            Cookie::attrs_type::value_type(name, value));\n        }\n      }\n      else\n      {\n        if (!current_cookie_name.empty())\n          store_cookie();\n  \n        log_debug(\"Cookie: \" << name << '=' << value);\n  \n        current_cookie_name = name;\n        current_cookie.value = value;\n        current_cookie.secureFlag = false;\n        name.clear();\n        current_attrs = &current_cookie.attrs;\n        current_cookie.attrs = common_attrs;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid cookie: \" << header << \" - semicolon expected\""
          ],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hexvalue",
          "args": [
            "h"
          ],
          "line": 441
        },
        "resolved": true,
        "details": {
          "function_name": "hexvalue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "54-64",
          "snippet": "char hexvalue(char ch)\n    {\n      if (ch >= '0' && ch <= '9')\n        return ch - '0';\n      else if (ch >= 'A' && ch <= 'F')\n        return ch - 'A' + 10;\n      else if (ch >= 'a' && ch <= 'f')\n        return ch - 'a' + 10;\n      else\n        return '\\0';\n    }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nchar hexvalue(char ch)\n    {\n      if (ch >= '0' && ch <= '9')\n        return ch - '0';\n      else if (ch >= 'A' && ch <= 'F')\n        return ch - 'A' + 10;\n      else if (ch >= 'a' && ch <= 'f')\n        return ch - 'a' + 10;\n      else\n        return '\\0';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "ishexdigit",
          "args": [
            "ch"
          ],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "ishexdigit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "47-52",
          "snippet": "bool ishexdigit(char ch)\n    {\n      return (ch >= '0' && ch <= '9')\n          || (ch >= 'a' && ch <= 'f')\n          || (ch >= 'A' && ch <= 'F');\n    }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nbool ishexdigit(char ch)\n    {\n      return (ch >= '0' && ch <= '9')\n          || (ch >= 'a' && ch <= 'f')\n          || (ch >= 'A' && ch <= 'F');\n    }"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid cookie: \" << header << \" - semicolon expected after value\""
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 376
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid cookie: \" << header << \" - '=' expected\""
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.reserve",
          "args": [
            "32"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.clear",
          "args": [],
          "line": 273
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Cookies",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "137-137",
          "snippet": "void clear()  { data.clear(); }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookies {\n  void clear()  { data.clear(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.reserve",
          "args": [
            "32"
          ],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "header.end",
          "args": [],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "header.begin",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  void CookieParser::parse(const std::string& header)\n    {\n      // Cookie: $Version=\"1\"; Customer=\"WILE_E_COYOTE\"; $Path=\"/acme\"\n  \n      enum state_type\n      {\n        state_0,\n        state_name,\n        state_eq,\n        state_value0,\n        state_value,\n        state_valueh1,\n        state_valueh2,\n        state_valuee,\n        state_qvalue,\n        state_qvalueh1,\n        state_qvalueh2,\n        state_qvaluee\n      };\n  \n      state_type state = state_0;\n      char h = '\\0';\n  \n      for (std::string::const_iterator it = header.begin();\n           it != header.end(); ++it)\n      {\n        char ch = *it;\n        switch(state)\n        {\n          case state_0:\n            if (ch == '$')\n            {\n              attr = true;\n              name.clear();\n              state = state_name;\n            }\n            else if (!std::isspace(ch))\n            {\n              attr = false;\n              name = ch;\n              state = state_name;\n            }\n            break;\n  \n          case state_name:\n            if (std::isspace(ch))\n              state = (name == Cookie::secure ? state_valuee : state_eq);\n            else if (ch == '=')\n            {\n              if (name == Cookie::secure)\n                state = state_valuee;\n              else\n              {\n                value.clear();\n                value.reserve(32);\n                state = state_value0;\n              }\n            }\n            else if (ch == ';' && name == Cookie::secure)\n              state = state_valuee;\n            else\n              name += ch;\n            break;\n  \n          case state_eq:\n            if (ch == '=')\n            {\n              value.clear();\n              value.reserve(32);\n              state = state_value0;\n            }\n            else if (!std::isspace(ch))\n            {\n              log_warn(\"invalid cookie: \" << header << \" - '=' expected\");\n              throwInvalidCookie(header);\n            }\n            break;\n  \n          case state_value0:\n            if (ch == '\"')\n              state = state_qvalue;\n            else if (ch == '%')\n              state = state_valueh1;\n            else if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (!std::isspace(ch))\n            {\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_value:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '%')\n              state = state_valueh1;\n            else if (ch == '+')\n              value += ' ';\n            else\n              value += ch;\n            break;\n  \n          case state_valueh1:\n            if (ishexdigit(ch))\n            {\n              h = ch;\n              state = state_valueh2;\n            }\n            else if (ch == ';')\n            {\n              value += '%';\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n            {\n              value += '%';\n              value += ' ';\n              state = state_value;\n            }\n            else\n            {\n              value += '%';\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_valueh2:\n            if (ishexdigit(ch))\n            {\n              value += hexvalue(h, ch);\n              state = state_value;\n            }\n            else if (ch == ';')\n            {\n              value += '%';\n              value += h;\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n            {\n              value += hexvalue(h);\n              value += ' ';\n              state = state_value;\n            }\n            else\n            {\n              value += hexvalue(h);\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_valuee:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n              value += ' ';\n            else if (std::isspace(ch))\n              state = state_valuee;\n            else\n            {\n              log_warn(\"invalid cookie: \" << header << \" - semicolon expected after value\");\n              throwInvalidCookie(header);\n            }\n            break;\n  \n          case state_qvalue:\n            if (ch == '\"')\n              state = state_qvaluee;\n            else if (ch == '%')\n              state = state_qvalueh1;\n            else if (ch == '+')\n              value += ' ';\n            else\n              value += ch;\n            break;\n  \n          case state_qvalueh1:\n            if (ishexdigit(ch))\n            {\n              h = ch;\n              state = state_qvalueh2;\n            }\n            else if (ch == '\"')\n            {\n              value += '%';\n              state = state_qvaluee;\n            }\n            else if (ch == '+')\n            {\n              value += '%';\n              value += ' ';\n              state = state_qvalue;\n            }\n            else\n            {\n              value += '%';\n              value += ch;\n              state = state_qvalue;\n            }\n            break;\n  \n          case state_qvalueh2:\n            if (ishexdigit(ch))\n            {\n              value += hexvalue(h, ch);\n              state = state_qvalue;\n            }\n            else if (ch == '\"')\n            {\n              value += '%';\n              value += h;\n              state = state_qvaluee;\n            }\n            else if (ch == '+')\n            {\n              value += hexvalue(h);\n              value += ' ';\n              state = state_qvalue;\n            }\n            else\n            {\n              value += hexvalue(h);\n              value += ch;\n              state = state_qvalue;\n            }\n            break;\n  \n          case state_qvaluee:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (!std::isspace(ch))\n            {\n              log_warn(\"invalid cookie: \" << header << \" - semicolon expected\");\n              throwInvalidCookie(header);\n            }\n            break;\n        }\n      }\n  \n      if (state == state_qvaluee || state == state_value || state == state_value0)\n        process_nv();\n      else if (state != state_0)\n      {\n        log_warn(\"invalid cookie: \" << header << \" - invalid state \" << state);\n        throwInvalidCookie(header);\n      }\n  \n      if (!current_cookie.value.empty())\n        store_cookie();\n    }\n}"
  },
  {
    "function_name": "throwInvalidCookie",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "200-203",
    "snippet": "void throwInvalidCookie(const std::string& cookie)\n    {\n      throw HttpError(HTTP_BAD_REQUEST, \"invalid cookie: \" + cookie);\n    }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HttpError",
          "args": [
            "HTTP_BAD_REQUEST",
            "\"invalid cookie: \" + cookie"
          ],
          "line": 202
        },
        "resolved": true,
        "details": {
          "function_name": "HttpError",
          "container": "HttpError",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "160-170",
          "snippet": "HttpError::HttpError(unsigned errcode, const std::string& m)\n    : msg(httpErrorFormat(errcode, m))\n  {\n    std::ostringstream b;\n    HtmlEscOstream sb(b);\n\n    b << \"<html><body><h1>Error</h1><p>\";\n    sb << m;\n    b << \"</p></body></html>\";\n    body = b.str();\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpError {\n  HttpError::HttpError(unsigned errcode, const std::string& m)\n      : msg(httpErrorFormat(errcode, m))\n    {\n      std::ostringstream b;\n      HtmlEscOstream sb(b);\n  \n      b << \"<html><body><h1>Error</h1><p>\";\n      sb << m;\n      b << \"</p></body></html>\";\n      body = b.str();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nvoid throwInvalidCookie(const std::string& cookie)\n    {\n      throw HttpError(HTTP_BAD_REQUEST, \"invalid cookie: \" + cookie);\n    }"
  },
  {
    "function_name": "process_nv",
    "container": "CookieParser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "166-196",
    "snippet": "void CookieParser::process_nv()\n  {\n    if (attr)\n    {\n      if (name == Cookie::secure)\n      {\n        log_debug(\"attribute: secure\");\n        current_cookie.secureFlag = true;\n      }\n      else\n      {\n        log_debug(\"attribute: \" << name << '=' << value);\n        current_attrs->insert(\n          Cookie::attrs_type::value_type(name, value));\n      }\n    }\n    else\n    {\n      if (!current_cookie_name.empty())\n        store_cookie();\n\n      log_debug(\"Cookie: \" << name << '=' << value);\n\n      current_cookie_name = name;\n      current_cookie.value = value;\n      current_cookie.secureFlag = false;\n      name.clear();\n      current_attrs = &current_cookie.attrs;\n      current_cookie.attrs = common_attrs;\n    }\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "name.clear",
          "args": [],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Cookies",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "137-137",
          "snippet": "void clear()  { data.clear(); }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookies {\n  void clear()  { data.clear(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"Cookie: \" << name << '=' << value"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "store_cookie",
          "args": [],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "store_cookie",
          "container": "CookieParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "159-164",
          "snippet": "void CookieParser::store_cookie()\n  {\n    if (!mycookies.hasCookie(current_cookie_name))\n      mycookies.setCookie(current_cookie_name, current_cookie);\n    current_cookie.value.clear();\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  void CookieParser::store_cookie()\n    {\n      if (!mycookies.hasCookie(current_cookie_name))\n        mycookies.setCookie(current_cookie_name, current_cookie);\n      current_cookie.value.clear();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_cookie_name.empty",
          "args": [],
          "line": 184
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "current_attrs->insert",
          "args": [
            "Cookie::attrs_type::value_type(name, value)"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Cookie::attrs_type::value_type",
          "args": [
            "name",
            "value"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"attribute: \" << name << '=' << value"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"attribute: secure\""
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  void CookieParser::process_nv()\n    {\n      if (attr)\n      {\n        if (name == Cookie::secure)\n        {\n          log_debug(\"attribute: secure\");\n          current_cookie.secureFlag = true;\n        }\n        else\n        {\n          log_debug(\"attribute: \" << name << '=' << value);\n          current_attrs->insert(\n            Cookie::attrs_type::value_type(name, value));\n        }\n      }\n      else\n      {\n        if (!current_cookie_name.empty())\n          store_cookie();\n  \n        log_debug(\"Cookie: \" << name << '=' << value);\n  \n        current_cookie_name = name;\n        current_cookie.value = value;\n        current_cookie.secureFlag = false;\n        name.clear();\n        current_attrs = &current_cookie.attrs;\n        current_cookie.attrs = common_attrs;\n      }\n    }\n}"
  },
  {
    "function_name": "store_cookie",
    "container": "CookieParser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "159-164",
    "snippet": "void CookieParser::store_cookie()\n  {\n    if (!mycookies.hasCookie(current_cookie_name))\n      mycookies.setCookie(current_cookie_name, current_cookie);\n    current_cookie.value.clear();\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current_cookie.value.clear",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "Cookies",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "137-137",
          "snippet": "void clear()  { data.clear(); }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookies {\n  void clear()  { data.clear(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mycookies.setCookie",
          "args": [
            "current_cookie_name",
            "current_cookie"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "setCookie",
          "container": "Cookies",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "145-146",
          "snippet": "void setCookie(const std::string& name, const Cookie& value_)\n        { data[name] = value_; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookies {\n  void setCookie(const std::string& name, const Cookie& value_)\n          { data[name] = value_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mycookies.hasCookie",
          "args": [
            "current_cookie_name"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "hasCookie",
          "container": "Cookies",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "151-152",
          "snippet": "bool hasCookie(const std::string& name) const\n        { return data.find(name) != data.end(); }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookies {\n  bool hasCookie(const std::string& name) const\n          { return data.find(name) != data.end(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  void CookieParser::store_cookie()\n    {\n      if (!mycookies.hasCookie(current_cookie_name))\n        mycookies.setCookie(current_cookie_name, current_cookie);\n      current_cookie.value.clear();\n    }\n}"
  },
  {
    "function_name": "set",
    "container": "Cookies",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "153-157",
    "snippet": "void Cookies::set(const std::string& header)\n  {\n    CookieParser parser(*this);\n    parser.parse(header);\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parser.parse",
          "args": [
            "header"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "parse",
          "container": "CookieParser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "206-472",
          "snippet": "void CookieParser::parse(const std::string& header)\n  {\n    // Cookie: $Version=\"1\"; Customer=\"WILE_E_COYOTE\"; $Path=\"/acme\"\n\n    enum state_type\n    {\n      state_0,\n      state_name,\n      state_eq,\n      state_value0,\n      state_value,\n      state_valueh1,\n      state_valueh2,\n      state_valuee,\n      state_qvalue,\n      state_qvalueh1,\n      state_qvalueh2,\n      state_qvaluee\n    };\n\n    state_type state = state_0;\n    char h = '\\0';\n\n    for (std::string::const_iterator it = header.begin();\n         it != header.end(); ++it)\n    {\n      char ch = *it;\n      switch(state)\n      {\n        case state_0:\n          if (ch == '$')\n          {\n            attr = true;\n            name.clear();\n            state = state_name;\n          }\n          else if (!std::isspace(ch))\n          {\n            attr = false;\n            name = ch;\n            state = state_name;\n          }\n          break;\n\n        case state_name:\n          if (std::isspace(ch))\n            state = (name == Cookie::secure ? state_valuee : state_eq);\n          else if (ch == '=')\n          {\n            if (name == Cookie::secure)\n              state = state_valuee;\n            else\n            {\n              value.clear();\n              value.reserve(32);\n              state = state_value0;\n            }\n          }\n          else if (ch == ';' && name == Cookie::secure)\n            state = state_valuee;\n          else\n            name += ch;\n          break;\n\n        case state_eq:\n          if (ch == '=')\n          {\n            value.clear();\n            value.reserve(32);\n            state = state_value0;\n          }\n          else if (!std::isspace(ch))\n          {\n            log_warn(\"invalid cookie: \" << header << \" - '=' expected\");\n            throwInvalidCookie(header);\n          }\n          break;\n\n        case state_value0:\n          if (ch == '\"')\n            state = state_qvalue;\n          else if (ch == '%')\n            state = state_valueh1;\n          else if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (!std::isspace(ch))\n          {\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_value:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '%')\n            state = state_valueh1;\n          else if (ch == '+')\n            value += ' ';\n          else\n            value += ch;\n          break;\n\n        case state_valueh1:\n          if (ishexdigit(ch))\n          {\n            h = ch;\n            state = state_valueh2;\n          }\n          else if (ch == ';')\n          {\n            value += '%';\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n          {\n            value += '%';\n            value += ' ';\n            state = state_value;\n          }\n          else\n          {\n            value += '%';\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_valueh2:\n          if (ishexdigit(ch))\n          {\n            value += hexvalue(h, ch);\n            state = state_value;\n          }\n          else if (ch == ';')\n          {\n            value += '%';\n            value += h;\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n          {\n            value += hexvalue(h);\n            value += ' ';\n            state = state_value;\n          }\n          else\n          {\n            value += hexvalue(h);\n            value += ch;\n            state = state_value;\n          }\n          break;\n\n        case state_valuee:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (ch == '+')\n            value += ' ';\n          else if (std::isspace(ch))\n            state = state_valuee;\n          else\n          {\n            log_warn(\"invalid cookie: \" << header << \" - semicolon expected after value\");\n            throwInvalidCookie(header);\n          }\n          break;\n\n        case state_qvalue:\n          if (ch == '\"')\n            state = state_qvaluee;\n          else if (ch == '%')\n            state = state_qvalueh1;\n          else if (ch == '+')\n            value += ' ';\n          else\n            value += ch;\n          break;\n\n        case state_qvalueh1:\n          if (ishexdigit(ch))\n          {\n            h = ch;\n            state = state_qvalueh2;\n          }\n          else if (ch == '\"')\n          {\n            value += '%';\n            state = state_qvaluee;\n          }\n          else if (ch == '+')\n          {\n            value += '%';\n            value += ' ';\n            state = state_qvalue;\n          }\n          else\n          {\n            value += '%';\n            value += ch;\n            state = state_qvalue;\n          }\n          break;\n\n        case state_qvalueh2:\n          if (ishexdigit(ch))\n          {\n            value += hexvalue(h, ch);\n            state = state_qvalue;\n          }\n          else if (ch == '\"')\n          {\n            value += '%';\n            value += h;\n            state = state_qvaluee;\n          }\n          else if (ch == '+')\n          {\n            value += hexvalue(h);\n            value += ' ';\n            state = state_qvalue;\n          }\n          else\n          {\n            value += hexvalue(h);\n            value += ch;\n            state = state_qvalue;\n          }\n          break;\n\n        case state_qvaluee:\n          if (ch == ';')\n          {\n            process_nv();\n            state = state_0;\n          }\n          else if (!std::isspace(ch))\n          {\n            log_warn(\"invalid cookie: \" << header << \" - semicolon expected\");\n            throwInvalidCookie(header);\n          }\n          break;\n      }\n    }\n\n    if (state == state_qvaluee || state == state_value || state == state_value0)\n      process_nv();\n    else if (state != state_0)\n    {\n      log_warn(\"invalid cookie: \" << header << \" - invalid state \" << state);\n      throwInvalidCookie(header);\n    }\n\n    if (!current_cookie.value.empty())\n      store_cookie();\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/httpmessage.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/cookie.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  void CookieParser::parse(const std::string& header)\n    {\n      // Cookie: $Version=\"1\"; Customer=\"WILE_E_COYOTE\"; $Path=\"/acme\"\n  \n      enum state_type\n      {\n        state_0,\n        state_name,\n        state_eq,\n        state_value0,\n        state_value,\n        state_valueh1,\n        state_valueh2,\n        state_valuee,\n        state_qvalue,\n        state_qvalueh1,\n        state_qvalueh2,\n        state_qvaluee\n      };\n  \n      state_type state = state_0;\n      char h = '\\0';\n  \n      for (std::string::const_iterator it = header.begin();\n           it != header.end(); ++it)\n      {\n        char ch = *it;\n        switch(state)\n        {\n          case state_0:\n            if (ch == '$')\n            {\n              attr = true;\n              name.clear();\n              state = state_name;\n            }\n            else if (!std::isspace(ch))\n            {\n              attr = false;\n              name = ch;\n              state = state_name;\n            }\n            break;\n  \n          case state_name:\n            if (std::isspace(ch))\n              state = (name == Cookie::secure ? state_valuee : state_eq);\n            else if (ch == '=')\n            {\n              if (name == Cookie::secure)\n                state = state_valuee;\n              else\n              {\n                value.clear();\n                value.reserve(32);\n                state = state_value0;\n              }\n            }\n            else if (ch == ';' && name == Cookie::secure)\n              state = state_valuee;\n            else\n              name += ch;\n            break;\n  \n          case state_eq:\n            if (ch == '=')\n            {\n              value.clear();\n              value.reserve(32);\n              state = state_value0;\n            }\n            else if (!std::isspace(ch))\n            {\n              log_warn(\"invalid cookie: \" << header << \" - '=' expected\");\n              throwInvalidCookie(header);\n            }\n            break;\n  \n          case state_value0:\n            if (ch == '\"')\n              state = state_qvalue;\n            else if (ch == '%')\n              state = state_valueh1;\n            else if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (!std::isspace(ch))\n            {\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_value:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '%')\n              state = state_valueh1;\n            else if (ch == '+')\n              value += ' ';\n            else\n              value += ch;\n            break;\n  \n          case state_valueh1:\n            if (ishexdigit(ch))\n            {\n              h = ch;\n              state = state_valueh2;\n            }\n            else if (ch == ';')\n            {\n              value += '%';\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n            {\n              value += '%';\n              value += ' ';\n              state = state_value;\n            }\n            else\n            {\n              value += '%';\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_valueh2:\n            if (ishexdigit(ch))\n            {\n              value += hexvalue(h, ch);\n              state = state_value;\n            }\n            else if (ch == ';')\n            {\n              value += '%';\n              value += h;\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n            {\n              value += hexvalue(h);\n              value += ' ';\n              state = state_value;\n            }\n            else\n            {\n              value += hexvalue(h);\n              value += ch;\n              state = state_value;\n            }\n            break;\n  \n          case state_valuee:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (ch == '+')\n              value += ' ';\n            else if (std::isspace(ch))\n              state = state_valuee;\n            else\n            {\n              log_warn(\"invalid cookie: \" << header << \" - semicolon expected after value\");\n              throwInvalidCookie(header);\n            }\n            break;\n  \n          case state_qvalue:\n            if (ch == '\"')\n              state = state_qvaluee;\n            else if (ch == '%')\n              state = state_qvalueh1;\n            else if (ch == '+')\n              value += ' ';\n            else\n              value += ch;\n            break;\n  \n          case state_qvalueh1:\n            if (ishexdigit(ch))\n            {\n              h = ch;\n              state = state_qvalueh2;\n            }\n            else if (ch == '\"')\n            {\n              value += '%';\n              state = state_qvaluee;\n            }\n            else if (ch == '+')\n            {\n              value += '%';\n              value += ' ';\n              state = state_qvalue;\n            }\n            else\n            {\n              value += '%';\n              value += ch;\n              state = state_qvalue;\n            }\n            break;\n  \n          case state_qvalueh2:\n            if (ishexdigit(ch))\n            {\n              value += hexvalue(h, ch);\n              state = state_qvalue;\n            }\n            else if (ch == '\"')\n            {\n              value += '%';\n              value += h;\n              state = state_qvaluee;\n            }\n            else if (ch == '+')\n            {\n              value += hexvalue(h);\n              value += ' ';\n              state = state_qvalue;\n            }\n            else\n            {\n              value += hexvalue(h);\n              value += ch;\n              state = state_qvalue;\n            }\n            break;\n  \n          case state_qvaluee:\n            if (ch == ';')\n            {\n              process_nv();\n              state = state_0;\n            }\n            else if (!std::isspace(ch))\n            {\n              log_warn(\"invalid cookie: \" << header << \" - semicolon expected\");\n              throwInvalidCookie(header);\n            }\n            break;\n        }\n      }\n  \n      if (state == state_qvaluee || state == state_value || state == state_value0)\n        process_nv();\n      else if (state != state_0)\n      {\n        log_warn(\"invalid cookie: \" << header << \" - invalid state \" << state);\n        throwInvalidCookie(header);\n      }\n  \n      if (!current_cookie.value.empty())\n        store_cookie();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookies {\n  void Cookies::set(const std::string& header)\n    {\n      CookieParser parser(*this);\n      parser.parse(header);\n    }\n}"
  },
  {
    "function_name": "CookieParser",
    "container": "CookieParser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "145-148",
    "snippet": "CookieParser(Cookies& c)\n        : current_attrs(&common_attrs),\n          mycookies(c)\n        { }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookieParser {\n  CookieParser(Cookies& c)\n          : current_attrs(&common_attrs),\n            mycookies(c)\n          { }\n}"
  },
  {
    "function_name": "clearCookie",
    "container": "Cookies",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "120-125",
    "snippet": "void Cookies::clearCookie(const std::string& name, const Cookie& c)\n  {\n    Cookie cc(c);\n    cc.setAttr(Cookie::maxAge, \"0\");\n    setCookie(name, cc);\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setCookie",
          "args": [
            "name",
            "cc"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "setCookie",
          "container": "Cookies",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "145-146",
          "snippet": "void setCookie(const std::string& name, const Cookie& value_)\n        { data[name] = value_; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookies {\n  void setCookie(const std::string& name, const Cookie& value_)\n          { data[name] = value_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "cc.setAttr",
          "args": [
            "Cookie::maxAge",
            "\"0\""
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "setAttr",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "95-96",
          "snippet": "void setAttr(const std::string& name, const std::string& value_)\n        { attrs[name] = value_; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  void setAttr(const std::string& name, const std::string& value_)\n          { attrs[name] = value_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookies {\n  void Cookies::clearCookie(const std::string& name, const Cookie& c)\n    {\n      Cookie cc(c);\n      cc.setAttr(Cookie::maxAge, \"0\");\n      setCookie(name, cc);\n    }\n}"
  },
  {
    "function_name": "clearCookie",
    "container": "Cookies",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "103-118",
    "snippet": "void Cookies::clearCookie(const std::string& name)\n  {\n    cookies_type::iterator it = data.find(name);\n    if (it != data.end())\n    {\n      it->second.setAttr(Cookie::maxAge, \"0\");\n      it->second.setAttr(Cookie::expires, HttpMessage::htdate(static_cast<time_t>(0)));\n    }\n    else\n    {\n      Cookie c;\n      c.setAttr(Cookie::maxAge, \"0\");\n      c.setAttr(Cookie::expires, HttpMessage::htdate(static_cast<time_t>(0)));\n      setCookie(name, c);\n    }\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setCookie",
          "args": [
            "name",
            "c"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "setCookie",
          "container": "Cookies",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "145-146",
          "snippet": "void setCookie(const std::string& name, const Cookie& value_)\n        { data[name] = value_; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookies {\n  void setCookie(const std::string& name, const Cookie& value_)\n          { data[name] = value_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.setAttr",
          "args": [
            "Cookie::expires",
            "HttpMessage::htdate(static_cast<time_t>(0))"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "setAttr",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "95-96",
          "snippet": "void setAttr(const std::string& name, const std::string& value_)\n        { attrs[name] = value_; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  void setAttr(const std::string& name, const std::string& value_)\n          { attrs[name] = value_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "HttpMessage::htdate",
          "args": [
            "static_cast<time_t>(0)"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "htdate",
          "container": "HttpMessage",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "76-87",
          "snippet": "std::string HttpMessage::htdate(struct ::tm* tm)\n  {\n    static const char* wday[] = {\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"};\n    static const char* monthn[] = {\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                            \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"};\n    char buffer[80];\n\n    sprintf(buffer, \"%s, %02d %s %d %02d:%02d:%02d GMT\",\n      wday[tm->tm_wday], tm->tm_mday, monthn[tm->tm_mon], tm->tm_year + 1900,\n      tm->tm_hour, tm->tm_min, tm->tm_sec);\n    return buffer;\n  }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nHttpMessage {\n  std::string HttpMessage::htdate(struct ::tm* tm)\n    {\n      static const char* wday[] = {\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"};\n      static const char* monthn[] = {\"Jan\", \"Feb\", \"Mar\", \"Apr\", \"May\", \"Jun\",\n                              \"Jul\", \"Aug\", \"Sep\", \"Oct\", \"Nov\", \"Dec\"};\n      char buffer[80];\n  \n      sprintf(buffer, \"%s, %02d %s %d %02d:%02d:%02d GMT\",\n        wday[tm->tm_wday], tm->tm_mday, monthn[tm->tm_mon], tm->tm_year + 1900,\n        tm->tm_hour, tm->tm_min, tm->tm_sec);\n      return buffer;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<time_t>",
          "args": [
            "0"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<time_t>",
          "args": [
            "0"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.end",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.find",
          "args": [
            "name"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader {\n  Messageheader::const_iterator Messageheader::find(const char* key) const\n    {\n      for (const_iterator it = begin(); it != end(); ++it)\n      {\n        if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n          return it;\n      }\n  \n      return end();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookies {\n  void Cookies::clearCookie(const std::string& name)\n    {\n      cookies_type::iterator it = data.find(name);\n      if (it != data.end())\n      {\n        it->second.setAttr(Cookie::maxAge, \"0\");\n        it->second.setAttr(Cookie::expires, HttpMessage::htdate(static_cast<time_t>(0)));\n      }\n      else\n      {\n        Cookie c;\n        c.setAttr(Cookie::maxAge, \"0\");\n        c.setAttr(Cookie::expires, HttpMessage::htdate(static_cast<time_t>(0)));\n        setCookie(name, c);\n      }\n    }\n}"
  },
  {
    "function_name": "setMaxAge",
    "container": "Cookie",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "96-101",
    "snippet": "void Cookie::setMaxAge(unsigned v)\n  {\n    std::ostringstream s;\n    s << v;\n    setAttr(maxAge, s.str());\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setAttr",
          "args": [
            "maxAge",
            "s.str()"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "setAttr",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "95-96",
          "snippet": "void setAttr(const std::string& name, const std::string& value_)\n        { attrs[name] = value_; }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  void setAttr(const std::string& name, const std::string& value_)\n          { attrs[name] = value_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.str",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookie {\n  void Cookie::setMaxAge(unsigned v)\n    {\n      std::ostringstream s;\n      s << v;\n      setAttr(maxAge, s.str());\n    }\n}"
  },
  {
    "function_name": "getMaxAge",
    "container": "Cookie",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "82-94",
    "snippet": "unsigned Cookie::getMaxAge() const\n  {\n    std::string a = getAttr(maxAge);\n    if (!a.empty())\n    {\n      std::istringstream s(a);\n      unsigned ret;\n      s >> ret;\n      if (s)\n        return ret;\n    }\n    return 0;\n  }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a.empty",
          "args": [],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Part",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/multipart.h",
          "lines": "113-113",
          "snippet": "bool empty() const            { return isEmpty(); }",
          "includes": [
            "#include <iterator>",
            "#include <vector>",
            "#include <tnt/contentdisposition.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iterator>\n#include <vector>\n#include <tnt/contentdisposition.h>\n#include <tnt/messageheader.h>\n\nPart {\n  bool empty() const            { return isEmpty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getAttr",
          "args": [
            "maxAge"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "getAttr",
          "container": "Cookie",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/cookie.h",
          "lines": "87-91",
          "snippet": "std::string getAttr(const std::string& name) const\n      {\n        attrs_type::const_iterator it = attrs.find(name);\n        return it == attrs.end() ? std::string() : it->second;\n      }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <iosfwd>",
            "#include <map>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <iosfwd>\n#include <map>\n#include <string>\n\nCookie {\n  std::string getAttr(const std::string& name) const\n        {\n          attrs_type::const_iterator it = attrs.find(name);\n          return it == attrs.end() ? std::string() : it->second;\n        }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nCookie {\n  unsigned Cookie::getMaxAge() const\n    {\n      std::string a = getAttr(maxAge);\n      if (!a.empty())\n      {\n        std::istringstream s(a);\n        unsigned ret;\n        s >> ret;\n        if (s)\n          return ret;\n      }\n      return 0;\n    }\n}"
  },
  {
    "function_name": "hexvalue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "66-69",
    "snippet": "char hexvalue(char upper, char lower)\n    {\n      return (hexvalue(upper) << 4) + hexvalue(lower);\n    }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hexvalue",
          "args": [
            "lower"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "hexvalue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
          "lines": "54-64",
          "snippet": "char hexvalue(char ch)\n    {\n      if (ch >= '0' && ch <= '9')\n        return ch - '0';\n      else if (ch >= 'A' && ch <= 'F')\n        return ch - 'A' + 10;\n      else if (ch >= 'a' && ch <= 'f')\n        return ch - 'a' + 10;\n      else\n        return '\\0';\n    }",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nchar hexvalue(char upper, char lower)\n    {\n      return (hexvalue(upper) << 4) + hexvalue(lower);\n    }"
  },
  {
    "function_name": "hexvalue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "54-64",
    "snippet": "char hexvalue(char ch)\n    {\n      if (ch >= '0' && ch <= '9')\n        return ch - '0';\n      else if (ch >= 'A' && ch <= 'F')\n        return ch - 'A' + 10;\n      else if (ch >= 'a' && ch <= 'f')\n        return ch - 'a' + 10;\n      else\n        return '\\0';\n    }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nchar hexvalue(char ch)\n    {\n      if (ch >= '0' && ch <= '9')\n        return ch - '0';\n      else if (ch >= 'A' && ch <= 'F')\n        return ch - 'A' + 10;\n      else if (ch >= 'a' && ch <= 'f')\n        return ch - 'a' + 10;\n      else\n        return '\\0';\n    }"
  },
  {
    "function_name": "ishexdigit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cookie.cpp",
    "lines": "47-52",
    "snippet": "bool ishexdigit(char ch)\n    {\n      return (ch >= '0' && ch <= '9')\n          || (ch >= 'a' && ch <= 'f')\n          || (ch >= 'A' && ch <= 'F');\n    }",
    "includes": [
      "#include <stdexcept>",
      "#include <sstream>",
      "#include <iostream>",
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/urlescostream.h>",
      "#include <tnt/httpmessage.h>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/cookie.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <stdexcept>\n#include <sstream>\n#include <iostream>\n#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/urlescostream.h>\n#include <tnt/httpmessage.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/cookie.h>\n\nbool ishexdigit(char ch)\n    {\n      return (ch >= '0' && ch <= '9')\n          || (ch >= 'a' && ch <= 'f')\n          || (ch >= 'A' && ch <= 'F');\n    }"
  }
]