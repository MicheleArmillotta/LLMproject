[
  {
    "function_name": "Cmd::call",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cmd.cpp",
    "lines": "39-56",
    "snippet": "void Cmd::call(const Compident& ci, const QueryParams& queryParams)\n  {\n    HttpRequest request(application, &socketIf);\n    request.setQueryParams(queryParams);\n\n    // set thread context for thread scope\n    request.setThreadContext(&threadContext);\n\n    // sets session and application scope\n    scopeManager.preCall(request, ci.libname);\n    scopeManager.setSessionId(request, sessionId);\n\n    // fetch and call the component\n    comploader.fetchComp(ci)(request, reply, request.getQueryParams());\n\n    // sets session cookie if needed\n    sessionId = scopeManager.postCall(request, reply, application.getAppName());\n  }",
    "includes": [
      "#include <tnt/cmd.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scopeManager.postCall",
          "args": [
            "request",
            "reply",
            "application.getAppName()"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "application.getAppName",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "comploader.fetchComp",
          "args": [
            "request",
            "reply",
            "request.getQueryParams()"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.getQueryParams",
          "args": [],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "comploader.fetchComp",
          "args": [
            "ci"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scopeManager.setSessionId",
          "args": [
            "request",
            "sessionId"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "scopeManager.preCall",
          "args": [
            "request",
            "ci.libname"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request.setThreadContext",
          "args": [
            "&threadContext"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "setThreadContext",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "229-229",
          "snippet": "void setThreadContext(ThreadContext* ctx)    { threadContext = ctx; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setThreadContext(ThreadContext* ctx)    { threadContext = ctx; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "request.setQueryParams",
          "args": [
            "queryParams"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "setQueryParams",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "176-176",
          "snippet": "void setQueryParams(const tnt::QueryParams& q)   { qparam = q; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setQueryParams(const tnt::QueryParams& q)   { qparam = q; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <tnt/cmd.h>\n\nvoid Cmd::call(const Compident& ci, const QueryParams& queryParams)\n  {\n    HttpRequest request(application, &socketIf);\n    request.setQueryParams(queryParams);\n\n    // set thread context for thread scope\n    request.setThreadContext(&threadContext);\n\n    // sets session and application scope\n    scopeManager.preCall(request, ci.libname);\n    scopeManager.setSessionId(request, sessionId);\n\n    // fetch and call the component\n    comploader.fetchComp(ci)(request, reply, request.getQueryParams());\n\n    // sets session cookie if needed\n    sessionId = scopeManager.postCall(request, reply, application.getAppName());\n  }"
  },
  {
    "function_name": "Cmd::Cmd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/cmd.cpp",
    "lines": "33-37",
    "snippet": "Cmd::Cmd(std::ostream& out)\n    : reply(out, false)\n  {\n    reply.setDirectModeNoFlush();\n  }",
    "includes": [
      "#include <tnt/cmd.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reply.setDirectModeNoFlush",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <tnt/cmd.h>\n\nCmd::Cmd(std::ostream& out)\n    : reply(out, false)\n  {\n    reply.setDirectModeNoFlush();\n  }"
  }
]