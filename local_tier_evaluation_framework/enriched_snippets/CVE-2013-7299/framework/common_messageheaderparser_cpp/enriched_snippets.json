[
  {
    "function_name": "reset",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "265-270",
    "snippet": "void Messageheader::Parser::reset()\n  {\n    failedFlag = false;\n    headerdataPtr = header.rawdata;\n    SET_STATE(state_0);\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_0"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    void Messageheader::Parser::reset()\n      {\n        failedFlag = false;\n        headerdataPtr = header.rawdata;\n        SET_STATE(state_0);\n      }\n  }\n}"
  },
  {
    "function_name": "checkHeaderspace",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "259-263",
    "snippet": "void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n  {\n    if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n      throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HttpError",
          "args": [
            "HTTP_REQUEST_ENTITY_TOO_LARGE",
            "\"header too large\""
          ],
          "line": 262
        },
        "resolved": true,
        "details": {
          "function_name": "HttpError",
          "container": "HttpError",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httperror.cpp",
          "lines": "160-170",
          "snippet": "HttpError::HttpError(unsigned errcode, const std::string& m)\n    : msg(httpErrorFormat(errcode, m))\n  {\n    std::ostringstream b;\n    HtmlEscOstream sb(b);\n\n    b << \"<html><body><h1>Error</h1><p>\";\n    sb << m;\n    b << \"</p></body></html>\";\n    body = b.str();\n  }",
          "includes": [
            "#include <algorithm>",
            "#include <sstream>",
            "#include <iostream>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <sstream>\n#include <iostream>\n#include <tnt/htmlescostream.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n\nHttpError {\n  HttpError::HttpError(unsigned errcode, const std::string& m)\n      : msg(httpErrorFormat(errcode, m))\n    {\n      std::ostringstream b;\n      HtmlEscOstream sb(b);\n  \n      b << \"<html><body><h1>Error</h1><p>\";\n      sb << m;\n      b << \"</p></body></html>\";\n      body = b.str();\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n      {\n        if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n          throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n      }\n  }\n}"
  },
  {
    "function_name": "state_end_cr",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "237-257",
    "snippet": "bool Messageheader::Parser::state_end_cr(char ch)\n  {\n    if (ch == '\\n')\n    {\n      if (header.onField(fieldnamePtr, fieldbodyPtr) == FAIL)\n      {\n        log_warn(\"invalid header \" << fieldnamePtr << ' ' << fieldbodyPtr);\n        failedFlag = true;\n      }\n\n      *headerdataPtr = '\\0';\n      return true;\n    }\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in end-cr\");\n      failedFlag = true;\n      return true;\n    }\n    return false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in end-cr\""
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "40-47",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid header \" << fieldnamePtr << ' ' << fieldbodyPtr"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "header.onField",
          "args": [
            "fieldnamePtr",
            "fieldbodyPtr"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "onField",
          "container": "Partheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/multipart.cpp",
          "lines": "85-97",
          "snippet": "Partheader::return_type Partheader::onField(const char* name,\n    const char* value)\n  {\n    if (tnt::StringCompareIgnoreCase<const char*>(name, \"Content-Disposition:\") == 0)\n    {\n      std::istringstream in(value);\n      in >> cd;\n      if (!in)\n        return FAIL;\n    }\n\n    return Messageheader::onField(name, value);\n  }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <streambuf>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/multipart.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <streambuf>\n#include <stdexcept>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httpheader.h>\n#include <tnt/multipart.h>\n\nPartheader {\n  Partheader::return_type Partheader::onField(const char* name,\n      const char* value)\n    {\n      if (tnt::StringCompareIgnoreCase<const char*>(name, \"Content-Disposition:\") == 0)\n      {\n        std::istringstream in(value);\n        in >> cd;\n        if (!in)\n          return FAIL;\n      }\n  \n      return Messageheader::onField(name, value);\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_end_cr(char ch)\n      {\n        if (ch == '\\n')\n        {\n          if (header.onField(fieldnamePtr, fieldbodyPtr) == FAIL)\n          {\n            log_warn(\"invalid header \" << fieldnamePtr << ' ' << fieldbodyPtr);\n            failedFlag = true;\n          }\n    \n          *headerdataPtr = '\\0';\n          return true;\n        }\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in end-cr\");\n          failedFlag = true;\n          return true;\n        }\n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_fieldbody_crlf",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "190-235",
    "snippet": "bool Messageheader::Parser::state_fieldbody_crlf(char ch)\n  {\n    if (ch == '\\r')\n      SET_STATE(state_end_cr);\n    else if (ch == '\\n')\n    {\n      log_debug(\"header \" << fieldnamePtr << \": \" << fieldbodyPtr);\n      switch (header.onField(fieldnamePtr, fieldbodyPtr))\n      {\n        case OK:\n        case END:  return true;\n                   break;\n        case FAIL: failedFlag = true;\n                   log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldbody\");\n                   break;\n      }\n\n      return true;\n    }\n    else if (std::isspace(ch))\n    {\n      // continuation line\n      checkHeaderspace(1);\n      *(headerdataPtr - 1) = '\\n';\n      *headerdataPtr++ = ch;\n      SET_STATE(state_fieldbody);\n    }\n    else if (ch >= 33 && ch <= 126)\n    {\n      switch (header.onField(fieldnamePtr, fieldbodyPtr))\n      {\n        case OK:   SET_STATE(state_fieldname);\n                   break;\n        case FAIL: failedFlag = true;\n                   log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldbody\");\n                   break;\n        case END:  return true;\n                   break;\n      }\n\n      fieldnamePtr = headerdataPtr;\n      checkHeaderspace(1);\n      *headerdataPtr++ = ch;\n    }\n    return false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkHeaderspace",
          "args": [
            "1"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "checkHeaderspace",
          "container": "Messageheader::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "259-263",
          "snippet": "void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n  {\n    if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n      throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n      {\n        if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n          throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in fieldbody\""
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "40-47",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldname"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "header.onField",
          "args": [
            "fieldnamePtr",
            "fieldbodyPtr"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "onField",
          "container": "Partheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/multipart.cpp",
          "lines": "85-97",
          "snippet": "Partheader::return_type Partheader::onField(const char* name,\n    const char* value)\n  {\n    if (tnt::StringCompareIgnoreCase<const char*>(name, \"Content-Disposition:\") == 0)\n    {\n      std::istringstream in(value);\n      in >> cd;\n      if (!in)\n        return FAIL;\n    }\n\n    return Messageheader::onField(name, value);\n  }",
          "includes": [
            "#include <tnt/stringlessignorecase.h>",
            "#include <streambuf>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/multipart.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <tnt/stringlessignorecase.h>\n#include <streambuf>\n#include <stdexcept>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httpheader.h>\n#include <tnt/multipart.h>\n\nPartheader {\n  Partheader::return_type Partheader::onField(const char* name,\n      const char* value)\n    {\n      if (tnt::StringCompareIgnoreCase<const char*>(name, \"Content-Disposition:\") == 0)\n      {\n        std::istringstream in(value);\n        in >> cd;\n        if (!in)\n          return FAIL;\n      }\n  \n      return Messageheader::onField(name, value);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in fieldbody\""
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"header \" << fieldnamePtr << \": \" << fieldbodyPtr"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_end_cr"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_fieldbody_crlf(char ch)\n      {\n        if (ch == '\\r')\n          SET_STATE(state_end_cr);\n        else if (ch == '\\n')\n        {\n          log_debug(\"header \" << fieldnamePtr << \": \" << fieldbodyPtr);\n          switch (header.onField(fieldnamePtr, fieldbodyPtr))\n          {\n            case OK:\n            case END:  return true;\n                       break;\n            case FAIL: failedFlag = true;\n                       log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldbody\");\n                       break;\n          }\n    \n          return true;\n        }\n        else if (std::isspace(ch))\n        {\n          // continuation line\n          checkHeaderspace(1);\n          *(headerdataPtr - 1) = '\\n';\n          *headerdataPtr++ = ch;\n          SET_STATE(state_fieldbody);\n        }\n        else if (ch >= 33 && ch <= 126)\n        {\n          switch (header.onField(fieldnamePtr, fieldbodyPtr))\n          {\n            case OK:   SET_STATE(state_fieldname);\n                       break;\n            case FAIL: failedFlag = true;\n                       log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldbody\");\n                       break;\n            case END:  return true;\n                       break;\n          }\n    \n          fieldnamePtr = headerdataPtr;\n          checkHeaderspace(1);\n          *headerdataPtr++ = ch;\n        }\n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_fieldbody_cr",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "177-188",
    "snippet": "bool Messageheader::Parser::state_fieldbody_cr(char ch)\n  {\n    if (ch == '\\n')\n      SET_STATE(state_fieldbody_crlf);\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldbody-cr\");\n      failedFlag = true;\n      return true;\n    }\n    return false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in fieldbody-cr\""
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "40-47",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody_crlf"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_fieldbody_cr(char ch)\n      {\n        if (ch == '\\n')\n          SET_STATE(state_fieldbody_crlf);\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldbody-cr\");\n          failedFlag = true;\n          return true;\n        }\n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_fieldbody",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "155-175",
    "snippet": "bool Messageheader::Parser::state_fieldbody(char ch)\n  {\n    if (ch == '\\r')\n    {\n      checkHeaderspace(1);\n      *headerdataPtr++ = '\\0';\n      SET_STATE(state_fieldbody_cr);\n    }\n    else if (ch == '\\n')\n    {\n      checkHeaderspace(1);\n      *headerdataPtr++ = '\\0';\n      SET_STATE(state_fieldbody_crlf);\n    }\n    else\n    {\n      checkHeaderspace(1);\n      *headerdataPtr++ = ch;\n    }\n    return false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "checkHeaderspace",
          "args": [
            "1"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "checkHeaderspace",
          "container": "Messageheader::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "259-263",
          "snippet": "void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n  {\n    if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n      throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n      {\n        if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n          throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody_crlf"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody_cr"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_fieldbody(char ch)\n      {\n        if (ch == '\\r')\n        {\n          checkHeaderspace(1);\n          *headerdataPtr++ = '\\0';\n          SET_STATE(state_fieldbody_cr);\n        }\n        else if (ch == '\\n')\n        {\n          checkHeaderspace(1);\n          *headerdataPtr++ = '\\0';\n          SET_STATE(state_fieldbody_crlf);\n        }\n        else\n        {\n          checkHeaderspace(1);\n          *headerdataPtr++ = ch;\n        }\n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_fieldbody0",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "132-153",
    "snippet": "bool Messageheader::Parser::state_fieldbody0(char ch)\n  {\n    if (ch == '\\r')\n    {\n      checkHeaderspace(1);\n      *headerdataPtr++ = '\\0';\n      SET_STATE(state_fieldbody_cr);\n    }\n    else if (ch == '\\n')\n    {\n      checkHeaderspace(1);\n      *headerdataPtr++ = '\\0';\n      SET_STATE(state_fieldbody_crlf);\n    }\n    else if (!std::isspace(ch))\n    {\n      checkHeaderspace(1);\n      *headerdataPtr++ = ch;\n      SET_STATE(state_fieldbody);\n    }\n    return false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkHeaderspace",
          "args": [
            "1"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "checkHeaderspace",
          "container": "Messageheader::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "259-263",
          "snippet": "void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n  {\n    if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n      throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n      {\n        if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n          throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody_crlf"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody_cr"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_fieldbody0(char ch)\n      {\n        if (ch == '\\r')\n        {\n          checkHeaderspace(1);\n          *headerdataPtr++ = '\\0';\n          SET_STATE(state_fieldbody_cr);\n        }\n        else if (ch == '\\n')\n        {\n          checkHeaderspace(1);\n          *headerdataPtr++ = '\\0';\n          SET_STATE(state_fieldbody_crlf);\n        }\n        else if (!std::isspace(ch))\n        {\n          checkHeaderspace(1);\n          *headerdataPtr++ = ch;\n          SET_STATE(state_fieldbody);\n        }\n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_fieldnamespace",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "119-130",
    "snippet": "bool Messageheader::Parser::state_fieldnamespace(char ch)\n  {\n    if (ch == ':')                   // \"Field-name :\"\n      SET_STATE(state_fieldbody0);\n    else if (!std::isspace(ch))\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldname-space\");\n      failedFlag = true;\n      return true;\n    }\n    return false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in fieldname-space\""
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "40-47",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody0"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_fieldnamespace(char ch)\n      {\n        if (ch == ':')                   // \"Field-name :\"\n          SET_STATE(state_fieldbody0);\n        else if (!std::isspace(ch))\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldname-space\");\n          failedFlag = true;\n          return true;\n        }\n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_fieldname",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "87-117",
    "snippet": "bool Messageheader::Parser::state_fieldname(char ch)\n  {\n    if (ch == ':')            // Field-name:\n    {\n      checkHeaderspace(2);\n      *headerdataPtr++ = ch;\n      *headerdataPtr++ = '\\0';\n      fieldbodyPtr = headerdataPtr;\n      SET_STATE(state_fieldbody0);\n    }\n    else if (ch >= 33 && ch <= 126)\n    {\n      checkHeaderspace(1);\n      *headerdataPtr++ = ch;\n    }\n    else if (std::isspace(ch))\n    {\n      checkHeaderspace(2);\n      *headerdataPtr++ = ':';\n      *headerdataPtr++ = '\\0';\n      fieldbodyPtr = headerdataPtr;\n      SET_STATE(state_fieldnamespace);\n    }\n    else\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldname\");\n      failedFlag = true;\n      return true;\n    }\n    return false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in fieldname\""
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "40-47",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldnamespace"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkHeaderspace",
          "args": [
            "2"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "checkHeaderspace",
          "container": "Messageheader::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "259-263",
          "snippet": "void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n  {\n    if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n      throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n      {\n        if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n          throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldbody0"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_fieldname(char ch)\n      {\n        if (ch == ':')            // Field-name:\n        {\n          checkHeaderspace(2);\n          *headerdataPtr++ = ch;\n          *headerdataPtr++ = '\\0';\n          fieldbodyPtr = headerdataPtr;\n          SET_STATE(state_fieldbody0);\n        }\n        else if (ch >= 33 && ch <= 126)\n        {\n          checkHeaderspace(1);\n          *headerdataPtr++ = ch;\n        }\n        else if (std::isspace(ch))\n        {\n          checkHeaderspace(2);\n          *headerdataPtr++ = ':';\n          *headerdataPtr++ = '\\0';\n          fieldbodyPtr = headerdataPtr;\n          SET_STATE(state_fieldnamespace);\n        }\n        else\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in fieldname\");\n          failedFlag = true;\n          return true;\n        }\n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "state_cr",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "77-85",
    "snippet": "bool Messageheader::Parser::state_cr(char ch)\n  {\n    if (ch != '\\n')\n    {\n      log_warn(\"invalid character \" << chartoprint(ch) << \" in state-cr\");\n      failedFlag = true;\n    }\n    return true;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch) << \" in state-cr\""
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "40-47",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_cr(char ch)\n      {\n        if (ch != '\\n')\n        {\n          log_warn(\"invalid character \" << chartoprint(ch) << \" in state-cr\");\n          failedFlag = true;\n        }\n        return true;\n      }\n  }\n}"
  },
  {
    "function_name": "state_0",
    "container": "Messageheader::Parser",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "54-75",
    "snippet": "bool Messageheader::Parser::state_0(char ch)\n  {\n    if (ch >= 33 && ch <= 126 && ch != ':')\n    {\n      fieldnamePtr = headerdataPtr;\n      checkHeaderspace(1);\n      *headerdataPtr++ = ch;\n      SET_STATE(state_fieldname);\n    }\n    else if (ch == '\\n')\n      return true;\n    else if (ch == '\\r')\n      SET_STATE(state_cr);\n    else if (!std::isspace(ch))\n    {\n      log_warn(\"invalid character \" << chartoprint(ch));\n      failedFlag = true;\n      return true;\n    }\n\n    return false;\n  }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"invalid character \" << chartoprint(ch)"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "chartoprint",
          "args": [
            "ch"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "chartoprint",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "40-47",
          "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }"
        }
      },
      {
        "call_info": {
          "callee": "std::isspace",
          "args": [
            "ch"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_cr"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SET_STATE",
          "args": [
            "state_fieldname"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "checkHeaderspace",
          "args": [
            "1"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "checkHeaderspace",
          "container": "Messageheader::Parser",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
          "lines": "259-263",
          "snippet": "void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n  {\n    if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n      throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n  }",
          "includes": [
            "#include <cxxtools/log.h>",
            "#include <cctype>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/messageheaderparser.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    void Messageheader::Parser::checkHeaderspace(unsigned chars) const\n      {\n        if (headerdataPtr + chars >= header.rawdata + sizeof(header.rawdata))\n          throw HttpError(HTTP_REQUEST_ENTITY_TOO_LARGE, \"header too large\");\n      }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nMessageheader {\n  Parser {\n    bool Messageheader::Parser::state_0(char ch)\n      {\n        if (ch >= 33 && ch <= 126 && ch != ':')\n        {\n          fieldnamePtr = headerdataPtr;\n          checkHeaderspace(1);\n          *headerdataPtr++ = ch;\n          SET_STATE(state_fieldname);\n        }\n        else if (ch == '\\n')\n          return true;\n        else if (ch == '\\r')\n          SET_STATE(state_cr);\n        else if (!std::isspace(ch))\n        {\n          log_warn(\"invalid character \" << chartoprint(ch));\n          failedFlag = true;\n          return true;\n        }\n    \n        return false;\n      }\n  }\n}"
  },
  {
    "function_name": "chartoprint",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheaderparser.cpp",
    "lines": "40-47",
    "snippet": "std::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }",
    "includes": [
      "#include <cxxtools/log.h>",
      "#include <cctype>",
      "#include <tnt/http.h>",
      "#include <tnt/httperror.h>",
      "#include <tnt/messageheaderparser.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"'\\\\x\""
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "1",
            "'\\''"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::isprint",
          "args": [
            "ch"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cxxtools/log.h>\n#include <cctype>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/messageheaderparser.h>\n\nstd::string chartoprint(char ch)\n    {\n      const static char hex[] = \"0123456789abcdef\";\n      if (std::isprint(ch))\n        return std::string(1, '\\'') + ch + '\\'';\n      else\n        return std::string(\"'\\\\x\") + hex[ch >> 4] + hex[ch & 0xf] + '\\'';\n    }"
  }
]