[
  {
    "function_name": "shutdown",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "323-327",
    "snippet": "void Tntnet::shutdown()\n  {\n    stop = true;\n    timerStopCondition.broadcast();\n  }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "timerStopCondition.broadcast",
          "args": [],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::shutdown()\n    {\n      stop = true;\n      timerStopCondition.broadcast();\n    }\n}"
  },
  {
    "function_name": "timerTask",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "303-321",
    "snippet": "void Tntnet::timerTask()\n  {\n    log_debug(\"timer thread\");\n\n    while (true)\n    {\n      {\n        cxxtools::MutexLock timeStopLock(timeStopMutex);\n        if (stop || timerStopCondition.wait(timeStopLock, TntConfig::it().timerSleep * 1000))\n          break;\n      }\n\n      getScopemanager().checkSessionTimeout();\n      Worker::timer();\n    }\n\n    queue.noWaitThreads.signal();\n    minthreads = maxthreads = 0;\n  }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue.noWaitThreads.signal",
          "args": [],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Worker::timer",
          "args": [],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "timer",
          "container": "Worker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/worker.cpp",
          "lines": "493-504",
          "snippet": "void Worker::timer()\n  {\n    time_t currentTime;\n    time(&currentTime);\n\n    cxxtools::MutexLock lock(mutex);\n    for (workers_type::iterator it = workers.begin();\n         it != workers.end(); ++it)\n    {\n      (*it)->healthCheck(currentTime);\n    }\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <string.h>",
            "#include <pthread.h>",
            "#include <cxxtools/net/tcpserver.h>",
            "#include <cxxtools/atomicity.h>",
            "#include <cxxtools/ioerror.h>",
            "#include <cxxtools/dlloader.h>",
            "#include <sys/poll.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include \"tnt/job.h\"",
            "#include \"tnt/dispatcher.h\"",
            "#include \"tnt/worker.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <string.h>\n#include <pthread.h>\n#include <cxxtools/net/tcpserver.h>\n#include <cxxtools/atomicity.h>\n#include <cxxtools/ioerror.h>\n#include <cxxtools/dlloader.h>\n#include <sys/poll.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/poller.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include \"tnt/job.h\"\n#include \"tnt/dispatcher.h\"\n#include \"tnt/worker.h\"\n\nWorker {\n  void Worker::timer()\n    {\n      time_t currentTime;\n      time(&currentTime);\n  \n      cxxtools::MutexLock lock(mutex);\n      for (workers_type::iterator it = workers.begin();\n           it != workers.end(); ++it)\n      {\n        (*it)->healthCheck(currentTime);\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getScopemanager",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getScopemanager",
          "args": [],
          "line": 315
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerStopCondition.wait",
          "args": [
            "timeStopLock",
            "TntConfig::it().timerSleep * 1000"
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"timer thread\""
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::timerTask()\n    {\n      log_debug(\"timer thread\");\n  \n      while (true)\n      {\n        {\n          cxxtools::MutexLock timeStopLock(timeStopMutex);\n          if (stop || timerStopCondition.wait(timeStopLock, TntConfig::it().timerSleep * 1000))\n            break;\n        }\n  \n        getScopemanager().checkSessionTimeout();\n        Worker::timer();\n      }\n  \n      queue.noWaitThreads.signal();\n      minthreads = maxthreads = 0;\n    }\n}"
  },
  {
    "function_name": "setMinThreads",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "290-301",
    "snippet": "void Tntnet::setMinThreads(unsigned n)\n  {\n    if (listeners.size() >= n)\n    {\n      log_warn(\"at least one more worker than listeners needed - set MinThreads to \"\n        << listeners.size() + 1);\n      minthreads = listeners.size() + 1;\n    }\n    else\n      minthreads = n;\n\n  }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "listeners.size",
          "args": [],
          "line": 296
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"at least one more worker than listeners needed - set MinThreads to \"\n        << listeners.size() + 1"
          ],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::setMinThreads(unsigned n)\n    {\n      if (listeners.size() >= n)\n      {\n        log_warn(\"at least one more worker than listeners needed - set MinThreads to \"\n          << listeners.size() + 1);\n        minthreads = listeners.size() + 1;\n      }\n      else\n        minthreads = n;\n  \n    }\n}"
  },
  {
    "function_name": "run",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "171-288",
    "snippet": "void Tntnet::run()\n  {\n    log_debug(\"worker-process\");\n\n    stop = false;\n\n    if (listeners.empty())\n      throwRuntimeError(\"no listeners defined\");\n\n    log_debug(listeners.size() << \" listeners\");\n\n    if (listeners.size() >= minthreads)\n    {\n      log_warn(\"at least one more worker than listeners needed - set MinThreads to \"\n        << listeners.size() + 1);\n      minthreads = listeners.size() + 1;\n    }\n\n    if (maxthreads < minthreads)\n    {\n      log_warn(\"MaxThreads < MinThreads - set MaxThreads = MinThreads = \" << minthreads);\n      maxthreads = minthreads;\n    }\n\n    // initialize worker-process\n\n    // set FD_CLOEXEC\n    for (listeners_type::iterator it = listeners.begin(); it != listeners.end(); ++it)\n      (*it)->initialize();\n\n    // SIGPIPE must be ignored\n    ::signal(SIGPIPE, SIG_IGN);\n\n    // create worker-threads\n    log_info(\"create \" << minthreads << \" worker threads\");\n    for (unsigned i = 0; i < minthreads; ++i)\n    {\n      log_debug(\"create worker \" << i);\n      Worker* s = new Worker(*this);\n      s->create();\n    }\n\n    // create poller-thread\n    log_debug(\"start poller thread\");\n    pollerthread.start();\n\n    log_debug(\"start timer thread\");\n    cxxtools::AttachedThread timerThread(cxxtools::callable(*this, &Tntnet::timerTask));\n    timerThread.start();\n\n    {\n      cxxtools::MutexLock lock(allTntnetInstancesMutex);\n      allRunningTntnetInstances.insert(this);\n    }\n\n    // mainloop\n    cxxtools::Mutex mutex;\n    while (!stop)\n    {\n      {\n        cxxtools::MutexLock lock(mutex);\n        queue.noWaitThreads.wait(lock);\n      }\n\n      if (stop)\n        break;\n\n      if (Worker::getCountThreads() < maxthreads)\n      {\n        log_info(\"create workerthread\");\n        Worker* s = new Worker(*this);\n        s->create();\n      }\n      else\n        log_info(\"max worker-threadcount \" << maxthreads << \" reached\");\n\n      if (TntConfig::it().threadStartDelay > 0)\n        usleep(TntConfig::it().threadStartDelay * 1000);\n    }\n\n    log_info(\"stopping Tntnet\");\n\n    {\n      cxxtools::MutexLock lock(allTntnetInstancesMutex);\n      allRunningTntnetInstances.erase(this);\n    }\n\n    log_info(\"stop listener\");\n    for (listeners_type::iterator it = listeners.begin(); it != listeners.end(); ++it)\n      (*it)->doTerminate();\n\n    log_info(\"stop poller thread\");\n    poller.doStop();\n    pollerthread.join();\n\n    log_info(\"stop timer thread\");\n    timerThread.join();\n\n    if (Worker::getCountThreads() > 0)\n    {\n      log_info(\"wait for \" << Worker::getCountThreads() << \" worker threads to stop\");\n      while (Worker::getCountThreads() > 0)\n      {\n        log_debug(\"wait for worker threads to stop; \" << Worker::getCountThreads() << \" left\");\n        usleep(100);\n      }\n    }\n\n    log_debug(\"destroy listener\");\n    for (listeners_type::iterator it = listeners.begin(); it != listeners.end(); ++it)\n      delete *it;\n    listeners.clear();\n\n    HttpReply::postRunCleanup();\n    HttpRequest::postRunCleanup();\n\n    log_info(\"all threads stopped\");\n  }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"all threads stopped\""
          ],
          "line": 287
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HttpRequest::postRunCleanup",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "postRunCleanup",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "620-625",
          "snippet": "void HttpRequest::postRunCleanup()\n  {\n#ifdef ENABLE_LOCALE\n    tnt::clearLocaleCache();\n#endif\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::postRunCleanup()\n    {\n  #ifdef ENABLE_LOCALE\n      tnt::clearLocaleCache();\n  #endif\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "HttpReply::postRunCleanup",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "postRunCleanup",
          "container": "HttpReply",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpreply.cpp",
          "lines": "281-284",
          "snippet": "void HttpReply::postRunCleanup()\n  {\n    Impl::pool.clear();\n  }",
          "includes": [
            "#include <netinet/in.h>",
            "#include <zlib.h>",
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/md5stream.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/urlescostream.h>",
            "#include <tnt/htmlescostream.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/deflatestream.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httpreply.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <netinet/in.h>\n#include <zlib.h>\n#include <stdio.h>\n#include <sstream>\n#include <cxxtools/mutex.h>\n#include <cxxtools/md5stream.h>\n#include <cxxtools/log.h>\n#include <tnt/encoding.h>\n#include <tnt/urlescostream.h>\n#include <tnt/htmlescostream.h>\n#include <tnt/tntconfig.h>\n#include <tnt/httperror.h>\n#include <tnt/deflatestream.h>\n#include <tnt/httpheader.h>\n#include <tnt/http.h>\n#include <tnt/httpreply.h>\n\nHttpReply {\n  void HttpReply::postRunCleanup()\n    {\n      Impl::pool.clear();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "listeners.clear",
          "args": [],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httprequest.cpp",
          "lines": "168-220",
          "snippet": "void HttpRequest::clear()\n  {\n    HttpMessage::clear();\n    body.clear();\n    methodLen = 0;\n    method[0] = '\\0';\n    url.clear();\n    queryString.clear();\n    contentSize = 0;\n    pathinfo.clear();\n    args.clear();\n    getparam.clear();\n    postparam.clear();\n    qparam.clear();\n    ct = Contenttype();\n    mp = Multipart();\n    locale_init = false;\n    if (requestScope)\n    {\n      if (requestScope->release() == 0)\n        delete requestScope;\n      requestScope = 0;\n    }\n    httpcookies.clear();\n    encodingRead = false;\n    username.clear();\n    password.clear();\n\n    releaseLocks();\n\n    if (applicationScope)\n    {\n      if (applicationScope->release() == 0)\n        delete applicationScope;\n      applicationScope = 0;\n    }\n\n    if (sessionScope)\n    {\n      if (sessionScope->release() == 0)\n        delete sessionScope;\n      sessionScope = 0;\n    }\n\n    if (secureSessionScope)\n    {\n      if (secureSessionScope->release() == 0)\n        delete secureSessionScope;\n      secureSessionScope = 0;\n    }\n\n    threadContext = 0;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include \"config.h\"",
            "#include <pthread.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/sessionscope.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <cxxtools/base64stream.h>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <sstream>",
            "#include <tnt/util.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include \"config.h\"\n#include <pthread.h>\n#include <tnt/socketif.h>\n#include <tnt/sessionscope.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <cxxtools/base64stream.h>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <sstream>\n#include <tnt/util.h>\n#include <tnt/httperror.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n\nHttpRequest {\n  void HttpRequest::clear()\n    {\n      HttpMessage::clear();\n      body.clear();\n      methodLen = 0;\n      method[0] = '\\0';\n      url.clear();\n      queryString.clear();\n      contentSize = 0;\n      pathinfo.clear();\n      args.clear();\n      getparam.clear();\n      postparam.clear();\n      qparam.clear();\n      ct = Contenttype();\n      mp = Multipart();\n      locale_init = false;\n      if (requestScope)\n      {\n        if (requestScope->release() == 0)\n          delete requestScope;\n        requestScope = 0;\n      }\n      httpcookies.clear();\n      encodingRead = false;\n      username.clear();\n      password.clear();\n  \n      releaseLocks();\n  \n      if (applicationScope)\n      {\n        if (applicationScope->release() == 0)\n          delete applicationScope;\n        applicationScope = 0;\n      }\n  \n      if (sessionScope)\n      {\n        if (sessionScope->release() == 0)\n          delete sessionScope;\n        sessionScope = 0;\n      }\n  \n      if (secureSessionScope)\n      {\n        if (secureSessionScope->release() == 0)\n          delete secureSessionScope;\n        secureSessionScope = 0;\n      }\n  \n      threadContext = 0;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "listeners.end",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "listeners.begin",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"destroy listener\""
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "100"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"wait for worker threads to stop; \" << Worker::getCountThreads() << \" left\""
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Worker::getCountThreads",
          "args": [],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "getCountThreads",
          "container": "Worker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/worker.cpp",
          "lines": "532-536",
          "snippet": "Worker::workers_type::size_type Worker::getCountThreads()\n  {\n    cxxtools::MutexLock lock(mutex);\n    return workers.size();\n  }",
          "includes": [
            "#include \"config.h\"",
            "#include <string.h>",
            "#include <pthread.h>",
            "#include <cxxtools/net/tcpserver.h>",
            "#include <cxxtools/atomicity.h>",
            "#include <cxxtools/ioerror.h>",
            "#include <cxxtools/dlloader.h>",
            "#include <sys/poll.h>",
            "#include <arpa/inet.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/tntconfig.h>",
            "#include <tnt/poller.h>",
            "#include <tnt/http.h>",
            "#include <tnt/httperror.h>",
            "#include <tnt/httpreply.h>",
            "#include <tnt/httprequest.h>",
            "#include \"tnt/job.h\"",
            "#include \"tnt/dispatcher.h\"",
            "#include \"tnt/worker.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"config.h\"\n#include <string.h>\n#include <pthread.h>\n#include <cxxtools/net/tcpserver.h>\n#include <cxxtools/atomicity.h>\n#include <cxxtools/ioerror.h>\n#include <cxxtools/dlloader.h>\n#include <sys/poll.h>\n#include <arpa/inet.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <unistd.h>\n#include <stdlib.h>\n#include <cxxtools/log.h>\n#include <tnt/tntconfig.h>\n#include <tnt/poller.h>\n#include <tnt/http.h>\n#include <tnt/httperror.h>\n#include <tnt/httpreply.h>\n#include <tnt/httprequest.h>\n#include \"tnt/job.h\"\n#include \"tnt/dispatcher.h\"\n#include \"tnt/worker.h\"\n\nWorker {\n  Worker::workers_type::size_type Worker::getCountThreads()\n    {\n      cxxtools::MutexLock lock(mutex);\n      return workers.size();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"wait for \" << Worker::getCountThreads() << \" worker threads to stop\""
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerThread.join",
          "args": [],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"stop timer thread\""
          ],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollerthread.join",
          "args": [],
          "line": 264
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "poller.doStop",
          "args": [],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "doStop",
          "container": "PollerImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/poller.cpp",
          "lines": "338-341",
          "snippet": "void PollerImpl::doStop()\n  {\n    notify_pipe.write('A');\n  }",
          "includes": [
            "#include <errno.h>",
            "#include <sys/epoll.h>",
            "#include <fcntl.h>",
            "#include <unistd.h>",
            "#include <ios>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/systemerror.h>",
            "#include \"tnt/tntnet.h\"",
            "#include \"tnt/pollerimpl.h\"",
            "#include \"tnt/poller.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <errno.h>\n#include <sys/epoll.h>\n#include <fcntl.h>\n#include <unistd.h>\n#include <ios>\n#include <cxxtools/log.h>\n#include <cxxtools/systemerror.h>\n#include \"tnt/tntnet.h\"\n#include \"tnt/pollerimpl.h\"\n#include \"tnt/poller.h\"\n\nPollerImpl {\n  void PollerImpl::doStop()\n    {\n      notify_pipe.write('A');\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"stop poller thread\""
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 260
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"stop listener\""
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allRunningTntnetInstances.erase",
          "args": [
            "this"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "Scope",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/scope.h",
          "lines": "111-111",
          "snippet": "void erase(const std::string& key)  { data.erase(key); }",
          "includes": [
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/object.h>",
            "#include <string>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/refcounted.h>\n#include <cxxtools/mutex.h>\n#include <tnt/object.h>\n#include <string>\n#include <map>\n\nScope {\n  void erase(const std::string& key)  { data.erase(key); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"stopping Tntnet\""
          ],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "TntConfig::it().threadStartDelay * 1000"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"max worker-threadcount \" << maxthreads << \" reached\""
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s->create",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"create workerthread\""
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue.noWaitThreads.wait",
          "args": [
            "lock"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allRunningTntnetInstances.insert",
          "args": [
            "this"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "timerThread.start",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cxxtools::callable",
          "args": [
            "*this",
            "&Tntnet::timerTask"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"start timer thread\""
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pollerthread.start",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"start poller thread\""
          ],
          "line": 214
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s->create",
          "args": [],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"create worker \" << i"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_info",
          "args": [
            "\"create \" << minthreads << \" worker threads\""
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::signal",
          "args": [
            "SIGPIPE",
            "SIG_IGN"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"MaxThreads < MinThreads - set MaxThreads = MinThreads = \" << minthreads"
          ],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listeners.size",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_warn",
          "args": [
            "\"at least one more worker than listeners needed - set MinThreads to \"\n        << listeners.size() + 1"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "listeners.size() << \" listeners\""
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "throwRuntimeError",
          "args": [
            "\"no listeners defined\""
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "throwRuntimeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/util.cpp",
          "lines": "39-42",
          "snippet": "void throwRuntimeError(const char* msg)\n  {\n    throwRuntimeError(std::string(msg));\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <tnt/util.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <tnt/util.h>\n\nvoid throwRuntimeError(const char* msg)\n  {\n    throwRuntimeError(std::string(msg));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "listeners.empty",
          "args": [],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"worker-process\""
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::run()\n    {\n      log_debug(\"worker-process\");\n  \n      stop = false;\n  \n      if (listeners.empty())\n        throwRuntimeError(\"no listeners defined\");\n  \n      log_debug(listeners.size() << \" listeners\");\n  \n      if (listeners.size() >= minthreads)\n      {\n        log_warn(\"at least one more worker than listeners needed - set MinThreads to \"\n          << listeners.size() + 1);\n        minthreads = listeners.size() + 1;\n      }\n  \n      if (maxthreads < minthreads)\n      {\n        log_warn(\"MaxThreads < MinThreads - set MaxThreads = MinThreads = \" << minthreads);\n        maxthreads = minthreads;\n      }\n  \n      // initialize worker-process\n  \n      // set FD_CLOEXEC\n      for (listeners_type::iterator it = listeners.begin(); it != listeners.end(); ++it)\n        (*it)->initialize();\n  \n      // SIGPIPE must be ignored\n      ::signal(SIGPIPE, SIG_IGN);\n  \n      // create worker-threads\n      log_info(\"create \" << minthreads << \" worker threads\");\n      for (unsigned i = 0; i < minthreads; ++i)\n      {\n        log_debug(\"create worker \" << i);\n        Worker* s = new Worker(*this);\n        s->create();\n      }\n  \n      // create poller-thread\n      log_debug(\"start poller thread\");\n      pollerthread.start();\n  \n      log_debug(\"start timer thread\");\n      cxxtools::AttachedThread timerThread(cxxtools::callable(*this, &Tntnet::timerTask));\n      timerThread.start();\n  \n      {\n        cxxtools::MutexLock lock(allTntnetInstancesMutex);\n        allRunningTntnetInstances.insert(this);\n      }\n  \n      // mainloop\n      cxxtools::Mutex mutex;\n      while (!stop)\n      {\n        {\n          cxxtools::MutexLock lock(mutex);\n          queue.noWaitThreads.wait(lock);\n        }\n  \n        if (stop)\n          break;\n  \n        if (Worker::getCountThreads() < maxthreads)\n        {\n          log_info(\"create workerthread\");\n          Worker* s = new Worker(*this);\n          s->create();\n        }\n        else\n          log_info(\"max worker-threadcount \" << maxthreads << \" reached\");\n  \n        if (TntConfig::it().threadStartDelay > 0)\n          usleep(TntConfig::it().threadStartDelay * 1000);\n      }\n  \n      log_info(\"stopping Tntnet\");\n  \n      {\n        cxxtools::MutexLock lock(allTntnetInstancesMutex);\n        allRunningTntnetInstances.erase(this);\n      }\n  \n      log_info(\"stop listener\");\n      for (listeners_type::iterator it = listeners.begin(); it != listeners.end(); ++it)\n        (*it)->doTerminate();\n  \n      log_info(\"stop poller thread\");\n      poller.doStop();\n      pollerthread.join();\n  \n      log_info(\"stop timer thread\");\n      timerThread.join();\n  \n      if (Worker::getCountThreads() > 0)\n      {\n        log_info(\"wait for \" << Worker::getCountThreads() << \" worker threads to stop\");\n        while (Worker::getCountThreads() > 0)\n        {\n          log_debug(\"wait for worker threads to stop; \" << Worker::getCountThreads() << \" left\");\n          usleep(100);\n        }\n      }\n  \n      log_debug(\"destroy listener\");\n      for (listeners_type::iterator it = listeners.begin(); it != listeners.end(); ++it)\n        delete *it;\n      listeners.clear();\n  \n      HttpReply::postRunCleanup();\n      HttpRequest::postRunCleanup();\n  \n      log_info(\"all threads stopped\");\n    }\n}"
  },
  {
    "function_name": "sslListen",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "158-169",
    "snippet": "void Tntnet::sslListen(const std::string& certificateFile, const std::string& keyFile, const std::string& ip, unsigned short int port)\n  {\n#ifdef USE_SSL\n    log_debug(\"listen on ip \" << ip << \" port \" << port << \" (ssl)\");\n    ListenerBase* listener = new Ssllistener(*this, certificateFile.c_str(),\n        keyFile.c_str(), ip, port, queue);\n    listeners.insert(listener);\n    allListeners.insert(listener);\n#else\n    log_error(\"cannot add ssl listener - ssl is not compiled into tntnet\");\n#endif // USE_SSL\n  }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_error",
          "args": [
            "\"cannot add ssl listener - ssl is not compiled into tntnet\""
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allListeners.insert",
          "args": [
            "listener"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listeners.insert",
          "args": [
            "listener"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keyFile.c_str",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "certificateFile.c_str",
          "args": [],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"listen on ip \" << ip << \" port \" << port << \" (ssl)\""
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::sslListen(const std::string& certificateFile, const std::string& keyFile, const std::string& ip, unsigned short int port)\n    {\n  #ifdef USE_SSL\n      log_debug(\"listen on ip \" << ip << \" port \" << port << \" (ssl)\");\n      ListenerBase* listener = new Ssllistener(*this, certificateFile.c_str(),\n          keyFile.c_str(), ip, port, queue);\n      listeners.insert(listener);\n      allListeners.insert(listener);\n  #else\n      log_error(\"cannot add ssl listener - ssl is not compiled into tntnet\");\n  #endif // USE_SSL\n    }\n}"
  },
  {
    "function_name": "listen",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "150-156",
    "snippet": "void Tntnet::listen(const std::string& ip, unsigned short int port)\n  {\n    log_debug(\"listen on ip \" << ip << \" port \" << port);\n    ListenerBase* listener = new Listener(*this, ip, port, queue);\n    listeners.insert(listener);\n    allListeners.insert(listener);\n  }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "allListeners.insert",
          "args": [
            "listener"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "listeners.insert",
          "args": [
            "listener"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"listen on ip \" << ip << \" port \" << port"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::listen(const std::string& ip, unsigned short int port)\n    {\n      log_debug(\"listen on ip \" << ip << \" port \" << port);\n      ListenerBase* listener = new Listener(*this, ip, port, queue);\n      listeners.insert(listener);\n      allListeners.insert(listener);\n    }\n}"
  },
  {
    "function_name": "init",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "92-148",
    "snippet": "void Tntnet::init(const TntConfig& config)\n  {\n    minthreads = config.minThreads;\n    maxthreads = config.maxThreads;\n\n    queue.setCapacity(config.queueSize);\n\n    for (TntConfig::EnvironmentType::const_iterator it = config.environment.begin(); it != config.environment.end(); ++it)\n    {\n      std::string name = it->first;\n      std::string value = it->second;\n#ifdef HAVE_SETENV\n      log_debug(\"setenv \" << name << \"=\\\"\" << value << '\"');\n      ::setenv(name.c_str(), value.c_str(), 1);\n#else\n      char* env = new char[name.size() + value.size() + 2];\n      name.copy(env, name.size());\n      env[name.size()] = '=';\n      value.copy(env + name.size() + 1, value.size());\n      env[name.size() + value.size() + 1] = '\\0';\n\n      log_debug(\"putenv(\" << env << ')');\n      ::putenv(env);\n#endif\n    }\n\n    configureDispatcher(dispatcher);\n\n    // initialize listeners\n    for (TntConfig::ListenersType::const_iterator it = config.listeners.begin(); it != config.listeners.end(); ++it)\n    {\n      listen(it->ip, it->port);\n    }\n\n#ifdef USE_SSL\n\n    for (TntConfig::SslListenersType::const_iterator it = config.ssllisteners.begin(); it != config.ssllisteners.end(); ++it)\n    {\n      sslListen(it->certificate, it->key, it->ip, it->port);\n    }\n\n#else\n\n    if (!config.ssllisteners.empty())\n      throwRuntimeError(\"SslListen is configured but SSL is not compiled into this tntnet\");\n\n#endif // USE_SSL\n\n#ifdef WITH_STRESSJOB\n    std::string stressJob = config.getValue(\"StressJob\");\n    if (!stressJob.empty())\n    {\n      log_debug(\"create stress job for url \\\"\" << stressJob << '\"');\n      queue.put(new StressJob(*this, stressJob));\n    }\n#endif\n  }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "queue.put",
          "args": [
            "new StressJob(*this, stressJob)"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"create stress job for url \\\"\" << stressJob << '\"'"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stressJob.empty",
          "args": [],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "config.getValue",
          "args": [
            "\"StressJob\""
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "throwRuntimeError",
          "args": [
            "\"SslListen is configured but SSL is not compiled into this tntnet\""
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "throwRuntimeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/util.cpp",
          "lines": "39-42",
          "snippet": "void throwRuntimeError(const char* msg)\n  {\n    throwRuntimeError(std::string(msg));\n  }",
          "includes": [
            "#include <stdexcept>",
            "#include <tnt/util.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdexcept>\n#include <tnt/util.h>\n\nvoid throwRuntimeError(const char* msg)\n  {\n    throwRuntimeError(std::string(msg));\n  }"
        }
      },
      {
        "call_info": {
          "callee": "sslListen",
          "args": [
            "it->certificate",
            "it->key",
            "it->ip",
            "it->port"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "sslListen",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
          "lines": "158-169",
          "snippet": "void Tntnet::sslListen(const std::string& certificateFile, const std::string& keyFile, const std::string& ip, unsigned short int port)\n  {\n#ifdef USE_SSL\n    log_debug(\"listen on ip \" << ip << \" port \" << port << \" (ssl)\");\n    ListenerBase* listener = new Ssllistener(*this, certificateFile.c_str(),\n        keyFile.c_str(), ip, port, queue);\n    listeners.insert(listener);\n    allListeners.insert(listener);\n#else\n    log_error(\"cannot add ssl listener - ssl is not compiled into tntnet\");\n#endif // USE_SSL\n  }",
          "includes": [
            "#include <config.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/net/tcpstream.h>",
            "#include \"tnt/stressjob.h\"",
            "#include \"tnt/util.h\"",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/sessionscope.h\"",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/http.h\"",
            "#include \"tnt/listener.h\"",
            "#include \"tnt/worker.h\"",
            "#include \"tnt/tntnet.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::sslListen(const std::string& certificateFile, const std::string& keyFile, const std::string& ip, unsigned short int port)\n    {\n  #ifdef USE_SSL\n      log_debug(\"listen on ip \" << ip << \" port \" << port << \" (ssl)\");\n      ListenerBase* listener = new Ssllistener(*this, certificateFile.c_str(),\n          keyFile.c_str(), ip, port, queue);\n      listeners.insert(listener);\n      allListeners.insert(listener);\n  #else\n      log_error(\"cannot add ssl listener - ssl is not compiled into tntnet\");\n  #endif // USE_SSL\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "config.ssllisteners.end",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "config.ssllisteners.begin",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "listen",
          "args": [
            "it->ip",
            "it->port"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "listen",
          "container": "Tntnet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
          "lines": "150-156",
          "snippet": "void Tntnet::listen(const std::string& ip, unsigned short int port)\n  {\n    log_debug(\"listen on ip \" << ip << \" port \" << port);\n    ListenerBase* listener = new Listener(*this, ip, port, queue);\n    listeners.insert(listener);\n    allListeners.insert(listener);\n  }",
          "includes": [
            "#include <config.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/net/tcpstream.h>",
            "#include \"tnt/stressjob.h\"",
            "#include \"tnt/util.h\"",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/sessionscope.h\"",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/http.h\"",
            "#include \"tnt/listener.h\"",
            "#include \"tnt/worker.h\"",
            "#include \"tnt/tntnet.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::listen(const std::string& ip, unsigned short int port)\n    {\n      log_debug(\"listen on ip \" << ip << \" port \" << port);\n      ListenerBase* listener = new Listener(*this, ip, port, queue);\n      listeners.insert(listener);\n      allListeners.insert(listener);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "configureDispatcher",
          "args": [
            "dispatcher"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "configureDispatcher",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
          "lines": "56-67",
          "snippet": "void configureDispatcher(Dispatcher& dis)\n    {\n      const TntConfig::MappingsType& mappings = TntConfig::it().mappings;\n      for (TntConfig::MappingsType::const_iterator it = mappings.begin(); it != mappings.end(); ++it)\n      {\n        Maptarget ci(it->target);\n        if (!it->pathinfo.empty())\n          ci.setPathInfo(it->pathinfo);\n        ci.setArgs(it->args);\n        dis.addUrlMapEntry(it->vhost, it->url, it->method, it->ssl, ci);\n      }\n    }",
          "includes": [
            "#include <config.h>",
            "#include <signal.h>",
            "#include <unistd.h>",
            "#include <cxxtools/log.h>",
            "#include <cxxtools/net/tcpstream.h>",
            "#include \"tnt/stressjob.h\"",
            "#include \"tnt/util.h\"",
            "#include \"tnt/tntconfig.h\"",
            "#include \"tnt/sessionscope.h\"",
            "#include \"tnt/httpreply.h\"",
            "#include \"tnt/http.h\"",
            "#include \"tnt/listener.h\"",
            "#include \"tnt/worker.h\"",
            "#include \"tnt/tntnet.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nvoid configureDispatcher(Dispatcher& dis)\n    {\n      const TntConfig::MappingsType& mappings = TntConfig::it().mappings;\n      for (TntConfig::MappingsType::const_iterator it = mappings.begin(); it != mappings.end(); ++it)\n      {\n        Maptarget ci(it->target);\n        if (!it->pathinfo.empty())\n          ci.setPathInfo(it->pathinfo);\n        ci.setArgs(it->args);\n        dis.addUrlMapEntry(it->vhost, it->url, it->method, it->ssl, ci);\n      }\n    }"
        }
      },
      {
        "call_info": {
          "callee": "::putenv",
          "args": [
            "env"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"putenv(\" << env << ')'"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.size",
          "args": [],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "155-155",
          "snippet": "size_type size() const  { return end - start; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  size_type size() const  { return end - start; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.copy",
          "args": [
            "env + name.size() + 1",
            "value.size()"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.copy",
          "args": [
            "env",
            "name.size()"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "::setenv",
          "args": [
            "name.c_str()",
            "value.c_str()",
            "1"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.c_str",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "\"setenv \" << name << \"=\\\"\" << value << '\"'"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue.setCapacity",
          "args": [
            "config.queueSize"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "setCapacity",
          "container": "Jobqueue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/job.h",
          "lines": "126-127",
          "snippet": "void setCapacity(unsigned c)\n        { capacity = c; }",
          "includes": [
            "#include <cxxtools/smartptr.h>",
            "#include <cxxtools/refcounted.h>",
            "#include <cxxtools/condition.h>",
            "#include <cxxtools/mutex.h>",
            "#include <tnt/httpparser.h>",
            "#include <tnt/httprequest.h>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cxxtools/smartptr.h>\n#include <cxxtools/refcounted.h>\n#include <cxxtools/condition.h>\n#include <cxxtools/mutex.h>\n#include <tnt/httpparser.h>\n#include <tnt/httprequest.h>\n#include <deque>\n\nJobqueue {\n  void setCapacity(unsigned c)\n          { capacity = c; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  void Tntnet::init(const TntConfig& config)\n    {\n      minthreads = config.minThreads;\n      maxthreads = config.maxThreads;\n  \n      queue.setCapacity(config.queueSize);\n  \n      for (TntConfig::EnvironmentType::const_iterator it = config.environment.begin(); it != config.environment.end(); ++it)\n      {\n        std::string name = it->first;\n        std::string value = it->second;\n  #ifdef HAVE_SETENV\n        log_debug(\"setenv \" << name << \"=\\\"\" << value << '\"');\n        ::setenv(name.c_str(), value.c_str(), 1);\n  #else\n        char* env = new char[name.size() + value.size() + 2];\n        name.copy(env, name.size());\n        env[name.size()] = '=';\n        value.copy(env + name.size() + 1, value.size());\n        env[name.size() + value.size() + 1] = '\\0';\n  \n        log_debug(\"putenv(\" << env << ')');\n        ::putenv(env);\n  #endif\n      }\n  \n      configureDispatcher(dispatcher);\n  \n      // initialize listeners\n      for (TntConfig::ListenersType::const_iterator it = config.listeners.begin(); it != config.listeners.end(); ++it)\n      {\n        listen(it->ip, it->port);\n      }\n  \n  #ifdef USE_SSL\n  \n      for (TntConfig::SslListenersType::const_iterator it = config.ssllisteners.begin(); it != config.ssllisteners.end(); ++it)\n      {\n        sslListen(it->certificate, it->key, it->ip, it->port);\n      }\n  \n  #else\n  \n      if (!config.ssllisteners.empty())\n        throwRuntimeError(\"SslListen is configured but SSL is not compiled into this tntnet\");\n  \n  #endif // USE_SSL\n  \n  #ifdef WITH_STRESSJOB\n      std::string stressJob = config.getValue(\"StressJob\");\n      if (!stressJob.empty())\n      {\n        log_debug(\"create stress job for url \\\"\" << stressJob << '\"');\n        queue.put(new StressJob(*this, stressJob));\n      }\n  #endif\n    }\n}"
  },
  {
    "function_name": "Tntnet",
    "container": "Tntnet",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "78-83",
    "snippet": "Tntnet::Tntnet()\n    : minthreads(TntConfig::it().minThreads),\n      maxthreads(TntConfig::it().maxThreads),\n      pollerthread(cxxtools::callable(poller, &Poller::run)),\n      poller(queue)\n  { }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "cxxtools::callable",
          "args": [
            "poller",
            "&Poller::run"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nTntnet {\n  Tntnet::Tntnet()\n      : minthreads(TntConfig::it().minThreads),\n        maxthreads(TntConfig::it().maxThreads),\n        pollerthread(cxxtools::callable(poller, &Poller::run)),\n        poller(queue)\n    { }\n}"
  },
  {
    "function_name": "configureDispatcher",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tntnet.cpp",
    "lines": "56-67",
    "snippet": "void configureDispatcher(Dispatcher& dis)\n    {\n      const TntConfig::MappingsType& mappings = TntConfig::it().mappings;\n      for (TntConfig::MappingsType::const_iterator it = mappings.begin(); it != mappings.end(); ++it)\n      {\n        Maptarget ci(it->target);\n        if (!it->pathinfo.empty())\n          ci.setPathInfo(it->pathinfo);\n        ci.setArgs(it->args);\n        dis.addUrlMapEntry(it->vhost, it->url, it->method, it->ssl, ci);\n      }\n    }",
    "includes": [
      "#include <config.h>",
      "#include <signal.h>",
      "#include <unistd.h>",
      "#include <cxxtools/log.h>",
      "#include <cxxtools/net/tcpstream.h>",
      "#include \"tnt/stressjob.h\"",
      "#include \"tnt/util.h\"",
      "#include \"tnt/tntconfig.h\"",
      "#include \"tnt/sessionscope.h\"",
      "#include \"tnt/httpreply.h\"",
      "#include \"tnt/http.h\"",
      "#include \"tnt/listener.h\"",
      "#include \"tnt/worker.h\"",
      "#include \"tnt/tntnet.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "dis.addUrlMapEntry",
          "args": [
            "it->vhost",
            "it->url",
            "it->method",
            "it->ssl",
            "ci"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ci.setArgs",
          "args": [
            "it->args"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "setArgs",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "156-156",
          "snippet": "void setArgs(const args_type& a)             { args = a; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setArgs(const args_type& a)             { args = a; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ci.setPathInfo",
          "args": [
            "it->pathinfo"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "setPathInfo",
          "container": "HttpRequest",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/httprequest.h",
          "lines": "153-153",
          "snippet": "void setPathInfo(const std::string& p)       { pathinfo = p; }",
          "includes": [
            "#include <cstring>",
            "#include <string>",
            "#include <cxxtools/atomicity.h>",
            "#include <map>",
            "#include <locale>",
            "#include <tnt/threadcontext.h>",
            "#include <tnt/scope.h>",
            "#include <tnt/query_params.h>",
            "#include <tnt/encoding.h>",
            "#include <tnt/cookie.h>",
            "#include <tnt/multipart.h>",
            "#include <tnt/contenttype.h>",
            "#include <tnt/socketif.h>",
            "#include <tnt/httpheader.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <string>\n#include <cxxtools/atomicity.h>\n#include <map>\n#include <locale>\n#include <tnt/threadcontext.h>\n#include <tnt/scope.h>\n#include <tnt/query_params.h>\n#include <tnt/encoding.h>\n#include <tnt/cookie.h>\n#include <tnt/multipart.h>\n#include <tnt/contenttype.h>\n#include <tnt/socketif.h>\n#include <tnt/httpheader.h>\n#include <tnt/httpmessage.h>\n\nHttpRequest {\n  void setPathInfo(const std::string& p)       { pathinfo = p; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "it->pathinfo.empty",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "Pstr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/httpmessage.cpp",
          "lines": "156-156",
          "snippet": "bool empty() const      { return start == end; }",
          "includes": [
            "#include <stdio.h>",
            "#include <sstream>",
            "#include <list>",
            "#include <cxxtools/mutex.h>",
            "#include <cxxtools/log.h>",
            "#include <tnt/httpmessage.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <sstream>\n#include <list>\n#include <cxxtools/mutex.h>\n#include <cxxtools/log.h>\n#include <tnt/httpmessage.h>\n\nPstr {\n  bool empty() const      { return start == end; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mappings.end",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "DeflateStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/deflatestream.cpp",
          "lines": "183-187",
          "snippet": "void DeflateStream::end()\n  {\n    if (streambuf.end() != 0)\n      setstate(failbit);\n  }",
          "includes": [
            "#include <string.h>",
            "#include <sstream>",
            "#include <cxxtools/log.h>",
            "#include \"tnt/deflatestream.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <sstream>\n#include <cxxtools/log.h>\n#include \"tnt/deflatestream.h\"\n\nDeflateStream {\n  void DeflateStream::end()\n    {\n      if (streambuf.end() != 0)\n        setstate(failbit);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mappings.begin",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TntConfig::it",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <config.h>\n#include <signal.h>\n#include <unistd.h>\n#include <cxxtools/log.h>\n#include <cxxtools/net/tcpstream.h>\n#include \"tnt/stressjob.h\"\n#include \"tnt/util.h\"\n#include \"tnt/tntconfig.h\"\n#include \"tnt/sessionscope.h\"\n#include \"tnt/httpreply.h\"\n#include \"tnt/http.h\"\n#include \"tnt/listener.h\"\n#include \"tnt/worker.h\"\n#include \"tnt/tntnet.h\"\n\nvoid configureDispatcher(Dispatcher& dis)\n    {\n      const TntConfig::MappingsType& mappings = TntConfig::it().mappings;\n      for (TntConfig::MappingsType::const_iterator it = mappings.begin(); it != mappings.end(); ++it)\n      {\n        Maptarget ci(it->target);\n        if (!it->pathinfo.empty())\n          ci.setPathInfo(it->pathinfo);\n        ci.setArgs(it->args);\n        dis.addUrlMapEntry(it->vhost, it->url, it->method, it->ssl, ci);\n      }\n    }"
  }
]