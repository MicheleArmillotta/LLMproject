[
  {
    "function_name": "Messageheader::onField",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
    "lines": "128-132",
    "snippet": "Messageheader::return_type Messageheader::onField(const char* name, const char* value)\n  {\n    log_debug(name << ' ' << value);\n    return OK;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include <stdexcept>",
      "#include <cxxtools/log.h>",
      "#include <tnt/messageheaderparser.h>",
      "#include <tnt/messageheader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "log_debug",
          "args": [
            "name << ' ' << value"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader::return_type Messageheader::onField(const char* name, const char* value)\n  {\n    log_debug(name << ' ' << value);\n    return OK;\n  }"
  },
  {
    "function_name": "Messageheader::setHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
    "lines": "101-126",
    "snippet": "void Messageheader::setHeader(const char* key, const char* value, bool replace)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    if (replace)\n      removeHeader(key);\n\n    char* p = getEnd();\n\n    size_t lk = std::strlen(key);     // length of key\n    size_t lk2 = key[lk-1] == ':' ? lk + 1 : lk + 2;  // length of key including trailing ':' and terminator\n    size_t lv = std::strlen(value);   // length of value\n\n    if (p - rawdata + lk2 + lv + 3 > MAXHEADERSIZE)\n      throw std::runtime_error(\"message header too big\");\n\n    std::strcpy(p, key);   // copy key\n    p += lk2;\n    *(p - 2) = ':';        // make sure, key is prepended by ':'\n    *(p - 1) = '\\0';\n    std::strcpy(p, value); // copy value\n    p[lv + 1] = '\\0';      // put new message end marker in place\n\n    endOffset = (p + lv + 1) - rawdata;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include <stdexcept>",
      "#include <cxxtools/log.h>",
      "#include <tnt/messageheaderparser.h>",
      "#include <tnt/messageheader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::strcpy",
          "args": [
            "p",
            "value"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::strcpy",
          "args": [
            "p",
            "key"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"message header too big\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::strlen",
          "args": [
            "value"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::strlen",
          "args": [
            "key"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getEnd",
          "args": [],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "removeHeader",
          "args": [
            "key"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "Messageheader::removeHeader",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "51-79",
          "snippet": "void Messageheader::removeHeader(const char* key)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    char* p = getEnd();\n\n    const_iterator it = begin();\n    while (it != end())\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n      {\n        unsigned slen = it->second - it->first + std::strlen(it->second) + 1;\n\n        std::memmove(\n            const_cast<char*>(it->first),\n            it->first + slen,\n            p - it->first + slen);\n\n        p -= slen;\n\n        it.fixup();\n      }\n      else\n        ++it;\n    }\n\n    endOffset = p - rawdata;\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nvoid Messageheader::removeHeader(const char* key)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    char* p = getEnd();\n\n    const_iterator it = begin();\n    while (it != end())\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n      {\n        unsigned slen = it->second - it->first + std::strlen(it->second) + 1;\n\n        std::memmove(\n            const_cast<char*>(it->first),\n            it->first + slen,\n            p - it->first + slen);\n\n        p -= slen;\n\n        it.fixup();\n      }\n      else\n        ++it;\n    }\n\n    endOffset = p - rawdata;\n  }"
        }
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"empty key not allowed in messageheader\""
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nvoid Messageheader::setHeader(const char* key, const char* value, bool replace)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    if (replace)\n      removeHeader(key);\n\n    char* p = getEnd();\n\n    size_t lk = std::strlen(key);     // length of key\n    size_t lk2 = key[lk-1] == ':' ? lk + 1 : lk + 2;  // length of key including trailing ':' and terminator\n    size_t lv = std::strlen(value);   // length of value\n\n    if (p - rawdata + lk2 + lv + 3 > MAXHEADERSIZE)\n      throw std::runtime_error(\"message header too big\");\n\n    std::strcpy(p, key);   // copy key\n    p += lk2;\n    *(p - 2) = ':';        // make sure, key is prepended by ':'\n    *(p - 1) = '\\0';\n    std::strcpy(p, value); // copy value\n    p[lv + 1] = '\\0';      // put new message end marker in place\n\n    endOffset = (p + lv + 1) - rawdata;\n  }"
  },
  {
    "function_name": "Messageheader::clear",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
    "lines": "92-99",
    "snippet": "void Messageheader::clear()\n  {\n#ifdef DEBUG\n    std::memset(rawdata, '\\xfe', sizeof(rawdata));\n#endif\n    rawdata[0] = rawdata[1] = '\\0';\n    endOffset = 0;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include <stdexcept>",
      "#include <cxxtools/log.h>",
      "#include <tnt/messageheaderparser.h>",
      "#include <tnt/messageheader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::memset",
          "args": [
            "rawdata",
            "'\\xfe'",
            "sizeof(rawdata)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nvoid Messageheader::clear()\n  {\n#ifdef DEBUG\n    std::memset(rawdata, '\\xfe', sizeof(rawdata));\n#endif\n    rawdata[0] = rawdata[1] = '\\0';\n    endOffset = 0;\n  }"
  },
  {
    "function_name": "Messageheader::find",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
    "lines": "81-90",
    "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include <stdexcept>",
      "#include <cxxtools/log.h>",
      "#include <tnt/messageheaderparser.h>",
      "#include <tnt/messageheader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "StringCompareIgnoreCase<const char*>",
          "args": [
            "key",
            "it->first"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "StringCompareIgnoreCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/stringlessignorecase.h",
          "lines": "66-69",
          "snippet": "inline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }",
          "includes": [
            "#include <cctype>",
            "#include <functional>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cctype>\n#include <functional>\n#include <string>\n\ninline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }"
  },
  {
    "function_name": "Messageheader::removeHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
    "lines": "51-79",
    "snippet": "void Messageheader::removeHeader(const char* key)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    char* p = getEnd();\n\n    const_iterator it = begin();\n    while (it != end())\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n      {\n        unsigned slen = it->second - it->first + std::strlen(it->second) + 1;\n\n        std::memmove(\n            const_cast<char*>(it->first),\n            it->first + slen,\n            p - it->first + slen);\n\n        p -= slen;\n\n        it.fixup();\n      }\n      else\n        ++it;\n    }\n\n    endOffset = p - rawdata;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include <stdexcept>",
      "#include <cxxtools/log.h>",
      "#include <tnt/messageheaderparser.h>",
      "#include <tnt/messageheader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "it.fixup",
          "args": [],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "fixup",
          "container": "Messageheader::const_iterator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "64-70",
          "snippet": "void fixup()\n          {\n            if (*current_value.first)\n              current_value.second = current_value.first + std::strlen(current_value.first) + 1;\n            else\n              current_value.first = current_value.second = 0;\n          }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator {\n    void fixup()\n              {\n                if (*current_value.first)\n                  current_value.second = current_value.first + std::strlen(current_value.first) + 1;\n                else\n                  current_value.first = current_value.second = 0;\n              }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::memmove",
          "args": [
            "const_cast<char*>(it->first)",
            "it->first + slen",
            "p - it->first + slen"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<char*>",
          "args": [
            "it->first"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::strlen",
          "args": [
            "it->second"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "StringCompareIgnoreCase<const char*>",
          "args": [
            "key",
            "it->first"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "StringCompareIgnoreCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/stringlessignorecase.h",
          "lines": "66-69",
          "snippet": "inline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }",
          "includes": [
            "#include <cctype>",
            "#include <functional>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cctype>\n#include <functional>\n#include <string>\n\ninline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "128-129",
          "snippet": "const_iterator begin() const\n        { return const_iterator(rawdata); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator begin() const\n          { return const_iterator(rawdata); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getEnd",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::runtime_error",
          "args": [
            "\"empty key not allowed in messageheader\""
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nvoid Messageheader::removeHeader(const char* key)\n  {\n    if (!*key)\n      throw std::runtime_error(\"empty key not allowed in messageheader\");\n\n    char* p = getEnd();\n\n    const_iterator it = begin();\n    while (it != end())\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n      {\n        unsigned slen = it->second - it->first + std::strlen(it->second) + 1;\n\n        std::memmove(\n            const_cast<char*>(it->first),\n            it->first + slen,\n            p - it->first + slen);\n\n        p -= slen;\n\n        it.fixup();\n      }\n      else\n        ++it;\n    }\n\n    endOffset = p - rawdata;\n  }"
  },
  {
    "function_name": "Messageheader::compareHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
    "lines": "43-49",
    "snippet": "bool Messageheader::compareHeader(const char* key, const char* value) const\n  {\n    const_iterator it = find(key);\n    return it == end() ? false\n                       : tnt::StringCompareIgnoreCase<const char*>(\n                           it->second, value) == 0;\n  }",
    "includes": [
      "#include <cstring>",
      "#include <tnt/stringlessignorecase.h>",
      "#include <stdexcept>",
      "#include <cxxtools/log.h>",
      "#include <tnt/messageheaderparser.h>",
      "#include <tnt/messageheader.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tnt::StringCompareIgnoreCase<const char*>",
          "args": [
            "it->second",
            "value"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "StringCompareIgnoreCase",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/stringlessignorecase.h",
          "lines": "66-69",
          "snippet": "inline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }",
          "includes": [
            "#include <cctype>",
            "#include <functional>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cctype>\n#include <functional>\n#include <string>\n\ninline int StringCompareIgnoreCase(const std::string& s1, const std::string& s2)\n  {\n    return StringCompareIgnoreCase<std::string>(s1, s2);\n  }"
        }
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "Messageheader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/tnt/messageheader.h",
          "lines": "130-131",
          "snippet": "const_iterator end() const\n        { return const_iterator(); }",
          "includes": [
            "#include <utility>",
            "#include <cstring>",
            "#include <string>",
            "#include <istream>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <utility>\n#include <cstring>\n#include <string>\n#include <istream>\n\nMessageheader {\n  const_iterator end() const\n          { return const_iterator(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "find",
          "args": [
            "key"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "Messageheader::find",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2013-7299/repo/framework/common/messageheader.cpp",
          "lines": "81-90",
          "snippet": "Messageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }",
          "includes": [
            "#include <cstring>",
            "#include <tnt/stringlessignorecase.h>",
            "#include <stdexcept>",
            "#include <cxxtools/log.h>",
            "#include <tnt/messageheaderparser.h>",
            "#include <tnt/messageheader.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nMessageheader::const_iterator Messageheader::find(const char* key) const\n  {\n    for (const_iterator it = begin(); it != end(); ++it)\n    {\n      if (StringCompareIgnoreCase<const char*>(key, it->first) == 0)\n        return it;\n    }\n\n    return end();\n  }"
        }
      }
    ],
    "contextual_snippet": "#include <cstring>\n#include <tnt/stringlessignorecase.h>\n#include <stdexcept>\n#include <cxxtools/log.h>\n#include <tnt/messageheaderparser.h>\n#include <tnt/messageheader.h>\n\nbool Messageheader::compareHeader(const char* key, const char* value) const\n  {\n    const_iterator it = find(key);\n    return it == end() ? false\n                       : tnt::StringCompareIgnoreCase<const char*>(\n                           it->second, value) == 0;\n  }"
  }
]