[
  {
    "function_name": "afGetVirtualPCMMapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/pcm.cpp",
    "lines": "154-172",
    "snippet": "void afGetVirtualPCMMapping (AFfilehandle file, int trackid,\n\tdouble *slope, double *intercept, double *minClip, double *maxClip)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (slope)\n\t\t*slope = track->v.pcm.slope;\n\tif (intercept)\n\t\t*intercept = track->v.pcm.intercept;\n\tif (minClip)\n\t\t*minClip = track->v.pcm.minClip;\n\tif (maxClip)\n\t\t*maxClip = track->v.pcm.maxClip;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"pcm.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"pcm.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid afGetVirtualPCMMapping (AFfilehandle file, int trackid,\n\tdouble *slope, double *intercept, double *minClip, double *maxClip)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (slope)\n\t\t*slope = track->v.pcm.slope;\n\tif (intercept)\n\t\t*intercept = track->v.pcm.intercept;\n\tif (minClip)\n\t\t*minClip = track->v.pcm.minClip;\n\tif (maxClip)\n\t\t*maxClip = track->v.pcm.maxClip;\n}"
  },
  {
    "function_name": "afGetPCMMapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/pcm.cpp",
    "lines": "134-152",
    "snippet": "void afGetPCMMapping (AFfilehandle file, int trackid,\n\tdouble *slope, double *intercept, double *minClip, double *maxClip)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (slope)\n\t\t*slope = track->f.pcm.slope;\n\tif (intercept)\n\t\t*intercept = track->f.pcm.intercept;\n\tif (minClip)\n\t\t*minClip = track->f.pcm.minClip;\n\tif (maxClip)\n\t\t*maxClip = track->f.pcm.maxClip;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"pcm.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"pcm.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid afGetPCMMapping (AFfilehandle file, int trackid,\n\tdouble *slope, double *intercept, double *minClip, double *maxClip)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (slope)\n\t\t*slope = track->f.pcm.slope;\n\tif (intercept)\n\t\t*intercept = track->f.pcm.intercept;\n\tif (minClip)\n\t\t*minClip = track->f.pcm.minClip;\n\tif (maxClip)\n\t\t*maxClip = track->f.pcm.maxClip;\n}"
  },
  {
    "function_name": "afSetTrackPCMMapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/pcm.cpp",
    "lines": "103-132",
    "snippet": "int afSetTrackPCMMapping (AFfilehandle file, int trackid,\n\tdouble slope, double intercept, double minClip, double maxClip)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\t/*\n\t\tNOTE: this is highly unusual: we don't ordinarily\n\t\tchange track.f after the file is opened.\n\n\t\tPCM mapping is the exception because this information\n\t\tis not encoded in sound files' headers using today's\n\t\tformats, so the user will probably want to set this\n\t\tinformation on a regular basis.  The defaults may or\n\t\tmay not be what the user wants.\n\t*/\n\n\ttrack->f.pcm.slope = slope;\n\ttrack->f.pcm.intercept = intercept;\n\ttrack->f.pcm.minClip = minClip;\n\ttrack->f.pcm.maxClip = maxClip;\n\n\ttrack->ms->setDirty();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"pcm.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->ms->setDirty",
          "args": [],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "setDirty",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.h",
          "lines": "40-40",
          "snippet": "void setDirty() { m_isDirty = true; }",
          "includes": [
            "#include <vector>",
            "#include \"afinternal.h\"",
            "#include \"Shared.h\"",
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"afinternal.h\"\n#include \"Shared.h\"\n#include \"Module.h\"\n\nModuleState {\n  void setDirty() { m_isDirty = true; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"pcm.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nint afSetTrackPCMMapping (AFfilehandle file, int trackid,\n\tdouble slope, double intercept, double minClip, double maxClip)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\t/*\n\t\tNOTE: this is highly unusual: we don't ordinarily\n\t\tchange track.f after the file is opened.\n\n\t\tPCM mapping is the exception because this information\n\t\tis not encoded in sound files' headers using today's\n\t\tformats, so the user will probably want to set this\n\t\tinformation on a regular basis.  The defaults may or\n\t\tmay not be what the user wants.\n\t*/\n\n\ttrack->f.pcm.slope = slope;\n\ttrack->f.pcm.intercept = intercept;\n\ttrack->f.pcm.minClip = minClip;\n\ttrack->f.pcm.maxClip = maxClip;\n\n\ttrack->ms->setDirty();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "afSetVirtualPCMMapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/pcm.cpp",
    "lines": "83-101",
    "snippet": "int afSetVirtualPCMMapping (AFfilehandle file, int trackid,\n\tdouble slope, double intercept, double minClip, double maxClip)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\ttrack->v.pcm.slope = slope;\n\ttrack->v.pcm.intercept = intercept;\n\ttrack->v.pcm.minClip = minClip;\n\ttrack->v.pcm.maxClip = maxClip;\n\n\ttrack->ms->setDirty();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"pcm.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->ms->setDirty",
          "args": [],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "setDirty",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.h",
          "lines": "40-40",
          "snippet": "void setDirty() { m_isDirty = true; }",
          "includes": [
            "#include <vector>",
            "#include \"afinternal.h\"",
            "#include \"Shared.h\"",
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"afinternal.h\"\n#include \"Shared.h\"\n#include \"Module.h\"\n\nModuleState {\n  void setDirty() { m_isDirty = true; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"pcm.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nint afSetVirtualPCMMapping (AFfilehandle file, int trackid,\n\tdouble slope, double intercept, double minClip, double maxClip)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\ttrack->v.pcm.slope = slope;\n\ttrack->v.pcm.intercept = intercept;\n\ttrack->v.pcm.minClip = minClip;\n\ttrack->v.pcm.maxClip = maxClip;\n\n\ttrack->ms->setDirty();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "afInitPCMMapping",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/pcm.cpp",
    "lines": "67-81",
    "snippet": "void afInitPCMMapping (AFfilesetup setup, int trackid,\n\tdouble slope, double intercept, double minClip, double maxClip)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\ttrack->f.pcm.slope = slope;\n\ttrack->f.pcm.intercept = intercept;\n\ttrack->f.pcm.minClip = minClip;\n\ttrack->f.pcm.maxClip = maxClip;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"pcm.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"pcm.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid afInitPCMMapping (AFfilesetup setup, int trackid,\n\tdouble slope, double intercept, double minClip, double maxClip)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\ttrack->f.pcm.slope = slope;\n\ttrack->f.pcm.intercept = intercept;\n\ttrack->f.pcm.minClip = minClip;\n\ttrack->f.pcm.maxClip = maxClip;\n}"
  }
]