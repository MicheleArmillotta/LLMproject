[
  {
    "function_name": "computeTotalFileFrames",
    "container": "Track",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Track.cpp",
    "lines": "173-177",
    "snippet": "void Track::computeTotalFileFrames()\n{\n\tif (f.bytesPerPacket && f.framesPerPacket)\n\t\ttotalfframes = (data_size / f.bytesPerPacket) * f.framesPerPacket;\n}",
    "includes": [
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"PacketTable.h\"",
      "#include \"Marker.h\"",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <assert.h>",
      "#include \"Track.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"PacketTable.h\"\n#include \"Marker.h\"\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <assert.h>\n#include \"Track.h\"\n#include \"config.h\"\n\nTrack {\n  void Track::computeTotalFileFrames()\n  {\n  \tif (f.bytesPerPacket && f.framesPerPacket)\n  \t\ttotalfframes = (data_size / f.bytesPerPacket) * f.framesPerPacket;\n  }\n}"
  },
  {
    "function_name": "copyMarkers",
    "container": "Track",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Track.cpp",
    "lines": "145-171",
    "snippet": "status Track::copyMarkers(TrackSetup *setup)\n{\n\tif ((markerCount = setup->markerCount) == 0)\n\t{\n\t\tmarkers = NULL;\n\t\treturn AF_SUCCEED;\n\t}\n\n\tmarkers = _af_marker_new(markerCount);\n\tif (!markers)\n\t\treturn AF_FAIL;\n\n\tfor (int i=0; i<markerCount; i++)\n\t{\n\t\tmarkers[i].id = setup->markers[i].id;\n\t\tmarkers[i].name = _af_strdup(setup->markers[i].name);\n\t\tif (!markers[i].name)\n\t\t\treturn AF_FAIL;\n\n\t\tmarkers[i].comment = _af_strdup(setup->markers[i].comment);\n\t\tif (!markers[i].comment)\n\t\t\treturn AF_FAIL;\n\t\tmarkers[i].position = 0;\n\t}\n\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"PacketTable.h\"",
      "#include \"Marker.h\"",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <assert.h>",
      "#include \"Track.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_strdup",
          "args": [
            "setup->markers[i].comment"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_strdup",
          "args": [
            "setup->markers[i].name"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_marker_new",
          "args": [
            "markerCount"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"PacketTable.h\"\n#include \"Marker.h\"\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <assert.h>\n#include \"Track.h\"\n#include \"config.h\"\n\nTrack {\n  status Track::copyMarkers(TrackSetup *setup)\n  {\n  \tif ((markerCount = setup->markerCount) == 0)\n  \t{\n  \t\tmarkers = NULL;\n  \t\treturn AF_SUCCEED;\n  \t}\n  \n  \tmarkers = _af_marker_new(markerCount);\n  \tif (!markers)\n  \t\treturn AF_FAIL;\n  \n  \tfor (int i=0; i<markerCount; i++)\n  \t{\n  \t\tmarkers[i].id = setup->markers[i].id;\n  \t\tmarkers[i].name = _af_strdup(setup->markers[i].name);\n  \t\tif (!markers[i].name)\n  \t\t\treturn AF_FAIL;\n  \n  \t\tmarkers[i].comment = _af_strdup(setup->markers[i].comment);\n  \t\tif (!markers[i].comment)\n  \t\t\treturn AF_FAIL;\n  \t\tmarkers[i].position = 0;\n  \t}\n  \n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "print",
    "container": "Track",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Track.cpp",
    "lines": "120-131",
    "snippet": "void Track::print()\n{\n\tfprintf(stderr, \"totalfframes %jd\\n\", (intmax_t) totalfframes);\n\tfprintf(stderr, \"nextfframe %jd\\n\", (intmax_t) nextfframe);\n\tfprintf(stderr, \"frames2ignore %jd\\n\", (intmax_t) frames2ignore);\n\tfprintf(stderr, \"fpos_first_frame %jd\\n\", (intmax_t) fpos_first_frame);\n\tfprintf(stderr, \"fpos_next_frame %jd\\n\", (intmax_t) fpos_next_frame);\n\tfprintf(stderr, \"fpos_after_data %jd\\n\", (intmax_t) fpos_after_data);\n\tfprintf(stderr, \"totalvframes %jd\\n\", (intmax_t) totalvframes);\n\tfprintf(stderr, \"nextvframe %jd\\n\", (intmax_t) nextvframe);\n\tfprintf(stderr, \"data_size %jd\\n\", (intmax_t) data_size);\n}",
    "includes": [
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"PacketTable.h\"",
      "#include \"Marker.h\"",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <assert.h>",
      "#include \"Track.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"data_size %jd\\n\"",
            "(intmax_t) data_size"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"nextvframe %jd\\n\"",
            "(intmax_t) nextvframe"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"totalvframes %jd\\n\"",
            "(intmax_t) totalvframes"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"fpos_after_data %jd\\n\"",
            "(intmax_t) fpos_after_data"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"fpos_next_frame %jd\\n\"",
            "(intmax_t) fpos_next_frame"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"fpos_first_frame %jd\\n\"",
            "(intmax_t) fpos_first_frame"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"frames2ignore %jd\\n\"",
            "(intmax_t) frames2ignore"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"nextfframe %jd\\n\"",
            "(intmax_t) nextfframe"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"totalfframes %jd\\n\"",
            "(intmax_t) totalfframes"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"PacketTable.h\"\n#include \"Marker.h\"\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <assert.h>\n#include \"Track.h\"\n#include \"config.h\"\n\nTrack {\n  void Track::print()\n  {\n  \tfprintf(stderr, \"totalfframes %jd\\n\", (intmax_t) totalfframes);\n  \tfprintf(stderr, \"nextfframe %jd\\n\", (intmax_t) nextfframe);\n  \tfprintf(stderr, \"frames2ignore %jd\\n\", (intmax_t) frames2ignore);\n  \tfprintf(stderr, \"fpos_first_frame %jd\\n\", (intmax_t) fpos_first_frame);\n  \tfprintf(stderr, \"fpos_next_frame %jd\\n\", (intmax_t) fpos_next_frame);\n  \tfprintf(stderr, \"fpos_after_data %jd\\n\", (intmax_t) fpos_after_data);\n  \tfprintf(stderr, \"totalvframes %jd\\n\", (intmax_t) totalvframes);\n  \tfprintf(stderr, \"nextvframe %jd\\n\", (intmax_t) nextvframe);\n  \tfprintf(stderr, \"data_size %jd\\n\", (intmax_t) data_size);\n  }\n}"
  },
  {
    "function_name": "~Track",
    "container": "Track",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Track.cpp",
    "lines": "88-118",
    "snippet": "Track::~Track()\n{\n\tif (f.compressionParams)\n\t{\n\t\tAUpvfree(f.compressionParams);\n\t\tf.compressionParams = NULL;\n\t}\n\n\tif (v.compressionParams)\n\t{\n\t\tAUpvfree(v.compressionParams);\n\t\tv.compressionParams = NULL;\n\t}\n\n\tfree(channelMatrix);\n\tchannelMatrix = NULL;\n\n\tif (markers)\n\t{\n\t\tfor (int j=0; j<markerCount; j++)\n\t\t{\n\t\t\tfree(markers[j].name);\n\t\t\tmarkers[j].name = NULL;\n\t\t\tfree(markers[j].comment);\n\t\t\tmarkers[j].comment = NULL;\n\t\t}\n\n\t\tfree(markers);\n\t\tmarkers = NULL;\n\t}\n}",
    "includes": [
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"PacketTable.h\"",
      "#include \"Marker.h\"",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <assert.h>",
      "#include \"Track.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "markers"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AUpvfree",
          "args": [
            "v.compressionParams"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvfree",
          "args": [
            "f.compressionParams"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"PacketTable.h\"\n#include \"Marker.h\"\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <assert.h>\n#include \"Track.h\"\n#include \"config.h\"\n\nTrack {\n  Track::~Track()\n  {\n  \tif (f.compressionParams)\n  \t{\n  \t\tAUpvfree(f.compressionParams);\n  \t\tf.compressionParams = NULL;\n  \t}\n  \n  \tif (v.compressionParams)\n  \t{\n  \t\tAUpvfree(v.compressionParams);\n  \t\tv.compressionParams = NULL;\n  \t}\n  \n  \tfree(channelMatrix);\n  \tchannelMatrix = NULL;\n  \n  \tif (markers)\n  \t{\n  \t\tfor (int j=0; j<markerCount; j++)\n  \t\t{\n  \t\t\tfree(markers[j].name);\n  \t\t\tmarkers[j].name = NULL;\n  \t\t\tfree(markers[j].comment);\n  \t\t\tmarkers[j].comment = NULL;\n  \t\t}\n  \n  \t\tfree(markers);\n  \t\tmarkers = NULL;\n  \t}\n  }\n}"
  },
  {
    "function_name": "Track",
    "container": "Track",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Track.cpp",
    "lines": "62-86",
    "snippet": "Track::Track()\n{\n\tid = AF_DEFAULT_TRACK;\n\n\tf.compressionParams = NULL;\n\tv.compressionParams = NULL;\n\n\tchannelMatrix = NULL;\n\n\tmarkerCount = 0;\n\tmarkers = NULL;\n\n\thasAESData = false;\n\tmemset(aesData, 0, 24);\n\n\ttotalfframes = 0;\n\tnextfframe = 0;\n\tframes2ignore = 0;\n\tfpos_first_frame = 0;\n\tfpos_next_frame = 0;\n\tfpos_after_data = 0;\n\ttotalvframes = 0;\n\tnextvframe = 0;\n\tdata_size = 0;\n}",
    "includes": [
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"PacketTable.h\"",
      "#include \"Marker.h\"",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <assert.h>",
      "#include \"Track.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "aesData",
            "0",
            "24"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"PacketTable.h\"\n#include \"Marker.h\"\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <assert.h>\n#include \"Track.h\"\n#include \"config.h\"\n\nTrack {\n  Track::Track()\n  {\n  \tid = AF_DEFAULT_TRACK;\n  \n  \tf.compressionParams = NULL;\n  \tv.compressionParams = NULL;\n  \n  \tchannelMatrix = NULL;\n  \n  \tmarkerCount = 0;\n  \tmarkers = NULL;\n  \n  \thasAESData = false;\n  \tmemset(aesData, 0, 24);\n  \n  \ttotalfframes = 0;\n  \tnextfframe = 0;\n  \tframes2ignore = 0;\n  \tfpos_first_frame = 0;\n  \tfpos_next_frame = 0;\n  \tfpos_after_data = 0;\n  \ttotalvframes = 0;\n  \tnextvframe = 0;\n  \tdata_size = 0;\n  }\n}"
  },
  {
    "function_name": "afGetTrackIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Track.cpp",
    "lines": "52-60",
    "snippet": "int afGetTrackIDs (AFfilehandle file, int *trackids)\n{\n\tassert(file);\n\n\tif (trackids != NULL)\n\t\ttrackids[0] = AF_DEFAULT_TRACK;\n\n\treturn 1;\n}",
    "includes": [
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"PacketTable.h\"",
      "#include \"Marker.h\"",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <assert.h>",
      "#include \"Track.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "file"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"PacketTable.h\"\n#include \"Marker.h\"\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <assert.h>\n#include \"Track.h\"\n#include \"config.h\"\n\nint afGetTrackIDs (AFfilehandle file, int *trackids)\n{\n\tassert(file);\n\n\tif (trackids != NULL)\n\t\ttrackids[0] = AF_DEFAULT_TRACK;\n\n\treturn 1;\n}"
  },
  {
    "function_name": "afInitTrackIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Track.cpp",
    "lines": "44-50",
    "snippet": "void afInitTrackIDs (AFfilesetup file, const int *trackids, int trackCount)\n{\n\tassert(file);\n\tassert(trackids);\n\tassert(trackCount == 1);\n\tassert(trackids[0] == AF_DEFAULT_TRACK);\n}",
    "includes": [
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"PacketTable.h\"",
      "#include \"Marker.h\"",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <string.h>",
      "#include <stdio.h>",
      "#include <stddef.h>",
      "#include <assert.h>",
      "#include \"Track.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "trackids[0] == AF_DEFAULT_TRACK"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "trackCount == 1"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "trackids"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "file"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"PacketTable.h\"\n#include \"Marker.h\"\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <string.h>\n#include <stdio.h>\n#include <stddef.h>\n#include <assert.h>\n#include \"Track.h\"\n#include \"config.h\"\n\nvoid afInitTrackIDs (AFfilesetup file, const int *trackids, int trackCount)\n{\n\tassert(file);\n\tassert(trackids);\n\tassert(trackCount == 1);\n\tassert(trackids[0] == AF_DEFAULT_TRACK);\n}"
  }
]