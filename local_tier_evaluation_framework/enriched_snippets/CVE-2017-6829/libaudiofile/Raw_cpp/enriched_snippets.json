[
  {
    "function_name": "completeSetup",
    "container": "RawFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Raw.cpp",
    "lines": "137-189",
    "snippet": "AFfilesetup RawFile::completeSetup(AFfilesetup setup)\n{\n\tAFfilesetup\tnewSetup;\n\n\tif (setup->trackSet && setup->trackCount != 1)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"raw file must have exactly one track\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tTrackSetup *track = setup->getTrack();\n\tif (!track)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"could not access track in file setup\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tif (track->aesDataSet)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"raw file cannot have AES data\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tif (track->markersSet && track->markerCount != 0)\n\t{\n\t\t_af_error(AF_BAD_NUMMARKS, \"raw file cannot have markers\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tif (setup->instrumentSet && setup->instrumentCount != 0)\n\t{\n\t\t_af_error(AF_BAD_NUMINSTS, \"raw file cannot have instruments\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tif (setup->miscellaneousSet && setup->miscellaneousCount != 0)\n\t{\n\t\t_af_error(AF_BAD_NUMMISC, \"raw file cannot have miscellaneous data\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tnewSetup = (_AFfilesetup *) _af_malloc(sizeof (_AFfilesetup));\n\t*newSetup = rawDefaultFileSetup;\n\n\tnewSetup->tracks = (TrackSetup *) _af_malloc(sizeof (TrackSetup));\n\tnewSetup->tracks[0] = setup->tracks[0];\n\tnewSetup->tracks[0].f.compressionParams = NULL;\n\n\tnewSetup->tracks[0].markerCount = 0;\n\tnewSetup->tracks[0].markers = NULL;\n\n\treturn newSetup;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"Raw.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const _AFfilesetup rawDefaultFileSetup =\n{\n\t_AF_VALID_FILESETUP,\t// valid\n\tAF_FILE_RAWDATA,\t\t// fileFormat\n\ttrue,\t// trackSet\n\ttrue,\t// instrumentSet\n\ttrue,\t// miscellaneousSet\n\t1,\t\t// trackCount\n\tNULL,\t// tracks\n\t0,\t\t// instrumentCount\n\tNULL,\t// instruments\n\t0,\t\t// miscellaneousCount\n\tNULL\t// miscellaneous\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_malloc",
          "args": [
            "sizeof (TrackSetup)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_malloc",
          "args": [
            "sizeof (_AFfilesetup)"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_NUMMISC",
            "\"raw file cannot have miscellaneous data\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_NUMINSTS",
            "\"raw file cannot have instruments\""
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_NUMMARKS",
            "\"raw file cannot have markers\""
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"raw file cannot have AES data\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"could not access track in file setup\""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"raw file must have exactly one track\""
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"Raw.h\"\n#include \"config.h\"\n\nstatic const _AFfilesetup rawDefaultFileSetup =\n{\n\t_AF_VALID_FILESETUP,\t// valid\n\tAF_FILE_RAWDATA,\t\t// fileFormat\n\ttrue,\t// trackSet\n\ttrue,\t// instrumentSet\n\ttrue,\t// miscellaneousSet\n\t1,\t\t// trackCount\n\tNULL,\t// tracks\n\t0,\t\t// instrumentCount\n\tNULL,\t// instruments\n\t0,\t\t// miscellaneousCount\n\tNULL\t// miscellaneous\n};\n\nRawFile {\n  AFfilesetup RawFile::completeSetup(AFfilesetup setup)\n  {\n  \tAFfilesetup\tnewSetup;\n  \n  \tif (setup->trackSet && setup->trackCount != 1)\n  \t{\n  \t\t_af_error(AF_BAD_FILESETUP, \"raw file must have exactly one track\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tTrackSetup *track = setup->getTrack();\n  \tif (!track)\n  \t{\n  \t\t_af_error(AF_BAD_FILESETUP, \"could not access track in file setup\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tif (track->aesDataSet)\n  \t{\n  \t\t_af_error(AF_BAD_FILESETUP, \"raw file cannot have AES data\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tif (track->markersSet && track->markerCount != 0)\n  \t{\n  \t\t_af_error(AF_BAD_NUMMARKS, \"raw file cannot have markers\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tif (setup->instrumentSet && setup->instrumentCount != 0)\n  \t{\n  \t\t_af_error(AF_BAD_NUMINSTS, \"raw file cannot have instruments\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tif (setup->miscellaneousSet && setup->miscellaneousCount != 0)\n  \t{\n  \t\t_af_error(AF_BAD_NUMMISC, \"raw file cannot have miscellaneous data\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tnewSetup = (_AFfilesetup *) _af_malloc(sizeof (_AFfilesetup));\n  \t*newSetup = rawDefaultFileSetup;\n  \n  \tnewSetup->tracks = (TrackSetup *) _af_malloc(sizeof (TrackSetup));\n  \tnewSetup->tracks[0] = setup->tracks[0];\n  \tnewSetup->tracks[0].f.compressionParams = NULL;\n  \n  \tnewSetup->tracks[0].markerCount = 0;\n  \tnewSetup->tracks[0].markers = NULL;\n  \n  \treturn newSetup;\n  }\n}"
  },
  {
    "function_name": "update",
    "container": "RawFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Raw.cpp",
    "lines": "132-135",
    "snippet": "status RawFile::update()\n{\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"Raw.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"Raw.h\"\n#include \"config.h\"\n\nRawFile {\n  status RawFile::update()\n  {\n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "writeInit",
    "container": "RawFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Raw.cpp",
    "lines": "113-130",
    "snippet": "status RawFile::writeInit(AFfilesetup setup)\n{\n\tif (initFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\n\tTrackSetup *trackSetup = setup->getTrack();\n\tif (!trackSetup)\n\t\treturn AF_FAIL;\n\n\tTrack *track = getTrack();\n\n\tif (trackSetup->dataOffsetSet)\n\t\ttrack->fpos_first_frame = trackSetup->dataOffset;\n\telse\n\t\ttrack->fpos_first_frame = 0;\n\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"Raw.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "getTrack",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initFromSetup",
          "args": [
            "setup"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "initFromSetup",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "222-231",
          "snippet": "status _AFfilehandle::initFromSetup(AFfilesetup setup)\n{\n\tif (copyTracksFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\tif (copyInstrumentsFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\tif (copyMiscellaneousFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  status _AFfilehandle::initFromSetup(AFfilesetup setup)\n  {\n  \tif (copyTracksFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \tif (copyInstrumentsFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \tif (copyMiscellaneousFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \treturn AF_SUCCEED;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"Raw.h\"\n#include \"config.h\"\n\nRawFile {\n  status RawFile::writeInit(AFfilesetup setup)\n  {\n  \tif (initFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \n  \tTrackSetup *trackSetup = setup->getTrack();\n  \tif (!trackSetup)\n  \t\treturn AF_FAIL;\n  \n  \tTrack *track = getTrack();\n  \n  \tif (trackSetup->dataOffsetSet)\n  \t\ttrack->fpos_first_frame = trackSetup->dataOffset;\n  \telse\n  \t\ttrack->fpos_first_frame = 0;\n  \n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "readInit",
    "container": "RawFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Raw.cpp",
    "lines": "62-111",
    "snippet": "status RawFile::readInit(AFfilesetup fileSetup)\n{\n\tif (!fileSetup)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"a valid AFfilesetup is required for reading raw data\");\n\t\treturn AF_FAIL;\n\t}\n\n\tif (initFromSetup(fileSetup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\n\tTrackSetup *trackSetup = fileSetup->getTrack();\n\tif (!trackSetup)\n\t\treturn AF_FAIL;\n\n\tTrack *track = getTrack();\n\n\t/* Set the track's data offset. */\n\tif (trackSetup->dataOffsetSet)\n\t\ttrack->fpos_first_frame = trackSetup->dataOffset;\n\telse\n\t\ttrack->fpos_first_frame = 0;\n\n\t/* Set the track's frame count. */\n\tif (trackSetup->frameCountSet)\n\t{\n\t\ttrack->totalfframes = trackSetup->frameCount;\n\t}\n\telse\n\t{\n\t\tAFfileoffset filesize = m_fh->length();\n\t\tif (filesize == -1)\n\t\t\ttrack->totalfframes = -1;\n\t\telse\n\t\t{\n\t\t\t/* Ensure that the data offset is valid. */\n\t\t\tif (track->fpos_first_frame > filesize)\n\t\t\t{\n\t\t\t\t_af_error(AF_BAD_FILESETUP, \"data offset is larger than file size\");\n\t\t\t\treturn AF_FAIL;\n\t\t\t}\n\n\t\t\tfilesize -= track->fpos_first_frame;\n\t\t\ttrack->totalfframes = filesize / (int) _af_format_frame_size(&track->f, false);\n\t\t}\n\t\ttrack->data_size = filesize;\n\t}\n\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"Raw.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_format_frame_size",
          "args": [
            "&track->f",
            "false"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "_af_format_frame_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "301-308",
          "snippet": "float _af_format_frame_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_frame_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nfloat _af_format_frame_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_frame_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"data offset is larger than file size\""
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_fh->length",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "182-185",
          "snippet": "off_t FileVF::length()\n{\n\treturn m_vf->length(m_vf);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  off_t FileVF::length()\n  {\n  \treturn m_vf->length(m_vf);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getTrack",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileSetup->getTrack",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initFromSetup",
          "args": [
            "fileSetup"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "initFromSetup",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "222-231",
          "snippet": "status _AFfilehandle::initFromSetup(AFfilesetup setup)\n{\n\tif (copyTracksFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\tif (copyInstrumentsFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\tif (copyMiscellaneousFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  status _AFfilehandle::initFromSetup(AFfilesetup setup)\n  {\n  \tif (copyTracksFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \tif (copyInstrumentsFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \tif (copyMiscellaneousFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \treturn AF_SUCCEED;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"a valid AFfilesetup is required for reading raw data\""
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"Raw.h\"\n#include \"config.h\"\n\nRawFile {\n  status RawFile::readInit(AFfilesetup fileSetup)\n  {\n  \tif (!fileSetup)\n  \t{\n  \t\t_af_error(AF_BAD_FILESETUP, \"a valid AFfilesetup is required for reading raw data\");\n  \t\treturn AF_FAIL;\n  \t}\n  \n  \tif (initFromSetup(fileSetup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \n  \tTrackSetup *trackSetup = fileSetup->getTrack();\n  \tif (!trackSetup)\n  \t\treturn AF_FAIL;\n  \n  \tTrack *track = getTrack();\n  \n  \t/* Set the track's data offset. */\n  \tif (trackSetup->dataOffsetSet)\n  \t\ttrack->fpos_first_frame = trackSetup->dataOffset;\n  \telse\n  \t\ttrack->fpos_first_frame = 0;\n  \n  \t/* Set the track's frame count. */\n  \tif (trackSetup->frameCountSet)\n  \t{\n  \t\ttrack->totalfframes = trackSetup->frameCount;\n  \t}\n  \telse\n  \t{\n  \t\tAFfileoffset filesize = m_fh->length();\n  \t\tif (filesize == -1)\n  \t\t\ttrack->totalfframes = -1;\n  \t\telse\n  \t\t{\n  \t\t\t/* Ensure that the data offset is valid. */\n  \t\t\tif (track->fpos_first_frame > filesize)\n  \t\t\t{\n  \t\t\t\t_af_error(AF_BAD_FILESETUP, \"data offset is larger than file size\");\n  \t\t\t\treturn AF_FAIL;\n  \t\t\t}\n  \n  \t\t\tfilesize -= track->fpos_first_frame;\n  \t\t\ttrack->totalfframes = filesize / (int) _af_format_frame_size(&track->f, false);\n  \t\t}\n  \t\ttrack->data_size = filesize;\n  \t}\n  \n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "recognize",
    "container": "RawFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Raw.cpp",
    "lines": "57-60",
    "snippet": "bool RawFile::recognize(File *fh)\n{\n\treturn false;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"Raw.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"Raw.h\"\n#include \"config.h\"\n\nRawFile {\n  bool RawFile::recognize(File *fh)\n  {\n  \treturn false;\n  }\n}"
  }
]