[
  {
    "function_name": "afGetVirtualChannels",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "375-385",
    "snippet": "int afGetVirtualChannels (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->v.channelCount;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 377
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afGetVirtualChannels (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->v.channelCount;\n}"
  },
  {
    "function_name": "afSetChannelMatrix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "349-373",
    "snippet": "void afSetChannelMatrix (AFfilehandle file, int trackid, double* matrix)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (track->channelMatrix != NULL)\n\t\tfree(track->channelMatrix);\n\ttrack->channelMatrix = NULL;\n\n\tif (matrix != NULL)\n\t{\n\t\tint\ti, size;\n\n\t\tsize = track->v.channelCount * track->f.channelCount;\n\n\t\ttrack->channelMatrix = (double *) malloc(size * sizeof (double));\n\n\t\tfor (i = 0; i < size; i++)\n\t\t\ttrack->channelMatrix[i] = matrix[i];\n\t}\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "malloc",
          "args": [
            "size * sizeof (double)"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "track->channelMatrix"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 351
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nvoid afSetChannelMatrix (AFfilehandle file, int trackid, double* matrix)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (track->channelMatrix != NULL)\n\t\tfree(track->channelMatrix);\n\ttrack->channelMatrix = NULL;\n\n\tif (matrix != NULL)\n\t{\n\t\tint\ti, size;\n\n\t\tsize = track->v.channelCount * track->f.channelCount;\n\n\t\ttrack->channelMatrix = (double *) malloc(size * sizeof (double));\n\n\t\tfor (i = 0; i < size; i++)\n\t\t\ttrack->channelMatrix[i] = matrix[i];\n\t}\n}"
  },
  {
    "function_name": "afSetVirtualRate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "328-347",
    "snippet": "int afSetVirtualRate (AFfilehandle file, int trackid, double rate)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (rate < 0)\n\t{\n\t\t_af_error(AF_BAD_RATE, \"invalid sampling rate %.30g\", rate);\n\t\treturn -1;\n\t}\n\n\ttrack->v.sampleRate = rate;\n\ttrack->ms->setDirty();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->ms->setDirty",
          "args": [],
          "line": 344
        },
        "resolved": true,
        "details": {
          "function_name": "setDirty",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.h",
          "lines": "40-40",
          "snippet": "void setDirty() { m_isDirty = true; }",
          "includes": [
            "#include <vector>",
            "#include \"afinternal.h\"",
            "#include \"Shared.h\"",
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"afinternal.h\"\n#include \"Shared.h\"\n#include \"Module.h\"\n\nModuleState {\n  void setDirty() { m_isDirty = true; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_RATE",
            "\"invalid sampling rate %.30g\"",
            "rate"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afSetVirtualRate (AFfilehandle file, int trackid, double rate)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (rate < 0)\n\t{\n\t\t_af_error(AF_BAD_RATE, \"invalid sampling rate %.30g\", rate);\n\t\treturn -1;\n\t}\n\n\ttrack->v.sampleRate = rate;\n\ttrack->ms->setDirty();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "afGetVirtualRate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "316-326",
    "snippet": "double afGetVirtualRate (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->v.sampleRate;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 321
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\ndouble afGetVirtualRate (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->v.sampleRate;\n}"
  },
  {
    "function_name": "afSetVirtualChannels",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "297-314",
    "snippet": "int afSetVirtualChannels (AFfilehandle file, int trackid, int channelCount)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\ttrack->v.channelCount = channelCount;\n\ttrack->ms->setDirty();\n\n\tif (track->channelMatrix)\n\t\tfree(track->channelMatrix);\n\ttrack->channelMatrix = NULL;\n\n\treturn 0;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "track->channelMatrix"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "track->ms->setDirty",
          "args": [],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "setDirty",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.h",
          "lines": "40-40",
          "snippet": "void setDirty() { m_isDirty = true; }",
          "includes": [
            "#include <vector>",
            "#include \"afinternal.h\"",
            "#include \"Shared.h\"",
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"afinternal.h\"\n#include \"Shared.h\"\n#include \"Module.h\"\n\nModuleState {\n  void setDirty() { m_isDirty = true; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 299
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afSetVirtualChannels (AFfilehandle file, int trackid, int channelCount)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\ttrack->v.channelCount = channelCount;\n\ttrack->ms->setDirty();\n\n\tif (track->channelMatrix)\n\t\tfree(track->channelMatrix);\n\ttrack->channelMatrix = NULL;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "afGetFileFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "286-295",
    "snippet": "int afGetFileFormat (AFfilehandle file, int *version)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (version != NULL)\n\t\t*version = file->getVersion();\n\n\treturn file->m_fileFormat;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getVersion",
          "args": [],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "getVersion",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.h",
          "lines": "67-67",
          "snippet": "virtual int getVersion() { return 0; }",
          "includes": [
            "#include <stdint.h>",
            "#include \"afinternal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include \"afinternal.h\"\n\n_AFfilehandle {\n  virtual int getVersion() { return 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 288
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afGetFileFormat (AFfilehandle file, int *version)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (version != NULL)\n\t\t*version = file->getVersion();\n\n\treturn file->m_fileFormat;\n}"
  },
  {
    "function_name": "afSetVirtualSampleFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "267-283",
    "snippet": "int afSetVirtualSampleFormat (AFfilehandle file, int trackid,\n\tint sampleFormat, int sampleWidth)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (_af_set_sample_format(&track->v, sampleFormat, sampleWidth) == AF_FAIL)\n\t\treturn -1;\n\n\ttrack->ms->setDirty();\n\n\treturn 0;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->ms->setDirty",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "setDirty",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.h",
          "lines": "40-40",
          "snippet": "void setDirty() { m_isDirty = true; }",
          "includes": [
            "#include <vector>",
            "#include \"afinternal.h\"",
            "#include \"Shared.h\"",
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"afinternal.h\"\n#include \"Shared.h\"\n#include \"Module.h\"\n\nModuleState {\n  void setDirty() { m_isDirty = true; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_set_sample_format",
          "args": [
            "&track->v",
            "sampleFormat",
            "sampleWidth"
          ],
          "line": 277
        },
        "resolved": true,
        "details": {
          "function_name": "_af_set_sample_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "315-361",
          "snippet": "status _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatus _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afSetVirtualSampleFormat (AFfilehandle file, int trackid,\n\tint sampleFormat, int sampleWidth)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (_af_set_sample_format(&track->v, sampleFormat, sampleWidth) == AF_FAIL)\n\t\treturn -1;\n\n\ttrack->ms->setDirty();\n\n\treturn 0;\n}"
  },
  {
    "function_name": "afGetVirtualSampleFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "251-265",
    "snippet": "void afGetVirtualSampleFormat (AFfilehandle file, int trackid, int *sampleFormat, int *sampleWidth)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (sampleFormat)\n\t\t*sampleFormat = track->v.sampleFormat;\n\n\tif (sampleWidth)\n\t\t*sampleWidth = track->v.sampleWidth;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nvoid afGetVirtualSampleFormat (AFfilehandle file, int trackid, int *sampleFormat, int *sampleWidth)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (sampleFormat)\n\t\t*sampleFormat = track->v.sampleFormat;\n\n\tif (sampleWidth)\n\t\t*sampleWidth = track->v.sampleWidth;\n}"
  },
  {
    "function_name": "afGetSampleFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "235-249",
    "snippet": "void afGetSampleFormat (AFfilehandle file, int trackid, int *sampleFormat, int *sampleWidth)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (sampleFormat)\n\t\t*sampleFormat = track->f.sampleFormat;\n\n\tif (sampleWidth)\n\t\t*sampleWidth = track->f.sampleWidth;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nvoid afGetSampleFormat (AFfilehandle file, int trackid, int *sampleFormat, int *sampleWidth)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (sampleFormat)\n\t\t*sampleFormat = track->f.sampleFormat;\n\n\tif (sampleWidth)\n\t\t*sampleWidth = track->f.sampleWidth;\n}"
  },
  {
    "function_name": "afGetChannels",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "223-233",
    "snippet": "int afGetChannels (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->f.channelCount;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afGetChannels (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->f.channelCount;\n}"
  },
  {
    "function_name": "afGetRate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "211-221",
    "snippet": "double afGetRate (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->f.sampleRate;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 216
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\ndouble afGetRate (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->f.sampleRate;\n}"
  },
  {
    "function_name": "afGetFrameCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "196-209",
    "snippet": "AFframecount afGetFrameCount (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (track->ms->isDirty() && track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\treturn track->totalvframes;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->ms->setup",
          "args": [
            "file",
            "track"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "setup",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.cpp",
          "lines": "109-201",
          "snippet": "status ModuleState::setup(AFfilehandle file, Track *track)\n{\n\tAFframecount fframepos = llrint(track->nextvframe * track->f.sampleRate / track->v.sampleRate);\n\tbool isReading = file->m_access == _AF_READ_ACCESS;\n\n\tif (!track->v.isUncompressed())\n\t{\n\t\t_af_error(AF_BAD_NOT_IMPLEMENTED,\n\t\t\t\"library does not support compression in virtual format yet\");\n\t\treturn AF_FAIL;\n\t}\n\n\tif (arrange(file, track) == AF_FAIL)\n\t\treturn AF_FAIL;\n\n\ttrack->filemodhappy = true;\n\tint maxbufsize = 0;\n\tif (isReading)\n\t{\n\t\tm_chunks.back()->frameCount = _AF_ATOMIC_NVFRAMES;\n\t\tfor (int i=m_modules.size() - 1; i >= 0; i--)\n\t\t{\n\t\t\tSharedPtr<Chunk> inChunk = m_chunks[i];\n\t\t\tSharedPtr<Chunk> outChunk = m_chunks[i+1];\n\t\t\tint bufsize = outChunk->frameCount * outChunk->f.bytesPerFrame(true);\n\t\t\tif (bufsize > maxbufsize)\n\t\t\t\tmaxbufsize = bufsize;\n\t\t\tif (i != 0)\n\t\t\t\tm_modules[i]->setSource(m_modules[i-1].get());\n\t\t\tm_modules[i]->maxPull();\n\t\t}\n\n\t\tif (!track->filemodhappy)\n\t\t\treturn AF_FAIL;\n\t\tint bufsize = m_fileModule->bufferSize();\n\t\tif (bufsize > maxbufsize)\n\t\t\tmaxbufsize = bufsize;\n\t}\n\telse\n\t{\n\t\tm_chunks.front()->frameCount = _AF_ATOMIC_NVFRAMES;\n\t\tfor (size_t i=0; i<m_modules.size(); i++)\n\t\t{\n\t\t\tSharedPtr<Chunk> inChunk = m_chunks[i];\n\t\t\tSharedPtr<Chunk> outChunk = m_chunks[i+1];\n\t\t\tint bufsize = inChunk->frameCount * inChunk->f.bytesPerFrame(true);\n\t\t\tif (bufsize > maxbufsize)\n\t\t\t\tmaxbufsize = bufsize;\n\t\t\tif (i != m_modules.size() - 1)\n\t\t\t\tm_modules[i]->setSink(m_modules[i+1].get());\n\t\t\tm_modules[i]->maxPush();\n\t\t}\n\n\t\tif (!track->filemodhappy)\n\t\t\treturn AF_FAIL;\n\n\t\tint bufsize = m_fileModule->bufferSize();\n\t\tif (bufsize > maxbufsize)\n\t\t\tmaxbufsize = bufsize;\n\t}\n\n\tfor (size_t i=0; i<m_chunks.size(); i++)\n\t{\n\t\tif ((isReading && i==m_chunks.size() - 1) || (!isReading && i==0))\n\t\t\tcontinue;\n\t\tm_chunks[i]->allocate(maxbufsize);\n\t}\n\n\tif (isReading)\n\t{\n\t\tif (track->totalfframes == -1)\n\t\t\ttrack->totalvframes = -1;\n\t\telse\n\t\t\ttrack->totalvframes = llrint(track->totalfframes *\n\t\t\t\t(track->v.sampleRate / track->f.sampleRate));\n\n\t\ttrack->nextfframe = fframepos;\n\t\ttrack->nextvframe = llrint(fframepos * track->v.sampleRate / track->f.sampleRate);\n\n\t\tm_isDirty = false;\n\n\t\tif (reset(file, track) == AF_FAIL)\n\t\t\treturn AF_FAIL;\n\t}\n\telse\n\t{\n\t\ttrack->nextvframe = track->totalvframes =\n\t\t\t(AFframecount) (fframepos * track->v.sampleRate / track->f.sampleRate);\n\t\tm_isDirty = false;\n\t}\n\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <functional>",
            "#include <cmath>",
            "#include <cassert>",
            "#include <algorithm>",
            "#include \"../pcm.h\"",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"Track.h\"",
            "#include \"SimpleModule.h\"",
            "#include \"RebufferModule.h\"",
            "#include \"FileModule.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"ModuleState.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <functional>\n#include <cmath>\n#include <cassert>\n#include <algorithm>\n#include \"../pcm.h\"\n#include \"util.h\"\n#include \"units.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"SimpleModule.h\"\n#include \"RebufferModule.h\"\n#include \"FileModule.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"ModuleState.h\"\n#include \"config.h\"\n\nModuleState {\n  status ModuleState::setup(AFfilehandle file, Track *track)\n  {\n  \tAFframecount fframepos = llrint(track->nextvframe * track->f.sampleRate / track->v.sampleRate);\n  \tbool isReading = file->m_access == _AF_READ_ACCESS;\n  \n  \tif (!track->v.isUncompressed())\n  \t{\n  \t\t_af_error(AF_BAD_NOT_IMPLEMENTED,\n  \t\t\t\"library does not support compression in virtual format yet\");\n  \t\treturn AF_FAIL;\n  \t}\n  \n  \tif (arrange(file, track) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \n  \ttrack->filemodhappy = true;\n  \tint maxbufsize = 0;\n  \tif (isReading)\n  \t{\n  \t\tm_chunks.back()->frameCount = _AF_ATOMIC_NVFRAMES;\n  \t\tfor (int i=m_modules.size() - 1; i >= 0; i--)\n  \t\t{\n  \t\t\tSharedPtr<Chunk> inChunk = m_chunks[i];\n  \t\t\tSharedPtr<Chunk> outChunk = m_chunks[i+1];\n  \t\t\tint bufsize = outChunk->frameCount * outChunk->f.bytesPerFrame(true);\n  \t\t\tif (bufsize > maxbufsize)\n  \t\t\t\tmaxbufsize = bufsize;\n  \t\t\tif (i != 0)\n  \t\t\t\tm_modules[i]->setSource(m_modules[i-1].get());\n  \t\t\tm_modules[i]->maxPull();\n  \t\t}\n  \n  \t\tif (!track->filemodhappy)\n  \t\t\treturn AF_FAIL;\n  \t\tint bufsize = m_fileModule->bufferSize();\n  \t\tif (bufsize > maxbufsize)\n  \t\t\tmaxbufsize = bufsize;\n  \t}\n  \telse\n  \t{\n  \t\tm_chunks.front()->frameCount = _AF_ATOMIC_NVFRAMES;\n  \t\tfor (size_t i=0; i<m_modules.size(); i++)\n  \t\t{\n  \t\t\tSharedPtr<Chunk> inChunk = m_chunks[i];\n  \t\t\tSharedPtr<Chunk> outChunk = m_chunks[i+1];\n  \t\t\tint bufsize = inChunk->frameCount * inChunk->f.bytesPerFrame(true);\n  \t\t\tif (bufsize > maxbufsize)\n  \t\t\t\tmaxbufsize = bufsize;\n  \t\t\tif (i != m_modules.size() - 1)\n  \t\t\t\tm_modules[i]->setSink(m_modules[i+1].get());\n  \t\t\tm_modules[i]->maxPush();\n  \t\t}\n  \n  \t\tif (!track->filemodhappy)\n  \t\t\treturn AF_FAIL;\n  \n  \t\tint bufsize = m_fileModule->bufferSize();\n  \t\tif (bufsize > maxbufsize)\n  \t\t\tmaxbufsize = bufsize;\n  \t}\n  \n  \tfor (size_t i=0; i<m_chunks.size(); i++)\n  \t{\n  \t\tif ((isReading && i==m_chunks.size() - 1) || (!isReading && i==0))\n  \t\t\tcontinue;\n  \t\tm_chunks[i]->allocate(maxbufsize);\n  \t}\n  \n  \tif (isReading)\n  \t{\n  \t\tif (track->totalfframes == -1)\n  \t\t\ttrack->totalvframes = -1;\n  \t\telse\n  \t\t\ttrack->totalvframes = llrint(track->totalfframes *\n  \t\t\t\t(track->v.sampleRate / track->f.sampleRate));\n  \n  \t\ttrack->nextfframe = fframepos;\n  \t\ttrack->nextvframe = llrint(fframepos * track->v.sampleRate / track->f.sampleRate);\n  \n  \t\tm_isDirty = false;\n  \n  \t\tif (reset(file, track) == AF_FAIL)\n  \t\t\treturn AF_FAIL;\n  \t}\n  \telse\n  \t{\n  \t\ttrack->nextvframe = track->totalvframes =\n  \t\t\t(AFframecount) (fframepos * track->v.sampleRate / track->f.sampleRate);\n  \t\tm_isDirty = false;\n  \t}\n  \n  \treturn AF_SUCCEED;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "track->ms->isDirty",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "isDirty",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.h",
          "lines": "39-39",
          "snippet": "bool isDirty() const { return m_isDirty; }",
          "includes": [
            "#include <vector>",
            "#include \"afinternal.h\"",
            "#include \"Shared.h\"",
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"afinternal.h\"\n#include \"Shared.h\"\n#include \"Module.h\"\n\nModuleState {\n  bool isDirty() const { return m_isDirty; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nAFframecount afGetFrameCount (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (track->ms->isDirty() && track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\treturn track->totalvframes;\n}"
  },
  {
    "function_name": "afGetVirtualByteOrder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "184-194",
    "snippet": "int afGetVirtualByteOrder (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->v.byteOrder;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afGetVirtualByteOrder (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->v.byteOrder;\n}"
  },
  {
    "function_name": "afGetByteOrder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "172-182",
    "snippet": "int afGetByteOrder (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->f.byteOrder;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afGetByteOrder (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->f.byteOrder;\n}"
  },
  {
    "function_name": "afSetVirtualByteOrder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "150-170",
    "snippet": "int afSetVirtualByteOrder (AFfilehandle file, int trackid, int byteorder)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn AF_FAIL;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn AF_FAIL;\n\n\tif (byteorder != AF_BYTEORDER_BIGENDIAN &&\n\t\tbyteorder != AF_BYTEORDER_LITTLEENDIAN)\n\t{\n\t\t_af_error(AF_BAD_BYTEORDER, \"invalid byte order %d\", byteorder);\n\t\treturn AF_FAIL;\n\t}\n\n\ttrack->v.byteOrder = byteorder;\n\ttrack->ms->setDirty();\n\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->ms->setDirty",
          "args": [],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "setDirty",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.h",
          "lines": "40-40",
          "snippet": "void setDirty() { m_isDirty = true; }",
          "includes": [
            "#include <vector>",
            "#include \"afinternal.h\"",
            "#include \"Shared.h\"",
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"afinternal.h\"\n#include \"Shared.h\"\n#include \"Module.h\"\n\nModuleState {\n  void setDirty() { m_isDirty = true; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_BYTEORDER",
            "\"invalid byte order %d\"",
            "byteorder"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nint afSetVirtualByteOrder (AFfilehandle file, int trackid, int byteorder)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn AF_FAIL;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn AF_FAIL;\n\n\tif (byteorder != AF_BYTEORDER_BIGENDIAN &&\n\t\tbyteorder != AF_BYTEORDER_LITTLEENDIAN)\n\t{\n\t\t_af_error(AF_BAD_BYTEORDER, \"invalid byte order %d\", byteorder);\n\t\treturn AF_FAIL;\n\t}\n\n\ttrack->v.byteOrder = byteorder;\n\ttrack->ms->setDirty();\n\n\treturn AF_SUCCEED;\n}"
  },
  {
    "function_name": "afTellFrame",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "145-148",
    "snippet": "AFfileoffset afTellFrame (AFfilehandle file, int trackid)\n{\n\treturn afSeekFrame(file, trackid, -1);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "afSeekFrame",
          "args": [
            "file",
            "trackid",
            "-1"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "afSeekFrame",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
          "lines": "101-143",
          "snippet": "AFframecount afSeekFrame (AFfilehandle file, int trackid, AFframecount frame)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (!file->checkCanRead())\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (track->ms->isDirty() && track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\tif (frame < 0)\n\t\treturn track->nextvframe;\n\n\t/* Optimize the case of seeking to the current position. */\n\tif (frame == track->nextvframe)\n\t\treturn track->nextvframe;\n\n\t/* Limit request to the number of frames in the file. */\n\tif (track->totalvframes != -1)\n\t\tif (frame > track->totalvframes)\n\t\t\tframe = track->totalvframes - 1;\n\n\t/*\n\t\tNow that the modules are not dirty and frame\n\t\trepresents a valid virtual frame, we call\n\t\t_AFsetupmodules again after setting track->nextvframe.\n\n\t\t_AFsetupmodules will look at track->nextvframe and\n\t\tcompute track->nextfframe in clever and mysterious\n\t\tways.\n\t*/\n\ttrack->nextvframe = frame;\n\n\tif (track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\treturn track->nextvframe;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"modules/ModuleState.h\"",
            "#include \"modules/Module.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdint.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nAFframecount afSeekFrame (AFfilehandle file, int trackid, AFframecount frame)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (!file->checkCanRead())\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (track->ms->isDirty() && track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\tif (frame < 0)\n\t\treturn track->nextvframe;\n\n\t/* Optimize the case of seeking to the current position. */\n\tif (frame == track->nextvframe)\n\t\treturn track->nextvframe;\n\n\t/* Limit request to the number of frames in the file. */\n\tif (track->totalvframes != -1)\n\t\tif (frame > track->totalvframes)\n\t\t\tframe = track->totalvframes - 1;\n\n\t/*\n\t\tNow that the modules are not dirty and frame\n\t\trepresents a valid virtual frame, we call\n\t\t_AFsetupmodules again after setting track->nextvframe.\n\n\t\t_AFsetupmodules will look at track->nextvframe and\n\t\tcompute track->nextfframe in clever and mysterious\n\t\tways.\n\t*/\n\ttrack->nextvframe = frame;\n\n\tif (track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\treturn track->nextvframe;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nAFfileoffset afTellFrame (AFfilehandle file, int trackid)\n{\n\treturn afSeekFrame(file, trackid, -1);\n}"
  },
  {
    "function_name": "afSeekFrame",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "101-143",
    "snippet": "AFframecount afSeekFrame (AFfilehandle file, int trackid, AFframecount frame)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (!file->checkCanRead())\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (track->ms->isDirty() && track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\tif (frame < 0)\n\t\treturn track->nextvframe;\n\n\t/* Optimize the case of seeking to the current position. */\n\tif (frame == track->nextvframe)\n\t\treturn track->nextvframe;\n\n\t/* Limit request to the number of frames in the file. */\n\tif (track->totalvframes != -1)\n\t\tif (frame > track->totalvframes)\n\t\t\tframe = track->totalvframes - 1;\n\n\t/*\n\t\tNow that the modules are not dirty and frame\n\t\trepresents a valid virtual frame, we call\n\t\t_AFsetupmodules again after setting track->nextvframe.\n\n\t\t_AFsetupmodules will look at track->nextvframe and\n\t\tcompute track->nextfframe in clever and mysterious\n\t\tways.\n\t*/\n\ttrack->nextvframe = frame;\n\n\tif (track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\treturn track->nextvframe;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->ms->setup",
          "args": [
            "file",
            "track"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "setup",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.cpp",
          "lines": "109-201",
          "snippet": "status ModuleState::setup(AFfilehandle file, Track *track)\n{\n\tAFframecount fframepos = llrint(track->nextvframe * track->f.sampleRate / track->v.sampleRate);\n\tbool isReading = file->m_access == _AF_READ_ACCESS;\n\n\tif (!track->v.isUncompressed())\n\t{\n\t\t_af_error(AF_BAD_NOT_IMPLEMENTED,\n\t\t\t\"library does not support compression in virtual format yet\");\n\t\treturn AF_FAIL;\n\t}\n\n\tif (arrange(file, track) == AF_FAIL)\n\t\treturn AF_FAIL;\n\n\ttrack->filemodhappy = true;\n\tint maxbufsize = 0;\n\tif (isReading)\n\t{\n\t\tm_chunks.back()->frameCount = _AF_ATOMIC_NVFRAMES;\n\t\tfor (int i=m_modules.size() - 1; i >= 0; i--)\n\t\t{\n\t\t\tSharedPtr<Chunk> inChunk = m_chunks[i];\n\t\t\tSharedPtr<Chunk> outChunk = m_chunks[i+1];\n\t\t\tint bufsize = outChunk->frameCount * outChunk->f.bytesPerFrame(true);\n\t\t\tif (bufsize > maxbufsize)\n\t\t\t\tmaxbufsize = bufsize;\n\t\t\tif (i != 0)\n\t\t\t\tm_modules[i]->setSource(m_modules[i-1].get());\n\t\t\tm_modules[i]->maxPull();\n\t\t}\n\n\t\tif (!track->filemodhappy)\n\t\t\treturn AF_FAIL;\n\t\tint bufsize = m_fileModule->bufferSize();\n\t\tif (bufsize > maxbufsize)\n\t\t\tmaxbufsize = bufsize;\n\t}\n\telse\n\t{\n\t\tm_chunks.front()->frameCount = _AF_ATOMIC_NVFRAMES;\n\t\tfor (size_t i=0; i<m_modules.size(); i++)\n\t\t{\n\t\t\tSharedPtr<Chunk> inChunk = m_chunks[i];\n\t\t\tSharedPtr<Chunk> outChunk = m_chunks[i+1];\n\t\t\tint bufsize = inChunk->frameCount * inChunk->f.bytesPerFrame(true);\n\t\t\tif (bufsize > maxbufsize)\n\t\t\t\tmaxbufsize = bufsize;\n\t\t\tif (i != m_modules.size() - 1)\n\t\t\t\tm_modules[i]->setSink(m_modules[i+1].get());\n\t\t\tm_modules[i]->maxPush();\n\t\t}\n\n\t\tif (!track->filemodhappy)\n\t\t\treturn AF_FAIL;\n\n\t\tint bufsize = m_fileModule->bufferSize();\n\t\tif (bufsize > maxbufsize)\n\t\t\tmaxbufsize = bufsize;\n\t}\n\n\tfor (size_t i=0; i<m_chunks.size(); i++)\n\t{\n\t\tif ((isReading && i==m_chunks.size() - 1) || (!isReading && i==0))\n\t\t\tcontinue;\n\t\tm_chunks[i]->allocate(maxbufsize);\n\t}\n\n\tif (isReading)\n\t{\n\t\tif (track->totalfframes == -1)\n\t\t\ttrack->totalvframes = -1;\n\t\telse\n\t\t\ttrack->totalvframes = llrint(track->totalfframes *\n\t\t\t\t(track->v.sampleRate / track->f.sampleRate));\n\n\t\ttrack->nextfframe = fframepos;\n\t\ttrack->nextvframe = llrint(fframepos * track->v.sampleRate / track->f.sampleRate);\n\n\t\tm_isDirty = false;\n\n\t\tif (reset(file, track) == AF_FAIL)\n\t\t\treturn AF_FAIL;\n\t}\n\telse\n\t{\n\t\ttrack->nextvframe = track->totalvframes =\n\t\t\t(AFframecount) (fframepos * track->v.sampleRate / track->f.sampleRate);\n\t\tm_isDirty = false;\n\t}\n\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <functional>",
            "#include <cmath>",
            "#include <cassert>",
            "#include <algorithm>",
            "#include \"../pcm.h\"",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"Track.h\"",
            "#include \"SimpleModule.h\"",
            "#include \"RebufferModule.h\"",
            "#include \"FileModule.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"ModuleState.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <functional>\n#include <cmath>\n#include <cassert>\n#include <algorithm>\n#include \"../pcm.h\"\n#include \"util.h\"\n#include \"units.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"SimpleModule.h\"\n#include \"RebufferModule.h\"\n#include \"FileModule.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"ModuleState.h\"\n#include \"config.h\"\n\nModuleState {\n  status ModuleState::setup(AFfilehandle file, Track *track)\n  {\n  \tAFframecount fframepos = llrint(track->nextvframe * track->f.sampleRate / track->v.sampleRate);\n  \tbool isReading = file->m_access == _AF_READ_ACCESS;\n  \n  \tif (!track->v.isUncompressed())\n  \t{\n  \t\t_af_error(AF_BAD_NOT_IMPLEMENTED,\n  \t\t\t\"library does not support compression in virtual format yet\");\n  \t\treturn AF_FAIL;\n  \t}\n  \n  \tif (arrange(file, track) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \n  \ttrack->filemodhappy = true;\n  \tint maxbufsize = 0;\n  \tif (isReading)\n  \t{\n  \t\tm_chunks.back()->frameCount = _AF_ATOMIC_NVFRAMES;\n  \t\tfor (int i=m_modules.size() - 1; i >= 0; i--)\n  \t\t{\n  \t\t\tSharedPtr<Chunk> inChunk = m_chunks[i];\n  \t\t\tSharedPtr<Chunk> outChunk = m_chunks[i+1];\n  \t\t\tint bufsize = outChunk->frameCount * outChunk->f.bytesPerFrame(true);\n  \t\t\tif (bufsize > maxbufsize)\n  \t\t\t\tmaxbufsize = bufsize;\n  \t\t\tif (i != 0)\n  \t\t\t\tm_modules[i]->setSource(m_modules[i-1].get());\n  \t\t\tm_modules[i]->maxPull();\n  \t\t}\n  \n  \t\tif (!track->filemodhappy)\n  \t\t\treturn AF_FAIL;\n  \t\tint bufsize = m_fileModule->bufferSize();\n  \t\tif (bufsize > maxbufsize)\n  \t\t\tmaxbufsize = bufsize;\n  \t}\n  \telse\n  \t{\n  \t\tm_chunks.front()->frameCount = _AF_ATOMIC_NVFRAMES;\n  \t\tfor (size_t i=0; i<m_modules.size(); i++)\n  \t\t{\n  \t\t\tSharedPtr<Chunk> inChunk = m_chunks[i];\n  \t\t\tSharedPtr<Chunk> outChunk = m_chunks[i+1];\n  \t\t\tint bufsize = inChunk->frameCount * inChunk->f.bytesPerFrame(true);\n  \t\t\tif (bufsize > maxbufsize)\n  \t\t\t\tmaxbufsize = bufsize;\n  \t\t\tif (i != m_modules.size() - 1)\n  \t\t\t\tm_modules[i]->setSink(m_modules[i+1].get());\n  \t\t\tm_modules[i]->maxPush();\n  \t\t}\n  \n  \t\tif (!track->filemodhappy)\n  \t\t\treturn AF_FAIL;\n  \n  \t\tint bufsize = m_fileModule->bufferSize();\n  \t\tif (bufsize > maxbufsize)\n  \t\t\tmaxbufsize = bufsize;\n  \t}\n  \n  \tfor (size_t i=0; i<m_chunks.size(); i++)\n  \t{\n  \t\tif ((isReading && i==m_chunks.size() - 1) || (!isReading && i==0))\n  \t\t\tcontinue;\n  \t\tm_chunks[i]->allocate(maxbufsize);\n  \t}\n  \n  \tif (isReading)\n  \t{\n  \t\tif (track->totalfframes == -1)\n  \t\t\ttrack->totalvframes = -1;\n  \t\telse\n  \t\t\ttrack->totalvframes = llrint(track->totalfframes *\n  \t\t\t\t(track->v.sampleRate / track->f.sampleRate));\n  \n  \t\ttrack->nextfframe = fframepos;\n  \t\ttrack->nextvframe = llrint(fframepos * track->v.sampleRate / track->f.sampleRate);\n  \n  \t\tm_isDirty = false;\n  \n  \t\tif (reset(file, track) == AF_FAIL)\n  \t\t\treturn AF_FAIL;\n  \t}\n  \telse\n  \t{\n  \t\ttrack->nextvframe = track->totalvframes =\n  \t\t\t(AFframecount) (fframepos * track->v.sampleRate / track->f.sampleRate);\n  \t\tm_isDirty = false;\n  \t}\n  \n  \treturn AF_SUCCEED;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "track->ms->isDirty",
          "args": [],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "isDirty",
          "container": "ModuleState",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/ModuleState.h",
          "lines": "39-39",
          "snippet": "bool isDirty() const { return m_isDirty; }",
          "includes": [
            "#include <vector>",
            "#include \"afinternal.h\"",
            "#include \"Shared.h\"",
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"afinternal.h\"\n#include \"Shared.h\"\n#include \"Module.h\"\n\nModuleState {\n  bool isDirty() const { return m_isDirty; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->checkCanRead",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "checkCanRead",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "177-186",
          "snippet": "bool _AFfilehandle::checkCanRead()\n{\n\tif (m_access != _AF_READ_ACCESS)\n\t{\n\t\t_af_error(AF_BAD_NOREADACC, \"file not opened for read access\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::checkCanRead()\n  {\n  \tif (m_access != _AF_READ_ACCESS)\n  \t{\n  \t\t_af_error(AF_BAD_NOREADACC, \"file not opened for read access\");\n  \t\treturn false;\n  \t}\n  \n  \treturn true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nAFframecount afSeekFrame (AFfilehandle file, int trackid, AFframecount frame)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (!file->checkCanRead())\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (track->ms->isDirty() && track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\tif (frame < 0)\n\t\treturn track->nextvframe;\n\n\t/* Optimize the case of seeking to the current position. */\n\tif (frame == track->nextvframe)\n\t\treturn track->nextvframe;\n\n\t/* Limit request to the number of frames in the file. */\n\tif (track->totalvframes != -1)\n\t\tif (frame > track->totalvframes)\n\t\t\tframe = track->totalvframes - 1;\n\n\t/*\n\t\tNow that the modules are not dirty and frame\n\t\trepresents a valid virtual frame, we call\n\t\t_AFsetupmodules again after setting track->nextvframe.\n\n\t\t_AFsetupmodules will look at track->nextvframe and\n\t\tcompute track->nextfframe in clever and mysterious\n\t\tways.\n\t*/\n\ttrack->nextvframe = frame;\n\n\tif (track->ms->setup(file, track) == AF_FAIL)\n\t\treturn -1;\n\n\treturn track->nextvframe;\n}"
  },
  {
    "function_name": "afGetVirtualFrameSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "89-99",
    "snippet": "float afGetVirtualFrameSize (AFfilehandle file, int trackid, int stretch3to4)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn _af_format_frame_size(&track->v, stretch3to4);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_format_frame_size",
          "args": [
            "&track->v",
            "stretch3to4"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "_af_format_frame_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "301-308",
          "snippet": "float _af_format_frame_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_frame_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nfloat _af_format_frame_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_frame_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nfloat afGetVirtualFrameSize (AFfilehandle file, int trackid, int stretch3to4)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn _af_format_frame_size(&track->v, stretch3to4);\n}"
  },
  {
    "function_name": "afGetFrameSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "77-87",
    "snippet": "float afGetFrameSize (AFfilehandle file, int trackid, int stretch3to4)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn _af_format_frame_size(&track->f, stretch3to4);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_format_frame_size",
          "args": [
            "&track->f",
            "stretch3to4"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "_af_format_frame_size",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "301-308",
          "snippet": "float _af_format_frame_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_frame_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nfloat _af_format_frame_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_frame_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}"
        }
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nfloat afGetFrameSize (AFfilehandle file, int trackid, int stretch3to4)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn _af_format_frame_size(&track->f, stretch3to4);\n}"
  },
  {
    "function_name": "afGetTrackBytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "58-68",
    "snippet": "AFfileoffset afGetTrackBytes (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->data_size;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nAFfileoffset afGetTrackBytes (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->data_size;\n}"
  },
  {
    "function_name": "afGetDataOffset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/format.cpp",
    "lines": "46-56",
    "snippet": "AFfileoffset afGetDataOffset (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->fpos_first_frame;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"modules/ModuleState.h\"",
      "#include \"modules/Module.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"modules/ModuleState.h\"\n#include \"modules/Module.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <assert.h>\n#include \"config.h\"\n\nAFfileoffset afGetDataOffset (AFfilehandle file, int trackid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\treturn track->fpos_first_frame;\n}"
  }
]