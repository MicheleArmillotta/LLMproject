[
  {
    "function_name": "afSeekMisc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "192-213",
    "snippet": "int afSeekMisc (AFfilehandle file, int miscellaneousid, int offset)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (!miscellaneous)\n\t\treturn -1;\n\n\tif (offset >= miscellaneous->size)\n\t{\n\t\t_af_error(AF_BAD_MISCSEEK,\n\t\t\t\"offset %d too big for miscellaneous chunk %d \"\n\t\t\t\"(%d data bytes)\",\n\t\t\toffset, miscellaneousid, miscellaneous->size);\n\t\treturn -1;\n\t}\n\n\tmiscellaneous->position = offset;\n\n\treturn offset;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_MISCSEEK",
            "\"offset %d too big for miscellaneous chunk %d \"\n\t\t\t\"(%d data bytes)\"",
            "offset",
            "miscellaneousid",
            "miscellaneous->size"
          ],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getMiscellaneous",
          "args": [
            "miscellaneousid"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 194
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nint afSeekMisc (AFfilehandle file, int miscellaneousid, int offset)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (!miscellaneous)\n\t\treturn -1;\n\n\tif (offset >= miscellaneous->size)\n\t{\n\t\t_af_error(AF_BAD_MISCSEEK,\n\t\t\t\"offset %d too big for miscellaneous chunk %d \"\n\t\t\t\"(%d data bytes)\",\n\t\t\toffset, miscellaneousid, miscellaneous->size);\n\t\treturn -1;\n\t}\n\n\tmiscellaneous->position = offset;\n\n\treturn offset;\n}"
  },
  {
    "function_name": "afReadMisc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "166-190",
    "snippet": "int afReadMisc (AFfilehandle file, int miscellaneousid, void *buf, int bytes)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (!file->checkCanRead())\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (!miscellaneous)\n\t\treturn -1;\n\n\tif (bytes <= 0)\n\t{\n\t\t_af_error(AF_BAD_MISCSIZE, \"invalid size (%d) for miscellaneous chunk\", bytes);\n\t\treturn -1;\n\t}\n\n\tint localsize = std::min(bytes,\n\t\tmiscellaneous->size - miscellaneous->position);\n\tmemcpy(buf, (char *) miscellaneous->buffer + miscellaneous->position,\n\t\tlocalsize);\n\tmiscellaneous->position += localsize;\n\treturn localsize;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "(char *) miscellaneous->buffer + miscellaneous->position",
            "localsize"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::min",
          "args": [
            "bytes",
            "miscellaneous->size - miscellaneous->position"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_MISCSIZE",
            "\"invalid size (%d) for miscellaneous chunk\"",
            "bytes"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getMiscellaneous",
          "args": [
            "miscellaneousid"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->checkCanRead",
          "args": [],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "checkCanRead",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "177-186",
          "snippet": "bool _AFfilehandle::checkCanRead()\n{\n\tif (m_access != _AF_READ_ACCESS)\n\t{\n\t\t_af_error(AF_BAD_NOREADACC, \"file not opened for read access\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::checkCanRead()\n  {\n  \tif (m_access != _AF_READ_ACCESS)\n  \t{\n  \t\t_af_error(AF_BAD_NOREADACC, \"file not opened for read access\");\n  \t\treturn false;\n  \t}\n  \n  \treturn true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nint afReadMisc (AFfilehandle file, int miscellaneousid, void *buf, int bytes)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (!file->checkCanRead())\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (!miscellaneous)\n\t\treturn -1;\n\n\tif (bytes <= 0)\n\t{\n\t\t_af_error(AF_BAD_MISCSIZE, \"invalid size (%d) for miscellaneous chunk\", bytes);\n\t\treturn -1;\n\t}\n\n\tint localsize = std::min(bytes,\n\t\tmiscellaneous->size - miscellaneous->position);\n\tmemcpy(buf, (char *) miscellaneous->buffer + miscellaneous->position,\n\t\tlocalsize);\n\tmiscellaneous->position += localsize;\n\treturn localsize;\n}"
  },
  {
    "function_name": "afWriteMisc",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "132-164",
    "snippet": "int afWriteMisc (AFfilehandle file, int miscellaneousid, const void *buf, int bytes)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (!file->checkCanWrite())\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (!miscellaneous)\n\t\treturn -1;\n\n\tif (bytes <= 0)\n\t{\n\t\t_af_error(AF_BAD_MISCSIZE, \"invalid size (%d) for miscellaneous chunk\", bytes);\n\t\treturn -1;\n\t}\n\n\tif (miscellaneous->buffer == NULL && miscellaneous->size != 0)\n\t{\n\t\tmiscellaneous->buffer = _af_malloc(miscellaneous->size);\n\t\tif (miscellaneous->buffer == NULL)\n\t\t\treturn -1;\n\t\tmemset(miscellaneous->buffer, 0, miscellaneous->size);\n\t}\n\n\tint localsize = std::min(bytes,\n\t\tmiscellaneous->size - miscellaneous->position);\n\tmemcpy((char *) miscellaneous->buffer + miscellaneous->position,\n\t\tbuf, localsize);\n\tmiscellaneous->position += localsize;\n\treturn localsize;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "(char *) miscellaneous->buffer + miscellaneous->position",
            "buf",
            "localsize"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::min",
          "args": [
            "bytes",
            "miscellaneous->size - miscellaneous->position"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "miscellaneous->buffer",
            "0",
            "miscellaneous->size"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_malloc",
          "args": [
            "miscellaneous->size"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_MISCSIZE",
            "\"invalid size (%d) for miscellaneous chunk\"",
            "bytes"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getMiscellaneous",
          "args": [
            "miscellaneousid"
          ],
          "line": 140
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->checkCanWrite",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "checkCanWrite",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "188-197",
          "snippet": "bool _AFfilehandle::checkCanWrite()\n{\n\tif (m_access != _AF_WRITE_ACCESS)\n\t{\n\t\t_af_error(AF_BAD_NOWRITEACC, \"file not opened for write access\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::checkCanWrite()\n  {\n  \tif (m_access != _AF_WRITE_ACCESS)\n  \t{\n  \t\t_af_error(AF_BAD_NOWRITEACC, \"file not opened for write access\");\n  \t\treturn false;\n  \t}\n  \n  \treturn true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 134
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nint afWriteMisc (AFfilehandle file, int miscellaneousid, const void *buf, int bytes)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (!file->checkCanWrite())\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (!miscellaneous)\n\t\treturn -1;\n\n\tif (bytes <= 0)\n\t{\n\t\t_af_error(AF_BAD_MISCSIZE, \"invalid size (%d) for miscellaneous chunk\", bytes);\n\t\treturn -1;\n\t}\n\n\tif (miscellaneous->buffer == NULL && miscellaneous->size != 0)\n\t{\n\t\tmiscellaneous->buffer = _af_malloc(miscellaneous->size);\n\t\tif (miscellaneous->buffer == NULL)\n\t\t\treturn -1;\n\t\tmemset(miscellaneous->buffer, 0, miscellaneous->size);\n\t}\n\n\tint localsize = std::min(bytes,\n\t\tmiscellaneous->size - miscellaneous->position);\n\tmemcpy((char *) miscellaneous->buffer + miscellaneous->position,\n\t\tbuf, localsize);\n\tmiscellaneous->position += localsize;\n\treturn localsize;\n}"
  },
  {
    "function_name": "afGetMiscSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "121-130",
    "snippet": "int afGetMiscSize (AFfilehandle file, int miscellaneousid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (miscellaneous)\n\t\treturn miscellaneous->size;\n\treturn -1;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getMiscellaneous",
          "args": [
            "miscellaneousid"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nint afGetMiscSize (AFfilehandle file, int miscellaneousid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (miscellaneous)\n\t\treturn miscellaneous->size;\n\treturn -1;\n}"
  },
  {
    "function_name": "afInitMiscSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "111-119",
    "snippet": "void afInitMiscSize (AFfilesetup setup, int miscellaneousid, int size)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tMiscellaneousSetup *miscellaneous = setup->getMiscellaneous(miscellaneousid);\n\tif (miscellaneous)\n\t\tmiscellaneous->size = size;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setup->getMiscellaneous",
          "args": [
            "miscellaneousid"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nvoid afInitMiscSize (AFfilesetup setup, int miscellaneousid, int size)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tMiscellaneousSetup *miscellaneous = setup->getMiscellaneous(miscellaneousid);\n\tif (miscellaneous)\n\t\tmiscellaneous->size = size;\n}"
  },
  {
    "function_name": "afGetMiscType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "100-109",
    "snippet": "int afGetMiscType (AFfilehandle file, int miscellaneousid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (miscellaneous)\n\t\treturn miscellaneous->type;\n\treturn -1;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getMiscellaneous",
          "args": [
            "miscellaneousid"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nint afGetMiscType (AFfilehandle file, int miscellaneousid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tMiscellaneous *miscellaneous = file->getMiscellaneous(miscellaneousid);\n\tif (miscellaneous)\n\t\treturn miscellaneous->type;\n\treturn -1;\n}"
  },
  {
    "function_name": "afInitMiscType",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "90-98",
    "snippet": "void afInitMiscType (AFfilesetup setup, int miscellaneousid, int type)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tMiscellaneousSetup *miscellaneous = setup->getMiscellaneous(miscellaneousid);\n\tif (miscellaneous)\n\t\tmiscellaneous->type = type;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setup->getMiscellaneous",
          "args": [
            "miscellaneousid"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nvoid afInitMiscType (AFfilesetup setup, int miscellaneousid, int type)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tMiscellaneousSetup *miscellaneous = setup->getMiscellaneous(miscellaneousid);\n\tif (miscellaneous)\n\t\tmiscellaneous->type = type;\n}"
  },
  {
    "function_name": "afGetMiscIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "74-88",
    "snippet": "int afGetMiscIDs (AFfilehandle file, int *ids)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (ids != NULL)\n\t{\n\t\tfor (int i=0; i<file->m_miscellaneousCount; i++)\n\t\t{\n\t\t\tids[i] = file->m_miscellaneous[i].id;\n\t\t}\n\t}\n\n\treturn file->m_miscellaneousCount;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nint afGetMiscIDs (AFfilehandle file, int *ids)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (ids != NULL)\n\t{\n\t\tfor (int i=0; i<file->m_miscellaneousCount; i++)\n\t\t{\n\t\t\tids[i] = file->m_miscellaneous[i].id;\n\t\t}\n\t}\n\n\treturn file->m_miscellaneousCount;\n}"
  },
  {
    "function_name": "afInitMiscIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Miscellaneous.cpp",
    "lines": "41-72",
    "snippet": "void afInitMiscIDs (AFfilesetup setup, const int *ids, int nids)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tif (setup->miscellaneous != NULL)\n\t{\n\t\tfree(setup->miscellaneous);\n\t}\n\n\tsetup->miscellaneousCount = nids;\n\n\tif (nids == 0)\n\t\tsetup->miscellaneous = NULL;\n\telse\n\t{\n\t\tsetup->miscellaneous = (MiscellaneousSetup *) _af_calloc(nids,\n\t\t\tsizeof (MiscellaneousSetup));\n\n\t\tif (setup->miscellaneous == NULL)\n\t\t\treturn;\n\n\t\tfor (int i=0; i<nids; i++)\n\t\t{\n\t\t\tsetup->miscellaneous[i].id = ids[i];\n\t\t\tsetup->miscellaneous[i].type = 0;\n\t\t\tsetup->miscellaneous[i].size = 0;\n\t\t}\n\t}\n\n\tsetup->miscellaneousSet = true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdint.h>",
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_calloc",
          "args": [
            "nids",
            "sizeof (MiscellaneousSetup)"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "setup->miscellaneous"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include <stdint.h>\n#include <algorithm>\n#include \"config.h\"\n\nvoid afInitMiscIDs (AFfilesetup setup, const int *ids, int nids)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tif (setup->miscellaneous != NULL)\n\t{\n\t\tfree(setup->miscellaneous);\n\t}\n\n\tsetup->miscellaneousCount = nids;\n\n\tif (nids == 0)\n\t\tsetup->miscellaneous = NULL;\n\telse\n\t{\n\t\tsetup->miscellaneous = (MiscellaneousSetup *) _af_calloc(nids,\n\t\t\tsizeof (MiscellaneousSetup));\n\n\t\tif (setup->miscellaneous == NULL)\n\t\t\treturn;\n\n\t\tfor (int i=0; i<nids; i++)\n\t\t{\n\t\t\tsetup->miscellaneous[i].id = ids[i];\n\t\t\tsetup->miscellaneous[i].type = 0;\n\t\t\tsetup->miscellaneous[i].size = 0;\n\t\t}\n\t}\n\n\tsetup->miscellaneousSet = true;\n}"
  }
]