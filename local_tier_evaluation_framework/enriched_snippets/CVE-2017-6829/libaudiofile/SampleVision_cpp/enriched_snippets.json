[
  {
    "function_name": "writeMarkers",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "336-348",
    "snippet": "status SampleVisionFile::writeMarkers()\n{\n\tfor (int i=0; i<8; i++)\n\t{\n\t\tchar name[kSMPMarkerNameLength + 1];\n\t\tmemset(name, ' ', kSMPMarkerNameLength);\n\t\tname[kSMPMarkerNameLength] = '\\0';\n\t\tm_fh->write(name, kSMPMarkerNameLength);\n\t\tuint32_t position = kSMPInvalidSamplePosition;\n\t\twriteU32(&position);\n\t}\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned kSMPMarkerNameLength = 10;",
      "static const uint32_t kSMPInvalidSamplePosition = 0xffffffffu;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeU32",
          "args": [
            "&position"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "writeU32",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "443-446",
          "snippet": "bool _AFfilehandle::writeU32(const uint32_t *v)\n{\n\treturn writeSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU32(const uint32_t *v)\n  {\n  \treturn writeSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_fh->write",
          "args": [
            "name",
            "kSMPMarkerNameLength"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "177-180",
          "snippet": "ssize_t FileVF::write(const void *data, size_t nbytes)\n{\n\treturn m_vf->write(m_vf, data, nbytes);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  ssize_t FileVF::write(const void *data, size_t nbytes)\n  {\n  \treturn m_vf->write(m_vf, data, nbytes);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "name",
            "' '",
            "kSMPMarkerNameLength"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const unsigned kSMPMarkerNameLength = 10;\nstatic const uint32_t kSMPInvalidSamplePosition = 0xffffffffu;\n\nSampleVisionFile {\n  status SampleVisionFile::writeMarkers()\n  {\n  \tfor (int i=0; i<8; i++)\n  \t{\n  \t\tchar name[kSMPMarkerNameLength + 1];\n  \t\tmemset(name, ' ', kSMPMarkerNameLength);\n  \t\tname[kSMPMarkerNameLength] = '\\0';\n  \t\tm_fh->write(name, kSMPMarkerNameLength);\n  \t\tuint32_t position = kSMPInvalidSamplePosition;\n  \t\twriteU32(&position);\n  \t}\n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "writeLoops",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "321-334",
    "snippet": "status SampleVisionFile::writeLoops()\n{\n\tfor (int i=0; i<8; i++)\n\t{\n\t\tuint32_t startFrame = kSMPInvalidSamplePosition, endFrame = 0;\n\t\tuint8_t type = 0;\n\t\tuint16_t count = 0;\n\t\twriteU32(&startFrame);\n\t\twriteU32(&endFrame);\n\t\twriteU8(&type);\n\t\twriteU16(&count);\n\t}\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const uint32_t kSMPInvalidSamplePosition = 0xffffffffu;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeU16",
          "args": [
            "&count"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "writeU16",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "433-436",
          "snippet": "bool _AFfilehandle::writeU16(const uint16_t *v)\n{\n\treturn writeSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU16(const uint16_t *v)\n  {\n  \treturn writeSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeU8",
          "args": [
            "&type"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "writeU8",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "430-430",
          "snippet": "bool _AFfilehandle::writeU8(const uint8_t *v) { return writeValue(m_fh, v); }",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU8(const uint8_t *v) { return writeValue(m_fh, v); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeU32",
          "args": [
            "&endFrame"
          ],
          "line": 329
        },
        "resolved": true,
        "details": {
          "function_name": "writeU32",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "443-446",
          "snippet": "bool _AFfilehandle::writeU32(const uint32_t *v)\n{\n\treturn writeSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU32(const uint32_t *v)\n  {\n  \treturn writeSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const uint32_t kSMPInvalidSamplePosition = 0xffffffffu;\n\nSampleVisionFile {\n  status SampleVisionFile::writeLoops()\n  {\n  \tfor (int i=0; i<8; i++)\n  \t{\n  \t\tuint32_t startFrame = kSMPInvalidSamplePosition, endFrame = 0;\n  \t\tuint8_t type = 0;\n  \t\tuint16_t count = 0;\n  \t\twriteU32(&startFrame);\n  \t\twriteU32(&endFrame);\n  \t\twriteU8(&type);\n  \t\twriteU16(&count);\n  \t}\n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "writeTrailer",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "297-319",
    "snippet": "status SampleVisionFile::writeTrailer()\n{\n\tTrack *track = getTrack();\n\n\tm_fh->seek(track->fpos_after_data, File::SeekFromBeginning);\n\n\tuint16_t reserved = 0;\n\twriteU16(&reserved);\n\n\twriteLoops();\n\twriteMarkers();\n\n\tuint8_t midiNote = kSMPMIDIUnityPlaybackNote;\n\tuint32_t sampleRate = track->f.sampleRate;\n\tuint32_t smpteOffset = 0;\n\tuint32_t cycleLength = 0;\n\n\twriteU8(&midiNote);\n\twriteU32(&sampleRate);\n\twriteU32(&smpteOffset);\n\twriteU32(&cycleLength);\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const uint8_t kSMPMIDIUnityPlaybackNote = 60;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeU32",
          "args": [
            "&cycleLength"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "writeU32",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "443-446",
          "snippet": "bool _AFfilehandle::writeU32(const uint32_t *v)\n{\n\treturn writeSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU32(const uint32_t *v)\n  {\n  \treturn writeSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeU8",
          "args": [
            "&midiNote"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "writeU8",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "430-430",
          "snippet": "bool _AFfilehandle::writeU8(const uint8_t *v) { return writeValue(m_fh, v); }",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU8(const uint8_t *v) { return writeValue(m_fh, v); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeMarkers",
          "args": [],
          "line": 307
        },
        "resolved": true,
        "details": {
          "function_name": "writeMarkers",
          "container": "SampleVisionFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
          "lines": "336-348",
          "snippet": "status SampleVisionFile::writeMarkers()\n{\n\tfor (int i=0; i<8; i++)\n\t{\n\t\tchar name[kSMPMarkerNameLength + 1];\n\t\tmemset(name, ' ', kSMPMarkerNameLength);\n\t\tname[kSMPMarkerNameLength] = '\\0';\n\t\tm_fh->write(name, kSMPMarkerNameLength);\n\t\tuint32_t position = kSMPInvalidSamplePosition;\n\t\twriteU32(&position);\n\t}\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"util.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"File.h\"",
            "#include \"SampleVision.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned kSMPMarkerNameLength = 10;",
            "static const uint32_t kSMPInvalidSamplePosition = 0xffffffffu;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const unsigned kSMPMarkerNameLength = 10;\nstatic const uint32_t kSMPInvalidSamplePosition = 0xffffffffu;\n\nSampleVisionFile {\n  status SampleVisionFile::writeMarkers()\n  {\n  \tfor (int i=0; i<8; i++)\n  \t{\n  \t\tchar name[kSMPMarkerNameLength + 1];\n  \t\tmemset(name, ' ', kSMPMarkerNameLength);\n  \t\tname[kSMPMarkerNameLength] = '\\0';\n  \t\tm_fh->write(name, kSMPMarkerNameLength);\n  \t\tuint32_t position = kSMPInvalidSamplePosition;\n  \t\twriteU32(&position);\n  \t}\n  \treturn AF_SUCCEED;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeLoops",
          "args": [],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "writeLoops",
          "container": "SampleVisionFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
          "lines": "321-334",
          "snippet": "status SampleVisionFile::writeLoops()\n{\n\tfor (int i=0; i<8; i++)\n\t{\n\t\tuint32_t startFrame = kSMPInvalidSamplePosition, endFrame = 0;\n\t\tuint8_t type = 0;\n\t\tuint16_t count = 0;\n\t\twriteU32(&startFrame);\n\t\twriteU32(&endFrame);\n\t\twriteU8(&type);\n\t\twriteU16(&count);\n\t}\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"util.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"File.h\"",
            "#include \"SampleVision.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const uint32_t kSMPInvalidSamplePosition = 0xffffffffu;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const uint32_t kSMPInvalidSamplePosition = 0xffffffffu;\n\nSampleVisionFile {\n  status SampleVisionFile::writeLoops()\n  {\n  \tfor (int i=0; i<8; i++)\n  \t{\n  \t\tuint32_t startFrame = kSMPInvalidSamplePosition, endFrame = 0;\n  \t\tuint8_t type = 0;\n  \t\tuint16_t count = 0;\n  \t\twriteU32(&startFrame);\n  \t\twriteU32(&endFrame);\n  \t\twriteU8(&type);\n  \t\twriteU16(&count);\n  \t}\n  \treturn AF_SUCCEED;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeU16",
          "args": [
            "&reserved"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "writeU16",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "433-436",
          "snippet": "bool _AFfilehandle::writeU16(const uint16_t *v)\n{\n\treturn writeSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU16(const uint16_t *v)\n  {\n  \treturn writeSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_fh->seek",
          "args": [
            "track->fpos_after_data",
            "File::SeekFromBeginning"
          ],
          "line": 301
        },
        "resolved": true,
        "details": {
          "function_name": "seek",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "187-192",
          "snippet": "off_t FileVF::seek(off_t offset, SeekOrigin origin)\n{\n\tif (origin == SeekFromEnd)\n\t\toffset += length();\n\treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  off_t FileVF::seek(off_t offset, SeekOrigin origin)\n  {\n  \tif (origin == SeekFromEnd)\n  \t\toffset += length();\n  \treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getTrack",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const uint8_t kSMPMIDIUnityPlaybackNote = 60;\n\nSampleVisionFile {\n  status SampleVisionFile::writeTrailer()\n  {\n  \tTrack *track = getTrack();\n  \n  \tm_fh->seek(track->fpos_after_data, File::SeekFromBeginning);\n  \n  \tuint16_t reserved = 0;\n  \twriteU16(&reserved);\n  \n  \twriteLoops();\n  \twriteMarkers();\n  \n  \tuint8_t midiNote = kSMPMIDIUnityPlaybackNote;\n  \tuint32_t sampleRate = track->f.sampleRate;\n  \tuint32_t smpteOffset = 0;\n  \tuint32_t cycleLength = 0;\n  \n  \twriteU8(&midiNote);\n  \twriteU32(&sampleRate);\n  \twriteU32(&smpteOffset);\n  \twriteU32(&cycleLength);\n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "update",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "287-295",
    "snippet": "status SampleVisionFile::update()\n{\n\tm_fh->seek(m_frameCountOffset, File::SeekFromBeginning);\n\tTrack *track = getTrack();\n\tuint32_t frameCount = track->totalfframes;\n\twriteU32(&frameCount);\n\twriteTrailer();\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "writeTrailer",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "writeTrailer",
          "container": "SampleVisionFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
          "lines": "297-319",
          "snippet": "status SampleVisionFile::writeTrailer()\n{\n\tTrack *track = getTrack();\n\n\tm_fh->seek(track->fpos_after_data, File::SeekFromBeginning);\n\n\tuint16_t reserved = 0;\n\twriteU16(&reserved);\n\n\twriteLoops();\n\twriteMarkers();\n\n\tuint8_t midiNote = kSMPMIDIUnityPlaybackNote;\n\tuint32_t sampleRate = track->f.sampleRate;\n\tuint32_t smpteOffset = 0;\n\tuint32_t cycleLength = 0;\n\n\twriteU8(&midiNote);\n\twriteU32(&sampleRate);\n\twriteU32(&smpteOffset);\n\twriteU32(&cycleLength);\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"util.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"File.h\"",
            "#include \"SampleVision.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const uint8_t kSMPMIDIUnityPlaybackNote = 60;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const uint8_t kSMPMIDIUnityPlaybackNote = 60;\n\nSampleVisionFile {\n  status SampleVisionFile::writeTrailer()\n  {\n  \tTrack *track = getTrack();\n  \n  \tm_fh->seek(track->fpos_after_data, File::SeekFromBeginning);\n  \n  \tuint16_t reserved = 0;\n  \twriteU16(&reserved);\n  \n  \twriteLoops();\n  \twriteMarkers();\n  \n  \tuint8_t midiNote = kSMPMIDIUnityPlaybackNote;\n  \tuint32_t sampleRate = track->f.sampleRate;\n  \tuint32_t smpteOffset = 0;\n  \tuint32_t cycleLength = 0;\n  \n  \twriteU8(&midiNote);\n  \twriteU32(&sampleRate);\n  \twriteU32(&smpteOffset);\n  \twriteU32(&cycleLength);\n  \treturn AF_SUCCEED;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "writeU32",
          "args": [
            "&frameCount"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "writeU32",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "443-446",
          "snippet": "bool _AFfilehandle::writeU32(const uint32_t *v)\n{\n\treturn writeSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU32(const uint32_t *v)\n  {\n  \treturn writeSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getTrack",
          "args": [],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_fh->seek",
          "args": [
            "m_frameCountOffset",
            "File::SeekFromBeginning"
          ],
          "line": 289
        },
        "resolved": true,
        "details": {
          "function_name": "seek",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "187-192",
          "snippet": "off_t FileVF::seek(off_t offset, SeekOrigin origin)\n{\n\tif (origin == SeekFromEnd)\n\t\toffset += length();\n\treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  off_t FileVF::seek(off_t offset, SeekOrigin origin)\n  {\n  \tif (origin == SeekFromEnd)\n  \t\toffset += length();\n  \treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nSampleVisionFile {\n  status SampleVisionFile::update()\n  {\n  \tm_fh->seek(m_frameCountOffset, File::SeekFromBeginning);\n  \tTrack *track = getTrack();\n  \tuint32_t frameCount = track->totalfframes;\n  \twriteU32(&frameCount);\n  \twriteTrailer();\n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "writeInit",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "262-285",
    "snippet": "status SampleVisionFile::writeInit(AFfilesetup setup)\n{\n\tif (initFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\n\tm_fh->write(kSMPMagic, kSMPMagicLength);\n\tm_fh->write(kSMPVersion, kSMPVersionLength);\n\n\tchar name[kSMPNameLength + 1];\n\tchar comment[kSMPCommentLength + 1];\n\tmemset(name, ' ', kSMPNameLength);\n\tmemset(comment, ' ', kSMPCommentLength);\n\tm_fh->write(name, kSMPNameLength);\n\tm_fh->write(comment, kSMPCommentLength);\n\n\tuint32_t frameCount = 0;\n\tm_frameCountOffset = m_fh->tell();\n\twriteU32(&frameCount);\n\n\tTrack *track = getTrack();\n\ttrack->fpos_first_frame = m_fh->tell();\n\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *kSMPMagic = \"SOUND SAMPLE DATA \";",
      "static const unsigned kSMPMagicLength = 18;",
      "static const char *kSMPVersion = \"2.1 \";",
      "static const unsigned kSMPVersionLength = 4;",
      "static const unsigned kSMPNameLength = 30;",
      "static const unsigned kSMPCommentLength = 60;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_fh->tell",
          "args": [],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "tell",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "194-197",
          "snippet": "off_t FileVF::tell()\n{\n\treturn m_vf->tell(m_vf);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  off_t FileVF::tell()\n  {\n  \treturn m_vf->tell(m_vf);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "getTrack",
          "args": [],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "writeU32",
          "args": [
            "&frameCount"
          ],
          "line": 279
        },
        "resolved": true,
        "details": {
          "function_name": "writeU32",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "443-446",
          "snippet": "bool _AFfilehandle::writeU32(const uint32_t *v)\n{\n\treturn writeSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::writeU32(const uint32_t *v)\n  {\n  \treturn writeSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_fh->write",
          "args": [
            "comment",
            "kSMPCommentLength"
          ],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "177-180",
          "snippet": "ssize_t FileVF::write(const void *data, size_t nbytes)\n{\n\treturn m_vf->write(m_vf, data, nbytes);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  ssize_t FileVF::write(const void *data, size_t nbytes)\n  {\n  \treturn m_vf->write(m_vf, data, nbytes);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "comment",
            "' '",
            "kSMPCommentLength"
          ],
          "line": 273
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "name",
            "' '",
            "kSMPNameLength"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "initFromSetup",
          "args": [
            "setup"
          ],
          "line": 264
        },
        "resolved": true,
        "details": {
          "function_name": "initFromSetup",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "222-231",
          "snippet": "status _AFfilehandle::initFromSetup(AFfilesetup setup)\n{\n\tif (copyTracksFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\tif (copyInstrumentsFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\tif (copyMiscellaneousFromSetup(setup) == AF_FAIL)\n\t\treturn AF_FAIL;\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  status _AFfilehandle::initFromSetup(AFfilesetup setup)\n  {\n  \tif (copyTracksFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \tif (copyInstrumentsFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \tif (copyMiscellaneousFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \treturn AF_SUCCEED;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const char *kSMPMagic = \"SOUND SAMPLE DATA \";\nstatic const unsigned kSMPMagicLength = 18;\nstatic const char *kSMPVersion = \"2.1 \";\nstatic const unsigned kSMPVersionLength = 4;\nstatic const unsigned kSMPNameLength = 30;\nstatic const unsigned kSMPCommentLength = 60;\n\nSampleVisionFile {\n  status SampleVisionFile::writeInit(AFfilesetup setup)\n  {\n  \tif (initFromSetup(setup) == AF_FAIL)\n  \t\treturn AF_FAIL;\n  \n  \tm_fh->write(kSMPMagic, kSMPMagicLength);\n  \tm_fh->write(kSMPVersion, kSMPVersionLength);\n  \n  \tchar name[kSMPNameLength + 1];\n  \tchar comment[kSMPCommentLength + 1];\n  \tmemset(name, ' ', kSMPNameLength);\n  \tmemset(comment, ' ', kSMPCommentLength);\n  \tm_fh->write(name, kSMPNameLength);\n  \tm_fh->write(comment, kSMPCommentLength);\n  \n  \tuint32_t frameCount = 0;\n  \tm_frameCountOffset = m_fh->tell();\n  \twriteU32(&frameCount);\n  \n  \tTrack *track = getTrack();\n  \ttrack->fpos_first_frame = m_fh->tell();\n  \n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "addMiscellaneous",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "247-260",
    "snippet": "void SampleVisionFile::addMiscellaneous(int type, const char *data)\n{\n\tm_miscellaneousCount++;\n\tm_miscellaneous = (Miscellaneous *) _af_realloc(m_miscellaneous,\n\t\tm_miscellaneousCount * sizeof (Miscellaneous));\n\n\tMiscellaneous &m = m_miscellaneous[m_miscellaneousCount - 1];\n\tm.id = m_miscellaneousCount;\n\tm.type = type;\n\tm.size = strlen(data);\n\tm.position = 0;\n\tm.buffer = _af_malloc(m.size);\n\tmemcpy(m.buffer, data, m.size);\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m.buffer",
            "data",
            "m.size"
          ],
          "line": 259
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_malloc",
          "args": [
            "m.size"
          ],
          "line": 258
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "data"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_realloc",
          "args": [
            "m_miscellaneous",
            "m_miscellaneousCount * sizeof (Miscellaneous)"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nSampleVisionFile {\n  void SampleVisionFile::addMiscellaneous(int type, const char *data)\n  {\n  \tm_miscellaneousCount++;\n  \tm_miscellaneous = (Miscellaneous *) _af_realloc(m_miscellaneous,\n  \t\tm_miscellaneousCount * sizeof (Miscellaneous));\n  \n  \tMiscellaneous &m = m_miscellaneous[m_miscellaneousCount - 1];\n  \tm.id = m_miscellaneousCount;\n  \tm.type = type;\n  \tm.size = strlen(data);\n  \tm.position = 0;\n  \tm.buffer = _af_malloc(m.size);\n  \tmemcpy(m.buffer, data, m.size);\n  }\n}"
  },
  {
    "function_name": "parseMarkers",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "234-245",
    "snippet": "status SampleVisionFile::parseMarkers()\n{\n\tfor (int i=0; i<8; i++)\n\t{\n\t\tchar name[kSMPMarkerNameLength + 1];\n\t\tm_fh->read(name, kSMPMarkerNameLength);\n\t\tname[kSMPMarkerNameLength] = '\\0';\n\t\tuint32_t position;\n\t\treadU32(&position);\n\t}\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned kSMPMarkerNameLength = 10;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "readU32",
          "args": [
            "&position"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "readU32",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "400-403",
          "snippet": "bool _AFfilehandle::readU32(uint32_t *v)\n{\n\treturn readSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::readU32(uint32_t *v)\n  {\n  \treturn readSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_fh->read",
          "args": [
            "name",
            "kSMPMarkerNameLength"
          ],
          "line": 239
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "172-175",
          "snippet": "ssize_t FileVF::read(void *data, size_t nbytes)\n{\n\treturn m_vf->read(m_vf, data, nbytes);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  ssize_t FileVF::read(void *data, size_t nbytes)\n  {\n  \treturn m_vf->read(m_vf, data, nbytes);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const unsigned kSMPMarkerNameLength = 10;\n\nSampleVisionFile {\n  status SampleVisionFile::parseMarkers()\n  {\n  \tfor (int i=0; i<8; i++)\n  \t{\n  \t\tchar name[kSMPMarkerNameLength + 1];\n  \t\tm_fh->read(name, kSMPMarkerNameLength);\n  \t\tname[kSMPMarkerNameLength] = '\\0';\n  \t\tuint32_t position;\n  \t\treadU32(&position);\n  \t}\n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "parseLoops",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "219-232",
    "snippet": "status SampleVisionFile::parseLoops()\n{\n\tfor (int i=0; i<8; i++)\n\t{\n\t\tuint32_t startFrame, endFrame;\n\t\tuint8_t type;\n\t\tuint16_t count;\n\t\treadU32(&startFrame);\n\t\treadU32(&endFrame);\n\t\treadU8(&type);\n\t\treadU16(&count);\n\t}\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "readU16",
          "args": [
            "&count"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "readU16",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "390-393",
          "snippet": "bool _AFfilehandle::readU16(uint16_t *v)\n{\n\treturn readSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::readU16(uint16_t *v)\n  {\n  \treturn readSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readU8",
          "args": [
            "&type"
          ],
          "line": 228
        },
        "resolved": true,
        "details": {
          "function_name": "readU8",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "387-387",
          "snippet": "bool _AFfilehandle::readU8(uint8_t *v) { return readValue(m_fh, v); }",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::readU8(uint8_t *v) { return readValue(m_fh, v); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readU32",
          "args": [
            "&endFrame"
          ],
          "line": 227
        },
        "resolved": true,
        "details": {
          "function_name": "readU32",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "400-403",
          "snippet": "bool _AFfilehandle::readU32(uint32_t *v)\n{\n\treturn readSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::readU32(uint32_t *v)\n  {\n  \treturn readSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nSampleVisionFile {\n  status SampleVisionFile::parseLoops()\n  {\n  \tfor (int i=0; i<8; i++)\n  \t{\n  \t\tuint32_t startFrame, endFrame;\n  \t\tuint8_t type;\n  \t\tuint16_t count;\n  \t\treadU32(&startFrame);\n  \t\treadU32(&endFrame);\n  \t\treadU8(&type);\n  \t\treadU16(&count);\n  \t}\n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "readInit",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "152-217",
    "snippet": "status SampleVisionFile::readInit(AFfilesetup)\n{\n\tm_fh->seek(0, File::SeekFromBeginning);\n\n\tchar magic[kSMPMagicLength];\n\tif (m_fh->read(magic, kSMPMagicLength) != (ssize_t) kSMPMagicLength)\n\t\treturn AF_FAIL;\n\tif (strncmp(magic, kSMPMagic, kSMPMagicLength) != 0)\n\t\treturn AF_FAIL;\n\n\tchar version[kSMPVersionLength];\n\tif (m_fh->read(version, kSMPVersionLength) != (ssize_t) kSMPVersionLength)\n\t\treturn AF_FAIL;\n\tif (strncmp(version, kSMPVersion, kSMPVersionLength) != 0)\n\t\treturn AF_FAIL;\n\n\tTrack *track = allocateTrack();\n\n\tchar name[kSMPNameLength + 1];\n\tm_fh->read(name, kSMPNameLength);\n\tname[kSMPNameLength] = '\\0';\n\ttrimTrailingSpaces(name);\n\tif (strlen(name) > 0)\n\t\taddMiscellaneous(AF_MISC_NAME, name);\n\n\tchar comment[kSMPCommentLength + 1];\n\tm_fh->read(comment, kSMPCommentLength);\n\tcomment[kSMPCommentLength] = '\\0';\n\ttrimTrailingSpaces(comment);\n\tif (strlen(comment) > 0)\n\t\taddMiscellaneous(AF_MISC_COMMENT, comment);\n\n\tuint32_t frameCount;\n\treadU32(&frameCount);\n\ttrack->totalfframes = frameCount;\n\ttrack->fpos_first_frame = m_fh->tell();\n\ttrack->data_size = 2 * frameCount;\n\n\tm_fh->seek(track->data_size, File::SeekFromCurrent);\n\n\tuint16_t reserved;\n\treadU16(&reserved);\n\n\tparseLoops();\n\tparseMarkers();\n\n\tuint8_t midiNote;\n\tuint32_t sampleRate;\n\tuint32_t smpteOffset;\n\tuint32_t cycleLength;\n\n\treadU8(&midiNote);\n\treadU32(&sampleRate);\n\treadU32(&smpteOffset);\n\treadU32(&cycleLength);\n\n\ttrack->f.byteOrder = AF_BYTEORDER_LITTLEENDIAN;\n\ttrack->f.sampleRate = sampleRate;\n\ttrack->f.channelCount = 1;\n\ttrack->f.compressionType = AF_COMPRESSION_NONE;\n\ttrack->f.framesPerPacket = 1;\n\t_af_set_sample_format(&track->f, AF_SAMPFMT_TWOSCOMP, 16);\n\ttrack->f.computeBytesPerPacketPCM();\n\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *kSMPMagic = \"SOUND SAMPLE DATA \";",
      "static const unsigned kSMPMagicLength = 18;",
      "static const char *kSMPVersion = \"2.1 \";",
      "static const unsigned kSMPVersionLength = 4;",
      "static const unsigned kSMPNameLength = 30;",
      "static const unsigned kSMPCommentLength = 60;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->f.computeBytesPerPacketPCM",
          "args": [],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "computeBytesPerPacketPCM",
          "container": "AudioFormat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/AudioFormat.cpp",
          "lines": "98-103",
          "snippet": "void AudioFormat::computeBytesPerPacketPCM()\n{\n\tassert(isUncompressed());\n\tint bytesPerSample = (sampleWidth + 7) / 8;\n\tbytesPerPacket = bytesPerSample * channelCount;\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <assert.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"AudioFormat.h\"\n#include \"config.h\"\n\nAudioFormat {\n  void AudioFormat::computeBytesPerPacketPCM()\n  {\n  \tassert(isUncompressed());\n  \tint bytesPerSample = (sampleWidth + 7) / 8;\n  \tbytesPerPacket = bytesPerSample * channelCount;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_set_sample_format",
          "args": [
            "&track->f",
            "AF_SAMPFMT_TWOSCOMP",
            "16"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "_af_set_sample_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "315-361",
          "snippet": "status _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatus _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "readU32",
          "args": [
            "&cycleLength"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "readU32",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "400-403",
          "snippet": "bool _AFfilehandle::readU32(uint32_t *v)\n{\n\treturn readSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::readU32(uint32_t *v)\n  {\n  \treturn readSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readU8",
          "args": [
            "&midiNote"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "readU8",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "387-387",
          "snippet": "bool _AFfilehandle::readU8(uint8_t *v) { return readValue(m_fh, v); }",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::readU8(uint8_t *v) { return readValue(m_fh, v); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parseMarkers",
          "args": [],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "parseMarkers",
          "container": "SampleVisionFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
          "lines": "234-245",
          "snippet": "status SampleVisionFile::parseMarkers()\n{\n\tfor (int i=0; i<8; i++)\n\t{\n\t\tchar name[kSMPMarkerNameLength + 1];\n\t\tm_fh->read(name, kSMPMarkerNameLength);\n\t\tname[kSMPMarkerNameLength] = '\\0';\n\t\tuint32_t position;\n\t\treadU32(&position);\n\t}\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"util.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"File.h\"",
            "#include \"SampleVision.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned kSMPMarkerNameLength = 10;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const unsigned kSMPMarkerNameLength = 10;\n\nSampleVisionFile {\n  status SampleVisionFile::parseMarkers()\n  {\n  \tfor (int i=0; i<8; i++)\n  \t{\n  \t\tchar name[kSMPMarkerNameLength + 1];\n  \t\tm_fh->read(name, kSMPMarkerNameLength);\n  \t\tname[kSMPMarkerNameLength] = '\\0';\n  \t\tuint32_t position;\n  \t\treadU32(&position);\n  \t}\n  \treturn AF_SUCCEED;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parseLoops",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "parseLoops",
          "container": "SampleVisionFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
          "lines": "219-232",
          "snippet": "status SampleVisionFile::parseLoops()\n{\n\tfor (int i=0; i<8; i++)\n\t{\n\t\tuint32_t startFrame, endFrame;\n\t\tuint8_t type;\n\t\tuint16_t count;\n\t\treadU32(&startFrame);\n\t\treadU32(&endFrame);\n\t\treadU8(&type);\n\t\treadU16(&count);\n\t}\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include <string.h>",
            "#include \"util.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"File.h\"",
            "#include \"SampleVision.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nSampleVisionFile {\n  status SampleVisionFile::parseLoops()\n  {\n  \tfor (int i=0; i<8; i++)\n  \t{\n  \t\tuint32_t startFrame, endFrame;\n  \t\tuint8_t type;\n  \t\tuint16_t count;\n  \t\treadU32(&startFrame);\n  \t\treadU32(&endFrame);\n  \t\treadU8(&type);\n  \t\treadU16(&count);\n  \t}\n  \treturn AF_SUCCEED;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "readU16",
          "args": [
            "&reserved"
          ],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "readU16",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "390-393",
          "snippet": "bool _AFfilehandle::readU16(uint16_t *v)\n{\n\treturn readSwap(m_fh, v, m_formatByteOrder);\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::readU16(uint16_t *v)\n  {\n  \treturn readSwap(m_fh, v, m_formatByteOrder);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_fh->seek",
          "args": [
            "track->data_size",
            "File::SeekFromCurrent"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "seek",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "187-192",
          "snippet": "off_t FileVF::seek(off_t offset, SeekOrigin origin)\n{\n\tif (origin == SeekFromEnd)\n\t\toffset += length();\n\treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  off_t FileVF::seek(off_t offset, SeekOrigin origin)\n  {\n  \tif (origin == SeekFromEnd)\n  \t\toffset += length();\n  \treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_fh->tell",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "tell",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "194-197",
          "snippet": "off_t FileVF::tell()\n{\n\treturn m_vf->tell(m_vf);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  off_t FileVF::tell()\n  {\n  \treturn m_vf->tell(m_vf);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "addMiscellaneous",
          "args": [
            "AF_MISC_COMMENT",
            "comment"
          ],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "addMiscellaneous",
          "container": "SampleVisionFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
          "lines": "247-260",
          "snippet": "void SampleVisionFile::addMiscellaneous(int type, const char *data)\n{\n\tm_miscellaneousCount++;\n\tm_miscellaneous = (Miscellaneous *) _af_realloc(m_miscellaneous,\n\t\tm_miscellaneousCount * sizeof (Miscellaneous));\n\n\tMiscellaneous &m = m_miscellaneous[m_miscellaneousCount - 1];\n\tm.id = m_miscellaneousCount;\n\tm.type = type;\n\tm.size = strlen(data);\n\tm.position = 0;\n\tm.buffer = _af_malloc(m.size);\n\tmemcpy(m.buffer, data, m.size);\n}",
          "includes": [
            "#include <string.h>",
            "#include \"util.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"File.h\"",
            "#include \"SampleVision.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nSampleVisionFile {\n  void SampleVisionFile::addMiscellaneous(int type, const char *data)\n  {\n  \tm_miscellaneousCount++;\n  \tm_miscellaneous = (Miscellaneous *) _af_realloc(m_miscellaneous,\n  \t\tm_miscellaneousCount * sizeof (Miscellaneous));\n  \n  \tMiscellaneous &m = m_miscellaneous[m_miscellaneousCount - 1];\n  \tm.id = m_miscellaneousCount;\n  \tm.type = type;\n  \tm.size = strlen(data);\n  \tm.position = 0;\n  \tm.buffer = _af_malloc(m.size);\n  \tmemcpy(m.buffer, data, m.size);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "comment"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "trimTrailingSpaces",
          "args": [
            "comment"
          ],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "trimTrailingSpaces",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
          "lines": "57-65",
          "snippet": "static void trimTrailingSpaces(char *s)\n{\n\tint n = strlen(s);\n\tif (!n)\n\t\treturn;\n\twhile (--n > 0 && s[n] == ' ')\n\t\t;\n\ts[n+1] = '\\0';\n}",
          "includes": [
            "#include <string.h>",
            "#include \"util.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"File.h\"",
            "#include \"SampleVision.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic void trimTrailingSpaces(char *s)\n{\n\tint n = strlen(s);\n\tif (!n)\n\t\treturn;\n\twhile (--n > 0 && s[n] == ' ')\n\t\t;\n\ts[n+1] = '\\0';\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_fh->read",
          "args": [
            "comment",
            "kSMPCommentLength"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "172-175",
          "snippet": "ssize_t FileVF::read(void *data, size_t nbytes)\n{\n\treturn m_vf->read(m_vf, data, nbytes);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  ssize_t FileVF::read(void *data, size_t nbytes)\n  {\n  \treturn m_vf->read(m_vf, data, nbytes);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "name"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allocateTrack",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "version",
            "kSMPVersion",
            "kSMPVersionLength"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "magic",
            "kSMPMagic",
            "kSMPMagicLength"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const char *kSMPMagic = \"SOUND SAMPLE DATA \";\nstatic const unsigned kSMPMagicLength = 18;\nstatic const char *kSMPVersion = \"2.1 \";\nstatic const unsigned kSMPVersionLength = 4;\nstatic const unsigned kSMPNameLength = 30;\nstatic const unsigned kSMPCommentLength = 60;\n\nSampleVisionFile {\n  status SampleVisionFile::readInit(AFfilesetup)\n  {\n  \tm_fh->seek(0, File::SeekFromBeginning);\n  \n  \tchar magic[kSMPMagicLength];\n  \tif (m_fh->read(magic, kSMPMagicLength) != (ssize_t) kSMPMagicLength)\n  \t\treturn AF_FAIL;\n  \tif (strncmp(magic, kSMPMagic, kSMPMagicLength) != 0)\n  \t\treturn AF_FAIL;\n  \n  \tchar version[kSMPVersionLength];\n  \tif (m_fh->read(version, kSMPVersionLength) != (ssize_t) kSMPVersionLength)\n  \t\treturn AF_FAIL;\n  \tif (strncmp(version, kSMPVersion, kSMPVersionLength) != 0)\n  \t\treturn AF_FAIL;\n  \n  \tTrack *track = allocateTrack();\n  \n  \tchar name[kSMPNameLength + 1];\n  \tm_fh->read(name, kSMPNameLength);\n  \tname[kSMPNameLength] = '\\0';\n  \ttrimTrailingSpaces(name);\n  \tif (strlen(name) > 0)\n  \t\taddMiscellaneous(AF_MISC_NAME, name);\n  \n  \tchar comment[kSMPCommentLength + 1];\n  \tm_fh->read(comment, kSMPCommentLength);\n  \tcomment[kSMPCommentLength] = '\\0';\n  \ttrimTrailingSpaces(comment);\n  \tif (strlen(comment) > 0)\n  \t\taddMiscellaneous(AF_MISC_COMMENT, comment);\n  \n  \tuint32_t frameCount;\n  \treadU32(&frameCount);\n  \ttrack->totalfframes = frameCount;\n  \ttrack->fpos_first_frame = m_fh->tell();\n  \ttrack->data_size = 2 * frameCount;\n  \n  \tm_fh->seek(track->data_size, File::SeekFromCurrent);\n  \n  \tuint16_t reserved;\n  \treadU16(&reserved);\n  \n  \tparseLoops();\n  \tparseMarkers();\n  \n  \tuint8_t midiNote;\n  \tuint32_t sampleRate;\n  \tuint32_t smpteOffset;\n  \tuint32_t cycleLength;\n  \n  \treadU8(&midiNote);\n  \treadU32(&sampleRate);\n  \treadU32(&smpteOffset);\n  \treadU32(&cycleLength);\n  \n  \ttrack->f.byteOrder = AF_BYTEORDER_LITTLEENDIAN;\n  \ttrack->f.sampleRate = sampleRate;\n  \ttrack->f.channelCount = 1;\n  \ttrack->f.compressionType = AF_COMPRESSION_NONE;\n  \ttrack->f.framesPerPacket = 1;\n  \t_af_set_sample_format(&track->f, AF_SAMPFMT_TWOSCOMP, 16);\n  \ttrack->f.computeBytesPerPacketPCM();\n  \n  \treturn AF_SUCCEED;\n  }\n}"
  },
  {
    "function_name": "completeSetup",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "86-150",
    "snippet": "AFfilesetup SampleVisionFile::completeSetup(AFfilesetup setup)\n{\n\tif (setup->trackSet && setup->trackCount != 1)\n\t{\n\t\t_af_error(AF_BAD_NUMTRACKS, \"SampleVision file must have 1 track\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tTrackSetup *track = setup->getTrack();\n\tif (!track)\n\t\treturn AF_NULL_FILESETUP;\n\n\tif (track->sampleFormatSet)\n\t{\n\t\tif (!track->f.isSigned() || track->f.sampleWidth != 16)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"SampleVision format supports only 16-bit signed integer audio data\");\n\t\t\treturn AF_NULL_FILESETUP;\n\t\t}\n\t}\n\telse\n\t\t_af_set_sample_format(&track->f, AF_SAMPFMT_TWOSCOMP,\n\t\t\ttrack->f.sampleWidth);\n\n\tif (track->byteOrderSet && track->f.byteOrder != AF_BYTEORDER_LITTLEENDIAN)\n\t{\n\t\t// Treat error as correctable.\n\t\t_af_error(AF_BAD_BYTEORDER, \"SampleVision supports only little-endian data\");\n\t}\n\n\ttrack->f.byteOrder = AF_BYTEORDER_LITTLEENDIAN;\n\n\tif (track->compressionSet && !track->f.isUncompressed())\n\t{\n\t\t_af_error(AF_BAD_COMPTYPE, \"SampleVision does not support compressed audio data\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tif (track->markersSet && track->markerCount)\n\t{\n\t\t_af_error(AF_BAD_NUMMARKS, \"SampleVision does not support markers\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tif (track->aesDataSet)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"SampleVision does not support AES data\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tif (setup->instrumentSet && setup->instrumentCount)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"SampleVision does not support instruments\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\tif (setup->miscellaneousSet && setup->miscellaneousCount)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"SampleVision does not support miscellaneous data\");\n\t\treturn AF_NULL_FILESETUP;\n\t}\n\n\treturn _af_filesetup_copy(setup, &sSampleVisionDefaultFileSetup, true);\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const _AFfilesetup sSampleVisionDefaultFileSetup =\n{\n\t_AF_VALID_FILESETUP,\n\tAF_FILE_SAMPLEVISION,\n\ttrue,\t// trackSet\n\ttrue,\t// instrumentSet\n\ttrue,\t// miscellaneousSet\n\t1,\t\t// trackCount\n\tNULL,\t// tracks\n\t1,\t\t// instrumentCount\n\tNULL,\t// instruments\n\t0,\t\t// miscellaneousCount\n\tNULL\t// miscellaneous\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_filesetup_copy",
          "args": [
            "setup",
            "&sSampleVisionDefaultFileSetup",
            "true"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_copy",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "440-525",
          "snippet": "AFfilesetup _af_filesetup_copy (const _AFfilesetup *setup,\n\tconst _AFfilesetup *defaultSetup, bool copyMarks)\n{\n\tAFfilesetup newsetup;\n\tint instrumentCount, miscellaneousCount, trackCount;\n\n\tnewsetup = (_AFfilesetup *) _af_malloc(sizeof (_AFfilesetup));\n\tif (newsetup == AF_NULL_FILESETUP)\n\t\treturn AF_NULL_FILESETUP;\n\n\t*newsetup = *defaultSetup;\n\n\tnewsetup->tracks = NULL;\n\tnewsetup->instruments = NULL;\n\tnewsetup->miscellaneous = NULL;\n\n\t/* Copy tracks. */\n\ttrackCount = setup->trackSet ? setup->trackCount :\n\t\tnewsetup->trackSet ? newsetup->trackCount : 0;\n\talloccopy(TrackSetup, trackCount, newsetup->tracks, setup->tracks);\n\tnewsetup->trackCount = trackCount;\n\n\t/* Copy instruments. */\n\tinstrumentCount = setup->instrumentSet ? setup->instrumentCount :\n\t\tnewsetup->instrumentSet ? newsetup->instrumentCount : 0;\n\talloccopy(InstrumentSetup, instrumentCount, newsetup->instruments, setup->instruments);\n\tnewsetup->instrumentCount = instrumentCount;\n\n\t/* Copy miscellaneous information. */\n\tmiscellaneousCount = setup->miscellaneousSet ? setup->miscellaneousCount :\n\t\tnewsetup->miscellaneousSet ? newsetup->miscellaneousCount : 0;\n\talloccopy(MiscellaneousSetup, miscellaneousCount, newsetup->miscellaneous, setup->miscellaneous);\n\tnewsetup->miscellaneousCount = miscellaneousCount;\n\n\tfor (int i=0; i<setup->trackCount; i++)\n\t{\n\t\tTrackSetup\t*track = &newsetup->tracks[i];\n\n\t\t/* XXXmpruett set compression information */\n\n\t\tif (!setup->tracks[i].markersSet && !copyMarks)\n\t\t{\n\t\t\ttrack->markers = NULL;\n\t\t\ttrack->markerCount = 0;\n\t\t\tcontinue;\n\t\t}\n\n\t\talloccopy(MarkerSetup, setup->tracks[i].markerCount,\n\t\t\ttrack->markers, setup->tracks[i].markers);\n\t\ttrack->markerCount = setup->tracks[i].markerCount;\n\n\t\tfor (int j=0; j<setup->tracks[i].markerCount; j++)\n\t\t{\n\t\t\ttrack->markers[j].name =\n\t\t\t\t_af_strdup(setup->tracks[i].markers[j].name);\n\t\t\tif (track->markers[j].name == NULL)\n\t\t\t\tgoto fail;\n\n\t\t\ttrack->markers[j].comment =\n\t\t\t\t_af_strdup(setup->tracks[i].markers[j].comment);\n\t\t\tif (track->markers[j].comment == NULL)\n\t\t\t\tgoto fail;\n\t\t}\n\t}\n\n\tfor (int i=0; i<newsetup->instrumentCount; i++)\n\t{\n\t\tInstrumentSetup\t*instrument = &newsetup->instruments[i];\n\t\talloccopy(LoopSetup, setup->instruments[i].loopCount,\n\t\t\tinstrument->loops, setup->instruments[i].loops);\n\t}\n\n\treturn newsetup;\n\n\tfail:\n\t\tif (newsetup->miscellaneous)\n\t\t\tfree(newsetup->miscellaneous);\n\t\tif (newsetup->instruments)\n\t\t\tfree(newsetup->instruments);\n\t\tif (newsetup->tracks)\n\t\t\tfree(newsetup->tracks);\n\t\tif (newsetup)\n\t\t\tfree(newsetup);\n\n\treturn AF_NULL_FILESETUP;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nAFfilesetup _af_filesetup_copy (const _AFfilesetup *setup,\n\tconst _AFfilesetup *defaultSetup, bool copyMarks)\n{\n\tAFfilesetup newsetup;\n\tint instrumentCount, miscellaneousCount, trackCount;\n\n\tnewsetup = (_AFfilesetup *) _af_malloc(sizeof (_AFfilesetup));\n\tif (newsetup == AF_NULL_FILESETUP)\n\t\treturn AF_NULL_FILESETUP;\n\n\t*newsetup = *defaultSetup;\n\n\tnewsetup->tracks = NULL;\n\tnewsetup->instruments = NULL;\n\tnewsetup->miscellaneous = NULL;\n\n\t/* Copy tracks. */\n\ttrackCount = setup->trackSet ? setup->trackCount :\n\t\tnewsetup->trackSet ? newsetup->trackCount : 0;\n\talloccopy(TrackSetup, trackCount, newsetup->tracks, setup->tracks);\n\tnewsetup->trackCount = trackCount;\n\n\t/* Copy instruments. */\n\tinstrumentCount = setup->instrumentSet ? setup->instrumentCount :\n\t\tnewsetup->instrumentSet ? newsetup->instrumentCount : 0;\n\talloccopy(InstrumentSetup, instrumentCount, newsetup->instruments, setup->instruments);\n\tnewsetup->instrumentCount = instrumentCount;\n\n\t/* Copy miscellaneous information. */\n\tmiscellaneousCount = setup->miscellaneousSet ? setup->miscellaneousCount :\n\t\tnewsetup->miscellaneousSet ? newsetup->miscellaneousCount : 0;\n\talloccopy(MiscellaneousSetup, miscellaneousCount, newsetup->miscellaneous, setup->miscellaneous);\n\tnewsetup->miscellaneousCount = miscellaneousCount;\n\n\tfor (int i=0; i<setup->trackCount; i++)\n\t{\n\t\tTrackSetup\t*track = &newsetup->tracks[i];\n\n\t\t/* XXXmpruett set compression information */\n\n\t\tif (!setup->tracks[i].markersSet && !copyMarks)\n\t\t{\n\t\t\ttrack->markers = NULL;\n\t\t\ttrack->markerCount = 0;\n\t\t\tcontinue;\n\t\t}\n\n\t\talloccopy(MarkerSetup, setup->tracks[i].markerCount,\n\t\t\ttrack->markers, setup->tracks[i].markers);\n\t\ttrack->markerCount = setup->tracks[i].markerCount;\n\n\t\tfor (int j=0; j<setup->tracks[i].markerCount; j++)\n\t\t{\n\t\t\ttrack->markers[j].name =\n\t\t\t\t_af_strdup(setup->tracks[i].markers[j].name);\n\t\t\tif (track->markers[j].name == NULL)\n\t\t\t\tgoto fail;\n\n\t\t\ttrack->markers[j].comment =\n\t\t\t\t_af_strdup(setup->tracks[i].markers[j].comment);\n\t\t\tif (track->markers[j].comment == NULL)\n\t\t\t\tgoto fail;\n\t\t}\n\t}\n\n\tfor (int i=0; i<newsetup->instrumentCount; i++)\n\t{\n\t\tInstrumentSetup\t*instrument = &newsetup->instruments[i];\n\t\talloccopy(LoopSetup, setup->instruments[i].loopCount,\n\t\t\tinstrument->loops, setup->instruments[i].loops);\n\t}\n\n\treturn newsetup;\n\n\tfail:\n\t\tif (newsetup->miscellaneous)\n\t\t\tfree(newsetup->miscellaneous);\n\t\tif (newsetup->instruments)\n\t\t\tfree(newsetup->instruments);\n\t\tif (newsetup->tracks)\n\t\t\tfree(newsetup->tracks);\n\t\tif (newsetup)\n\t\t\tfree(newsetup);\n\n\treturn AF_NULL_FILESETUP;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"SampleVision does not support miscellaneous data\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"SampleVision does not support instruments\""
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"SampleVision does not support AES data\""
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_NUMMARKS",
            "\"SampleVision does not support markers\""
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_COMPTYPE",
            "\"SampleVision does not support compressed audio data\""
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "track->f.isUncompressed",
          "args": [],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "isUncompressed",
          "container": "AudioFormat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/AudioFormat.cpp",
          "lines": "93-96",
          "snippet": "bool AudioFormat::isUncompressed() const\n{\n\treturn compressionType == AF_COMPRESSION_NONE;\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <assert.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"AudioFormat.h\"\n#include \"config.h\"\n\nAudioFormat {\n  bool AudioFormat::isUncompressed() const\n  {\n  \treturn compressionType == AF_COMPRESSION_NONE;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_BYTEORDER",
            "\"SampleVision supports only little-endian data\""
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_set_sample_format",
          "args": [
            "&track->f",
            "AF_SAMPFMT_TWOSCOMP",
            "track->f.sampleWidth"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "_af_set_sample_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "315-361",
          "snippet": "status _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatus _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_SAMPFMT",
            "\"SampleVision format supports only 16-bit signed integer audio data\""
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "track->f.isSigned",
          "args": [],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "isSigned",
          "container": "AudioFormat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/AudioFormat.cpp",
          "lines": "72-75",
          "snippet": "bool AudioFormat::isSigned() const\n{\n\treturn sampleFormat == AF_SAMPFMT_TWOSCOMP;\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <assert.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <assert.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"AudioFormat.h\"\n#include \"config.h\"\n\nAudioFormat {\n  bool AudioFormat::isSigned() const\n  {\n  \treturn sampleFormat == AF_SAMPFMT_TWOSCOMP;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_NUMTRACKS",
            "\"SampleVision file must have 1 track\""
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const _AFfilesetup sSampleVisionDefaultFileSetup =\n{\n\t_AF_VALID_FILESETUP,\n\tAF_FILE_SAMPLEVISION,\n\ttrue,\t// trackSet\n\ttrue,\t// instrumentSet\n\ttrue,\t// miscellaneousSet\n\t1,\t\t// trackCount\n\tNULL,\t// tracks\n\t1,\t\t// instrumentCount\n\tNULL,\t// instruments\n\t0,\t\t// miscellaneousCount\n\tNULL\t// miscellaneous\n};\n\nSampleVisionFile {\n  AFfilesetup SampleVisionFile::completeSetup(AFfilesetup setup)\n  {\n  \tif (setup->trackSet && setup->trackCount != 1)\n  \t{\n  \t\t_af_error(AF_BAD_NUMTRACKS, \"SampleVision file must have 1 track\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tTrackSetup *track = setup->getTrack();\n  \tif (!track)\n  \t\treturn AF_NULL_FILESETUP;\n  \n  \tif (track->sampleFormatSet)\n  \t{\n  \t\tif (!track->f.isSigned() || track->f.sampleWidth != 16)\n  \t\t{\n  \t\t\t_af_error(AF_BAD_SAMPFMT,\n  \t\t\t\t\"SampleVision format supports only 16-bit signed integer audio data\");\n  \t\t\treturn AF_NULL_FILESETUP;\n  \t\t}\n  \t}\n  \telse\n  \t\t_af_set_sample_format(&track->f, AF_SAMPFMT_TWOSCOMP,\n  \t\t\ttrack->f.sampleWidth);\n  \n  \tif (track->byteOrderSet && track->f.byteOrder != AF_BYTEORDER_LITTLEENDIAN)\n  \t{\n  \t\t// Treat error as correctable.\n  \t\t_af_error(AF_BAD_BYTEORDER, \"SampleVision supports only little-endian data\");\n  \t}\n  \n  \ttrack->f.byteOrder = AF_BYTEORDER_LITTLEENDIAN;\n  \n  \tif (track->compressionSet && !track->f.isUncompressed())\n  \t{\n  \t\t_af_error(AF_BAD_COMPTYPE, \"SampleVision does not support compressed audio data\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tif (track->markersSet && track->markerCount)\n  \t{\n  \t\t_af_error(AF_BAD_NUMMARKS, \"SampleVision does not support markers\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tif (track->aesDataSet)\n  \t{\n  \t\t_af_error(AF_BAD_FILESETUP, \"SampleVision does not support AES data\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tif (setup->instrumentSet && setup->instrumentCount)\n  \t{\n  \t\t_af_error(AF_BAD_FILESETUP, \"SampleVision does not support instruments\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \tif (setup->miscellaneousSet && setup->miscellaneousCount)\n  \t{\n  \t\t_af_error(AF_BAD_FILESETUP, \"SampleVision does not support miscellaneous data\");\n  \t\treturn AF_NULL_FILESETUP;\n  \t}\n  \n  \treturn _af_filesetup_copy(setup, &sSampleVisionDefaultFileSetup, true);\n  }\n}"
  },
  {
    "function_name": "recognize",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "77-84",
    "snippet": "bool SampleVisionFile::recognize(File *fh)\n{\n\tfh->seek(0, File::SeekFromBeginning);\n\tchar magic[kSMPMagicLength];\n\tif (fh->read(magic, kSMPMagicLength) != (ssize_t) kSMPMagicLength)\n\t\treturn false;\n\treturn !strncmp(magic, kSMPMagic, kSMPMagicLength);\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char *kSMPMagic = \"SOUND SAMPLE DATA \";",
      "static const unsigned kSMPMagicLength = 18;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncmp",
          "args": [
            "magic",
            "kSMPMagic",
            "kSMPMagicLength"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fh->read",
          "args": [
            "magic",
            "kSMPMagicLength"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "172-175",
          "snippet": "ssize_t FileVF::read(void *data, size_t nbytes)\n{\n\treturn m_vf->read(m_vf, data, nbytes);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  ssize_t FileVF::read(void *data, size_t nbytes)\n  {\n  \treturn m_vf->read(m_vf, data, nbytes);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fh->seek",
          "args": [
            "0",
            "File::SeekFromBeginning"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "seek",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "187-192",
          "snippet": "off_t FileVF::seek(off_t offset, SeekOrigin origin)\n{\n\tif (origin == SeekFromEnd)\n\t\toffset += length();\n\treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  off_t FileVF::seek(off_t offset, SeekOrigin origin)\n  {\n  \tif (origin == SeekFromEnd)\n  \t\toffset += length();\n  \treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic const char *kSMPMagic = \"SOUND SAMPLE DATA \";\nstatic const unsigned kSMPMagicLength = 18;\n\nSampleVisionFile {\n  bool SampleVisionFile::recognize(File *fh)\n  {\n  \tfh->seek(0, File::SeekFromBeginning);\n  \tchar magic[kSMPMagicLength];\n  \tif (fh->read(magic, kSMPMagicLength) != (ssize_t) kSMPMagicLength)\n  \t\treturn false;\n  \treturn !strncmp(magic, kSMPMagic, kSMPMagicLength);\n  }\n}"
  },
  {
    "function_name": "~SampleVisionFile",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "73-75",
    "snippet": "SampleVisionFile::~SampleVisionFile()\n{\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nSampleVisionFile {\n  SampleVisionFile::~SampleVisionFile()\n  {\n  }\n}"
  },
  {
    "function_name": "SampleVisionFile",
    "container": "SampleVisionFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "67-71",
    "snippet": "SampleVisionFile::SampleVisionFile() :\n\tm_frameCountOffset(-1)\n{\n\tsetFormatByteOrder(AF_BYTEORDER_LITTLEENDIAN);\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setFormatByteOrder",
          "args": [
            "AF_BYTEORDER_LITTLEENDIAN"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "setFormatByteOrder",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.h",
          "lines": "86-86",
          "snippet": "void setFormatByteOrder(int byteOrder) { m_formatByteOrder = byteOrder; }",
          "includes": [
            "#include <stdint.h>",
            "#include \"afinternal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include \"afinternal.h\"\n\n_AFfilehandle {\n  void setFormatByteOrder(int byteOrder) { m_formatByteOrder = byteOrder; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nSampleVisionFile {\n  SampleVisionFile::SampleVisionFile() :\n  \tm_frameCountOffset(-1)\n  {\n  \tsetFormatByteOrder(AF_BYTEORDER_LITTLEENDIAN);\n  }\n}"
  },
  {
    "function_name": "trimTrailingSpaces",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/SampleVision.cpp",
    "lines": "57-65",
    "snippet": "static void trimTrailingSpaces(char *s)\n{\n\tint n = strlen(s);\n\tif (!n)\n\t\treturn;\n\twhile (--n > 0 && s[n] == ' ')\n\t\t;\n\ts[n+1] = '\\0';\n}",
    "includes": [
      "#include <string.h>",
      "#include \"util.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"File.h\"",
      "#include \"SampleVision.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include \"util.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"File.h\"\n#include \"SampleVision.h\"\n#include \"config.h\"\n\nstatic void trimTrailingSpaces(char *s)\n{\n\tint n = strlen(s);\n\tif (!n)\n\t\treturn;\n\twhile (--n > 0 && s[n] == ' ')\n\t\t;\n\ts[n+1] = '\\0';\n}"
  }
]