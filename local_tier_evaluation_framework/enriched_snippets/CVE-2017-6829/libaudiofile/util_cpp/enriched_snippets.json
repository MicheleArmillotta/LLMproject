[
  {
    "function_name": "_af_unique_ids",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "369-384",
    "snippet": "bool _af_unique_ids (const int *ids, int nids, const char *idname, int iderr)\n{\n\tfor (int i = 0; i < nids; i++)\n\t{\n\t\tfor (int j = 0; j < i; j++)\n\t\t{\n\t\t\tif (ids[i] == ids[j])\n\t\t\t{\n\t\t\t\t_af_error(iderr, \"nonunique %s id %d\", idname, ids[i]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "iderr",
            "\"nonunique %s id %d\"",
            "idname",
            "ids[i]"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_unique_ids (const int *ids, int nids, const char *idname, int iderr)\n{\n\tfor (int i = 0; i < nids; i++)\n\t{\n\t\tfor (int j = 0; j < i; j++)\n\t\t{\n\t\t\tif (ids[i] == ids[j])\n\t\t\t{\n\t\t\t\t_af_error(iderr, \"nonunique %s id %d\", idname, ids[i]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "_af_set_sample_format",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "315-361",
    "snippet": "status _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_SAMPFMT",
            "\"unknown sample format %d\"",
            "sampleFormat"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_format_sample_size_uncompressed",
          "args": [
            "f",
            "false"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "_af_format_sample_size_uncompressed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "263-284",
          "snippet": "int _af_format_sample_size_uncompressed (const AudioFormat *format, bool stretch3to4)\n{\n\tint\tsize = 0;\n\n\tswitch (format->sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tsize = sizeof (float);\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tsize = sizeof (double);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tsize = (int) (format->sampleWidth + 7) / 8;\n\t\t\tif (format->compressionType == AF_COMPRESSION_NONE &&\n\t\t\t\tsize == 3 && stretch3to4)\n\t\t\t\tsize = 4;\n\t\t\tbreak;\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint _af_format_sample_size_uncompressed (const AudioFormat *format, bool stretch3to4)\n{\n\tint\tsize = 0;\n\n\tswitch (format->sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tsize = sizeof (float);\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tsize = sizeof (double);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tsize = (int) (format->sampleWidth + 7) / 8;\n\t\t\tif (format->compressionType == AF_COMPRESSION_NONE &&\n\t\t\t\tsize == 3 && stretch3to4)\n\t\t\t\tsize = 4;\n\t\t\tbreak;\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_SAMPFMT",
            "\"illegal sample width %d for integer data\"",
            "sampleWidth"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatus _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}"
  },
  {
    "function_name": "_af_format_frame_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "301-308",
    "snippet": "float _af_format_frame_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_frame_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_format_frame_size_uncompressed",
          "args": [
            "fmt",
            "stretch3to4"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "_af_format_frame_size_uncompressed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "295-299",
          "snippet": "int _af_format_frame_size_uncompressed (const AudioFormat *fmt, bool stretch3to4)\n{\n\treturn _af_format_sample_size_uncompressed(fmt, stretch3to4) *\n\t\tfmt->channelCount;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint _af_format_frame_size_uncompressed (const AudioFormat *fmt, bool stretch3to4)\n{\n\treturn _af_format_sample_size_uncompressed(fmt, stretch3to4) *\n\t\tfmt->channelCount;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_compression_unit_from_id",
          "args": [
            "fmt->compressionType"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nfloat _af_format_frame_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_frame_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}"
  },
  {
    "function_name": "_af_format_frame_size_uncompressed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "295-299",
    "snippet": "int _af_format_frame_size_uncompressed (const AudioFormat *fmt, bool stretch3to4)\n{\n\treturn _af_format_sample_size_uncompressed(fmt, stretch3to4) *\n\t\tfmt->channelCount;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_format_sample_size_uncompressed",
          "args": [
            "fmt",
            "stretch3to4"
          ],
          "line": 297
        },
        "resolved": true,
        "details": {
          "function_name": "_af_format_sample_size_uncompressed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "263-284",
          "snippet": "int _af_format_sample_size_uncompressed (const AudioFormat *format, bool stretch3to4)\n{\n\tint\tsize = 0;\n\n\tswitch (format->sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tsize = sizeof (float);\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tsize = sizeof (double);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tsize = (int) (format->sampleWidth + 7) / 8;\n\t\t\tif (format->compressionType == AF_COMPRESSION_NONE &&\n\t\t\t\tsize == 3 && stretch3to4)\n\t\t\t\tsize = 4;\n\t\t\tbreak;\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint _af_format_sample_size_uncompressed (const AudioFormat *format, bool stretch3to4)\n{\n\tint\tsize = 0;\n\n\tswitch (format->sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tsize = sizeof (float);\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tsize = sizeof (double);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tsize = (int) (format->sampleWidth + 7) / 8;\n\t\t\tif (format->compressionType == AF_COMPRESSION_NONE &&\n\t\t\t\tsize == 3 && stretch3to4)\n\t\t\t\tsize = 4;\n\t\t\tbreak;\n\t}\n\n\treturn size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint _af_format_frame_size_uncompressed (const AudioFormat *fmt, bool stretch3to4)\n{\n\treturn _af_format_sample_size_uncompressed(fmt, stretch3to4) *\n\t\tfmt->channelCount;\n}"
  },
  {
    "function_name": "_af_format_sample_size",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "286-293",
    "snippet": "float _af_format_sample_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_sample_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_format_sample_size_uncompressed",
          "args": [
            "fmt",
            "stretch3to4"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "_af_format_sample_size_uncompressed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "263-284",
          "snippet": "int _af_format_sample_size_uncompressed (const AudioFormat *format, bool stretch3to4)\n{\n\tint\tsize = 0;\n\n\tswitch (format->sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tsize = sizeof (float);\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tsize = sizeof (double);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tsize = (int) (format->sampleWidth + 7) / 8;\n\t\t\tif (format->compressionType == AF_COMPRESSION_NONE &&\n\t\t\t\tsize == 3 && stretch3to4)\n\t\t\t\tsize = 4;\n\t\t\tbreak;\n\t}\n\n\treturn size;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint _af_format_sample_size_uncompressed (const AudioFormat *format, bool stretch3to4)\n{\n\tint\tsize = 0;\n\n\tswitch (format->sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tsize = sizeof (float);\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tsize = sizeof (double);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tsize = (int) (format->sampleWidth + 7) / 8;\n\t\t\tif (format->compressionType == AF_COMPRESSION_NONE &&\n\t\t\t\tsize == 3 && stretch3to4)\n\t\t\t\tsize = 4;\n\t\t\tbreak;\n\t}\n\n\treturn size;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_compression_unit_from_id",
          "args": [
            "fmt->compressionType"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nfloat _af_format_sample_size (const AudioFormat *fmt, bool stretch3to4)\n{\n\tconst CompressionUnit *unit = _af_compression_unit_from_id(fmt->compressionType);\n\tfloat squishFactor = unit->squishFactor;\n\n\treturn _af_format_sample_size_uncompressed(fmt, stretch3to4) /\n\t\tsquishFactor;\n}"
  },
  {
    "function_name": "_af_format_sample_size_uncompressed",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "263-284",
    "snippet": "int _af_format_sample_size_uncompressed (const AudioFormat *format, bool stretch3to4)\n{\n\tint\tsize = 0;\n\n\tswitch (format->sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tsize = sizeof (float);\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tsize = sizeof (double);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tsize = (int) (format->sampleWidth + 7) / 8;\n\t\t\tif (format->compressionType == AF_COMPRESSION_NONE &&\n\t\t\t\tsize == 3 && stretch3to4)\n\t\t\t\tsize = 4;\n\t\t\tbreak;\n\t}\n\n\treturn size;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nint _af_format_sample_size_uncompressed (const AudioFormat *format, bool stretch3to4)\n{\n\tint\tsize = 0;\n\n\tswitch (format->sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tsize = sizeof (float);\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tsize = sizeof (double);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tsize = (int) (format->sampleWidth + 7) / 8;\n\t\t\tif (format->compressionType == AF_COMPRESSION_NONE &&\n\t\t\t\tsize == 3 && stretch3to4)\n\t\t\t\tsize = 4;\n\t\t\tbreak;\n\t}\n\n\treturn size;\n}"
  },
  {
    "function_name": "_af_pv_getptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "239-261",
    "snippet": "bool _af_pv_getptr (AUpvlist pvlist, int param, void **v)\n{\n\tfor (int i=0; i<AUpvgetmaxitems(pvlist); i++)\n\t{\n\t\tint\tp, t;\n\n\t\tAUpvgetparam(pvlist, i, &p);\n\n\t\tif (p != param)\n\t\t\tcontinue;\n\n\t\tAUpvgetvaltype(pvlist, i, &t);\n\n\t\t/* Ensure that this parameter is of type AU_PVTYPE_PTR. */\n\t\tif (t != AU_PVTYPE_PTR)\n\t\t\treturn false;\n\n\t\tAUpvgetval(pvlist, i, v);\n\t\treturn true;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "pvlist",
            "i",
            "v"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetvaltype",
          "args": [
            "pvlist",
            "i",
            "&t"
          ],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetparam",
          "args": [
            "pvlist",
            "i",
            "&p"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetmaxitems",
          "args": [
            "pvlist"
          ],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_pv_getptr (AUpvlist pvlist, int param, void **v)\n{\n\tfor (int i=0; i<AUpvgetmaxitems(pvlist); i++)\n\t{\n\t\tint\tp, t;\n\n\t\tAUpvgetparam(pvlist, i, &p);\n\n\t\tif (p != param)\n\t\t\tcontinue;\n\n\t\tAUpvgetvaltype(pvlist, i, &t);\n\n\t\t/* Ensure that this parameter is of type AU_PVTYPE_PTR. */\n\t\tif (t != AU_PVTYPE_PTR)\n\t\t\treturn false;\n\n\t\tAUpvgetval(pvlist, i, v);\n\t\treturn true;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "_af_pv_getdouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "215-237",
    "snippet": "bool _af_pv_getdouble (AUpvlist pvlist, int param, double *d)\n{\n\tfor (int i=0; i<AUpvgetmaxitems(pvlist); i++)\n\t{\n\t\tint\tp, t;\n\n\t\tAUpvgetparam(pvlist, i, &p);\n\n\t\tif (p != param)\n\t\t\tcontinue;\n\n\t\tAUpvgetvaltype(pvlist, i, &t);\n\n\t\t/* Ensure that this parameter is of type AU_PVTYPE_DOUBLE. */\n\t\tif (t != AU_PVTYPE_DOUBLE)\n\t\t\treturn false;\n\n\t\tAUpvgetval(pvlist, i, d);\n\t\treturn true;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "pvlist",
            "i",
            "d"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetvaltype",
          "args": [
            "pvlist",
            "i",
            "&t"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetparam",
          "args": [
            "pvlist",
            "i",
            "&p"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetmaxitems",
          "args": [
            "pvlist"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_pv_getdouble (AUpvlist pvlist, int param, double *d)\n{\n\tfor (int i=0; i<AUpvgetmaxitems(pvlist); i++)\n\t{\n\t\tint\tp, t;\n\n\t\tAUpvgetparam(pvlist, i, &p);\n\n\t\tif (p != param)\n\t\t\tcontinue;\n\n\t\tAUpvgetvaltype(pvlist, i, &t);\n\n\t\t/* Ensure that this parameter is of type AU_PVTYPE_DOUBLE. */\n\t\tif (t != AU_PVTYPE_DOUBLE)\n\t\t\treturn false;\n\n\t\tAUpvgetval(pvlist, i, d);\n\t\treturn true;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "_af_pv_getlong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "191-213",
    "snippet": "bool _af_pv_getlong (AUpvlist pvlist, int param, long *l)\n{\n\tfor (int i=0; i<AUpvgetmaxitems(pvlist); i++)\n\t{\n\t\tint\tp, t;\n\n\t\tAUpvgetparam(pvlist, i, &p);\n\n\t\tif (p != param)\n\t\t\tcontinue;\n\n\t\tAUpvgetvaltype(pvlist, i, &t);\n\n\t\t/* Ensure that this parameter is of type AU_PVTYPE_LONG. */\n\t\tif (t != AU_PVTYPE_LONG)\n\t\t\treturn false;\n\n\t\tAUpvgetval(pvlist, i, l);\n\t\treturn true;\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "pvlist",
            "i",
            "l"
          ],
          "line": 208
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetvaltype",
          "args": [
            "pvlist",
            "i",
            "&t"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetparam",
          "args": [
            "pvlist",
            "i",
            "&p"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetmaxitems",
          "args": [
            "pvlist"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_pv_getlong (AUpvlist pvlist, int param, long *l)\n{\n\tfor (int i=0; i<AUpvgetmaxitems(pvlist); i++)\n\t{\n\t\tint\tp, t;\n\n\t\tAUpvgetparam(pvlist, i, &p);\n\n\t\tif (p != param)\n\t\t\tcontinue;\n\n\t\tAUpvgetvaltype(pvlist, i, &t);\n\n\t\t/* Ensure that this parameter is of type AU_PVTYPE_LONG. */\n\t\tif (t != AU_PVTYPE_LONG)\n\t\t\treturn false;\n\n\t\tAUpvgetval(pvlist, i, l);\n\t\treturn true;\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "_af_pv_pointer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "182-189",
    "snippet": "AUpvlist _af_pv_pointer (void *val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_PTR);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvsetval",
          "args": [
            "ret",
            "0",
            "&val"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetvaltype",
          "args": [
            "ret",
            "0",
            "AU_PVTYPE_PTR"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetparam",
          "args": [
            "ret",
            "0",
            "0"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvnew",
          "args": [
            "1"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_pointer (void *val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_PTR);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
  },
  {
    "function_name": "_af_pv_double",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "173-180",
    "snippet": "AUpvlist _af_pv_double (double val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_DOUBLE);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvsetval",
          "args": [
            "ret",
            "0",
            "&val"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetvaltype",
          "args": [
            "ret",
            "0",
            "AU_PVTYPE_DOUBLE"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetparam",
          "args": [
            "ret",
            "0",
            "0"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvnew",
          "args": [
            "1"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_double (double val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_DOUBLE);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
  },
  {
    "function_name": "_af_pv_long",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "164-171",
    "snippet": "AUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvsetval",
          "args": [
            "ret",
            "0",
            "&val"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetvaltype",
          "args": [
            "ret",
            "0",
            "AU_PVTYPE_LONG"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetparam",
          "args": [
            "ret",
            "0",
            "0"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvnew",
          "args": [
            "1"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
  },
  {
    "function_name": "_af_filehandle_ok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "71-84",
    "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILEHANDLE",
            "\"invalid file handle\""
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILEHANDLE",
            "\"null file handle\""
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
  },
  {
    "function_name": "_af_filesetup_ok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
    "lines": "56-69",
    "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"compression.h\"",
      "#include \"byteorder.h\"",
      "#include \"aupvinternal.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include \"File.h\"",
      "#include \"AudioFormat.h\"",
      "#include \"aupvlist.h\"",
      "#include \"audiofile.h\"",
      "#include <assert.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"invalid file setup\""
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILESETUP",
            "\"null file setup\""
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
  }
]