[
  {
    "function_name": "_af_filesetup_copy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "440-525",
    "snippet": "AFfilesetup _af_filesetup_copy (const _AFfilesetup *setup,\n\tconst _AFfilesetup *defaultSetup, bool copyMarks)\n{\n\tAFfilesetup newsetup;\n\tint instrumentCount, miscellaneousCount, trackCount;\n\n\tnewsetup = (_AFfilesetup *) _af_malloc(sizeof (_AFfilesetup));\n\tif (newsetup == AF_NULL_FILESETUP)\n\t\treturn AF_NULL_FILESETUP;\n\n\t*newsetup = *defaultSetup;\n\n\tnewsetup->tracks = NULL;\n\tnewsetup->instruments = NULL;\n\tnewsetup->miscellaneous = NULL;\n\n\t/* Copy tracks. */\n\ttrackCount = setup->trackSet ? setup->trackCount :\n\t\tnewsetup->trackSet ? newsetup->trackCount : 0;\n\talloccopy(TrackSetup, trackCount, newsetup->tracks, setup->tracks);\n\tnewsetup->trackCount = trackCount;\n\n\t/* Copy instruments. */\n\tinstrumentCount = setup->instrumentSet ? setup->instrumentCount :\n\t\tnewsetup->instrumentSet ? newsetup->instrumentCount : 0;\n\talloccopy(InstrumentSetup, instrumentCount, newsetup->instruments, setup->instruments);\n\tnewsetup->instrumentCount = instrumentCount;\n\n\t/* Copy miscellaneous information. */\n\tmiscellaneousCount = setup->miscellaneousSet ? setup->miscellaneousCount :\n\t\tnewsetup->miscellaneousSet ? newsetup->miscellaneousCount : 0;\n\talloccopy(MiscellaneousSetup, miscellaneousCount, newsetup->miscellaneous, setup->miscellaneous);\n\tnewsetup->miscellaneousCount = miscellaneousCount;\n\n\tfor (int i=0; i<setup->trackCount; i++)\n\t{\n\t\tTrackSetup\t*track = &newsetup->tracks[i];\n\n\t\t/* XXXmpruett set compression information */\n\n\t\tif (!setup->tracks[i].markersSet && !copyMarks)\n\t\t{\n\t\t\ttrack->markers = NULL;\n\t\t\ttrack->markerCount = 0;\n\t\t\tcontinue;\n\t\t}\n\n\t\talloccopy(MarkerSetup, setup->tracks[i].markerCount,\n\t\t\ttrack->markers, setup->tracks[i].markers);\n\t\ttrack->markerCount = setup->tracks[i].markerCount;\n\n\t\tfor (int j=0; j<setup->tracks[i].markerCount; j++)\n\t\t{\n\t\t\ttrack->markers[j].name =\n\t\t\t\t_af_strdup(setup->tracks[i].markers[j].name);\n\t\t\tif (track->markers[j].name == NULL)\n\t\t\t\tgoto fail;\n\n\t\t\ttrack->markers[j].comment =\n\t\t\t\t_af_strdup(setup->tracks[i].markers[j].comment);\n\t\t\tif (track->markers[j].comment == NULL)\n\t\t\t\tgoto fail;\n\t\t}\n\t}\n\n\tfor (int i=0; i<newsetup->instrumentCount; i++)\n\t{\n\t\tInstrumentSetup\t*instrument = &newsetup->instruments[i];\n\t\talloccopy(LoopSetup, setup->instruments[i].loopCount,\n\t\t\tinstrument->loops, setup->instruments[i].loops);\n\t}\n\n\treturn newsetup;\n\n\tfail:\n\t\tif (newsetup->miscellaneous)\n\t\t\tfree(newsetup->miscellaneous);\n\t\tif (newsetup->instruments)\n\t\t\tfree(newsetup->instruments);\n\t\tif (newsetup->tracks)\n\t\t\tfree(newsetup->tracks);\n\t\tif (newsetup)\n\t\t\tfree(newsetup);\n\n\treturn AF_NULL_FILESETUP;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "newsetup"
          ],
          "line": 522
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "alloccopy",
          "args": [
            "LoopSetup",
            "setup->instruments[i].loopCount",
            "instrument->loops",
            "setup->instruments[i].loops"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_strdup",
          "args": [
            "setup->tracks[i].markers[j].comment"
          ],
          "line": 499
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_strdup",
          "args": [
            "setup->tracks[i].markers[j].name"
          ],
          "line": 494
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloccopy",
          "args": [
            "MarkerSetup",
            "setup->tracks[i].markerCount",
            "track->markers",
            "setup->tracks[i].markers"
          ],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloccopy",
          "args": [
            "MiscellaneousSetup",
            "miscellaneousCount",
            "newsetup->miscellaneous",
            "setup->miscellaneous"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloccopy",
          "args": [
            "InstrumentSetup",
            "instrumentCount",
            "newsetup->instruments",
            "setup->instruments"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alloccopy",
          "args": [
            "TrackSetup",
            "trackCount",
            "newsetup->tracks",
            "setup->tracks"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_malloc",
          "args": [
            "sizeof (_AFfilesetup)"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nAFfilesetup _af_filesetup_copy (const _AFfilesetup *setup,\n\tconst _AFfilesetup *defaultSetup, bool copyMarks)\n{\n\tAFfilesetup newsetup;\n\tint instrumentCount, miscellaneousCount, trackCount;\n\n\tnewsetup = (_AFfilesetup *) _af_malloc(sizeof (_AFfilesetup));\n\tif (newsetup == AF_NULL_FILESETUP)\n\t\treturn AF_NULL_FILESETUP;\n\n\t*newsetup = *defaultSetup;\n\n\tnewsetup->tracks = NULL;\n\tnewsetup->instruments = NULL;\n\tnewsetup->miscellaneous = NULL;\n\n\t/* Copy tracks. */\n\ttrackCount = setup->trackSet ? setup->trackCount :\n\t\tnewsetup->trackSet ? newsetup->trackCount : 0;\n\talloccopy(TrackSetup, trackCount, newsetup->tracks, setup->tracks);\n\tnewsetup->trackCount = trackCount;\n\n\t/* Copy instruments. */\n\tinstrumentCount = setup->instrumentSet ? setup->instrumentCount :\n\t\tnewsetup->instrumentSet ? newsetup->instrumentCount : 0;\n\talloccopy(InstrumentSetup, instrumentCount, newsetup->instruments, setup->instruments);\n\tnewsetup->instrumentCount = instrumentCount;\n\n\t/* Copy miscellaneous information. */\n\tmiscellaneousCount = setup->miscellaneousSet ? setup->miscellaneousCount :\n\t\tnewsetup->miscellaneousSet ? newsetup->miscellaneousCount : 0;\n\talloccopy(MiscellaneousSetup, miscellaneousCount, newsetup->miscellaneous, setup->miscellaneous);\n\tnewsetup->miscellaneousCount = miscellaneousCount;\n\n\tfor (int i=0; i<setup->trackCount; i++)\n\t{\n\t\tTrackSetup\t*track = &newsetup->tracks[i];\n\n\t\t/* XXXmpruett set compression information */\n\n\t\tif (!setup->tracks[i].markersSet && !copyMarks)\n\t\t{\n\t\t\ttrack->markers = NULL;\n\t\t\ttrack->markerCount = 0;\n\t\t\tcontinue;\n\t\t}\n\n\t\talloccopy(MarkerSetup, setup->tracks[i].markerCount,\n\t\t\ttrack->markers, setup->tracks[i].markers);\n\t\ttrack->markerCount = setup->tracks[i].markerCount;\n\n\t\tfor (int j=0; j<setup->tracks[i].markerCount; j++)\n\t\t{\n\t\t\ttrack->markers[j].name =\n\t\t\t\t_af_strdup(setup->tracks[i].markers[j].name);\n\t\t\tif (track->markers[j].name == NULL)\n\t\t\t\tgoto fail;\n\n\t\t\ttrack->markers[j].comment =\n\t\t\t\t_af_strdup(setup->tracks[i].markers[j].comment);\n\t\t\tif (track->markers[j].comment == NULL)\n\t\t\t\tgoto fail;\n\t\t}\n\t}\n\n\tfor (int i=0; i<newsetup->instrumentCount; i++)\n\t{\n\t\tInstrumentSetup\t*instrument = &newsetup->instruments[i];\n\t\talloccopy(LoopSetup, setup->instruments[i].loopCount,\n\t\t\tinstrument->loops, setup->instruments[i].loops);\n\t}\n\n\treturn newsetup;\n\n\tfail:\n\t\tif (newsetup->miscellaneous)\n\t\t\tfree(newsetup->miscellaneous);\n\t\tif (newsetup->instruments)\n\t\t\tfree(newsetup->instruments);\n\t\tif (newsetup->tracks)\n\t\t\tfree(newsetup->tracks);\n\t\tif (newsetup)\n\t\t\tfree(newsetup);\n\n\treturn AF_NULL_FILESETUP;\n}"
  },
  {
    "function_name": "afInitFrameCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "408-426",
    "snippet": "void afInitFrameCount (AFfilesetup setup, int trackid, AFfileoffset count)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (count < 0)\n\t{\n\t\t_af_error(AF_BAD_FRAMECNT, \"invalid frame count %jd\",\n\t\t\tstatic_cast<intmax_t>(count));\n\t\treturn;\n\t}\n\n\ttrack->frameCount = count;\n\ttrack->frameCountSet = true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FRAMECNT",
            "\"invalid frame count %jd\"",
            "static_cast<intmax_t>(count)"
          ],
          "line": 419
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "count"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid afInitFrameCount (AFfilesetup setup, int trackid, AFfileoffset count)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (count < 0)\n\t{\n\t\t_af_error(AF_BAD_FRAMECNT, \"invalid frame count %jd\",\n\t\t\tstatic_cast<intmax_t>(count));\n\t\treturn;\n\t}\n\n\ttrack->frameCount = count;\n\ttrack->frameCountSet = true;\n}"
  },
  {
    "function_name": "afInitDataOffset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "385-403",
    "snippet": "void afInitDataOffset (AFfilesetup setup, int trackid, AFfileoffset offset)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (offset < 0)\n\t{\n\t\t_af_error(AF_BAD_DATAOFFSET, \"invalid data offset %jd\",\n\t\t\tstatic_cast<intmax_t>(offset));\n\t\treturn;\n\t}\n\n\ttrack->dataOffset = offset;\n\ttrack->dataOffsetSet = true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_DATAOFFSET",
            "\"invalid data offset %jd\"",
            "static_cast<intmax_t>(offset)"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "offset"
          ],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid afInitDataOffset (AFfilesetup setup, int trackid, AFfileoffset offset)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (offset < 0)\n\t{\n\t\t_af_error(AF_BAD_DATAOFFSET, \"invalid data offset %jd\",\n\t\t\tstatic_cast<intmax_t>(offset));\n\t\treturn;\n\t}\n\n\ttrack->dataOffset = offset;\n\ttrack->dataOffsetSet = true;\n}"
  },
  {
    "function_name": "afInitRate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "363-380",
    "snippet": "void afInitRate (AFfilesetup setup, int trackid, double rate)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (rate <= 0.0)\n\t{\n\t\t_af_error(AF_BAD_RATE, \"invalid sample rate %.30g\", rate);\n\t\treturn;\n\t}\n\n\ttrack->f.sampleRate = rate;\n\ttrack->rateSet = true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_RATE",
            "\"invalid sample rate %.30g\"",
            "rate"
          ],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid afInitRate (AFfilesetup setup, int trackid, double rate)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (rate <= 0.0)\n\t{\n\t\t_af_error(AF_BAD_RATE, \"invalid sample rate %.30g\", rate);\n\t\treturn;\n\t}\n\n\ttrack->f.sampleRate = rate;\n\ttrack->rateSet = true;\n}"
  },
  {
    "function_name": "afInitByteOrder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "343-361",
    "snippet": "void afInitByteOrder (AFfilesetup setup, int trackid, int byteorder)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (byteorder != AF_BYTEORDER_BIGENDIAN &&\n\t\tbyteorder != AF_BYTEORDER_LITTLEENDIAN)\n\t{\n\t\t_af_error(AF_BAD_BYTEORDER, \"invalid byte order %d\", byteorder);\n\t\treturn;\n\t}\n\n\ttrack->f.byteOrder = byteorder;\n\ttrack->byteOrderSet = true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_BYTEORDER",
            "\"invalid byte order %d\"",
            "byteorder"
          ],
          "line": 355
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 345
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid afInitByteOrder (AFfilesetup setup, int trackid, int byteorder)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (byteorder != AF_BYTEORDER_BIGENDIAN &&\n\t\tbyteorder != AF_BYTEORDER_LITTLEENDIAN)\n\t{\n\t\t_af_error(AF_BAD_BYTEORDER, \"invalid byte order %d\", byteorder);\n\t\treturn;\n\t}\n\n\ttrack->f.byteOrder = byteorder;\n\ttrack->byteOrderSet = true;\n}"
  },
  {
    "function_name": "afInitSampleFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "328-341",
    "snippet": "void afInitSampleFormat (AFfilesetup setup, int trackid, int sampfmt, int sampwidth)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\t_af_set_sample_format(&track->f, sampfmt, sampwidth);\n\n\ttrack->sampleFormatSet = true;\n\ttrack->sampleWidthSet = true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_set_sample_format",
          "args": [
            "&track->f",
            "sampfmt",
            "sampwidth"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "_af_set_sample_format",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "315-361",
          "snippet": "status _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nstatus _af_set_sample_format (AudioFormat *f, int sampleFormat, int sampleWidth)\n{\n\tswitch (sampleFormat)\n\t{\n\t\tcase AF_SAMPFMT_UNSIGNED:\n\t\tcase AF_SAMPFMT_TWOSCOMP:\n\t\tif (sampleWidth < 1 || sampleWidth > 32)\n\t\t{\n\t\t\t_af_error(AF_BAD_SAMPFMT,\n\t\t\t\t\"illegal sample width %d for integer data\",\n\t\t\t\tsampleWidth);\n\t\t\treturn AF_FAIL;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tint bytes;\n\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = sampleWidth;\n\n\t\t\tbytes = _af_format_sample_size_uncompressed(f, false);\n\n\t\t\tif (sampleFormat == AF_SAMPFMT_TWOSCOMP)\n\t\t\t\tf->pcm = _af_default_signed_integer_pcm_mappings[bytes];\n\t\t\telse\n\t\t\t\tf->pcm = _af_default_unsigned_integer_pcm_mappings[bytes];\n\t\t}\n\t\tbreak;\n\n\t\tcase AF_SAMPFMT_FLOAT:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 32;\n\t\t\tf->pcm = _af_default_float_pcm_mapping;\n\t\t\tbreak;\n\t\tcase AF_SAMPFMT_DOUBLE:\n\t\t\tf->sampleFormat = sampleFormat;\n\t\t\tf->sampleWidth = 64;      /*for convenience */\n\t\t\tf->pcm = _af_default_double_pcm_mapping;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\t_af_error(AF_BAD_SAMPFMT, \"unknown sample format %d\",\n\t\t\t\tsampleFormat);\n\t\t\treturn AF_FAIL;\n\t}\n\n\treturn AF_SUCCEED;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid afInitSampleFormat (AFfilesetup setup, int trackid, int sampfmt, int sampwidth)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\t_af_set_sample_format(&track->f, sampfmt, sampwidth);\n\n\ttrack->sampleFormatSet = true;\n\ttrack->sampleWidthSet = true;\n}"
  },
  {
    "function_name": "afInitChannels",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "308-326",
    "snippet": "void afInitChannels (AFfilesetup setup, int trackid, int channels)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (channels < 1)\n\t{\n\t\t_af_error(AF_BAD_CHANNELS, \"invalid number of channels %d\",\n\t\t\tchannels);\n\t\treturn;\n\t}\n\n\ttrack->f.channelCount = channels;\n\ttrack->channelCountSet = true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CHANNELS",
            "\"invalid number of channels %d\"",
            "channels"
          ],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 313
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 310
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid afInitChannels (AFfilesetup setup, int trackid, int channels)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (channels < 1)\n\t{\n\t\t_af_error(AF_BAD_CHANNELS, \"invalid number of channels %d\",\n\t\t\tchannels);\n\t\treturn;\n\t}\n\n\ttrack->f.channelCount = channels;\n\ttrack->channelCountSet = true;\n}"
  },
  {
    "function_name": "afInitFileFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "285-306",
    "snippet": "void afInitFileFormat (AFfilesetup setup, int filefmt)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tif (filefmt < 0 || filefmt >= _AF_NUM_UNITS)\n\t{\n\t\t_af_error(AF_BAD_FILEFMT, \"unrecognized file format %d\",\n\t\t\tfilefmt);\n\t\treturn;\n\t}\n\n\tif (!_af_units[filefmt].implemented)\n\t{\n\t\t_af_error(AF_BAD_NOT_IMPLEMENTED,\n\t\t\t\"%s format not currently supported\",\n\t\t\t_af_units[filefmt].name);\n\t\treturn;\n\t}\n\n\tsetup->fileFormat = filefmt;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_NOT_IMPLEMENTED",
            "\"%s format not currently supported\"",
            "_af_units[filefmt].name"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_FILEFMT",
            "\"unrecognized file format %d\"",
            "filefmt"
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid afInitFileFormat (AFfilesetup setup, int filefmt)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tif (filefmt < 0 || filefmt >= _AF_NUM_UNITS)\n\t{\n\t\t_af_error(AF_BAD_FILEFMT, \"unrecognized file format %d\",\n\t\t\tfilefmt);\n\t\treturn;\n\t}\n\n\tif (!_af_units[filefmt].implemented)\n\t{\n\t\t_af_error(AF_BAD_NOT_IMPLEMENTED,\n\t\t\t\"%s format not currently supported\",\n\t\t\t_af_units[filefmt].name);\n\t\treturn;\n\t}\n\n\tsetup->fileFormat = filefmt;\n}"
  },
  {
    "function_name": "afFreeFileSetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "265-283",
    "snippet": "void afFreeFileSetup (AFfilesetup setup)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\t_af_setup_free_tracks(setup);\n\n\t_af_setup_free_instruments(setup);\n\n\tif (setup->miscellaneousCount)\n\t{\n\t\tfree(setup->miscellaneous);\n\t\tsetup->miscellaneous = NULL;\n\t\tsetup->miscellaneousCount = 0;\n\t}\n\n\tmemset(setup, 0, sizeof (_AFfilesetup));\n\tfree(setup);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "setup"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "setup",
            "0",
            "sizeof (_AFfilesetup)"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_setup_free_tracks",
          "args": [
            "setup"
          ],
          "line": 270
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_tracks",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "232-246",
          "snippet": "void _af_setup_free_tracks (AFfilesetup setup)\n{\n\tif (setup->tracks)\n\t{\n\t\tfor (int i=0; i<setup->trackCount; i++)\n\t\t{\n\t\t\t_af_setup_free_markers(setup, i);\n\t\t}\n\n\t\tfree(setup->tracks);\n\t}\n\n\tsetup->tracks = NULL;\n\tsetup->trackCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_tracks (AFfilesetup setup)\n{\n\tif (setup->tracks)\n\t{\n\t\tfor (int i=0; i<setup->trackCount; i++)\n\t\t{\n\t\t\t_af_setup_free_markers(setup, i);\n\t\t}\n\n\t\tfree(setup->tracks);\n\t}\n\n\tsetup->tracks = NULL;\n\tsetup->trackCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid afFreeFileSetup (AFfilesetup setup)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\t_af_setup_free_tracks(setup);\n\n\t_af_setup_free_instruments(setup);\n\n\tif (setup->miscellaneousCount)\n\t{\n\t\tfree(setup->miscellaneous);\n\t\tsetup->miscellaneous = NULL;\n\t\tsetup->miscellaneousCount = 0;\n\t}\n\n\tmemset(setup, 0, sizeof (_AFfilesetup));\n\tfree(setup);\n}"
  },
  {
    "function_name": "_af_setup_free_instruments",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "251-263",
    "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "setup->instruments"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "setup->instruments[i].freeLoops",
          "args": [],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "freeLoops",
          "container": "InstrumentSetup",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "69-75",
          "snippet": "void InstrumentSetup::freeLoops()\n{\n\tif (loops)\n\t\tfree(loops);\n\tloops = NULL;\n\tloopCount = 0;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nInstrumentSetup {\n  void InstrumentSetup::freeLoops()\n  {\n  \tif (loops)\n  \t\tfree(loops);\n  \tloops = NULL;\n  \tloopCount = 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
  },
  {
    "function_name": "_af_setup_free_tracks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "232-246",
    "snippet": "void _af_setup_free_tracks (AFfilesetup setup)\n{\n\tif (setup->tracks)\n\t{\n\t\tfor (int i=0; i<setup->trackCount; i++)\n\t\t{\n\t\t\t_af_setup_free_markers(setup, i);\n\t\t}\n\n\t\tfree(setup->tracks);\n\t}\n\n\tsetup->tracks = NULL;\n\tsetup->trackCount = 0;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "setup->tracks"
          ],
          "line": 241
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_setup_free_markers",
          "args": [
            "setup",
            "i"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_markers",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "212-227",
          "snippet": "void _af_setup_free_markers (AFfilesetup setup, int trackno)\n{\n\tif (setup->tracks[trackno].markerCount != 0)\n\t{\n\t\tfor (int i=0; i<setup->tracks[trackno].markerCount; i++)\n\t\t{\n\t\t\tfree(setup->tracks[trackno].markers[i].name);\n\t\t\tfree(setup->tracks[trackno].markers[i].comment);\n\t\t}\n\n\t\tfree(setup->tracks[trackno].markers);\n\t}\n\n\tsetup->tracks[trackno].markers = NULL;\n\tsetup->tracks[trackno].markerCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_markers (AFfilesetup setup, int trackno)\n{\n\tif (setup->tracks[trackno].markerCount != 0)\n\t{\n\t\tfor (int i=0; i<setup->tracks[trackno].markerCount; i++)\n\t\t{\n\t\t\tfree(setup->tracks[trackno].markers[i].name);\n\t\t\tfree(setup->tracks[trackno].markers[i].comment);\n\t\t}\n\n\t\tfree(setup->tracks[trackno].markers);\n\t}\n\n\tsetup->tracks[trackno].markers = NULL;\n\tsetup->tracks[trackno].markerCount = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_tracks (AFfilesetup setup)\n{\n\tif (setup->tracks)\n\t{\n\t\tfor (int i=0; i<setup->trackCount; i++)\n\t\t{\n\t\t\t_af_setup_free_markers(setup, i);\n\t\t}\n\n\t\tfree(setup->tracks);\n\t}\n\n\tsetup->tracks = NULL;\n\tsetup->trackCount = 0;\n}"
  },
  {
    "function_name": "_af_setup_free_markers",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "212-227",
    "snippet": "void _af_setup_free_markers (AFfilesetup setup, int trackno)\n{\n\tif (setup->tracks[trackno].markerCount != 0)\n\t{\n\t\tfor (int i=0; i<setup->tracks[trackno].markerCount; i++)\n\t\t{\n\t\t\tfree(setup->tracks[trackno].markers[i].name);\n\t\t\tfree(setup->tracks[trackno].markers[i].comment);\n\t\t}\n\n\t\tfree(setup->tracks[trackno].markers);\n\t}\n\n\tsetup->tracks[trackno].markers = NULL;\n\tsetup->tracks[trackno].markerCount = 0;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "setup->tracks[trackno].markers"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_markers (AFfilesetup setup, int trackno)\n{\n\tif (setup->tracks[trackno].markerCount != 0)\n\t{\n\t\tfor (int i=0; i<setup->tracks[trackno].markerCount; i++)\n\t\t{\n\t\t\tfree(setup->tracks[trackno].markers[i].name);\n\t\t\tfree(setup->tracks[trackno].markers[i].comment);\n\t\t}\n\n\t\tfree(setup->tracks[trackno].markers);\n\t}\n\n\tsetup->tracks[trackno].markers = NULL;\n\tsetup->tracks[trackno].markerCount = 0;\n}"
  },
  {
    "function_name": "afNewFileSetup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
    "lines": "179-207",
    "snippet": "AFfilesetup afNewFileSetup (void)\n{\n\tAFfilesetup\tsetup;\n\n\tsetup = (_AFfilesetup *) _af_malloc(sizeof (_AFfilesetup));\n\tif (setup == NULL) return AF_NULL_FILESETUP;\n\n\t*setup = _af_default_file_setup;\n\n\tsetup->tracks = _af_tracksetup_new(setup->trackCount);\n\n\tsetup->instruments = _af_instsetup_new(setup->instrumentCount);\n\n\tif (setup->miscellaneousCount == 0)\n\t\tsetup->miscellaneous = NULL;\n\telse\n\t{\n\t\tsetup->miscellaneous = (MiscellaneousSetup *) _af_calloc(setup->miscellaneousCount,\n\t\t\tsizeof (MiscellaneousSetup));\n\t\tfor (int i=0; i<setup->miscellaneousCount; i++)\n\t\t{\n\t\t\tsetup->miscellaneous[i].id = i+1;\n\t\t\tsetup->miscellaneous[i].type = 0;\n\t\t\tsetup->miscellaneous[i].size = 0;\n\t\t}\n\t}\n\n\treturn setup;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"pcm.h\"",
      "#include \"audiofile.h\"",
      "#include \"byteorder.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Marker.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include \"Setup.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const _AFfilesetup _af_default_file_setup =\n{\n\t_AF_VALID_FILESETUP,\t/* valid */\n#if WORDS_BIGENDIAN\n\tAF_FILE_AIFFC,\t/* file format */\n#else\n\tAF_FILE_WAVE,\t/* file format */\n#endif\n\tfalse,\t\t/* trackSet */\n\tfalse,\t\t/* instrumentSet */\n\tfalse,\t\t/* miscellaneousSet */\n\t1,\t\t/* trackCount */\n\tNULL,\t\t/* tracks */\n\t1,\t\t/* instrumentCount */\n\tNULL,\t\t/* instruments */\n\t0,\t\t/* miscellaneousCount */\n\tNULL\t\t/* miscellaneous */\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_calloc",
          "args": [
            "setup->miscellaneousCount",
            "sizeof (MiscellaneousSetup)"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_instsetup_new",
          "args": [
            "setup->instrumentCount"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_tracksetup_new",
          "args": [
            "setup->trackCount"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_malloc",
          "args": [
            "sizeof (_AFfilesetup)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nstatic const _AFfilesetup _af_default_file_setup =\n{\n\t_AF_VALID_FILESETUP,\t/* valid */\n#if WORDS_BIGENDIAN\n\tAF_FILE_AIFFC,\t/* file format */\n#else\n\tAF_FILE_WAVE,\t/* file format */\n#endif\n\tfalse,\t\t/* trackSet */\n\tfalse,\t\t/* instrumentSet */\n\tfalse,\t\t/* miscellaneousSet */\n\t1,\t\t/* trackCount */\n\tNULL,\t\t/* tracks */\n\t1,\t\t/* instrumentCount */\n\tNULL,\t\t/* instruments */\n\t0,\t\t/* miscellaneousCount */\n\tNULL\t\t/* miscellaneous */\n};\n\nAFfilesetup afNewFileSetup (void)\n{\n\tAFfilesetup\tsetup;\n\n\tsetup = (_AFfilesetup *) _af_malloc(sizeof (_AFfilesetup));\n\tif (setup == NULL) return AF_NULL_FILESETUP;\n\n\t*setup = _af_default_file_setup;\n\n\tsetup->tracks = _af_tracksetup_new(setup->trackCount);\n\n\tsetup->instruments = _af_instsetup_new(setup->instrumentCount);\n\n\tif (setup->miscellaneousCount == 0)\n\t\tsetup->miscellaneous = NULL;\n\telse\n\t{\n\t\tsetup->miscellaneous = (MiscellaneousSetup *) _af_calloc(setup->miscellaneousCount,\n\t\t\tsizeof (MiscellaneousSetup));\n\t\tfor (int i=0; i<setup->miscellaneousCount; i++)\n\t\t{\n\t\t\tsetup->miscellaneous[i].id = i+1;\n\t\t\tsetup->miscellaneous[i].type = 0;\n\t\t\tsetup->miscellaneous[i].size = 0;\n\t\t}\n\t}\n\n\treturn setup;\n}"
  }
]