[
  {
    "function_name": "_af_flac_format_ok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "486-489",
    "snippet": "bool _af_flac_format_ok(AudioFormat *)\n{\n\treturn false;\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nbool _af_flac_format_ok(AudioFormat *)\n{\n\treturn false;\n}"
  },
  {
    "function_name": "_af_flac_format_ok",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "457-482",
    "snippet": "bool _af_flac_format_ok(AudioFormat *f)\n{\n\tif (f->channelCount > static_cast<int>(FLAC__MAX_CHANNELS))\n\t{\n\t\t_af_error(AF_BAD_COMPRESSION,\n\t\t\t\"FLAC compression supports a maximum of 8 channels\");\n\t\treturn false;\n\t}\n\n\tif (f->sampleFormat != AF_SAMPFMT_TWOSCOMP ||\n\t\t(f->sampleWidth != 16 && f->sampleWidth != 24))\n\t{\n\t\t_af_error(AF_BAD_COMPRESSION,\n\t\t\t\"FLAC compression requires 16- or 24-bit signed integer format\");\n\t\treturn false;\n\t}\n\n\tif (f->byteOrder != _AF_BYTEORDER_NATIVE)\n\t{\n\t\t_af_error(AF_BAD_COMPRESSION,\n\t\t\t\"FLAC compression requires native byte order\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_COMPRESSION",
            "\"FLAC compression requires native byte order\""
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_COMPRESSION",
            "\"FLAC compression requires 16- or 24-bit signed integer format\""
          ],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_COMPRESSION",
            "\"FLAC compression supports a maximum of 8 channels\""
          ],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "FLAC__MAX_CHANNELS"
          ],
          "line": 459
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nbool _af_flac_format_ok(AudioFormat *f)\n{\n\tif (f->channelCount > static_cast<int>(FLAC__MAX_CHANNELS))\n\t{\n\t\t_af_error(AF_BAD_COMPRESSION,\n\t\t\t\"FLAC compression supports a maximum of 8 channels\");\n\t\treturn false;\n\t}\n\n\tif (f->sampleFormat != AF_SAMPFMT_TWOSCOMP ||\n\t\t(f->sampleWidth != 16 && f->sampleWidth != 24))\n\t{\n\t\t_af_error(AF_BAD_COMPRESSION,\n\t\t\t\"FLAC compression requires 16- or 24-bit signed integer format\");\n\t\treturn false;\n\t}\n\n\tif (f->byteOrder != _AF_BYTEORDER_NATIVE)\n\t{\n\t\t_af_error(AF_BAD_COMPRESSION,\n\t\t\t\"FLAC compression requires native byte order\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}"
  },
  {
    "function_name": "convert24To32",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "435-455",
    "snippet": "void FLACEncoder::convert24To32()\n{\n\tint channelCount = m_track->f.channelCount;\n\tconst uint8_t *src = static_cast<const uint8_t *>(m_inChunk->buffer);\n\tfor (unsigned i=0; i<m_inChunk->frameCount; i++)\n\t\tfor (int c=0; c<channelCount; c++)\n\t\t{\n\t\t\tint srcIndex = channelCount * i + c; \n\t\t\tint32_t t =\n#ifdef WORDS_BIGENDIAN\n\t\t\t\t(src[3*srcIndex] << 24) |\n\t\t\t\t(src[3*srcIndex+1] << 16) |\n\t\t\t\tsrc[3*srcIndex+2] << 8;\n#else\n\t\t\t\t(src[3*srcIndex+2] << 24) |\n\t\t\t\t(src[3*srcIndex+1] << 16) |\n\t\t\t\tsrc[3*srcIndex] << 8;\n#endif\n\t\t\tm_buffer[channelCount * i + c] = t >> 8;\n\t\t}\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "WORDS_BIGENDIAN",
          "args": [
            "src[3*srcIndex] << 24"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<const uint8_t *>",
          "args": [
            "m_inChunk->buffer"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  void FLACEncoder::convert24To32()\n  {\n  \tint channelCount = m_track->f.channelCount;\n  \tconst uint8_t *src = static_cast<const uint8_t *>(m_inChunk->buffer);\n  \tfor (unsigned i=0; i<m_inChunk->frameCount; i++)\n  \t\tfor (int c=0; c<channelCount; c++)\n  \t\t{\n  \t\t\tint srcIndex = channelCount * i + c; \n  \t\t\tint32_t t =\n  #ifdef WORDS_BIGENDIAN\n  \t\t\t\t(src[3*srcIndex] << 24) |\n  \t\t\t\t(src[3*srcIndex+1] << 16) |\n  \t\t\t\tsrc[3*srcIndex+2] << 8;\n  #else\n  \t\t\t\t(src[3*srcIndex+2] << 24) |\n  \t\t\t\t(src[3*srcIndex+1] << 16) |\n  \t\t\t\tsrc[3*srcIndex] << 8;\n  #endif\n  \t\t\tm_buffer[channelCount * i + c] = t >> 8;\n  \t\t}\n  }\n}"
  },
  {
    "function_name": "convert16To32",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "426-433",
    "snippet": "void FLACEncoder::convert16To32()\n{\n\tint channelCount = m_track->f.channelCount;\n\tconst int16_t *src = static_cast<const int16_t *>(m_inChunk->buffer);\n\tfor (unsigned i=0; i<m_inChunk->frameCount; i++)\n\t\tfor (int c=0; c<channelCount; c++)\n\t\t\tm_buffer[channelCount * i + c] = src[channelCount * i + c];\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<const int16_t *>",
          "args": [
            "m_inChunk->buffer"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  void FLACEncoder::convert16To32()\n  {\n  \tint channelCount = m_track->f.channelCount;\n  \tconst int16_t *src = static_cast<const int16_t *>(m_inChunk->buffer);\n  \tfor (unsigned i=0; i<m_inChunk->frameCount; i++)\n  \t\tfor (int c=0; c<channelCount; c++)\n  \t\t\tm_buffer[channelCount * i + c] = src[channelCount * i + c];\n  }\n}"
  },
  {
    "function_name": "sync2",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "418-424",
    "snippet": "void FLACEncoder::sync2()\n{\n\tif (!FLAC__stream_encoder_finish(m_encoder))\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not finish encoding\");\n\t}\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not finish encoding\""
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_encoder_finish",
          "args": [
            "m_encoder"
          ],
          "line": 420
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  void FLACEncoder::sync2()\n  {\n  \tif (!FLAC__stream_encoder_finish(m_encoder))\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not finish encoding\");\n  \t}\n  }\n}"
  },
  {
    "function_name": "sync1",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "414-416",
    "snippet": "void FLACEncoder::sync1()\n{\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  void FLACEncoder::sync1()\n  {\n  }\n}"
  },
  {
    "function_name": "runPush",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "397-412",
    "snippet": "void FLACEncoder::runPush()\n{\n\tif (m_track->f.sampleWidth == 16)\n\t\tconvert16To32();\n\telse if (m_track->f.sampleWidth == 24)\n\t\tconvert24To32();\n\n\tif (!FLAC__stream_encoder_process_interleaved(m_encoder, m_buffer,\n\t\tm_inChunk->frameCount))\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not encode data into FLAC stream\");\n\t}\n\n\tm_track->nextfframe += m_inChunk->frameCount;\n\tm_track->totalfframes = m_track->nextfframe;\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not encode data into FLAC stream\""
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_encoder_process_interleaved",
          "args": [
            "m_encoder",
            "m_buffer",
            "m_inChunk->frameCount"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convert24To32",
          "args": [],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "convert24To32",
          "container": "FLACEncoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
          "lines": "435-455",
          "snippet": "void FLACEncoder::convert24To32()\n{\n\tint channelCount = m_track->f.channelCount;\n\tconst uint8_t *src = static_cast<const uint8_t *>(m_inChunk->buffer);\n\tfor (unsigned i=0; i<m_inChunk->frameCount; i++)\n\t\tfor (int c=0; c<channelCount; c++)\n\t\t{\n\t\t\tint srcIndex = channelCount * i + c; \n\t\t\tint32_t t =\n#ifdef WORDS_BIGENDIAN\n\t\t\t\t(src[3*srcIndex] << 24) |\n\t\t\t\t(src[3*srcIndex+1] << 16) |\n\t\t\t\tsrc[3*srcIndex+2] << 8;\n#else\n\t\t\t\t(src[3*srcIndex+2] << 24) |\n\t\t\t\t(src[3*srcIndex+1] << 16) |\n\t\t\t\tsrc[3*srcIndex] << 8;\n#endif\n\t\t\tm_buffer[channelCount * i + c] = t >> 8;\n\t\t}\n}",
          "includes": [
            "#include <vector>",
            "#include <algorithm>",
            "#include <string.h>",
            "#include <assert.h>",
            "#include <FLAC/stream_encoder.h>",
            "#include <FLAC/stream_decoder.h>",
            "#include \"byteorder.h\"",
            "#include \"Track.h\"",
            "#include \"Features.h\"",
            "#include \"FileModule.h\"",
            "#include \"Compiler.h\"",
            "#include \"FLAC.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  void FLACEncoder::convert24To32()\n  {\n  \tint channelCount = m_track->f.channelCount;\n  \tconst uint8_t *src = static_cast<const uint8_t *>(m_inChunk->buffer);\n  \tfor (unsigned i=0; i<m_inChunk->frameCount; i++)\n  \t\tfor (int c=0; c<channelCount; c++)\n  \t\t{\n  \t\t\tint srcIndex = channelCount * i + c; \n  \t\t\tint32_t t =\n  #ifdef WORDS_BIGENDIAN\n  \t\t\t\t(src[3*srcIndex] << 24) |\n  \t\t\t\t(src[3*srcIndex+1] << 16) |\n  \t\t\t\tsrc[3*srcIndex+2] << 8;\n  #else\n  \t\t\t\t(src[3*srcIndex+2] << 24) |\n  \t\t\t\t(src[3*srcIndex+1] << 16) |\n  \t\t\t\tsrc[3*srcIndex] << 8;\n  #endif\n  \t\t\tm_buffer[channelCount * i + c] = t >> 8;\n  \t\t}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "convert16To32",
          "args": [],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "convert16To32",
          "container": "FLACEncoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
          "lines": "426-433",
          "snippet": "void FLACEncoder::convert16To32()\n{\n\tint channelCount = m_track->f.channelCount;\n\tconst int16_t *src = static_cast<const int16_t *>(m_inChunk->buffer);\n\tfor (unsigned i=0; i<m_inChunk->frameCount; i++)\n\t\tfor (int c=0; c<channelCount; c++)\n\t\t\tm_buffer[channelCount * i + c] = src[channelCount * i + c];\n}",
          "includes": [
            "#include <vector>",
            "#include <algorithm>",
            "#include <string.h>",
            "#include <assert.h>",
            "#include <FLAC/stream_encoder.h>",
            "#include <FLAC/stream_decoder.h>",
            "#include \"byteorder.h\"",
            "#include \"Track.h\"",
            "#include \"Features.h\"",
            "#include \"FileModule.h\"",
            "#include \"Compiler.h\"",
            "#include \"FLAC.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  void FLACEncoder::convert16To32()\n  {\n  \tint channelCount = m_track->f.channelCount;\n  \tconst int16_t *src = static_cast<const int16_t *>(m_inChunk->buffer);\n  \tfor (unsigned i=0; i<m_inChunk->frameCount; i++)\n  \t\tfor (int c=0; c<channelCount; c++)\n  \t\t\tm_buffer[channelCount * i + c] = src[channelCount * i + c];\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  void FLACEncoder::runPush()\n  {\n  \tif (m_track->f.sampleWidth == 16)\n  \t\tconvert16To32();\n  \telse if (m_track->f.sampleWidth == 24)\n  \t\tconvert24To32();\n  \n  \tif (!FLAC__stream_encoder_process_interleaved(m_encoder, m_buffer,\n  \t\tm_inChunk->frameCount))\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not encode data into FLAC stream\");\n  \t}\n  \n  \tm_track->nextfframe += m_inChunk->frameCount;\n  \tm_track->totalfframes = m_track->nextfframe;\n  }\n}"
  },
  {
    "function_name": "describe",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "391-395",
    "snippet": "void FLACEncoder::describe()\n{\n\tm_outChunk->f.byteOrder = _AF_BYTEORDER_NATIVE;\n\tm_outChunk->f.compressionType = AF_COMPRESSION_FLAC;\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  void FLACEncoder::describe()\n  {\n  \tm_outChunk->f.byteOrder = _AF_BYTEORDER_NATIVE;\n  \tm_outChunk->f.compressionType = AF_COMPRESSION_FLAC;\n  }\n}"
  },
  {
    "function_name": "~FLACEncoder",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "374-383",
    "snippet": "FLACEncoder::~FLACEncoder()\n{\n\tif (m_encoder)\n\t{\n\t\tFLAC__stream_encoder_delete(m_encoder);\n\t\tm_encoder = NULL;\n\t}\n\n\tdelete [] m_buffer;\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FLAC__stream_encoder_delete",
          "args": [
            "m_encoder"
          ],
          "line": 378
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  FLACEncoder::~FLACEncoder()\n  {\n  \tif (m_encoder)\n  \t{\n  \t\tFLAC__stream_encoder_delete(m_encoder);\n  \t\tm_encoder = NULL;\n  \t}\n  \n  \tdelete [] m_buffer;\n  }\n}"
  },
  {
    "function_name": "FLACEncoder",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "330-372",
    "snippet": "FLACEncoder::FLACEncoder(Track *track, File *file, bool canSeek) :\n\tFileModule(Compress, track, file, canSeek),\n\tm_encoder(NULL),\n\tm_buffer(NULL)\n{\n\tm_encoder = FLAC__stream_encoder_new();\n\tif (!m_encoder)\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not create encoder\");\n\t\treturn;\n\t}\n\n\tif (!FLAC__stream_encoder_set_channels(m_encoder, m_track->f.channelCount))\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not set channel count\");\n\t\treturn;\n\t}\n\n\tif (!FLAC__stream_encoder_set_sample_rate(m_encoder, m_track->f.sampleRate))\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not set sample rate\");\n\t\treturn;\n\t}\n\n\tif (!FLAC__stream_encoder_set_bits_per_sample(m_encoder, m_track->f.sampleWidth))\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not set sample width\");\n\t\treturn;\n\t}\n\n\tif (FLAC__stream_encoder_init_stream(m_encoder,\n\t\twriteCallback,\n\t\tseekCallback,\n\t\ttellCallback,\n\t\tNULL,\n\t\tthis) != FLAC__STREAM_ENCODER_INIT_STATUS_OK)\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not initialize FLAC encoder\");\n\t\treturn;\n\t}\n\n\tm_buffer = new int32_t[FLAC__MAX_BLOCK_SIZE * m_track->f.channelCount];\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not initialize FLAC encoder\""
          ],
          "line": 367
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_encoder_init_stream",
          "args": [
            "m_encoder",
            "writeCallback",
            "seekCallback",
            "tellCallback",
            "NULL",
            "this"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not set sample width\""
          ],
          "line": 356
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_encoder_set_bits_per_sample",
          "args": [
            "m_encoder",
            "m_track->f.sampleWidth"
          ],
          "line": 354
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not set sample rate\""
          ],
          "line": 350
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_encoder_set_sample_rate",
          "args": [
            "m_encoder",
            "m_track->f.sampleRate"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not set channel count\""
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_encoder_set_channels",
          "args": [
            "m_encoder",
            "m_track->f.channelCount"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not create encoder\""
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_encoder_new",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  FLACEncoder::FLACEncoder(Track *track, File *file, bool canSeek) :\n  \tFileModule(Compress, track, file, canSeek),\n  \tm_encoder(NULL),\n  \tm_buffer(NULL)\n  {\n  \tm_encoder = FLAC__stream_encoder_new();\n  \tif (!m_encoder)\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not create encoder\");\n  \t\treturn;\n  \t}\n  \n  \tif (!FLAC__stream_encoder_set_channels(m_encoder, m_track->f.channelCount))\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not set channel count\");\n  \t\treturn;\n  \t}\n  \n  \tif (!FLAC__stream_encoder_set_sample_rate(m_encoder, m_track->f.sampleRate))\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not set sample rate\");\n  \t\treturn;\n  \t}\n  \n  \tif (!FLAC__stream_encoder_set_bits_per_sample(m_encoder, m_track->f.sampleWidth))\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not set sample width\");\n  \t\treturn;\n  \t}\n  \n  \tif (FLAC__stream_encoder_init_stream(m_encoder,\n  \t\twriteCallback,\n  \t\tseekCallback,\n  \t\ttellCallback,\n  \t\tNULL,\n  \t\tthis) != FLAC__STREAM_ENCODER_INIT_STATUS_OK)\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not initialize FLAC encoder\");\n  \t\treturn;\n  \t}\n  \n  \tm_buffer = new int32_t[FLAC__MAX_BLOCK_SIZE * m_track->f.channelCount];\n  }\n}"
  },
  {
    "function_name": "writeCallback",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "320-327",
    "snippet": "static FLAC__StreamEncoderWriteStatus writeCallback(const FLAC__StreamEncoder *, const FLAC__byte buffer[], size_t bytes, unsigned samples, unsigned currentFrame, void *clientData)\n\t{\n\t\tFLACEncoder *flac = static_cast<FLACEncoder *>(clientData);\n\t\tssize_t result = flac->write(buffer, bytes);\n\t\tif (result == static_cast<ssize_t>(bytes))\n\t\t\treturn FLAC__STREAM_ENCODER_WRITE_STATUS_OK;\n\t\treturn FLAC__STREAM_ENCODER_WRITE_STATUS_FATAL_ERROR;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<ssize_t>",
          "args": [
            "bytes"
          ],
          "line": 324
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flac->write",
          "args": [
            "buffer",
            "bytes"
          ],
          "line": 323
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "50-59",
          "snippet": "ssize_t FileModule::write(const void *data, size_t nbytes)\n{\n\tssize_t bytesWritten = m_fh->write(data, nbytes);\n\tif (bytesWritten > 0)\n\t{\n\t\tm_track->fpos_next_frame += bytesWritten;\n\t\tm_track->data_size += bytesWritten;\n\t}\n\treturn bytesWritten;\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  ssize_t FileModule::write(const void *data, size_t nbytes)\n  {\n  \tssize_t bytesWritten = m_fh->write(data, nbytes);\n  \tif (bytesWritten > 0)\n  \t{\n  \t\tm_track->fpos_next_frame += bytesWritten;\n  \t\tm_track->data_size += bytesWritten;\n  \t}\n  \treturn bytesWritten;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACEncoder *>",
          "args": [
            "clientData"
          ],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  static FLAC__StreamEncoderWriteStatus writeCallback(const FLAC__StreamEncoder *, const FLAC__byte buffer[], size_t bytes, unsigned samples, unsigned currentFrame, void *clientData)\n  \t{\n  \t\tFLACEncoder *flac = static_cast<FLACEncoder *>(clientData);\n  \t\tssize_t result = flac->write(buffer, bytes);\n  \t\tif (result == static_cast<ssize_t>(bytes))\n  \t\t\treturn FLAC__STREAM_ENCODER_WRITE_STATUS_OK;\n  \t\treturn FLAC__STREAM_ENCODER_WRITE_STATUS_FATAL_ERROR;\n  \t}\n}"
  },
  {
    "function_name": "tellCallback",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "310-318",
    "snippet": "static FLAC__StreamEncoderTellStatus tellCallback(const FLAC__StreamEncoder *, FLAC__uint64 *absoluteByteOffset, void *clientData)\n\t{\n\t\tFLACEncoder *flac = static_cast<FLACEncoder *>(clientData);\n\t\toff_t offset = flac->tell();\n\t\tif (offset < 0)\n\t\t\treturn FLAC__STREAM_ENCODER_TELL_STATUS_ERROR;\n\t\t*absoluteByteOffset = static_cast<FLAC__uint64>(offset);\n\t\treturn FLAC__STREAM_ENCODER_TELL_STATUS_OK;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<FLAC__uint64>",
          "args": [
            "offset"
          ],
          "line": 316
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flac->tell",
          "args": [],
          "line": 313
        },
        "resolved": true,
        "details": {
          "function_name": "tell",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "66-69",
          "snippet": "off_t FileModule::tell()\n{\n\treturn m_fh->tell();\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::tell()\n  {\n  \treturn m_fh->tell();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACEncoder *>",
          "args": [
            "clientData"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  static FLAC__StreamEncoderTellStatus tellCallback(const FLAC__StreamEncoder *, FLAC__uint64 *absoluteByteOffset, void *clientData)\n  \t{\n  \t\tFLACEncoder *flac = static_cast<FLACEncoder *>(clientData);\n  \t\toff_t offset = flac->tell();\n  \t\tif (offset < 0)\n  \t\t\treturn FLAC__STREAM_ENCODER_TELL_STATUS_ERROR;\n  \t\t*absoluteByteOffset = static_cast<FLAC__uint64>(offset);\n  \t\treturn FLAC__STREAM_ENCODER_TELL_STATUS_OK;\n  \t}\n}"
  },
  {
    "function_name": "seekCallback",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "301-308",
    "snippet": "static FLAC__StreamEncoderSeekStatus seekCallback(const FLAC__StreamEncoder *, FLAC__uint64 absoluteByteOffset, void *clientData)\n\t{\n\t\tFLACEncoder *flac = static_cast<FLACEncoder *>(clientData);\n\t\toff_t result = flac->seek(absoluteByteOffset);\n\t\tif (result < 0)\n\t\t\treturn FLAC__STREAM_ENCODER_SEEK_STATUS_ERROR;\n\t\treturn FLAC__STREAM_ENCODER_SEEK_STATUS_OK;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flac->seek",
          "args": [
            "absoluteByteOffset"
          ],
          "line": 304
        },
        "resolved": true,
        "details": {
          "function_name": "seek",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "61-64",
          "snippet": "off_t FileModule::seek(off_t offset)\n{\n\treturn m_fh->seek(offset, File::SeekFromBeginning);\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::seek(off_t offset)\n  {\n  \treturn m_fh->seek(offset, File::SeekFromBeginning);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACEncoder *>",
          "args": [
            "clientData"
          ],
          "line": 303
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  static FLAC__StreamEncoderSeekStatus seekCallback(const FLAC__StreamEncoder *, FLAC__uint64 absoluteByteOffset, void *clientData)\n  \t{\n  \t\tFLACEncoder *flac = static_cast<FLACEncoder *>(clientData);\n  \t\toff_t result = flac->seek(absoluteByteOffset);\n  \t\tif (result < 0)\n  \t\t\treturn FLAC__STREAM_ENCODER_SEEK_STATUS_ERROR;\n  \t\treturn FLAC__STREAM_ENCODER_SEEK_STATUS_OK;\n  \t}\n}"
  },
  {
    "function_name": "handlesSeeking",
    "container": "FLACEncoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "290-290",
    "snippet": "virtual bool handlesSeeking() const OVERRIDE { return true; }",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACEncoder {\n  virtual bool handlesSeeking() const OVERRIDE { return true; }\n}"
  },
  {
    "function_name": "reset2",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "266-273",
    "snippet": "void FLACDecoder::reset2()\n{\n\tif (!FLAC__stream_decoder_seek_absolute(m_decoder, m_track->nextfframe))\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not seek to frame %jd\",\n\t\t\tstatic_cast<intmax_t>(m_track->nextfframe));\n\t}\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not seek to frame %jd\"",
            "static_cast<intmax_t>(m_track->nextfframe)"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "m_track->nextfframe"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_decoder_seek_absolute",
          "args": [
            "m_decoder",
            "m_track->nextfframe"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  void FLACDecoder::reset2()\n  {\n  \tif (!FLAC__stream_decoder_seek_absolute(m_decoder, m_track->nextfframe))\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not seek to frame %jd\",\n  \t\t\tstatic_cast<intmax_t>(m_track->nextfframe));\n  \t}\n  }\n}"
  },
  {
    "function_name": "reset1",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "262-264",
    "snippet": "void FLACDecoder::reset1()\n{\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  void FLACDecoder::reset1()\n  {\n  }\n}"
  },
  {
    "function_name": "runPull",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "240-260",
    "snippet": "void FLACDecoder::runPull()\n{\n\tint framesToRead = m_outChunk->frameCount;\n\tint offset = 0;\n\twhile (framesToRead > 0)\n\t{\n\t\tint bufferedFramesToRead = std::min<int>(framesToRead,\n\t\t\tm_bufferedFrames - m_bufferedOffset);\n\t\tconvertAndInterleave(offset, bufferedFramesToRead);\n\t\toffset += bufferedFramesToRead;\n\t\tframesToRead -= bufferedFramesToRead;\n\n\t\tif (framesToRead > 0)\n\t\t{\n\t\t\tif (!FLAC__stream_decoder_process_single(m_decoder))\n\t\t\t\tbreak;\n\t\t\tif (FLAC__stream_decoder_get_state(m_decoder) >= FLAC__STREAM_DECODER_END_OF_STREAM)\n\t\t\t\tbreak;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FLAC__stream_decoder_get_state",
          "args": [
            "m_decoder"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_decoder_process_single",
          "args": [
            "m_decoder"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "convertAndInterleave",
          "args": [
            "offset",
            "bufferedFramesToRead"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "convertAndInterleave",
          "container": "FLACDecoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
          "lines": "193-238",
          "snippet": "void FLACDecoder::convertAndInterleave(int offset, int frameCount)\n{\n\tint channelCount = m_outChunk->f.channelCount;\n\n\tif (m_track->f.sampleWidth == 16)\n\t{\n\t\tint16_t *out = static_cast<int16_t *>(m_outChunk->buffer);\n\t\tfor (int i=0; i<frameCount; i++)\n\t\t{\n\t\t\tfor (int c=0; c<channelCount; c++)\n\t\t\t{\n\t\t\t\tint outIndex = (offset+i) * channelCount + c;\n\t\t\t\tout[outIndex] = m_buffer[c][m_bufferedOffset + i];\n\t\t\t}\n\t\t}\n\t}\n\telse if (m_track->f.sampleWidth == 24)\n\t{\n\t\tuint8_t *out = static_cast<uint8_t *>(m_outChunk->buffer);\n\t\tfor (int i=0; i<frameCount; i++)\n\t\t{\n\t\t\tfor (int c=0; c<channelCount; c++)\n\t\t\t{\n\t\t\t\tint32_t in = m_buffer[c][m_bufferedOffset + i];\n\t\t\t\tuint8_t c0, c1, c2;\n\n#ifdef WORDS_BIGENDIAN\n\t\t\t\tc0 = (in >> 16) & 0xff;\n\t\t\t\tc1 = (in >> 8) & 0xff;\n\t\t\t\tc2 = in & 0xff;\n#else\n\t\t\t\tc2 = (in >> 16) & 0xff;\n\t\t\t\tc1 = (in >> 8) & 0xff;\n\t\t\t\tc0 = in & 0xff;\n#endif\n\n\t\t\t\tint outIndex = (offset+i) * channelCount + c;\n\t\t\t\tout[3*outIndex] = c0;\n\t\t\t\tout[3*outIndex+1] = c1;\n\t\t\t\tout[3*outIndex+2] = c2;\n\t\t\t}\n\t\t}\n\t}\n\n\tm_bufferedOffset += frameCount;\n}",
          "includes": [
            "#include <vector>",
            "#include <algorithm>",
            "#include <string.h>",
            "#include <assert.h>",
            "#include <FLAC/stream_encoder.h>",
            "#include <FLAC/stream_decoder.h>",
            "#include \"byteorder.h\"",
            "#include \"Track.h\"",
            "#include \"Features.h\"",
            "#include \"FileModule.h\"",
            "#include \"Compiler.h\"",
            "#include \"FLAC.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  void FLACDecoder::convertAndInterleave(int offset, int frameCount)\n  {\n  \tint channelCount = m_outChunk->f.channelCount;\n  \n  \tif (m_track->f.sampleWidth == 16)\n  \t{\n  \t\tint16_t *out = static_cast<int16_t *>(m_outChunk->buffer);\n  \t\tfor (int i=0; i<frameCount; i++)\n  \t\t{\n  \t\t\tfor (int c=0; c<channelCount; c++)\n  \t\t\t{\n  \t\t\t\tint outIndex = (offset+i) * channelCount + c;\n  \t\t\t\tout[outIndex] = m_buffer[c][m_bufferedOffset + i];\n  \t\t\t}\n  \t\t}\n  \t}\n  \telse if (m_track->f.sampleWidth == 24)\n  \t{\n  \t\tuint8_t *out = static_cast<uint8_t *>(m_outChunk->buffer);\n  \t\tfor (int i=0; i<frameCount; i++)\n  \t\t{\n  \t\t\tfor (int c=0; c<channelCount; c++)\n  \t\t\t{\n  \t\t\t\tint32_t in = m_buffer[c][m_bufferedOffset + i];\n  \t\t\t\tuint8_t c0, c1, c2;\n  \n  #ifdef WORDS_BIGENDIAN\n  \t\t\t\tc0 = (in >> 16) & 0xff;\n  \t\t\t\tc1 = (in >> 8) & 0xff;\n  \t\t\t\tc2 = in & 0xff;\n  #else\n  \t\t\t\tc2 = (in >> 16) & 0xff;\n  \t\t\t\tc1 = (in >> 8) & 0xff;\n  \t\t\t\tc0 = in & 0xff;\n  #endif\n  \n  \t\t\t\tint outIndex = (offset+i) * channelCount + c;\n  \t\t\t\tout[3*outIndex] = c0;\n  \t\t\t\tout[3*outIndex+1] = c1;\n  \t\t\t\tout[3*outIndex+2] = c2;\n  \t\t\t}\n  \t\t}\n  \t}\n  \n  \tm_bufferedOffset += frameCount;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::min<int>",
          "args": [
            "framesToRead",
            "m_bufferedFrames - m_bufferedOffset"
          ],
          "line": 246
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  void FLACDecoder::runPull()\n  {\n  \tint framesToRead = m_outChunk->frameCount;\n  \tint offset = 0;\n  \twhile (framesToRead > 0)\n  \t{\n  \t\tint bufferedFramesToRead = std::min<int>(framesToRead,\n  \t\t\tm_bufferedFrames - m_bufferedOffset);\n  \t\tconvertAndInterleave(offset, bufferedFramesToRead);\n  \t\toffset += bufferedFramesToRead;\n  \t\tframesToRead -= bufferedFramesToRead;\n  \n  \t\tif (framesToRead > 0)\n  \t\t{\n  \t\t\tif (!FLAC__stream_decoder_process_single(m_decoder))\n  \t\t\t\tbreak;\n  \t\t\tif (FLAC__stream_decoder_get_state(m_decoder) >= FLAC__STREAM_DECODER_END_OF_STREAM)\n  \t\t\t\tbreak;\n  \t\t}\n  \t}\n  }\n}"
  },
  {
    "function_name": "convertAndInterleave",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "193-238",
    "snippet": "void FLACDecoder::convertAndInterleave(int offset, int frameCount)\n{\n\tint channelCount = m_outChunk->f.channelCount;\n\n\tif (m_track->f.sampleWidth == 16)\n\t{\n\t\tint16_t *out = static_cast<int16_t *>(m_outChunk->buffer);\n\t\tfor (int i=0; i<frameCount; i++)\n\t\t{\n\t\t\tfor (int c=0; c<channelCount; c++)\n\t\t\t{\n\t\t\t\tint outIndex = (offset+i) * channelCount + c;\n\t\t\t\tout[outIndex] = m_buffer[c][m_bufferedOffset + i];\n\t\t\t}\n\t\t}\n\t}\n\telse if (m_track->f.sampleWidth == 24)\n\t{\n\t\tuint8_t *out = static_cast<uint8_t *>(m_outChunk->buffer);\n\t\tfor (int i=0; i<frameCount; i++)\n\t\t{\n\t\t\tfor (int c=0; c<channelCount; c++)\n\t\t\t{\n\t\t\t\tint32_t in = m_buffer[c][m_bufferedOffset + i];\n\t\t\t\tuint8_t c0, c1, c2;\n\n#ifdef WORDS_BIGENDIAN\n\t\t\t\tc0 = (in >> 16) & 0xff;\n\t\t\t\tc1 = (in >> 8) & 0xff;\n\t\t\t\tc2 = in & 0xff;\n#else\n\t\t\t\tc2 = (in >> 16) & 0xff;\n\t\t\t\tc1 = (in >> 8) & 0xff;\n\t\t\t\tc0 = in & 0xff;\n#endif\n\n\t\t\t\tint outIndex = (offset+i) * channelCount + c;\n\t\t\t\tout[3*outIndex] = c0;\n\t\t\t\tout[3*outIndex+1] = c1;\n\t\t\t\tout[3*outIndex+2] = c2;\n\t\t\t}\n\t\t}\n\t}\n\n\tm_bufferedOffset += frameCount;\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<uint8_t *>",
          "args": [
            "m_outChunk->buffer"
          ],
          "line": 211
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int16_t *>",
          "args": [
            "m_outChunk->buffer"
          ],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  void FLACDecoder::convertAndInterleave(int offset, int frameCount)\n  {\n  \tint channelCount = m_outChunk->f.channelCount;\n  \n  \tif (m_track->f.sampleWidth == 16)\n  \t{\n  \t\tint16_t *out = static_cast<int16_t *>(m_outChunk->buffer);\n  \t\tfor (int i=0; i<frameCount; i++)\n  \t\t{\n  \t\t\tfor (int c=0; c<channelCount; c++)\n  \t\t\t{\n  \t\t\t\tint outIndex = (offset+i) * channelCount + c;\n  \t\t\t\tout[outIndex] = m_buffer[c][m_bufferedOffset + i];\n  \t\t\t}\n  \t\t}\n  \t}\n  \telse if (m_track->f.sampleWidth == 24)\n  \t{\n  \t\tuint8_t *out = static_cast<uint8_t *>(m_outChunk->buffer);\n  \t\tfor (int i=0; i<frameCount; i++)\n  \t\t{\n  \t\t\tfor (int c=0; c<channelCount; c++)\n  \t\t\t{\n  \t\t\t\tint32_t in = m_buffer[c][m_bufferedOffset + i];\n  \t\t\t\tuint8_t c0, c1, c2;\n  \n  #ifdef WORDS_BIGENDIAN\n  \t\t\t\tc0 = (in >> 16) & 0xff;\n  \t\t\t\tc1 = (in >> 8) & 0xff;\n  \t\t\t\tc2 = in & 0xff;\n  #else\n  \t\t\t\tc2 = (in >> 16) & 0xff;\n  \t\t\t\tc1 = (in >> 8) & 0xff;\n  \t\t\t\tc0 = in & 0xff;\n  #endif\n  \n  \t\t\t\tint outIndex = (offset+i) * channelCount + c;\n  \t\t\t\tout[3*outIndex] = c0;\n  \t\t\t\tout[3*outIndex+1] = c1;\n  \t\t\t\tout[3*outIndex+2] = c2;\n  \t\t\t}\n  \t\t}\n  \t}\n  \n  \tm_bufferedOffset += frameCount;\n  }\n}"
  },
  {
    "function_name": "describe",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "186-191",
    "snippet": "void FLACDecoder::describe()\n{\n\tm_outChunk->f.byteOrder = _AF_BYTEORDER_NATIVE;\n\tm_outChunk->f.compressionType = AF_COMPRESSION_NONE;\n\tm_outChunk->f.compressionParams = AU_NULL_PVLIST;\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  void FLACDecoder::describe()\n  {\n  \tm_outChunk->f.byteOrder = _AF_BYTEORDER_NATIVE;\n  \tm_outChunk->f.compressionType = AF_COMPRESSION_NONE;\n  \tm_outChunk->f.compressionParams = AU_NULL_PVLIST;\n  }\n}"
  },
  {
    "function_name": "~FLACDecoder",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "174-184",
    "snippet": "FLACDecoder::~FLACDecoder()\n{\n\tif (m_decoder)\n\t{\n\t\tFLAC__stream_decoder_delete(m_decoder);\n\t\tm_decoder = NULL;\n\t}\n\n\tfor (size_t i=0; i<m_buffer.size(); i++)\n\t\tdelete [] m_buffer[i];\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_buffer.size",
          "args": [],
          "line": 182
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "Buffer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Buffer.h",
          "lines": "39-39",
          "snippet": "size_t size() const { return m_size; }",
          "includes": [
            "#include <sys/types.h>",
            "#include \"Shared.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include \"Shared.h\"\n\nBuffer {\n  size_t size() const { return m_size; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "FLAC__stream_decoder_delete",
          "args": [
            "m_decoder"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  FLACDecoder::~FLACDecoder()\n  {\n  \tif (m_decoder)\n  \t{\n  \t\tFLAC__stream_decoder_delete(m_decoder);\n  \t\tm_decoder = NULL;\n  \t}\n  \n  \tfor (size_t i=0; i<m_buffer.size(); i++)\n  \t\tdelete [] m_buffer[i];\n  }\n}"
  },
  {
    "function_name": "FLACDecoder",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "146-172",
    "snippet": "FLACDecoder::FLACDecoder(Track *track, File *file, bool canSeek) :\n\tFileModule(Decompress, track, file, canSeek),\n\tm_decoder(NULL),\n\tm_bufferedFrames(0),\n\tm_bufferedOffset(0)\n{\n\tm_decoder = FLAC__stream_decoder_new();\n\n\tif (FLAC__stream_decoder_init_stream(m_decoder,\n\t\treadCallback,\n\t\tseekCallback,\n\t\ttellCallback,\n\t\tlengthCallback,\n\t\teofCallback,\n\t\twriteCallback,\n\t\tmetadataCallback,\n\t\terrorCallback,\n\t\tthis) != FLAC__STREAM_DECODER_INIT_STATUS_OK)\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not initialize FLAC decoder\");\n\t\treturn;\n\t}\n\n\tm_buffer.resize(m_track->f.channelCount);\n\tfor (int c=0; c<m_track->f.channelCount; c++)\n\t\tm_buffer[c] = new int32_t[FLAC__MAX_BLOCK_SIZE];\n}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_buffer.resize",
          "args": [
            "m_track->f.channelCount"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"could not initialize FLAC decoder\""
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_decoder_init_stream",
          "args": [
            "m_decoder",
            "readCallback",
            "seekCallback",
            "tellCallback",
            "lengthCallback",
            "eofCallback",
            "writeCallback",
            "metadataCallback",
            "errorCallback",
            "this"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FLAC__stream_decoder_new",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  FLACDecoder::FLACDecoder(Track *track, File *file, bool canSeek) :\n  \tFileModule(Decompress, track, file, canSeek),\n  \tm_decoder(NULL),\n  \tm_bufferedFrames(0),\n  \tm_bufferedOffset(0)\n  {\n  \tm_decoder = FLAC__stream_decoder_new();\n  \n  \tif (FLAC__stream_decoder_init_stream(m_decoder,\n  \t\treadCallback,\n  \t\tseekCallback,\n  \t\ttellCallback,\n  \t\tlengthCallback,\n  \t\teofCallback,\n  \t\twriteCallback,\n  \t\tmetadataCallback,\n  \t\terrorCallback,\n  \t\tthis) != FLAC__STREAM_DECODER_INIT_STATUS_OK)\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"could not initialize FLAC decoder\");\n  \t\treturn;\n  \t}\n  \n  \tm_buffer.resize(m_track->f.channelCount);\n  \tfor (int c=0; c<m_track->f.channelCount; c++)\n  \t\tm_buffer[c] = new int32_t[FLAC__MAX_BLOCK_SIZE];\n  }\n}"
  },
  {
    "function_name": "didDecodeFrame",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "129-137",
    "snippet": "void didDecodeFrame(const FLAC__Frame *frame, const FLAC__int32 * const buffer[])\n\t{\n\t\tm_bufferedFrames = frame->header.blocksize;\n\t\tm_bufferedOffset = 0;\n\t\tfor (unsigned c=0; c<frame->header.channels; c++)\n\t\t\tmemcpy(m_buffer[c], buffer[c], frame->header.blocksize * sizeof (int32_t));\n\n\t\tm_track->nextfframe += frame->header.blocksize;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m_buffer[c]",
            "buffer[c]",
            "frame->header.blocksize * sizeof (int32_t)"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  void didDecodeFrame(const FLAC__Frame *frame, const FLAC__int32 * const buffer[])\n  \t{\n  \t\tm_bufferedFrames = frame->header.blocksize;\n  \t\tm_bufferedOffset = 0;\n  \t\tfor (unsigned c=0; c<frame->header.channels; c++)\n  \t\t\tmemcpy(m_buffer[c], buffer[c], frame->header.blocksize * sizeof (int32_t));\n  \n  \t\tm_track->nextfframe += frame->header.blocksize;\n  \t}\n}"
  },
  {
    "function_name": "errorCallback",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "124-127",
    "snippet": "static void errorCallback(const FLAC__StreamDecoder *, FLAC__StreamDecoderErrorStatus status, void *clientData)\n\t{\n\t\t_af_error(AF_BAD_CODEC_CONFIG, \"FLAC decoding error %d\", status);\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_CODEC_CONFIG",
            "\"FLAC decoding error %d\"",
            "status"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  static void errorCallback(const FLAC__StreamDecoder *, FLAC__StreamDecoderErrorStatus status, void *clientData)\n  \t{\n  \t\t_af_error(AF_BAD_CODEC_CONFIG, \"FLAC decoding error %d\", status);\n  \t}\n}"
  },
  {
    "function_name": "metadataCallback",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "120-122",
    "snippet": "static void metadataCallback(const FLAC__StreamDecoder *, const FLAC__StreamMetadata *metadata, void *clientData)\n\t{\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  static void metadataCallback(const FLAC__StreamDecoder *, const FLAC__StreamMetadata *metadata, void *clientData)\n  \t{\n  \t}\n}"
  },
  {
    "function_name": "writeCallback",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "113-118",
    "snippet": "static FLAC__StreamDecoderWriteStatus writeCallback(const FLAC__StreamDecoder *, const FLAC__Frame *frame, const FLAC__int32 * const buffer[], void *clientData)\n\t{\n\t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n\t\tflac->didDecodeFrame(frame, buffer);\n\t\treturn FLAC__STREAM_DECODER_WRITE_STATUS_CONTINUE;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flac->didDecodeFrame",
          "args": [
            "frame",
            "buffer"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "didDecodeFrame",
          "container": "FLACDecoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
          "lines": "129-137",
          "snippet": "void didDecodeFrame(const FLAC__Frame *frame, const FLAC__int32 * const buffer[])\n\t{\n\t\tm_bufferedFrames = frame->header.blocksize;\n\t\tm_bufferedOffset = 0;\n\t\tfor (unsigned c=0; c<frame->header.channels; c++)\n\t\t\tmemcpy(m_buffer[c], buffer[c], frame->header.blocksize * sizeof (int32_t));\n\n\t\tm_track->nextfframe += frame->header.blocksize;\n\t}",
          "includes": [
            "#include <vector>",
            "#include <algorithm>",
            "#include <string.h>",
            "#include <assert.h>",
            "#include <FLAC/stream_encoder.h>",
            "#include <FLAC/stream_decoder.h>",
            "#include \"byteorder.h\"",
            "#include \"Track.h\"",
            "#include \"Features.h\"",
            "#include \"FileModule.h\"",
            "#include \"Compiler.h\"",
            "#include \"FLAC.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  void didDecodeFrame(const FLAC__Frame *frame, const FLAC__int32 * const buffer[])\n  \t{\n  \t\tm_bufferedFrames = frame->header.blocksize;\n  \t\tm_bufferedOffset = 0;\n  \t\tfor (unsigned c=0; c<frame->header.channels; c++)\n  \t\t\tmemcpy(m_buffer[c], buffer[c], frame->header.blocksize * sizeof (int32_t));\n  \n  \t\tm_track->nextfframe += frame->header.blocksize;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACDecoder *>",
          "args": [
            "clientData"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  static FLAC__StreamDecoderWriteStatus writeCallback(const FLAC__StreamDecoder *, const FLAC__Frame *frame, const FLAC__int32 * const buffer[], void *clientData)\n  \t{\n  \t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n  \t\tflac->didDecodeFrame(frame, buffer);\n  \t\treturn FLAC__STREAM_DECODER_WRITE_STATUS_CONTINUE;\n  \t}\n}"
  },
  {
    "function_name": "eofCallback",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "107-111",
    "snippet": "static FLAC__bool eofCallback(const FLAC__StreamDecoder *, void *clientData)\n\t{\n\t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n\t\treturn flac->tell() == flac->length();\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flac->length",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "71-74",
          "snippet": "off_t FileModule::length()\n{\n\treturn m_fh->length();\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::length()\n  {\n  \treturn m_fh->length();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "flac->tell",
          "args": [],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "tell",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "66-69",
          "snippet": "off_t FileModule::tell()\n{\n\treturn m_fh->tell();\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::tell()\n  {\n  \treturn m_fh->tell();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACDecoder *>",
          "args": [
            "clientData"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  static FLAC__bool eofCallback(const FLAC__StreamDecoder *, void *clientData)\n  \t{\n  \t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n  \t\treturn flac->tell() == flac->length();\n  \t}\n}"
  },
  {
    "function_name": "lengthCallback",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "97-105",
    "snippet": "static FLAC__StreamDecoderLengthStatus lengthCallback(const FLAC__StreamDecoder *, FLAC__uint64 *length, void *clientData)\n\t{\n\t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n\t\toff_t result = flac->length();\n\t\tif (result < 0)\n\t\t\treturn FLAC__STREAM_DECODER_LENGTH_STATUS_ERROR;\n\t\t*length = result;\n\t\treturn FLAC__STREAM_DECODER_LENGTH_STATUS_OK;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flac->length",
          "args": [],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "71-74",
          "snippet": "off_t FileModule::length()\n{\n\treturn m_fh->length();\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::length()\n  {\n  \treturn m_fh->length();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACDecoder *>",
          "args": [
            "clientData"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  static FLAC__StreamDecoderLengthStatus lengthCallback(const FLAC__StreamDecoder *, FLAC__uint64 *length, void *clientData)\n  \t{\n  \t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n  \t\toff_t result = flac->length();\n  \t\tif (result < 0)\n  \t\t\treturn FLAC__STREAM_DECODER_LENGTH_STATUS_ERROR;\n  \t\t*length = result;\n  \t\treturn FLAC__STREAM_DECODER_LENGTH_STATUS_OK;\n  \t}\n}"
  },
  {
    "function_name": "tellCallback",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "87-95",
    "snippet": "static FLAC__StreamDecoderTellStatus tellCallback(const FLAC__StreamDecoder *, FLAC__uint64 *absoluteByteOffset, void *clientData)\n\t{\n\t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n\t\toff_t result = flac->tell();\n\t\tif (result < 0)\n\t\t\treturn FLAC__STREAM_DECODER_TELL_STATUS_ERROR;\n\t\t*absoluteByteOffset = static_cast<FLAC__uint64>(result);\n\t\treturn FLAC__STREAM_DECODER_TELL_STATUS_OK;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<FLAC__uint64>",
          "args": [
            "result"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "flac->tell",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "tell",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "66-69",
          "snippet": "off_t FileModule::tell()\n{\n\treturn m_fh->tell();\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::tell()\n  {\n  \treturn m_fh->tell();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACDecoder *>",
          "args": [
            "clientData"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  static FLAC__StreamDecoderTellStatus tellCallback(const FLAC__StreamDecoder *, FLAC__uint64 *absoluteByteOffset, void *clientData)\n  \t{\n  \t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n  \t\toff_t result = flac->tell();\n  \t\tif (result < 0)\n  \t\t\treturn FLAC__STREAM_DECODER_TELL_STATUS_ERROR;\n  \t\t*absoluteByteOffset = static_cast<FLAC__uint64>(result);\n  \t\treturn FLAC__STREAM_DECODER_TELL_STATUS_OK;\n  \t}\n}"
  },
  {
    "function_name": "seekCallback",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "79-85",
    "snippet": "static FLAC__StreamDecoderSeekStatus seekCallback(const FLAC__StreamDecoder *, FLAC__uint64 absoluteByteOffset, void *clientData)\n\t{\n\t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n\t\tif (flac->seek(absoluteByteOffset) < 0)\n\t\t\treturn FLAC__STREAM_DECODER_SEEK_STATUS_ERROR;\n\t\treturn FLAC__STREAM_DECODER_SEEK_STATUS_OK;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flac->seek",
          "args": [
            "absoluteByteOffset"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "seek",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "61-64",
          "snippet": "off_t FileModule::seek(off_t offset)\n{\n\treturn m_fh->seek(offset, File::SeekFromBeginning);\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::seek(off_t offset)\n  {\n  \treturn m_fh->seek(offset, File::SeekFromBeginning);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACDecoder *>",
          "args": [
            "clientData"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  static FLAC__StreamDecoderSeekStatus seekCallback(const FLAC__StreamDecoder *, FLAC__uint64 absoluteByteOffset, void *clientData)\n  \t{\n  \t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n  \t\tif (flac->seek(absoluteByteOffset) < 0)\n  \t\t\treturn FLAC__STREAM_DECODER_SEEK_STATUS_ERROR;\n  \t\treturn FLAC__STREAM_DECODER_SEEK_STATUS_OK;\n  \t}\n}"
  },
  {
    "function_name": "readCallback",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "65-77",
    "snippet": "static FLAC__StreamDecoderReadStatus readCallback(const FLAC__StreamDecoder *, FLAC__byte buffer[], size_t *bytes, void *clientData)\n\t{\n\t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n\t\tssize_t result = flac->read(buffer, *bytes);\n\t\tif (result > 0)\n\t\t{\n\t\t\t*bytes = result;\n\t\t\treturn FLAC__STREAM_DECODER_READ_STATUS_CONTINUE;\n\t\t}\n\n\t\t*bytes = 0;\n\t\treturn FLAC__STREAM_DECODER_READ_STATUS_ABORT;\n\t}",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "flac->read",
          "args": [
            "buffer",
            "*bytes"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "40-48",
          "snippet": "ssize_t FileModule::read(void *data, size_t nbytes)\n{\n\tssize_t bytesRead = m_fh->read(data, nbytes);\n\tif (bytesRead > 0)\n\t{\n\t\tm_track->fpos_next_frame += bytesRead;\n\t}\n\treturn bytesRead;\n}",
          "includes": [
            "#include <string.h>",
            "#include <errno.h>",
            "#include \"Track.h\"",
            "#include \"File.h\"",
            "#include \"FileModule.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  ssize_t FileModule::read(void *data, size_t nbytes)\n  {\n  \tssize_t bytesRead = m_fh->read(data, nbytes);\n  \tif (bytesRead > 0)\n  \t{\n  \t\tm_track->fpos_next_frame += bytesRead;\n  \t}\n  \treturn bytesRead;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<FLACDecoder *>",
          "args": [
            "clientData"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  static FLAC__StreamDecoderReadStatus readCallback(const FLAC__StreamDecoder *, FLAC__byte buffer[], size_t *bytes, void *clientData)\n  \t{\n  \t\tFLACDecoder *flac = static_cast<FLACDecoder *>(clientData);\n  \t\tssize_t result = flac->read(buffer, *bytes);\n  \t\tif (result > 0)\n  \t\t{\n  \t\t\t*bytes = result;\n  \t\t\treturn FLAC__STREAM_DECODER_READ_STATUS_CONTINUE;\n  \t\t}\n  \n  \t\t*bytes = 0;\n  \t\treturn FLAC__STREAM_DECODER_READ_STATUS_ABORT;\n  \t}\n}"
  },
  {
    "function_name": "handlesSeeking",
    "container": "FLACDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FLAC.cpp",
    "lines": "54-54",
    "snippet": "virtual bool handlesSeeking() const OVERRIDE { return true; }",
    "includes": [
      "#include <vector>",
      "#include <algorithm>",
      "#include <string.h>",
      "#include <assert.h>",
      "#include <FLAC/stream_encoder.h>",
      "#include <FLAC/stream_decoder.h>",
      "#include \"byteorder.h\"",
      "#include \"Track.h\"",
      "#include \"Features.h\"",
      "#include \"FileModule.h\"",
      "#include \"Compiler.h\"",
      "#include \"FLAC.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include <algorithm>\n#include <string.h>\n#include <assert.h>\n#include <FLAC/stream_encoder.h>\n#include <FLAC/stream_decoder.h>\n#include \"byteorder.h\"\n#include \"Track.h\"\n#include \"Features.h\"\n#include \"FileModule.h\"\n#include \"Compiler.h\"\n#include \"FLAC.h\"\n#include \"config.h\"\n\nFLACDecoder {\n  virtual bool handlesSeeking() const OVERRIDE { return true; }\n}"
  }
]