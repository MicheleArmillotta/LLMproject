[
  {
    "function_name": "bufferSize",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "119-125",
    "snippet": "int FileModule::bufferSize() const\n{\n\tif (mode() == Compress)\n\t\treturn outChunk()->frameCount * inChunk()->f.bytesPerFrame(true);\n\telse\n\t\treturn inChunk()->frameCount * outChunk()->f.bytesPerFrame(true);\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "outChunk",
          "args": [
            "true"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outChunk",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inChunk",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inChunk",
          "args": [
            "true"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "inChunk",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "outChunk",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mode",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "mode",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.h",
          "lines": "37-37",
          "snippet": "Mode mode() const { return m_mode; }",
          "includes": [
            "#include \"Module.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"Module.h\"\n\nFileModule {\n  Mode mode() const { return m_mode; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  int FileModule::bufferSize() const\n  {\n  \tif (mode() == Compress)\n  \t\treturn outChunk()->frameCount * inChunk()->f.bytesPerFrame(true);\n  \telse\n  \t\treturn inChunk()->frameCount * outChunk()->f.bytesPerFrame(true);\n  }\n}"
  },
  {
    "function_name": "reportWriteError",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "90-117",
    "snippet": "void FileModule::reportWriteError(AFframecount framesWritten,\n\tAFframecount framesToWrite)\n{\n\t// Report error if we haven't already.\n\tif (!m_track->filemodhappy)\n\t\treturn;\n\n\tif (framesWritten < 0)\n\t{\n\t\t// Signal I/O error.\n\t\t_af_error(AF_BAD_WRITE,\n\t\t\t\"unable to write data (%s) -- wrote %jd out of %jd frames\",\n\t\t\tstrerror(errno),\n\t\t\tstatic_cast<intmax_t>(m_track->nextfframe),\n\t\t\tstatic_cast<intmax_t>(m_track->nextfframe + framesToWrite));\n\t}\n\telse\n\t{\n\t\t// Signal disk full error.\n\t\t_af_error(AF_BAD_WRITE,\n\t\t\t\"unable to write data (disk full) -- \"\n\t\t\t\"wrote %jd out of %jd frames\",\n\t\t\tstatic_cast<intmax_t>(m_track->nextfframe + framesWritten),\n\t\t\tstatic_cast<intmax_t>(m_track->nextfframe + framesToWrite));\n\t}\n\n\tm_track->filemodhappy = false;\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_WRITE",
            "\"unable to write data (disk full) -- \"\n\t\t\t\"wrote %jd out of %jd frames\"",
            "static_cast<intmax_t>(m_track->nextfframe + framesWritten)",
            "static_cast<intmax_t>(m_track->nextfframe + framesToWrite)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "m_track->nextfframe + framesToWrite"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "m_track->nextfframe + framesWritten"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_WRITE",
            "\"unable to write data (%s) -- wrote %jd out of %jd frames\"",
            "strerror(errno)",
            "static_cast<intmax_t>(m_track->nextfframe)",
            "static_cast<intmax_t>(m_track->nextfframe + framesToWrite)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "m_track->nextfframe + framesToWrite"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "m_track->nextfframe"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  void FileModule::reportWriteError(AFframecount framesWritten,\n  \tAFframecount framesToWrite)\n  {\n  \t// Report error if we haven't already.\n  \tif (!m_track->filemodhappy)\n  \t\treturn;\n  \n  \tif (framesWritten < 0)\n  \t{\n  \t\t// Signal I/O error.\n  \t\t_af_error(AF_BAD_WRITE,\n  \t\t\t\"unable to write data (%s) -- wrote %jd out of %jd frames\",\n  \t\t\tstrerror(errno),\n  \t\t\tstatic_cast<intmax_t>(m_track->nextfframe),\n  \t\t\tstatic_cast<intmax_t>(m_track->nextfframe + framesToWrite));\n  \t}\n  \telse\n  \t{\n  \t\t// Signal disk full error.\n  \t\t_af_error(AF_BAD_WRITE,\n  \t\t\t\"unable to write data (disk full) -- \"\n  \t\t\t\"wrote %jd out of %jd frames\",\n  \t\t\tstatic_cast<intmax_t>(m_track->nextfframe + framesWritten),\n  \t\t\tstatic_cast<intmax_t>(m_track->nextfframe + framesToWrite));\n  \t}\n  \n  \tm_track->filemodhappy = false;\n  }\n}"
  },
  {
    "function_name": "reportReadError",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "76-88",
    "snippet": "void FileModule::reportReadError(AFframecount framesRead,\n\tAFframecount framesToRead)\n{\n\t// Report error if we haven't already.\n\tif (!m_track->filemodhappy)\n\t\treturn;\n\n\t_af_error(AF_BAD_READ,\n\t\t\"file missing data -- read %jd frames, should be %jd\",\n\t\tstatic_cast<intmax_t>(m_track->nextfframe),\n\t\tstatic_cast<intmax_t>(m_track->totalfframes));\n\tm_track->filemodhappy = false;\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_READ",
            "\"file missing data -- read %jd frames, should be %jd\"",
            "static_cast<intmax_t>(m_track->nextfframe)",
            "static_cast<intmax_t>(m_track->totalfframes)"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "m_track->totalfframes"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "m_track->nextfframe"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  void FileModule::reportReadError(AFframecount framesRead,\n  \tAFframecount framesToRead)\n  {\n  \t// Report error if we haven't already.\n  \tif (!m_track->filemodhappy)\n  \t\treturn;\n  \n  \t_af_error(AF_BAD_READ,\n  \t\t\"file missing data -- read %jd frames, should be %jd\",\n  \t\tstatic_cast<intmax_t>(m_track->nextfframe),\n  \t\tstatic_cast<intmax_t>(m_track->totalfframes));\n  \tm_track->filemodhappy = false;\n  }\n}"
  },
  {
    "function_name": "length",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "71-74",
    "snippet": "off_t FileModule::length()\n{\n\treturn m_fh->length();\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_fh->length",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "length",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "71-74",
          "snippet": "off_t FileModule::length()\n{\n\treturn m_fh->length();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::length()\n  {\n  \treturn m_fh->length();\n  }\n}"
  },
  {
    "function_name": "tell",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "66-69",
    "snippet": "off_t FileModule::tell()\n{\n\treturn m_fh->tell();\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_fh->tell",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "tell",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "66-69",
          "snippet": "off_t FileModule::tell()\n{\n\treturn m_fh->tell();\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::tell()\n  {\n  \treturn m_fh->tell();\n  }\n}"
  },
  {
    "function_name": "seek",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "61-64",
    "snippet": "off_t FileModule::seek(off_t offset)\n{\n\treturn m_fh->seek(offset, File::SeekFromBeginning);\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_fh->seek",
          "args": [
            "offset",
            "File::SeekFromBeginning"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "seek",
          "container": "FileVF",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/File.cpp",
          "lines": "187-192",
          "snippet": "off_t FileVF::seek(off_t offset, SeekOrigin origin)\n{\n\tif (origin == SeekFromEnd)\n\t\toffset += length();\n\treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n}",
          "includes": [
            "#include <stdio.h>",
            "#include <unistd.h>",
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <fcntl.h>",
            "#include <assert.h>",
            "#include \"af_vfs.h\"",
            "#include \"Compiler.h\"",
            "#include \"File.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdio.h>\n#include <unistd.h>\n#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <fcntl.h>\n#include <assert.h>\n#include \"af_vfs.h\"\n#include \"Compiler.h\"\n#include \"File.h\"\n#include \"config.h\"\n\nFileVF {\n  off_t FileVF::seek(off_t offset, SeekOrigin origin)\n  {\n  \tif (origin == SeekFromEnd)\n  \t\toffset += length();\n  \treturn m_vf->seek(m_vf, offset, origin == SeekFromCurrent);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  off_t FileModule::seek(off_t offset)\n  {\n  \treturn m_fh->seek(offset, File::SeekFromBeginning);\n  }\n}"
  },
  {
    "function_name": "write",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "50-59",
    "snippet": "ssize_t FileModule::write(const void *data, size_t nbytes)\n{\n\tssize_t bytesWritten = m_fh->write(data, nbytes);\n\tif (bytesWritten > 0)\n\t{\n\t\tm_track->fpos_next_frame += bytesWritten;\n\t\tm_track->data_size += bytesWritten;\n\t}\n\treturn bytesWritten;\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_fh->write",
          "args": [
            "data",
            "nbytes"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "write",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "50-59",
          "snippet": "ssize_t FileModule::write(const void *data, size_t nbytes)\n{\n\tssize_t bytesWritten = m_fh->write(data, nbytes);\n\tif (bytesWritten > 0)\n\t{\n\t\tm_track->fpos_next_frame += bytesWritten;\n\t\tm_track->data_size += bytesWritten;\n\t}\n\treturn bytesWritten;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  ssize_t FileModule::write(const void *data, size_t nbytes)\n  {\n  \tssize_t bytesWritten = m_fh->write(data, nbytes);\n  \tif (bytesWritten > 0)\n  \t{\n  \t\tm_track->fpos_next_frame += bytesWritten;\n  \t\tm_track->data_size += bytesWritten;\n  \t}\n  \treturn bytesWritten;\n  }\n}"
  },
  {
    "function_name": "read",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "40-48",
    "snippet": "ssize_t FileModule::read(void *data, size_t nbytes)\n{\n\tssize_t bytesRead = m_fh->read(data, nbytes);\n\tif (bytesRead > 0)\n\t{\n\t\tm_track->fpos_next_frame += bytesRead;\n\t}\n\treturn bytesRead;\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_fh->read",
          "args": [
            "data",
            "nbytes"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "read",
          "container": "FileModule",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
          "lines": "40-48",
          "snippet": "ssize_t FileModule::read(void *data, size_t nbytes)\n{\n\tssize_t bytesRead = m_fh->read(data, nbytes);\n\tif (bytesRead > 0)\n\t{\n\t\tm_track->fpos_next_frame += bytesRead;\n\t}\n\treturn bytesRead;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  ssize_t FileModule::read(void *data, size_t nbytes)\n  {\n  \tssize_t bytesRead = m_fh->read(data, nbytes);\n  \tif (bytesRead > 0)\n  \t{\n  \t\tm_track->fpos_next_frame += bytesRead;\n  \t}\n  \treturn bytesRead;\n  }\n}"
  },
  {
    "function_name": "FileModule",
    "container": "FileModule",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/modules/FileModule.cpp",
    "lines": "30-38",
    "snippet": "FileModule::FileModule(Mode mode, Track *track, File *fh, bool canSeek) :\n\tm_mode(mode),\n\tm_track(track),\n\tm_fh(fh),\n\tm_canSeek(canSeek)\n{\n\ttrack->fpos_next_frame = track->fpos_first_frame;\n\ttrack->frames2ignore = 0;\n}",
    "includes": [
      "#include <string.h>",
      "#include <errno.h>",
      "#include \"Track.h\"",
      "#include \"File.h\"",
      "#include \"FileModule.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h>\n#include <errno.h>\n#include \"Track.h\"\n#include \"File.h\"\n#include \"FileModule.h\"\n#include \"config.h\"\n\nFileModule {\n  FileModule::FileModule(Mode mode, Track *track, File *fh, bool canSeek) :\n  \tm_mode(mode),\n  \tm_track(track),\n  \tm_fh(fh),\n  \tm_canSeek(canSeek)\n  {\n  \ttrack->fpos_next_frame = track->fpos_first_frame;\n  \ttrack->frames2ignore = 0;\n  }\n}"
  }
]