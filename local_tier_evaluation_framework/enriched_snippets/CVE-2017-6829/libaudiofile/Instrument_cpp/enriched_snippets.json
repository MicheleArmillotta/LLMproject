[
  {
    "function_name": "_af_instparam_index_from_id",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "275-291",
    "snippet": "int _af_instparam_index_from_id (int filefmt, int id)\n{\n\tint i;\n\n\tfor (i = 0; i < _af_units[filefmt].instrumentParameterCount; i++)\n\t\tif (_af_units[filefmt].instrumentParameters[i].id == id)\n\t\t\tbreak;\n\n\tif (i == _af_units[filefmt].instrumentParameterCount)\n\t{\n\t\t_af_error(AF_BAD_INSTPID, \"invalid instrument parameter id %d\",\n\t\t\tid);\n\t\treturn -1;\n\t}\n\n\treturn i;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_INSTPID",
            "\"invalid instrument parameter id %d\"",
            "id"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nint _af_instparam_index_from_id (int filefmt, int id)\n{\n\tint i;\n\n\tfor (i = 0; i < _af_units[filefmt].instrumentParameterCount; i++)\n\t\tif (_af_units[filefmt].instrumentParameters[i].id == id)\n\t\t\tbreak;\n\n\tif (i == _af_units[filefmt].instrumentParameterCount)\n\t{\n\t\t_af_error(AF_BAD_INSTPID, \"invalid instrument parameter id %d\",\n\t\t\tid);\n\t\treturn -1;\n\t}\n\n\treturn i;\n}"
  },
  {
    "function_name": "afGetInstParamLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "251-265",
    "snippet": "long afGetInstParamLong (AFfilehandle file, int inst, int param)\n{\n\tlong val;\n\tAUpvlist pvlist = AUpvnew(1);\n\n\tAUpvsetparam(pvlist, 0, param);\n\tAUpvsetvaltype(pvlist, 0, AU_PVTYPE_LONG);\n\n\t_af_instparam_get(file, inst, pvlist, 1, true);\n\n\tAUpvgetval(pvlist, 0, &val);\n\tAUpvfree(pvlist);\n\n\treturn(val);\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvfree",
          "args": [
            "pvlist"
          ],
          "line": 262
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "pvlist",
            "0",
            "&val"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_instparam_get",
          "args": [
            "file",
            "inst",
            "pvlist",
            "1",
            "true"
          ],
          "line": 259
        },
        "resolved": true,
        "details": {
          "function_name": "_af_instparam_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "186-240",
          "snippet": "void _af_instparam_get (AFfilehandle file, int instid, AUpvlist pvlist, int npv,\n\tbool forceLong)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\t\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint param;\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tint type = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\t/*\n\t\t\tforceLong is true when this routine called by\n\t\t\tafGetInstParamLong().\n\t\t*/\n\t\tif (forceLong && type != AU_PVTYPE_LONG)\n\t\t{\n\t\t\t_af_error(AF_BAD_INSTPTYPE, \"type of instrument parameter %d is not AU_PVTYPE_LONG\", param);\n\t\t\tcontinue;\n\t\t}\n\n\t\tAUpvsetvaltype(pvlist, i, type);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t_af_error(AF_BAD_INSTPTYPE, \"invalid instrument parameter type %d\", type);\n\t\t\t\treturn;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid _af_instparam_get (AFfilehandle file, int instid, AUpvlist pvlist, int npv,\n\tbool forceLong)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\t\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint param;\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tint type = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\t/*\n\t\t\tforceLong is true when this routine called by\n\t\t\tafGetInstParamLong().\n\t\t*/\n\t\tif (forceLong && type != AU_PVTYPE_LONG)\n\t\t{\n\t\t\t_af_error(AF_BAD_INSTPTYPE, \"type of instrument parameter %d is not AU_PVTYPE_LONG\", param);\n\t\t\tcontinue;\n\t\t}\n\n\t\tAUpvsetvaltype(pvlist, i, type);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t_af_error(AF_BAD_INSTPTYPE, \"invalid instrument parameter type %d\", type);\n\t\t\t\treturn;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AUpvsetvaltype",
          "args": [
            "pvlist",
            "0",
            "AU_PVTYPE_LONG"
          ],
          "line": 257
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetparam",
          "args": [
            "pvlist",
            "0",
            "param"
          ],
          "line": 256
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvnew",
          "args": [
            "1"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nlong afGetInstParamLong (AFfilehandle file, int inst, int param)\n{\n\tlong val;\n\tAUpvlist pvlist = AUpvnew(1);\n\n\tAUpvsetparam(pvlist, 0, param);\n\tAUpvsetvaltype(pvlist, 0, AU_PVTYPE_LONG);\n\n\t_af_instparam_get(file, inst, pvlist, 1, true);\n\n\tAUpvgetval(pvlist, 0, &val);\n\tAUpvfree(pvlist);\n\n\treturn(val);\n}"
  },
  {
    "function_name": "afGetInstParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "246-249",
    "snippet": "void afGetInstParams (AFfilehandle file, int inst, AUpvlist pvlist, int npv)\n{\n\t_af_instparam_get(file, inst, pvlist, npv, false);\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_instparam_get",
          "args": [
            "file",
            "inst",
            "pvlist",
            "npv",
            "false"
          ],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "_af_instparam_get",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "186-240",
          "snippet": "void _af_instparam_get (AFfilehandle file, int instid, AUpvlist pvlist, int npv,\n\tbool forceLong)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\t\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint param;\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tint type = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\t/*\n\t\t\tforceLong is true when this routine called by\n\t\t\tafGetInstParamLong().\n\t\t*/\n\t\tif (forceLong && type != AU_PVTYPE_LONG)\n\t\t{\n\t\t\t_af_error(AF_BAD_INSTPTYPE, \"type of instrument parameter %d is not AU_PVTYPE_LONG\", param);\n\t\t\tcontinue;\n\t\t}\n\n\t\tAUpvsetvaltype(pvlist, i, type);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t_af_error(AF_BAD_INSTPTYPE, \"invalid instrument parameter type %d\", type);\n\t\t\t\treturn;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid _af_instparam_get (AFfilehandle file, int instid, AUpvlist pvlist, int npv,\n\tbool forceLong)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\t\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint param;\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tint type = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\t/*\n\t\t\tforceLong is true when this routine called by\n\t\t\tafGetInstParamLong().\n\t\t*/\n\t\tif (forceLong && type != AU_PVTYPE_LONG)\n\t\t{\n\t\t\t_af_error(AF_BAD_INSTPTYPE, \"type of instrument parameter %d is not AU_PVTYPE_LONG\", param);\n\t\t\tcontinue;\n\t\t}\n\n\t\tAUpvsetvaltype(pvlist, i, type);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t_af_error(AF_BAD_INSTPTYPE, \"invalid instrument parameter type %d\", type);\n\t\t\t\treturn;\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid afGetInstParams (AFfilehandle file, int inst, AUpvlist pvlist, int npv)\n{\n\t_af_instparam_get(file, inst, pvlist, npv, false);\n}"
  },
  {
    "function_name": "_af_instparam_get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "186-240",
    "snippet": "void _af_instparam_get (AFfilehandle file, int instid, AUpvlist pvlist, int npv,\n\tbool forceLong)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\t\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint param;\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tint type = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\t/*\n\t\t\tforceLong is true when this routine called by\n\t\t\tafGetInstParamLong().\n\t\t*/\n\t\tif (forceLong && type != AU_PVTYPE_LONG)\n\t\t{\n\t\t\t_af_error(AF_BAD_INSTPTYPE, \"type of instrument parameter %d is not AU_PVTYPE_LONG\", param);\n\t\t\tcontinue;\n\t\t}\n\n\t\tAUpvsetvaltype(pvlist, i, type);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t_af_error(AF_BAD_INSTPTYPE, \"invalid instrument parameter type %d\", type);\n\t\t\t\treturn;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_INSTPTYPE",
            "\"invalid instrument parameter type %d\"",
            "type"
          ],
          "line": 236
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetval",
          "args": [
            "pvlist",
            "i",
            "&instrument->values[j].v"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetval",
          "args": [
            "pvlist",
            "i",
            "&instrument->values[j].d"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetval",
          "args": [
            "pvlist",
            "i",
            "&instrument->values[j].l"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetvaltype",
          "args": [
            "pvlist",
            "i",
            "type"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_INSTPTYPE",
            "\"type of instrument parameter %d is not AU_PVTYPE_LONG\"",
            "param"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_instparam_index_from_id",
          "args": [
            "file->m_fileFormat",
            "param"
          ],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "_af_instparam_index_from_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "275-291",
          "snippet": "int _af_instparam_index_from_id (int filefmt, int id)\n{\n\tint i;\n\n\tfor (i = 0; i < _af_units[filefmt].instrumentParameterCount; i++)\n\t\tif (_af_units[filefmt].instrumentParameters[i].id == id)\n\t\t\tbreak;\n\n\tif (i == _af_units[filefmt].instrumentParameterCount)\n\t{\n\t\t_af_error(AF_BAD_INSTPID, \"invalid instrument parameter id %d\",\n\t\t\tid);\n\t\treturn -1;\n\t}\n\n\treturn i;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nint _af_instparam_index_from_id (int filefmt, int id)\n{\n\tint i;\n\n\tfor (i = 0; i < _af_units[filefmt].instrumentParameterCount; i++)\n\t\tif (_af_units[filefmt].instrumentParameters[i].id == id)\n\t\t\tbreak;\n\n\tif (i == _af_units[filefmt].instrumentParameterCount)\n\t{\n\t\t_af_error(AF_BAD_INSTPID, \"invalid instrument parameter id %d\",\n\t\t\tid);\n\t\treturn -1;\n\t}\n\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AUpvgetparam",
          "args": [
            "pvlist",
            "i",
            "&param"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetmaxitems",
          "args": [
            "pvlist"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetmaxitems",
          "args": [
            "pvlist"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getInstrument",
          "args": [
            "instid"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid _af_instparam_get (AFfilehandle file, int instid, AUpvlist pvlist, int npv,\n\tbool forceLong)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\t\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint param;\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tint type = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\t/*\n\t\t\tforceLong is true when this routine called by\n\t\t\tafGetInstParamLong().\n\t\t*/\n\t\tif (forceLong && type != AU_PVTYPE_LONG)\n\t\t{\n\t\t\t_af_error(AF_BAD_INSTPTYPE, \"type of instrument parameter %d is not AU_PVTYPE_LONG\", param);\n\t\t\tcontinue;\n\t\t}\n\n\t\tAUpvsetvaltype(pvlist, i, type);\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvsetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t_af_error(AF_BAD_INSTPTYPE, \"invalid instrument parameter type %d\", type);\n\t\t\t\treturn;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "afSetInstParamLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "169-180",
    "snippet": "void afSetInstParamLong (AFfilehandle file, int instid, int param, long value)\n{\n\tAUpvlist pvlist = AUpvnew(1);\n\n\tAUpvsetparam(pvlist, 0, param);\n\tAUpvsetvaltype(pvlist, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(pvlist, 0, &value);\n\n\t_af_instparam_set(file, instid, pvlist, 1);\n\n\tAUpvfree(pvlist);\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvfree",
          "args": [
            "pvlist"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_instparam_set",
          "args": [
            "file",
            "instid",
            "pvlist",
            "1"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "_af_instparam_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "115-162",
          "snippet": "void _af_instparam_set (AFfilehandle file, int instid, AUpvlist pvlist, int npv)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tif (!file->checkCanWrite())\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint\tparam;\n\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tif (!file->isInstrumentParameterValid(pvlist, i))\n\t\t\t/* bad parameter value; ignore */\n\t\t\tcontinue;\n\n\t\tint\ttype = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid _af_instparam_set (AFfilehandle file, int instid, AUpvlist pvlist, int npv)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tif (!file->checkCanWrite())\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint\tparam;\n\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tif (!file->isInstrumentParameterValid(pvlist, i))\n\t\t\t/* bad parameter value; ignore */\n\t\t\tcontinue;\n\n\t\tint\ttype = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AUpvsetval",
          "args": [
            "pvlist",
            "0",
            "&value"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetvaltype",
          "args": [
            "pvlist",
            "0",
            "AU_PVTYPE_LONG"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetparam",
          "args": [
            "pvlist",
            "0",
            "param"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvnew",
          "args": [
            "1"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid afSetInstParamLong (AFfilehandle file, int instid, int param, long value)\n{\n\tAUpvlist pvlist = AUpvnew(1);\n\n\tAUpvsetparam(pvlist, 0, param);\n\tAUpvsetvaltype(pvlist, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(pvlist, 0, &value);\n\n\t_af_instparam_set(file, instid, pvlist, 1);\n\n\tAUpvfree(pvlist);\n}"
  },
  {
    "function_name": "afSetInstParams",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "164-167",
    "snippet": "void afSetInstParams (AFfilehandle file, int instid, AUpvlist pvlist, int npv)\n{\n\t_af_instparam_set(file, instid, pvlist, npv);\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_instparam_set",
          "args": [
            "file",
            "instid",
            "pvlist",
            "npv"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "_af_instparam_set",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "115-162",
          "snippet": "void _af_instparam_set (AFfilehandle file, int instid, AUpvlist pvlist, int npv)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tif (!file->checkCanWrite())\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint\tparam;\n\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tif (!file->isInstrumentParameterValid(pvlist, i))\n\t\t\t/* bad parameter value; ignore */\n\t\t\tcontinue;\n\n\t\tint\ttype = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\t}\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid _af_instparam_set (AFfilehandle file, int instid, AUpvlist pvlist, int npv)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tif (!file->checkCanWrite())\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint\tparam;\n\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tif (!file->isInstrumentParameterValid(pvlist, i))\n\t\t\t/* bad parameter value; ignore */\n\t\t\tcontinue;\n\n\t\tint\ttype = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid afSetInstParams (AFfilehandle file, int instid, AUpvlist pvlist, int npv)\n{\n\t_af_instparam_set(file, instid, pvlist, npv);\n}"
  },
  {
    "function_name": "_af_instparam_set",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "115-162",
    "snippet": "void _af_instparam_set (AFfilehandle file, int instid, AUpvlist pvlist, int npv)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tif (!file->checkCanWrite())\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint\tparam;\n\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tif (!file->isInstrumentParameterValid(pvlist, i))\n\t\t\t/* bad parameter value; ignore */\n\t\t\tcontinue;\n\n\t\tint\ttype = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "pvlist",
            "i",
            "&instrument->values[j].v"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "pvlist",
            "i",
            "&instrument->values[j].d"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "pvlist",
            "i",
            "&instrument->values[j].l"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->isInstrumentParameterValid",
          "args": [
            "pvlist",
            "i"
          ],
          "line": 141
        },
        "resolved": true,
        "details": {
          "function_name": "isInstrumentParameterValid",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.h",
          "lines": "71-71",
          "snippet": "virtual bool isInstrumentParameterValid(AUpvlist, int) { return false; }",
          "includes": [
            "#include <stdint.h>",
            "#include \"afinternal.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include \"afinternal.h\"\n\n_AFfilehandle {\n  virtual bool isInstrumentParameterValid(AUpvlist, int) { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_instparam_index_from_id",
          "args": [
            "file->m_fileFormat",
            "param"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "_af_instparam_index_from_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "275-291",
          "snippet": "int _af_instparam_index_from_id (int filefmt, int id)\n{\n\tint i;\n\n\tfor (i = 0; i < _af_units[filefmt].instrumentParameterCount; i++)\n\t\tif (_af_units[filefmt].instrumentParameters[i].id == id)\n\t\t\tbreak;\n\n\tif (i == _af_units[filefmt].instrumentParameterCount)\n\t{\n\t\t_af_error(AF_BAD_INSTPID, \"invalid instrument parameter id %d\",\n\t\t\tid);\n\t\treturn -1;\n\t}\n\n\treturn i;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nint _af_instparam_index_from_id (int filefmt, int id)\n{\n\tint i;\n\n\tfor (i = 0; i < _af_units[filefmt].instrumentParameterCount; i++)\n\t\tif (_af_units[filefmt].instrumentParameters[i].id == id)\n\t\t\tbreak;\n\n\tif (i == _af_units[filefmt].instrumentParameterCount)\n\t{\n\t\t_af_error(AF_BAD_INSTPID, \"invalid instrument parameter id %d\",\n\t\t\tid);\n\t\treturn -1;\n\t}\n\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AUpvgetparam",
          "args": [
            "pvlist",
            "i",
            "&param"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetmaxitems",
          "args": [
            "pvlist"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetmaxitems",
          "args": [
            "pvlist"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getInstrument",
          "args": [
            "instid"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->checkCanWrite",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "checkCanWrite",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "188-197",
          "snippet": "bool _AFfilehandle::checkCanWrite()\n{\n\tif (m_access != _AF_WRITE_ACCESS)\n\t{\n\t\t_af_error(AF_BAD_NOWRITEACC, \"file not opened for write access\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::checkCanWrite()\n  {\n  \tif (m_access != _AF_WRITE_ACCESS)\n  \t{\n  \t\t_af_error(AF_BAD_NOWRITEACC, \"file not opened for write access\");\n  \t\treturn false;\n  \t}\n  \n  \treturn true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid _af_instparam_set (AFfilehandle file, int instid, AUpvlist pvlist, int npv)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tif (!file->checkCanWrite())\n\t\treturn;\n\n\tInstrument *instrument = file->getInstrument(instid);\n\tif (!instrument)\n\t\treturn;\n\n\tif (AUpvgetmaxitems(pvlist) < npv)\n\tnpv = AUpvgetmaxitems(pvlist);\n\n\tfor (int i=0; i < npv; i++)\n\t{\n\t\tint\tparam;\n\n\t\tAUpvgetparam(pvlist, i, &param);\n\n\t\tint j;\n\t\tif ((j = _af_instparam_index_from_id(file->m_fileFormat, param)) == -1)\n\t\t\t/* no parameter with that id; ignore */\n\t\t\tcontinue;\n\n\t\tif (!file->isInstrumentParameterValid(pvlist, i))\n\t\t\t/* bad parameter value; ignore */\n\t\t\tcontinue;\n\n\t\tint\ttype = _af_units[file->m_fileFormat].instrumentParameters[j].type;\n\n\t\tswitch (type)\n\t\t{\n\t\t\tcase AU_PVTYPE_LONG:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].l);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_DOUBLE:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].d);\n\t\t\t\tbreak;\n\t\t\tcase AU_PVTYPE_PTR:\n\t\t\t\tAUpvgetval(pvlist, i, &instrument->values[j].v);\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\treturn;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "afGetInstIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "99-109",
    "snippet": "int afGetInstIDs (AFfilehandle file, int *instids)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (instids)\n\t\tfor (int i=0; i < file->m_instrumentCount; i++)\n\t\t\tinstids[i] = file->m_instruments[i].id;\n\n\treturn file->m_instrumentCount;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nint afGetInstIDs (AFfilehandle file, int *instids)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tif (instids)\n\t\tfor (int i=0; i < file->m_instrumentCount; i++)\n\t\t\tinstids[i] = file->m_instruments[i].id;\n\n\treturn file->m_instrumentCount;\n}"
  },
  {
    "function_name": "afInitInstIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "80-97",
    "snippet": "void afInitInstIDs (AFfilesetup setup, const int *instids, int ninsts)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tif (!_af_unique_ids(instids, ninsts, \"instrument\", AF_BAD_INSTID))\n\t\treturn;\n\n\t_af_setup_free_instruments(setup);\n\n\tsetup->instrumentCount = ninsts;\n\tsetup->instrumentSet = true;\n\n\tsetup->instruments = _af_instsetup_new(setup->instrumentCount);\n\n\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\tsetup->instruments[i].id = instids[i];\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_instsetup_new",
          "args": [
            "setup->instrumentCount"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_setup_free_instruments",
          "args": [
            "setup"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_unique_ids",
          "args": [
            "instids",
            "ninsts",
            "\"instrument\"",
            "AF_BAD_INSTID"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "_af_unique_ids",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "369-384",
          "snippet": "bool _af_unique_ids (const int *ids, int nids, const char *idname, int iderr)\n{\n\tfor (int i = 0; i < nids; i++)\n\t{\n\t\tfor (int j = 0; j < i; j++)\n\t\t{\n\t\t\tif (ids[i] == ids[j])\n\t\t\t{\n\t\t\t\t_af_error(iderr, \"nonunique %s id %d\", idname, ids[i]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_unique_ids (const int *ids, int nids, const char *idname, int iderr)\n{\n\tfor (int i = 0; i < nids; i++)\n\t{\n\t\tfor (int j = 0; j < i; j++)\n\t\t{\n\t\t\tif (ids[i] == ids[j])\n\t\t\t{\n\t\t\t\t_af_error(iderr, \"nonunique %s id %d\", idname, ids[i]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nvoid afInitInstIDs (AFfilesetup setup, const int *instids, int ninsts)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tif (!_af_unique_ids(instids, ninsts, \"instrument\", AF_BAD_INSTID))\n\t\treturn;\n\n\t_af_setup_free_instruments(setup);\n\n\tsetup->instrumentCount = ninsts;\n\tsetup->instrumentSet = true;\n\n\tsetup->instruments = _af_instsetup_new(setup->instrumentCount);\n\n\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\tsetup->instruments[i].id = instids[i];\n}"
  },
  {
    "function_name": "freeLoops",
    "container": "InstrumentSetup",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "69-75",
    "snippet": "void InstrumentSetup::freeLoops()\n{\n\tif (loops)\n\t\tfree(loops);\n\tloops = NULL;\n\tloopCount = 0;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "free",
          "args": [
            "loops"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nInstrumentSetup {\n  void InstrumentSetup::freeLoops()\n  {\n  \tif (loops)\n  \t\tfree(loops);\n  \tloops = NULL;\n  \tloopCount = 0;\n  }\n}"
  },
  {
    "function_name": "allocateLoops",
    "container": "InstrumentSetup",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
    "lines": "57-67",
    "snippet": "bool InstrumentSetup::allocateLoops(int count)\n{\n\tfreeLoops();\n\tloops = (LoopSetup *) _af_calloc(count, sizeof (LoopSetup));\n\tif (loops)\n\t{\n\t\tloopCount = count;\n\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <stdlib.h>",
      "#include \"util.h\"",
      "#include \"units.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Setup.h\"",
      "#include \"Instrument.h\"",
      "#include \"FileHandle.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_calloc",
          "args": [
            "count",
            "sizeof (LoopSetup)"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "freeLoops",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "freeLoops",
          "container": "InstrumentSetup",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "69-75",
          "snippet": "void InstrumentSetup::freeLoops()\n{\n\tif (loops)\n\t\tfree(loops);\n\tloops = NULL;\n\tloopCount = 0;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nInstrumentSetup {\n  void InstrumentSetup::freeLoops()\n  {\n  \tif (loops)\n  \t\tfree(loops);\n  \tloops = NULL;\n  \tloopCount = 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nInstrumentSetup {\n  bool InstrumentSetup::allocateLoops(int count)\n  {\n  \tfreeLoops();\n  \tloops = (LoopSetup *) _af_calloc(count, sizeof (LoopSetup));\n  \tif (loops)\n  \t{\n  \t\tloopCount = count;\n  \t\treturn true;\n  \t}\n  \treturn false;\n  }\n}"
  }
]