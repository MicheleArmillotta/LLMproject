[
  {
    "function_name": "afGetMarkPosition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Marker.cpp",
    "lines": "234-248",
    "snippet": "AFframecount afGetMarkPosition (AFfilehandle file, int trackid, int markid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn 0L;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn 0L;\n\n\tMarker *marker = track->getMarker(markid);\n\tif (!marker)\n\t\treturn 0L;\n\n\treturn marker->position;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <assert.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include \"Marker.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "track->getMarker",
          "args": [
            "markid"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"Marker.h\"\n#include \"config.h\"\n\nAFframecount afGetMarkPosition (AFfilehandle file, int trackid, int markid)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn 0L;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn 0L;\n\n\tMarker *marker = track->getMarker(markid);\n\tif (!marker)\n\t\treturn 0L;\n\n\treturn marker->position;\n}"
  },
  {
    "function_name": "afGetMarkIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Marker.cpp",
    "lines": "214-232",
    "snippet": "int afGetMarkIDs (AFfilehandle file, int trackid, int markids[])\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (markids != NULL)\n\t{\n\t\tfor (int i=0; i<track->markerCount; i++)\n\t\t{\n\t\t\tmarkids[i] = track->markers[i].id;\n\t\t}\n\t}\n\n\treturn track->markerCount;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <assert.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include \"Marker.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"Marker.h\"\n#include \"config.h\"\n\nint afGetMarkIDs (AFfilehandle file, int trackid, int markids[])\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn -1;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn -1;\n\n\tif (markids != NULL)\n\t{\n\t\tfor (int i=0; i<track->markerCount; i++)\n\t\t{\n\t\t\tmarkids[i] = track->markers[i].id;\n\t\t}\n\t}\n\n\treturn track->markerCount;\n}"
  },
  {
    "function_name": "afSetMarkPosition",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Marker.cpp",
    "lines": "187-212",
    "snippet": "void afSetMarkPosition (AFfilehandle file, int trackid, int markid,\n\tAFframecount position)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tif (!file->checkCanWrite())\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tMarker *marker = track->getMarker(markid);\n\tif (!marker)\n\t\treturn;\n\n\tif (position < 0)\n\t{\n\t\t_af_error(AF_BAD_MARKPOS, \"invalid marker position %jd\",\n\t\t\tstatic_cast<intmax_t>(position));\n\t\tposition = 0;\n\t}\n\n\tmarker->position = position;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <assert.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include \"Marker.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_MARKPOS",
            "\"invalid marker position %jd\"",
            "static_cast<intmax_t>(position)"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<intmax_t>",
          "args": [
            "position"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "track->getMarker",
          "args": [
            "markid"
          ],
          "line": 200
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->getTrack",
          "args": [
            "trackid"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "file->checkCanWrite",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "checkCanWrite",
          "container": "_AFfilehandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/FileHandle.cpp",
          "lines": "188-197",
          "snippet": "bool _AFfilehandle::checkCanWrite()\n{\n\tif (m_access != _AF_WRITE_ACCESS)\n\t{\n\t\t_af_error(AF_BAD_NOWRITEACC, \"file not opened for write access\");\n\t\treturn false;\n\t}\n\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"Track.h\"",
            "#include \"Tag.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"File.h\"",
            "#include \"WAVE.h\"",
            "#include \"VOC.h\"",
            "#include \"SampleVision.h\"",
            "#include \"Raw.h\"",
            "#include \"NIST.h\"",
            "#include \"NeXT.h\"",
            "#include \"IRCAM.h\"",
            "#include \"IFF.h\"",
            "#include \"FLACFile.h\"",
            "#include \"CAF.h\"",
            "#include \"AVR.h\"",
            "#include \"AIFF.h\"",
            "#include <assert.h>",
            "#include <stdlib.h>",
            "#include \"byteorder.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"Track.h\"\n#include \"Tag.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"File.h\"\n#include \"WAVE.h\"\n#include \"VOC.h\"\n#include \"SampleVision.h\"\n#include \"Raw.h\"\n#include \"NIST.h\"\n#include \"NeXT.h\"\n#include \"IRCAM.h\"\n#include \"IFF.h\"\n#include \"FLACFile.h\"\n#include \"CAF.h\"\n#include \"AVR.h\"\n#include \"AIFF.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include \"byteorder.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\n_AFfilehandle {\n  bool _AFfilehandle::checkCanWrite()\n  {\n  \tif (m_access != _AF_WRITE_ACCESS)\n  \t{\n  \t\t_af_error(AF_BAD_NOWRITEACC, \"file not opened for write access\");\n  \t\treturn false;\n  \t}\n  \n  \treturn true;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_filehandle_ok",
          "args": [
            "file"
          ],
          "line": 190
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filehandle_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "71-84",
          "snippet": "bool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filehandle_ok (AFfilehandle file)\n{\n\tif (file == AF_NULL_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"null file handle\");\n\t\treturn false;\n\t}\n\tif (file->m_valid != _AF_VALID_FILEHANDLE)\n\t{\n\t\t_af_error(AF_BAD_FILEHANDLE, \"invalid file handle\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"Marker.h\"\n#include \"config.h\"\n\nvoid afSetMarkPosition (AFfilehandle file, int trackid, int markid,\n\tAFframecount position)\n{\n\tif (!_af_filehandle_ok(file))\n\t\treturn;\n\n\tif (!file->checkCanWrite())\n\t\treturn;\n\n\tTrack *track = file->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tMarker *marker = track->getMarker(markid);\n\tif (!marker)\n\t\treturn;\n\n\tif (position < 0)\n\t{\n\t\t_af_error(AF_BAD_MARKPOS, \"invalid marker position %jd\",\n\t\t\tstatic_cast<intmax_t>(position));\n\t\tposition = 0;\n\t}\n\n\tmarker->position = position;\n}"
  },
  {
    "function_name": "afInitMarkComment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Marker.cpp",
    "lines": "121-153",
    "snippet": "void afInitMarkComment(AFfilesetup setup, int trackid, int markid,\n\tconst char *commstr)\n{\n\tint\tmarkno;\n\tint\tlength;\n\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tfor (markno=0; markno<track->markerCount; markno++)\n\t{\n\t\tif (track->markers[markno].id == markid)\n\t\t\tbreak;\n\t}\n\n\tif (markno == track->markerCount)\n\t{\n\t\t_af_error(AF_BAD_MARKID, \"no marker id %d for file setup\", markid);\n\t\treturn;\n\t}\n\n\tlength = strlen(commstr);\n\n\tif (track->markers[markno].comment)\n\t\tfree(track->markers[markno].comment);\n\tif ((track->markers[markno].comment = (char *) _af_malloc(length+1)) == NULL)\n\t\treturn;\n\tstrcpy(track->markers[markno].comment, commstr);\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <assert.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include \"Marker.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcpy",
          "args": [
            "track->markers[markno].comment",
            "commstr"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_malloc",
          "args": [
            "length+1"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "track->markers[markno].comment"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "commstr"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_MARKID",
            "\"no marker id %d for file setup\"",
            "markid"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 127
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"Marker.h\"\n#include \"config.h\"\n\nvoid afInitMarkComment(AFfilesetup setup, int trackid, int markid,\n\tconst char *commstr)\n{\n\tint\tmarkno;\n\tint\tlength;\n\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tfor (markno=0; markno<track->markerCount; markno++)\n\t{\n\t\tif (track->markers[markno].id == markid)\n\t\t\tbreak;\n\t}\n\n\tif (markno == track->markerCount)\n\t{\n\t\t_af_error(AF_BAD_MARKID, \"no marker id %d for file setup\", markid);\n\t\treturn;\n\t}\n\n\tlength = strlen(commstr);\n\n\tif (track->markers[markno].comment)\n\t\tfree(track->markers[markno].comment);\n\tif ((track->markers[markno].comment = (char *) _af_malloc(length+1)) == NULL)\n\t\treturn;\n\tstrcpy(track->markers[markno].comment, commstr);\n}"
  },
  {
    "function_name": "afInitMarkName",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Marker.cpp",
    "lines": "76-119",
    "snippet": "void afInitMarkName(AFfilesetup setup, int trackid, int markid,\n\tconst char *namestr)\n{\n\tint\tmarkno;\n\tint\tlength;\n\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tfor (markno=0; markno<track->markerCount; markno++)\n\t{\n\t\tif (track->markers[markno].id == markid)\n\t\t\tbreak;\n\t}\n\n\tif (markno == track->markerCount)\n\t{\n\t\t_af_error(AF_BAD_MARKID, \"no marker id %d for file setup\", markid);\n\t\treturn;\n\t}\n\n\tlength = strlen(namestr);\n\tif (length > 255)\n\t{\n\t\t_af_error(AF_BAD_STRLEN,\n\t\t\t\"warning: marker name truncated to 255 characters\");\n\t\tlength = 255;\n\t}\n\n\tif (track->markers[markno].name)\n\t\tfree(track->markers[markno].name);\n\tif ((track->markers[markno].name = (char *) _af_malloc(length+1)) == NULL)\n\t\treturn;\n\tstrncpy(track->markers[markno].name, namestr, length);\n\t/*\n\t\tThe null terminator is not set by strncpy if\n\t\tstrlen(namestr) > length.  Set it here.\n\t*/\n\ttrack->markers[markno].name[length] = '\\0';\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <assert.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include \"Marker.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "track->markers[markno].name",
            "namestr",
            "length"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_malloc",
          "args": [
            "length+1"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "track->markers[markno].name"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_STRLEN",
            "\"warning: marker name truncated to 255 characters\""
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "namestr"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_MARKID",
            "\"no marker id %d for file setup\"",
            "markid"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"Marker.h\"\n#include \"config.h\"\n\nvoid afInitMarkName(AFfilesetup setup, int trackid, int markid,\n\tconst char *namestr)\n{\n\tint\tmarkno;\n\tint\tlength;\n\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tfor (markno=0; markno<track->markerCount; markno++)\n\t{\n\t\tif (track->markers[markno].id == markid)\n\t\t\tbreak;\n\t}\n\n\tif (markno == track->markerCount)\n\t{\n\t\t_af_error(AF_BAD_MARKID, \"no marker id %d for file setup\", markid);\n\t\treturn;\n\t}\n\n\tlength = strlen(namestr);\n\tif (length > 255)\n\t{\n\t\t_af_error(AF_BAD_STRLEN,\n\t\t\t\"warning: marker name truncated to 255 characters\");\n\t\tlength = 255;\n\t}\n\n\tif (track->markers[markno].name)\n\t\tfree(track->markers[markno].name);\n\tif ((track->markers[markno].name = (char *) _af_malloc(length+1)) == NULL)\n\t\treturn;\n\tstrncpy(track->markers[markno].name, namestr, length);\n\t/*\n\t\tThe null terminator is not set by strncpy if\n\t\tstrlen(namestr) > length.  Set it here.\n\t*/\n\ttrack->markers[markno].name[length] = '\\0';\n}"
  },
  {
    "function_name": "afInitMarkIDs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Marker.cpp",
    "lines": "42-74",
    "snippet": "void afInitMarkIDs(AFfilesetup setup, int trackid, const int *markids, int nmarks)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (track->markers != NULL)\n\t{\n\t\tfor (int i=0; i<track->markerCount; i++)\n\t\t{\n\t\t\tif (track->markers[i].name != NULL)\n\t\t\t\tfree(track->markers[i].name);\n\t\t\tif (track->markers[i].comment != NULL)\n\t\t\t\tfree(track->markers[i].comment);\n\t\t}\n\t\tfree(track->markers);\n\t}\n\n\ttrack->markers = (MarkerSetup *) _af_calloc(nmarks, sizeof (struct MarkerSetup));\n\ttrack->markerCount = nmarks;\n\n\tfor (int i=0; i<nmarks; i++)\n\t{\n\t\ttrack->markers[i].id = markids[i];\n\t\ttrack->markers[i].name = _af_strdup(\"\");\n\t\ttrack->markers[i].comment = _af_strdup(\"\");\n\t}\n\n\ttrack->markersSet = true;\n}",
    "includes": [
      "#include \"util.h\"",
      "#include \"audiofile.h\"",
      "#include \"afinternal.h\"",
      "#include \"Track.h\"",
      "#include \"Setup.h\"",
      "#include \"FileHandle.h\"",
      "#include <assert.h>",
      "#include <stdlib.h>",
      "#include <string.h>",
      "#include \"Marker.h\"",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_strdup",
          "args": [
            "\"\""
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_strdup",
          "args": [
            "\"\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_calloc",
          "args": [
            "nmarks",
            "sizeof (struct MarkerSetup)"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "track->markers"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "setup->getTrack",
          "args": [
            "trackid"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_filesetup_ok",
          "args": [
            "setup"
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "_af_filesetup_ok",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "56-69",
          "snippet": "bool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nbool _af_filesetup_ok (AFfilesetup setup)\n{\n\tif (setup == AF_NULL_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"null file setup\");\n\t\treturn false;\n\t}\n\tif (setup->valid != _AF_VALID_FILESETUP)\n\t{\n\t\t_af_error(AF_BAD_FILESETUP, \"invalid file setup\");\n\t\treturn false;\n\t}\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include <assert.h>\n#include <stdlib.h>\n#include <string.h>\n#include \"Marker.h\"\n#include \"config.h\"\n\nvoid afInitMarkIDs(AFfilesetup setup, int trackid, const int *markids, int nmarks)\n{\n\tif (!_af_filesetup_ok(setup))\n\t\treturn;\n\n\tTrackSetup *track = setup->getTrack(trackid);\n\tif (!track)\n\t\treturn;\n\n\tif (track->markers != NULL)\n\t{\n\t\tfor (int i=0; i<track->markerCount; i++)\n\t\t{\n\t\t\tif (track->markers[i].name != NULL)\n\t\t\t\tfree(track->markers[i].name);\n\t\t\tif (track->markers[i].comment != NULL)\n\t\t\t\tfree(track->markers[i].comment);\n\t\t}\n\t\tfree(track->markers);\n\t}\n\n\ttrack->markers = (MarkerSetup *) _af_calloc(nmarks, sizeof (struct MarkerSetup));\n\ttrack->markerCount = nmarks;\n\n\tfor (int i=0; i<nmarks; i++)\n\t{\n\t\ttrack->markers[i].id = markids[i];\n\t\ttrack->markers[i].name = _af_strdup(\"\");\n\t\ttrack->markers[i].comment = _af_strdup(\"\");\n\t}\n\n\ttrack->markersSet = true;\n}"
  }
]