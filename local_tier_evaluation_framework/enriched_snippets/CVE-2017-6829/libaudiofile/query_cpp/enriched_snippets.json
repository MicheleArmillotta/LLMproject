[
  {
    "function_name": "_afQueryCompression",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "413-482",
    "snippet": "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4)\n{\n\tconst CompressionUnit *unit = NULL;\n\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t{\n\t\t\tint count = 0;\n\t\t\tfor (int i = 0; i < _AF_NUM_COMPRESSION; i++)\n\t\t\t\tif (_af_compression[i].implemented)\n\t\t\t\t\tcount++;\n\t\t\treturn _af_pv_long(count);\n\t\t}\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint *buf = (int *) _af_calloc(_AF_NUM_COMPRESSION, sizeof (int));\n\t\t\tif (!buf)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tint count = 0;\n\t\t\tfor (int i = 0; i < _AF_NUM_COMPRESSION; i++)\n\t\t\t{\n\t\t\t\tif (_af_compression[i].implemented)\n\t\t\t\t\tbuf[count++] = _af_compression[i].compressionID;\n\t\t\t}\n\t\t\treturn _af_pv_pointer(buf);\n\t\t}\n\n\t\tcase AF_QUERY_IMPLEMENTED:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn _af_pv_long(0);\n\t\t\treturn _af_pv_long(unit->implemented);\n\n\t\tcase AF_QUERY_NATIVE_SAMPFMT:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(unit->nativeSampleFormat);\n\n\t\tcase AF_QUERY_NATIVE_SAMPWIDTH:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(unit->nativeSampleWidth);\n\n\t\tcase AF_QUERY_LABEL:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->label));\n\n\t\tcase AF_QUERY_NAME:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->shortname));\n\n\t\tcase AF_QUERY_DESC:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->name));\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"unrecognized query selector %d\\n\", arg1);\n\treturn AU_NULL_PVLIST;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_QUERY",
            "\"unrecognized query selector %d\\n\"",
            "arg1"
          ],
          "line": 480
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_pv_pointer",
          "args": [
            "const_cast<char *>(unit->name)"
          ],
          "line": 477
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_pointer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "182-189",
          "snippet": "AUpvlist _af_pv_pointer (void *val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_PTR);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_pointer (void *val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_PTR);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<char *>",
          "args": [
            "unit->name"
          ],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_compression_unit_from_id",
          "args": [
            "arg2"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<char *>",
          "args": [
            "unit->shortname"
          ],
          "line": 471
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_compression_unit_from_id",
          "args": [
            "arg2"
          ],
          "line": 468
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<char *>",
          "args": [
            "unit->label"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_compression_unit_from_id",
          "args": [
            "arg2"
          ],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_pv_long",
          "args": [
            "unit->nativeSampleWidth"
          ],
          "line": 459
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_long",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "164-171",
          "snippet": "AUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_compression_unit_from_id",
          "args": [
            "arg2"
          ],
          "line": 456
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_compression_unit_from_id",
          "args": [
            "arg2"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_compression_unit_from_id",
          "args": [
            "arg2"
          ],
          "line": 444
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_calloc",
          "args": [
            "_AF_NUM_COMPRESSION",
            "sizeof (int)"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4)\n{\n\tconst CompressionUnit *unit = NULL;\n\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t{\n\t\t\tint count = 0;\n\t\t\tfor (int i = 0; i < _AF_NUM_COMPRESSION; i++)\n\t\t\t\tif (_af_compression[i].implemented)\n\t\t\t\t\tcount++;\n\t\t\treturn _af_pv_long(count);\n\t\t}\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint *buf = (int *) _af_calloc(_AF_NUM_COMPRESSION, sizeof (int));\n\t\t\tif (!buf)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tint count = 0;\n\t\t\tfor (int i = 0; i < _AF_NUM_COMPRESSION; i++)\n\t\t\t{\n\t\t\t\tif (_af_compression[i].implemented)\n\t\t\t\t\tbuf[count++] = _af_compression[i].compressionID;\n\t\t\t}\n\t\t\treturn _af_pv_pointer(buf);\n\t\t}\n\n\t\tcase AF_QUERY_IMPLEMENTED:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn _af_pv_long(0);\n\t\t\treturn _af_pv_long(unit->implemented);\n\n\t\tcase AF_QUERY_NATIVE_SAMPFMT:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(unit->nativeSampleFormat);\n\n\t\tcase AF_QUERY_NATIVE_SAMPWIDTH:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(unit->nativeSampleWidth);\n\n\t\tcase AF_QUERY_LABEL:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->label));\n\n\t\tcase AF_QUERY_NAME:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->shortname));\n\n\t\tcase AF_QUERY_DESC:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->name));\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"unrecognized query selector %d\\n\", arg1);\n\treturn AU_NULL_PVLIST;\n}"
  },
  {
    "function_name": "_afQueryMarker",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "398-410",
    "snippet": "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\treturn _af_pv_long(_af_units[arg2].markerCount != 0);\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\treturn _af_pv_long(_af_units[arg2].markerCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_QUERY",
            "\"bad query selector\""
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_pv_long",
          "args": [
            "_af_units[arg2].markerCount"
          ],
          "line": 405
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_long",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "164-171",
          "snippet": "AUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\treturn _af_pv_long(_af_units[arg2].markerCount != 0);\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\treturn _af_pv_long(_af_units[arg2].markerCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
  },
  {
    "function_name": "_afQueryMiscellaneous",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "391-395",
    "snippet": "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4)\n{\n\t_af_error(AF_BAD_NOT_IMPLEMENTED, \"not implemented yet\");\n\treturn AU_NULL_PVLIST;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_NOT_IMPLEMENTED",
            "\"not implemented yet\""
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4)\n{\n\t_af_error(AF_BAD_NOT_IMPLEMENTED, \"not implemented yet\");\n\treturn AU_NULL_PVLIST;\n}"
  },
  {
    "function_name": "_afQueryInstrument",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "371-388",
    "snippet": "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentCount != 0);\n\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_QUERY",
            "\"bad query selector\""
          ],
          "line": 386
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_pv_long",
          "args": [
            "_af_units[arg2].instrumentCount"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_long",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "164-171",
          "snippet": "AUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentCount != 0);\n\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
  },
  {
    "function_name": "_afQueryLoop",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "353-368",
    "snippet": "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4)\n{\n\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\treturn AU_NULL_PVLIST;\n\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\treturn _af_pv_long(_af_units[arg2].loopPerInstrumentCount != 0);\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\treturn _af_pv_long(_af_units[arg2].loopPerInstrumentCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_QUERY",
            "\"bad query selector\""
          ],
          "line": 366
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_pv_long",
          "args": [
            "_af_units[arg2].loopPerInstrumentCount"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_long",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "164-171",
          "snippet": "AUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4)\n{\n\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\treturn AU_NULL_PVLIST;\n\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\treturn _af_pv_long(_af_units[arg2].loopPerInstrumentCount != 0);\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\treturn _af_pv_long(_af_units[arg2].loopPerInstrumentCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
  },
  {
    "function_name": "_afQueryInstrumentParameter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "265-350",
    "snippet": "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\t/* For the following query types, arg2 is the file format. */\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameterCount != 0);\n\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameterCount);\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint\tcount;\n\t\t\tint\t*buffer;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tcount = _af_units[arg2].instrumentParameterCount;\n\t\t\tif (count == 0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tbuffer = (int *) _af_calloc(count, sizeof (int));\n\t\t\tif (buffer == NULL)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tfor (int i=0; i<count; i++)\n\t\t\t\tbuffer[i] = _af_units[arg2].instrumentParameters[i].id;\n\t\t\treturn _af_pv_pointer(buffer);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\t/*\n\t\t\tFor the next few query types, arg2 is the file\n\t\t\tformat and arg3 is the instrument parameter id.\n\t\t*/\n\t\tcase AF_QUERY_TYPE:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx<0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameters[idx].type);\n\t\t}\n\n\t\tcase AF_QUERY_NAME:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx < 0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].instrumentParameters[idx].name));\n\t\t}\n\n\t\tcase AF_QUERY_DEFAULT:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx >= 0)\n\t\t\t{\n\t\t\t\tAUpvlist\tret = AUpvnew(1);\n\t\t\t\tAUpvsetparam(ret, 0, _af_units[arg2].instrumentParameters[idx].id);\n\t\t\t\tAUpvsetvaltype(ret, 0, _af_units[arg2].instrumentParameters[idx].type);\n\t\t\t\tAUpvsetval(ret, 0, const_cast<AFPVu *>(&_af_units[arg2].instrumentParameters[idx].defaultValue));\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t\treturn AU_NULL_PVLIST;\n\t\t}\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_QUERY",
            "\"bad query selector\""
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetval",
          "args": [
            "ret",
            "0",
            "const_cast<AFPVu *>(&_af_units[arg2].instrumentParameters[idx].defaultValue)"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<AFPVu *>",
          "args": [
            "&_af_units[arg2].instrumentParameters[idx].defaultValue"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetvaltype",
          "args": [
            "ret",
            "0",
            "_af_units[arg2].instrumentParameters[idx].type"
          ],
          "line": 340
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvsetparam",
          "args": [
            "ret",
            "0",
            "_af_units[arg2].instrumentParameters[idx].id"
          ],
          "line": 339
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvnew",
          "args": [
            "1"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_instparam_index_from_id",
          "args": [
            "arg2",
            "arg3"
          ],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "_af_instparam_index_from_id",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Instrument.cpp",
          "lines": "275-291",
          "snippet": "int _af_instparam_index_from_id (int filefmt, int id)\n{\n\tint i;\n\n\tfor (i = 0; i < _af_units[filefmt].instrumentParameterCount; i++)\n\t\tif (_af_units[filefmt].instrumentParameters[i].id == id)\n\t\t\tbreak;\n\n\tif (i == _af_units[filefmt].instrumentParameterCount)\n\t{\n\t\t_af_error(AF_BAD_INSTPID, \"invalid instrument parameter id %d\",\n\t\t\tid);\n\t\treturn -1;\n\t}\n\n\treturn i;\n}",
          "includes": [
            "#include <stdlib.h>",
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"audiofile.h\"",
            "#include \"afinternal.h\"",
            "#include \"Setup.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdlib.h>\n#include \"util.h\"\n#include \"units.h\"\n#include \"audiofile.h\"\n#include \"afinternal.h\"\n#include \"Setup.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include \"config.h\"\n\nint _af_instparam_index_from_id (int filefmt, int id)\n{\n\tint i;\n\n\tfor (i = 0; i < _af_units[filefmt].instrumentParameterCount; i++)\n\t\tif (_af_units[filefmt].instrumentParameters[i].id == id)\n\t\t\tbreak;\n\n\tif (i == _af_units[filefmt].instrumentParameterCount)\n\t{\n\t\t_af_error(AF_BAD_INSTPID, \"invalid instrument parameter id %d\",\n\t\t\tid);\n\t\treturn -1;\n\t}\n\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_pv_pointer",
          "args": [
            "const_cast<char *>(_af_units[arg2].instrumentParameters[idx].name)"
          ],
          "line": 326
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_pointer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "182-189",
          "snippet": "AUpvlist _af_pv_pointer (void *val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_PTR);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_pointer (void *val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_PTR);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<char *>",
          "args": [
            "_af_units[arg2].instrumentParameters[idx].name"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_pv_long",
          "args": [
            "_af_units[arg2].instrumentParameters[idx].type"
          ],
          "line": 314
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_long",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "164-171",
          "snippet": "AUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_calloc",
          "args": [
            "count",
            "sizeof (int)"
          ],
          "line": 290
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\t/* For the following query types, arg2 is the file format. */\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameterCount != 0);\n\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameterCount);\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint\tcount;\n\t\t\tint\t*buffer;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tcount = _af_units[arg2].instrumentParameterCount;\n\t\t\tif (count == 0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tbuffer = (int *) _af_calloc(count, sizeof (int));\n\t\t\tif (buffer == NULL)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tfor (int i=0; i<count; i++)\n\t\t\t\tbuffer[i] = _af_units[arg2].instrumentParameters[i].id;\n\t\t\treturn _af_pv_pointer(buffer);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\t/*\n\t\t\tFor the next few query types, arg2 is the file\n\t\t\tformat and arg3 is the instrument parameter id.\n\t\t*/\n\t\tcase AF_QUERY_TYPE:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx<0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameters[idx].type);\n\t\t}\n\n\t\tcase AF_QUERY_NAME:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx < 0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].instrumentParameters[idx].name));\n\t\t}\n\n\t\tcase AF_QUERY_DEFAULT:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx >= 0)\n\t\t\t{\n\t\t\t\tAUpvlist\tret = AUpvnew(1);\n\t\t\t\tAUpvsetparam(ret, 0, _af_units[arg2].instrumentParameters[idx].id);\n\t\t\t\tAUpvsetvaltype(ret, 0, _af_units[arg2].instrumentParameters[idx].type);\n\t\t\t\tAUpvsetval(ret, 0, const_cast<AFPVu *>(&_af_units[arg2].instrumentParameters[idx].defaultValue));\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t\treturn AU_NULL_PVLIST;\n\t\t}\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
  },
  {
    "function_name": "afQueryDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "230-245",
    "snippet": "double afQueryDouble (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tAUpvlist\tlist;\n\tint\t\ttype;\n\tdouble\t\tvalue;\n\n\tlist = afQuery(querytype, arg1, arg2, arg3, arg4);\n\tif (list == AU_NULL_PVLIST)\n\t\treturn -1;\n\tAUpvgetvaltype(list, 0, &type);\n\tif (type != AU_PVTYPE_DOUBLE)\n\t\treturn -1;\n\tAUpvgetval(list, 0, &value);\n\tAUpvfree(list);\n\treturn value;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvfree",
          "args": [
            "list"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "list",
            "0",
            "&value"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetvaltype",
          "args": [
            "list",
            "0",
            "&type"
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afQuery",
          "args": [
            "querytype",
            "arg1",
            "arg2",
            "arg3",
            "arg4"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "afQueryDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
          "lines": "230-245",
          "snippet": "double afQueryDouble (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tAUpvlist\tlist;\n\tint\t\ttype;\n\tdouble\t\tvalue;\n\n\tlist = afQuery(querytype, arg1, arg2, arg3, arg4);\n\tif (list == AU_NULL_PVLIST)\n\t\treturn -1;\n\tAUpvgetvaltype(list, 0, &type);\n\tif (type != AU_PVTYPE_DOUBLE)\n\t\treturn -1;\n\tAUpvgetval(list, 0, &value);\n\tAUpvfree(list);\n\treturn value;\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\ndouble afQueryDouble (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tAUpvlist\tlist;\n\tint\t\ttype;\n\tdouble\t\tvalue;\n\n\tlist = afQuery(querytype, arg1, arg2, arg3, arg4);\n\tif (list == AU_NULL_PVLIST)\n\t\treturn -1;\n\tAUpvgetvaltype(list, 0, &type);\n\tif (type != AU_PVTYPE_DOUBLE)\n\t\treturn -1;\n\tAUpvgetval(list, 0, &value);\n\tAUpvfree(list);\n\treturn value;\n}"
  },
  {
    "function_name": "afQueryLong",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "213-228",
    "snippet": "long afQueryLong (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tAUpvlist\tlist;\n\tint\t\ttype;\n\tlong\t\tvalue;\n\n\tlist = afQuery(querytype, arg1, arg2, arg3, arg4);\n\tif (list == AU_NULL_PVLIST)\n\t\treturn -1;\n\tAUpvgetvaltype(list, 0, &type);\n\tif (type != AU_PVTYPE_LONG)\n\t\treturn -1;\n\tAUpvgetval(list, 0, &value);\n\tAUpvfree(list);\n\treturn value;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "AUpvfree",
          "args": [
            "list"
          ],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetval",
          "args": [
            "list",
            "0",
            "&value"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AUpvgetvaltype",
          "args": [
            "list",
            "0",
            "&type"
          ],
          "line": 222
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afQuery",
          "args": [
            "querytype",
            "arg1",
            "arg2",
            "arg3",
            "arg4"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "afQueryDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
          "lines": "230-245",
          "snippet": "double afQueryDouble (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tAUpvlist\tlist;\n\tint\t\ttype;\n\tdouble\t\tvalue;\n\n\tlist = afQuery(querytype, arg1, arg2, arg3, arg4);\n\tif (list == AU_NULL_PVLIST)\n\t\treturn -1;\n\tAUpvgetvaltype(list, 0, &type);\n\tif (type != AU_PVTYPE_DOUBLE)\n\t\treturn -1;\n\tAUpvgetval(list, 0, &value);\n\tAUpvfree(list);\n\treturn value;\n}",
          "includes": [
            "#include \"Instrument.h\"",
            "#include \"compression.h\"",
            "#include \"units.h\"",
            "#include \"util.h\"",
            "#include \"error.h\"",
            "#include \"aupvlist.h\"",
            "#include \"afinternal.h\"",
            "#include \"audiofile.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\ndouble afQueryDouble (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tAUpvlist\tlist;\n\tint\t\ttype;\n\tdouble\t\tvalue;\n\n\tlist = afQuery(querytype, arg1, arg2, arg3, arg4);\n\tif (list == AU_NULL_PVLIST)\n\t\treturn -1;\n\tAUpvgetvaltype(list, 0, &type);\n\tif (type != AU_PVTYPE_DOUBLE)\n\t\treturn -1;\n\tAUpvgetval(list, 0, &value);\n\tAUpvfree(list);\n\treturn value;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nlong afQueryLong (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tAUpvlist\tlist;\n\tint\t\ttype;\n\tlong\t\tvalue;\n\n\tlist = afQuery(querytype, arg1, arg2, arg3, arg4);\n\tif (list == AU_NULL_PVLIST)\n\t\treturn -1;\n\tAUpvgetvaltype(list, 0, &type);\n\tif (type != AU_PVTYPE_LONG)\n\t\treturn -1;\n\tAUpvgetval(list, 0, &value);\n\tAUpvfree(list);\n\treturn value;\n}"
  },
  {
    "function_name": "_afQueryFileFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "82-211",
    "snippet": "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\t/* The following select only on arg1. */\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t{\n\t\t\tint\tcount = 0, idx;\n\t\t\tfor (idx = 0; idx < _AF_NUM_UNITS; idx++)\n\t\t\t\tif (_af_units[idx].implemented)\n\t\t\t\t\tcount++;\n\t\t\treturn _af_pv_long(count);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint\tcount = 0, idx;\n\t\t\tint\t*buffer;\n\n\t\t\tbuffer = (int *) _af_calloc(_AF_NUM_UNITS, sizeof (int));\n\t\t\tif (buffer == NULL)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tfor (idx = 0; idx < _AF_NUM_UNITS; idx++)\n\t\t\t\tif (_af_units[idx].implemented)\n\t\t\t\t\tbuffer[count++] = idx;\n\n\t\t\tif (count == 0)\n\t\t\t{\n\t\t\t\tfree(buffer);\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\t}\n\n\t\t\treturn _af_pv_pointer(buffer);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\t/* The following select on arg2. */\n\t\tcase AF_QUERY_LABEL:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].label));\n\n\t\tcase AF_QUERY_NAME:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].name));\n\n\t\tcase AF_QUERY_DESC:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].description));\n\n\t\tcase AF_QUERY_IMPLEMENTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn _af_pv_long(0);\n\t\t\treturn _af_pv_long(_af_units[arg2].implemented);\n\n\t\t/* The following select on arg3. */\n\t\tcase AF_QUERY_SAMPLE_FORMATS:\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_DEFAULT:\n\t\t\t\t\treturn _af_pv_long(_af_units[arg3].defaultSampleFormat);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* NOTREACHED */\n\t\t\tbreak;\n\n\t\tcase AF_QUERY_SAMPLE_SIZES:\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_DEFAULT:\n\t\t\t\t\treturn _af_pv_long(_af_units[arg3].defaultSampleWidth);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* NOTREACHED */\n\t\t\tbreak;\n\n\t\tcase AF_QUERY_COMPRESSION_TYPES:\n\t\t{\n\t\t\tint\tidx, count;\n\t\t\tint\t*buffer;\n\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t{\n\t\t\t\t_af_error(AF_BAD_QUERY,\n\t\t\t\t\t\"unrecognized file format %d\", arg3);\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\t}\n\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_VALUE_COUNT:\n\t\t\t\t\tcount = _af_units[arg3].compressionTypeCount;\n\t\t\t\t\treturn _af_pv_long(count);\n\n\t\t\t\tcase AF_QUERY_VALUES:\n\t\t\t\t\tcount = _af_units[arg3].compressionTypeCount;\n\t\t\t\t\tif (count == 0)\n\t\t\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\t\t\tbuffer = (int *) _af_calloc(count, sizeof (int));\n\t\t\t\t\tif (buffer == NULL)\n\t\t\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\t\t\tfor (idx = 0; idx < count; idx++)\n\t\t\t\t\t{\n\t\t\t\t\t\tbuffer[idx] = _af_units[arg3].compressionTypes[idx];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn _af_pv_pointer(buffer);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_QUERY",
            "\"bad query selector\""
          ],
          "line": 209
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_pv_pointer",
          "args": [
            "buffer"
          ],
          "line": 203
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_pointer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "182-189",
          "snippet": "AUpvlist _af_pv_pointer (void *val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_PTR);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_pointer (void *val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_PTR);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_calloc",
          "args": [
            "count",
            "sizeof (int)"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_af_pv_long",
          "args": [
            "count"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "_af_pv_long",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/util.cpp",
          "lines": "164-171",
          "snippet": "AUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"compression.h\"",
            "#include \"byteorder.h\"",
            "#include \"aupvinternal.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Setup.h\"",
            "#include \"FileHandle.h\"",
            "#include \"File.h\"",
            "#include \"AudioFormat.h\"",
            "#include \"aupvlist.h\"",
            "#include \"audiofile.h\"",
            "#include <assert.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"compression.h\"\n#include \"byteorder.h\"\n#include \"aupvinternal.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Setup.h\"\n#include \"FileHandle.h\"\n#include \"File.h\"\n#include \"AudioFormat.h\"\n#include \"aupvlist.h\"\n#include \"audiofile.h\"\n#include <assert.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include \"config.h\"\n\nAUpvlist _af_pv_long (long val)\n{\n\tAUpvlist\tret = AUpvnew(1);\n\tAUpvsetparam(ret, 0, 0);\n\tAUpvsetvaltype(ret, 0, AU_PVTYPE_LONG);\n\tAUpvsetval(ret, 0, &val);\n\treturn ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_QUERY",
            "\"unrecognized file format %d\"",
            "arg3"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<char *>",
          "args": [
            "_af_units[arg2].description"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<char *>",
          "args": [
            "_af_units[arg2].name"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<char *>",
          "args": [
            "_af_units[arg2].label"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "free",
          "args": [
            "buffer"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "_af_setup_free_instruments",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/Setup.cpp",
          "lines": "251-263",
          "snippet": "void _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"units.h\"",
            "#include \"pcm.h\"",
            "#include \"audiofile.h\"",
            "#include \"byteorder.h\"",
            "#include \"afinternal.h\"",
            "#include \"Track.h\"",
            "#include \"Marker.h\"",
            "#include \"Instrument.h\"",
            "#include \"FileHandle.h\"",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include \"Setup.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"units.h\"\n#include \"pcm.h\"\n#include \"audiofile.h\"\n#include \"byteorder.h\"\n#include \"afinternal.h\"\n#include \"Track.h\"\n#include \"Marker.h\"\n#include \"Instrument.h\"\n#include \"FileHandle.h\"\n#include <string.h>\n#include <stdlib.h>\n#include \"Setup.h\"\n#include \"config.h\"\n\nvoid _af_setup_free_instruments (AFfilesetup setup)\n{\n\tif (setup->instruments)\n\t{\n\t\tfor (int i=0; i < setup->instrumentCount; i++)\n\t\t\tsetup->instruments[i].freeLoops();\n\n\t\tfree(setup->instruments);\n\t}\n\n\tsetup->instruments = NULL;\n\tsetup->instrumentCount = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_af_calloc",
          "args": [
            "_AF_NUM_UNITS",
            "sizeof (int)"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\t/* The following select only on arg1. */\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t{\n\t\t\tint\tcount = 0, idx;\n\t\t\tfor (idx = 0; idx < _AF_NUM_UNITS; idx++)\n\t\t\t\tif (_af_units[idx].implemented)\n\t\t\t\t\tcount++;\n\t\t\treturn _af_pv_long(count);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint\tcount = 0, idx;\n\t\t\tint\t*buffer;\n\n\t\t\tbuffer = (int *) _af_calloc(_AF_NUM_UNITS, sizeof (int));\n\t\t\tif (buffer == NULL)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tfor (idx = 0; idx < _AF_NUM_UNITS; idx++)\n\t\t\t\tif (_af_units[idx].implemented)\n\t\t\t\t\tbuffer[count++] = idx;\n\n\t\t\tif (count == 0)\n\t\t\t{\n\t\t\t\tfree(buffer);\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\t}\n\n\t\t\treturn _af_pv_pointer(buffer);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\t/* The following select on arg2. */\n\t\tcase AF_QUERY_LABEL:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].label));\n\n\t\tcase AF_QUERY_NAME:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].name));\n\n\t\tcase AF_QUERY_DESC:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].description));\n\n\t\tcase AF_QUERY_IMPLEMENTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn _af_pv_long(0);\n\t\t\treturn _af_pv_long(_af_units[arg2].implemented);\n\n\t\t/* The following select on arg3. */\n\t\tcase AF_QUERY_SAMPLE_FORMATS:\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_DEFAULT:\n\t\t\t\t\treturn _af_pv_long(_af_units[arg3].defaultSampleFormat);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* NOTREACHED */\n\t\t\tbreak;\n\n\t\tcase AF_QUERY_SAMPLE_SIZES:\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_DEFAULT:\n\t\t\t\t\treturn _af_pv_long(_af_units[arg3].defaultSampleWidth);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* NOTREACHED */\n\t\t\tbreak;\n\n\t\tcase AF_QUERY_COMPRESSION_TYPES:\n\t\t{\n\t\t\tint\tidx, count;\n\t\t\tint\t*buffer;\n\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t{\n\t\t\t\t_af_error(AF_BAD_QUERY,\n\t\t\t\t\t\"unrecognized file format %d\", arg3);\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\t}\n\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_VALUE_COUNT:\n\t\t\t\t\tcount = _af_units[arg3].compressionTypeCount;\n\t\t\t\t\treturn _af_pv_long(count);\n\n\t\t\t\tcase AF_QUERY_VALUES:\n\t\t\t\t\tcount = _af_units[arg3].compressionTypeCount;\n\t\t\t\t\tif (count == 0)\n\t\t\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\t\t\tbuffer = (int *) _af_calloc(count, sizeof (int));\n\t\t\t\t\tif (buffer == NULL)\n\t\t\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\t\t\tfor (idx = 0; idx < count; idx++)\n\t\t\t\t\t{\n\t\t\t\t\t\tbuffer[idx] = _af_units[arg3].compressionTypes[idx];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn _af_pv_pointer(buffer);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
  },
  {
    "function_name": "afQuery",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
    "lines": "53-79",
    "snippet": "AUpvlist afQuery (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (querytype)\n\t{\n\t\tcase AF_QUERYTYPE_INST:\n\t\t\treturn _afQueryInstrument(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_INSTPARAM:\n\t\t\treturn _afQueryInstrumentParameter(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_LOOP:\n\t\t\treturn _afQueryLoop(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_FILEFMT:\n\t\t\treturn _afQueryFileFormat(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_COMPRESSION:\n\t\t\treturn _afQueryCompression(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_COMPRESSIONPARAM:\n\t\t\t/* FIXME: This selector is not implemented. */\n\t\t\treturn AU_NULL_PVLIST;\n\t\tcase AF_QUERYTYPE_MISC:\n\t\t\t/* FIXME: This selector is not implemented. */\n\t\t\treturn AU_NULL_PVLIST;\n\t\tcase AF_QUERYTYPE_MARK:\n\t\t\treturn _afQueryMarker(arg1, arg2, arg3, arg4);\n\t}\n\n\t_af_error(AF_BAD_QUERYTYPE, \"bad query type\");\n\treturn AU_NULL_PVLIST;\n}",
    "includes": [
      "#include \"Instrument.h\"",
      "#include \"compression.h\"",
      "#include \"units.h\"",
      "#include \"util.h\"",
      "#include \"error.h\"",
      "#include \"aupvlist.h\"",
      "#include \"afinternal.h\"",
      "#include \"audiofile.h\"",
      "#include <stdlib.h>",
      "#include <assert.h>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
      "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "_af_error",
          "args": [
            "AF_BAD_QUERYTYPE",
            "\"bad query type\""
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "_afQueryMarker",
          "args": [
            "arg1",
            "arg2",
            "arg3",
            "arg4"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "_afQueryMarker",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
          "lines": "398-410",
          "snippet": "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\treturn _af_pv_long(_af_units[arg2].markerCount != 0);\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\treturn _af_pv_long(_af_units[arg2].markerCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
          "includes": [
            "#include \"Instrument.h\"",
            "#include \"compression.h\"",
            "#include \"units.h\"",
            "#include \"util.h\"",
            "#include \"error.h\"",
            "#include \"aupvlist.h\"",
            "#include \"afinternal.h\"",
            "#include \"audiofile.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\treturn _af_pv_long(_af_units[arg2].markerCount != 0);\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\treturn _af_pv_long(_af_units[arg2].markerCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_afQueryCompression",
          "args": [
            "arg1",
            "arg2",
            "arg3",
            "arg4"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "_afQueryCompression",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
          "lines": "413-482",
          "snippet": "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4)\n{\n\tconst CompressionUnit *unit = NULL;\n\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t{\n\t\t\tint count = 0;\n\t\t\tfor (int i = 0; i < _AF_NUM_COMPRESSION; i++)\n\t\t\t\tif (_af_compression[i].implemented)\n\t\t\t\t\tcount++;\n\t\t\treturn _af_pv_long(count);\n\t\t}\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint *buf = (int *) _af_calloc(_AF_NUM_COMPRESSION, sizeof (int));\n\t\t\tif (!buf)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tint count = 0;\n\t\t\tfor (int i = 0; i < _AF_NUM_COMPRESSION; i++)\n\t\t\t{\n\t\t\t\tif (_af_compression[i].implemented)\n\t\t\t\t\tbuf[count++] = _af_compression[i].compressionID;\n\t\t\t}\n\t\t\treturn _af_pv_pointer(buf);\n\t\t}\n\n\t\tcase AF_QUERY_IMPLEMENTED:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn _af_pv_long(0);\n\t\t\treturn _af_pv_long(unit->implemented);\n\n\t\tcase AF_QUERY_NATIVE_SAMPFMT:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(unit->nativeSampleFormat);\n\n\t\tcase AF_QUERY_NATIVE_SAMPWIDTH:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(unit->nativeSampleWidth);\n\n\t\tcase AF_QUERY_LABEL:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->label));\n\n\t\tcase AF_QUERY_NAME:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->shortname));\n\n\t\tcase AF_QUERY_DESC:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->name));\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"unrecognized query selector %d\\n\", arg1);\n\treturn AU_NULL_PVLIST;\n}",
          "includes": [
            "#include \"Instrument.h\"",
            "#include \"compression.h\"",
            "#include \"units.h\"",
            "#include \"util.h\"",
            "#include \"error.h\"",
            "#include \"aupvlist.h\"",
            "#include \"afinternal.h\"",
            "#include \"audiofile.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4)\n{\n\tconst CompressionUnit *unit = NULL;\n\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t{\n\t\t\tint count = 0;\n\t\t\tfor (int i = 0; i < _AF_NUM_COMPRESSION; i++)\n\t\t\t\tif (_af_compression[i].implemented)\n\t\t\t\t\tcount++;\n\t\t\treturn _af_pv_long(count);\n\t\t}\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint *buf = (int *) _af_calloc(_AF_NUM_COMPRESSION, sizeof (int));\n\t\t\tif (!buf)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tint count = 0;\n\t\t\tfor (int i = 0; i < _AF_NUM_COMPRESSION; i++)\n\t\t\t{\n\t\t\t\tif (_af_compression[i].implemented)\n\t\t\t\t\tbuf[count++] = _af_compression[i].compressionID;\n\t\t\t}\n\t\t\treturn _af_pv_pointer(buf);\n\t\t}\n\n\t\tcase AF_QUERY_IMPLEMENTED:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn _af_pv_long(0);\n\t\t\treturn _af_pv_long(unit->implemented);\n\n\t\tcase AF_QUERY_NATIVE_SAMPFMT:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(unit->nativeSampleFormat);\n\n\t\tcase AF_QUERY_NATIVE_SAMPWIDTH:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(unit->nativeSampleWidth);\n\n\t\tcase AF_QUERY_LABEL:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->label));\n\n\t\tcase AF_QUERY_NAME:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->shortname));\n\n\t\tcase AF_QUERY_DESC:\n\t\t\tunit = _af_compression_unit_from_id(arg2);\n\t\t\tif (!unit)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(unit->name));\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"unrecognized query selector %d\\n\", arg1);\n\treturn AU_NULL_PVLIST;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_afQueryFileFormat",
          "args": [
            "arg1",
            "arg2",
            "arg3",
            "arg4"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "_afQueryFileFormat",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
          "lines": "82-211",
          "snippet": "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\t/* The following select only on arg1. */\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t{\n\t\t\tint\tcount = 0, idx;\n\t\t\tfor (idx = 0; idx < _AF_NUM_UNITS; idx++)\n\t\t\t\tif (_af_units[idx].implemented)\n\t\t\t\t\tcount++;\n\t\t\treturn _af_pv_long(count);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint\tcount = 0, idx;\n\t\t\tint\t*buffer;\n\n\t\t\tbuffer = (int *) _af_calloc(_AF_NUM_UNITS, sizeof (int));\n\t\t\tif (buffer == NULL)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tfor (idx = 0; idx < _AF_NUM_UNITS; idx++)\n\t\t\t\tif (_af_units[idx].implemented)\n\t\t\t\t\tbuffer[count++] = idx;\n\n\t\t\tif (count == 0)\n\t\t\t{\n\t\t\t\tfree(buffer);\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\t}\n\n\t\t\treturn _af_pv_pointer(buffer);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\t/* The following select on arg2. */\n\t\tcase AF_QUERY_LABEL:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].label));\n\n\t\tcase AF_QUERY_NAME:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].name));\n\n\t\tcase AF_QUERY_DESC:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].description));\n\n\t\tcase AF_QUERY_IMPLEMENTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn _af_pv_long(0);\n\t\t\treturn _af_pv_long(_af_units[arg2].implemented);\n\n\t\t/* The following select on arg3. */\n\t\tcase AF_QUERY_SAMPLE_FORMATS:\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_DEFAULT:\n\t\t\t\t\treturn _af_pv_long(_af_units[arg3].defaultSampleFormat);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* NOTREACHED */\n\t\t\tbreak;\n\n\t\tcase AF_QUERY_SAMPLE_SIZES:\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_DEFAULT:\n\t\t\t\t\treturn _af_pv_long(_af_units[arg3].defaultSampleWidth);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* NOTREACHED */\n\t\t\tbreak;\n\n\t\tcase AF_QUERY_COMPRESSION_TYPES:\n\t\t{\n\t\t\tint\tidx, count;\n\t\t\tint\t*buffer;\n\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t{\n\t\t\t\t_af_error(AF_BAD_QUERY,\n\t\t\t\t\t\"unrecognized file format %d\", arg3);\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\t}\n\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_VALUE_COUNT:\n\t\t\t\t\tcount = _af_units[arg3].compressionTypeCount;\n\t\t\t\t\treturn _af_pv_long(count);\n\n\t\t\t\tcase AF_QUERY_VALUES:\n\t\t\t\t\tcount = _af_units[arg3].compressionTypeCount;\n\t\t\t\t\tif (count == 0)\n\t\t\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\t\t\tbuffer = (int *) _af_calloc(count, sizeof (int));\n\t\t\t\t\tif (buffer == NULL)\n\t\t\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\t\t\tfor (idx = 0; idx < count; idx++)\n\t\t\t\t\t{\n\t\t\t\t\t\tbuffer[idx] = _af_units[arg3].compressionTypes[idx];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn _af_pv_pointer(buffer);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
          "includes": [
            "#include \"Instrument.h\"",
            "#include \"compression.h\"",
            "#include \"units.h\"",
            "#include \"util.h\"",
            "#include \"error.h\"",
            "#include \"aupvlist.h\"",
            "#include \"afinternal.h\"",
            "#include \"audiofile.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\t/* The following select only on arg1. */\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t{\n\t\t\tint\tcount = 0, idx;\n\t\t\tfor (idx = 0; idx < _AF_NUM_UNITS; idx++)\n\t\t\t\tif (_af_units[idx].implemented)\n\t\t\t\t\tcount++;\n\t\t\treturn _af_pv_long(count);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint\tcount = 0, idx;\n\t\t\tint\t*buffer;\n\n\t\t\tbuffer = (int *) _af_calloc(_AF_NUM_UNITS, sizeof (int));\n\t\t\tif (buffer == NULL)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tfor (idx = 0; idx < _AF_NUM_UNITS; idx++)\n\t\t\t\tif (_af_units[idx].implemented)\n\t\t\t\t\tbuffer[count++] = idx;\n\n\t\t\tif (count == 0)\n\t\t\t{\n\t\t\t\tfree(buffer);\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\t}\n\n\t\t\treturn _af_pv_pointer(buffer);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\t/* The following select on arg2. */\n\t\tcase AF_QUERY_LABEL:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].label));\n\n\t\tcase AF_QUERY_NAME:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].name));\n\n\t\tcase AF_QUERY_DESC:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].description));\n\n\t\tcase AF_QUERY_IMPLEMENTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn _af_pv_long(0);\n\t\t\treturn _af_pv_long(_af_units[arg2].implemented);\n\n\t\t/* The following select on arg3. */\n\t\tcase AF_QUERY_SAMPLE_FORMATS:\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_DEFAULT:\n\t\t\t\t\treturn _af_pv_long(_af_units[arg3].defaultSampleFormat);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* NOTREACHED */\n\t\t\tbreak;\n\n\t\tcase AF_QUERY_SAMPLE_SIZES:\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_DEFAULT:\n\t\t\t\t\treturn _af_pv_long(_af_units[arg3].defaultSampleWidth);\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\t/* NOTREACHED */\n\t\t\tbreak;\n\n\t\tcase AF_QUERY_COMPRESSION_TYPES:\n\t\t{\n\t\t\tint\tidx, count;\n\t\t\tint\t*buffer;\n\n\t\t\tif (arg3 < 0 || arg3 >= _AF_NUM_UNITS)\n\t\t\t{\n\t\t\t\t_af_error(AF_BAD_QUERY,\n\t\t\t\t\t\"unrecognized file format %d\", arg3);\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\t}\n\n\t\t\tswitch (arg2)\n\t\t\t{\n\t\t\t\tcase AF_QUERY_VALUE_COUNT:\n\t\t\t\t\tcount = _af_units[arg3].compressionTypeCount;\n\t\t\t\t\treturn _af_pv_long(count);\n\n\t\t\t\tcase AF_QUERY_VALUES:\n\t\t\t\t\tcount = _af_units[arg3].compressionTypeCount;\n\t\t\t\t\tif (count == 0)\n\t\t\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\t\t\tbuffer = (int *) _af_calloc(count, sizeof (int));\n\t\t\t\t\tif (buffer == NULL)\n\t\t\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\t\t\tfor (idx = 0; idx < count; idx++)\n\t\t\t\t\t{\n\t\t\t\t\t\tbuffer[idx] = _af_units[arg3].compressionTypes[idx];\n\t\t\t\t\t}\n\n\t\t\t\t\treturn _af_pv_pointer(buffer);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_afQueryLoop",
          "args": [
            "arg1",
            "arg2",
            "arg3",
            "arg4"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "_afQueryLoop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
          "lines": "353-368",
          "snippet": "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4)\n{\n\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\treturn AU_NULL_PVLIST;\n\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\treturn _af_pv_long(_af_units[arg2].loopPerInstrumentCount != 0);\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\treturn _af_pv_long(_af_units[arg2].loopPerInstrumentCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
          "includes": [
            "#include \"Instrument.h\"",
            "#include \"compression.h\"",
            "#include \"units.h\"",
            "#include \"util.h\"",
            "#include \"error.h\"",
            "#include \"aupvlist.h\"",
            "#include \"afinternal.h\"",
            "#include \"audiofile.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4)\n{\n\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\treturn AU_NULL_PVLIST;\n\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\treturn _af_pv_long(_af_units[arg2].loopPerInstrumentCount != 0);\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\treturn _af_pv_long(_af_units[arg2].loopPerInstrumentCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_afQueryInstrumentParameter",
          "args": [
            "arg1",
            "arg2",
            "arg3",
            "arg4"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "_afQueryInstrumentParameter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
          "lines": "265-350",
          "snippet": "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\t/* For the following query types, arg2 is the file format. */\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameterCount != 0);\n\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameterCount);\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint\tcount;\n\t\t\tint\t*buffer;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tcount = _af_units[arg2].instrumentParameterCount;\n\t\t\tif (count == 0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tbuffer = (int *) _af_calloc(count, sizeof (int));\n\t\t\tif (buffer == NULL)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tfor (int i=0; i<count; i++)\n\t\t\t\tbuffer[i] = _af_units[arg2].instrumentParameters[i].id;\n\t\t\treturn _af_pv_pointer(buffer);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\t/*\n\t\t\tFor the next few query types, arg2 is the file\n\t\t\tformat and arg3 is the instrument parameter id.\n\t\t*/\n\t\tcase AF_QUERY_TYPE:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx<0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameters[idx].type);\n\t\t}\n\n\t\tcase AF_QUERY_NAME:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx < 0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].instrumentParameters[idx].name));\n\t\t}\n\n\t\tcase AF_QUERY_DEFAULT:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx >= 0)\n\t\t\t{\n\t\t\t\tAUpvlist\tret = AUpvnew(1);\n\t\t\t\tAUpvsetparam(ret, 0, _af_units[arg2].instrumentParameters[idx].id);\n\t\t\t\tAUpvsetvaltype(ret, 0, _af_units[arg2].instrumentParameters[idx].type);\n\t\t\t\tAUpvsetval(ret, 0, const_cast<AFPVu *>(&_af_units[arg2].instrumentParameters[idx].defaultValue));\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t\treturn AU_NULL_PVLIST;\n\t\t}\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
          "includes": [
            "#include \"Instrument.h\"",
            "#include \"compression.h\"",
            "#include \"units.h\"",
            "#include \"util.h\"",
            "#include \"error.h\"",
            "#include \"aupvlist.h\"",
            "#include \"afinternal.h\"",
            "#include \"audiofile.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\t/* For the following query types, arg2 is the file format. */\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameterCount != 0);\n\n\t\tcase AF_QUERY_ID_COUNT:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameterCount);\n\n\t\tcase AF_QUERY_IDS:\n\t\t{\n\t\t\tint\tcount;\n\t\t\tint\t*buffer;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tcount = _af_units[arg2].instrumentParameterCount;\n\t\t\tif (count == 0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tbuffer = (int *) _af_calloc(count, sizeof (int));\n\t\t\tif (buffer == NULL)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tfor (int i=0; i<count; i++)\n\t\t\t\tbuffer[i] = _af_units[arg2].instrumentParameters[i].id;\n\t\t\treturn _af_pv_pointer(buffer);\n\t\t}\n\t\t/* NOTREACHED */\n\t\tbreak;\n\n\t\t/*\n\t\t\tFor the next few query types, arg2 is the file\n\t\t\tformat and arg3 is the instrument parameter id.\n\t\t*/\n\t\tcase AF_QUERY_TYPE:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx<0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentParameters[idx].type);\n\t\t}\n\n\t\tcase AF_QUERY_NAME:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx < 0)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_pointer(const_cast<char *>(_af_units[arg2].instrumentParameters[idx].name));\n\t\t}\n\n\t\tcase AF_QUERY_DEFAULT:\n\t\t{\n\t\t\tint\tidx;\n\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\tidx = _af_instparam_index_from_id(arg2, arg3);\n\t\t\tif (idx >= 0)\n\t\t\t{\n\t\t\t\tAUpvlist\tret = AUpvnew(1);\n\t\t\t\tAUpvsetparam(ret, 0, _af_units[arg2].instrumentParameters[idx].id);\n\t\t\t\tAUpvsetvaltype(ret, 0, _af_units[arg2].instrumentParameters[idx].type);\n\t\t\t\tAUpvsetval(ret, 0, const_cast<AFPVu *>(&_af_units[arg2].instrumentParameters[idx].defaultValue));\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t\treturn AU_NULL_PVLIST;\n\t\t}\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
        }
      },
      {
        "call_info": {
          "callee": "_afQueryInstrument",
          "args": [
            "arg1",
            "arg2",
            "arg3",
            "arg4"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "_afQueryInstrument",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2017-6829/repo/libaudiofile/query.cpp",
          "lines": "371-388",
          "snippet": "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentCount != 0);\n\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}",
          "includes": [
            "#include \"Instrument.h\"",
            "#include \"compression.h\"",
            "#include \"units.h\"",
            "#include \"util.h\"",
            "#include \"error.h\"",
            "#include \"aupvlist.h\"",
            "#include \"afinternal.h\"",
            "#include \"audiofile.h\"",
            "#include <stdlib.h>",
            "#include <assert.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "AUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);",
            "AUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (arg1)\n\t{\n\t\tcase AF_QUERY_SUPPORTED:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentCount != 0);\n\n\t\tcase AF_QUERY_MAX_NUMBER:\n\t\t\tif (arg2 < 0 || arg2 >= _AF_NUM_UNITS)\n\t\t\t\treturn AU_NULL_PVLIST;\n\t\t\treturn _af_pv_long(_af_units[arg2].instrumentCount);\n\t}\n\n\t_af_error(AF_BAD_QUERY, \"bad query selector\");\n\treturn AU_NULL_PVLIST;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"Instrument.h\"\n#include \"compression.h\"\n#include \"units.h\"\n#include \"util.h\"\n#include \"error.h\"\n#include \"aupvlist.h\"\n#include \"afinternal.h\"\n#include \"audiofile.h\"\n#include <stdlib.h>\n#include <assert.h>\n#include \"config.h\"\n\nAUpvlist _afQueryFileFormat (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrument (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryInstrumentParameter (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryLoop (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMarker (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryMiscellaneous (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompression (int arg1, int arg2, int arg3, int arg4);\nAUpvlist _afQueryCompressionParameter (int arg1, int arg2, int arg3, int arg4);\n\nAUpvlist afQuery (int querytype, int arg1, int arg2, int arg3, int arg4)\n{\n\tswitch (querytype)\n\t{\n\t\tcase AF_QUERYTYPE_INST:\n\t\t\treturn _afQueryInstrument(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_INSTPARAM:\n\t\t\treturn _afQueryInstrumentParameter(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_LOOP:\n\t\t\treturn _afQueryLoop(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_FILEFMT:\n\t\t\treturn _afQueryFileFormat(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_COMPRESSION:\n\t\t\treturn _afQueryCompression(arg1, arg2, arg3, arg4);\n\t\tcase AF_QUERYTYPE_COMPRESSIONPARAM:\n\t\t\t/* FIXME: This selector is not implemented. */\n\t\t\treturn AU_NULL_PVLIST;\n\t\tcase AF_QUERYTYPE_MISC:\n\t\t\t/* FIXME: This selector is not implemented. */\n\t\t\treturn AU_NULL_PVLIST;\n\t\tcase AF_QUERYTYPE_MARK:\n\t\t\treturn _afQueryMarker(arg1, arg2, arg3, arg4);\n\t}\n\n\t_af_error(AF_BAD_QUERYTYPE, \"bad query type\");\n\treturn AU_NULL_PVLIST;\n}"
  }
]