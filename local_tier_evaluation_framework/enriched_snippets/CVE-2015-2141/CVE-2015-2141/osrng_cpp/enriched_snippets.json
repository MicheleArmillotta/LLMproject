[
  {
    "function_name": "Reseed",
    "container": "AutoSeededRandomPool",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "181-186",
    "snippet": "void AutoSeededRandomPool::Reseed(bool blocking, unsigned int seedSize)\n{\n\tSecByteBlock seed(seedSize);\n\tOS_GenerateRandomBlock(blocking, seed, seedSize);\n\tIncorporateEntropy(seed, seedSize);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IncorporateEntropy",
          "args": [
            "seed",
            "seedSize"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "IncorporateEntropy",
          "container": "AutoSeededX917RNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.h",
          "lines": "108-108",
          "snippet": "void IncorporateEntropy(const byte *input, size_t length) {Reseed(false, input, length);}",
          "includes": [
            "#include \"fips140.h\"",
            "#include \"sha.h\"",
            "#include \"aes.h\"",
            "#include \"rng.h\"",
            "#include \"randpool.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fips140.h\"\n#include \"sha.h\"\n#include \"aes.h\"\n#include \"rng.h\"\n#include \"randpool.h\"\n#include \"config.h\"\n\nAutoSeededX917RNG {\n  void IncorporateEntropy(const byte *input, size_t length) {Reseed(false, input, length);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "OS_GenerateRandomBlock",
          "args": [
            "blocking",
            "seed",
            "seedSize"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nAutoSeededRandomPool {\n  void AutoSeededRandomPool::Reseed(bool blocking, unsigned int seedSize)\n  {\n  \tSecByteBlock seed(seedSize);\n  \tOS_GenerateRandomBlock(blocking, seed, seedSize);\n  \tIncorporateEntropy(seed, seedSize);\n  }\n}"
  },
  {
    "function_name": "GenerateBlock",
    "container": "BlockingRng",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "131-152",
    "snippet": "void BlockingRng::GenerateBlock(byte *output, size_t size)\n{\n\twhile (size)\n\t{\n\t\t// on some systems /dev/random will block until all bytes\n\t\t// are available, on others it returns immediately\n\t\tssize_t len = read(m_fd, output, size);\n\t\tif (len < 0)\n\t\t{\n\t\t\t// /dev/random reads CAN give EAGAIN errors! (maybe EINTR as well)\n\t\t\tif (errno != EINTR && errno != EAGAIN)\n\t\t\t\tthrow OS_RNG_Err(\"read \" CRYPTOPP_BLOCKING_RNG_FILENAME);\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tsize -= len;\n\t\toutput += len;\n\t\tif (size)\n\t\t\tsleep(1);\n\t}\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [
      "#define CRYPTOPP_BLOCKING_RNG_FILENAME \"/dev/random\"",
      "#define CRYPTOPP_BLOCKING_RNG_FILENAME \"/dev/srandom\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sleep",
          "args": [
            "1"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "OS_RNG_Err",
          "args": [
            "\"read \"CRYPTOPP_BLOCKING_RNG_FILENAME"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "OS_RNG_Err",
          "container": "OS_RNG_Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
          "lines": "32-41",
          "snippet": "OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n\t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n#ifdef CRYPTOPP_WIN32_AVAILABLE\n\t\t\"0x\" + IntToString(GetLastError(), 16)\n#else\n\t\tIntToString(errno)\n#endif\n\t\t)\n{\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <wincrypt.h>",
            "#include <windows.h>",
            "#include \"rng.h\"",
            "#include \"osrng.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nOS_RNG_Err {\n  OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n  \t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n  #ifdef CRYPTOPP_WIN32_AVAILABLE\n  \t\t\"0x\" + IntToString(GetLastError(), 16)\n  #else\n  \t\tIntToString(errno)\n  #endif\n  \t\t)\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "m_fd",
            "output",
            "size"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\n#define CRYPTOPP_BLOCKING_RNG_FILENAME \"/dev/random\"\n#define CRYPTOPP_BLOCKING_RNG_FILENAME \"/dev/srandom\"\n\nBlockingRng {\n  void BlockingRng::GenerateBlock(byte *output, size_t size)\n  {\n  \twhile (size)\n  \t{\n  \t\t// on some systems /dev/random will block until all bytes\n  \t\t// are available, on others it returns immediately\n  \t\tssize_t len = read(m_fd, output, size);\n  \t\tif (len < 0)\n  \t\t{\n  \t\t\t// /dev/random reads CAN give EAGAIN errors! (maybe EINTR as well)\n  \t\t\tif (errno != EINTR && errno != EAGAIN)\n  \t\t\t\tthrow OS_RNG_Err(\"read \" CRYPTOPP_BLOCKING_RNG_FILENAME);\n  \n  \t\t\tcontinue;\n  \t\t}\n  \n  \t\tsize -= len;\n  \t\toutput += len;\n  \t\tif (size)\n  \t\t\tsleep(1);\n  \t}\n  }\n}"
  },
  {
    "function_name": "~BlockingRng",
    "container": "BlockingRng",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "126-129",
    "snippet": "BlockingRng::~BlockingRng()\n{\n\tclose(m_fd);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "m_fd"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nBlockingRng {\n  BlockingRng::~BlockingRng()\n  {\n  \tclose(m_fd);\n  }\n}"
  },
  {
    "function_name": "BlockingRng",
    "container": "BlockingRng",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "119-124",
    "snippet": "BlockingRng::BlockingRng()\n{\n\tm_fd = open(CRYPTOPP_BLOCKING_RNG_FILENAME,O_RDONLY);\n\tif (m_fd == -1)\n\t\tthrow OS_RNG_Err(\"open \" CRYPTOPP_BLOCKING_RNG_FILENAME);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [
      "#define CRYPTOPP_BLOCKING_RNG_FILENAME \"/dev/random\"",
      "#define CRYPTOPP_BLOCKING_RNG_FILENAME \"/dev/srandom\""
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OS_RNG_Err",
          "args": [
            "\"open \"CRYPTOPP_BLOCKING_RNG_FILENAME"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "OS_RNG_Err",
          "container": "OS_RNG_Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
          "lines": "32-41",
          "snippet": "OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n\t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n#ifdef CRYPTOPP_WIN32_AVAILABLE\n\t\t\"0x\" + IntToString(GetLastError(), 16)\n#else\n\t\tIntToString(errno)\n#endif\n\t\t)\n{\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <wincrypt.h>",
            "#include <windows.h>",
            "#include \"rng.h\"",
            "#include \"osrng.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nOS_RNG_Err {\n  OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n  \t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n  #ifdef CRYPTOPP_WIN32_AVAILABLE\n  \t\t\"0x\" + IntToString(GetLastError(), 16)\n  #else\n  \t\tIntToString(errno)\n  #endif\n  \t\t)\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "CRYPTOPP_BLOCKING_RNG_FILENAME",
            "O_RDONLY"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\n#define CRYPTOPP_BLOCKING_RNG_FILENAME \"/dev/random\"\n#define CRYPTOPP_BLOCKING_RNG_FILENAME \"/dev/srandom\"\n\nBlockingRng {\n  BlockingRng::BlockingRng()\n  {\n  \tm_fd = open(CRYPTOPP_BLOCKING_RNG_FILENAME,O_RDONLY);\n  \tif (m_fd == -1)\n  \t\tthrow OS_RNG_Err(\"open \" CRYPTOPP_BLOCKING_RNG_FILENAME);\n  }\n}"
  },
  {
    "function_name": "GenerateBlock",
    "container": "NonblockingRng",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "77-103",
    "snippet": "void NonblockingRng::GenerateBlock(byte *output, size_t size)\n{\n#ifdef CRYPTOPP_WIN32_AVAILABLE\n#\tifdef WORKAROUND_MS_BUG_Q258000\n\t\tconst MicrosoftCryptoProvider &m_Provider = Singleton<MicrosoftCryptoProvider>().Ref();\n#\tendif\n\tif (!CryptGenRandom(m_Provider.GetProviderHandle(), (DWORD)size, output))\n\t\tthrow OS_RNG_Err(\"CryptGenRandom\");\n#else\n\twhile (size)\n\t{\n\t\tssize_t len = read(m_fd, output, size);\n\n\t\tif (len < 0)\n\t\t{\n\t\t\t// /dev/urandom reads CAN give EAGAIN errors! (maybe EINTR as well)\n\t\t\tif (errno != EINTR && errno != EAGAIN)\n\t\t\t\tthrow OS_RNG_Err(\"read /dev/urandom\");\n\n\t\t\tcontinue;\n\t\t}\n\n\t\toutput += len;\n\t\tsize -= len;\n\t}\n#endif\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OS_RNG_Err",
          "args": [
            "\"read /dev/urandom\""
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "OS_RNG_Err",
          "container": "OS_RNG_Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
          "lines": "32-41",
          "snippet": "OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n\t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n#ifdef CRYPTOPP_WIN32_AVAILABLE\n\t\t\"0x\" + IntToString(GetLastError(), 16)\n#else\n\t\tIntToString(errno)\n#endif\n\t\t)\n{\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <wincrypt.h>",
            "#include <windows.h>",
            "#include \"rng.h\"",
            "#include \"osrng.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nOS_RNG_Err {\n  OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n  \t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n  #ifdef CRYPTOPP_WIN32_AVAILABLE\n  \t\t\"0x\" + IntToString(GetLastError(), 16)\n  #else\n  \t\tIntToString(errno)\n  #endif\n  \t\t)\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "read",
          "args": [
            "m_fd",
            "output",
            "size"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CryptGenRandom",
          "args": [
            "m_Provider.GetProviderHandle()",
            "(DWORD)size",
            "output"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_Provider.GetProviderHandle",
          "args": [],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Singleton<MicrosoftCryptoProvider>",
          "args": [],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "Singleton",
          "container": "Singleton",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "111-111",
          "snippet": "Singleton(F objectFactory = F()) : m_objectFactory(objectFactory) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nSingleton {\n  Singleton(F objectFactory = F()) : m_objectFactory(objectFactory) {}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nNonblockingRng {\n  void NonblockingRng::GenerateBlock(byte *output, size_t size)\n  {\n  #ifdef CRYPTOPP_WIN32_AVAILABLE\n  #\tifdef WORKAROUND_MS_BUG_Q258000\n  \t\tconst MicrosoftCryptoProvider &m_Provider = Singleton<MicrosoftCryptoProvider>().Ref();\n  #\tendif\n  \tif (!CryptGenRandom(m_Provider.GetProviderHandle(), (DWORD)size, output))\n  \t\tthrow OS_RNG_Err(\"CryptGenRandom\");\n  #else\n  \twhile (size)\n  \t{\n  \t\tssize_t len = read(m_fd, output, size);\n  \n  \t\tif (len < 0)\n  \t\t{\n  \t\t\t// /dev/urandom reads CAN give EAGAIN errors! (maybe EINTR as well)\n  \t\t\tif (errno != EINTR && errno != EAGAIN)\n  \t\t\t\tthrow OS_RNG_Err(\"read /dev/urandom\");\n  \n  \t\t\tcontinue;\n  \t\t}\n  \n  \t\toutput += len;\n  \t\tsize -= len;\n  \t}\n  #endif\n  }\n}"
  },
  {
    "function_name": "~NonblockingRng",
    "container": "NonblockingRng",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "70-75",
    "snippet": "NonblockingRng::~NonblockingRng()\n{\n#ifndef CRYPTOPP_WIN32_AVAILABLE\n\tclose(m_fd);\n#endif\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "m_fd"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nNonblockingRng {\n  NonblockingRng::~NonblockingRng()\n  {\n  #ifndef CRYPTOPP_WIN32_AVAILABLE\n  \tclose(m_fd);\n  #endif\n  }\n}"
  },
  {
    "function_name": "NonblockingRng",
    "container": "NonblockingRng",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "61-68",
    "snippet": "NonblockingRng::NonblockingRng()\n{\n#ifndef CRYPTOPP_WIN32_AVAILABLE\n\tm_fd = open(\"/dev/urandom\",O_RDONLY);\n\tif (m_fd == -1)\n\t\tthrow OS_RNG_Err(\"open /dev/urandom\");\n#endif\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OS_RNG_Err",
          "args": [
            "\"open /dev/urandom\""
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "OS_RNG_Err",
          "container": "OS_RNG_Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
          "lines": "32-41",
          "snippet": "OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n\t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n#ifdef CRYPTOPP_WIN32_AVAILABLE\n\t\t\"0x\" + IntToString(GetLastError(), 16)\n#else\n\t\tIntToString(errno)\n#endif\n\t\t)\n{\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <wincrypt.h>",
            "#include <windows.h>",
            "#include \"rng.h\"",
            "#include \"osrng.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nOS_RNG_Err {\n  OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n  \t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n  #ifdef CRYPTOPP_WIN32_AVAILABLE\n  \t\t\"0x\" + IntToString(GetLastError(), 16)\n  #else\n  \t\tIntToString(errno)\n  #endif\n  \t\t)\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "\"/dev/urandom\"",
            "O_RDONLY"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nNonblockingRng {\n  NonblockingRng::NonblockingRng()\n  {\n  #ifndef CRYPTOPP_WIN32_AVAILABLE\n  \tm_fd = open(\"/dev/urandom\",O_RDONLY);\n  \tif (m_fd == -1)\n  \t\tthrow OS_RNG_Err(\"open /dev/urandom\");\n  #endif\n  }\n}"
  },
  {
    "function_name": "~MicrosoftCryptoProvider",
    "container": "MicrosoftCryptoProvider",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "54-57",
    "snippet": "MicrosoftCryptoProvider::~MicrosoftCryptoProvider()\n{\n\tCryptReleaseContext(m_hProvider, 0);\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CryptReleaseContext",
          "args": [
            "m_hProvider",
            "0"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nMicrosoftCryptoProvider {\n  MicrosoftCryptoProvider::~MicrosoftCryptoProvider()\n  {\n  \tCryptReleaseContext(m_hProvider, 0);\n  }\n}"
  },
  {
    "function_name": "MicrosoftCryptoProvider",
    "container": "MicrosoftCryptoProvider",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "48-52",
    "snippet": "MicrosoftCryptoProvider::MicrosoftCryptoProvider()\n{\n\tif(!CryptAcquireContext(&m_hProvider, 0, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT))\n\t\tthrow OS_RNG_Err(\"CryptAcquireContext\");\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OS_RNG_Err",
          "args": [
            "\"CryptAcquireContext\""
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "OS_RNG_Err",
          "container": "OS_RNG_Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
          "lines": "32-41",
          "snippet": "OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n\t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n#ifdef CRYPTOPP_WIN32_AVAILABLE\n\t\t\"0x\" + IntToString(GetLastError(), 16)\n#else\n\t\tIntToString(errno)\n#endif\n\t\t)\n{\n}",
          "includes": [
            "#include <unistd.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <wincrypt.h>",
            "#include <windows.h>",
            "#include \"rng.h\"",
            "#include \"osrng.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nOS_RNG_Err {\n  OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n  \t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n  #ifdef CRYPTOPP_WIN32_AVAILABLE\n  \t\t\"0x\" + IntToString(GetLastError(), 16)\n  #else\n  \t\tIntToString(errno)\n  #endif\n  \t\t)\n  {\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CryptAcquireContext",
          "args": [
            "&m_hProvider",
            "0",
            "0",
            "PROV_RSA_FULL",
            "CRYPT_VERIFYCONTEXT"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nMicrosoftCryptoProvider {\n  MicrosoftCryptoProvider::MicrosoftCryptoProvider()\n  {\n  \tif(!CryptAcquireContext(&m_hProvider, 0, 0, PROV_RSA_FULL, CRYPT_VERIFYCONTEXT))\n  \t\tthrow OS_RNG_Err(\"CryptAcquireContext\");\n  }\n}"
  },
  {
    "function_name": "OS_RNG_Err",
    "container": "OS_RNG_Err",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.cpp",
    "lines": "32-41",
    "snippet": "OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n\t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n#ifdef CRYPTOPP_WIN32_AVAILABLE\n\t\t\"0x\" + IntToString(GetLastError(), 16)\n#else\n\t\tIntToString(errno)\n#endif\n\t\t)\n{\n}",
    "includes": [
      "#include <unistd.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <wincrypt.h>",
      "#include <windows.h>",
      "#include \"rng.h\"",
      "#include \"osrng.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "errno"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "IntToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "409-429",
          "snippet": "std::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nstd::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "GetLastError()",
            "16"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastError",
          "container": "Socket",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/socketft.cpp",
          "lines": "286-293",
          "snippet": "int Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}",
          "includes": [
            "#include <sys/ioctl.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include \"wait.h\"",
            "#include \"socketft.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/ioctl.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <netdb.h>\n#include <errno.h>\n#include \"wait.h\"\n#include \"socketft.h\"\n#include \"pch.h\"\n\nSocket {\n  int Socket::GetLastError()\n  {\n  #ifdef USE_WINDOWS_STYLE_SOCKETS\n  \treturn WSAGetLastError();\n  #else\n  \treturn errno;\n  #endif\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <unistd.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <wincrypt.h>\n#include <windows.h>\n#include \"rng.h\"\n#include \"osrng.h\"\n#include \"pch.h\"\n\nOS_RNG_Err {\n  OS_RNG_Err::OS_RNG_Err(const std::string &operation)\n  \t: Exception(OTHER_ERROR, \"OS_Rng: \" + operation + \" operation failed with error \" + \n  #ifdef CRYPTOPP_WIN32_AVAILABLE\n  \t\t\"0x\" + IntToString(GetLastError(), 16)\n  #else\n  \t\tIntToString(errno)\n  #endif\n  \t\t)\n  {\n  }\n}"
  }
]