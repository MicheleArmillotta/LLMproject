[
  {
    "function_name": "StaticAlgorithmName",
    "container": "ESIGN_Keys",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "115-115",
    "snippet": "static std::string StaticAlgorithmName() {return \"ESIGN\";}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nESIGN_Keys {\n  static std::string StaticAlgorithmName() {return \"ESIGN\";}\n}"
  },
  {
    "function_name": "ComputeMessageRepresentative",
    "container": "EMSA5Pad",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "92-104",
    "snippet": "void ComputeMessageRepresentative(RandomNumberGenerator &rng, \n\t\tconst byte *recoverableMessage, size_t recoverableMessageLength,\n\t\tHashTransformation &hash, HashIdentifier hashIdentifier, bool messageEmpty,\n\t\tbyte *representative, size_t representativeBitLength) const\n\t{\n\t\tSecByteBlock digest(hash.DigestSize());\n\t\thash.Final(digest);\n\t\tsize_t representativeByteLength = BitsToBytes(representativeBitLength);\n\t\tT mgf;\n\t\tmgf.GenerateAndMask(hash, representative, representativeByteLength, digest, digest.size(), false);\n\t\tif (representativeBitLength % 8 != 0)\n\t\t\trepresentative[0] = (byte)Crop(representative[0], representativeBitLength % 8);\n\t}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Crop",
          "args": [
            "representative[0]",
            "representativeBitLength % 8"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "Crop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "290-296",
          "snippet": "inline T Crop(T value, size_t size)\n{\n\tif (size < 8*sizeof(value))\n    \treturn T(value & ((T(1) << size) - 1));\n\telse\n\t\treturn value;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T Crop(T value, size_t size)\n{\n\tif (size < 8*sizeof(value))\n    \treturn T(value & ((T(1) << size) - 1));\n\telse\n\t\treturn value;\n}"
        }
      },
      {
        "call_info": {
          "callee": "mgf.GenerateAndMask",
          "args": [
            "hash",
            "representative",
            "representativeByteLength",
            "digest",
            "digest.size()",
            "false"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "digest.size",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitsToBytes",
          "args": [
            "representativeBitLength"
          ],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "BitsToBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "307-310",
          "snippet": "inline size_t BitsToBytes(size_t bitCount)\n{\n\treturn ((bitCount+7)/(8));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline size_t BitsToBytes(size_t bitCount)\n{\n\treturn ((bitCount+7)/(8));\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.Final",
          "args": [
            "digest"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.DigestSize",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nEMSA5Pad {\n  void ComputeMessageRepresentative(RandomNumberGenerator &rng, \n  \t\tconst byte *recoverableMessage, size_t recoverableMessageLength,\n  \t\tHashTransformation &hash, HashIdentifier hashIdentifier, bool messageEmpty,\n  \t\tbyte *representative, size_t representativeBitLength) const\n  \t{\n  \t\tSecByteBlock digest(hash.DigestSize());\n  \t\thash.Final(digest);\n  \t\tsize_t representativeByteLength = BitsToBytes(representativeBitLength);\n  \t\tT mgf;\n  \t\tmgf.GenerateAndMask(hash, representative, representativeByteLength, digest, digest.size(), false);\n  \t\tif (representativeBitLength % 8 != 0)\n  \t\t\trepresentative[0] = (byte)Crop(representative[0], representativeBitLength % 8);\n  \t}\n}"
  },
  {
    "function_name": "SetPrime2",
    "container": "InvertibleESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "79-79",
    "snippet": "void SetPrime2(const Integer &q) {m_q = q;}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nInvertibleESIGNFunction {\n  void SetPrime2(const Integer &q) {m_q = q;}\n}"
  },
  {
    "function_name": "SetPrime1",
    "container": "InvertibleESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "78-78",
    "snippet": "void SetPrime1(const Integer &p) {m_p = p;}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nInvertibleESIGNFunction {\n  void SetPrime1(const Integer &p) {m_p = p;}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "InvertibleESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "60-61",
    "snippet": "void Initialize(RandomNumberGenerator &rng, unsigned int modulusBits)\n\t\t{GenerateRandomWithKeySize(rng, modulusBits);}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateRandomWithKeySize",
          "args": [
            "rng",
            "modulusBits"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateRandomWithKeySize",
          "container": "GeneratableCryptoMaterial",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "658-661",
          "snippet": "void GeneratableCryptoMaterial::GenerateRandomWithKeySize(RandomNumberGenerator &rng, unsigned int keySize)\n{\n\tGenerateRandom(rng, MakeParameters(\"KeySize\", (int)keySize));\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nGeneratableCryptoMaterial {\n  void GeneratableCryptoMaterial::GenerateRandomWithKeySize(RandomNumberGenerator &rng, unsigned int keySize)\n  {\n  \tGenerateRandom(rng, MakeParameters(\"KeySize\", (int)keySize));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nInvertibleESIGNFunction {\n  void Initialize(RandomNumberGenerator &rng, unsigned int modulusBits)\n  \t\t{GenerateRandomWithKeySize(rng, modulusBits);}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "InvertibleESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "57-58",
    "snippet": "void Initialize(const Integer &n, const Integer &e, const Integer &p, const Integer &q)\n\t\t{m_n = n; m_e = e; m_p = p; m_q = q;}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nInvertibleESIGNFunction {\n  void Initialize(const Integer &n, const Integer &e, const Integer &p, const Integer &q)\n  \t\t{m_n = n; m_e = e; m_p = p; m_q = q;}\n}"
  },
  {
    "function_name": "GetK",
    "container": "ESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "46-46",
    "snippet": "unsigned int GetK() const {return m_n.BitCount()/3-1;}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_n.BitCount",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "BitCount",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3054-3061",
          "snippet": "unsigned int Integer::BitCount() const\n{\n\tunsigned wordCount = WordCount();\n\tif (wordCount)\n\t\treturn (wordCount-1)*WORD_BITS + BitPrecision(reg[wordCount-1]);\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  unsigned int Integer::BitCount() const\n  {\n  \tunsigned wordCount = WordCount();\n  \tif (wordCount)\n  \t\treturn (wordCount-1)*WORD_BITS + BitPrecision(reg[wordCount-1]);\n  \telse\n  \t\treturn 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nESIGNFunction {\n  unsigned int GetK() const {return m_n.BitCount()/3-1;}\n}"
  },
  {
    "function_name": "SetPublicExponent",
    "container": "ESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "43-43",
    "snippet": "void SetPublicExponent(const Integer &e) {m_e = e;}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nESIGNFunction {\n  void SetPublicExponent(const Integer &e) {m_e = e;}\n}"
  },
  {
    "function_name": "SetModulus",
    "container": "ESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "42-42",
    "snippet": "void SetModulus(const Integer &n) {m_n = n;}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nESIGNFunction {\n  void SetModulus(const Integer &n) {m_n = n;}\n}"
  },
  {
    "function_name": "ImageBound",
    "container": "ESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "36-36",
    "snippet": "Integer ImageBound() const {return Integer::Power2(GetK());}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Integer::Power2",
          "args": [
            "GetK()"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "Power2",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "2846-2851",
          "snippet": "Integer Integer::Power2(size_t e)\n{\n\tInteger r((word)0, BitsToWords(e+1));\n\tr.SetBit(e);\n\treturn r;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  Integer Integer::Power2(size_t e)\n  {\n  \tInteger r((word)0, BitsToWords(e+1));\n  \tr.SetBit(e);\n  \treturn r;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetK",
          "args": [],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "GetK",
          "container": "ESIGNFunction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
          "lines": "46-46",
          "snippet": "unsigned int GetK() const {return m_n.BitCount()/3-1;}",
          "includes": [
            "#include \"asn.h\"",
            "#include \"integer.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nESIGNFunction {\n  unsigned int GetK() const {return m_n.BitCount()/3-1;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nESIGNFunction {\n  Integer ImageBound() const {return Integer::Power2(GetK());}\n}"
  },
  {
    "function_name": "PreimageBound",
    "container": "ESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "35-35",
    "snippet": "Integer PreimageBound() const {return m_n;}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nESIGNFunction {\n  Integer PreimageBound() const {return m_n;}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "ESIGNFunction",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/esign.h",
    "lines": "21-22",
    "snippet": "void Initialize(const Integer &n, const Integer &e)\n\t\t{m_n = n; m_e = e;}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"integer.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nESIGNFunction {\n  void Initialize(const Integer &n, const Integer &e)\n  \t\t{m_n = n; m_e = e;}\n}"
  }
]