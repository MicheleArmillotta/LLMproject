[
  {
    "function_name": "CBC_MAC_Base::ProcessBuf",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cbcmac.cpp",
    "lines": "54-58",
    "snippet": "void CBC_MAC_Base::ProcessBuf()\n{\n\tAccessCipher().ProcessBlock(m_reg);\n\tm_counter = 0;\n}",
    "includes": [
      "#include \"cbcmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [
            "m_reg"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cbcmac.h\"\n#include \"pch.h\"\n\nvoid CBC_MAC_Base::ProcessBuf()\n{\n\tAccessCipher().ProcessBlock(m_reg);\n\tm_counter = 0;\n}"
  },
  {
    "function_name": "CBC_MAC_Base::TruncatedFinal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cbcmac.cpp",
    "lines": "43-52",
    "snippet": "void CBC_MAC_Base::TruncatedFinal(byte *mac, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tif (m_counter)\n\t\tProcessBuf();\n\n\tmemcpy(mac, m_reg, size);\n\tmemset(m_reg, 0, AccessCipher().BlockSize());\n}",
    "includes": [
      "#include \"cbcmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "m_reg",
            "0",
            "AccessCipher().BlockSize()"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "mac",
            "m_reg",
            "size"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ProcessBuf",
          "args": [],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "CBC_MAC_Base::ProcessBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cbcmac.cpp",
          "lines": "54-58",
          "snippet": "void CBC_MAC_Base::ProcessBuf()\n{\n\tAccessCipher().ProcessBlock(m_reg);\n\tm_counter = 0;\n}",
          "includes": [
            "#include \"cbcmac.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cbcmac.h\"\n#include \"pch.h\"\n\nvoid CBC_MAC_Base::ProcessBuf()\n{\n\tAccessCipher().ProcessBlock(m_reg);\n\tm_counter = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ThrowIfInvalidTruncatedSize",
          "args": [
            "size"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "HashTransformation::ThrowIfInvalidTruncatedSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "309-313",
          "snippet": "void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cbcmac.h\"\n#include \"pch.h\"\n\nvoid CBC_MAC_Base::TruncatedFinal(byte *mac, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tif (m_counter)\n\t\tProcessBuf();\n\n\tmemcpy(mac, m_reg, size);\n\tmemset(m_reg, 0, AccessCipher().BlockSize());\n}"
  },
  {
    "function_name": "CBC_MAC_Base::Update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cbcmac.cpp",
    "lines": "16-41",
    "snippet": "void CBC_MAC_Base::Update(const byte *input, size_t length)\n{\n\tunsigned int blockSize = AccessCipher().BlockSize();\n\n\twhile (m_counter && length)\n\t{\n\t\tm_reg[m_counter++] ^= *input++;\n\t\tif (m_counter == blockSize)\n\t\t\tProcessBuf();\n\t\tlength--;\n\t}\n\n\tif (length >= blockSize)\n\t{\n\t\tsize_t leftOver = AccessCipher().AdvancedProcessBlocks(m_reg, input, m_reg, length, BlockTransformation::BT_DontIncrementInOutPointers|BlockTransformation::BT_XorInput);\n\t\tinput += (length - leftOver);\n\t\tlength = leftOver;\n\t}\n\n\twhile (length--)\n\t{\n\t\tm_reg[m_counter++] ^= *input++;\n\t\tif (m_counter == blockSize)\n\t\t\tProcessBuf();\n\t}\n}",
    "includes": [
      "#include \"cbcmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ProcessBuf",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "CBC_MAC_Base::ProcessBuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cbcmac.cpp",
          "lines": "54-58",
          "snippet": "void CBC_MAC_Base::ProcessBuf()\n{\n\tAccessCipher().ProcessBlock(m_reg);\n\tm_counter = 0;\n}",
          "includes": [
            "#include \"cbcmac.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cbcmac.h\"\n#include \"pch.h\"\n\nvoid CBC_MAC_Base::ProcessBuf()\n{\n\tAccessCipher().ProcessBlock(m_reg);\n\tm_counter = 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [
            "m_reg",
            "input",
            "m_reg",
            "length",
            "BlockTransformation::BT_DontIncrementInOutPointers|BlockTransformation::BT_XorInput"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cbcmac.h\"\n#include \"pch.h\"\n\nvoid CBC_MAC_Base::Update(const byte *input, size_t length)\n{\n\tunsigned int blockSize = AccessCipher().BlockSize();\n\n\twhile (m_counter && length)\n\t{\n\t\tm_reg[m_counter++] ^= *input++;\n\t\tif (m_counter == blockSize)\n\t\t\tProcessBuf();\n\t\tlength--;\n\t}\n\n\tif (length >= blockSize)\n\t{\n\t\tsize_t leftOver = AccessCipher().AdvancedProcessBlocks(m_reg, input, m_reg, length, BlockTransformation::BT_DontIncrementInOutPointers|BlockTransformation::BT_XorInput);\n\t\tinput += (length - leftOver);\n\t\tlength = leftOver;\n\t}\n\n\twhile (length--)\n\t{\n\t\tm_reg[m_counter++] ^= *input++;\n\t\tif (m_counter == blockSize)\n\t\t\tProcessBuf();\n\t}\n}"
  },
  {
    "function_name": "CBC_MAC_Base::UncheckedSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cbcmac.cpp",
    "lines": "9-14",
    "snippet": "void CBC_MAC_Base::UncheckedSetKey(const byte *key, unsigned int length, const NameValuePairs &params)\n{\n\tAccessCipher().SetKey(key, length, params);\n\tm_reg.CleanNew(AccessCipher().BlockSize());\n\tm_counter = 0;\n}",
    "includes": [
      "#include \"cbcmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_reg.CleanNew",
          "args": [
            "AccessCipher().BlockSize()"
          ],
          "line": 12
        },
        "resolved": true,
        "details": {
          "function_name": "CleanNew",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "368-372",
          "snippet": "void CleanNew(size_type newSize)\n\t{\n\t\tNew(newSize);\n\t\tmemset_z(m_ptr, 0, m_size*sizeof(T));\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void CleanNew(size_type newSize)\n  \t{\n  \t\tNew(newSize);\n  \t\tmemset_z(m_ptr, 0, m_size*sizeof(T));\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 12
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 12
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [
            "key",
            "length",
            "params"
          ],
          "line": 11
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessCipher",
          "args": [],
          "line": 11
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cbcmac.h\"\n#include \"pch.h\"\n\nvoid CBC_MAC_Base::UncheckedSetKey(const byte *key, unsigned int length, const NameValuePairs &params)\n{\n\tAccessCipher().SetKey(key, length, params);\n\tm_reg.CleanNew(AccessCipher().BlockSize());\n\tm_counter = 0;\n}"
  }
]