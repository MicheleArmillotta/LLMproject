[
  {
    "function_name": "IsolatedInitialize",
    "container": "Base64Encoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/base64.cpp",
    "lines": "12-27",
    "snippet": "void Base64Encoder::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tbool insertLineBreaks = parameters.GetValueWithDefault(Name::InsertLineBreaks(), true);\n\tint maxLineLength = parameters.GetIntValueWithDefault(Name::MaxLineLength(), 72);\n\n\tconst char *lineBreak = insertLineBreaks ? \"\\n\" : \"\";\n\t\n\tm_filter->Initialize(CombinedNameValuePairs(\n\t\tparameters,\n\t\tMakeParameters(Name::EncodingLookupArray(), &s_vec[0], false)\n\t\t\t(Name::PaddingByte(), s_padding)\n\t\t\t(Name::GroupSize(), insertLineBreaks ? maxLineLength : 0)\n\t\t\t(Name::Separator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Terminator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Log2Base(), 6, true)));\n}",
    "includes": [
      "#include \"base64.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const byte s_vec[] =\n\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";",
      "static const byte s_padding = '=';"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->Initialize",
          "args": [
            "CombinedNameValuePairs(\n\t\tparameters,\n\t\tMakeParameters(Name::EncodingLookupArray(), &s_vec[0], false)\n\t\t\t(Name::PaddingByte(), s_padding)\n\t\t\t(Name::GroupSize(), insertLineBreaks ? maxLineLength : 0)\n\t\t\t(Name::Separator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Terminator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Log2Base(), 6, true))"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "Initialize",
          "container": "DL_GroupParameters_EC<EC>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eccrypto.cpp",
          "lines": "422-444",
          "snippet": "void DL_GroupParameters_EC<EC>::Initialize(const OID &oid)\n{\n\tconst EcRecommendedParameters<EllipticCurve> *begin, *end;\n\tGetRecommendedParameters(begin, end);\n\tconst EcRecommendedParameters<EllipticCurve> *it = std::lower_bound(begin, end, oid, OIDLessThan());\n\tif (it == end || it->oid != oid)\n\t\tthrow UnknownOID();\n\n\tconst EcRecommendedParameters<EllipticCurve> &param = *it;\n\tm_oid = oid;\n\tstd::auto_ptr<EllipticCurve> ec(param.NewEC());\n\tthis->m_groupPrecomputation.SetCurve(*ec);\n\n\tStringSource ssG(param.g, true, new HexDecoder);\n\tElement G;\n\tbool result = GetCurve().DecodePoint(G, ssG, (size_t)ssG.MaxRetrievable());\n\tthis->SetSubgroupGenerator(G);\n\tassert(result);\n\n\tStringSource ssN(param.n, true, new HexDecoder);\n\tm_n.Decode(ssN, (size_t)ssN.MaxRetrievable());\n\tm_k = param.h;\n}",
          "includes": [
            "#include \"ec2n.h\"",
            "#include \"argnames.h\"",
            "#include \"hex.h\"",
            "#include \"oids.h\"",
            "#include \"nbtheory.h\"",
            "#include \"eccrypto.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ec2n.h\"\n#include \"argnames.h\"\n#include \"hex.h\"\n#include \"oids.h\"\n#include \"nbtheory.h\"\n#include \"eccrypto.h\"\n#include \"pch.h\"\n\nDL_GroupParameters_EC<EC> {\n  void DL_GroupParameters_EC<EC>::Initialize(const OID &oid)\n  {\n  \tconst EcRecommendedParameters<EllipticCurve> *begin, *end;\n  \tGetRecommendedParameters(begin, end);\n  \tconst EcRecommendedParameters<EllipticCurve> *it = std::lower_bound(begin, end, oid, OIDLessThan());\n  \tif (it == end || it->oid != oid)\n  \t\tthrow UnknownOID();\n  \n  \tconst EcRecommendedParameters<EllipticCurve> &param = *it;\n  \tm_oid = oid;\n  \tstd::auto_ptr<EllipticCurve> ec(param.NewEC());\n  \tthis->m_groupPrecomputation.SetCurve(*ec);\n  \n  \tStringSource ssG(param.g, true, new HexDecoder);\n  \tElement G;\n  \tbool result = GetCurve().DecodePoint(G, ssG, (size_t)ssG.MaxRetrievable());\n  \tthis->SetSubgroupGenerator(G);\n  \tassert(result);\n  \n  \tStringSource ssN(param.n, true, new HexDecoder);\n  \tm_n.Decode(ssN, (size_t)ssN.MaxRetrievable());\n  \tm_k = param.h;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CombinedNameValuePairs",
          "args": [
            "parameters",
            "MakeParameters(Name::EncodingLookupArray(), &s_vec[0], false)\n\t\t\t(Name::PaddingByte(), s_padding)\n\t\t\t(Name::GroupSize(), insertLineBreaks ? maxLineLength : 0)\n\t\t\t(Name::Separator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Terminator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Log2Base(), 6, true)"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::Log2Base()",
            "6",
            "true"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Log2Base",
          "args": [],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::Terminator()",
            "ConstByteArrayParameter(lineBreak)"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ConstByteArrayParameter",
          "args": [
            "lineBreak"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "ConstByteArrayParameter",
          "container": "ConstByteArrayParameter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "24-28",
          "snippet": "ConstByteArrayParameter(const T &string, bool deepCopy = false)\n\t{\n        CRYPTOPP_COMPILE_ASSERT(sizeof(CPP_TYPENAME T::value_type) == 1);\n\t\tAssign((const byte *)string.data(), string.size(), deepCopy);\n\t}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nConstByteArrayParameter {\n  ConstByteArrayParameter(const T &string, bool deepCopy = false)\n  \t{\n          CRYPTOPP_COMPILE_ASSERT(sizeof(CPP_TYPENAME T::value_type) == 1);\n  \t\tAssign((const byte *)string.data(), string.size(), deepCopy);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::Terminator",
          "args": [],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Separator",
          "args": [],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::GroupSize",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::PaddingByte",
          "args": [],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::EncodingLookupArray()",
            "&s_vec[0]",
            "false"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::EncodingLookupArray",
          "args": [],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetIntValueWithDefault",
          "args": [
            "Name::MaxLineLength()",
            "72"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::MaxLineLength",
          "args": [],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::InsertLineBreaks()",
            "true"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::InsertLineBreaks",
          "args": [],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base64.h\"\n#include \"pch.h\"\n\nstatic const byte s_vec[] =\n\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\nstatic const byte s_padding = '=';\n\nBase64Encoder {\n  void Base64Encoder::IsolatedInitialize(const NameValuePairs &parameters)\n  {\n  \tbool insertLineBreaks = parameters.GetValueWithDefault(Name::InsertLineBreaks(), true);\n  \tint maxLineLength = parameters.GetIntValueWithDefault(Name::MaxLineLength(), 72);\n  \n  \tconst char *lineBreak = insertLineBreaks ? \"\\n\" : \"\";\n  \t\n  \tm_filter->Initialize(CombinedNameValuePairs(\n  \t\tparameters,\n  \t\tMakeParameters(Name::EncodingLookupArray(), &s_vec[0], false)\n  \t\t\t(Name::PaddingByte(), s_padding)\n  \t\t\t(Name::GroupSize(), insertLineBreaks ? maxLineLength : 0)\n  \t\t\t(Name::Separator(), ConstByteArrayParameter(lineBreak))\n  \t\t\t(Name::Terminator(), ConstByteArrayParameter(lineBreak))\n  \t\t\t(Name::Log2Base(), 6, true)));\n  }\n}"
  }
]