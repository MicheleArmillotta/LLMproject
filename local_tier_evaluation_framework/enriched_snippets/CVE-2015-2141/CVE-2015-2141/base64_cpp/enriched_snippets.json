[
  {
    "function_name": "Base64Encoder::IsolatedInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/base64.cpp",
    "lines": "12-27",
    "snippet": "void Base64Encoder::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tbool insertLineBreaks = parameters.GetValueWithDefault(Name::InsertLineBreaks(), true);\n\tint maxLineLength = parameters.GetIntValueWithDefault(Name::MaxLineLength(), 72);\n\n\tconst char *lineBreak = insertLineBreaks ? \"\\n\" : \"\";\n\t\n\tm_filter->Initialize(CombinedNameValuePairs(\n\t\tparameters,\n\t\tMakeParameters(Name::EncodingLookupArray(), &s_vec[0], false)\n\t\t\t(Name::PaddingByte(), s_padding)\n\t\t\t(Name::GroupSize(), insertLineBreaks ? maxLineLength : 0)\n\t\t\t(Name::Separator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Terminator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Log2Base(), 6, true)));\n}",
    "includes": [
      "#include \"base64.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const byte s_vec[] =\n\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";",
      "static const byte s_padding = '=';"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->Initialize",
          "args": [
            "CombinedNameValuePairs(\n\t\tparameters,\n\t\tMakeParameters(Name::EncodingLookupArray(), &s_vec[0], false)\n\t\t\t(Name::PaddingByte(), s_padding)\n\t\t\t(Name::GroupSize(), insertLineBreaks ? maxLineLength : 0)\n\t\t\t(Name::Separator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Terminator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Log2Base(), 6, true))"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CombinedNameValuePairs",
          "args": [
            "parameters",
            "MakeParameters(Name::EncodingLookupArray(), &s_vec[0], false)\n\t\t\t(Name::PaddingByte(), s_padding)\n\t\t\t(Name::GroupSize(), insertLineBreaks ? maxLineLength : 0)\n\t\t\t(Name::Separator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Terminator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Log2Base(), 6, true)"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::Log2Base()",
            "6",
            "true"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Log2Base",
          "args": [],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::Terminator()",
            "ConstByteArrayParameter(lineBreak)"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ConstByteArrayParameter",
          "args": [
            "lineBreak"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Terminator",
          "args": [],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ConstByteArrayParameter",
          "args": [
            "lineBreak"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Separator",
          "args": [],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::GroupSize",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::PaddingByte",
          "args": [],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::EncodingLookupArray()",
            "&s_vec[0]",
            "false"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::EncodingLookupArray",
          "args": [],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetIntValueWithDefault",
          "args": [
            "Name::MaxLineLength()",
            "72"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::MaxLineLength",
          "args": [],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::InsertLineBreaks()",
            "true"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::InsertLineBreaks",
          "args": [],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base64.h\"\n#include \"pch.h\"\n\nstatic const byte s_vec[] =\n\t\t\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\nstatic const byte s_padding = '=';\n\nvoid Base64Encoder::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tbool insertLineBreaks = parameters.GetValueWithDefault(Name::InsertLineBreaks(), true);\n\tint maxLineLength = parameters.GetIntValueWithDefault(Name::MaxLineLength(), 72);\n\n\tconst char *lineBreak = insertLineBreaks ? \"\\n\" : \"\";\n\t\n\tm_filter->Initialize(CombinedNameValuePairs(\n\t\tparameters,\n\t\tMakeParameters(Name::EncodingLookupArray(), &s_vec[0], false)\n\t\t\t(Name::PaddingByte(), s_padding)\n\t\t\t(Name::GroupSize(), insertLineBreaks ? maxLineLength : 0)\n\t\t\t(Name::Separator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Terminator(), ConstByteArrayParameter(lineBreak))\n\t\t\t(Name::Log2Base(), 6, true)));\n}"
  }
]