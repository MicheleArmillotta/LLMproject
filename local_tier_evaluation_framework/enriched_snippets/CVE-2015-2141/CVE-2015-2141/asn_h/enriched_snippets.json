[
  {
    "function_name": "BERDecodeUnsigned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
    "lines": "326-356",
    "snippet": "void BERDecodeUnsigned(BufferedTransformation &in, T &w, byte asnTag = INTEGER,\n\t\t\t\t\t   T minValue = 0, T maxValue = 0xffffffff)\n{\n\tbyte b;\n\tif (!in.Get(b) || b != asnTag)\n\t\tBERDecodeError();\n\n\tsize_t bc;\n\tBERLengthDecode(in, bc);\n\n\tSecByteBlock buf(bc);\n\n\tif (bc != in.Get(buf, bc))\n\t\tBERDecodeError();\n\n\tconst byte *ptr = buf;\n\twhile (bc > sizeof(w) && *ptr == 0)\n\t{\n\t\tbc--;\n\t\tptr++;\n\t}\n\tif (bc > sizeof(w))\n\t\tBERDecodeError();\n\n\tw = 0;\n\tfor (unsigned int i=0; i<bc; i++)\n\t\tw = (w << 8) | ptr[i];\n\n\tif (w < minValue || w > maxValue)\n\t\tBERDecodeError();\n}",
    "includes": [
      "#include <vector>",
      "#include \"queue.h\"",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "CRYPTOPP_DLL void CRYPTOPP_API BERDecodeNull(BufferedTransformation &in);",
      "CRYPTOPP_DLL size_t CRYPTOPP_API DEREncodeTextString(BufferedTransformation &out, const std::string &str, byte asnTag);",
      "CRYPTOPP_DLL size_t CRYPTOPP_API BERDecodeTextString(BufferedTransformation &in, std::string &str, byte asnTag);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "BERDecodeError",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "BERDecodeError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
          "lines": "49-49",
          "snippet": "inline void BERDecodeError() {throw BERDecodeErr();}",
          "includes": [
            "#include <vector>",
            "#include \"queue.h\"",
            "#include \"filters.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\ninline void BERDecodeError() {throw BERDecodeErr();}"
        }
      },
      {
        "call_info": {
          "callee": "in.Get",
          "args": [
            "buf",
            "bc"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "88-93",
          "snippet": "inline size_t Get(byte *outString, size_t getMax)\n\t{\n\t\tsize_t len = Peek(outString, getMax);\n\t\tm_head += len;\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Get(byte *outString, size_t getMax)\n  \t{\n  \t\tsize_t len = Peek(outString, getMax);\n  \t\tm_head += len;\n  \t\treturn len;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BERLengthDecode",
          "args": [
            "in",
            "bc"
          ],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "BERLengthDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.cpp",
          "lines": "75-84",
          "snippet": "bool BERLengthDecode(BufferedTransformation &bt, size_t &length)\n{\n\tlword lw;\n\tbool definiteLength;\n\tif (!BERLengthDecode(bt, lw, definiteLength))\n\t\tBERDecodeError();\n\tif (!SafeConvert(lw, length))\n\t\tBERDecodeError();\n\treturn definiteLength;\n}",
          "includes": [
            "#include <time.h>",
            "#include <iomanip>",
            "#include \"asn.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <iomanip>\n#include \"asn.h\"\n#include \"pch.h\"\n\nbool BERLengthDecode(BufferedTransformation &bt, size_t &length)\n{\n\tlword lw;\n\tbool definiteLength;\n\tif (!BERLengthDecode(bt, lw, definiteLength))\n\t\tBERDecodeError();\n\tif (!SafeConvert(lw, length))\n\t\tBERDecodeError();\n\treturn definiteLength;\n}"
        }
      },
      {
        "call_info": {
          "callee": "in.Get",
          "args": [
            "b"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\nCRYPTOPP_DLL void CRYPTOPP_API BERDecodeNull(BufferedTransformation &in);\nCRYPTOPP_DLL size_t CRYPTOPP_API DEREncodeTextString(BufferedTransformation &out, const std::string &str, byte asnTag);\nCRYPTOPP_DLL size_t CRYPTOPP_API BERDecodeTextString(BufferedTransformation &in, std::string &str, byte asnTag);\n\nvoid BERDecodeUnsigned(BufferedTransformation &in, T &w, byte asnTag = INTEGER,\n\t\t\t\t\t   T minValue = 0, T maxValue = 0xffffffff)\n{\n\tbyte b;\n\tif (!in.Get(b) || b != asnTag)\n\t\tBERDecodeError();\n\n\tsize_t bc;\n\tBERLengthDecode(in, bc);\n\n\tSecByteBlock buf(bc);\n\n\tif (bc != in.Get(buf, bc))\n\t\tBERDecodeError();\n\n\tconst byte *ptr = buf;\n\twhile (bc > sizeof(w) && *ptr == 0)\n\t{\n\t\tbc--;\n\t\tptr++;\n\t}\n\tif (bc > sizeof(w))\n\t\tBERDecodeError();\n\n\tw = 0;\n\tfor (unsigned int i=0; i<bc; i++)\n\t\tw = (w << 8) | ptr[i];\n\n\tif (w < minValue || w > maxValue)\n\t\tBERDecodeError();\n}"
  },
  {
    "function_name": "DEREncodeUnsigned",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
    "lines": "296-320",
    "snippet": "size_t DEREncodeUnsigned(BufferedTransformation &out, T w, byte asnTag = INTEGER)\n{\n\tbyte buf[sizeof(w)+1];\n\tunsigned int bc;\n\tif (asnTag == BOOLEAN)\n\t{\n\t\tbuf[sizeof(w)] = w ? 0xff : 0;\n\t\tbc = 1;\n\t}\n\telse\n\t{\n\t\tbuf[0] = 0;\n\t\tfor (unsigned int i=0; i<sizeof(w); i++)\n\t\t\tbuf[i+1] = byte(w >> (sizeof(w)-1-i)*8);\n\t\tbc = sizeof(w);\n\t\twhile (bc > 1 && buf[sizeof(w)+1-bc] == 0)\n\t\t\t--bc;\n\t\tif (buf[sizeof(w)+1-bc] & 0x80)\n\t\t\t++bc;\n\t}\n\tout.Put(asnTag);\n\tsize_t lengthBytes = DERLengthEncode(out, bc);\n\tout.Put(buf+sizeof(w)+1-bc, bc);\n\treturn 1+lengthBytes+bc;\n}",
    "includes": [
      "#include <vector>",
      "#include \"queue.h\"",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "CRYPTOPP_DLL void CRYPTOPP_API DEREncodeNull(BufferedTransformation &out);",
      "CRYPTOPP_DLL size_t CRYPTOPP_API DEREncodeTextString(BufferedTransformation &out, const std::string &str, byte asnTag);",
      "CRYPTOPP_DLL size_t CRYPTOPP_API BERDecodeTextString(BufferedTransformation &in, std::string &str, byte asnTag);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "out.Put",
          "args": [
            "buf+sizeof(w)+1-bc",
            "bc"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "42-49",
          "snippet": "inline size_t Put(const byte *begin, size_t length)\n\t{\n\t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n\t\tif (buf+m_tail != begin)\n\t\t\tmemcpy(buf+m_tail, begin, l);\n\t\tm_tail += l;\n\t\treturn l;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Put(const byte *begin, size_t length)\n  \t{\n  \t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n  \t\tif (buf+m_tail != begin)\n  \t\t\tmemcpy(buf+m_tail, begin, l);\n  \t\tm_tail += l;\n  \t\treturn l;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DERLengthEncode",
          "args": [
            "out",
            "bc"
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "DERLengthEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.cpp",
          "lines": "16-35",
          "snippet": "size_t DERLengthEncode(BufferedTransformation &bt, lword length)\n{\n\tsize_t i=0;\n\tif (length <= 0x7f)\n\t{\n\t\tbt.Put(byte(length));\n\t\ti++;\n\t}\n\telse\n\t{\n\t\tbt.Put(byte(BytePrecision(length) | 0x80));\n\t\ti++;\n\t\tfor (int j=BytePrecision(length); j; --j)\n\t\t{\n\t\t\tbt.Put(byte(length >> (j-1)*8));\n\t\t\ti++;\n\t\t}\n\t}\n\treturn i;\n}",
          "includes": [
            "#include <time.h>",
            "#include <iomanip>",
            "#include \"asn.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <iomanip>\n#include \"asn.h\"\n#include \"pch.h\"\n\nsize_t DERLengthEncode(BufferedTransformation &bt, lword length)\n{\n\tsize_t i=0;\n\tif (length <= 0x7f)\n\t{\n\t\tbt.Put(byte(length));\n\t\ti++;\n\t}\n\telse\n\t{\n\t\tbt.Put(byte(BytePrecision(length) | 0x80));\n\t\ti++;\n\t\tfor (int j=BytePrecision(length); j; --j)\n\t\t{\n\t\t\tbt.Put(byte(length >> (j-1)*8));\n\t\t\ti++;\n\t\t}\n\t}\n\treturn i;\n}"
        }
      },
      {
        "call_info": {
          "callee": "out.Put",
          "args": [
            "asnTag"
          ],
          "line": 316
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "byte",
          "args": [
            "w >> (sizeof(w)-1-i)*8"
          ],
          "line": 309
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\nCRYPTOPP_DLL void CRYPTOPP_API DEREncodeNull(BufferedTransformation &out);\nCRYPTOPP_DLL size_t CRYPTOPP_API DEREncodeTextString(BufferedTransformation &out, const std::string &str, byte asnTag);\nCRYPTOPP_DLL size_t CRYPTOPP_API BERDecodeTextString(BufferedTransformation &in, std::string &str, byte asnTag);\n\nsize_t DEREncodeUnsigned(BufferedTransformation &out, T w, byte asnTag = INTEGER)\n{\n\tbyte buf[sizeof(w)+1];\n\tunsigned int bc;\n\tif (asnTag == BOOLEAN)\n\t{\n\t\tbuf[sizeof(w)] = w ? 0xff : 0;\n\t\tbc = 1;\n\t}\n\telse\n\t{\n\t\tbuf[0] = 0;\n\t\tfor (unsigned int i=0; i<sizeof(w); i++)\n\t\t\tbuf[i+1] = byte(w >> (sizeof(w)-1-i)*8);\n\t\tbc = sizeof(w);\n\t\twhile (bc > 1 && buf[sizeof(w)+1-bc] == 0)\n\t\t\t--bc;\n\t\tif (buf[sizeof(w)+1-bc] & 0x80)\n\t\t\t++bc;\n\t}\n\tout.Put(asnTag);\n\tsize_t lengthBytes = DERLengthEncode(out, bc);\n\tout.Put(buf+sizeof(w)+1-bc, bc);\n\treturn 1+lengthBytes+bc;\n}"
  },
  {
    "function_name": "DEREncode",
    "container": "ASNOptional",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
    "lines": "226-230",
    "snippet": "void DEREncode(BufferedTransformation &out)\n\t{\n\t\tif (this->get() != NULL)\n\t\t\tthis->get()->DEREncode(out);\n\t}",
    "includes": [
      "#include <vector>",
      "#include \"queue.h\"",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "CRYPTOPP_DLL void CRYPTOPP_API DEREncodeNull(BufferedTransformation &out);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->get",
          "args": [
            "out"
          ],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->get",
          "args": [],
          "line": 229
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->get",
          "args": [],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\nCRYPTOPP_DLL void CRYPTOPP_API DEREncodeNull(BufferedTransformation &out);\n\nASNOptional {\n  void DEREncode(BufferedTransformation &out)\n  \t{\n  \t\tif (this->get() != NULL)\n  \t\t\tthis->get()->DEREncode(out);\n  \t}\n}"
  },
  {
    "function_name": "BERDecode",
    "container": "ASNOptional",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
    "lines": "220-225",
    "snippet": "void BERDecode(BERSequenceDecoder &seqDecoder, byte tag, byte mask = ~CONSTRUCTED)\n\t{\n\t\tbyte b;\n\t\tif (seqDecoder.Peek(b) && (b & mask) == tag)\n\t\t\treset(new T(seqDecoder));\n\t}",
    "includes": [
      "#include <vector>",
      "#include \"queue.h\"",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reset",
          "args": [
            "new T(seqDecoder)"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "member_ptr<T>::reset",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "50-50",
          "snippet": "void member_ptr<T>::reset(T *p) {delete m_p; m_p = p;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvoid member_ptr<T>::reset(T *p) {delete m_p; m_p = p;}"
        }
      },
      {
        "call_info": {
          "callee": "seqDecoder.Peek",
          "args": [
            "b"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "Peek",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "51-58",
          "snippet": "inline size_t Peek(byte &outByte) const\n\t{\n\t\tif (m_tail==m_head)\n\t\t\treturn 0;\n\n\t\toutByte=buf[m_head];\n\t\treturn 1;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Peek(byte &outByte) const\n  \t{\n  \t\tif (m_tail==m_head)\n  \t\t\treturn 0;\n  \n  \t\toutByte=buf[m_head];\n  \t\treturn 1;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\nASNOptional {\n  void BERDecode(BERSequenceDecoder &seqDecoder, byte tag, byte mask = ~CONSTRUCTED)\n  \t{\n  \t\tbyte b;\n  \t\tif (seqDecoder.Peek(b) && (b & mask) == tag)\n  \t\t\treset(new T(seqDecoder));\n  \t}\n}"
  },
  {
    "function_name": "GetPositionOfObject",
    "container": "EncodedObjectFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
    "lines": "113-113",
    "snippet": "unsigned long GetPositionOfObject(unsigned int i) const {return m_positions[i];}",
    "includes": [
      "#include <vector>",
      "#include \"queue.h\"",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\nEncodedObjectFilter {\n  unsigned long GetPositionOfObject(unsigned int i) const {return m_positions[i];}\n}"
  },
  {
    "function_name": "GetNumberOfCompletedObjects",
    "container": "EncodedObjectFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
    "lines": "112-112",
    "snippet": "unsigned int GetNumberOfCompletedObjects() const {return m_nCurrentObject;}",
    "includes": [
      "#include <vector>",
      "#include \"queue.h\"",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\nEncodedObjectFilter {\n  unsigned int GetNumberOfCompletedObjects() const {return m_nCurrentObject;}\n}"
  },
  {
    "function_name": "BERDecodeError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
    "lines": "49-49",
    "snippet": "inline void BERDecodeError() {throw BERDecodeErr();}",
    "includes": [
      "#include <vector>",
      "#include \"queue.h\"",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "BERDecodeErr",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\ninline void BERDecodeError() {throw BERDecodeErr();}"
  }
]