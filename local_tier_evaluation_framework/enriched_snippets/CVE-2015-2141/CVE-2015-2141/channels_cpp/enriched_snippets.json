[
  {
    "function_name": "ChannelSwitch::RemoveRoute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "294-305",
    "snippet": "void ChannelSwitch::RemoveRoute(const std::string &inChannel, BufferedTransformation &destination, const std::string &outChannel)\n{\n\ttypedef ChannelSwitch::RouteMap::iterator MapIterator;\n\tpair<MapIterator, MapIterator> range = m_routeMap.equal_range(inChannel);\n\t\n\tfor (MapIterator it = range.first; it != range.second; ++it)\n\t\tif (it->second.first == &destination && it->second.second == outChannel)\n\t\t{\n\t\t\tm_routeMap.erase(it);\n\t\t\tbreak;\n\t\t}\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_routeMap.erase",
          "args": [
            "it"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_routeMap.equal_range",
          "args": [
            "inChannel"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::RemoveRoute(const std::string &inChannel, BufferedTransformation &destination, const std::string &outChannel)\n{\n\ttypedef ChannelSwitch::RouteMap::iterator MapIterator;\n\tpair<MapIterator, MapIterator> range = m_routeMap.equal_range(inChannel);\n\t\n\tfor (MapIterator it = range.first; it != range.second; ++it)\n\t\tif (it->second.first == &destination && it->second.second == outChannel)\n\t\t{\n\t\t\tm_routeMap.erase(it);\n\t\t\tbreak;\n\t\t}\n}"
  },
  {
    "function_name": "ChannelSwitch::AddRoute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "289-292",
    "snippet": "void ChannelSwitch::AddRoute(const std::string &inChannel, BufferedTransformation &destination, const std::string &outChannel)\n{\n\tm_routeMap.insert(RouteMap::value_type(inChannel, Route(&destination, outChannel)));\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_routeMap.insert",
          "args": [
            "RouteMap::value_type(inChannel, Route(&destination, outChannel))"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RouteMap::value_type",
          "args": [
            "inChannel",
            "Route(&destination, outChannel)"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Route",
          "args": [
            "&destination",
            "outChannel"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelSwitch::RemoveDefaultRoute",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
          "lines": "279-287",
          "snippet": "void ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}",
          "includes": [
            "#include \"channels.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::AddRoute(const std::string &inChannel, BufferedTransformation &destination, const std::string &outChannel)\n{\n\tm_routeMap.insert(RouteMap::value_type(inChannel, Route(&destination, outChannel)));\n}"
  },
  {
    "function_name": "ChannelSwitch::RemoveDefaultRoute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "279-287",
    "snippet": "void ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_defaultRoutes.erase",
          "args": [
            "it"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it->second.get",
          "args": [],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_defaultRoutes.end",
          "args": [],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "296-297",
          "snippet": "const_iterator end() const\n\t\t{return m_ptr+m_size;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator end() const\n  \t\t{return m_ptr+m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_defaultRoutes.begin",
          "args": [],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}"
  },
  {
    "function_name": "ChannelSwitch::AddDefaultRoute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "274-277",
    "snippet": "void ChannelSwitch::AddDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tm_defaultRoutes.push_back(DefaultRoute(&destination, outChannel));\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_defaultRoutes.push_back",
          "args": [
            "DefaultRoute(&destination, outChannel)"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DefaultRoute",
          "args": [
            "&destination",
            "outChannel"
          ],
          "line": 276
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelSwitch::RemoveDefaultRoute",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
          "lines": "279-287",
          "snippet": "void ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}",
          "includes": [
            "#include \"channels.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::AddDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tm_defaultRoutes.push_back(DefaultRoute(&destination, outChannel));\n}"
  },
  {
    "function_name": "ChannelSwitch::RemoveDefaultRoute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "264-272",
    "snippet": "void ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && !it->second.get())\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_defaultRoutes.erase",
          "args": [
            "it"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it->second.get",
          "args": [],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_defaultRoutes.end",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "296-297",
          "snippet": "const_iterator end() const\n\t\t{return m_ptr+m_size;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator end() const\n  \t\t{return m_ptr+m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_defaultRoutes.begin",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && !it->second.get())\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}"
  },
  {
    "function_name": "ChannelSwitch::AddDefaultRoute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "259-262",
    "snippet": "void ChannelSwitch::AddDefaultRoute(BufferedTransformation &destination)\n{\n\tm_defaultRoutes.push_back(DefaultRoute(&destination, value_ptr<std::string>(NULL)));\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_defaultRoutes.push_back",
          "args": [
            "DefaultRoute(&destination, value_ptr<std::string>(NULL))"
          ],
          "line": 261
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DefaultRoute",
          "args": [
            "&destination",
            "value_ptr<std::string>(NULL)"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelSwitch::RemoveDefaultRoute",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
          "lines": "279-287",
          "snippet": "void ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}",
          "includes": [
            "#include \"channels.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "value_ptr<std::string>",
          "args": [
            "NULL"
          ],
          "line": 261
        },
        "resolved": true,
        "details": {
          "function_name": "value_ptr",
          "container": "value_ptr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "59-60",
          "snippet": "value_ptr(const value_ptr<T>& rhs)\n\t\t: member_ptr<T>(rhs.m_p ? new T(*rhs.m_p) : NULL) {}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvalue_ptr {\n  value_ptr(const value_ptr<T>& rhs)\n  \t\t: member_ptr<T>(rhs.m_p ? new T(*rhs.m_p) : NULL) {}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::AddDefaultRoute(BufferedTransformation &destination)\n{\n\tm_defaultRoutes.push_back(DefaultRoute(&destination, value_ptr<std::string>(NULL)));\n}"
  },
  {
    "function_name": "ChannelSwitch::ChannelPutModifiable2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "242-257",
    "snippet": "size_t ChannelSwitch::ChannelPutModifiable2(const std::string &channel, byte *inString, size_t length, int messageEnd, bool blocking)\n{\n\tChannelRouteIterator it(*this);\n\tit.Reset(channel);\n\n\tif (!it.End())\n\t{\n\t\tBufferedTransformation &target = it.Destination();\n\t\tconst std::string &targetChannel = it.Channel();\n\t\tit.Next();\n\t\tif (it.End())\t// there is only one target channel\n\t\t\treturn target.ChannelPutModifiable2(targetChannel, inString, length, messageEnd, blocking);\n\t}\n\n\treturn ChannelPut2(channel, inString, length, messageEnd, blocking);\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChannelPut2",
          "args": [
            "channel",
            "inString",
            "length",
            "messageEnd",
            "blocking"
          ],
          "line": 256
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelSwitch::ChannelPut2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
          "lines": "145-168",
          "snippet": "size_t ChannelSwitch::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (m_blocked)\n\t{\n\t\tm_blocked = false;\n\t\tgoto WasBlocked;\n\t}\n\n\tm_it.Reset(channel);\n\n\twhile (!m_it.End())\n\t{\nWasBlocked:\n\t\tif (m_it.Destination().ChannelPut2(m_it.Channel(), begin, length, messageEnd, blocking))\n\t\t{\n\t\t\tm_blocked = true;\n\t\t\treturn 1;\n\t\t}\n\n\t\tm_it.Next();\n\t}\n\n\treturn 0;\n}",
          "includes": [
            "#include \"channels.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nsize_t ChannelSwitch::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (m_blocked)\n\t{\n\t\tm_blocked = false;\n\t\tgoto WasBlocked;\n\t}\n\n\tm_it.Reset(channel);\n\n\twhile (!m_it.End())\n\t{\nWasBlocked:\n\t\tif (m_it.Destination().ChannelPut2(m_it.Channel(), begin, length, messageEnd, blocking))\n\t\t{\n\t\t\tm_blocked = true;\n\t\t\treturn 1;\n\t\t}\n\n\t\tm_it.Next();\n\t}\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "target.ChannelPutModifiable2",
          "args": [
            "targetChannel",
            "inString",
            "length",
            "messageEnd",
            "blocking"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.End",
          "args": [],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.Next",
          "args": [],
          "line": 251
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.Channel",
          "args": [],
          "line": 250
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.Destination",
          "args": [],
          "line": 249
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.End",
          "args": [],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "it.Reset",
          "args": [
            "channel"
          ],
          "line": 245
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nsize_t ChannelSwitch::ChannelPutModifiable2(const std::string &channel, byte *inString, size_t length, int messageEnd, bool blocking)\n{\n\tChannelRouteIterator it(*this);\n\tit.Reset(channel);\n\n\tif (!it.End())\n\t{\n\t\tBufferedTransformation &target = it.Destination();\n\t\tconst std::string &targetChannel = it.Channel();\n\t\tit.Next();\n\t\tif (it.End())\t// there is only one target channel\n\t\t\treturn target.ChannelPutModifiable2(targetChannel, inString, length, messageEnd, blocking);\n\t}\n\n\treturn ChannelPut2(channel, inString, length, messageEnd, blocking);\n}"
  },
  {
    "function_name": "ChannelSwitch::ChannelMessageSeriesEnd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "202-225",
    "snippet": "bool ChannelSwitch::ChannelMessageSeriesEnd(const std::string &channel, int propagation, bool blocking)\n{\n\tif (m_blocked)\n\t{\n\t\tm_blocked = false;\n\t\tgoto WasBlocked;\n\t}\n\n\tm_it.Reset(channel);\n\n\twhile (!m_it.End())\n\t{\n\t  WasBlocked:\n\t\tif (m_it.Destination().ChannelMessageSeriesEnd(m_it.Channel(), propagation))\n\t\t{\n\t\t\tm_blocked = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tm_it.Next();\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_it.Next",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Destination",
          "args": [
            "m_it.Channel()",
            "propagation"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Channel",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Destination",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.End",
          "args": [],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Reset",
          "args": [
            "channel"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nbool ChannelSwitch::ChannelMessageSeriesEnd(const std::string &channel, int propagation, bool blocking)\n{\n\tif (m_blocked)\n\t{\n\t\tm_blocked = false;\n\t\tgoto WasBlocked;\n\t}\n\n\tm_it.Reset(channel);\n\n\twhile (!m_it.End())\n\t{\n\t  WasBlocked:\n\t\tif (m_it.Destination().ChannelMessageSeriesEnd(m_it.Channel(), propagation))\n\t\t{\n\t\t\tm_blocked = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tm_it.Next();\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "ChannelSwitch::ChannelFlush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "177-200",
    "snippet": "bool ChannelSwitch::ChannelFlush(const std::string &channel, bool completeFlush, int propagation, bool blocking)\n{\n\tif (m_blocked)\n\t{\n\t\tm_blocked = false;\n\t\tgoto WasBlocked;\n\t}\n\n\tm_it.Reset(channel);\n\n\twhile (!m_it.End())\n\t{\n\t  WasBlocked:\n\t\tif (m_it.Destination().ChannelFlush(m_it.Channel(), completeFlush, propagation, blocking))\n\t\t{\n\t\t\tm_blocked = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tm_it.Next();\n\t}\n\n\treturn false;\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_it.Next",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Destination",
          "args": [
            "m_it.Channel()",
            "completeFlush",
            "propagation",
            "blocking"
          ],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Channel",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Destination",
          "args": [],
          "line": 190
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.End",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Reset",
          "args": [
            "channel"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nbool ChannelSwitch::ChannelFlush(const std::string &channel, bool completeFlush, int propagation, bool blocking)\n{\n\tif (m_blocked)\n\t{\n\t\tm_blocked = false;\n\t\tgoto WasBlocked;\n\t}\n\n\tm_it.Reset(channel);\n\n\twhile (!m_it.End())\n\t{\n\t  WasBlocked:\n\t\tif (m_it.Destination().ChannelFlush(m_it.Channel(), completeFlush, propagation, blocking))\n\t\t{\n\t\t\tm_blocked = true;\n\t\t\treturn true;\n\t\t}\n\n\t\tm_it.Next();\n\t}\n\n\treturn false;\n}"
  },
  {
    "function_name": "ChannelSwitch::IsolatedInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "170-175",
    "snippet": "void ChannelSwitch::IsolatedInitialize(const NameValuePairs &parameters/* =g_nullNameValuePairs */)\n{\n\tm_routeMap.clear();\n\tm_defaultRoutes.clear();\n\tm_blocked = false;\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_defaultRoutes.clear",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_routeMap.clear",
          "args": [],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::IsolatedInitialize(const NameValuePairs &parameters/* =g_nullNameValuePairs */)\n{\n\tm_routeMap.clear();\n\tm_defaultRoutes.clear();\n\tm_blocked = false;\n}"
  },
  {
    "function_name": "ChannelSwitch::ChannelPut2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "145-168",
    "snippet": "size_t ChannelSwitch::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (m_blocked)\n\t{\n\t\tm_blocked = false;\n\t\tgoto WasBlocked;\n\t}\n\n\tm_it.Reset(channel);\n\n\twhile (!m_it.End())\n\t{\nWasBlocked:\n\t\tif (m_it.Destination().ChannelPut2(m_it.Channel(), begin, length, messageEnd, blocking))\n\t\t{\n\t\t\tm_blocked = true;\n\t\t\treturn 1;\n\t\t}\n\n\t\tm_it.Next();\n\t}\n\n\treturn 0;\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_it.Next",
          "args": [],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Destination",
          "args": [
            "m_it.Channel()",
            "begin",
            "length",
            "messageEnd",
            "blocking"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Channel",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Destination",
          "args": [],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.End",
          "args": [],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_it.Reset",
          "args": [
            "channel"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nsize_t ChannelSwitch::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (m_blocked)\n\t{\n\t\tm_blocked = false;\n\t\tgoto WasBlocked;\n\t}\n\n\tm_it.Reset(channel);\n\n\twhile (!m_it.End())\n\t{\nWasBlocked:\n\t\tif (m_it.Destination().ChannelPut2(m_it.Channel(), begin, length, messageEnd, blocking))\n\t\t{\n\t\t\tm_blocked = true;\n\t\t\treturn 1;\n\t\t}\n\n\t\tm_it.Next();\n\t}\n\n\treturn 0;\n}"
  },
  {
    "function_name": "ChannelRouteIterator::Next",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "119-125",
    "snippet": "void ChannelRouteIterator::Next()\n{\n\tif (m_useDefault)\n\t\t++m_itListCurrent;\n\telse\n\t\t++m_itMapCurrent;\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelRouteIterator::Next()\n{\n\tif (m_useDefault)\n\t\t++m_itListCurrent;\n\telse\n\t\t++m_itMapCurrent;\n}"
  },
  {
    "function_name": "ChannelRouteIterator::End",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "114-117",
    "snippet": "bool ChannelRouteIterator::End() const\n{\n\treturn m_useDefault ? m_itListCurrent == m_itListEnd : m_itMapCurrent == m_itMapEnd;\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nbool ChannelRouteIterator::End() const\n{\n\treturn m_useDefault ? m_itListCurrent == m_itListEnd : m_itMapCurrent == m_itMapEnd;\n}"
  },
  {
    "function_name": "ChannelRouteIterator::Reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "96-112",
    "snippet": "void ChannelRouteIterator::Reset(const std::string &channel)\n{\n\tm_channel = channel;\n\tpair<MapIterator, MapIterator> range = m_cs.m_routeMap.equal_range(channel);\n\tif (range.first == range.second)\n\t{\n\t\tm_useDefault = true;\n\t\tm_itListCurrent = m_cs.m_defaultRoutes.begin();\n\t\tm_itListEnd = m_cs.m_defaultRoutes.end();\n\t}\n\telse\n\t{\n\t\tm_useDefault = false;\n\t\tm_itMapCurrent = range.first;\n\t\tm_itMapEnd = range.second;\n\t}\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_cs.m_defaultRoutes.end",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "296-297",
          "snippet": "const_iterator end() const\n\t\t{return m_ptr+m_size;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator end() const\n  \t\t{return m_ptr+m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_cs.m_defaultRoutes.begin",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_cs.m_routeMap.equal_range",
          "args": [
            "channel"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelRouteIterator::Reset(const std::string &channel)\n{\n\tm_channel = channel;\n\tpair<MapIterator, MapIterator> range = m_cs.m_routeMap.equal_range(channel);\n\tif (range.first == range.second)\n\t{\n\t\tm_useDefault = true;\n\t\tm_itListCurrent = m_cs.m_defaultRoutes.begin();\n\t\tm_itListEnd = m_cs.m_defaultRoutes.end();\n\t}\n\telse\n\t{\n\t\tm_useDefault = false;\n\t\tm_itMapCurrent = range.first;\n\t\tm_itMapEnd = range.second;\n\t}\n}"
  },
  {
    "function_name": "MessageSwitch::AddRoute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "18-23",
    "snippet": "void MessageSwitch::AddRoute(unsigned int begin, unsigned int end, BufferedTransformation &destination, const std::string &channel)\n{\n\tRangeRoute route(begin, end, Route(&destination, channel));\n\tRouteList::iterator it = upper_bound(m_routes.begin(), m_routes.end(), route);\n\tm_routes.insert(it, route);\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_routes.insert",
          "args": [
            "it",
            "route"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "upper_bound",
          "args": [
            "m_routes.begin()",
            "m_routes.end()",
            "route"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_routes.end",
          "args": [],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "296-297",
          "snippet": "const_iterator end() const\n\t\t{return m_ptr+m_size;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator end() const\n  \t\t{return m_ptr+m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_routes.begin",
          "args": [],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Route",
          "args": [
            "&destination",
            "channel"
          ],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelSwitch::RemoveDefaultRoute",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
          "lines": "279-287",
          "snippet": "void ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}",
          "includes": [
            "#include \"channels.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid MessageSwitch::AddRoute(unsigned int begin, unsigned int end, BufferedTransformation &destination, const std::string &channel)\n{\n\tRangeRoute route(begin, end, Route(&destination, channel));\n\tRouteList::iterator it = upper_bound(m_routes.begin(), m_routes.end(), route);\n\tm_routes.insert(it, route);\n}"
  },
  {
    "function_name": "MessageSwitch::AddDefaultRoute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
    "lines": "13-16",
    "snippet": "void MessageSwitch::AddDefaultRoute(BufferedTransformation &destination, const std::string &channel)\n{\n\tm_defaultRoutes.push_back(Route(&destination, channel));\n}",
    "includes": [
      "#include \"channels.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_defaultRoutes.push_back",
          "args": [
            "Route(&destination, channel)"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Route",
          "args": [
            "&destination",
            "channel"
          ],
          "line": 15
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelSwitch::RemoveDefaultRoute",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/channels.cpp",
          "lines": "279-287",
          "snippet": "void ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}",
          "includes": [
            "#include \"channels.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid ChannelSwitch::RemoveDefaultRoute(BufferedTransformation &destination, const std::string &outChannel)\n{\n\tfor (DefaultRouteList::iterator it = m_defaultRoutes.begin(); it != m_defaultRoutes.end(); ++it)\n\t\tif (it->first == &destination && (it->second.get() && *it->second == outChannel))\n\t\t{\n\t\t\tm_defaultRoutes.erase(it);\n\t\t\tbreak;\n\t\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"channels.h\"\n#include \"pch.h\"\n\nvoid MessageSwitch::AddDefaultRoute(BufferedTransformation &destination, const std::string &channel)\n{\n\tm_defaultRoutes.push_back(Route(&destination, channel));\n}"
  }
]