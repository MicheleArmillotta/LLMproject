[
  {
    "function_name": "ProcessPoststreamTail",
    "container": "ZlibDecompressor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "81-88",
    "snippet": "void ZlibDecompressor::ProcessPoststreamTail()\n{\n\tFixedSizeSecBlock<byte, 4> adler32;\n\tif (m_inQueue.Get(adler32, 4) != 4)\n\t\tthrow Adler32Err();\n\tif (!m_adler32.Verify(adler32))\n\t\tthrow Adler32Err();\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Adler32Err",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "Adler32Err",
          "container": "ZlibDecompressor::Adler32Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "35-35",
          "snippet": "Adler32Err() : Err(DATA_INTEGRITY_CHECK_FAILED, \"ZlibDecompressor: ADLER32 check error\") {}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  Adler32Err {\n    Adler32Err() : Err(DATA_INTEGRITY_CHECK_FAILED, \"ZlibDecompressor: ADLER32 check error\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_adler32.Verify",
          "args": [
            "adler32"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "Verify",
          "container": "PK_Verifier",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "778-782",
          "snippet": "bool PK_Verifier::Verify(PK_MessageAccumulator *messageAccumulator) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn VerifyAndRestart(*m);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nPK_Verifier {\n  bool PK_Verifier::Verify(PK_MessageAccumulator *messageAccumulator) const\n  {\n  \tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n  \treturn VerifyAndRestart(*m);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.Get",
          "args": [
            "adler32",
            "4"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ByteQueue::Walker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "492-496",
          "snippet": "size_t ByteQueue::Walker::Get(byte *outString, size_t getMax)\n{\n\tArraySink sink(outString, getMax);\n\treturn (size_t)TransferTo(sink, getMax);\n}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueue {\n  Walker {\n    size_t ByteQueue::Walker::Get(byte *outString, size_t getMax)\n    {\n    \tArraySink sink(outString, getMax);\n    \treturn (size_t)TransferTo(sink, getMax);\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nZlibDecompressor {\n  void ZlibDecompressor::ProcessPoststreamTail()\n  {\n  \tFixedSizeSecBlock<byte, 4> adler32;\n  \tif (m_inQueue.Get(adler32, 4) != 4)\n  \t\tthrow Adler32Err();\n  \tif (!m_adler32.Verify(adler32))\n  \t\tthrow Adler32Err();\n  }\n}"
  },
  {
    "function_name": "ProcessDecompressedData",
    "container": "ZlibDecompressor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "75-79",
    "snippet": "void ZlibDecompressor::ProcessDecompressedData(const byte *inString, size_t length)\n{\n\tAttachedTransformation()->Put(inString, length);\n\tm_adler32.Update(inString, length);\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_adler32.Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "Adler32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/adler32.cpp",
          "lines": "8-54",
          "snippet": "void Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}",
          "includes": [
            "#include \"adler32.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"adler32.h\"\n#include \"pch.h\"\n\nAdler32 {\n  void Adler32::Update(const byte *input, size_t length)\n  {\n  \tconst unsigned long BASE = 65521;\n  \n  \tunsigned long s1 = m_s1;\n  \tunsigned long s2 = m_s2;\n  \n  \tif (length % 8 != 0)\n  \t{\n  \t\tdo\n  \t\t{\n  \t\t\ts1 += *input++;\n  \t\t\ts2 += s1;\n  \t\t\tlength--;\n  \t\t} while (length % 8 != 0);\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\ts2 %= BASE;\n  \t}\n  \n  \twhile (length > 0)\n  \t{\n  \t\ts1 += input[0]; s2 += s1;\n  \t\ts1 += input[1]; s2 += s1;\n  \t\ts1 += input[2]; s2 += s1;\n  \t\ts1 += input[3]; s2 += s1;\n  \t\ts1 += input[4]; s2 += s1;\n  \t\ts1 += input[5]; s2 += s1;\n  \t\ts1 += input[6]; s2 += s1;\n  \t\ts1 += input[7]; s2 += s1;\n  \n  \t\tlength -= 8;\n  \t\tinput += 8;\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\tif (length % 0x8000 == 0)\n  \t\t\ts2 %= BASE;\n  \t}\n  \n  \tassert(s1 < BASE);\n  \tassert(s2 < BASE);\n  \n  \tm_s1 = (word16)s1;\n  \tm_s2 = (word16)s2;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "length"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nZlibDecompressor {\n  void ZlibDecompressor::ProcessDecompressedData(const byte *inString, size_t length)\n  {\n  \tAttachedTransformation()->Put(inString, length);\n  \tm_adler32.Update(inString, length);\n  }\n}"
  },
  {
    "function_name": "ProcessPrestreamHeader",
    "container": "ZlibDecompressor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "53-73",
    "snippet": "void ZlibDecompressor::ProcessPrestreamHeader()\n{\n\tm_adler32.Restart();\n\n\tbyte cmf;\n\tbyte flags;\n\n\tif (!m_inQueue.Get(cmf) || !m_inQueue.Get(flags))\n\t\tthrow HeaderErr();\n\n\tif ((cmf*256+flags) % 31 != 0)\n\t\tthrow HeaderErr();\t// if you hit this exception, you're probably trying to decompress invalid data\n\n\tif ((cmf & 0xf) != DEFLATE_METHOD)\n\t\tthrow UnsupportedAlgorithm();\n\n\tif (flags & FDICT_FLAG)\n\t\tthrow UnsupportedPresetDictionary();\n\n\tm_log2WindowSize = 8 + (cmf >> 4);\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const byte DEFLATE_METHOD = 8;",
      "static const byte FDICT_FLAG = 1 << 5;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "UnsupportedPresetDictionary",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "UnsupportedPresetDictionary",
          "container": "ZlibDecompressor::UnsupportedPresetDictionary",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "37-37",
          "snippet": "UnsupportedPresetDictionary() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: unsupported preset dictionary\") {}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  UnsupportedPresetDictionary {\n    UnsupportedPresetDictionary() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: unsupported preset dictionary\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "UnsupportedAlgorithm",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "UnsupportedAlgorithm",
          "container": "ZlibDecompressor::UnsupportedAlgorithm",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "36-36",
          "snippet": "UnsupportedAlgorithm() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: unsupported algorithm\") {}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  UnsupportedAlgorithm {\n    UnsupportedAlgorithm() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: unsupported algorithm\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "HeaderErr",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "HeaderErr",
          "container": "ZlibDecompressor::HeaderErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "34-34",
          "snippet": "HeaderErr() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: header decoding error\") {}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  HeaderErr {\n    HeaderErr() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: header decoding error\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.Get",
          "args": [
            "flags"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_adler32.Restart",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "Restart",
          "container": "IteratedHashBase<T, BASE>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.cpp",
          "lines": "120-124",
          "snippet": "void IteratedHashBase<T, BASE>::Restart()\n{\n\tm_countLo = m_countHi = 0;\n\tInit();\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"iterhash.h\"\n\nIteratedHashBase<T, BASE> {\n  void IteratedHashBase<T, BASE>::Restart()\n  {\n  \tm_countLo = m_countHi = 0;\n  \tInit();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nstatic const byte DEFLATE_METHOD = 8;\nstatic const byte FDICT_FLAG = 1 << 5;\n\nZlibDecompressor {\n  void ZlibDecompressor::ProcessPrestreamHeader()\n  {\n  \tm_adler32.Restart();\n  \n  \tbyte cmf;\n  \tbyte flags;\n  \n  \tif (!m_inQueue.Get(cmf) || !m_inQueue.Get(flags))\n  \t\tthrow HeaderErr();\n  \n  \tif ((cmf*256+flags) % 31 != 0)\n  \t\tthrow HeaderErr();\t// if you hit this exception, you're probably trying to decompress invalid data\n  \n  \tif ((cmf & 0xf) != DEFLATE_METHOD)\n  \t\tthrow UnsupportedAlgorithm();\n  \n  \tif (flags & FDICT_FLAG)\n  \t\tthrow UnsupportedPresetDictionary();\n  \n  \tm_log2WindowSize = 8 + (cmf >> 4);\n  }\n}"
  },
  {
    "function_name": "ZlibDecompressor",
    "container": "ZlibDecompressor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "48-51",
    "snippet": "ZlibDecompressor::ZlibDecompressor(BufferedTransformation *attachment, bool repeat, int propagation)\n\t: Inflator(attachment, repeat, propagation)\n{\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nZlibDecompressor {\n  ZlibDecompressor::ZlibDecompressor(BufferedTransformation *attachment, bool repeat, int propagation)\n  \t: Inflator(attachment, repeat, propagation)\n  {\n  }\n}"
  },
  {
    "function_name": "GetCompressionLevel",
    "container": "ZlibCompressor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "40-44",
    "snippet": "unsigned int ZlibCompressor::GetCompressionLevel() const\n{\n\tstatic const unsigned int deflateToCompressionLevel[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};\n\treturn deflateToCompressionLevel[GetDeflateLevel()];\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDeflateLevel",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "GetDeflateLevel",
          "container": "Deflator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zdeflate.h",
          "lines": "69-69",
          "snippet": "int GetDeflateLevel() const {return m_deflateLevel;}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"filters.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"filters.h\"\n\nDeflator {\n  int GetDeflateLevel() const {return m_deflateLevel;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nZlibCompressor {\n  unsigned int ZlibCompressor::GetCompressionLevel() const\n  {\n  \tstatic const unsigned int deflateToCompressionLevel[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};\n  \treturn deflateToCompressionLevel[GetDeflateLevel()];\n  }\n}"
  },
  {
    "function_name": "WritePoststreamTail",
    "container": "ZlibCompressor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "33-38",
    "snippet": "void ZlibCompressor::WritePoststreamTail()\n{\n\tFixedSizeSecBlock<byte, 4> adler32;\n\tm_adler32.Final(adler32);\n\tAttachedTransformation()->Put(adler32, 4);\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "adler32",
            "4"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_adler32.Final",
          "args": [
            "adler32"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nZlibCompressor {\n  void ZlibCompressor::WritePoststreamTail()\n  {\n  \tFixedSizeSecBlock<byte, 4> adler32;\n  \tm_adler32.Final(adler32);\n  \tAttachedTransformation()->Put(adler32, 4);\n  }\n}"
  },
  {
    "function_name": "ProcessUncompressedData",
    "container": "ZlibCompressor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "28-31",
    "snippet": "void ZlibCompressor::ProcessUncompressedData(const byte *inString, size_t length)\n{\n\tm_adler32.Update(inString, length);\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_adler32.Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "Adler32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/adler32.cpp",
          "lines": "8-54",
          "snippet": "void Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}",
          "includes": [
            "#include \"adler32.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"adler32.h\"\n#include \"pch.h\"\n\nAdler32 {\n  void Adler32::Update(const byte *input, size_t length)\n  {\n  \tconst unsigned long BASE = 65521;\n  \n  \tunsigned long s1 = m_s1;\n  \tunsigned long s2 = m_s2;\n  \n  \tif (length % 8 != 0)\n  \t{\n  \t\tdo\n  \t\t{\n  \t\t\ts1 += *input++;\n  \t\t\ts2 += s1;\n  \t\t\tlength--;\n  \t\t} while (length % 8 != 0);\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\ts2 %= BASE;\n  \t}\n  \n  \twhile (length > 0)\n  \t{\n  \t\ts1 += input[0]; s2 += s1;\n  \t\ts1 += input[1]; s2 += s1;\n  \t\ts1 += input[2]; s2 += s1;\n  \t\ts1 += input[3]; s2 += s1;\n  \t\ts1 += input[4]; s2 += s1;\n  \t\ts1 += input[5]; s2 += s1;\n  \t\ts1 += input[6]; s2 += s1;\n  \t\ts1 += input[7]; s2 += s1;\n  \n  \t\tlength -= 8;\n  \t\tinput += 8;\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\tif (length % 0x8000 == 0)\n  \t\t\ts2 %= BASE;\n  \t}\n  \n  \tassert(s1 < BASE);\n  \tassert(s2 < BASE);\n  \n  \tm_s1 = (word16)s1;\n  \tm_s2 = (word16)s2;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nZlibCompressor {\n  void ZlibCompressor::ProcessUncompressedData(const byte *inString, size_t length)\n  {\n  \tm_adler32.Update(inString, length);\n  }\n}"
  },
  {
    "function_name": "WritePrestreamHeader",
    "container": "ZlibCompressor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "20-26",
    "snippet": "void ZlibCompressor::WritePrestreamHeader()\n{\n\tm_adler32.Restart();\n\tbyte cmf = DEFLATE_METHOD | ((GetLog2WindowSize()-8) << 4);\n\tbyte flags = GetCompressionLevel() << 6;\n\tAttachedTransformation()->PutWord16(RoundUpToMultipleOf(cmf*256+flags, 31));\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const byte DEFLATE_METHOD = 8;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "RoundUpToMultipleOf(cmf*256+flags, 31)"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RoundUpToMultipleOf",
          "args": [
            "cmf*256+flags",
            "31"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "RoundUpToMultipleOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "355-360",
          "snippet": "inline T1 RoundUpToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (n+m-1 < n)\n\t\tthrow InvalidArgument(\"RoundUpToMultipleOf: integer overflow\");\n\treturn RoundDownToMultipleOf(n+m-1, m);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 RoundUpToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (n+m-1 < n)\n\t\tthrow InvalidArgument(\"RoundUpToMultipleOf: integer overflow\");\n\treturn RoundDownToMultipleOf(n+m-1, m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetCompressionLevel",
          "args": [],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "GetCompressionLevel",
          "container": "ZlibCompressor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
          "lines": "40-44",
          "snippet": "unsigned int ZlibCompressor::GetCompressionLevel() const\n{\n\tstatic const unsigned int deflateToCompressionLevel[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};\n\treturn deflateToCompressionLevel[GetDeflateLevel()];\n}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"zlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nZlibCompressor {\n  unsigned int ZlibCompressor::GetCompressionLevel() const\n  {\n  \tstatic const unsigned int deflateToCompressionLevel[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};\n  \treturn deflateToCompressionLevel[GetDeflateLevel()];\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLog2WindowSize",
          "args": [],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "GetLog2WindowSize",
          "container": "ZlibDecompressor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "43-43",
          "snippet": "unsigned int GetLog2WindowSize() const {return m_log2WindowSize;}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  unsigned int GetLog2WindowSize() const {return m_log2WindowSize;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_adler32.Restart",
          "args": [],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "Restart",
          "container": "IteratedHashBase<T, BASE>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.cpp",
          "lines": "120-124",
          "snippet": "void IteratedHashBase<T, BASE>::Restart()\n{\n\tm_countLo = m_countHi = 0;\n\tInit();\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"iterhash.h\"\n\nIteratedHashBase<T, BASE> {\n  void IteratedHashBase<T, BASE>::Restart()\n  {\n  \tm_countLo = m_countHi = 0;\n  \tInit();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nstatic const byte DEFLATE_METHOD = 8;\n\nZlibCompressor {\n  void ZlibCompressor::WritePrestreamHeader()\n  {\n  \tm_adler32.Restart();\n  \tbyte cmf = DEFLATE_METHOD | ((GetLog2WindowSize()-8) << 4);\n  \tbyte flags = GetCompressionLevel() << 6;\n  \tAttachedTransformation()->PutWord16(RoundUpToMultipleOf(cmf*256+flags, 31));\n  }\n}"
  }
]