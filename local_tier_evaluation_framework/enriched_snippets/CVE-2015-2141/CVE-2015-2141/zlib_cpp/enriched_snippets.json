[
  {
    "function_name": "ZlibDecompressor::ProcessPoststreamTail",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "81-88",
    "snippet": "void ZlibDecompressor::ProcessPoststreamTail()\n{\n\tFixedSizeSecBlock<byte, 4> adler32;\n\tif (m_inQueue.Get(adler32, 4) != 4)\n\t\tthrow Adler32Err();\n\tif (!m_adler32.Verify(adler32))\n\t\tthrow Adler32Err();\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Adler32Err",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "Adler32Err",
          "container": "ZlibDecompressor::Adler32Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "35-35",
          "snippet": "Adler32Err() : Err(DATA_INTEGRITY_CHECK_FAILED, \"ZlibDecompressor: ADLER32 check error\") {}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  Adler32Err {\n    Adler32Err() : Err(DATA_INTEGRITY_CHECK_FAILED, \"ZlibDecompressor: ADLER32 check error\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_adler32.Verify",
          "args": [
            "adler32"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_inQueue.Get",
          "args": [
            "adler32",
            "4"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "88-93",
          "snippet": "inline size_t Get(byte *outString, size_t getMax)\n\t{\n\t\tsize_t len = Peek(outString, getMax);\n\t\tm_head += len;\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Get(byte *outString, size_t getMax)\n  \t{\n  \t\tsize_t len = Peek(outString, getMax);\n  \t\tm_head += len;\n  \t\treturn len;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nvoid ZlibDecompressor::ProcessPoststreamTail()\n{\n\tFixedSizeSecBlock<byte, 4> adler32;\n\tif (m_inQueue.Get(adler32, 4) != 4)\n\t\tthrow Adler32Err();\n\tif (!m_adler32.Verify(adler32))\n\t\tthrow Adler32Err();\n}"
  },
  {
    "function_name": "ZlibDecompressor::ProcessDecompressedData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "75-79",
    "snippet": "void ZlibDecompressor::ProcessDecompressedData(const byte *inString, size_t length)\n{\n\tAttachedTransformation()->Put(inString, length);\n\tm_adler32.Update(inString, length);\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_adler32.Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "length"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nvoid ZlibDecompressor::ProcessDecompressedData(const byte *inString, size_t length)\n{\n\tAttachedTransformation()->Put(inString, length);\n\tm_adler32.Update(inString, length);\n}"
  },
  {
    "function_name": "ZlibDecompressor::ProcessPrestreamHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "53-73",
    "snippet": "void ZlibDecompressor::ProcessPrestreamHeader()\n{\n\tm_adler32.Restart();\n\n\tbyte cmf;\n\tbyte flags;\n\n\tif (!m_inQueue.Get(cmf) || !m_inQueue.Get(flags))\n\t\tthrow HeaderErr();\n\n\tif ((cmf*256+flags) % 31 != 0)\n\t\tthrow HeaderErr();\t// if you hit this exception, you're probably trying to decompress invalid data\n\n\tif ((cmf & 0xf) != DEFLATE_METHOD)\n\t\tthrow UnsupportedAlgorithm();\n\n\tif (flags & FDICT_FLAG)\n\t\tthrow UnsupportedPresetDictionary();\n\n\tm_log2WindowSize = 8 + (cmf >> 4);\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const byte DEFLATE_METHOD = 8;",
      "static const byte FDICT_FLAG = 1 << 5;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "UnsupportedPresetDictionary",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "UnsupportedPresetDictionary",
          "container": "ZlibDecompressor::UnsupportedPresetDictionary",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "37-37",
          "snippet": "UnsupportedPresetDictionary() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: unsupported preset dictionary\") {}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  UnsupportedPresetDictionary {\n    UnsupportedPresetDictionary() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: unsupported preset dictionary\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "UnsupportedAlgorithm",
          "args": [],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "UnsupportedAlgorithm",
          "container": "ZlibDecompressor::UnsupportedAlgorithm",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "36-36",
          "snippet": "UnsupportedAlgorithm() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: unsupported algorithm\") {}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  UnsupportedAlgorithm {\n    UnsupportedAlgorithm() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: unsupported algorithm\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "HeaderErr",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "HeaderErr",
          "container": "ZlibDecompressor::HeaderErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "34-34",
          "snippet": "HeaderErr() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: header decoding error\") {}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  HeaderErr {\n    HeaderErr() : Err(INVALID_DATA_FORMAT, \"ZlibDecompressor: header decoding error\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.Get",
          "args": [
            "flags"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_adler32.Restart",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "Restart",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "55-59",
          "snippet": "void Restart()\n\t{\n\t\tm_hash.Restart();\n\t\tm_keyed = false;\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Restart()\n  \t{\n  \t\tm_hash.Restart();\n  \t\tm_keyed = false;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nstatic const byte DEFLATE_METHOD = 8;\nstatic const byte FDICT_FLAG = 1 << 5;\n\nvoid ZlibDecompressor::ProcessPrestreamHeader()\n{\n\tm_adler32.Restart();\n\n\tbyte cmf;\n\tbyte flags;\n\n\tif (!m_inQueue.Get(cmf) || !m_inQueue.Get(flags))\n\t\tthrow HeaderErr();\n\n\tif ((cmf*256+flags) % 31 != 0)\n\t\tthrow HeaderErr();\t// if you hit this exception, you're probably trying to decompress invalid data\n\n\tif ((cmf & 0xf) != DEFLATE_METHOD)\n\t\tthrow UnsupportedAlgorithm();\n\n\tif (flags & FDICT_FLAG)\n\t\tthrow UnsupportedPresetDictionary();\n\n\tm_log2WindowSize = 8 + (cmf >> 4);\n}"
  },
  {
    "function_name": "ZlibDecompressor::ZlibDecompressor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "48-51",
    "snippet": "ZlibDecompressor::ZlibDecompressor(BufferedTransformation *attachment, bool repeat, int propagation)\n\t: Inflator(attachment, repeat, propagation)\n{\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nZlibDecompressor::ZlibDecompressor(BufferedTransformation *attachment, bool repeat, int propagation)\n\t: Inflator(attachment, repeat, propagation)\n{\n}"
  },
  {
    "function_name": "ZlibCompressor::GetCompressionLevel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "40-44",
    "snippet": "unsigned int ZlibCompressor::GetCompressionLevel() const\n{\n\tstatic const unsigned int deflateToCompressionLevel[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};\n\treturn deflateToCompressionLevel[GetDeflateLevel()];\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetDeflateLevel",
          "args": [],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "GetDeflateLevel",
          "container": "Deflator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zdeflate.h",
          "lines": "69-69",
          "snippet": "int GetDeflateLevel() const {return m_deflateLevel;}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"filters.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"filters.h\"\n\nDeflator {\n  int GetDeflateLevel() const {return m_deflateLevel;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nunsigned int ZlibCompressor::GetCompressionLevel() const\n{\n\tstatic const unsigned int deflateToCompressionLevel[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};\n\treturn deflateToCompressionLevel[GetDeflateLevel()];\n}"
  },
  {
    "function_name": "ZlibCompressor::WritePoststreamTail",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "33-38",
    "snippet": "void ZlibCompressor::WritePoststreamTail()\n{\n\tFixedSizeSecBlock<byte, 4> adler32;\n\tm_adler32.Final(adler32);\n\tAttachedTransformation()->Put(adler32, 4);\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "adler32",
            "4"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_adler32.Final",
          "args": [
            "adler32"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nvoid ZlibCompressor::WritePoststreamTail()\n{\n\tFixedSizeSecBlock<byte, 4> adler32;\n\tm_adler32.Final(adler32);\n\tAttachedTransformation()->Put(adler32, 4);\n}"
  },
  {
    "function_name": "ZlibCompressor::ProcessUncompressedData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "28-31",
    "snippet": "void ZlibCompressor::ProcessUncompressedData(const byte *inString, size_t length)\n{\n\tm_adler32.Update(inString, length);\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_adler32.Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nvoid ZlibCompressor::ProcessUncompressedData(const byte *inString, size_t length)\n{\n\tm_adler32.Update(inString, length);\n}"
  },
  {
    "function_name": "ZlibCompressor::WritePrestreamHeader",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
    "lines": "20-26",
    "snippet": "void ZlibCompressor::WritePrestreamHeader()\n{\n\tm_adler32.Restart();\n\tbyte cmf = DEFLATE_METHOD | ((GetLog2WindowSize()-8) << 4);\n\tbyte flags = GetCompressionLevel() << 6;\n\tAttachedTransformation()->PutWord16(RoundUpToMultipleOf(cmf*256+flags, 31));\n}",
    "includes": [
      "#include \"zinflate.h\"",
      "#include \"zdeflate.h\"",
      "#include \"zlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const byte DEFLATE_METHOD = 8;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "RoundUpToMultipleOf(cmf*256+flags, 31)"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RoundUpToMultipleOf",
          "args": [
            "cmf*256+flags",
            "31"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "RoundUpToMultipleOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "355-360",
          "snippet": "inline T1 RoundUpToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (n+m-1 < n)\n\t\tthrow InvalidArgument(\"RoundUpToMultipleOf: integer overflow\");\n\treturn RoundDownToMultipleOf(n+m-1, m);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 RoundUpToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (n+m-1 < n)\n\t\tthrow InvalidArgument(\"RoundUpToMultipleOf: integer overflow\");\n\treturn RoundDownToMultipleOf(n+m-1, m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetCompressionLevel",
          "args": [],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "ZlibCompressor::GetCompressionLevel",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.cpp",
          "lines": "40-44",
          "snippet": "unsigned int ZlibCompressor::GetCompressionLevel() const\n{\n\tstatic const unsigned int deflateToCompressionLevel[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};\n\treturn deflateToCompressionLevel[GetDeflateLevel()];\n}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"zlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nunsigned int ZlibCompressor::GetCompressionLevel() const\n{\n\tstatic const unsigned int deflateToCompressionLevel[] = {0, 1, 1, 1, 2, 2, 2, 2, 2, 3};\n\treturn deflateToCompressionLevel[GetDeflateLevel()];\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLog2WindowSize",
          "args": [],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "GetLog2WindowSize",
          "container": "ZlibDecompressor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zlib.h",
          "lines": "43-43",
          "snippet": "unsigned int GetLog2WindowSize() const {return m_log2WindowSize;}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\"",
            "#include \"adler32.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"adler32.h\"\n\nZlibDecompressor {\n  unsigned int GetLog2WindowSize() const {return m_log2WindowSize;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_adler32.Restart",
          "args": [],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "Restart",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "55-59",
          "snippet": "void Restart()\n\t{\n\t\tm_hash.Restart();\n\t\tm_keyed = false;\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Restart()\n  \t{\n  \t\tm_hash.Restart();\n  \t\tm_keyed = false;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"zinflate.h\"\n#include \"zdeflate.h\"\n#include \"zlib.h\"\n#include \"pch.h\"\n\nstatic const byte DEFLATE_METHOD = 8;\n\nvoid ZlibCompressor::WritePrestreamHeader()\n{\n\tm_adler32.Restart();\n\tbyte cmf = DEFLATE_METHOD | ((GetLog2WindowSize()-8) << 4);\n\tbyte flags = GetCompressionLevel() << 6;\n\tAttachedTransformation()->PutWord16(RoundUpToMultipleOf(cmf*256+flags, 31));\n}"
  }
]