[
  {
    "function_name": "SEAL_Policy<B>::OperateKeystream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seal.cpp",
    "lines": "85-208",
    "snippet": "void SEAL_Policy<B>::OperateKeystream(KeystreamOperation operation, byte *output, const byte *input, size_t iterationCount)\n{\n\tword32 a, b, c, d, n1, n2, n3, n4;\n\tunsigned int p, q;\n\n\tfor (size_t iteration = 0; iteration < iterationCount; ++iteration)\n\t{\n#define Ttab(x) *(word32 *)((byte *)m_T.begin()+x)\n\n\t\ta = m_outsideCounter ^ m_R[4*m_insideCounter];\n\t\tb = rotrFixed(m_outsideCounter, 8U) ^ m_R[4*m_insideCounter+1];\n\t\tc = rotrFixed(m_outsideCounter, 16U) ^ m_R[4*m_insideCounter+2];\n\t\td = rotrFixed(m_outsideCounter, 24U) ^ m_R[4*m_insideCounter+3];\n\n\t\tfor (unsigned int j=0; j<2; j++)\n\t\t{\n\t\t\tp = a & 0x7fc;\n\t\t\tb += Ttab(p);\n\t\t\ta = rotrFixed(a, 9U);\n\n\t\t\tp = b & 0x7fc;\n\t\t\tc += Ttab(p);\n\t\t\tb = rotrFixed(b, 9U);\n\n\t\t\tp = c & 0x7fc;\n\t\t\td += Ttab(p);\n\t\t\tc = rotrFixed(c, 9U);\n\n\t\t\tp = d & 0x7fc;\n\t\t\ta += Ttab(p);\n\t\t\td = rotrFixed(d, 9U);\n\t\t}\n\n\t\tn1 = d, n2 = b, n3 = a, n4 = c;\n\n\t\tp = a & 0x7fc;\n\t\tb += Ttab(p);\n\t\ta = rotrFixed(a, 9U);\n\n\t\tp = b & 0x7fc;\n\t\tc += Ttab(p);\n\t\tb = rotrFixed(b, 9U);\n\n\t\tp = c & 0x7fc;\n\t\td += Ttab(p);\n\t\tc = rotrFixed(c, 9U);\n\n\t\tp = d & 0x7fc;\n\t\ta += Ttab(p);\n\t\td = rotrFixed(d, 9U);\n\t\t\n\t\t// generate 8192 bits\n\t\tfor (unsigned int i=0; i<64; i++)\n\t\t{\n\t\t\tp = a & 0x7fc;\n\t\t\ta = rotrFixed(a, 9U);\n\t\t\tb += Ttab(p);\n\t\t\tb ^= a;\n\n\t\t\tq = b & 0x7fc;\n\t\t\tb = rotrFixed(b, 9U);\n\t\t\tc ^= Ttab(q);\n\t\t\tc += b;\n\n\t\t\tp = (p+c) & 0x7fc;\n\t\t\tc = rotrFixed(c, 9U);\n\t\t\td += Ttab(p);\n\t\t\td ^= c;\n\n\t\t\tq = (q+d) & 0x7fc;\n\t\t\td = rotrFixed(d, 9U);\n\t\t\ta ^= Ttab(q);\n\t\t\ta += d;\n\n\t\t\tp = (p+a) & 0x7fc;\n\t\t\tb ^= Ttab(p);\n\t\t\ta = rotrFixed(a, 9U);\n\n\t\t\tq = (q+b) & 0x7fc;\n\t\t\tc += Ttab(q);\n\t\t\tb = rotrFixed(b, 9U);\n\n\t\t\tp = (p+c) & 0x7fc;\n\t\t\td ^= Ttab(p);\n\t\t\tc = rotrFixed(c, 9U);\n\n\t\t\tq = (q+d) & 0x7fc;\n\t\t\td = rotrFixed(d, 9U);\n\t\t\ta += Ttab(q);\n\n#define SEAL_OUTPUT(x)\t\\\n\tCRYPTOPP_KEYSTREAM_OUTPUT_WORD(x, B::ToEnum(), 0, b + m_S[4*i+0]);\\\n\tCRYPTOPP_KEYSTREAM_OUTPUT_WORD(x, B::ToEnum(), 1, c ^ m_S[4*i+1]);\\\n\tCRYPTOPP_KEYSTREAM_OUTPUT_WORD(x, B::ToEnum(), 2, d + m_S[4*i+2]);\\\n\tCRYPTOPP_KEYSTREAM_OUTPUT_WORD(x, B::ToEnum(), 3, a ^ m_S[4*i+3]);\n\n\t\t\tCRYPTOPP_KEYSTREAM_OUTPUT_SWITCH(SEAL_OUTPUT, 4*4);\n\n\t\t\tif (i & 1)\n\t\t\t{\n\t\t\t\ta += n3;\n\t\t\t\tb += n4;\n\t\t\t\tc ^= n3;\n\t\t\t\td ^= n4;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ta += n1;\n\t\t\t\tb += n2;        \n\t\t\t\tc ^= n1;\n\t\t\t\td ^= n2;\n\t\t\t}\n\t\t}\n\n\t\tif (++m_insideCounter == m_iterationsPerCount)\n\t\t{\n\t\t\t++m_outsideCounter;\n\t\t\tm_insideCounter = 0;\n\t\t}\n\t}\n\n\ta = b = c = d = n1 = n2 = n3 = n4 = 0;\n\tp = q = 0;\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"sha.h\"",
      "#include \"seal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_KEYSTREAM_OUTPUT_SWITCH",
          "args": [
            "SEAL_OUTPUT",
            "4*4"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "q"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rotrFixed",
          "args": [
            "d",
            "9U"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "rotrFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "586-590",
          "snippet": "inline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "q"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "q"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "q"
          ],
          "line": 146
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Ttab",
          "args": [
            "p"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"sha.h\"\n#include \"seal.h\"\n#include \"pch.h\"\n\nvoid SEAL_Policy<B>::OperateKeystream(KeystreamOperation operation, byte *output, const byte *input, size_t iterationCount)\n{\n\tword32 a, b, c, d, n1, n2, n3, n4;\n\tunsigned int p, q;\n\n\tfor (size_t iteration = 0; iteration < iterationCount; ++iteration)\n\t{\n#define Ttab(x) *(word32 *)((byte *)m_T.begin()+x)\n\n\t\ta = m_outsideCounter ^ m_R[4*m_insideCounter];\n\t\tb = rotrFixed(m_outsideCounter, 8U) ^ m_R[4*m_insideCounter+1];\n\t\tc = rotrFixed(m_outsideCounter, 16U) ^ m_R[4*m_insideCounter+2];\n\t\td = rotrFixed(m_outsideCounter, 24U) ^ m_R[4*m_insideCounter+3];\n\n\t\tfor (unsigned int j=0; j<2; j++)\n\t\t{\n\t\t\tp = a & 0x7fc;\n\t\t\tb += Ttab(p);\n\t\t\ta = rotrFixed(a, 9U);\n\n\t\t\tp = b & 0x7fc;\n\t\t\tc += Ttab(p);\n\t\t\tb = rotrFixed(b, 9U);\n\n\t\t\tp = c & 0x7fc;\n\t\t\td += Ttab(p);\n\t\t\tc = rotrFixed(c, 9U);\n\n\t\t\tp = d & 0x7fc;\n\t\t\ta += Ttab(p);\n\t\t\td = rotrFixed(d, 9U);\n\t\t}\n\n\t\tn1 = d, n2 = b, n3 = a, n4 = c;\n\n\t\tp = a & 0x7fc;\n\t\tb += Ttab(p);\n\t\ta = rotrFixed(a, 9U);\n\n\t\tp = b & 0x7fc;\n\t\tc += Ttab(p);\n\t\tb = rotrFixed(b, 9U);\n\n\t\tp = c & 0x7fc;\n\t\td += Ttab(p);\n\t\tc = rotrFixed(c, 9U);\n\n\t\tp = d & 0x7fc;\n\t\ta += Ttab(p);\n\t\td = rotrFixed(d, 9U);\n\t\t\n\t\t// generate 8192 bits\n\t\tfor (unsigned int i=0; i<64; i++)\n\t\t{\n\t\t\tp = a & 0x7fc;\n\t\t\ta = rotrFixed(a, 9U);\n\t\t\tb += Ttab(p);\n\t\t\tb ^= a;\n\n\t\t\tq = b & 0x7fc;\n\t\t\tb = rotrFixed(b, 9U);\n\t\t\tc ^= Ttab(q);\n\t\t\tc += b;\n\n\t\t\tp = (p+c) & 0x7fc;\n\t\t\tc = rotrFixed(c, 9U);\n\t\t\td += Ttab(p);\n\t\t\td ^= c;\n\n\t\t\tq = (q+d) & 0x7fc;\n\t\t\td = rotrFixed(d, 9U);\n\t\t\ta ^= Ttab(q);\n\t\t\ta += d;\n\n\t\t\tp = (p+a) & 0x7fc;\n\t\t\tb ^= Ttab(p);\n\t\t\ta = rotrFixed(a, 9U);\n\n\t\t\tq = (q+b) & 0x7fc;\n\t\t\tc += Ttab(q);\n\t\t\tb = rotrFixed(b, 9U);\n\n\t\t\tp = (p+c) & 0x7fc;\n\t\t\td ^= Ttab(p);\n\t\t\tc = rotrFixed(c, 9U);\n\n\t\t\tq = (q+d) & 0x7fc;\n\t\t\td = rotrFixed(d, 9U);\n\t\t\ta += Ttab(q);\n\n#define SEAL_OUTPUT(x)\t\\\n\tCRYPTOPP_KEYSTREAM_OUTPUT_WORD(x, B::ToEnum(), 0, b + m_S[4*i+0]);\\\n\tCRYPTOPP_KEYSTREAM_OUTPUT_WORD(x, B::ToEnum(), 1, c ^ m_S[4*i+1]);\\\n\tCRYPTOPP_KEYSTREAM_OUTPUT_WORD(x, B::ToEnum(), 2, d + m_S[4*i+2]);\\\n\tCRYPTOPP_KEYSTREAM_OUTPUT_WORD(x, B::ToEnum(), 3, a ^ m_S[4*i+3]);\n\n\t\t\tCRYPTOPP_KEYSTREAM_OUTPUT_SWITCH(SEAL_OUTPUT, 4*4);\n\n\t\t\tif (i & 1)\n\t\t\t{\n\t\t\t\ta += n3;\n\t\t\t\tb += n4;\n\t\t\t\tc ^= n3;\n\t\t\t\td ^= n4;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\ta += n1;\n\t\t\t\tb += n2;        \n\t\t\t\tc ^= n1;\n\t\t\t\td ^= n2;\n\t\t\t}\n\t\t}\n\n\t\tif (++m_insideCounter == m_iterationsPerCount)\n\t\t{\n\t\t\t++m_outsideCounter;\n\t\t\tm_insideCounter = 0;\n\t\t}\n\t}\n\n\ta = b = c = d = n1 = n2 = n3 = n4 = 0;\n\tp = q = 0;\n}"
  },
  {
    "function_name": "SEAL_Policy<B>::SeekToIteration",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seal.cpp",
    "lines": "78-82",
    "snippet": "void SEAL_Policy<B>::SeekToIteration(lword iterationCount)\n{\n\tm_outsideCounter = m_startCount + (unsigned int)(iterationCount / m_iterationsPerCount);\n\tm_insideCounter = (unsigned int)(iterationCount % m_iterationsPerCount);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"sha.h\"",
      "#include \"seal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"misc.h\"\n#include \"sha.h\"\n#include \"seal.h\"\n#include \"pch.h\"\n\nvoid SEAL_Policy<B>::SeekToIteration(lword iterationCount)\n{\n\tm_outsideCounter = m_startCount + (unsigned int)(iterationCount / m_iterationsPerCount);\n\tm_insideCounter = (unsigned int)(iterationCount % m_iterationsPerCount);\n}"
  },
  {
    "function_name": "SEAL_Policy<B>::CipherResynchronize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seal.cpp",
    "lines": "69-75",
    "snippet": "void SEAL_Policy<B>::CipherResynchronize(byte *keystreamBuffer, const byte *IV, size_t length)\n{\n\tassert(length==4);\n\tm_outsideCounter = IV ? GetWord<word32>(false, BIG_ENDIAN_ORDER, IV) : 0;\n\tm_startCount = m_outsideCounter;\n\tm_insideCounter = 0;\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"sha.h\"",
      "#include \"seal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetWord<word32>",
          "args": [
            "false",
            "BIG_ENDIAN_ORDER",
            "IV"
          ],
          "line": 72
        },
        "resolved": true,
        "details": {
          "function_name": "GetWord",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1127-1135",
          "snippet": "inline T GetWord(bool assumeAligned, ByteOrder order, const byte *block)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedGetWordNonTemplate(order, block, (T*)NULL);\n\tassert(IsAligned<T>(block));\n#endif\n\treturn ConditionalByteReverse(order, *reinterpret_cast<const T *>(block));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T GetWord(bool assumeAligned, ByteOrder order, const byte *block)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedGetWordNonTemplate(order, block, (T*)NULL);\n\tassert(IsAligned<T>(block));\n#endif\n\treturn ConditionalByteReverse(order, *reinterpret_cast<const T *>(block));\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length==4"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"sha.h\"\n#include \"seal.h\"\n#include \"pch.h\"\n\nvoid SEAL_Policy<B>::CipherResynchronize(byte *keystreamBuffer, const byte *IV, size_t length)\n{\n\tassert(length==4);\n\tm_outsideCounter = IV ? GetWord<word32>(false, BIG_ENDIAN_ORDER, IV) : 0;\n\tm_startCount = m_outsideCounter;\n\tm_insideCounter = 0;\n}"
  },
  {
    "function_name": "SEAL_Policy<B>::CipherSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seal.cpp",
    "lines": "46-66",
    "snippet": "void SEAL_Policy<B>::CipherSetKey(const NameValuePairs &params, const byte *key, size_t length)\n{\n\tm_insideCounter = m_outsideCounter = m_startCount = 0;\n\n\tunsigned int L = params.GetIntValueWithDefault(\"NumberOfOutputBitsPerPositionIndex\", 32*1024);\n\tm_iterationsPerCount = L / 8192;\n\n\tSEAL_Gamma gamma(key);\n\tunsigned int i;\n\n\tfor (i=0; i<512; i++)\n\t\tm_T[i] = gamma.Apply(i);\n\n\tfor (i=0; i<256; i++)\n\t\tm_S[i] = gamma.Apply(0x1000+i);\n\n\tm_R.New(4*(L/8192));\n\n\tfor (i=0; i<m_R.size(); i++)\n\t\tm_R[i] = gamma.Apply(0x2000+i);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"sha.h\"",
      "#include \"seal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gamma.Apply",
          "args": [
            "0x2000+i"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_R.size",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_R.New",
          "args": [
            "4*(L/8192)"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "New",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "361-365",
          "snippet": "void New(size_type newSize)\n\t{\n\t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n\t\tm_size = newSize;\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void New(size_type newSize)\n  \t{\n  \t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n  \t\tm_size = newSize;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "gamma.Apply",
          "args": [
            "0x1000+i"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gamma.Apply",
          "args": [
            "i"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.GetIntValueWithDefault",
          "args": [
            "\"NumberOfOutputBitsPerPositionIndex\"",
            "32*1024"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"sha.h\"\n#include \"seal.h\"\n#include \"pch.h\"\n\nvoid SEAL_Policy<B>::CipherSetKey(const NameValuePairs &params, const byte *key, size_t length)\n{\n\tm_insideCounter = m_outsideCounter = m_startCount = 0;\n\n\tunsigned int L = params.GetIntValueWithDefault(\"NumberOfOutputBitsPerPositionIndex\", 32*1024);\n\tm_iterationsPerCount = L / 8192;\n\n\tSEAL_Gamma gamma(key);\n\tunsigned int i;\n\n\tfor (i=0; i<512; i++)\n\t\tm_T[i] = gamma.Apply(i);\n\n\tfor (i=0; i<256; i++)\n\t\tm_S[i] = gamma.Apply(0x1000+i);\n\n\tm_R.New(4*(L/8192));\n\n\tfor (i=0; i<m_R.size(); i++)\n\t\tm_R[i] = gamma.Apply(0x2000+i);\n}"
  },
  {
    "function_name": "SEAL_Gamma::Apply",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seal.cpp",
    "lines": "32-43",
    "snippet": "word32 SEAL_Gamma::Apply(word32 i)\n{\n\tword32 shaIndex = i/5;\n\tif (shaIndex != lastIndex)\n\t{\n\t\tmemcpy(Z, H, 20);\n\t\tD[0] = shaIndex;\n\t\tSHA::Transform(Z, D);\n\t\tlastIndex = shaIndex;\n\t}\n\treturn Z[i%5];\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"sha.h\"",
      "#include \"seal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SHA::Transform",
          "args": [
            "Z",
            "D"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "Z",
            "H",
            "20"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"sha.h\"\n#include \"seal.h\"\n#include \"pch.h\"\n\nword32 SEAL_Gamma::Apply(word32 i)\n{\n\tword32 shaIndex = i/5;\n\tif (shaIndex != lastIndex)\n\t{\n\t\tmemcpy(Z, H, 20);\n\t\tD[0] = shaIndex;\n\t\tSHA::Transform(Z, D);\n\t\tlastIndex = shaIndex;\n\t}\n\treturn Z[i%5];\n}"
  },
  {
    "function_name": "SEAL_Gamma",
    "container": "SEAL_Gamma",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seal.cpp",
    "lines": "19-24",
    "snippet": "SEAL_Gamma(const byte *key)\n\t\t: H(5), Z(5), D(16), lastIndex(0xffffffff)\n\t{\n\t\tGetUserKey(BIG_ENDIAN_ORDER, H.begin(), 5, key, 20);\n\t\tmemset(D, 0, 64);\n\t}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"sha.h\"",
      "#include \"seal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "D",
            "0",
            "64"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetUserKey",
          "args": [
            "BIG_ENDIAN_ORDER",
            "H.begin()",
            "5",
            "key",
            "20"
          ],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "946-953",
          "snippet": "inline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [
            "#define memcpy_s CryptoPP::memcpy_s"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\n#define memcpy_s CryptoPP::memcpy_s\n\ninline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}"
        }
      },
      {
        "call_info": {
          "callee": "H.begin",
          "args": [],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"sha.h\"\n#include \"seal.h\"\n#include \"pch.h\"\n\nSEAL_Gamma {\n  SEAL_Gamma(const byte *key)\n  \t\t: H(5), Z(5), D(16), lastIndex(0xffffffff)\n  \t{\n  \t\tGetUserKey(BIG_ENDIAN_ORDER, H.begin(), 5, key, 20);\n  \t\tmemset(D, 0, 64);\n  \t}\n}"
  },
  {
    "function_name": "SEAL_TestInstantiations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seal.cpp",
    "lines": "12-15",
    "snippet": "void SEAL_TestInstantiations()\n{\n\tSEAL<>::Encryption x;\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"sha.h\"",
      "#include \"seal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"misc.h\"\n#include \"sha.h\"\n#include \"seal.h\"\n#include \"pch.h\"\n\nvoid SEAL_TestInstantiations()\n{\n\tSEAL<>::Encryption x;\n}"
  }
]