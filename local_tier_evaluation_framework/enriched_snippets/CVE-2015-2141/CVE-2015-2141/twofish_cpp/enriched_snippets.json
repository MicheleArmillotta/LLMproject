[
  {
    "function_name": "ProcessAndXorBlock",
    "container": "Twofish::Dec",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
    "lines": "139-166",
    "snippet": "void Twofish::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 x, y, a, b, c, d;\n\n\tBlock::Get(inBlock)(c)(d)(a)(b);\n\n\tc ^= m_k[4];\n\td ^= m_k[5];\n\ta ^= m_k[6];\n\tb ^= m_k[7];\n\n\tconst word32 *k = m_k+8;\n\tDECCYCLE (7);\n\tDECCYCLE (6);\n\tDECCYCLE (5);\n\tDECCYCLE (4);\n\tDECCYCLE (3);\n\tDECCYCLE (2);\n\tDECCYCLE (1);\n\tDECCYCLE (0);\n\n\ta ^= m_k[0];\n\tb ^= m_k[1];\n\tc ^= m_k[2];\n\td ^= m_k[3];\n\n\tBlock::Put(xorBlock, outBlock)(a)(b)(c)(d);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"twofish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "d"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DECCYCLE",
          "args": [
            "0"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECCYCLE",
          "args": [
            "1"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECCYCLE",
          "args": [
            "2"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECCYCLE",
          "args": [
            "3"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECCYCLE",
          "args": [
            "4"
          ],
          "line": 154
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECCYCLE",
          "args": [
            "5"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECCYCLE",
          "args": [
            "6"
          ],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DECCYCLE",
          "args": [
            "7"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "b"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nTwofish {\n  Dec {\n    void Twofish::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tword32 x, y, a, b, c, d;\n    \n    \tBlock::Get(inBlock)(c)(d)(a)(b);\n    \n    \tc ^= m_k[4];\n    \td ^= m_k[5];\n    \ta ^= m_k[6];\n    \tb ^= m_k[7];\n    \n    \tconst word32 *k = m_k+8;\n    \tDECCYCLE (7);\n    \tDECCYCLE (6);\n    \tDECCYCLE (5);\n    \tDECCYCLE (4);\n    \tDECCYCLE (3);\n    \tDECCYCLE (2);\n    \tDECCYCLE (1);\n    \tDECCYCLE (0);\n    \n    \ta ^= m_k[0];\n    \tb ^= m_k[1];\n    \tc ^= m_k[2];\n    \td ^= m_k[3];\n    \n    \tBlock::Put(xorBlock, outBlock)(a)(b)(c)(d);\n    }\n  }\n}"
  },
  {
    "function_name": "ProcessAndXorBlock",
    "container": "Twofish::Enc",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
    "lines": "110-137",
    "snippet": "void Twofish::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 x, y, a, b, c, d;\n\n\tBlock::Get(inBlock)(a)(b)(c)(d);\n\n\ta ^= m_k[0];\n\tb ^= m_k[1];\n\tc ^= m_k[2];\n\td ^= m_k[3];\n\n\tconst word32 *k = m_k+8;\n\tENCCYCLE (0);\n\tENCCYCLE (1);\n\tENCCYCLE (2);\n\tENCCYCLE (3);\n\tENCCYCLE (4);\n\tENCCYCLE (5);\n\tENCCYCLE (6);\n\tENCCYCLE (7);\n\n\tc ^= m_k[4];\n\td ^= m_k[5];\n\ta ^= m_k[6];\n\tb ^= m_k[7]; \n\n\tBlock::Put(xorBlock, outBlock)(c)(d)(a)(b);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"twofish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "b"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 136
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ENCCYCLE",
          "args": [
            "7"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENCCYCLE",
          "args": [
            "6"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENCCYCLE",
          "args": [
            "5"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENCCYCLE",
          "args": [
            "4"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENCCYCLE",
          "args": [
            "3"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENCCYCLE",
          "args": [
            "2"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENCCYCLE",
          "args": [
            "1"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ENCCYCLE",
          "args": [
            "0"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "d"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nTwofish {\n  Enc {\n    void Twofish::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tword32 x, y, a, b, c, d;\n    \n    \tBlock::Get(inBlock)(a)(b)(c)(d);\n    \n    \ta ^= m_k[0];\n    \tb ^= m_k[1];\n    \tc ^= m_k[2];\n    \td ^= m_k[3];\n    \n    \tconst word32 *k = m_k+8;\n    \tENCCYCLE (0);\n    \tENCCYCLE (1);\n    \tENCCYCLE (2);\n    \tENCCYCLE (3);\n    \tENCCYCLE (4);\n    \tENCCYCLE (5);\n    \tENCCYCLE (6);\n    \tENCCYCLE (7);\n    \n    \tc ^= m_k[4];\n    \td ^= m_k[5];\n    \ta ^= m_k[6];\n    \tb ^= m_k[7]; \n    \n    \tBlock::Put(xorBlock, outBlock)(c)(d)(a)(b);\n    }\n  }\n}"
  },
  {
    "function_name": "UncheckedSetKey",
    "container": "Twofish::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
    "lines": "52-80",
    "snippet": "void Twofish::Base::UncheckedSetKey(const byte *userKey, unsigned int keylength, const NameValuePairs &)\n{\n\tAssertValidKeyLength(keylength);\n\n\tunsigned int len = (keylength <= 16 ? 2 : (keylength <= 24 ? 3 : 4));\n\tSecBlock<word32> key(len*2);\n\tGetUserKey(LITTLE_ENDIAN_ORDER, key.begin(), len*2, userKey, keylength);\n\n\tunsigned int i;\n\tfor (i=0; i<40; i+=2)\n\t{\n\t\tword32 a = h(i, key, len);\n\t\tword32 b = rotlFixed(h(i+1, key+1, len), 8);\n\t\tm_k[i] = a+b;\n\t\tm_k[i+1] = rotlFixed(a+2*b, 9);\n\t}\n\n\tSecBlock<word32> svec(2*len);\n\tfor (i=0; i<len; i++)\n\t\tsvec[2*(len-i-1)] = ReedSolomon(key[2*i+1], key[2*i]);\n\tfor (i=0; i<256; i++)\n\t{\n\t\tword32 t = h0(i, svec, len);\n\t\tm_s[0*256+i] = mds[0][GETBYTE(t, 0)];\n\t\tm_s[1*256+i] = mds[1][GETBYTE(t, 1)];\n\t\tm_s[2*256+i] = mds[2][GETBYTE(t, 2)];\n\t\tm_s[3*256+i] = mds[3][GETBYTE(t, 3)];\n\t}\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"twofish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "t",
            "3"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "t",
            "2"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "t",
            "1"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "t",
            "0"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "h0",
          "args": [
            "i",
            "svec",
            "len"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "h0",
          "container": "Twofish::Base",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
          "lines": "32-44",
          "snippet": "inline word32 Twofish::Base::h0(word32 x, const word32 *key, unsigned int kLen)\n{\n\tx = x | (x<<8) | (x<<16) | (x<<24);\n\tswitch(kLen)\n\t{\n#define Q(a, b, c, d, t) q[a][GETBYTE(t,0)] ^ (q[b][GETBYTE(t,1)] << 8) ^ (q[c][GETBYTE(t,2)] << 16) ^ (q[d][GETBYTE(t,3)] << 24)\n\tcase 4: x = Q(1, 0, 0, 1, x) ^ key[6];\n\tcase 3: x = Q(1, 1, 0, 0, x) ^ key[4];\n\tcase 2: x = Q(0, 1, 0, 1, x) ^ key[2];\n\t\t\tx = Q(0, 0, 1, 1, x) ^ key[0];\n\t}\n\treturn x;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"twofish.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nTwofish {\n  Base {\n    inline word32 Twofish::Base::h0(word32 x, const word32 *key, unsigned int kLen)\n    {\n    \tx = x | (x<<8) | (x<<16) | (x<<24);\n    \tswitch(kLen)\n    \t{\n    #define Q(a, b, c, d, t) q[a][GETBYTE(t,0)] ^ (q[b][GETBYTE(t,1)] << 8) ^ (q[c][GETBYTE(t,2)] << 16) ^ (q[d][GETBYTE(t,3)] << 24)\n    \tcase 4: x = Q(1, 0, 0, 1, x) ^ key[6];\n    \tcase 3: x = Q(1, 1, 0, 0, x) ^ key[4];\n    \tcase 2: x = Q(0, 1, 0, 1, x) ^ key[2];\n    \t\t\tx = Q(0, 0, 1, 1, x) ^ key[0];\n    \t}\n    \treturn x;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ReedSolomon",
          "args": [
            "key[2*i+1]",
            "key[2*i]"
          ],
          "line": 71
        },
        "resolved": true,
        "details": {
          "function_name": "ReedSolomon",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
          "lines": "22-30",
          "snippet": "static word32 ReedSolomon(word32 high, word32 low)\n{\n\tfor (unsigned int i=0; i<8; i++)\n\t{\n\t\thigh = Mod(high>>24) ^ (high<<8) ^ (low>>24);\n\t\tlow <<= 8;\n\t}\n\treturn high;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"twofish.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nstatic word32 ReedSolomon(word32 high, word32 low)\n{\n\tfor (unsigned int i=0; i<8; i++)\n\t{\n\t\thigh = Mod(high>>24) ^ (high<<8) ^ (low>>24);\n\t\tlow <<= 8;\n\t}\n\treturn high;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "a+2*b",
            "9"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "h",
          "args": [
            "i+1",
            "key+1",
            "len"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "ProcessAndXorBlock",
          "container": "Twofish::Dec",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
          "lines": "139-166",
          "snippet": "void Twofish::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 x, y, a, b, c, d;\n\n\tBlock::Get(inBlock)(c)(d)(a)(b);\n\n\tc ^= m_k[4];\n\td ^= m_k[5];\n\ta ^= m_k[6];\n\tb ^= m_k[7];\n\n\tconst word32 *k = m_k+8;\n\tDECCYCLE (7);\n\tDECCYCLE (6);\n\tDECCYCLE (5);\n\tDECCYCLE (4);\n\tDECCYCLE (3);\n\tDECCYCLE (2);\n\tDECCYCLE (1);\n\tDECCYCLE (0);\n\n\ta ^= m_k[0];\n\tb ^= m_k[1];\n\tc ^= m_k[2];\n\td ^= m_k[3];\n\n\tBlock::Put(xorBlock, outBlock)(a)(b)(c)(d);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"twofish.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nTwofish {\n  Dec {\n    void Twofish::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tword32 x, y, a, b, c, d;\n    \n    \tBlock::Get(inBlock)(c)(d)(a)(b);\n    \n    \tc ^= m_k[4];\n    \td ^= m_k[5];\n    \ta ^= m_k[6];\n    \tb ^= m_k[7];\n    \n    \tconst word32 *k = m_k+8;\n    \tDECCYCLE (7);\n    \tDECCYCLE (6);\n    \tDECCYCLE (5);\n    \tDECCYCLE (4);\n    \tDECCYCLE (3);\n    \tDECCYCLE (2);\n    \tDECCYCLE (1);\n    \tDECCYCLE (0);\n    \n    \ta ^= m_k[0];\n    \tb ^= m_k[1];\n    \tc ^= m_k[2];\n    \td ^= m_k[3];\n    \n    \tBlock::Put(xorBlock, outBlock)(a)(b)(c)(d);\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserKey",
          "args": [
            "LITTLE_ENDIAN_ORDER",
            "key.begin()",
            "len*2",
            "userKey",
            "keylength"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "946-953",
          "snippet": "inline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [
            "#define memcpy_s CryptoPP::memcpy_s"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\n#define memcpy_s CryptoPP::memcpy_s\n\ninline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}"
        }
      },
      {
        "call_info": {
          "callee": "key.begin",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "keylength"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nTwofish {\n  Base {\n    void Twofish::Base::UncheckedSetKey(const byte *userKey, unsigned int keylength, const NameValuePairs &)\n    {\n    \tAssertValidKeyLength(keylength);\n    \n    \tunsigned int len = (keylength <= 16 ? 2 : (keylength <= 24 ? 3 : 4));\n    \tSecBlock<word32> key(len*2);\n    \tGetUserKey(LITTLE_ENDIAN_ORDER, key.begin(), len*2, userKey, keylength);\n    \n    \tunsigned int i;\n    \tfor (i=0; i<40; i+=2)\n    \t{\n    \t\tword32 a = h(i, key, len);\n    \t\tword32 b = rotlFixed(h(i+1, key+1, len), 8);\n    \t\tm_k[i] = a+b;\n    \t\tm_k[i+1] = rotlFixed(a+2*b, 9);\n    \t}\n    \n    \tSecBlock<word32> svec(2*len);\n    \tfor (i=0; i<len; i++)\n    \t\tsvec[2*(len-i-1)] = ReedSolomon(key[2*i+1], key[2*i]);\n    \tfor (i=0; i<256; i++)\n    \t{\n    \t\tword32 t = h0(i, svec, len);\n    \t\tm_s[0*256+i] = mds[0][GETBYTE(t, 0)];\n    \t\tm_s[1*256+i] = mds[1][GETBYTE(t, 1)];\n    \t\tm_s[2*256+i] = mds[2][GETBYTE(t, 2)];\n    \t\tm_s[3*256+i] = mds[3][GETBYTE(t, 3)];\n    \t}\n    }\n  }\n}"
  },
  {
    "function_name": "h",
    "container": "Twofish::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
    "lines": "46-50",
    "snippet": "inline word32 Twofish::Base::h(word32 x, const word32 *key, unsigned int kLen)\n{\n\tx = h0(x, key, kLen);\n\treturn mds[0][GETBYTE(x,0)] ^ mds[1][GETBYTE(x,1)] ^ mds[2][GETBYTE(x,2)] ^ mds[3][GETBYTE(x,3)];\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"twofish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "x",
            "3"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "x",
            "2"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "x",
            "1"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "x",
            "0"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "h0",
          "args": [
            "x",
            "key",
            "kLen"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "h0",
          "container": "Twofish::Base",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
          "lines": "32-44",
          "snippet": "inline word32 Twofish::Base::h0(word32 x, const word32 *key, unsigned int kLen)\n{\n\tx = x | (x<<8) | (x<<16) | (x<<24);\n\tswitch(kLen)\n\t{\n#define Q(a, b, c, d, t) q[a][GETBYTE(t,0)] ^ (q[b][GETBYTE(t,1)] << 8) ^ (q[c][GETBYTE(t,2)] << 16) ^ (q[d][GETBYTE(t,3)] << 24)\n\tcase 4: x = Q(1, 0, 0, 1, x) ^ key[6];\n\tcase 3: x = Q(1, 1, 0, 0, x) ^ key[4];\n\tcase 2: x = Q(0, 1, 0, 1, x) ^ key[2];\n\t\t\tx = Q(0, 0, 1, 1, x) ^ key[0];\n\t}\n\treturn x;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"twofish.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nTwofish {\n  Base {\n    inline word32 Twofish::Base::h0(word32 x, const word32 *key, unsigned int kLen)\n    {\n    \tx = x | (x<<8) | (x<<16) | (x<<24);\n    \tswitch(kLen)\n    \t{\n    #define Q(a, b, c, d, t) q[a][GETBYTE(t,0)] ^ (q[b][GETBYTE(t,1)] << 8) ^ (q[c][GETBYTE(t,2)] << 16) ^ (q[d][GETBYTE(t,3)] << 24)\n    \tcase 4: x = Q(1, 0, 0, 1, x) ^ key[6];\n    \tcase 3: x = Q(1, 1, 0, 0, x) ^ key[4];\n    \tcase 2: x = Q(0, 1, 0, 1, x) ^ key[2];\n    \t\t\tx = Q(0, 0, 1, 1, x) ^ key[0];\n    \t}\n    \treturn x;\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nTwofish {\n  Base {\n    inline word32 Twofish::Base::h(word32 x, const word32 *key, unsigned int kLen)\n    {\n    \tx = h0(x, key, kLen);\n    \treturn mds[0][GETBYTE(x,0)] ^ mds[1][GETBYTE(x,1)] ^ mds[2][GETBYTE(x,2)] ^ mds[3][GETBYTE(x,3)];\n    }\n  }\n}"
  },
  {
    "function_name": "h0",
    "container": "Twofish::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
    "lines": "32-44",
    "snippet": "inline word32 Twofish::Base::h0(word32 x, const word32 *key, unsigned int kLen)\n{\n\tx = x | (x<<8) | (x<<16) | (x<<24);\n\tswitch(kLen)\n\t{\n#define Q(a, b, c, d, t) q[a][GETBYTE(t,0)] ^ (q[b][GETBYTE(t,1)] << 8) ^ (q[c][GETBYTE(t,2)] << 16) ^ (q[d][GETBYTE(t,3)] << 24)\n\tcase 4: x = Q(1, 0, 0, 1, x) ^ key[6];\n\tcase 3: x = Q(1, 1, 0, 0, x) ^ key[4];\n\tcase 2: x = Q(0, 1, 0, 1, x) ^ key[2];\n\t\t\tx = Q(0, 0, 1, 1, x) ^ key[0];\n\t}\n\treturn x;\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"twofish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Q",
          "args": [
            "0",
            "0",
            "1",
            "1",
            "x"
          ],
          "line": 41
        },
        "resolved": true,
        "details": {
          "function_name": "CorrectQuotientEstimate",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "2536-2551",
          "snippet": "static void CorrectQuotientEstimate(word *R, word *T, word *Q, const word *B, size_t N)\n{\n\tassert(N && N%2==0);\n\n\tAsymmetricMultiply(T, T+N+2, Q, 2, B, N);\n\n\tword borrow = Subtract(R, R, T, N+2);\n\tassert(!borrow && !R[N+1]);\n\n\twhile (R[N] || Compare(R, B, N) >= 0)\n\t{\n\t\tR[N] -= Subtract(R, R, B, N);\n\t\tQ[1] += (++Q[0]==0);\n\t\tassert(Q[0] || Q[1]); // no overflow\n\t}\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nstatic void CorrectQuotientEstimate(word *R, word *T, word *Q, const word *B, size_t N)\n{\n\tassert(N && N%2==0);\n\n\tAsymmetricMultiply(T, T+N+2, Q, 2, B, N);\n\n\tword borrow = Subtract(R, R, T, N+2);\n\tassert(!borrow && !R[N+1]);\n\n\twhile (R[N] || Compare(R, B, N) >= 0)\n\t{\n\t\tR[N] -= Subtract(R, R, B, N);\n\t\tQ[1] += (++Q[0]==0);\n\t\tassert(Q[0] || Q[1]); // no overflow\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nTwofish {\n  Base {\n    inline word32 Twofish::Base::h0(word32 x, const word32 *key, unsigned int kLen)\n    {\n    \tx = x | (x<<8) | (x<<16) | (x<<24);\n    \tswitch(kLen)\n    \t{\n    #define Q(a, b, c, d, t) q[a][GETBYTE(t,0)] ^ (q[b][GETBYTE(t,1)] << 8) ^ (q[c][GETBYTE(t,2)] << 16) ^ (q[d][GETBYTE(t,3)] << 24)\n    \tcase 4: x = Q(1, 0, 0, 1, x) ^ key[6];\n    \tcase 3: x = Q(1, 1, 0, 0, x) ^ key[4];\n    \tcase 2: x = Q(0, 1, 0, 1, x) ^ key[2];\n    \t\t\tx = Q(0, 0, 1, 1, x) ^ key[0];\n    \t}\n    \treturn x;\n    }\n  }\n}"
  },
  {
    "function_name": "ReedSolomon",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
    "lines": "22-30",
    "snippet": "static word32 ReedSolomon(word32 high, word32 low)\n{\n\tfor (unsigned int i=0; i<8; i++)\n\t{\n\t\thigh = Mod(high>>24) ^ (high<<8) ^ (low>>24);\n\t\tlow <<= 8;\n\t}\n\treturn high;\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"twofish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Mod",
          "args": [
            "high>>24"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "Mod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
          "lines": "12-18",
          "snippet": "static inline unsigned int Mod(unsigned int c)\n{\n\tstatic const unsigned int modulus = 0x14d;\n\tunsigned int c2 = (c<<1) ^ ((c & 0x80) ? modulus : 0);\n\tunsigned int c1 = c2 ^ (c>>1) ^ ((c & 1) ? (modulus>>1) : 0);\n\treturn c | (c1 << 8) | (c2 << 16) | (c1 << 24);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"twofish.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nstatic inline unsigned int Mod(unsigned int c)\n{\n\tstatic const unsigned int modulus = 0x14d;\n\tunsigned int c2 = (c<<1) ^ ((c & 0x80) ? modulus : 0);\n\tunsigned int c1 = c2 ^ (c>>1) ^ ((c & 1) ? (modulus>>1) : 0);\n\treturn c | (c1 << 8) | (c2 << 16) | (c1 << 24);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nstatic word32 ReedSolomon(word32 high, word32 low)\n{\n\tfor (unsigned int i=0; i<8; i++)\n\t{\n\t\thigh = Mod(high>>24) ^ (high<<8) ^ (low>>24);\n\t\tlow <<= 8;\n\t}\n\treturn high;\n}"
  },
  {
    "function_name": "Mod",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/twofish.cpp",
    "lines": "12-18",
    "snippet": "static inline unsigned int Mod(unsigned int c)\n{\n\tstatic const unsigned int modulus = 0x14d;\n\tunsigned int c2 = (c<<1) ^ ((c & 0x80) ? modulus : 0);\n\tunsigned int c1 = c2 ^ (c>>1) ^ ((c & 1) ? (modulus>>1) : 0);\n\treturn c | (c1 << 8) | (c2 << 16) | (c1 << 24);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"twofish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"misc.h\"\n#include \"twofish.h\"\n#include \"pch.h\"\n\nstatic inline unsigned int Mod(unsigned int c)\n{\n\tstatic const unsigned int modulus = 0x14d;\n\tunsigned int c2 = (c<<1) ^ ((c & 0x80) ? modulus : 0);\n\tunsigned int c1 = c2 ^ (c>>1) ^ ((c & 1) ? (modulus>>1) : 0);\n\treturn c | (c1 << 8) | (c2 << 16) | (c1 << 24);\n}"
  }
]