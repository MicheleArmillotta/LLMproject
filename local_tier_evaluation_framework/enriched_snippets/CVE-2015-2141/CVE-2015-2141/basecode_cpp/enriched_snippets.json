[
  {
    "function_name": "IsolatedInitialize",
    "container": "Grouper",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/basecode.cpp",
    "lines": "190-203",
    "snippet": "void Grouper::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_groupSize = parameters.GetIntValueWithDefault(Name::GroupSize(), 0);\n\tConstByteArrayParameter separator, terminator;\n\tif (m_groupSize)\n\t\tparameters.GetRequiredParameter(\"Grouper\", Name::Separator(), separator);\n\telse\n\t\tparameters.GetValue(Name::Separator(), separator);\n\tparameters.GetValue(Name::Terminator(), terminator);\n\n\tm_separator.Assign(separator.begin(), separator.size());\n\tm_terminator.Assign(terminator.begin(), terminator.size());\n\tm_counter = 0;\n}",
    "includes": [
      "#include <ctype.h>",
      "#include \"fltrimpl.h\"",
      "#include \"basecode.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_terminator.Assign",
          "args": [
            "terminator.begin()",
            "terminator.size()"
          ],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "Assign",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "310-314",
          "snippet": "void Assign(const T *t, size_type len)\n\t{\n\t\tNew(len);\n\t\tmemcpy_s(m_ptr, m_size*sizeof(T), t, len*sizeof(T));\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void Assign(const T *t, size_type len)\n  \t{\n  \t\tNew(len);\n  \t\tmemcpy_s(m_ptr, m_size*sizeof(T), t, len*sizeof(T));\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "terminator.size",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "terminator.begin",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "parameters.GetValue",
          "args": [
            "Name::Terminator()",
            "terminator"
          ],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Terminator",
          "args": [],
          "line": 198
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValue",
          "args": [
            "Name::Separator()",
            "separator"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Separator",
          "args": [],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetRequiredParameter",
          "args": [
            "\"Grouper\"",
            "Name::Separator()",
            "separator"
          ],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Separator",
          "args": [],
          "line": 195
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetIntValueWithDefault",
          "args": [
            "Name::GroupSize()",
            "0"
          ],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::GroupSize",
          "args": [],
          "line": 192
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n#include \"fltrimpl.h\"\n#include \"basecode.h\"\n#include \"pch.h\"\n\nGrouper {\n  void Grouper::IsolatedInitialize(const NameValuePairs &parameters)\n  {\n  \tm_groupSize = parameters.GetIntValueWithDefault(Name::GroupSize(), 0);\n  \tConstByteArrayParameter separator, terminator;\n  \tif (m_groupSize)\n  \t\tparameters.GetRequiredParameter(\"Grouper\", Name::Separator(), separator);\n  \telse\n  \t\tparameters.GetValue(Name::Separator(), separator);\n  \tparameters.GetValue(Name::Terminator(), terminator);\n  \n  \tm_separator.Assign(separator.begin(), separator.size());\n  \tm_terminator.Assign(terminator.begin(), terminator.size());\n  \tm_counter = 0;\n  }\n}"
  },
  {
    "function_name": "InitializeDecodingLookupArray",
    "container": "BaseN_Decoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/basecode.cpp",
    "lines": "169-188",
    "snippet": "void BaseN_Decoder::InitializeDecodingLookupArray(int *lookup, const byte *alphabet, unsigned int base, bool caseInsensitive)\n{\n\tstd::fill(lookup, lookup+256, -1);\n\n\tfor (unsigned int i=0; i<base; i++)\n\t{\n\t\tif (caseInsensitive && isalpha(alphabet[i]))\n\t\t{\n\t\t\tassert(lookup[toupper(alphabet[i])] == -1);\n\t\t\tlookup[toupper(alphabet[i])] = i;\n\t\t\tassert(lookup[tolower(alphabet[i])] == -1);\n\t\t\tlookup[tolower(alphabet[i])] = i;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tassert(lookup[alphabet[i]] == -1);\n\t\t\tlookup[alphabet[i]] = i;\n\t\t}\n\t}\n}",
    "includes": [
      "#include <ctype.h>",
      "#include \"fltrimpl.h\"",
      "#include \"basecode.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "lookup[alphabet[i]] == -1"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tolower",
          "args": [
            "alphabet[i]"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "lookup[tolower(alphabet[i])] == -1"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tolower",
          "args": [
            "alphabet[i]"
          ],
          "line": 179
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "alphabet[i]"
          ],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "lookup[toupper(alphabet[i])] == -1"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "toupper",
          "args": [
            "alphabet[i]"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "isalpha",
          "args": [
            "alphabet[i]"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::fill",
          "args": [
            "lookup",
            "lookup+256",
            "-1"
          ],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n#include \"fltrimpl.h\"\n#include \"basecode.h\"\n#include \"pch.h\"\n\nBaseN_Decoder {\n  void BaseN_Decoder::InitializeDecodingLookupArray(int *lookup, const byte *alphabet, unsigned int base, bool caseInsensitive)\n  {\n  \tstd::fill(lookup, lookup+256, -1);\n  \n  \tfor (unsigned int i=0; i<base; i++)\n  \t{\n  \t\tif (caseInsensitive && isalpha(alphabet[i]))\n  \t\t{\n  \t\t\tassert(lookup[toupper(alphabet[i])] == -1);\n  \t\t\tlookup[toupper(alphabet[i])] = i;\n  \t\t\tassert(lookup[tolower(alphabet[i])] == -1);\n  \t\t\tlookup[tolower(alphabet[i])] = i;\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t\tassert(lookup[alphabet[i]] == -1);\n  \t\t\tlookup[alphabet[i]] = i;\n  \t\t}\n  \t}\n  }\n}"
  },
  {
    "function_name": "Put2",
    "container": "BaseN_Decoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/basecode.cpp",
    "lines": "124-167",
    "snippet": "size_t BaseN_Decoder::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tFILTER_BEGIN;\n\twhile (m_inputPosition < length)\n\t{\n\t\tunsigned int value;\n\t\tvalue = m_lookup[begin[m_inputPosition++]];\n\t\tif (value >= 256)\n\t\t\tcontinue;\n\n\t\tif (m_bytePos == 0 && m_bitPos == 0)\n\t\t\tmemset(m_outBuf, 0, m_outputBlockSize);\n\n\t\t{\n\t\t\tint newBitPos = m_bitPos + m_bitsPerChar;\n\t\t\tif (newBitPos <= 8)\n\t\t\t\tm_outBuf[m_bytePos] |= value << (8-newBitPos);\n\t\t\telse\n\t\t\t{\n\t\t\t\tm_outBuf[m_bytePos] |= value >> (newBitPos-8);\n\t\t\t\tm_outBuf[m_bytePos+1] |= value << (16-newBitPos);\n\t\t\t}\n\n\t\t\tm_bitPos = newBitPos;\n\t\t\twhile (m_bitPos >= 8)\n\t\t\t{\n\t\t\t\tm_bitPos -= 8;\n\t\t\t\t++m_bytePos;\n\t\t\t}\n\t\t}\n\n\t\tif (m_bytePos == m_outputBlockSize)\n\t\t{\n\t\t\tFILTER_OUTPUT(1, m_outBuf, m_outputBlockSize, 0);\n\t\t\tm_bytePos = m_bitPos = 0;\n\t\t}\n\t}\n\tif (messageEnd)\n\t{\n\t\tFILTER_OUTPUT(2, m_outBuf, m_bytePos, messageEnd);\n\t\tm_bytePos = m_bitPos = 0;\n\t}\n\tFILTER_END_NO_MESSAGE_END;\n}",
    "includes": [
      "#include <ctype.h>",
      "#include \"fltrimpl.h\"",
      "#include \"basecode.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FILTER_OUTPUT",
          "args": [
            "2",
            "m_outBuf",
            "m_bytePos",
            "messageEnd"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FILTER_OUTPUT",
          "args": [
            "1",
            "m_outBuf",
            "m_outputBlockSize",
            "0"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "m_outBuf",
            "0",
            "m_outputBlockSize"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n#include \"fltrimpl.h\"\n#include \"basecode.h\"\n#include \"pch.h\"\n\nBaseN_Decoder {\n  size_t BaseN_Decoder::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n  {\n  \tFILTER_BEGIN;\n  \twhile (m_inputPosition < length)\n  \t{\n  \t\tunsigned int value;\n  \t\tvalue = m_lookup[begin[m_inputPosition++]];\n  \t\tif (value >= 256)\n  \t\t\tcontinue;\n  \n  \t\tif (m_bytePos == 0 && m_bitPos == 0)\n  \t\t\tmemset(m_outBuf, 0, m_outputBlockSize);\n  \n  \t\t{\n  \t\t\tint newBitPos = m_bitPos + m_bitsPerChar;\n  \t\t\tif (newBitPos <= 8)\n  \t\t\t\tm_outBuf[m_bytePos] |= value << (8-newBitPos);\n  \t\t\telse\n  \t\t\t{\n  \t\t\t\tm_outBuf[m_bytePos] |= value >> (newBitPos-8);\n  \t\t\t\tm_outBuf[m_bytePos+1] |= value << (16-newBitPos);\n  \t\t\t}\n  \n  \t\t\tm_bitPos = newBitPos;\n  \t\t\twhile (m_bitPos >= 8)\n  \t\t\t{\n  \t\t\t\tm_bitPos -= 8;\n  \t\t\t\t++m_bytePos;\n  \t\t\t}\n  \t\t}\n  \n  \t\tif (m_bytePos == m_outputBlockSize)\n  \t\t{\n  \t\t\tFILTER_OUTPUT(1, m_outBuf, m_outputBlockSize, 0);\n  \t\t\tm_bytePos = m_bitPos = 0;\n  \t\t}\n  \t}\n  \tif (messageEnd)\n  \t{\n  \t\tFILTER_OUTPUT(2, m_outBuf, m_bytePos, messageEnd);\n  \t\tm_bytePos = m_bitPos = 0;\n  \t}\n  \tFILTER_END_NO_MESSAGE_END;\n  }\n}"
  },
  {
    "function_name": "IsolatedInitialize",
    "container": "BaseN_Decoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/basecode.cpp",
    "lines": "106-122",
    "snippet": "void BaseN_Decoder::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tparameters.GetRequiredParameter(\"BaseN_Decoder\", Name::DecodingLookupArray(), m_lookup);\n\n\tparameters.GetRequiredIntParameter(\"BaseN_Decoder\", Name::Log2Base(), m_bitsPerChar);\n\tif (m_bitsPerChar <= 0 || m_bitsPerChar >= 8)\n\t\tthrow InvalidArgument(\"BaseN_Decoder: Log2Base must be between 1 and 7 inclusive\");\n\n\tm_bytePos = m_bitPos = 0;\n\n\tint i = m_bitsPerChar;\n\twhile (i%8 != 0)\n\t\ti += m_bitsPerChar;\n\tm_outputBlockSize = i/8;\n\n\tm_outBuf.New(m_outputBlockSize);\n}",
    "includes": [
      "#include <ctype.h>",
      "#include \"fltrimpl.h\"",
      "#include \"basecode.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_outBuf.New",
          "args": [
            "m_outputBlockSize"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "New",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "361-365",
          "snippet": "void New(size_type newSize)\n\t{\n\t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n\t\tm_size = newSize;\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void New(size_type newSize)\n  \t{\n  \t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n  \t\tm_size = newSize;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"BaseN_Decoder: Log2Base must be between 1 and 7 inclusive\""
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetRequiredIntParameter",
          "args": [
            "\"BaseN_Decoder\"",
            "Name::Log2Base()",
            "m_bitsPerChar"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Log2Base",
          "args": [],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetRequiredParameter",
          "args": [
            "\"BaseN_Decoder\"",
            "Name::DecodingLookupArray()",
            "m_lookup"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::DecodingLookupArray",
          "args": [],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n#include \"fltrimpl.h\"\n#include \"basecode.h\"\n#include \"pch.h\"\n\nBaseN_Decoder {\n  void BaseN_Decoder::IsolatedInitialize(const NameValuePairs &parameters)\n  {\n  \tparameters.GetRequiredParameter(\"BaseN_Decoder\", Name::DecodingLookupArray(), m_lookup);\n  \n  \tparameters.GetRequiredIntParameter(\"BaseN_Decoder\", Name::Log2Base(), m_bitsPerChar);\n  \tif (m_bitsPerChar <= 0 || m_bitsPerChar >= 8)\n  \t\tthrow InvalidArgument(\"BaseN_Decoder: Log2Base must be between 1 and 7 inclusive\");\n  \n  \tm_bytePos = m_bitPos = 0;\n  \n  \tint i = m_bitsPerChar;\n  \twhile (i%8 != 0)\n  \t\ti += m_bitsPerChar;\n  \tm_outputBlockSize = i/8;\n  \n  \tm_outBuf.New(m_outputBlockSize);\n  }\n}"
  },
  {
    "function_name": "Put2",
    "container": "BaseN_Encoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/basecode.cpp",
    "lines": "39-104",
    "snippet": "size_t BaseN_Encoder::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tFILTER_BEGIN;\n\twhile (m_inputPosition < length)\n\t{\n\t\tif (m_bytePos == 0)\n\t\t\tmemset(m_outBuf, 0, m_outputBlockSize);\n\n\t\t{\n\t\tunsigned int b = begin[m_inputPosition++], bitsLeftInSource = 8;\n\t\twhile (true)\n\t\t{\n\t\t\tassert(m_bitPos < m_bitsPerChar);\n\t\t\tunsigned int bitsLeftInTarget = m_bitsPerChar-m_bitPos;\n\t\t\tm_outBuf[m_bytePos] |= b >> (8-bitsLeftInTarget);\n\t\t\tif (bitsLeftInSource >= bitsLeftInTarget)\n\t\t\t{\n\t\t\t\tm_bitPos = 0;\n\t\t\t\t++m_bytePos;\n\t\t\t\tbitsLeftInSource -= bitsLeftInTarget;\n\t\t\t\tif (bitsLeftInSource == 0)\n\t\t\t\t\tbreak;\n\t\t\t\tb <<= bitsLeftInTarget;\n\t\t\t\tb &= 0xff;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tm_bitPos += bitsLeftInSource;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\t}\n\n\t\tassert(m_bytePos <= m_outputBlockSize);\n\t\tif (m_bytePos == m_outputBlockSize)\n\t\t{\n\t\t\tint i;\n\t\t\tfor (i=0; i<m_bytePos; i++)\n\t\t\t{\n\t\t\t\tassert(m_outBuf[i] < (1 << m_bitsPerChar));\n\t\t\t\tm_outBuf[i] = m_alphabet[m_outBuf[i]];\n\t\t\t}\n\t\t\tFILTER_OUTPUT(1, m_outBuf, m_outputBlockSize, 0);\n\t\t\t\n\t\t\tm_bytePos = m_bitPos = 0;\n\t\t}\n\t}\n\tif (messageEnd)\n\t{\n\t\tif (m_bitPos > 0)\n\t\t\t++m_bytePos;\n\n\t\tint i;\n\t\tfor (i=0; i<m_bytePos; i++)\n\t\t\tm_outBuf[i] = m_alphabet[m_outBuf[i]];\n\n\t\tif (m_padding != -1 && m_bytePos > 0)\n\t\t{\n\t\t\tmemset(m_outBuf+m_bytePos, m_padding, m_outputBlockSize-m_bytePos);\n\t\t\tm_bytePos = m_outputBlockSize;\n\t\t}\n\t\tFILTER_OUTPUT(2, m_outBuf, m_bytePos, messageEnd);\n\t\tm_bytePos = m_bitPos = 0;\n\t}\n\tFILTER_END_NO_MESSAGE_END;\n}",
    "includes": [
      "#include <ctype.h>",
      "#include \"fltrimpl.h\"",
      "#include \"basecode.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FILTER_OUTPUT",
          "args": [
            "2",
            "m_outBuf",
            "m_bytePos",
            "messageEnd"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "m_outBuf+m_bytePos",
            "m_padding",
            "m_outputBlockSize-m_bytePos"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FILTER_OUTPUT",
          "args": [
            "1",
            "m_outBuf",
            "m_outputBlockSize",
            "0"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_outBuf[i] < (1 << m_bitsPerChar)"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_bytePos <= m_outputBlockSize"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_bitPos < m_bitsPerChar"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "m_outBuf",
            "0",
            "m_outputBlockSize"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n#include \"fltrimpl.h\"\n#include \"basecode.h\"\n#include \"pch.h\"\n\nBaseN_Encoder {\n  size_t BaseN_Encoder::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n  {\n  \tFILTER_BEGIN;\n  \twhile (m_inputPosition < length)\n  \t{\n  \t\tif (m_bytePos == 0)\n  \t\t\tmemset(m_outBuf, 0, m_outputBlockSize);\n  \n  \t\t{\n  \t\tunsigned int b = begin[m_inputPosition++], bitsLeftInSource = 8;\n  \t\twhile (true)\n  \t\t{\n  \t\t\tassert(m_bitPos < m_bitsPerChar);\n  \t\t\tunsigned int bitsLeftInTarget = m_bitsPerChar-m_bitPos;\n  \t\t\tm_outBuf[m_bytePos] |= b >> (8-bitsLeftInTarget);\n  \t\t\tif (bitsLeftInSource >= bitsLeftInTarget)\n  \t\t\t{\n  \t\t\t\tm_bitPos = 0;\n  \t\t\t\t++m_bytePos;\n  \t\t\t\tbitsLeftInSource -= bitsLeftInTarget;\n  \t\t\t\tif (bitsLeftInSource == 0)\n  \t\t\t\t\tbreak;\n  \t\t\t\tb <<= bitsLeftInTarget;\n  \t\t\t\tb &= 0xff;\n  \t\t\t}\n  \t\t\telse\n  \t\t\t{\n  \t\t\t\tm_bitPos += bitsLeftInSource;\n  \t\t\t\tbreak;\n  \t\t\t}\n  \t\t}\n  \t\t}\n  \n  \t\tassert(m_bytePos <= m_outputBlockSize);\n  \t\tif (m_bytePos == m_outputBlockSize)\n  \t\t{\n  \t\t\tint i;\n  \t\t\tfor (i=0; i<m_bytePos; i++)\n  \t\t\t{\n  \t\t\t\tassert(m_outBuf[i] < (1 << m_bitsPerChar));\n  \t\t\t\tm_outBuf[i] = m_alphabet[m_outBuf[i]];\n  \t\t\t}\n  \t\t\tFILTER_OUTPUT(1, m_outBuf, m_outputBlockSize, 0);\n  \t\t\t\n  \t\t\tm_bytePos = m_bitPos = 0;\n  \t\t}\n  \t}\n  \tif (messageEnd)\n  \t{\n  \t\tif (m_bitPos > 0)\n  \t\t\t++m_bytePos;\n  \n  \t\tint i;\n  \t\tfor (i=0; i<m_bytePos; i++)\n  \t\t\tm_outBuf[i] = m_alphabet[m_outBuf[i]];\n  \n  \t\tif (m_padding != -1 && m_bytePos > 0)\n  \t\t{\n  \t\t\tmemset(m_outBuf+m_bytePos, m_padding, m_outputBlockSize-m_bytePos);\n  \t\t\tm_bytePos = m_outputBlockSize;\n  \t\t}\n  \t\tFILTER_OUTPUT(2, m_outBuf, m_bytePos, messageEnd);\n  \t\tm_bytePos = m_bitPos = 0;\n  \t}\n  \tFILTER_END_NO_MESSAGE_END;\n  }\n}"
  },
  {
    "function_name": "IsolatedInitialize",
    "container": "BaseN_Encoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/basecode.cpp",
    "lines": "13-37",
    "snippet": "void BaseN_Encoder::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tparameters.GetRequiredParameter(\"BaseN_Encoder\", Name::EncodingLookupArray(), m_alphabet);\n\n\tparameters.GetRequiredIntParameter(\"BaseN_Encoder\", Name::Log2Base(), m_bitsPerChar);\n\tif (m_bitsPerChar <= 0 || m_bitsPerChar >= 8)\n\t\tthrow InvalidArgument(\"BaseN_Encoder: Log2Base must be between 1 and 7 inclusive\");\n\n\tbyte padding;\n\tbool pad;\n\tif (parameters.GetValue(Name::PaddingByte(), padding))\n\t\tpad = parameters.GetValueWithDefault(Name::Pad(), true);\n\telse\n\t\tpad = false;\n\tm_padding = pad ? padding : -1;\n\n\tm_bytePos = m_bitPos = 0;\n\n\tint i = 8;\n\twhile (i%m_bitsPerChar != 0)\n\t\ti += 8;\n\tm_outputBlockSize = i/m_bitsPerChar;\n\n\tm_outBuf.New(m_outputBlockSize);\n}",
    "includes": [
      "#include <ctype.h>",
      "#include \"fltrimpl.h\"",
      "#include \"basecode.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_outBuf.New",
          "args": [
            "m_outputBlockSize"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "New",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "361-365",
          "snippet": "void New(size_type newSize)\n\t{\n\t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n\t\tm_size = newSize;\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void New(size_type newSize)\n  \t{\n  \t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n  \t\tm_size = newSize;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::Pad()",
            "true"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Pad",
          "args": [],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValue",
          "args": [
            "Name::PaddingByte()",
            "padding"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::PaddingByte",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"BaseN_Encoder: Log2Base must be between 1 and 7 inclusive\""
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetRequiredIntParameter",
          "args": [
            "\"BaseN_Encoder\"",
            "Name::Log2Base()",
            "m_bitsPerChar"
          ],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Log2Base",
          "args": [],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetRequiredParameter",
          "args": [
            "\"BaseN_Encoder\"",
            "Name::EncodingLookupArray()",
            "m_alphabet"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::EncodingLookupArray",
          "args": [],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <ctype.h>\n#include \"fltrimpl.h\"\n#include \"basecode.h\"\n#include \"pch.h\"\n\nBaseN_Encoder {\n  void BaseN_Encoder::IsolatedInitialize(const NameValuePairs &parameters)\n  {\n  \tparameters.GetRequiredParameter(\"BaseN_Encoder\", Name::EncodingLookupArray(), m_alphabet);\n  \n  \tparameters.GetRequiredIntParameter(\"BaseN_Encoder\", Name::Log2Base(), m_bitsPerChar);\n  \tif (m_bitsPerChar <= 0 || m_bitsPerChar >= 8)\n  \t\tthrow InvalidArgument(\"BaseN_Encoder: Log2Base must be between 1 and 7 inclusive\");\n  \n  \tbyte padding;\n  \tbool pad;\n  \tif (parameters.GetValue(Name::PaddingByte(), padding))\n  \t\tpad = parameters.GetValueWithDefault(Name::Pad(), true);\n  \telse\n  \t\tpad = false;\n  \tm_padding = pad ? padding : -1;\n  \n  \tm_bytePos = m_bitPos = 0;\n  \n  \tint i = 8;\n  \twhile (i%m_bitsPerChar != 0)\n  \t\ti += 8;\n  \tm_outputBlockSize = i/m_bitsPerChar;\n  \n  \tm_outBuf.New(m_outputBlockSize);\n  }\n}"
  }
]