[
  {
    "function_name": "ProcessPoststreamTail",
    "container": "Inflator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "117-117",
    "snippet": "virtual void ProcessPoststreamTail() {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  virtual void ProcessPoststreamTail() {}\n}"
  },
  {
    "function_name": "MaxPoststreamTailSize",
    "container": "Inflator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "116-116",
    "snippet": "virtual unsigned int MaxPoststreamTailSize() const {return 0;}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  virtual unsigned int MaxPoststreamTailSize() const {return 0;}\n}"
  },
  {
    "function_name": "ProcessDecompressedData",
    "container": "Inflator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "114-115",
    "snippet": "virtual void ProcessDecompressedData(const byte *string, size_t length)\n\t\t{AttachedTransformation()->Put(string, length);}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "string",
            "length"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  virtual void ProcessDecompressedData(const byte *string, size_t length)\n  \t\t{AttachedTransformation()->Put(string, length);}\n}"
  },
  {
    "function_name": "ProcessPrestreamHeader",
    "container": "Inflator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "113-113",
    "snippet": "virtual void ProcessPrestreamHeader() {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  virtual void ProcessPrestreamHeader() {}\n}"
  },
  {
    "function_name": "MaxPrestreamHeaderSize",
    "container": "Inflator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "112-112",
    "snippet": "virtual unsigned int MaxPrestreamHeaderSize() const {return 0;}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  virtual unsigned int MaxPrestreamHeaderSize() const {return 0;}\n}"
  },
  {
    "function_name": "GetLog2WindowSize",
    "container": "Inflator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "106-106",
    "snippet": "virtual unsigned int GetLog2WindowSize() const {return 15;}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  virtual unsigned int GetLog2WindowSize() const {return 15;}\n}"
  },
  {
    "function_name": "BadBlockErr",
    "container": "Inflator::BadBlockErr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "95-95",
    "snippet": "BadBlockErr() : Err(INVALID_DATA_FORMAT, \"Inflator: error in compressed block\") {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  BadBlockErr {\n    BadBlockErr() : Err(INVALID_DATA_FORMAT, \"Inflator: error in compressed block\") {}\n  }\n}"
  },
  {
    "function_name": "UnexpectedEndErr",
    "container": "Inflator::UnexpectedEndErr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "94-94",
    "snippet": "UnexpectedEndErr() : Err(INVALID_DATA_FORMAT, \"Inflator: unexpected end of compressed block\") {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  UnexpectedEndErr {\n    UnexpectedEndErr() : Err(INVALID_DATA_FORMAT, \"Inflator: unexpected end of compressed block\") {}\n  }\n}"
  },
  {
    "function_name": "Err",
    "container": "Inflator::Err",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "91-92",
    "snippet": "Err(ErrorType e, const std::string &s)\n\t\t\t: Exception(e, s) {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nInflator {\n  Err {\n    Err(ErrorType e, const std::string &s)\n    \t\t\t: Exception(e, s) {}\n  }\n}"
  },
  {
    "function_name": "CodeInfo",
    "container": "HuffmanDecoder::CodeInfo",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "53-53",
    "snippet": "CodeInfo(code_t code=0, unsigned int len=0, value_t value=0) : code(code), len(len), value(value) {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nHuffmanDecoder {\n  CodeInfo {\n    CodeInfo(code_t code=0, unsigned int len=0, value_t value=0) : code(code), len(len), value(value) {}\n  }\n}"
  },
  {
    "function_name": "HuffmanDecoder",
    "container": "HuffmanDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "42-42",
    "snippet": "HuffmanDecoder(const unsigned int *codeBitLengths, unsigned int nCodes)\t{Initialize(codeBitLengths, nCodes);}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Initialize",
          "args": [
            "codeBitLengths",
            "nCodes"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "Initialize",
          "container": "HuffmanDecoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.cpp",
          "lines": "62-146",
          "snippet": "void HuffmanDecoder::Initialize(const unsigned int *codeBits, unsigned int nCodes)\n{\n\t// the Huffman codes are represented in 3 ways in this code:\n\t//\n\t// 1. most significant code bit (i.e. top of code tree) in the least significant bit position\n\t// 2. most significant code bit (i.e. top of code tree) in the most significant bit position\n\t// 3. most significant code bit (i.e. top of code tree) in n-th least significant bit position,\n\t//    where n is the maximum code length for this code tree\n\t//\n\t// (1) is the way the codes come in from the deflate stream\n\t// (2) is used to sort codes so they can be binary searched\n\t// (3) is used in this function to compute codes from code lengths\n\t//\n\t// a code in representation (2) is called \"normalized\" here\n\t// The BitReverse() function is used to convert between (1) and (2)\n\t// The NormalizeCode() function is used to convert from (3) to (2)\n\n\tif (nCodes == 0)\n\t\tthrow Err(\"null code\");\n\n\tm_maxCodeBits = *std::max_element(codeBits, codeBits+nCodes);\n\n\tif (m_maxCodeBits > MAX_CODE_BITS)\n\t\tthrow Err(\"code length exceeds maximum\");\n\n\tif (m_maxCodeBits == 0)\n\t\tthrow Err(\"null code\");\n\n\t// count number of codes of each length\n\tSecBlockWithHint<unsigned int, 15+1> blCount(m_maxCodeBits+1);\n\tstd::fill(blCount.begin(), blCount.end(), 0);\n\tunsigned int i;\n\tfor (i=0; i<nCodes; i++)\n\t\tblCount[codeBits[i]]++;\n\n\t// compute the starting code of each length\n\tcode_t code = 0;\n\tSecBlockWithHint<code_t, 15+1> nextCode(m_maxCodeBits+1);\n\tnextCode[1] = 0;\n\tfor (i=2; i<=m_maxCodeBits; i++)\n\t{\n\t\t// compute this while checking for overflow: code = (code + blCount[i-1]) << 1\n\t\tif (code > code + blCount[i-1])\n\t\t\tthrow Err(\"codes oversubscribed\");\n\t\tcode += blCount[i-1];\n\t\tif (code > (code << 1))\n\t\t\tthrow Err(\"codes oversubscribed\");\n\t\tcode <<= 1;\n\t\tnextCode[i] = code;\n\t}\n\n\tif (code > (1 << m_maxCodeBits) - blCount[m_maxCodeBits])\n\t\tthrow Err(\"codes oversubscribed\");\n\telse if (m_maxCodeBits != 1 && code < (1 << m_maxCodeBits) - blCount[m_maxCodeBits])\n\t\tthrow Err(\"codes incomplete\");\n\n\t// compute a vector of <code, length, value> triples sorted by code\n\tm_codeToValue.resize(nCodes - blCount[0]);\n\tunsigned int j=0;\n\tfor (i=0; i<nCodes; i++) \n\t{\n\t\tunsigned int len = codeBits[i];\n\t\tif (len != 0)\n\t\t{\n\t\t\tcode = NormalizeCode(nextCode[len]++, len);\n\t\t\tm_codeToValue[j].code = code;\n\t\t\tm_codeToValue[j].len = len;\n\t\t\tm_codeToValue[j].value = i;\n\t\t\tj++;\n\t\t}\n\t}\n\tstd::sort(m_codeToValue.begin(), m_codeToValue.end());\n\n\t// initialize the decoding cache\n\tm_cacheBits = STDMIN(9U, m_maxCodeBits);\n\tm_cacheMask = (1 << m_cacheBits) - 1;\n\tm_normalizedCacheMask = NormalizeCode(m_cacheMask, m_cacheBits);\n\tassert(m_normalizedCacheMask == BitReverse(m_cacheMask));\n\n\tif (m_cache.size() != size_t(1) << m_cacheBits)\n\t\tm_cache.resize(1 << m_cacheBits);\n\n\tfor (i=0; i<m_cache.size(); i++)\n\t\tm_cache[i].type = 0;\n}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"pch.h\"\n\nHuffmanDecoder {\n  void HuffmanDecoder::Initialize(const unsigned int *codeBits, unsigned int nCodes)\n  {\n  \t// the Huffman codes are represented in 3 ways in this code:\n  \t//\n  \t// 1. most significant code bit (i.e. top of code tree) in the least significant bit position\n  \t// 2. most significant code bit (i.e. top of code tree) in the most significant bit position\n  \t// 3. most significant code bit (i.e. top of code tree) in n-th least significant bit position,\n  \t//    where n is the maximum code length for this code tree\n  \t//\n  \t// (1) is the way the codes come in from the deflate stream\n  \t// (2) is used to sort codes so they can be binary searched\n  \t// (3) is used in this function to compute codes from code lengths\n  \t//\n  \t// a code in representation (2) is called \"normalized\" here\n  \t// The BitReverse() function is used to convert between (1) and (2)\n  \t// The NormalizeCode() function is used to convert from (3) to (2)\n  \n  \tif (nCodes == 0)\n  \t\tthrow Err(\"null code\");\n  \n  \tm_maxCodeBits = *std::max_element(codeBits, codeBits+nCodes);\n  \n  \tif (m_maxCodeBits > MAX_CODE_BITS)\n  \t\tthrow Err(\"code length exceeds maximum\");\n  \n  \tif (m_maxCodeBits == 0)\n  \t\tthrow Err(\"null code\");\n  \n  \t// count number of codes of each length\n  \tSecBlockWithHint<unsigned int, 15+1> blCount(m_maxCodeBits+1);\n  \tstd::fill(blCount.begin(), blCount.end(), 0);\n  \tunsigned int i;\n  \tfor (i=0; i<nCodes; i++)\n  \t\tblCount[codeBits[i]]++;\n  \n  \t// compute the starting code of each length\n  \tcode_t code = 0;\n  \tSecBlockWithHint<code_t, 15+1> nextCode(m_maxCodeBits+1);\n  \tnextCode[1] = 0;\n  \tfor (i=2; i<=m_maxCodeBits; i++)\n  \t{\n  \t\t// compute this while checking for overflow: code = (code + blCount[i-1]) << 1\n  \t\tif (code > code + blCount[i-1])\n  \t\t\tthrow Err(\"codes oversubscribed\");\n  \t\tcode += blCount[i-1];\n  \t\tif (code > (code << 1))\n  \t\t\tthrow Err(\"codes oversubscribed\");\n  \t\tcode <<= 1;\n  \t\tnextCode[i] = code;\n  \t}\n  \n  \tif (code > (1 << m_maxCodeBits) - blCount[m_maxCodeBits])\n  \t\tthrow Err(\"codes oversubscribed\");\n  \telse if (m_maxCodeBits != 1 && code < (1 << m_maxCodeBits) - blCount[m_maxCodeBits])\n  \t\tthrow Err(\"codes incomplete\");\n  \n  \t// compute a vector of <code, length, value> triples sorted by code\n  \tm_codeToValue.resize(nCodes - blCount[0]);\n  \tunsigned int j=0;\n  \tfor (i=0; i<nCodes; i++) \n  \t{\n  \t\tunsigned int len = codeBits[i];\n  \t\tif (len != 0)\n  \t\t{\n  \t\t\tcode = NormalizeCode(nextCode[len]++, len);\n  \t\t\tm_codeToValue[j].code = code;\n  \t\t\tm_codeToValue[j].len = len;\n  \t\t\tm_codeToValue[j].value = i;\n  \t\t\tj++;\n  \t\t}\n  \t}\n  \tstd::sort(m_codeToValue.begin(), m_codeToValue.end());\n  \n  \t// initialize the decoding cache\n  \tm_cacheBits = STDMIN(9U, m_maxCodeBits);\n  \tm_cacheMask = (1 << m_cacheBits) - 1;\n  \tm_normalizedCacheMask = NormalizeCode(m_cacheMask, m_cacheBits);\n  \tassert(m_normalizedCacheMask == BitReverse(m_cacheMask));\n  \n  \tif (m_cache.size() != size_t(1) << m_cacheBits)\n  \t\tm_cache.resize(1 << m_cacheBits);\n  \n  \tfor (i=0; i<m_cache.size(); i++)\n  \t\tm_cache[i].type = 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nHuffmanDecoder {\n  HuffmanDecoder(const unsigned int *codeBitLengths, unsigned int nCodes)\t{Initialize(codeBitLengths, nCodes);}\n}"
  },
  {
    "function_name": "HuffmanDecoder",
    "container": "HuffmanDecoder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "41-41",
    "snippet": "HuffmanDecoder() {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nHuffmanDecoder {\n  HuffmanDecoder() {}\n}"
  },
  {
    "function_name": "Err",
    "container": "HuffmanDecoder::Err",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "39-39",
    "snippet": "Err(const std::string &what) : Exception(INVALID_DATA_FORMAT, \"HuffmanDecoder: \" + what) {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nHuffmanDecoder {\n  Err {\n    Err(const std::string &what) : Exception(INVALID_DATA_FORMAT, \"HuffmanDecoder: \" + what) {}\n  }\n}"
  },
  {
    "function_name": "PeekBuffer",
    "container": "LowFirstBitReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "17-17",
    "snippet": "unsigned long PeekBuffer() const {return m_buffer;}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nLowFirstBitReader {\n  unsigned long PeekBuffer() const {return m_buffer;}\n}"
  },
  {
    "function_name": "BitsBuffered",
    "container": "LowFirstBitReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "16-16",
    "snippet": "unsigned int BitsBuffered() const {return m_bitsBuffered;}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nLowFirstBitReader {\n  unsigned int BitsBuffered() const {return m_bitsBuffered;}\n}"
  },
  {
    "function_name": "LowFirstBitReader",
    "container": "LowFirstBitReader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.h",
    "lines": "13-14",
    "snippet": "LowFirstBitReader(BufferedTransformation &store)\n\t\t: m_store(store), m_buffer(0), m_bitsBuffered(0) {}",
    "includes": [
      "#include <vector>",
      "#include \"filters.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <vector>\n#include \"filters.h\"\n\nLowFirstBitReader {\n  LowFirstBitReader(BufferedTransformation &store)\n  \t\t: m_store(store), m_buffer(0), m_bitsBuffered(0) {}\n}"
  }
]