[
  {
    "function_name": "ThreadUserTimer::TicksPerSecond",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
    "lines": "127-137",
    "snippet": "TimerWord ThreadUserTimer::TicksPerSecond()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\treturn 10*1000*1000;\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\tstatic const long ticksPerSecond = sysconf(_SC_CLK_TCK);\n\treturn ticksPerSecond;\n#else\n\treturn CLOCKS_PER_SEC;\n#endif\n}",
    "includes": [
      "#include <assert.h>",
      "#include <unistd.h>",
      "#include <sys/times.h>",
      "#include <sys/time.h>",
      "#include <windows.h>",
      "#include <time.h>",
      "#include <stddef.h>\t\t// for NULL",
      "#include \"misc.h\"",
      "#include \"hrtimer.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sysconf",
          "args": [
            "_SC_CLK_TCK"
          ],
          "line": 132
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nTimerWord ThreadUserTimer::TicksPerSecond()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\treturn 10*1000*1000;\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\tstatic const long ticksPerSecond = sysconf(_SC_CLK_TCK);\n\treturn ticksPerSecond;\n#else\n\treturn CLOCKS_PER_SEC;\n#endif\n}"
  },
  {
    "function_name": "ThreadUserTimer::GetCurrentTimerValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
    "lines": "97-125",
    "snippet": "TimerWord ThreadUserTimer::GetCurrentTimerValue()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tstatic bool getCurrentThreadImplemented = true;\n\tif (getCurrentThreadImplemented)\n\t{\n\t\tFILETIME now, ignored;\n\t\tif (!GetThreadTimes(GetCurrentThread(), &ignored, &ignored, &ignored, &now))\n\t\t{\n\t\t\tDWORD lastError = GetLastError();\n\t\t\tif (lastError == ERROR_CALL_NOT_IMPLEMENTED)\n\t\t\t{\n\t\t\t\tgetCurrentThreadImplemented = false;\n\t\t\t\tgoto GetCurrentThreadNotImplemented;\n\t\t\t}\n\t\t\tthrow Exception(Exception::OTHER_ERROR, \"ThreadUserTimer: GetThreadTimes failed with error \" + IntToString(lastError));\n\t\t}\n\t\treturn now.dwLowDateTime + ((TimerWord)now.dwHighDateTime << 32);\n\t}\nGetCurrentThreadNotImplemented:\n\treturn (TimerWord)clock() * (10*1000*1000 / CLOCKS_PER_SEC);\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\ttms now;\n\ttimes(&now);\n\treturn now.tms_utime;\n#else\n\treturn clock();\n#endif\n}",
    "includes": [
      "#include <assert.h>",
      "#include <unistd.h>",
      "#include <sys/times.h>",
      "#include <sys/time.h>",
      "#include <windows.h>",
      "#include <time.h>",
      "#include <stddef.h>\t\t// for NULL",
      "#include \"misc.h\"",
      "#include \"hrtimer.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clock",
          "args": [],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "times",
          "args": [
            "&now"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clock",
          "args": [],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Exception",
          "args": [
            "Exception::OTHER_ERROR",
            "\"ThreadUserTimer: GetThreadTimes failed with error \" + IntToString(lastError)"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "lastError"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "IntToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "409-429",
          "snippet": "std::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nstd::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 106
        },
        "resolved": true,
        "details": {
          "function_name": "Socket::GetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/socketft.cpp",
          "lines": "286-293",
          "snippet": "int Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}",
          "includes": [
            "#include <sys/ioctl.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include \"wait.h\"",
            "#include \"socketft.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/ioctl.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <netdb.h>\n#include <errno.h>\n#include \"wait.h\"\n#include \"socketft.h\"\n#include \"pch.h\"\n\nint Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetThreadTimes",
          "args": [
            "GetCurrentThread()",
            "&ignored",
            "&ignored",
            "&ignored",
            "&now"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetCurrentThread",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nTimerWord ThreadUserTimer::GetCurrentTimerValue()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tstatic bool getCurrentThreadImplemented = true;\n\tif (getCurrentThreadImplemented)\n\t{\n\t\tFILETIME now, ignored;\n\t\tif (!GetThreadTimes(GetCurrentThread(), &ignored, &ignored, &ignored, &now))\n\t\t{\n\t\t\tDWORD lastError = GetLastError();\n\t\t\tif (lastError == ERROR_CALL_NOT_IMPLEMENTED)\n\t\t\t{\n\t\t\t\tgetCurrentThreadImplemented = false;\n\t\t\t\tgoto GetCurrentThreadNotImplemented;\n\t\t\t}\n\t\t\tthrow Exception(Exception::OTHER_ERROR, \"ThreadUserTimer: GetThreadTimes failed with error \" + IntToString(lastError));\n\t\t}\n\t\treturn now.dwLowDateTime + ((TimerWord)now.dwHighDateTime << 32);\n\t}\nGetCurrentThreadNotImplemented:\n\treturn (TimerWord)clock() * (10*1000*1000 / CLOCKS_PER_SEC);\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\ttms now;\n\ttimes(&now);\n\treturn now.tms_utime;\n#else\n\treturn clock();\n#endif\n}"
  },
  {
    "function_name": "Timer::TicksPerSecond",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
    "lines": "78-93",
    "snippet": "TimerWord Timer::TicksPerSecond()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tstatic LARGE_INTEGER freq = {0};\n\tif (freq.QuadPart == 0)\n\t{\n\t\tif (!QueryPerformanceFrequency(&freq))\n\t\t\tthrow Exception(Exception::OTHER_ERROR, \"Timer: QueryPerformanceFrequency failed with error \" + IntToString(GetLastError()));\n\t}\n\treturn freq.QuadPart;\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\treturn 1000000;\n#else\n\treturn CLOCKS_PER_SEC;\n#endif\n}",
    "includes": [
      "#include <assert.h>",
      "#include <unistd.h>",
      "#include <sys/times.h>",
      "#include <sys/time.h>",
      "#include <windows.h>",
      "#include <time.h>",
      "#include <stddef.h>\t\t// for NULL",
      "#include \"misc.h\"",
      "#include \"hrtimer.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Exception",
          "args": [
            "Exception::OTHER_ERROR",
            "\"Timer: QueryPerformanceFrequency failed with error \" + IntToString(GetLastError())"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "GetLastError()"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "IntToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "409-429",
          "snippet": "std::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nstd::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "Socket::GetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/socketft.cpp",
          "lines": "286-293",
          "snippet": "int Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}",
          "includes": [
            "#include <sys/ioctl.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include \"wait.h\"",
            "#include \"socketft.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/ioctl.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <netdb.h>\n#include <errno.h>\n#include \"wait.h\"\n#include \"socketft.h\"\n#include \"pch.h\"\n\nint Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "QueryPerformanceFrequency",
          "args": [
            "&freq"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nTimerWord Timer::TicksPerSecond()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tstatic LARGE_INTEGER freq = {0};\n\tif (freq.QuadPart == 0)\n\t{\n\t\tif (!QueryPerformanceFrequency(&freq))\n\t\t\tthrow Exception(Exception::OTHER_ERROR, \"Timer: QueryPerformanceFrequency failed with error \" + IntToString(GetLastError()));\n\t}\n\treturn freq.QuadPart;\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\treturn 1000000;\n#else\n\treturn CLOCKS_PER_SEC;\n#endif\n}"
  },
  {
    "function_name": "Timer::GetCurrentTimerValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
    "lines": "61-76",
    "snippet": "TimerWord Timer::GetCurrentTimerValue()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tLARGE_INTEGER now;\n\tif (!QueryPerformanceCounter(&now))\n\t\tthrow Exception(Exception::OTHER_ERROR, \"Timer: QueryPerformanceCounter failed with error \" + IntToString(GetLastError()));\n\treturn now.QuadPart;\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\ttimeval now;\n\tgettimeofday(&now, NULL);\n\treturn (TimerWord)now.tv_sec * 1000000 + now.tv_usec;\n#else\n\tclock_t now;\n\treturn clock();\n#endif\n}",
    "includes": [
      "#include <assert.h>",
      "#include <unistd.h>",
      "#include <sys/times.h>",
      "#include <sys/time.h>",
      "#include <windows.h>",
      "#include <time.h>",
      "#include <stddef.h>\t\t// for NULL",
      "#include \"misc.h\"",
      "#include \"hrtimer.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clock",
          "args": [],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&now",
            "NULL"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Exception",
          "args": [
            "Exception::OTHER_ERROR",
            "\"Timer: QueryPerformanceCounter failed with error \" + IntToString(GetLastError())"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "GetLastError()"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "IntToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "409-429",
          "snippet": "std::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nstd::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "Socket::GetLastError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/socketft.cpp",
          "lines": "286-293",
          "snippet": "int Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}",
          "includes": [
            "#include <sys/ioctl.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include \"wait.h\"",
            "#include \"socketft.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/ioctl.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <netdb.h>\n#include <errno.h>\n#include \"wait.h\"\n#include \"socketft.h\"\n#include \"pch.h\"\n\nint Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "QueryPerformanceCounter",
          "args": [
            "&now"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nTimerWord Timer::GetCurrentTimerValue()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tLARGE_INTEGER now;\n\tif (!QueryPerformanceCounter(&now))\n\t\tthrow Exception(Exception::OTHER_ERROR, \"Timer: QueryPerformanceCounter failed with error \" + IntToString(GetLastError()));\n\treturn now.QuadPart;\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\ttimeval now;\n\tgettimeofday(&now, NULL);\n\treturn (TimerWord)now.tv_sec * 1000000 + now.tv_usec;\n#else\n\tclock_t now;\n\treturn clock();\n#endif\n}"
  },
  {
    "function_name": "TimerBase::ElapsedTime",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
    "lines": "54-59",
    "snippet": "unsigned long TimerBase::ElapsedTime()\n{\n\tdouble elapsed = ElapsedTimeAsDouble();\n\tassert(elapsed <= ULONG_MAX);\n\treturn (unsigned long)elapsed;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <unistd.h>",
      "#include <sys/times.h>",
      "#include <sys/time.h>",
      "#include <windows.h>",
      "#include <time.h>",
      "#include <stddef.h>\t\t// for NULL",
      "#include \"misc.h\"",
      "#include \"hrtimer.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "elapsed <= ULONG_MAX"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ElapsedTimeAsDouble",
          "args": [],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "TimerBase::ElapsedTimeAsDouble",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
          "lines": "37-52",
          "snippet": "double TimerBase::ElapsedTimeAsDouble()\n{\n\tif (m_stuckAtZero)\n\t\treturn 0;\n\n\tif (m_started)\n\t{\n\t\tTimerWord now = GetCurrentTimerValue();\n\t\tif (m_last < now)\t// protect against OS bugs where time goes backwards\n\t\t\tm_last = now;\n\t\treturn ConvertTo(m_last - m_start, m_timerUnit);\n\t}\n\n\tStartTimer();\n\treturn 0;\n}",
          "includes": [
            "#include <assert.h>",
            "#include <unistd.h>",
            "#include <sys/times.h>",
            "#include <sys/time.h>",
            "#include <windows.h>",
            "#include <time.h>",
            "#include <stddef.h>\t\t// for NULL",
            "#include \"misc.h\"",
            "#include \"hrtimer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\ndouble TimerBase::ElapsedTimeAsDouble()\n{\n\tif (m_stuckAtZero)\n\t\treturn 0;\n\n\tif (m_started)\n\t{\n\t\tTimerWord now = GetCurrentTimerValue();\n\t\tif (m_last < now)\t// protect against OS bugs where time goes backwards\n\t\t\tm_last = now;\n\t\treturn ConvertTo(m_last - m_start, m_timerUnit);\n\t}\n\n\tStartTimer();\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nunsigned long TimerBase::ElapsedTime()\n{\n\tdouble elapsed = ElapsedTimeAsDouble();\n\tassert(elapsed <= ULONG_MAX);\n\treturn (unsigned long)elapsed;\n}"
  },
  {
    "function_name": "TimerBase::ElapsedTimeAsDouble",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
    "lines": "37-52",
    "snippet": "double TimerBase::ElapsedTimeAsDouble()\n{\n\tif (m_stuckAtZero)\n\t\treturn 0;\n\n\tif (m_started)\n\t{\n\t\tTimerWord now = GetCurrentTimerValue();\n\t\tif (m_last < now)\t// protect against OS bugs where time goes backwards\n\t\t\tm_last = now;\n\t\treturn ConvertTo(m_last - m_start, m_timerUnit);\n\t}\n\n\tStartTimer();\n\treturn 0;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <unistd.h>",
      "#include <sys/times.h>",
      "#include <sys/time.h>",
      "#include <windows.h>",
      "#include <time.h>",
      "#include <stddef.h>\t\t// for NULL",
      "#include \"misc.h\"",
      "#include \"hrtimer.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "StartTimer",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "TimerBase::StartTimer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
          "lines": "31-35",
          "snippet": "void TimerBase::StartTimer()\n{\n\tm_last = m_start = GetCurrentTimerValue();\n\tm_started = true;\n}",
          "includes": [
            "#include <assert.h>",
            "#include <unistd.h>",
            "#include <sys/times.h>",
            "#include <sys/time.h>",
            "#include <windows.h>",
            "#include <time.h>",
            "#include <stddef.h>\t\t// for NULL",
            "#include \"misc.h\"",
            "#include \"hrtimer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nvoid TimerBase::StartTimer()\n{\n\tm_last = m_start = GetCurrentTimerValue();\n\tm_started = true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ConvertTo",
          "args": [
            "m_last - m_start",
            "m_timerUnit"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "TimerBase::ConvertTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
          "lines": "23-29",
          "snippet": "double TimerBase::ConvertTo(TimerWord t, Unit unit)\n{\n\tstatic unsigned long unitsPerSecondTable[] = {1, 1000, 1000*1000, 1000*1000*1000};\n\n\tassert(unit < sizeof(unitsPerSecondTable) / sizeof(unitsPerSecondTable[0]));\n\treturn (double)CRYPTOPP_VC6_INT64 t * unitsPerSecondTable[unit] / CRYPTOPP_VC6_INT64 TicksPerSecond();\n}",
          "includes": [
            "#include <assert.h>",
            "#include <unistd.h>",
            "#include <sys/times.h>",
            "#include <sys/time.h>",
            "#include <windows.h>",
            "#include <time.h>",
            "#include <stddef.h>\t\t// for NULL",
            "#include \"misc.h\"",
            "#include \"hrtimer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\ndouble TimerBase::ConvertTo(TimerWord t, Unit unit)\n{\n\tstatic unsigned long unitsPerSecondTable[] = {1, 1000, 1000*1000, 1000*1000*1000};\n\n\tassert(unit < sizeof(unitsPerSecondTable) / sizeof(unitsPerSecondTable[0]));\n\treturn (double)CRYPTOPP_VC6_INT64 t * unitsPerSecondTable[unit] / CRYPTOPP_VC6_INT64 TicksPerSecond();\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetCurrentTimerValue",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "ThreadUserTimer::GetCurrentTimerValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
          "lines": "97-125",
          "snippet": "TimerWord ThreadUserTimer::GetCurrentTimerValue()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tstatic bool getCurrentThreadImplemented = true;\n\tif (getCurrentThreadImplemented)\n\t{\n\t\tFILETIME now, ignored;\n\t\tif (!GetThreadTimes(GetCurrentThread(), &ignored, &ignored, &ignored, &now))\n\t\t{\n\t\t\tDWORD lastError = GetLastError();\n\t\t\tif (lastError == ERROR_CALL_NOT_IMPLEMENTED)\n\t\t\t{\n\t\t\t\tgetCurrentThreadImplemented = false;\n\t\t\t\tgoto GetCurrentThreadNotImplemented;\n\t\t\t}\n\t\t\tthrow Exception(Exception::OTHER_ERROR, \"ThreadUserTimer: GetThreadTimes failed with error \" + IntToString(lastError));\n\t\t}\n\t\treturn now.dwLowDateTime + ((TimerWord)now.dwHighDateTime << 32);\n\t}\nGetCurrentThreadNotImplemented:\n\treturn (TimerWord)clock() * (10*1000*1000 / CLOCKS_PER_SEC);\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\ttms now;\n\ttimes(&now);\n\treturn now.tms_utime;\n#else\n\treturn clock();\n#endif\n}",
          "includes": [
            "#include <assert.h>",
            "#include <unistd.h>",
            "#include <sys/times.h>",
            "#include <sys/time.h>",
            "#include <windows.h>",
            "#include <time.h>",
            "#include <stddef.h>\t\t// for NULL",
            "#include \"misc.h\"",
            "#include \"hrtimer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nTimerWord ThreadUserTimer::GetCurrentTimerValue()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tstatic bool getCurrentThreadImplemented = true;\n\tif (getCurrentThreadImplemented)\n\t{\n\t\tFILETIME now, ignored;\n\t\tif (!GetThreadTimes(GetCurrentThread(), &ignored, &ignored, &ignored, &now))\n\t\t{\n\t\t\tDWORD lastError = GetLastError();\n\t\t\tif (lastError == ERROR_CALL_NOT_IMPLEMENTED)\n\t\t\t{\n\t\t\t\tgetCurrentThreadImplemented = false;\n\t\t\t\tgoto GetCurrentThreadNotImplemented;\n\t\t\t}\n\t\t\tthrow Exception(Exception::OTHER_ERROR, \"ThreadUserTimer: GetThreadTimes failed with error \" + IntToString(lastError));\n\t\t}\n\t\treturn now.dwLowDateTime + ((TimerWord)now.dwHighDateTime << 32);\n\t}\nGetCurrentThreadNotImplemented:\n\treturn (TimerWord)clock() * (10*1000*1000 / CLOCKS_PER_SEC);\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\ttms now;\n\ttimes(&now);\n\treturn now.tms_utime;\n#else\n\treturn clock();\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\ndouble TimerBase::ElapsedTimeAsDouble()\n{\n\tif (m_stuckAtZero)\n\t\treturn 0;\n\n\tif (m_started)\n\t{\n\t\tTimerWord now = GetCurrentTimerValue();\n\t\tif (m_last < now)\t// protect against OS bugs where time goes backwards\n\t\t\tm_last = now;\n\t\treturn ConvertTo(m_last - m_start, m_timerUnit);\n\t}\n\n\tStartTimer();\n\treturn 0;\n}"
  },
  {
    "function_name": "TimerBase::StartTimer",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
    "lines": "31-35",
    "snippet": "void TimerBase::StartTimer()\n{\n\tm_last = m_start = GetCurrentTimerValue();\n\tm_started = true;\n}",
    "includes": [
      "#include <assert.h>",
      "#include <unistd.h>",
      "#include <sys/times.h>",
      "#include <sys/time.h>",
      "#include <windows.h>",
      "#include <time.h>",
      "#include <stddef.h>\t\t// for NULL",
      "#include \"misc.h\"",
      "#include \"hrtimer.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetCurrentTimerValue",
          "args": [],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "ThreadUserTimer::GetCurrentTimerValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
          "lines": "97-125",
          "snippet": "TimerWord ThreadUserTimer::GetCurrentTimerValue()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tstatic bool getCurrentThreadImplemented = true;\n\tif (getCurrentThreadImplemented)\n\t{\n\t\tFILETIME now, ignored;\n\t\tif (!GetThreadTimes(GetCurrentThread(), &ignored, &ignored, &ignored, &now))\n\t\t{\n\t\t\tDWORD lastError = GetLastError();\n\t\t\tif (lastError == ERROR_CALL_NOT_IMPLEMENTED)\n\t\t\t{\n\t\t\t\tgetCurrentThreadImplemented = false;\n\t\t\t\tgoto GetCurrentThreadNotImplemented;\n\t\t\t}\n\t\t\tthrow Exception(Exception::OTHER_ERROR, \"ThreadUserTimer: GetThreadTimes failed with error \" + IntToString(lastError));\n\t\t}\n\t\treturn now.dwLowDateTime + ((TimerWord)now.dwHighDateTime << 32);\n\t}\nGetCurrentThreadNotImplemented:\n\treturn (TimerWord)clock() * (10*1000*1000 / CLOCKS_PER_SEC);\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\ttms now;\n\ttimes(&now);\n\treturn now.tms_utime;\n#else\n\treturn clock();\n#endif\n}",
          "includes": [
            "#include <assert.h>",
            "#include <unistd.h>",
            "#include <sys/times.h>",
            "#include <sys/time.h>",
            "#include <windows.h>",
            "#include <time.h>",
            "#include <stddef.h>\t\t// for NULL",
            "#include \"misc.h\"",
            "#include \"hrtimer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nTimerWord ThreadUserTimer::GetCurrentTimerValue()\n{\n#if defined(CRYPTOPP_WIN32_AVAILABLE)\n\tstatic bool getCurrentThreadImplemented = true;\n\tif (getCurrentThreadImplemented)\n\t{\n\t\tFILETIME now, ignored;\n\t\tif (!GetThreadTimes(GetCurrentThread(), &ignored, &ignored, &ignored, &now))\n\t\t{\n\t\t\tDWORD lastError = GetLastError();\n\t\t\tif (lastError == ERROR_CALL_NOT_IMPLEMENTED)\n\t\t\t{\n\t\t\t\tgetCurrentThreadImplemented = false;\n\t\t\t\tgoto GetCurrentThreadNotImplemented;\n\t\t\t}\n\t\t\tthrow Exception(Exception::OTHER_ERROR, \"ThreadUserTimer: GetThreadTimes failed with error \" + IntToString(lastError));\n\t\t}\n\t\treturn now.dwLowDateTime + ((TimerWord)now.dwHighDateTime << 32);\n\t}\nGetCurrentThreadNotImplemented:\n\treturn (TimerWord)clock() * (10*1000*1000 / CLOCKS_PER_SEC);\n#elif defined(CRYPTOPP_UNIX_AVAILABLE)\n\ttms now;\n\ttimes(&now);\n\treturn now.tms_utime;\n#else\n\treturn clock();\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\nvoid TimerBase::StartTimer()\n{\n\tm_last = m_start = GetCurrentTimerValue();\n\tm_started = true;\n}"
  },
  {
    "function_name": "TimerBase::ConvertTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hrtimer.cpp",
    "lines": "23-29",
    "snippet": "double TimerBase::ConvertTo(TimerWord t, Unit unit)\n{\n\tstatic unsigned long unitsPerSecondTable[] = {1, 1000, 1000*1000, 1000*1000*1000};\n\n\tassert(unit < sizeof(unitsPerSecondTable) / sizeof(unitsPerSecondTable[0]));\n\treturn (double)CRYPTOPP_VC6_INT64 t * unitsPerSecondTable[unit] / CRYPTOPP_VC6_INT64 TicksPerSecond();\n}",
    "includes": [
      "#include <assert.h>",
      "#include <unistd.h>",
      "#include <sys/times.h>",
      "#include <sys/time.h>",
      "#include <windows.h>",
      "#include <time.h>",
      "#include <stddef.h>\t\t// for NULL",
      "#include \"misc.h\"",
      "#include \"hrtimer.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_VC6_INT64 TicksPerSecond",
          "args": [],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "unit < sizeof(unitsPerSecondTable) / sizeof(unitsPerSecondTable[0])"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <assert.h>\n#include <unistd.h>\n#include <sys/times.h>\n#include <sys/time.h>\n#include <windows.h>\n#include <time.h>\n#include <stddef.h>\t\t// for NULL\n#include \"misc.h\"\n#include \"hrtimer.h\"\n#include \"pch.h\"\n\ndouble TimerBase::ConvertTo(TimerWord t, Unit unit)\n{\n\tstatic unsigned long unitsPerSecondTable[] = {1, 1000, 1000*1000, 1000*1000*1000};\n\n\tassert(unit < sizeof(unitsPerSecondTable) / sizeof(unitsPerSecondTable[0]));\n\treturn (double)CRYPTOPP_VC6_INT64 t * unitsPerSecondTable[unit] / CRYPTOPP_VC6_INT64 TicksPerSecond();\n}"
  }
]