[
  {
    "function_name": "XTR_DH::Agree",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "90-106",
    "snippet": "bool XTR_DH::Agree(byte *agreedValue, const byte *privateKey, const byte *otherPublicKey, bool validateOtherPublicKey) const\n{\n\tGFP2Element w(otherPublicKey, PublicKeyLength());\n\tif (validateOtherPublicKey)\n\t{\n\t\tGFP2_ONB<ModularArithmetic> gfp2(m_p);\n\t\tGFP2Element three = gfp2.ConvertIn(3);\n\t\tif (w.c1.IsNegative() || w.c2.IsNegative() || w.c1 >= m_p || w.c2 >= m_p || w == three)\n\t\t\treturn false;\n\t\tif (XTR_Exponentiate(w, m_q, m_p) != three)\n\t\t\treturn false;\n\t}\n\tInteger s(privateKey, PrivateKeyLength());\n\tGFP2Element z = XTR_Exponentiate(w, s, m_p);\n\tz.Encode(agreedValue, AgreedValueLength());\n\treturn true;\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "z.Encode",
          "args": [
            "agreedValue",
            "AgreedValueLength()"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "GFP2Element",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "21-25",
          "snippet": "void Encode(byte *encodedElement, unsigned int size)\n\t{\n\t\tc1.Encode(encodedElement, size/2);\n\t\tc2.Encode(encodedElement+size/2, size/2);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2Element {\n  void Encode(byte *encodedElement, unsigned int size)\n  \t{\n  \t\tc1.Encode(encodedElement, size/2);\n  \t\tc2.Encode(encodedElement+size/2, size/2);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AgreedValueLength",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "AgreedValueLength",
          "container": "XTR_DH",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.h",
          "lines": "29-29",
          "snippet": "unsigned int AgreedValueLength() const {return 2*m_p.ByteCount();}",
          "includes": [
            "#include \"xtr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xtr.h\"\n\nXTR_DH {\n  unsigned int AgreedValueLength() const {return 2*m_p.ByteCount();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTR_Exponentiate",
          "args": [
            "w",
            "s",
            "m_p"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XTR_Exponentiate",
          "args": [
            "w",
            "m_q",
            "m_p"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "w.c2.IsNegative",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "IsNegative",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "201-201",
          "snippet": "bool IsNegative() const {return sign == NEGATIVE;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsNegative() const {return sign == NEGATIVE;}"
        }
      },
      {
        "call_info": {
          "callee": "gfp2.ConvertIn",
          "args": [
            "3"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertIn",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/ecp.h",
          "lines": "104-105",
          "snippet": "Element ConvertIn(const Element &P) const\n\t\t{return P.identity ? P : ECP::Point(m_ec->GetField().ConvertIn(P.x), m_ec->GetField().ConvertIn(P.y));}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"smartptr.h\"",
            "#include \"eprecomp.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"modarith.h\"\n\nElement ConvertIn(const Element &P) const\n\t\t{return P.identity ? P : ECP::Point(m_ec->GetField().ConvertIn(P.x), m_ec->GetField().ConvertIn(P.y));}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nbool XTR_DH::Agree(byte *agreedValue, const byte *privateKey, const byte *otherPublicKey, bool validateOtherPublicKey) const\n{\n\tGFP2Element w(otherPublicKey, PublicKeyLength());\n\tif (validateOtherPublicKey)\n\t{\n\t\tGFP2_ONB<ModularArithmetic> gfp2(m_p);\n\t\tGFP2Element three = gfp2.ConvertIn(3);\n\t\tif (w.c1.IsNegative() || w.c2.IsNegative() || w.c1 >= m_p || w.c2 >= m_p || w == three)\n\t\t\treturn false;\n\t\tif (XTR_Exponentiate(w, m_q, m_p) != three)\n\t\t\treturn false;\n\t}\n\tInteger s(privateKey, PrivateKeyLength());\n\tGFP2Element z = XTR_Exponentiate(w, s, m_p);\n\tz.Encode(agreedValue, AgreedValueLength());\n\treturn true;\n}"
  },
  {
    "function_name": "XTR_DH::GeneratePublicKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "83-88",
    "snippet": "void XTR_DH::GeneratePublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n{\n\tInteger x(privateKey, PrivateKeyLength());\n\tGFP2Element y = XTR_Exponentiate(m_g, x, m_p);\n\ty.Encode(publicKey, PublicKeyLength());\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "y.Encode",
          "args": [
            "publicKey",
            "PublicKeyLength()"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "GFP2Element",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "21-25",
          "snippet": "void Encode(byte *encodedElement, unsigned int size)\n\t{\n\t\tc1.Encode(encodedElement, size/2);\n\t\tc2.Encode(encodedElement+size/2, size/2);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2Element {\n  void Encode(byte *encodedElement, unsigned int size)\n  \t{\n  \t\tc1.Encode(encodedElement, size/2);\n  \t\tc2.Encode(encodedElement+size/2, size/2);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PublicKeyLength",
          "args": [],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "PublicKeyLength",
          "container": "XTR_DH",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.h",
          "lines": "31-31",
          "snippet": "unsigned int PublicKeyLength() const {return 2*m_p.ByteCount();}",
          "includes": [
            "#include \"xtr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xtr.h\"\n\nXTR_DH {\n  unsigned int PublicKeyLength() const {return 2*m_p.ByteCount();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "XTR_Exponentiate",
          "args": [
            "m_g",
            "x",
            "m_p"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nvoid XTR_DH::GeneratePublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n{\n\tInteger x(privateKey, PrivateKeyLength());\n\tGFP2Element y = XTR_Exponentiate(m_g, x, m_p);\n\ty.Encode(publicKey, PublicKeyLength());\n}"
  },
  {
    "function_name": "XTR_DH::GeneratePrivateKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "77-81",
    "snippet": "void XTR_DH::GeneratePrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n{\n\tInteger x(rng, Integer::Zero(), m_q-1);\n\tx.Encode(privateKey, PrivateKeyLength());\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "x.Encode",
          "args": [
            "privateKey",
            "PrivateKeyLength()"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "GFP2Element",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "21-25",
          "snippet": "void Encode(byte *encodedElement, unsigned int size)\n\t{\n\t\tc1.Encode(encodedElement, size/2);\n\t\tc2.Encode(encodedElement+size/2, size/2);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2Element {\n  void Encode(byte *encodedElement, unsigned int size)\n  \t{\n  \t\tc1.Encode(encodedElement, size/2);\n  \t\tc2.Encode(encodedElement+size/2, size/2);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "PrivateKeyLength",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "PrivateKeyLength",
          "container": "XTR_DH",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.h",
          "lines": "30-30",
          "snippet": "unsigned int PrivateKeyLength() const {return m_q.ByteCount();}",
          "includes": [
            "#include \"xtr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xtr.h\"\n\nXTR_DH {\n  unsigned int PrivateKeyLength() const {return m_q.ByteCount();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::Zero",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "Zero",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "23-24",
          "snippet": "Element Zero() const\n\t\t{return 0;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Zero() const\n  \t\t{return 0;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nvoid XTR_DH::GeneratePrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n{\n\tInteger x(rng, Integer::Zero(), m_q-1);\n\tx.Encode(privateKey, PrivateKeyLength());\n}"
  },
  {
    "function_name": "XTR_DH::AssignFrom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "68-75",
    "snippet": "void XTR_DH::AssignFrom(const NameValuePairs &source)\n{\n\tAssignFromHelper(this, source)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(Modulus)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(SubgroupOrder)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(SubgroupGenerator)\n\t\t;\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "SubgroupGenerator"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "SubgroupOrder"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "Modulus"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssignFromHelper",
          "args": [
            "this",
            "source"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "AssignFromHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "235-238",
          "snippet": "AssignFromHelperClass<T, T> AssignFromHelper(T *pObject, const NameValuePairs &source)\n{\n\treturn AssignFromHelperClass<T, T>(pObject, source);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAssignFromHelperClass<T, T> AssignFromHelper(T *pObject, const NameValuePairs &source)\n{\n\treturn AssignFromHelperClass<T, T>(pObject, source);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nvoid XTR_DH::AssignFrom(const NameValuePairs &source)\n{\n\tAssignFromHelper(this, source)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(Modulus)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(SubgroupOrder)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(SubgroupGenerator)\n\t\t;\n}"
  },
  {
    "function_name": "XTR_DH::GetVoidValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "59-66",
    "snippet": "bool XTR_DH::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\treturn GetValueHelper(this, name, valueType, pValue).Assignable()\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Modulus)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(SubgroupOrder)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(SubgroupGenerator)\n\t\t;\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "SubgroupGenerator"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "SubgroupOrder"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "Modulus"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetValueHelper",
          "args": [],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetValueHelper",
          "args": [
            "this",
            "name",
            "valueType",
            "pValue"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "GetValueHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "161-164",
          "snippet": "GetValueHelperClass<T, T> GetValueHelper(const T *pObject, const char *name, const std::type_info &valueType, void *pValue, const NameValuePairs *searchFirst=NULL)\n{\n\treturn GetValueHelperClass<T, T>(pObject, name, valueType, pValue, searchFirst);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nGetValueHelperClass<T, T> GetValueHelper(const T *pObject, const char *name, const std::type_info &valueType, void *pValue, const NameValuePairs *searchFirst=NULL)\n{\n\treturn GetValueHelperClass<T, T>(pObject, name, valueType, pValue, searchFirst);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nbool XTR_DH::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\treturn GetValueHelper(this, name, valueType, pValue).Assignable()\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Modulus)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(SubgroupOrder)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(SubgroupGenerator)\n\t\t;\n}"
  },
  {
    "function_name": "XTR_DH::Validate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "41-57",
    "snippet": "bool XTR_DH::Validate(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tbool pass = true;\n\tpass = pass && m_p > Integer::One() && m_p.IsOdd();\n\tpass = pass && m_q > Integer::One() && m_q.IsOdd();\n\tGFP2Element three = GFP2_ONB<ModularArithmetic>(m_p).ConvertIn(3);\n\tpass = pass && !(m_g.c1.IsNegative() || m_g.c2.IsNegative() || m_g.c1 >= m_p || m_g.c2 >= m_p || m_g == three);\n\tif (level >= 1)\n\t\tpass = pass && ((m_p.Squared()-m_p+1)%m_q).IsZero();\n\tif (level >= 2)\n\t{\n\t\tpass = pass && VerifyPrime(rng, m_p, level-2) && VerifyPrime(rng, m_q, level-2);\n\t\tpass = pass && XTR_Exponentiate(m_g, (m_p.Squared()-m_p+1)/m_q, m_p) != three;\n\t\tpass = pass && XTR_Exponentiate(m_g, m_q, m_p) == three;\n\t}\n\treturn pass;\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XTR_Exponentiate",
          "args": [
            "m_g",
            "m_q",
            "m_p"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "XTR_Exponentiate",
          "args": [
            "m_g",
            "(m_p.Squared()-m_p+1)/m_q",
            "m_p"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_p.Squared",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "Squared",
          "container": "PolynomialOverFixedRing",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/polynomi.h",
          "lines": "278-278",
          "snippet": "ThisType Squared() const {return ThisType(B::Squared(ms_fixedRing));}",
          "includes": [
            "#include <vector>",
            "#include <iosfwd>",
            "#include \"algebra.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <iosfwd>\n#include \"algebra.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nPolynomialOverFixedRing {\n  ThisType Squared() const {return ThisType(B::Squared(ms_fixedRing));}\n}"
        }
      },
      {
        "call_info": {
          "callee": "VerifyPrime",
          "args": [
            "rng",
            "m_q",
            "level-2"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "VerifyPrime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.cpp",
          "lines": "247-253",
          "snippet": "bool VerifyPrime(RandomNumberGenerator &rng, const Integer &p, unsigned int level)\n{\n\tbool pass = IsPrime(p) && RabinMillerTest(rng, p, 1);\n\tif (level >= 1)\n\t\tpass = pass && RabinMillerTest(rng, p, 10);\n\treturn pass;\n}",
          "includes": [
            "#include <omp.h>",
            "#include <vector>",
            "#include <math.h>",
            "#include \"algparam.h\"",
            "#include \"modarith.h\"",
            "#include \"nbtheory.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <omp.h>\n#include <vector>\n#include <math.h>\n#include \"algparam.h\"\n#include \"modarith.h\"\n#include \"nbtheory.h\"\n#include \"pch.h\"\n\nbool VerifyPrime(RandomNumberGenerator &rng, const Integer &p, unsigned int level)\n{\n\tbool pass = IsPrime(p) && RabinMillerTest(rng, p, 1);\n\tif (level >= 1)\n\t\tpass = pass && RabinMillerTest(rng, p, 10);\n\treturn pass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_g.c2.IsNegative",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "IsNegative",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "201-201",
          "snippet": "bool IsNegative() const {return sign == NEGATIVE;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsNegative() const {return sign == NEGATIVE;}"
        }
      },
      {
        "call_info": {
          "callee": "GFP2_ONB<ModularArithmetic>",
          "args": [
            "3"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "RaiseToPthPower",
          "container": "GFP2_ONB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "173-176",
          "snippet": "void RaiseToPthPower(Element &a) const\n\t{\n\t\ta.c1.swap(a.c2);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2_ONB {\n  void RaiseToPthPower(Element &a) const\n  \t{\n  \t\ta.c1.swap(a.c2);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_q.IsOdd",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "IsOdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "211-211",
          "snippet": "bool IsOdd() const\t{return GetBit(0) == 1;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsOdd() const\t{return GetBit(0) == 1;}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::One",
          "args": [],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "One",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "44-45",
          "snippet": "Element One() const\n\t\t{return 1;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element One() const\n  \t\t{return 1;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nbool XTR_DH::Validate(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tbool pass = true;\n\tpass = pass && m_p > Integer::One() && m_p.IsOdd();\n\tpass = pass && m_q > Integer::One() && m_q.IsOdd();\n\tGFP2Element three = GFP2_ONB<ModularArithmetic>(m_p).ConvertIn(3);\n\tpass = pass && !(m_g.c1.IsNegative() || m_g.c2.IsNegative() || m_g.c1 >= m_p || m_g.c2 >= m_p || m_g == three);\n\tif (level >= 1)\n\t\tpass = pass && ((m_p.Squared()-m_p+1)%m_q).IsZero();\n\tif (level >= 2)\n\t{\n\t\tpass = pass && VerifyPrime(rng, m_p, level-2) && VerifyPrime(rng, m_q, level-2);\n\t\tpass = pass && XTR_Exponentiate(m_g, (m_p.Squared()-m_p+1)/m_q, m_p) != three;\n\t\tpass = pass && XTR_Exponentiate(m_g, m_q, m_p) == three;\n\t}\n\treturn pass;\n}"
  },
  {
    "function_name": "XTR_DH::DEREncode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "31-39",
    "snippet": "void XTR_DH::DEREncode(BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder seq(bt);\n\tm_p.DEREncode(seq);\n\tm_q.DEREncode(seq);\n\tm_g.c1.DEREncode(seq);\n\tm_g.c2.DEREncode(seq);\n\tseq.MessageEnd();\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "m_g.c2.DEREncode",
          "args": [
            "seq"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "67-68",
          "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nvoid XTR_DH::DEREncode(BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder seq(bt);\n\tm_p.DEREncode(seq);\n\tm_q.DEREncode(seq);\n\tm_g.c1.DEREncode(seq);\n\tm_g.c2.DEREncode(seq);\n\tseq.MessageEnd();\n}"
  },
  {
    "function_name": "XTR_DH::XTR_DH",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "21-29",
    "snippet": "XTR_DH::XTR_DH(BufferedTransformation &bt)\n{\n\tBERSequenceDecoder seq(bt);\n\tm_p.BERDecode(seq);\n\tm_q.BERDecode(seq);\n\tm_g.c1.BERDecode(seq);\n\tm_g.c2.BERDecode(seq);\n\tseq.MessageEnd();\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "m_g.c2.BERDecode",
          "args": [
            "seq"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "BERDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "65-66",
          "snippet": "void BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nXTR_DH::XTR_DH(BufferedTransformation &bt)\n{\n\tBERSequenceDecoder seq(bt);\n\tm_p.BERDecode(seq);\n\tm_q.BERDecode(seq);\n\tm_g.c1.BERDecode(seq);\n\tm_g.c2.BERDecode(seq);\n\tseq.MessageEnd();\n}"
  },
  {
    "function_name": "XTR_DH::XTR_DH",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "16-19",
    "snippet": "XTR_DH::XTR_DH(RandomNumberGenerator &rng, unsigned int pbits, unsigned int qbits)\n{\n\tXTR_FindPrimesAndGenerator(rng, m_p, m_q, m_g, pbits, qbits);\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "XTR_FindPrimesAndGenerator",
          "args": [
            "rng",
            "m_p",
            "m_q",
            "m_g",
            "pbits",
            "qbits"
          ],
          "line": 18
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nXTR_DH::XTR_DH(RandomNumberGenerator &rng, unsigned int pbits, unsigned int qbits)\n{\n\tXTR_FindPrimesAndGenerator(rng, m_p, m_q, m_g, pbits, qbits);\n}"
  },
  {
    "function_name": "XTR_DH::XTR_DH",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
    "lines": "11-14",
    "snippet": "XTR_DH::XTR_DH(const Integer &p, const Integer &q, const GFP2Element &g)\n\t: m_p(p), m_q(q), m_g(g)\n{\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"asn.h\"",
      "#include \"nbtheory.h\"",
      "#include \"xtrcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nXTR_DH::XTR_DH(const Integer &p, const Integer &q, const GFP2Element &g)\n\t: m_p(p), m_q(q), m_g(g)\n{\n}"
  }
]