[
  {
    "function_name": "HMAC_Base::TruncatedFinal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.cpp",
    "lines": "67-82",
    "snippet": "void HMAC_Base::TruncatedFinal(byte *mac, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tHashTransformation &hash = AccessHash();\n\n\tif (!m_innerHashKeyed)\n\t\tKeyInnerHash();\n\thash.Final(AccessInnerHash());\n\n\thash.Update(AccessOpad(), hash.BlockSize());\n\thash.Update(AccessInnerHash(), hash.DigestSize());\n\thash.TruncatedFinal(mac, size);\n\n\tm_innerHashKeyed = false;\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash.TruncatedFinal",
          "args": [
            "mac",
            "size"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedFinal",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "68-74",
          "snippet": "void TruncatedFinal(byte *digest, size_t digestSize)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.TruncatedFinal(digest, digestSize);\n\t\tm_keyed = false;\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void TruncatedFinal(byte *digest, size_t digestSize)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.TruncatedFinal(digest, digestSize);\n  \t\tm_keyed = false;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.Update",
          "args": [
            "AccessInnerHash()",
            "hash.DigestSize()"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.DigestSize",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.h",
          "lines": "22-22",
          "snippet": "unsigned int DigestSize() const {return const_cast<HMAC_Base*>(this)->AccessHash().DigestSize();}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"seckey.h\"\n\nunsigned int DigestSize() const {return const_cast<HMAC_Base*>(this)->AccessHash().DigestSize();}"
        }
      },
      {
        "call_info": {
          "callee": "AccessInnerHash",
          "args": [],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.BlockSize",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "BlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/vmac.h",
          "lines": "21-21",
          "snippet": "unsigned int BlockSize() const {return m_L1KeyLength;}",
          "includes": [
            "#include \"seckey.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"seckey.h\"\n#include \"iterhash.h\"\n\nunsigned int BlockSize() const {return m_L1KeyLength;}"
        }
      },
      {
        "call_info": {
          "callee": "AccessOpad",
          "args": [],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.Final",
          "args": [
            "AccessInnerHash()"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessInnerHash",
          "args": [],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KeyInnerHash",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_Base::KeyInnerHash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.cpp",
          "lines": "43-49",
          "snippet": "void HMAC_Base::KeyInnerHash()\n{\n\tassert(!m_innerHashKeyed);\n\tHashTransformation &hash = AccessHash();\n\thash.Update(AccessIpad(), hash.BlockSize());\n\tm_innerHashKeyed = true;\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"pch.h\"\n\nvoid HMAC_Base::KeyInnerHash()\n{\n\tassert(!m_innerHashKeyed);\n\tHashTransformation &hash = AccessHash();\n\thash.Update(AccessIpad(), hash.BlockSize());\n\tm_innerHashKeyed = true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ThrowIfInvalidTruncatedSize",
          "args": [
            "size"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "HashTransformation::ThrowIfInvalidTruncatedSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "309-313",
          "snippet": "void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"pch.h\"\n\nvoid HMAC_Base::TruncatedFinal(byte *mac, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tHashTransformation &hash = AccessHash();\n\n\tif (!m_innerHashKeyed)\n\t\tKeyInnerHash();\n\thash.Final(AccessInnerHash());\n\n\thash.Update(AccessOpad(), hash.BlockSize());\n\thash.Update(AccessInnerHash(), hash.DigestSize());\n\thash.TruncatedFinal(mac, size);\n\n\tm_innerHashKeyed = false;\n}"
  },
  {
    "function_name": "HMAC_Base::Update",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.cpp",
    "lines": "60-65",
    "snippet": "void HMAC_Base::Update(const byte *input, size_t length)\n{\n\tif (!m_innerHashKeyed)\n\t\tKeyInnerHash();\n\tAccessHash().Update(input, length);\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [
            "input",
            "length"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KeyInnerHash",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_Base::KeyInnerHash",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.cpp",
          "lines": "43-49",
          "snippet": "void HMAC_Base::KeyInnerHash()\n{\n\tassert(!m_innerHashKeyed);\n\tHashTransformation &hash = AccessHash();\n\thash.Update(AccessIpad(), hash.BlockSize());\n\tm_innerHashKeyed = true;\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"pch.h\"\n\nvoid HMAC_Base::KeyInnerHash()\n{\n\tassert(!m_innerHashKeyed);\n\tHashTransformation &hash = AccessHash();\n\thash.Update(AccessIpad(), hash.BlockSize());\n\tm_innerHashKeyed = true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"pch.h\"\n\nvoid HMAC_Base::Update(const byte *input, size_t length)\n{\n\tif (!m_innerHashKeyed)\n\t\tKeyInnerHash();\n\tAccessHash().Update(input, length);\n}"
  },
  {
    "function_name": "HMAC_Base::Restart",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.cpp",
    "lines": "51-58",
    "snippet": "void HMAC_Base::Restart()\n{\n\tif (m_innerHashKeyed)\n\t{\n\t\tAccessHash().Restart();\n\t\tm_innerHashKeyed = false;\n\t}\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"pch.h\"\n\nvoid HMAC_Base::Restart()\n{\n\tif (m_innerHashKeyed)\n\t{\n\t\tAccessHash().Restart();\n\t\tm_innerHashKeyed = false;\n\t}\n}"
  },
  {
    "function_name": "HMAC_Base::KeyInnerHash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.cpp",
    "lines": "43-49",
    "snippet": "void HMAC_Base::KeyInnerHash()\n{\n\tassert(!m_innerHashKeyed);\n\tHashTransformation &hash = AccessHash();\n\thash.Update(AccessIpad(), hash.BlockSize());\n\tm_innerHashKeyed = true;\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "hash.Update",
          "args": [
            "AccessIpad()",
            "hash.BlockSize()"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.BlockSize",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "BlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/vmac.h",
          "lines": "21-21",
          "snippet": "unsigned int BlockSize() const {return m_L1KeyLength;}",
          "includes": [
            "#include \"seckey.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"seckey.h\"\n#include \"iterhash.h\"\n\nunsigned int BlockSize() const {return m_L1KeyLength;}"
        }
      },
      {
        "call_info": {
          "callee": "AccessIpad",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!m_innerHashKeyed"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"pch.h\"\n\nvoid HMAC_Base::KeyInnerHash()\n{\n\tassert(!m_innerHashKeyed);\n\tHashTransformation &hash = AccessHash();\n\thash.Update(AccessIpad(), hash.BlockSize());\n\tm_innerHashKeyed = true;\n}"
  },
  {
    "function_name": "HMAC_Base::UncheckedSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.cpp",
    "lines": "11-41",
    "snippet": "void HMAC_Base::UncheckedSetKey(const byte *userKey, unsigned int keylength, const NameValuePairs &)\n{\n\tAssertValidKeyLength(keylength);\n\n\tRestart();\n\n\tHashTransformation &hash = AccessHash();\n\tunsigned int blockSize = hash.BlockSize();\n\n\tif (!blockSize)\n\t\tthrow InvalidArgument(\"HMAC: can only be used with a block-based hash function\");\n\n\tm_buf.resize(2*AccessHash().BlockSize() + AccessHash().DigestSize());\n\n\tif (keylength <= blockSize)\n\t\tmemcpy(AccessIpad(), userKey, keylength);\n\telse\n\t{\n\t\tAccessHash().CalculateDigest(AccessIpad(), userKey, keylength);\n\t\tkeylength = hash.DigestSize();\n\t}\n\n\tassert(keylength <= blockSize);\n\tmemset(AccessIpad()+keylength, 0, blockSize-keylength);\n\n\tfor (unsigned int i=0; i<blockSize; i++)\n\t{\n\t\tAccessOpad()[i] = AccessIpad()[i] ^ 0x5c;\n\t\tAccessIpad()[i] ^= 0x36;\n\t}\n}",
    "includes": [
      "#include \"hmac.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AccessIpad",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessIpad",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessOpad",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "AccessIpad()+keylength",
            "0",
            "blockSize-keylength"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessIpad",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "keylength <= blockSize"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.DigestSize",
          "args": [],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.h",
          "lines": "22-22",
          "snippet": "unsigned int DigestSize() const {return const_cast<HMAC_Base*>(this)->AccessHash().DigestSize();}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"seckey.h\"\n\nunsigned int DigestSize() const {return const_cast<HMAC_Base*>(this)->AccessHash().DigestSize();}"
        }
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [
            "AccessIpad()",
            "userKey",
            "keylength"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessIpad",
          "args": [],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "AccessIpad()",
            "userKey",
            "keylength"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessIpad",
          "args": [],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_buf.resize",
          "args": [
            "2*AccessHash().BlockSize() + AccessHash().DigestSize()"
          ],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "203-211",
          "snippet": "void resize(size_t newSize)\n\t{\n\t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n\t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n\t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n\t\tdelete [] this->m_ptr;\n\t\tthis->m_size = newSize;\n\t\tthis->m_ptr = newPtr;\n\t}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  void resize(size_t newSize)\n  \t{\n  \t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n  \t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n  \t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n  \t\tdelete [] this->m_ptr;\n  \t\tthis->m_size = newSize;\n  \t\tthis->m_ptr = newPtr;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"HMAC: can only be used with a block-based hash function\""
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.BlockSize",
          "args": [],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "BlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/vmac.h",
          "lines": "21-21",
          "snippet": "unsigned int BlockSize() const {return m_L1KeyLength;}",
          "includes": [
            "#include \"seckey.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"seckey.h\"\n#include \"iterhash.h\"\n\nunsigned int BlockSize() const {return m_L1KeyLength;}"
        }
      },
      {
        "call_info": {
          "callee": "AccessHash",
          "args": [],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Restart",
          "args": [],
          "line": 15
        },
        "resolved": true,
        "details": {
          "function_name": "HMAC_Base::Restart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/hmac.cpp",
          "lines": "51-58",
          "snippet": "void HMAC_Base::Restart()\n{\n\tif (m_innerHashKeyed)\n\t{\n\t\tAccessHash().Restart();\n\t\tm_innerHashKeyed = false;\n\t}\n}",
          "includes": [
            "#include \"hmac.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hmac.h\"\n#include \"pch.h\"\n\nvoid HMAC_Base::Restart()\n{\n\tif (m_innerHashKeyed)\n\t{\n\t\tAccessHash().Restart();\n\t\tm_innerHashKeyed = false;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "keylength"
          ],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"hmac.h\"\n#include \"pch.h\"\n\nvoid HMAC_Base::UncheckedSetKey(const byte *userKey, unsigned int keylength, const NameValuePairs &)\n{\n\tAssertValidKeyLength(keylength);\n\n\tRestart();\n\n\tHashTransformation &hash = AccessHash();\n\tunsigned int blockSize = hash.BlockSize();\n\n\tif (!blockSize)\n\t\tthrow InvalidArgument(\"HMAC: can only be used with a block-based hash function\");\n\n\tm_buf.resize(2*AccessHash().BlockSize() + AccessHash().DigestSize());\n\n\tif (keylength <= blockSize)\n\t\tmemcpy(AccessIpad(), userKey, keylength);\n\telse\n\t{\n\t\tAccessHash().CalculateDigest(AccessIpad(), userKey, keylength);\n\t\tkeylength = hash.DigestSize();\n\t}\n\n\tassert(keylength <= blockSize);\n\tmemset(AccessIpad()+keylength, 0, blockSize-keylength);\n\n\tfor (unsigned int i=0; i<blockSize; i++)\n\t{\n\t\tAccessOpad()[i] = AccessIpad()[i] ^ 0x5c;\n\t\tAccessIpad()[i] ^= 0x36;\n\t}\n}"
  }
]