[
  {
    "function_name": "NullStore::TransferTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1109-1116",
    "snippet": "size_t NullStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tlword begin = 0;\n\tsize_t blockedBytes = NullStore::CopyRangeTo2(target, begin, transferBytes, channel, blocking);\n\ttransferBytes = begin;\n\tm_size -= begin;\n\treturn blockedBytes;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NullStore::CopyRangeTo2",
          "args": [
            "target",
            "begin",
            "transferBytes",
            "channel",
            "blocking"
          ],
          "line": 1112
        },
        "resolved": true,
        "details": {
          "function_name": "NullStore::CopyRangeTo2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "1095-1107",
          "snippet": "size_t NullStore::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\tstatic const byte nullBytes[128] = {0};\n\twhile (begin < end)\n\t{\n\t\tsize_t len = (size_t)STDMIN(end-begin, lword(128));\n\t\tsize_t blockedBytes = target.ChannelPut2(channel, nullBytes, len, 0, blocking);\n\t\tif (blockedBytes)\n\t\t\treturn blockedBytes;\n\t\tbegin += len;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t NullStore::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\tstatic const byte nullBytes[128] = {0};\n\twhile (begin < end)\n\t{\n\t\tsize_t len = (size_t)STDMIN(end-begin, lword(128));\n\t\tsize_t blockedBytes = target.ChannelPut2(channel, nullBytes, len, 0, blocking);\n\t\tif (blockedBytes)\n\t\t\treturn blockedBytes;\n\t\tbegin += len;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t NullStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tlword begin = 0;\n\tsize_t blockedBytes = NullStore::CopyRangeTo2(target, begin, transferBytes, channel, blocking);\n\ttransferBytes = begin;\n\tm_size -= begin;\n\treturn blockedBytes;\n}"
  },
  {
    "function_name": "NullStore::CopyRangeTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1095-1107",
    "snippet": "size_t NullStore::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\tstatic const byte nullBytes[128] = {0};\n\twhile (begin < end)\n\t{\n\t\tsize_t len = (size_t)STDMIN(end-begin, lword(128));\n\t\tsize_t blockedBytes = target.ChannelPut2(channel, nullBytes, len, 0, blocking);\n\t\tif (blockedBytes)\n\t\t\treturn blockedBytes;\n\t\tbegin += len;\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "target.ChannelPut2",
          "args": [
            "channel",
            "nullBytes",
            "len",
            "0",
            "blocking"
          ],
          "line": 1101
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelPut2",
          "container": "RawIDA",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/ida.h",
          "lines": "25-31",
          "snippet": "size_t ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n\t{\n\t\tif (!blocking)\n\t\t\tthrow BlockingInputOnly(\"RawIDA\");\n\t\tChannelData(StringToWord<word32>(channel), begin, length, messageEnd != 0);\n\t\treturn 0;\n\t}",
          "includes": [
            "#include <vector>",
            "#include <map>",
            "#include \"channels.h\"",
            "#include \"filters.h\"",
            "#include \"mqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <map>\n#include \"channels.h\"\n#include \"filters.h\"\n#include \"mqueue.h\"\n\nRawIDA {\n  size_t ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n  \t{\n  \t\tif (!blocking)\n  \t\t\tthrow BlockingInputOnly(\"RawIDA\");\n  \t\tChannelData(StringToWord<word32>(channel), begin, length, messageEnd != 0);\n  \t\treturn 0;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "STDMIN",
          "args": [
            "end-begin",
            "lword(128)"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "lword",
          "args": [
            "128"
          ],
          "line": 1100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t NullStore::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\tstatic const byte nullBytes[128] = {0};\n\twhile (begin < end)\n\t{\n\t\tsize_t len = (size_t)STDMIN(end-begin, lword(128));\n\t\tsize_t blockedBytes = target.ChannelPut2(channel, nullBytes, len, 0, blocking);\n\t\tif (blockedBytes)\n\t\t\treturn blockedBytes;\n\t\tbegin += len;\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "RandomNumberStore::TransferTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1083-1093",
    "snippet": "size_t RandomNumberStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tif (!blocking)\n\t\tthrow NotImplemented(\"RandomNumberStore: nonblocking transfer is not implemented by this object\");\n\n\ttransferBytes = UnsignedMin(transferBytes, m_length - m_count);\n\tm_rng->GenerateIntoBufferedTransformation(target, channel, transferBytes);\n\tm_count += transferBytes;\n\n\treturn 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_rng->GenerateIntoBufferedTransformation",
          "args": [
            "target",
            "channel",
            "transferBytes"
          ],
          "line": 1089
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateIntoBufferedTransformation",
          "container": "AutoSeededX917RNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.h",
          "lines": "109-109",
          "snippet": "void GenerateIntoBufferedTransformation(BufferedTransformation &target, const std::string &channel, lword length) {m_rng->GenerateIntoBufferedTransformation(target, channel, length);}",
          "includes": [
            "#include \"fips140.h\"",
            "#include \"sha.h\"",
            "#include \"aes.h\"",
            "#include \"rng.h\"",
            "#include \"randpool.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fips140.h\"\n#include \"sha.h\"\n#include \"aes.h\"\n#include \"rng.h\"\n#include \"randpool.h\"\n#include \"config.h\"\n\nAutoSeededX917RNG {\n  void GenerateIntoBufferedTransformation(BufferedTransformation &target, const std::string &channel, lword length) {m_rng->GenerateIntoBufferedTransformation(target, channel, length);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "UnsignedMin",
          "args": [
            "transferBytes",
            "m_length - m_count"
          ],
          "line": 1088
        },
        "resolved": true,
        "details": {
          "function_name": "UnsignedMin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "182-192",
          "snippet": "inline const T1 UnsignedMin(const T1& a, const T2& b)\n{\n\tCRYPTOPP_COMPILE_ASSERT((sizeof(T1)<=sizeof(T2) && T2(-1)>0) || (sizeof(T1)>sizeof(T2) && T1(-1)>0));\n\tassert(a==0 || a>0);\t// GCC workaround: get rid of the warning \"comparison is always true due to limited range of data type\"\n\tassert(b>=0);\n\n\tif (sizeof(T1)<=sizeof(T2))\n\t\treturn b < (T2)a ? (T1)b : a;\n\telse\n\t\treturn (T1)b < a ? (T1)b : a;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline const T1 UnsignedMin(const T1& a, const T2& b)\n{\n\tCRYPTOPP_COMPILE_ASSERT((sizeof(T1)<=sizeof(T2) && T2(-1)>0) || (sizeof(T1)>sizeof(T2) && T1(-1)>0));\n\tassert(a==0 || a>0);\t// GCC workaround: get rid of the warning \"comparison is always true due to limited range of data type\"\n\tassert(b>=0);\n\n\tif (sizeof(T1)<=sizeof(T2))\n\t\treturn b < (T2)a ? (T1)b : a;\n\telse\n\t\treturn (T1)b < a ? (T1)b : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NotImplemented",
          "args": [
            "\"RandomNumberStore: nonblocking transfer is not implemented by this object\""
          ],
          "line": 1086
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t RandomNumberStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tif (!blocking)\n\t\tthrow NotImplemented(\"RandomNumberStore: nonblocking transfer is not implemented by this object\");\n\n\ttransferBytes = UnsignedMin(transferBytes, m_length - m_count);\n\tm_rng->GenerateIntoBufferedTransformation(target, channel, transferBytes);\n\tm_count += transferBytes;\n\n\treturn 0;\n}"
  },
  {
    "function_name": "RandomNumberStore::StoreInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1075-1081",
    "snippet": "void RandomNumberStore::StoreInitialize(const NameValuePairs &parameters)\n{\n\tparameters.GetRequiredParameter(\"RandomNumberStore\", \"RandomNumberGeneratorPointer\", m_rng);\n\tint length;\n\tparameters.GetRequiredIntParameter(\"RandomNumberStore\", \"RandomNumberStoreSize\", length);\n\tm_length = length;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parameters.GetRequiredIntParameter",
          "args": [
            "\"RandomNumberStore\"",
            "\"RandomNumberStoreSize\"",
            "length"
          ],
          "line": 1079
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetRequiredParameter",
          "args": [
            "\"RandomNumberStore\"",
            "\"RandomNumberGeneratorPointer\"",
            "m_rng"
          ],
          "line": 1077
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid RandomNumberStore::StoreInitialize(const NameValuePairs &parameters)\n{\n\tparameters.GetRequiredParameter(\"RandomNumberStore\", \"RandomNumberGeneratorPointer\", m_rng);\n\tint length;\n\tparameters.GetRequiredIntParameter(\"RandomNumberStore\", \"RandomNumberStoreSize\", length);\n\tm_length = length;\n}"
  },
  {
    "function_name": "StringStore::CopyRangeTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1065-1073",
    "snippet": "size_t StringStore::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\tsize_t i = UnsignedMin(m_length, m_count+begin);\n\tsize_t len = UnsignedMin(m_length-i, end-begin);\n\tsize_t blockedBytes = target.ChannelPut2(channel, m_store+i, len, 0, blocking);\n\tif (!blockedBytes)\n\t\tbegin += len;\n\treturn blockedBytes;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "target.ChannelPut2",
          "args": [
            "channel",
            "m_store+i",
            "len",
            "0",
            "blocking"
          ],
          "line": 1069
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelPut2",
          "container": "RawIDA",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/ida.h",
          "lines": "25-31",
          "snippet": "size_t ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n\t{\n\t\tif (!blocking)\n\t\t\tthrow BlockingInputOnly(\"RawIDA\");\n\t\tChannelData(StringToWord<word32>(channel), begin, length, messageEnd != 0);\n\t\treturn 0;\n\t}",
          "includes": [
            "#include <vector>",
            "#include <map>",
            "#include \"channels.h\"",
            "#include \"filters.h\"",
            "#include \"mqueue.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <map>\n#include \"channels.h\"\n#include \"filters.h\"\n#include \"mqueue.h\"\n\nRawIDA {\n  size_t ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n  \t{\n  \t\tif (!blocking)\n  \t\t\tthrow BlockingInputOnly(\"RawIDA\");\n  \t\tChannelData(StringToWord<word32>(channel), begin, length, messageEnd != 0);\n  \t\treturn 0;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "UnsignedMin",
          "args": [
            "m_length-i",
            "end-begin"
          ],
          "line": 1068
        },
        "resolved": true,
        "details": {
          "function_name": "UnsignedMin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "182-192",
          "snippet": "inline const T1 UnsignedMin(const T1& a, const T2& b)\n{\n\tCRYPTOPP_COMPILE_ASSERT((sizeof(T1)<=sizeof(T2) && T2(-1)>0) || (sizeof(T1)>sizeof(T2) && T1(-1)>0));\n\tassert(a==0 || a>0);\t// GCC workaround: get rid of the warning \"comparison is always true due to limited range of data type\"\n\tassert(b>=0);\n\n\tif (sizeof(T1)<=sizeof(T2))\n\t\treturn b < (T2)a ? (T1)b : a;\n\telse\n\t\treturn (T1)b < a ? (T1)b : a;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline const T1 UnsignedMin(const T1& a, const T2& b)\n{\n\tCRYPTOPP_COMPILE_ASSERT((sizeof(T1)<=sizeof(T2) && T2(-1)>0) || (sizeof(T1)>sizeof(T2) && T1(-1)>0));\n\tassert(a==0 || a>0);\t// GCC workaround: get rid of the warning \"comparison is always true due to limited range of data type\"\n\tassert(b>=0);\n\n\tif (sizeof(T1)<=sizeof(T2))\n\t\treturn b < (T2)a ? (T1)b : a;\n\telse\n\t\treturn (T1)b < a ? (T1)b : a;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t StringStore::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\tsize_t i = UnsignedMin(m_length, m_count+begin);\n\tsize_t len = UnsignedMin(m_length-i, end-begin);\n\tsize_t blockedBytes = target.ChannelPut2(channel, m_store+i, len, 0, blocking);\n\tif (!blockedBytes)\n\t\tbegin += len;\n\treturn blockedBytes;\n}"
  },
  {
    "function_name": "StringStore::TransferTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1056-1063",
    "snippet": "size_t StringStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tlword position = 0;\n\tsize_t blockedBytes = CopyRangeTo2(target, position, transferBytes, channel, blocking);\n\tm_count += (size_t)position;\n\ttransferBytes = position;\n\treturn blockedBytes;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CopyRangeTo2",
          "args": [
            "target",
            "position",
            "transferBytes",
            "channel",
            "blocking"
          ],
          "line": 1059
        },
        "resolved": true,
        "details": {
          "function_name": "NullStore::CopyRangeTo2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "1095-1107",
          "snippet": "size_t NullStore::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\tstatic const byte nullBytes[128] = {0};\n\twhile (begin < end)\n\t{\n\t\tsize_t len = (size_t)STDMIN(end-begin, lword(128));\n\t\tsize_t blockedBytes = target.ChannelPut2(channel, nullBytes, len, 0, blocking);\n\t\tif (blockedBytes)\n\t\t\treturn blockedBytes;\n\t\tbegin += len;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t NullStore::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\tstatic const byte nullBytes[128] = {0};\n\twhile (begin < end)\n\t{\n\t\tsize_t len = (size_t)STDMIN(end-begin, lword(128));\n\t\tsize_t blockedBytes = target.ChannelPut2(channel, nullBytes, len, 0, blocking);\n\t\tif (blockedBytes)\n\t\t\treturn blockedBytes;\n\t\tbegin += len;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t StringStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tlword position = 0;\n\tsize_t blockedBytes = CopyRangeTo2(target, position, transferBytes, channel, blocking);\n\tm_count += (size_t)position;\n\ttransferBytes = position;\n\treturn blockedBytes;\n}"
  },
  {
    "function_name": "StringStore::StoreInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1046-1054",
    "snippet": "void StringStore::StoreInitialize(const NameValuePairs &parameters)\n{\n\tConstByteArrayParameter array;\n\tif (!parameters.GetValue(Name::InputBuffer(), array))\n\t\tthrow InvalidArgument(\"StringStore: missing InputBuffer argument\");\n\tm_store = array.begin();\n\tm_length = array.size();\n\tm_count = 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "array.size",
          "args": [],
          "line": 1052
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "array.begin",
          "args": [],
          "line": 1051
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"StringStore: missing InputBuffer argument\""
          ],
          "line": 1050
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValue",
          "args": [
            "Name::InputBuffer()",
            "array"
          ],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::InputBuffer",
          "args": [],
          "line": 1049
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StringStore::StoreInitialize(const NameValuePairs &parameters)\n{\n\tConstByteArrayParameter array;\n\tif (!parameters.GetValue(Name::InputBuffer(), array))\n\t\tthrow InvalidArgument(\"StringStore: missing InputBuffer argument\");\n\tm_store = array.begin();\n\tm_length = array.size();\n\tm_count = 0;\n}"
  },
  {
    "function_name": "Store::CopyMessagesTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1033-1044",
    "snippet": "unsigned int Store::CopyMessagesTo(BufferedTransformation &target, unsigned int count, const std::string &channel) const\n{\n\tif (m_messageEnd || count == 0)\n\t\treturn 0;\n\telse\n\t{\n\t\tCopyTo(target, ULONG_MAX, channel);\n\t\tif (GetAutoSignalPropagation())\n\t\t\ttarget.ChannelMessageEnd(channel, GetAutoSignalPropagation()-1);\n\t\treturn 1;\n\t}\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "target.ChannelMessageEnd",
          "args": [
            "channel",
            "GetAutoSignalPropagation()-1"
          ],
          "line": 1041
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetAutoSignalPropagation",
          "args": [],
          "line": 1041
        },
        "resolved": true,
        "details": {
          "function_name": "GetAutoSignalPropagation",
          "container": "SourceTemplate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.h",
          "lines": "772-773",
          "snippet": "int GetAutoSignalPropagation() const\n\t\t{return m_store.GetAutoSignalPropagation();}",
          "includes": [
            "#include <deque>",
            "#include \"algparam.h\"",
            "#include \"queue.h\"",
            "#include \"smartptr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"simple.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include \"algparam.h\"\n#include \"queue.h\"\n#include \"smartptr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"simple.h\"\n\nSourceTemplate {\n  int GetAutoSignalPropagation() const\n  \t\t{return m_store.GetAutoSignalPropagation();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "CopyTo",
          "args": [
            "target",
            "ULONG_MAX",
            "channel"
          ],
          "line": 1039
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nunsigned int Store::CopyMessagesTo(BufferedTransformation &target, unsigned int count, const std::string &channel) const\n{\n\tif (m_messageEnd || count == 0)\n\t\treturn 0;\n\telse\n\t{\n\t\tCopyTo(target, ULONG_MAX, channel);\n\t\tif (GetAutoSignalPropagation())\n\t\t\ttarget.ChannelMessageEnd(channel, GetAutoSignalPropagation()-1);\n\t\treturn 1;\n\t}\n}"
  },
  {
    "function_name": "Store::GetNextMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1022-1031",
    "snippet": "bool Store::GetNextMessage()\n{\n\tif (!m_messageEnd && !AnyRetrievable())\n\t{\n\t\tm_messageEnd=true;\n\t\treturn true;\n\t}\n\telse\n\t\treturn false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AnyRetrievable",
          "args": [],
          "line": 1024
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::AnyRetrievable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "394-403",
          "snippet": "bool BufferedTransformation::AnyRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyRetrievable();\n\telse\n\t{\n\t\tbyte b;\n\t\treturn Peek(b) != 0;\n\t}\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::AnyRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyRetrievable();\n\telse\n\t{\n\t\tbyte b;\n\t\treturn Peek(b) != 0;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool Store::GetNextMessage()\n{\n\tif (!m_messageEnd && !AnyRetrievable())\n\t{\n\t\tm_messageEnd=true;\n\t\treturn true;\n\t}\n\telse\n\t\treturn false;\n}"
  },
  {
    "function_name": "Source::PumpAll2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "1012-1020",
    "snippet": "size_t Source::PumpAll2(bool blocking)\n{\n\tunsigned int messageCount = UINT_MAX;\n\tdo {\n\t\tRETURN_IF_NONZERO(PumpMessages2(messageCount, blocking));\n\t} while(messageCount == UINT_MAX);\n\n\treturn 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RETURN_IF_NONZERO",
          "args": [
            "PumpMessages2(messageCount, blocking)"
          ],
          "line": 1016
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PumpMessages2",
          "args": [
            "messageCount",
            "blocking"
          ],
          "line": 1016
        },
        "resolved": true,
        "details": {
          "function_name": "NonblockingSource::PumpMessages2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/network.cpp",
          "lines": "140-160",
          "snippet": "size_t NonblockingSource::PumpMessages2(unsigned int &messageCount, bool blocking)\n{\n\tif (messageCount == 0)\n\t\treturn 0;\n\n\tmessageCount = 0;\n\n\tlword byteCount;\n\tdo {\n\t\tbyteCount = LWORD_MAX;\n\t\tRETURN_IF_NONZERO(Pump2(byteCount, blocking));\n\t} while(byteCount == LWORD_MAX);\n\n\tif (!m_messageEndSent && SourceExhausted())\n\t{\n\t\tRETURN_IF_NONZERO(AttachedTransformation()->Put2(NULL, 0, GetAutoSignalPropagation(), true));\n\t\tm_messageEndSent = true;\n\t\tmessageCount = 1;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include \"wait.h\"",
            "#include \"network.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"wait.h\"\n#include \"network.h\"\n#include \"pch.h\"\n\nsize_t NonblockingSource::PumpMessages2(unsigned int &messageCount, bool blocking)\n{\n\tif (messageCount == 0)\n\t\treturn 0;\n\n\tmessageCount = 0;\n\n\tlword byteCount;\n\tdo {\n\t\tbyteCount = LWORD_MAX;\n\t\tRETURN_IF_NONZERO(Pump2(byteCount, blocking));\n\t} while(byteCount == LWORD_MAX);\n\n\tif (!m_messageEndSent && SourceExhausted())\n\t{\n\t\tRETURN_IF_NONZERO(AttachedTransformation()->Put2(NULL, 0, GetAutoSignalPropagation(), true));\n\t\tm_messageEndSent = true;\n\t\tmessageCount = 1;\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t Source::PumpAll2(bool blocking)\n{\n\tunsigned int messageCount = UINT_MAX;\n\tdo {\n\t\tRETURN_IF_NONZERO(PumpMessages2(messageCount, blocking));\n\t} while(messageCount == UINT_MAX);\n\n\treturn 0;\n}"
  },
  {
    "function_name": "SignatureVerificationFilter::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "987-1008",
    "snippet": "void SignatureVerificationFilter::LastPut(const byte *inString, size_t length)\n{\n\tif (m_flags & SIGNATURE_AT_BEGIN)\n\t{\n\t\tassert(length == 0);\n\t\tm_verifier.InputSignature(*m_messageAccumulator, m_signature, m_signature.size());\n\t\tm_verified = m_verifier.VerifyAndRestart(*m_messageAccumulator);\n\t}\n\telse\n\t{\n\t\tm_verifier.InputSignature(*m_messageAccumulator, inString, length);\n\t\tm_verified = m_verifier.VerifyAndRestart(*m_messageAccumulator);\n\t\tif (m_flags & PUT_SIGNATURE)\n\t\t\tAttachedTransformation()->Put(inString, length);\n\t}\n\n\tif (m_flags & PUT_RESULT)\n\t\tAttachedTransformation()->Put(m_verified);\n\n\tif ((m_flags & THROW_EXCEPTION) && !m_verified)\n\t\tthrow SignatureVerificationFailed();\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SignatureVerificationFailed",
          "args": [],
          "line": 1007
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "m_verified"
          ],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 1004
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "length"
          ],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 1000
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_verifier.VerifyAndRestart",
          "args": [
            "*m_messageAccumulator"
          ],
          "line": 998
        },
        "resolved": true,
        "details": {
          "function_name": "VerifyAndRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "1099-1117",
          "snippet": "bool VerifyAndRestart(PK_MessageAccumulator &messageAccumulator) const\n\t{\n\t\tthis->GetMaterial().DoQuickSanityCheck();\n\n\t\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\t\tconst DL_ElgamalLikeSignatureAlgorithm<T> &alg = this->GetSignatureAlgorithm();\n\t\tconst DL_GroupParameters<T> &params = this->GetAbstractGroupParameters();\n\t\tconst DL_PublicKey<T> &key = this->GetKeyInterface();\n\n\t\tSecByteBlock representative(this->MessageRepresentativeLength());\n\t\tthis->GetMessageEncodingInterface().ComputeMessageRepresentative(NullRNG(), ma.m_recoverableMessage, ma.m_recoverableMessage.size(), \n\t\t\tma.AccessHash(), this->GetHashIdentifier(), ma.m_empty,\n\t\t\trepresentative, this->MessageRepresentativeBitLength());\n\t\tma.m_empty = true;\n\t\tInteger e(representative, representative.size());\n\n\t\tInteger r(ma.m_semisignature, ma.m_semisignature.size());\n\t\treturn alg.Verify(params, key, e, r, ma.m_s);\n\t}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nbool VerifyAndRestart(PK_MessageAccumulator &messageAccumulator) const\n\t{\n\t\tthis->GetMaterial().DoQuickSanityCheck();\n\n\t\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\t\tconst DL_ElgamalLikeSignatureAlgorithm<T> &alg = this->GetSignatureAlgorithm();\n\t\tconst DL_GroupParameters<T> &params = this->GetAbstractGroupParameters();\n\t\tconst DL_PublicKey<T> &key = this->GetKeyInterface();\n\n\t\tSecByteBlock representative(this->MessageRepresentativeLength());\n\t\tthis->GetMessageEncodingInterface().ComputeMessageRepresentative(NullRNG(), ma.m_recoverableMessage, ma.m_recoverableMessage.size(), \n\t\t\tma.AccessHash(), this->GetHashIdentifier(), ma.m_empty,\n\t\t\trepresentative, this->MessageRepresentativeBitLength());\n\t\tma.m_empty = true;\n\t\tInteger e(representative, representative.size());\n\n\t\tInteger r(ma.m_semisignature, ma.m_semisignature.size());\n\t\treturn alg.Verify(params, key, e, r, ma.m_s);\n\t}"
        }
      },
      {
        "call_info": {
          "callee": "m_verifier.InputSignature",
          "args": [
            "*m_messageAccumulator",
            "inString",
            "length"
          ],
          "line": 997
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_verifier.InputSignature",
          "args": [
            "*m_messageAccumulator",
            "m_signature",
            "m_signature.size()"
          ],
          "line": 992
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_signature.size",
          "args": [],
          "line": 992
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length == 0"
          ],
          "line": 991
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignatureVerificationFilter::LastPut(const byte *inString, size_t length)\n{\n\tif (m_flags & SIGNATURE_AT_BEGIN)\n\t{\n\t\tassert(length == 0);\n\t\tm_verifier.InputSignature(*m_messageAccumulator, m_signature, m_signature.size());\n\t\tm_verified = m_verifier.VerifyAndRestart(*m_messageAccumulator);\n\t}\n\telse\n\t{\n\t\tm_verifier.InputSignature(*m_messageAccumulator, inString, length);\n\t\tm_verified = m_verifier.VerifyAndRestart(*m_messageAccumulator);\n\t\tif (m_flags & PUT_SIGNATURE)\n\t\t\tAttachedTransformation()->Put(inString, length);\n\t}\n\n\tif (m_flags & PUT_RESULT)\n\t\tAttachedTransformation()->Put(m_verified);\n\n\tif ((m_flags & THROW_EXCEPTION) && !m_verified)\n\t\tthrow SignatureVerificationFailed();\n}"
  },
  {
    "function_name": "SignatureVerificationFilter::NextPutMultiple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "980-985",
    "snippet": "void SignatureVerificationFilter::NextPutMultiple(const byte *inString, size_t length)\n{\n\tm_messageAccumulator->Update(inString, length);\n\tif (m_flags & PUT_MESSAGE)\n\t\tAttachedTransformation()->Put(inString, length);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "length"
          ],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 984
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_messageAccumulator->Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 982
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignatureVerificationFilter::NextPutMultiple(const byte *inString, size_t length)\n{\n\tm_messageAccumulator->Update(inString, length);\n\tif (m_flags & PUT_MESSAGE)\n\t\tAttachedTransformation()->Put(inString, length);\n}"
  },
  {
    "function_name": "SignatureVerificationFilter::FirstPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "959-978",
    "snippet": "void SignatureVerificationFilter::FirstPut(const byte *inString)\n{\n\tif (m_flags & SIGNATURE_AT_BEGIN)\n\t{\n\t\tif (m_verifier.SignatureUpfront())\n\t\t\tm_verifier.InputSignature(*m_messageAccumulator, inString, m_verifier.SignatureLength());\n\t\telse\n\t\t{\n\t\t\tm_signature.New(m_verifier.SignatureLength());\n\t\t\tmemcpy(m_signature, inString, m_signature.size());\n\t\t}\n\n\t\tif (m_flags & PUT_SIGNATURE)\n\t\t\tAttachedTransformation()->Put(inString, m_signature.size());\n\t}\n\telse\n\t{\n\t\tassert(!m_verifier.SignatureUpfront());\n\t}\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!m_verifier.SignatureUpfront()"
          ],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_verifier.SignatureUpfront",
          "args": [],
          "line": 976
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "m_signature.size()"
          ],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_signature.size",
          "args": [],
          "line": 972
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 972
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m_signature",
            "inString",
            "m_signature.size()"
          ],
          "line": 968
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_signature.New",
          "args": [
            "m_verifier.SignatureLength()"
          ],
          "line": 967
        },
        "resolved": true,
        "details": {
          "function_name": "New",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "361-365",
          "snippet": "void New(size_type newSize)\n\t{\n\t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n\t\tm_size = newSize;\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void New(size_type newSize)\n  \t{\n  \t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n  \t\tm_size = newSize;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_verifier.SignatureLength",
          "args": [],
          "line": 967
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_verifier.InputSignature",
          "args": [
            "*m_messageAccumulator",
            "inString",
            "m_verifier.SignatureLength()"
          ],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_verifier.SignatureLength",
          "args": [],
          "line": 964
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_verifier.SignatureUpfront",
          "args": [],
          "line": 963
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignatureVerificationFilter::FirstPut(const byte *inString)\n{\n\tif (m_flags & SIGNATURE_AT_BEGIN)\n\t{\n\t\tif (m_verifier.SignatureUpfront())\n\t\t\tm_verifier.InputSignature(*m_messageAccumulator, inString, m_verifier.SignatureLength());\n\t\telse\n\t\t{\n\t\t\tm_signature.New(m_verifier.SignatureLength());\n\t\t\tmemcpy(m_signature, inString, m_signature.size());\n\t\t}\n\n\t\tif (m_flags & PUT_SIGNATURE)\n\t\t\tAttachedTransformation()->Put(inString, m_signature.size());\n\t}\n\telse\n\t{\n\t\tassert(!m_verifier.SignatureUpfront());\n\t}\n}"
  },
  {
    "function_name": "SignatureVerificationFilter::InitializeDerivedAndReturnNewSizes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "947-957",
    "snippet": "void SignatureVerificationFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tm_flags = parameters.GetValueWithDefault(Name::SignatureVerificationFilterFlags(), (word32)DEFAULT_FLAGS);\n\tm_messageAccumulator.reset(m_verifier.NewVerificationAccumulator());\n\tsize_t size = m_verifier.SignatureLength();\n\tassert(size != 0);\t// TODO: handle recoverable signature scheme\n\tm_verified = false;\n\tfirstSize = m_flags & SIGNATURE_AT_BEGIN ? size : 0;\n\tblockSize = 1;\n\tlastSize = m_flags & SIGNATURE_AT_BEGIN ? 0 : size;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "size != 0"
          ],
          "line": 952
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_verifier.SignatureLength",
          "args": [],
          "line": 951
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_messageAccumulator.reset",
          "args": [
            "m_verifier.NewVerificationAccumulator()"
          ],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_verifier.NewVerificationAccumulator",
          "args": [],
          "line": 950
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::SignatureVerificationFilterFlags()",
            "(word32)DEFAULT_FLAGS"
          ],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::SignatureVerificationFilterFlags",
          "args": [],
          "line": 949
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignatureVerificationFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tm_flags = parameters.GetValueWithDefault(Name::SignatureVerificationFilterFlags(), (word32)DEFAULT_FLAGS);\n\tm_messageAccumulator.reset(m_verifier.NewVerificationAccumulator());\n\tsize_t size = m_verifier.SignatureLength();\n\tassert(size != 0);\t// TODO: handle recoverable signature scheme\n\tm_verified = false;\n\tfirstSize = m_flags & SIGNATURE_AT_BEGIN ? size : 0;\n\tblockSize = 1;\n\tlastSize = m_flags & SIGNATURE_AT_BEGIN ? 0 : size;\n}"
  },
  {
    "function_name": "SignatureVerificationFilter::SignatureVerificationFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "940-945",
    "snippet": "SignatureVerificationFilter::SignatureVerificationFilter(const PK_Verifier &verifier, BufferedTransformation *attachment, word32 flags)\n\t: FilterWithBufferedInput(attachment)\n\t, m_verifier(verifier)\n{\n\tIsolatedInitialize(MakeParameters(Name::SignatureVerificationFilterFlags(), flags));\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsolatedInitialize",
          "args": [
            "MakeParameters(Name::SignatureVerificationFilterFlags(), flags)"
          ],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "SignerFilter::IsolatedInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "918-922",
          "snippet": "void SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::SignatureVerificationFilterFlags()",
            "flags"
          ],
          "line": 944
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::SignatureVerificationFilterFlags",
          "args": [],
          "line": 944
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nSignatureVerificationFilter::SignatureVerificationFilter(const PK_Verifier &verifier, BufferedTransformation *attachment, word32 flags)\n\t: FilterWithBufferedInput(attachment)\n\t, m_verifier(verifier)\n{\n\tIsolatedInitialize(MakeParameters(Name::SignatureVerificationFilterFlags(), flags));\n}"
  },
  {
    "function_name": "SignerFilter::Put2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "924-938",
    "snippet": "size_t SignerFilter::Put2(const byte *inString, size_t length, int messageEnd, bool blocking)\n{\n\tFILTER_BEGIN;\n\tm_messageAccumulator->Update(inString, length);\n\tif (m_putMessage)\n\t\tFILTER_OUTPUT(1, inString, length, 0);\n\tif (messageEnd)\n\t{\n\t\tm_buf.New(m_signer.SignatureLength());\n\t\tm_signer.Sign(m_rng, m_messageAccumulator.release(), m_buf);\n\t\tFILTER_OUTPUT(2, m_buf, m_buf.size(), messageEnd);\n\t\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n\t}\n\tFILTER_END_NO_MESSAGE_END;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_messageAccumulator.reset",
          "args": [
            "m_signer.NewSignatureAccumulator(m_rng)"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_signer.NewSignatureAccumulator",
          "args": [
            "m_rng"
          ],
          "line": 935
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FILTER_OUTPUT",
          "args": [
            "2",
            "m_buf",
            "m_buf.size()",
            "messageEnd"
          ],
          "line": 934
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_buf.size",
          "args": [],
          "line": 934
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_signer.Sign",
          "args": [
            "m_rng",
            "m_messageAccumulator.release()",
            "m_buf"
          ],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_messageAccumulator.release",
          "args": [],
          "line": 933
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_buf.New",
          "args": [
            "m_signer.SignatureLength()"
          ],
          "line": 932
        },
        "resolved": true,
        "details": {
          "function_name": "New",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "361-365",
          "snippet": "void New(size_type newSize)\n\t{\n\t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n\t\tm_size = newSize;\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void New(size_type newSize)\n  \t{\n  \t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n  \t\tm_size = newSize;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_signer.SignatureLength",
          "args": [],
          "line": 932
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FILTER_OUTPUT",
          "args": [
            "1",
            "inString",
            "length",
            "0"
          ],
          "line": 929
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_messageAccumulator->Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 927
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t SignerFilter::Put2(const byte *inString, size_t length, int messageEnd, bool blocking)\n{\n\tFILTER_BEGIN;\n\tm_messageAccumulator->Update(inString, length);\n\tif (m_putMessage)\n\t\tFILTER_OUTPUT(1, inString, length, 0);\n\tif (messageEnd)\n\t{\n\t\tm_buf.New(m_signer.SignatureLength());\n\t\tm_signer.Sign(m_rng, m_messageAccumulator.release(), m_buf);\n\t\tFILTER_OUTPUT(2, m_buf, m_buf.size(), messageEnd);\n\t\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n\t}\n\tFILTER_END_NO_MESSAGE_END;\n}"
  },
  {
    "function_name": "SignerFilter::IsolatedInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "918-922",
    "snippet": "void SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_messageAccumulator.reset",
          "args": [
            "m_signer.NewSignatureAccumulator(m_rng)"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_signer.NewSignatureAccumulator",
          "args": [
            "m_rng"
          ],
          "line": 921
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::PutMessage()",
            "false"
          ],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::PutMessage",
          "args": [],
          "line": 920
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}"
  },
  {
    "function_name": "AuthenticatedDecryptionFilter::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "910-914",
    "snippet": "void AuthenticatedDecryptionFilter::LastPut(const byte *inString, size_t length)\n{\n\tm_streamFilter.MessageEnd();\n\tm_hashVerifier.PutMessageEnd(inString, length);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_hashVerifier.PutMessageEnd",
          "args": [
            "inString",
            "length"
          ],
          "line": 913
        },
        "resolved": true,
        "details": {
          "function_name": "PutMessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "809-810",
          "snippet": "size_t PutMessageEnd(const byte *inString, size_t length, int propagation=-1, bool blocking=true)\n\t\t\t{return Put2(inString, length, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t PutMessageEnd(const byte *inString, size_t length, int propagation=-1, bool blocking=true)\n\t\t\t{return Put2(inString, length, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "m_streamFilter.MessageEnd",
          "args": [],
          "line": 912
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedDecryptionFilter::LastPut(const byte *inString, size_t length)\n{\n\tm_streamFilter.MessageEnd();\n\tm_hashVerifier.PutMessageEnd(inString, length);\n}"
  },
  {
    "function_name": "AuthenticatedDecryptionFilter::NextPutMultiple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "905-908",
    "snippet": "void AuthenticatedDecryptionFilter::NextPutMultiple(const byte *inString, size_t length)\n{\n\tm_streamFilter.Put(inString, length);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_streamFilter.Put",
          "args": [
            "inString",
            "length"
          ],
          "line": 907
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "42-49",
          "snippet": "inline size_t Put(const byte *begin, size_t length)\n\t{\n\t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n\t\tif (buf+m_tail != begin)\n\t\t\tmemcpy(buf+m_tail, begin, l);\n\t\tm_tail += l;\n\t\treturn l;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Put(const byte *begin, size_t length)\n  \t{\n  \t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n  \t\tif (buf+m_tail != begin)\n  \t\t\tmemcpy(buf+m_tail, begin, l);\n  \t\tm_tail += l;\n  \t\treturn l;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedDecryptionFilter::NextPutMultiple(const byte *inString, size_t length)\n{\n\tm_streamFilter.Put(inString, length);\n}"
  },
  {
    "function_name": "AuthenticatedDecryptionFilter::FirstPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "900-903",
    "snippet": "void AuthenticatedDecryptionFilter::FirstPut(const byte *inString)\n{\n\tm_hashVerifier.Put(inString, m_firstSize);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_hashVerifier.Put",
          "args": [
            "inString",
            "m_firstSize"
          ],
          "line": 902
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "42-49",
          "snippet": "inline size_t Put(const byte *begin, size_t length)\n\t{\n\t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n\t\tif (buf+m_tail != begin)\n\t\t\tmemcpy(buf+m_tail, begin, l);\n\t\tm_tail += l;\n\t\treturn l;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Put(const byte *begin, size_t length)\n  \t{\n  \t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n  \t\tif (buf+m_tail != begin)\n  \t\t\tmemcpy(buf+m_tail, begin, l);\n  \t\tm_tail += l;\n  \t\treturn l;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedDecryptionFilter::FirstPut(const byte *inString)\n{\n\tm_hashVerifier.Put(inString, m_firstSize);\n}"
  },
  {
    "function_name": "AuthenticatedDecryptionFilter::ChannelPut2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "885-898",
    "snippet": "size_t AuthenticatedDecryptionFilter::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t{\n\t\tif (m_lastSize > 0)\n\t\t\tm_hashVerifier.ForceNextPut();\n\t\treturn FilterWithBufferedInput::Put2(begin, length, messageEnd, blocking);\n\t}\n\n\tif (channel == AAD_CHANNEL)\n\t\treturn m_hashVerifier.Put2(begin, length, 0, blocking);\n\n\tthrow InvalidChannelName(\"AuthenticatedDecryptionFilter\", channel);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InvalidChannelName",
          "args": [
            "\"AuthenticatedDecryptionFilter\"",
            "channel"
          ],
          "line": 897
        },
        "resolved": true,
        "details": {
          "function_name": "InvalidChannelName",
          "container": "InvalidChannelName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "971-971",
          "snippet": "InvalidChannelName(const std::string &name, const std::string &channel) : InvalidArgument(name + \": unexpected channel name \\\"\" + channel + \"\\\"\") {}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nInvalidChannelName {\n  InvalidChannelName(const std::string &name, const std::string &channel) : InvalidArgument(name + \": unexpected channel name \\\"\" + channel + \"\\\"\") {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_hashVerifier.Put2",
          "args": [
            "begin",
            "length",
            "0",
            "blocking"
          ],
          "line": 895
        },
        "resolved": true,
        "details": {
          "function_name": "Put2",
          "container": "StringSinkTemplate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.h",
          "lines": "597-607",
          "snippet": "size_t Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n\t{\n\t\tif (length > 0)\n\t\t{\n\t\t\ttypename T::size_type size = m_output->size();\n\t\t\tif (length < size && size + length > m_output->capacity())\n\t\t\t\tm_output->reserve(2*size);\n\t\tm_output->append((const char_type *)begin, (const char_type *)begin+length);\n\t\t}\n\t\treturn 0;\n\t}",
          "includes": [
            "#include <deque>",
            "#include \"algparam.h\"",
            "#include \"queue.h\"",
            "#include \"smartptr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"simple.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include \"algparam.h\"\n#include \"queue.h\"\n#include \"smartptr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"simple.h\"\n\nStringSinkTemplate {\n  size_t Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n  \t{\n  \t\tif (length > 0)\n  \t\t{\n  \t\t\ttypename T::size_type size = m_output->size();\n  \t\t\tif (length < size && size + length > m_output->capacity())\n  \t\t\t\tm_output->reserve(2*size);\n  \t\tm_output->append((const char_type *)begin, (const char_type *)begin+length);\n  \t\t}\n  \t\treturn 0;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_hashVerifier.ForceNextPut",
          "args": [],
          "line": 890
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "channel.empty",
          "args": [],
          "line": 887
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t AuthenticatedDecryptionFilter::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t{\n\t\tif (m_lastSize > 0)\n\t\t\tm_hashVerifier.ForceNextPut();\n\t\treturn FilterWithBufferedInput::Put2(begin, length, messageEnd, blocking);\n\t}\n\n\tif (channel == AAD_CHANNEL)\n\t\treturn m_hashVerifier.Put2(begin, length, 0, blocking);\n\n\tthrow InvalidChannelName(\"AuthenticatedDecryptionFilter\", channel);\n}"
  },
  {
    "function_name": "AuthenticatedDecryptionFilter::InitializeDerivedAndReturnNewSizes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "862-872",
    "snippet": "void AuthenticatedDecryptionFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tword32 flags = parameters.GetValueWithDefault(Name::AuthenticatedDecryptionFilterFlags(), (word32)DEFAULT_FLAGS);\n\n\tm_hashVerifier.Initialize(CombinedNameValuePairs(parameters, MakeParameters(Name::HashVerificationFilterFlags(), flags)));\n\tm_streamFilter.Initialize(parameters);\n\n\tfirstSize = m_hashVerifier.m_firstSize;\n\tblockSize = 1;\n\tlastSize = m_hashVerifier.m_lastSize;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_streamFilter.Initialize",
          "args": [
            "parameters"
          ],
          "line": 867
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_hashVerifier.Initialize",
          "args": [
            "CombinedNameValuePairs(parameters, MakeParameters(Name::HashVerificationFilterFlags(), flags))"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CombinedNameValuePairs",
          "args": [
            "parameters",
            "MakeParameters(Name::HashVerificationFilterFlags(), flags)"
          ],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::HashVerificationFilterFlags()",
            "flags"
          ],
          "line": 866
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::HashVerificationFilterFlags",
          "args": [],
          "line": 866
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::AuthenticatedDecryptionFilterFlags()",
            "(word32)DEFAULT_FLAGS"
          ],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::AuthenticatedDecryptionFilterFlags",
          "args": [],
          "line": 864
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedDecryptionFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tword32 flags = parameters.GetValueWithDefault(Name::AuthenticatedDecryptionFilterFlags(), (word32)DEFAULT_FLAGS);\n\n\tm_hashVerifier.Initialize(CombinedNameValuePairs(parameters, MakeParameters(Name::HashVerificationFilterFlags(), flags)));\n\tm_streamFilter.Initialize(parameters);\n\n\tfirstSize = m_hashVerifier.m_firstSize;\n\tblockSize = 1;\n\tlastSize = m_hashVerifier.m_lastSize;\n}"
  },
  {
    "function_name": "AuthenticatedDecryptionFilter::AuthenticatedDecryptionFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "853-860",
    "snippet": "AuthenticatedDecryptionFilter::AuthenticatedDecryptionFilter(AuthenticatedSymmetricCipher &c, BufferedTransformation *attachment, word32 flags, int truncatedDigestSize, BlockPaddingScheme padding)\n\t: FilterWithBufferedInput(attachment)\n\t, m_hashVerifier(c, new OutputProxy(*this, false))\n\t, m_streamFilter(c, new OutputProxy(*this, false), padding, true)\n{\n\tassert(!c.IsForwardTransformation() || c.IsSelfInverting());\n\tIsolatedInitialize(MakeParameters(Name::BlockPaddingScheme(), padding)(Name::AuthenticatedDecryptionFilterFlags(), flags)(Name::TruncatedDigestSize(), truncatedDigestSize));\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsolatedInitialize",
          "args": [
            "MakeParameters(Name::BlockPaddingScheme(), padding)(Name::AuthenticatedDecryptionFilterFlags(), flags)(Name::TruncatedDigestSize(), truncatedDigestSize)"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "SignerFilter::IsolatedInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "918-922",
          "snippet": "void SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::TruncatedDigestSize()",
            "truncatedDigestSize"
          ],
          "line": 859
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::TruncatedDigestSize",
          "args": [],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::AuthenticatedDecryptionFilterFlags",
          "args": [],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::BlockPaddingScheme",
          "args": [],
          "line": 859
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!c.IsForwardTransformation() || c.IsSelfInverting()"
          ],
          "line": 858
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.IsSelfInverting",
          "args": [],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "IsSelfInverting",
          "container": "PublicBlumBlumShub",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.h",
          "lines": "20-20",
          "snippet": "bool IsSelfInverting() const {return true;}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nPublicBlumBlumShub {\n  bool IsSelfInverting() const {return true;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.IsForwardTransformation",
          "args": [],
          "line": 858
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": "BlockCipherFinal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "162-162",
          "snippet": "bool IsForwardTransformation() const {return DIR == ENCRYPTION;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nBlockCipherFinal {\n  bool IsForwardTransformation() const {return DIR == ENCRYPTION;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nAuthenticatedDecryptionFilter::AuthenticatedDecryptionFilter(AuthenticatedSymmetricCipher &c, BufferedTransformation *attachment, word32 flags, int truncatedDigestSize, BlockPaddingScheme padding)\n\t: FilterWithBufferedInput(attachment)\n\t, m_hashVerifier(c, new OutputProxy(*this, false))\n\t, m_streamFilter(c, new OutputProxy(*this, false), padding, true)\n{\n\tassert(!c.IsForwardTransformation() || c.IsSelfInverting());\n\tIsolatedInitialize(MakeParameters(Name::BlockPaddingScheme(), padding)(Name::AuthenticatedDecryptionFilterFlags(), flags)(Name::TruncatedDigestSize(), truncatedDigestSize));\n}"
  },
  {
    "function_name": "AuthenticatedEncryptionFilter::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "845-849",
    "snippet": "void AuthenticatedEncryptionFilter::LastPut(const byte *inString, size_t length)\n{\n\tStreamTransformationFilter::LastPut(inString, length);\n\tm_hf.MessageEnd();\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_hf.MessageEnd",
          "args": [],
          "line": 848
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "StreamTransformationFilter::LastPut",
          "args": [
            "inString",
            "length"
          ],
          "line": 847
        },
        "resolved": true,
        "details": {
          "function_name": "StreamTransformationFilter::LastPut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "622-712",
          "snippet": "void StreamTransformationFilter::LastPut(const byte *inString, size_t length)\n{\n\tbyte *space = NULL;\n\t\n\tswitch (m_padding)\n\t{\n\tcase NO_PADDING:\n\tcase ZEROS_PADDING:\n\t\tif (length > 0)\n\t\t{\n\t\t\tsize_t minLastBlockSize = m_cipher.MinLastBlockSize();\n\t\t\tbool isForwardTransformation = m_cipher.IsForwardTransformation();\n\n\t\t\tif (isForwardTransformation && m_padding == ZEROS_PADDING && (minLastBlockSize == 0 || length < minLastBlockSize))\n\t\t\t{\n\t\t\t\t// do padding\n\t\t\t\tsize_t blockSize = STDMAX(minLastBlockSize, (size_t)m_cipher.MandatoryBlockSize());\n\t\t\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, blockSize);\n\t\t\t\tmemcpy(space, inString, length);\n\t\t\t\tmemset(space + length, 0, blockSize - length);\n\t\t\t\tm_cipher.ProcessLastBlock(space, space, blockSize);\n\t\t\t\tAttachedTransformation()->Put(space, blockSize);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (minLastBlockSize == 0)\n\t\t\t\t{\n\t\t\t\t\tif (isForwardTransformation)\n\t\t\t\t\t\tthrow InvalidDataFormat(\"StreamTransformationFilter: plaintext length is not a multiple of block size and NO_PADDING is specified\");\n\t\t\t\t\telse\n\t\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: ciphertext length is not a multiple of block size\");\n\t\t\t\t}\n\n\t\t\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, length, m_optimalBufferSize);\n\t\t\t\tm_cipher.ProcessLastBlock(space, inString, length);\n\t\t\t\tAttachedTransformation()->Put(space, length);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\n\tcase PKCS_PADDING:\n\tcase ONE_AND_ZEROS_PADDING:\n\t\tunsigned int s;\n\t\ts = m_cipher.MandatoryBlockSize();\n\t\tassert(s > 1);\n\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, s, m_optimalBufferSize);\n\t\tif (m_cipher.IsForwardTransformation())\n\t\t{\n\t\t\tassert(length < s);\n\t\t\tmemcpy(space, inString, length);\n\t\t\tif (m_padding == PKCS_PADDING)\n\t\t\t{\n\t\t\t\tassert(s < 256);\n\t\t\t\tbyte pad = byte(s-length);\n\t\t\t\tmemset(space+length, pad, s-length);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tspace[length] = 0x80;\n\t\t\t\tmemset(space+length+1, 0, s-length-1);\n\t\t\t}\n\t\t\tm_cipher.ProcessData(space, space, s);\n\t\t\tAttachedTransformation()->Put(space, s);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (length != s)\n\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: ciphertext length is not a multiple of block size\");\n\t\t\tm_cipher.ProcessData(space, inString, s);\n\t\t\tif (m_padding == PKCS_PADDING)\n\t\t\t{\n\t\t\t\tbyte pad = space[s-1];\n\t\t\t\tif (pad < 1 || pad > s || std::find_if(space+s-pad, space+s, std::bind2nd(std::not_equal_to<byte>(), pad)) != space+s)\n\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: invalid PKCS #7 block padding found\");\n\t\t\t\tlength = s-pad;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (length > 1 && space[length-1] == 0)\n\t\t\t\t\t--length;\n\t\t\t\tif (space[--length] != 0x80)\n\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: invalid ones-and-zeros padding found\");\n\t\t\t}\n\t\t\tAttachedTransformation()->Put(space, length);\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tassert(false);\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StreamTransformationFilter::LastPut(const byte *inString, size_t length)\n{\n\tbyte *space = NULL;\n\t\n\tswitch (m_padding)\n\t{\n\tcase NO_PADDING:\n\tcase ZEROS_PADDING:\n\t\tif (length > 0)\n\t\t{\n\t\t\tsize_t minLastBlockSize = m_cipher.MinLastBlockSize();\n\t\t\tbool isForwardTransformation = m_cipher.IsForwardTransformation();\n\n\t\t\tif (isForwardTransformation && m_padding == ZEROS_PADDING && (minLastBlockSize == 0 || length < minLastBlockSize))\n\t\t\t{\n\t\t\t\t// do padding\n\t\t\t\tsize_t blockSize = STDMAX(minLastBlockSize, (size_t)m_cipher.MandatoryBlockSize());\n\t\t\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, blockSize);\n\t\t\t\tmemcpy(space, inString, length);\n\t\t\t\tmemset(space + length, 0, blockSize - length);\n\t\t\t\tm_cipher.ProcessLastBlock(space, space, blockSize);\n\t\t\t\tAttachedTransformation()->Put(space, blockSize);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (minLastBlockSize == 0)\n\t\t\t\t{\n\t\t\t\t\tif (isForwardTransformation)\n\t\t\t\t\t\tthrow InvalidDataFormat(\"StreamTransformationFilter: plaintext length is not a multiple of block size and NO_PADDING is specified\");\n\t\t\t\t\telse\n\t\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: ciphertext length is not a multiple of block size\");\n\t\t\t\t}\n\n\t\t\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, length, m_optimalBufferSize);\n\t\t\t\tm_cipher.ProcessLastBlock(space, inString, length);\n\t\t\t\tAttachedTransformation()->Put(space, length);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\n\tcase PKCS_PADDING:\n\tcase ONE_AND_ZEROS_PADDING:\n\t\tunsigned int s;\n\t\ts = m_cipher.MandatoryBlockSize();\n\t\tassert(s > 1);\n\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, s, m_optimalBufferSize);\n\t\tif (m_cipher.IsForwardTransformation())\n\t\t{\n\t\t\tassert(length < s);\n\t\t\tmemcpy(space, inString, length);\n\t\t\tif (m_padding == PKCS_PADDING)\n\t\t\t{\n\t\t\t\tassert(s < 256);\n\t\t\t\tbyte pad = byte(s-length);\n\t\t\t\tmemset(space+length, pad, s-length);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tspace[length] = 0x80;\n\t\t\t\tmemset(space+length+1, 0, s-length-1);\n\t\t\t}\n\t\t\tm_cipher.ProcessData(space, space, s);\n\t\t\tAttachedTransformation()->Put(space, s);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (length != s)\n\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: ciphertext length is not a multiple of block size\");\n\t\t\tm_cipher.ProcessData(space, inString, s);\n\t\t\tif (m_padding == PKCS_PADDING)\n\t\t\t{\n\t\t\t\tbyte pad = space[s-1];\n\t\t\t\tif (pad < 1 || pad > s || std::find_if(space+s-pad, space+s, std::bind2nd(std::not_equal_to<byte>(), pad)) != space+s)\n\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: invalid PKCS #7 block padding found\");\n\t\t\t\tlength = s-pad;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (length > 1 && space[length-1] == 0)\n\t\t\t\t\t--length;\n\t\t\t\tif (space[--length] != 0x80)\n\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: invalid ones-and-zeros padding found\");\n\t\t\t}\n\t\t\tAttachedTransformation()->Put(space, length);\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tassert(false);\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedEncryptionFilter::LastPut(const byte *inString, size_t length)\n{\n\tStreamTransformationFilter::LastPut(inString, length);\n\tm_hf.MessageEnd();\n}"
  },
  {
    "function_name": "AuthenticatedEncryptionFilter::ChannelPut2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "834-843",
    "snippet": "size_t AuthenticatedEncryptionFilter::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn StreamTransformationFilter::Put2(begin, length, messageEnd, blocking);\n\n\tif (channel == AAD_CHANNEL)\n\t\treturn m_hf.Put2(begin, length, 0, blocking);\n\n\tthrow InvalidChannelName(\"AuthenticatedEncryptionFilter\", channel);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InvalidChannelName",
          "args": [
            "\"AuthenticatedEncryptionFilter\"",
            "channel"
          ],
          "line": 842
        },
        "resolved": true,
        "details": {
          "function_name": "InvalidChannelName",
          "container": "InvalidChannelName",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "971-971",
          "snippet": "InvalidChannelName(const std::string &name, const std::string &channel) : InvalidArgument(name + \": unexpected channel name \\\"\" + channel + \"\\\"\") {}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nInvalidChannelName {\n  InvalidChannelName(const std::string &name, const std::string &channel) : InvalidArgument(name + \": unexpected channel name \\\"\" + channel + \"\\\"\") {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_hf.Put2",
          "args": [
            "begin",
            "length",
            "0",
            "blocking"
          ],
          "line": 840
        },
        "resolved": true,
        "details": {
          "function_name": "Put2",
          "container": "StringSinkTemplate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.h",
          "lines": "597-607",
          "snippet": "size_t Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n\t{\n\t\tif (length > 0)\n\t\t{\n\t\t\ttypename T::size_type size = m_output->size();\n\t\t\tif (length < size && size + length > m_output->capacity())\n\t\t\t\tm_output->reserve(2*size);\n\t\tm_output->append((const char_type *)begin, (const char_type *)begin+length);\n\t\t}\n\t\treturn 0;\n\t}",
          "includes": [
            "#include <deque>",
            "#include \"algparam.h\"",
            "#include \"queue.h\"",
            "#include \"smartptr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"simple.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include \"algparam.h\"\n#include \"queue.h\"\n#include \"smartptr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"simple.h\"\n\nStringSinkTemplate {\n  size_t Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n  \t{\n  \t\tif (length > 0)\n  \t\t{\n  \t\t\ttypename T::size_type size = m_output->size();\n  \t\t\tif (length < size && size + length > m_output->capacity())\n  \t\t\t\tm_output->reserve(2*size);\n  \t\tm_output->append((const char_type *)begin, (const char_type *)begin+length);\n  \t\t}\n  \t\treturn 0;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "channel.empty",
          "args": [],
          "line": 836
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t AuthenticatedEncryptionFilter::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn StreamTransformationFilter::Put2(begin, length, messageEnd, blocking);\n\n\tif (channel == AAD_CHANNEL)\n\t\treturn m_hf.Put2(begin, length, 0, blocking);\n\n\tthrow InvalidChannelName(\"AuthenticatedEncryptionFilter\", channel);\n}"
  },
  {
    "function_name": "AuthenticatedEncryptionFilter::IsolatedInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "817-821",
    "snippet": "void AuthenticatedEncryptionFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_hf.IsolatedInitialize(parameters);\n\tStreamTransformationFilter::IsolatedInitialize(parameters);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "StreamTransformationFilter::IsolatedInitialize",
          "args": [
            "parameters"
          ],
          "line": 820
        },
        "resolved": true,
        "details": {
          "function_name": "IsolatedInitialize",
          "container": "SourceTemplate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.h",
          "lines": "760-761",
          "snippet": "void IsolatedInitialize(const NameValuePairs &parameters)\n\t\t{m_store.IsolatedInitialize(parameters);}",
          "includes": [
            "#include <deque>",
            "#include \"algparam.h\"",
            "#include \"queue.h\"",
            "#include \"smartptr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"simple.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include \"algparam.h\"\n#include \"queue.h\"\n#include \"smartptr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"simple.h\"\n\nSourceTemplate {\n  void IsolatedInitialize(const NameValuePairs &parameters)\n  \t\t{m_store.IsolatedInitialize(parameters);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedEncryptionFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_hf.IsolatedInitialize(parameters);\n\tStreamTransformationFilter::IsolatedInitialize(parameters);\n}"
  },
  {
    "function_name": "AuthenticatedEncryptionFilter::AuthenticatedEncryptionFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "809-815",
    "snippet": "AuthenticatedEncryptionFilter::AuthenticatedEncryptionFilter(AuthenticatedSymmetricCipher &c, BufferedTransformation *attachment, \n\t\t\t\t\t\t\t\tbool putAAD, int truncatedDigestSize, const std::string &macChannel, BlockPaddingScheme padding)\n\t: StreamTransformationFilter(c, attachment, padding, true)\n\t, m_hf(c, new OutputProxy(*this, false), putAAD, truncatedDigestSize, AAD_CHANNEL, macChannel)\n{\n\tassert(c.IsForwardTransformation());\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "c.IsForwardTransformation()"
          ],
          "line": 814
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.IsForwardTransformation",
          "args": [],
          "line": 814
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": "BlockCipherFinal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "162-162",
          "snippet": "bool IsForwardTransformation() const {return DIR == ENCRYPTION;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nBlockCipherFinal {\n  bool IsForwardTransformation() const {return DIR == ENCRYPTION;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nAuthenticatedEncryptionFilter::AuthenticatedEncryptionFilter(AuthenticatedSymmetricCipher &c, BufferedTransformation *attachment, \n\t\t\t\t\t\t\t\tbool putAAD, int truncatedDigestSize, const std::string &macChannel, BlockPaddingScheme padding)\n\t: StreamTransformationFilter(c, attachment, padding, true)\n\t, m_hf(c, new OutputProxy(*this, false), putAAD, truncatedDigestSize, AAD_CHANNEL, macChannel)\n{\n\tassert(c.IsForwardTransformation());\n}"
  },
  {
    "function_name": "HashVerificationFilter::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "786-805",
    "snippet": "void HashVerificationFilter::LastPut(const byte *inString, size_t length)\n{\n\tif (m_flags & HASH_AT_BEGIN)\n\t{\n\t\tassert(length == 0);\n\t\tm_verified = m_hashModule.TruncatedVerify(m_expectedHash, m_digestSize);\n\t}\n\telse\n\t{\n\t\tm_verified = (length==m_digestSize && m_hashModule.TruncatedVerify(inString, length));\n\t\tif (m_flags & PUT_HASH)\n\t\t\tAttachedTransformation()->Put(inString, length);\n\t}\n\n\tif (m_flags & PUT_RESULT)\n\t\tAttachedTransformation()->Put(m_verified);\n\n\tif ((m_flags & THROW_EXCEPTION) && !m_verified)\n\t\tthrow HashVerificationFailed();\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HashVerificationFailed",
          "args": [],
          "line": 804
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "m_verified"
          ],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 801
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "length"
          ],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 797
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_hashModule.TruncatedVerify",
          "args": [
            "inString",
            "length"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedVerify",
          "container": "TruncatedHashTemplate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trunhash.h",
          "lines": "36-37",
          "snippet": "bool TruncatedVerify(const byte *digest, size_t digestLength)\n\t\t{return m_hm.TruncatedVerify(digest, digestLength);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nTruncatedHashTemplate {\n  bool TruncatedVerify(const byte *digest, size_t digestLength)\n  \t\t{return m_hm.TruncatedVerify(digest, digestLength);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length == 0"
          ],
          "line": 790
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid HashVerificationFilter::LastPut(const byte *inString, size_t length)\n{\n\tif (m_flags & HASH_AT_BEGIN)\n\t{\n\t\tassert(length == 0);\n\t\tm_verified = m_hashModule.TruncatedVerify(m_expectedHash, m_digestSize);\n\t}\n\telse\n\t{\n\t\tm_verified = (length==m_digestSize && m_hashModule.TruncatedVerify(inString, length));\n\t\tif (m_flags & PUT_HASH)\n\t\t\tAttachedTransformation()->Put(inString, length);\n\t}\n\n\tif (m_flags & PUT_RESULT)\n\t\tAttachedTransformation()->Put(m_verified);\n\n\tif ((m_flags & THROW_EXCEPTION) && !m_verified)\n\t\tthrow HashVerificationFailed();\n}"
  },
  {
    "function_name": "HashVerificationFilter::NextPutMultiple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "779-784",
    "snippet": "void HashVerificationFilter::NextPutMultiple(const byte *inString, size_t length)\n{\n\tm_hashModule.Update(inString, length);\n\tif (m_flags & PUT_MESSAGE)\n\t\tAttachedTransformation()->Put(inString, length);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "length"
          ],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 783
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_hashModule.Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid HashVerificationFilter::NextPutMultiple(const byte *inString, size_t length)\n{\n\tm_hashModule.Update(inString, length);\n\tif (m_flags & PUT_MESSAGE)\n\t\tAttachedTransformation()->Put(inString, length);\n}"
  },
  {
    "function_name": "HashVerificationFilter::FirstPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "768-777",
    "snippet": "void HashVerificationFilter::FirstPut(const byte *inString)\n{\n\tif (m_flags & HASH_AT_BEGIN)\n\t{\n\t\tm_expectedHash.New(m_digestSize);\n\t\tmemcpy(m_expectedHash, inString, m_expectedHash.size());\n\t\tif (m_flags & PUT_HASH)\n\t\t\tAttachedTransformation()->Put(inString, m_expectedHash.size());\n\t}\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "m_expectedHash.size()"
          ],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_expectedHash.size",
          "args": [],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 775
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m_expectedHash",
            "inString",
            "m_expectedHash.size()"
          ],
          "line": 773
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_expectedHash.New",
          "args": [
            "m_digestSize"
          ],
          "line": 772
        },
        "resolved": true,
        "details": {
          "function_name": "New",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "361-365",
          "snippet": "void New(size_type newSize)\n\t{\n\t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n\t\tm_size = newSize;\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void New(size_type newSize)\n  \t{\n  \t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n  \t\tm_size = newSize;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid HashVerificationFilter::FirstPut(const byte *inString)\n{\n\tif (m_flags & HASH_AT_BEGIN)\n\t{\n\t\tm_expectedHash.New(m_digestSize);\n\t\tmemcpy(m_expectedHash, inString, m_expectedHash.size());\n\t\tif (m_flags & PUT_HASH)\n\t\t\tAttachedTransformation()->Put(inString, m_expectedHash.size());\n\t}\n}"
  },
  {
    "function_name": "HashVerificationFilter::InitializeDerivedAndReturnNewSizes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "757-766",
    "snippet": "void HashVerificationFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tm_flags = parameters.GetValueWithDefault(Name::HashVerificationFilterFlags(), (word32)DEFAULT_FLAGS);\n\tint s = parameters.GetIntValueWithDefault(Name::TruncatedDigestSize(), -1);\n\tm_digestSize = s < 0 ? m_hashModule.DigestSize() : s;\n\tm_verified = false;\n\tfirstSize = m_flags & HASH_AT_BEGIN ? m_digestSize : 0;\n\tblockSize = 1;\n\tlastSize = m_flags & HASH_AT_BEGIN ? 0 : m_digestSize;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_hashModule.DigestSize",
          "args": [],
          "line": 761
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "parameters.GetIntValueWithDefault",
          "args": [
            "Name::TruncatedDigestSize()",
            "-1"
          ],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::TruncatedDigestSize",
          "args": [],
          "line": 760
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::HashVerificationFilterFlags()",
            "(word32)DEFAULT_FLAGS"
          ],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::HashVerificationFilterFlags",
          "args": [],
          "line": 759
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid HashVerificationFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tm_flags = parameters.GetValueWithDefault(Name::HashVerificationFilterFlags(), (word32)DEFAULT_FLAGS);\n\tint s = parameters.GetIntValueWithDefault(Name::TruncatedDigestSize(), -1);\n\tm_digestSize = s < 0 ? m_hashModule.DigestSize() : s;\n\tm_verified = false;\n\tfirstSize = m_flags & HASH_AT_BEGIN ? m_digestSize : 0;\n\tblockSize = 1;\n\tlastSize = m_flags & HASH_AT_BEGIN ? 0 : m_digestSize;\n}"
  },
  {
    "function_name": "HashVerificationFilter::HashVerificationFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "750-755",
    "snippet": "HashVerificationFilter::HashVerificationFilter(HashTransformation &hm, BufferedTransformation *attachment, word32 flags, int truncatedDigestSize)\n\t: FilterWithBufferedInput(attachment)\n\t, m_hashModule(hm)\n{\n\tIsolatedInitialize(MakeParameters(Name::HashVerificationFilterFlags(), flags)(Name::TruncatedDigestSize(), truncatedDigestSize));\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsolatedInitialize",
          "args": [
            "MakeParameters(Name::HashVerificationFilterFlags(), flags)(Name::TruncatedDigestSize(), truncatedDigestSize)"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "SignerFilter::IsolatedInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "918-922",
          "snippet": "void SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::TruncatedDigestSize()",
            "truncatedDigestSize"
          ],
          "line": 754
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::TruncatedDigestSize",
          "args": [],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::HashVerificationFilterFlags",
          "args": [],
          "line": 754
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nHashVerificationFilter::HashVerificationFilter(HashTransformation &hm, BufferedTransformation *attachment, word32 flags, int truncatedDigestSize)\n\t: FilterWithBufferedInput(attachment)\n\t, m_hashModule(hm)\n{\n\tIsolatedInitialize(MakeParameters(Name::HashVerificationFilterFlags(), flags)(Name::TruncatedDigestSize(), truncatedDigestSize));\n}"
  },
  {
    "function_name": "HashFilter::Put2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "730-746",
    "snippet": "size_t HashFilter::Put2(const byte *inString, size_t length, int messageEnd, bool blocking)\n{\n\tFILTER_BEGIN;\n\tif (m_putMessage)\n\t\tFILTER_OUTPUT3(1, 0, inString, length, 0, m_messagePutChannel);\n\tm_hashModule.Update(inString, length);\n\tif (messageEnd)\n\t{\n\t\t{\n\t\t\tsize_t size;\n\t\t\tm_space = HelpCreatePutSpace(*AttachedTransformation(), m_hashPutChannel, m_digestSize, m_digestSize, size = m_digestSize);\n\t\t\tm_hashModule.TruncatedFinal(m_space, m_digestSize);\n\t\t}\n\t\tFILTER_OUTPUT3(2, 0, m_space, m_digestSize, messageEnd, m_hashPutChannel);\n\t}\n\tFILTER_END_NO_MESSAGE_END;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FILTER_OUTPUT3",
          "args": [
            "2",
            "0",
            "m_space",
            "m_digestSize",
            "messageEnd",
            "m_hashPutChannel"
          ],
          "line": 743
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_hashModule.TruncatedFinal",
          "args": [
            "m_space",
            "m_digestSize"
          ],
          "line": 741
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedFinal",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "68-74",
          "snippet": "void TruncatedFinal(byte *digest, size_t digestSize)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.TruncatedFinal(digest, digestSize);\n\t\tm_keyed = false;\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void TruncatedFinal(byte *digest, size_t digestSize)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.TruncatedFinal(digest, digestSize);\n  \t\tm_keyed = false;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "HelpCreatePutSpace",
          "args": [
            "*AttachedTransformation()",
            "m_hashPutChannel",
            "m_digestSize",
            "m_digestSize",
            "size = m_digestSize"
          ],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 740
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_hashModule.Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "FILTER_OUTPUT3",
          "args": [
            "1",
            "0",
            "inString",
            "length",
            "0",
            "m_messagePutChannel"
          ],
          "line": 734
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t HashFilter::Put2(const byte *inString, size_t length, int messageEnd, bool blocking)\n{\n\tFILTER_BEGIN;\n\tif (m_putMessage)\n\t\tFILTER_OUTPUT3(1, 0, inString, length, 0, m_messagePutChannel);\n\tm_hashModule.Update(inString, length);\n\tif (messageEnd)\n\t{\n\t\t{\n\t\t\tsize_t size;\n\t\t\tm_space = HelpCreatePutSpace(*AttachedTransformation(), m_hashPutChannel, m_digestSize, m_digestSize, size = m_digestSize);\n\t\t\tm_hashModule.TruncatedFinal(m_space, m_digestSize);\n\t\t}\n\t\tFILTER_OUTPUT3(2, 0, m_space, m_digestSize, messageEnd, m_hashPutChannel);\n\t}\n\tFILTER_END_NO_MESSAGE_END;\n}"
  },
  {
    "function_name": "HashFilter::IsolatedInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "723-728",
    "snippet": "void HashFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tint s = parameters.GetIntValueWithDefault(Name::TruncatedDigestSize(), -1);\n\tm_digestSize = s < 0 ? m_hashModule.DigestSize() : s;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_hashModule.DigestSize",
          "args": [],
          "line": 727
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "parameters.GetIntValueWithDefault",
          "args": [
            "Name::TruncatedDigestSize()",
            "-1"
          ],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::TruncatedDigestSize",
          "args": [],
          "line": 726
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::PutMessage()",
            "false"
          ],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::PutMessage",
          "args": [],
          "line": 725
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid HashFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tint s = parameters.GetIntValueWithDefault(Name::TruncatedDigestSize(), -1);\n\tm_digestSize = s < 0 ? m_hashModule.DigestSize() : s;\n}"
  },
  {
    "function_name": "HashFilter::HashFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "716-721",
    "snippet": "HashFilter::HashFilter(HashTransformation &hm, BufferedTransformation *attachment, bool putMessage, int truncatedDigestSize, const std::string &messagePutChannel, const std::string &hashPutChannel)\n\t: m_hashModule(hm), m_putMessage(putMessage), m_messagePutChannel(messagePutChannel), m_hashPutChannel(hashPutChannel)\n{\n\tm_digestSize = truncatedDigestSize < 0 ? m_hashModule.DigestSize() : truncatedDigestSize;\n\tDetach(attachment);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Detach",
          "args": [
            "attachment"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "Filter::Detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "40-43",
          "snippet": "void Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_hashModule.DigestSize",
          "args": [],
          "line": 719
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nHashFilter::HashFilter(HashTransformation &hm, BufferedTransformation *attachment, bool putMessage, int truncatedDigestSize, const std::string &messagePutChannel, const std::string &hashPutChannel)\n\t: m_hashModule(hm), m_putMessage(putMessage), m_messagePutChannel(messagePutChannel), m_hashPutChannel(hashPutChannel)\n{\n\tm_digestSize = truncatedDigestSize < 0 ? m_hashModule.DigestSize() : truncatedDigestSize;\n\tDetach(attachment);\n}"
  },
  {
    "function_name": "StreamTransformationFilter::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "622-712",
    "snippet": "void StreamTransformationFilter::LastPut(const byte *inString, size_t length)\n{\n\tbyte *space = NULL;\n\t\n\tswitch (m_padding)\n\t{\n\tcase NO_PADDING:\n\tcase ZEROS_PADDING:\n\t\tif (length > 0)\n\t\t{\n\t\t\tsize_t minLastBlockSize = m_cipher.MinLastBlockSize();\n\t\t\tbool isForwardTransformation = m_cipher.IsForwardTransformation();\n\n\t\t\tif (isForwardTransformation && m_padding == ZEROS_PADDING && (minLastBlockSize == 0 || length < minLastBlockSize))\n\t\t\t{\n\t\t\t\t// do padding\n\t\t\t\tsize_t blockSize = STDMAX(minLastBlockSize, (size_t)m_cipher.MandatoryBlockSize());\n\t\t\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, blockSize);\n\t\t\t\tmemcpy(space, inString, length);\n\t\t\t\tmemset(space + length, 0, blockSize - length);\n\t\t\t\tm_cipher.ProcessLastBlock(space, space, blockSize);\n\t\t\t\tAttachedTransformation()->Put(space, blockSize);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (minLastBlockSize == 0)\n\t\t\t\t{\n\t\t\t\t\tif (isForwardTransformation)\n\t\t\t\t\t\tthrow InvalidDataFormat(\"StreamTransformationFilter: plaintext length is not a multiple of block size and NO_PADDING is specified\");\n\t\t\t\t\telse\n\t\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: ciphertext length is not a multiple of block size\");\n\t\t\t\t}\n\n\t\t\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, length, m_optimalBufferSize);\n\t\t\t\tm_cipher.ProcessLastBlock(space, inString, length);\n\t\t\t\tAttachedTransformation()->Put(space, length);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\n\tcase PKCS_PADDING:\n\tcase ONE_AND_ZEROS_PADDING:\n\t\tunsigned int s;\n\t\ts = m_cipher.MandatoryBlockSize();\n\t\tassert(s > 1);\n\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, s, m_optimalBufferSize);\n\t\tif (m_cipher.IsForwardTransformation())\n\t\t{\n\t\t\tassert(length < s);\n\t\t\tmemcpy(space, inString, length);\n\t\t\tif (m_padding == PKCS_PADDING)\n\t\t\t{\n\t\t\t\tassert(s < 256);\n\t\t\t\tbyte pad = byte(s-length);\n\t\t\t\tmemset(space+length, pad, s-length);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tspace[length] = 0x80;\n\t\t\t\tmemset(space+length+1, 0, s-length-1);\n\t\t\t}\n\t\t\tm_cipher.ProcessData(space, space, s);\n\t\t\tAttachedTransformation()->Put(space, s);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (length != s)\n\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: ciphertext length is not a multiple of block size\");\n\t\t\tm_cipher.ProcessData(space, inString, s);\n\t\t\tif (m_padding == PKCS_PADDING)\n\t\t\t{\n\t\t\t\tbyte pad = space[s-1];\n\t\t\t\tif (pad < 1 || pad > s || std::find_if(space+s-pad, space+s, std::bind2nd(std::not_equal_to<byte>(), pad)) != space+s)\n\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: invalid PKCS #7 block padding found\");\n\t\t\t\tlength = s-pad;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (length > 1 && space[length-1] == 0)\n\t\t\t\t\t--length;\n\t\t\t\tif (space[--length] != 0x80)\n\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: invalid ones-and-zeros padding found\");\n\t\t\t}\n\t\t\tAttachedTransformation()->Put(space, length);\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tassert(false);\n\t}\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "false"
          ],
          "line": 710
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "space",
            "length"
          ],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 705
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidCiphertext",
          "args": [
            "\"StreamTransformationFilter: invalid ones-and-zeros padding found\""
          ],
          "line": 703
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidCiphertext",
          "args": [
            "\"StreamTransformationFilter: invalid PKCS #7 block padding found\""
          ],
          "line": 695
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::find_if",
          "args": [
            "space+s-pad",
            "space+s",
            "std::bind2nd(std::not_equal_to<byte>(), pad)"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::bind2nd",
          "args": [
            "std::not_equal_to<byte>()",
            "pad"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::not_equal_to<byte>",
          "args": [],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.ProcessData",
          "args": [
            "space",
            "inString",
            "s"
          ],
          "line": 690
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidCiphertext",
          "args": [
            "\"StreamTransformationFilter: ciphertext length is not a multiple of block size\""
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "space",
            "s"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.ProcessData",
          "args": [
            "space",
            "space",
            "s"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "space+length+1",
            "0",
            "s-length-1"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "space+length",
            "pad",
            "s-length"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "byte",
          "args": [
            "s-length"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "s < 256"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "space",
            "inString",
            "length"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length < s"
          ],
          "line": 670
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.IsForwardTransformation",
          "args": [],
          "line": 668
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.h",
          "lines": "25-25",
          "snippet": "bool IsForwardTransformation() const {return true;}",
          "includes": [
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n\nbool IsForwardTransformation() const {return true;}"
        }
      },
      {
        "call_info": {
          "callee": "HelpCreatePutSpace",
          "args": [
            "*AttachedTransformation()",
            "DEFAULT_CHANNEL",
            "s",
            "m_optimalBufferSize"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "s > 1"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.MandatoryBlockSize",
          "args": [],
          "line": 665
        },
        "resolved": true,
        "details": {
          "function_name": "MandatoryBlockSize",
          "container": "CFB_RequireFullDataBlocks",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/strciphr.h",
          "lines": "273-273",
          "snippet": "unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}",
          "includes": [
            "#include \"strciphr.cpp\"",
            "#include \"argnames.h\"",
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.cpp\"\n#include \"argnames.h\"\n#include \"secblock.h\"\n#include \"seckey.h\"\n\nCFB_RequireFullDataBlocks {\n  unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "space",
            "length"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.ProcessLastBlock",
          "args": [
            "space",
            "inString",
            "length"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HelpCreatePutSpace",
          "args": [
            "*AttachedTransformation()",
            "DEFAULT_CHANNEL",
            "length",
            "m_optimalBufferSize"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidCiphertext",
          "args": [
            "\"StreamTransformationFilter: ciphertext length is not a multiple of block size\""
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidDataFormat",
          "args": [
            "\"StreamTransformationFilter: plaintext length is not a multiple of block size and NO_PADDING is specified\""
          ],
          "line": 650
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "space",
            "blockSize"
          ],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 643
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.ProcessLastBlock",
          "args": [
            "space",
            "space",
            "blockSize"
          ],
          "line": 642
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "space + length",
            "0",
            "blockSize - length"
          ],
          "line": 641
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "space",
            "inString",
            "length"
          ],
          "line": 640
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HelpCreatePutSpace",
          "args": [
            "*AttachedTransformation()",
            "DEFAULT_CHANNEL",
            "blockSize"
          ],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 639
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STDMAX",
          "args": [
            "minLastBlockSize",
            "(size_t)m_cipher.MandatoryBlockSize()"
          ],
          "line": 638
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.MinLastBlockSize",
          "args": [],
          "line": 632
        },
        "resolved": true,
        "details": {
          "function_name": "MinLastBlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modes.h",
          "lines": "211-211",
          "snippet": "unsigned int MinLastBlockSize() const {return BlockSize()+1;}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"argnames.h\"",
            "#include \"strciphr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"argnames.h\"\n#include \"strciphr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nunsigned int MinLastBlockSize() const {return BlockSize()+1;}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StreamTransformationFilter::LastPut(const byte *inString, size_t length)\n{\n\tbyte *space = NULL;\n\t\n\tswitch (m_padding)\n\t{\n\tcase NO_PADDING:\n\tcase ZEROS_PADDING:\n\t\tif (length > 0)\n\t\t{\n\t\t\tsize_t minLastBlockSize = m_cipher.MinLastBlockSize();\n\t\t\tbool isForwardTransformation = m_cipher.IsForwardTransformation();\n\n\t\t\tif (isForwardTransformation && m_padding == ZEROS_PADDING && (minLastBlockSize == 0 || length < minLastBlockSize))\n\t\t\t{\n\t\t\t\t// do padding\n\t\t\t\tsize_t blockSize = STDMAX(minLastBlockSize, (size_t)m_cipher.MandatoryBlockSize());\n\t\t\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, blockSize);\n\t\t\t\tmemcpy(space, inString, length);\n\t\t\t\tmemset(space + length, 0, blockSize - length);\n\t\t\t\tm_cipher.ProcessLastBlock(space, space, blockSize);\n\t\t\t\tAttachedTransformation()->Put(space, blockSize);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tif (minLastBlockSize == 0)\n\t\t\t\t{\n\t\t\t\t\tif (isForwardTransformation)\n\t\t\t\t\t\tthrow InvalidDataFormat(\"StreamTransformationFilter: plaintext length is not a multiple of block size and NO_PADDING is specified\");\n\t\t\t\t\telse\n\t\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: ciphertext length is not a multiple of block size\");\n\t\t\t\t}\n\n\t\t\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, length, m_optimalBufferSize);\n\t\t\t\tm_cipher.ProcessLastBlock(space, inString, length);\n\t\t\t\tAttachedTransformation()->Put(space, length);\n\t\t\t}\n\t\t}\n\t\tbreak;\n\n\tcase PKCS_PADDING:\n\tcase ONE_AND_ZEROS_PADDING:\n\t\tunsigned int s;\n\t\ts = m_cipher.MandatoryBlockSize();\n\t\tassert(s > 1);\n\t\tspace = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, s, m_optimalBufferSize);\n\t\tif (m_cipher.IsForwardTransformation())\n\t\t{\n\t\t\tassert(length < s);\n\t\t\tmemcpy(space, inString, length);\n\t\t\tif (m_padding == PKCS_PADDING)\n\t\t\t{\n\t\t\t\tassert(s < 256);\n\t\t\t\tbyte pad = byte(s-length);\n\t\t\t\tmemset(space+length, pad, s-length);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tspace[length] = 0x80;\n\t\t\t\tmemset(space+length+1, 0, s-length-1);\n\t\t\t}\n\t\t\tm_cipher.ProcessData(space, space, s);\n\t\t\tAttachedTransformation()->Put(space, s);\n\t\t}\n\t\telse\n\t\t{\n\t\t\tif (length != s)\n\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: ciphertext length is not a multiple of block size\");\n\t\t\tm_cipher.ProcessData(space, inString, s);\n\t\t\tif (m_padding == PKCS_PADDING)\n\t\t\t{\n\t\t\t\tbyte pad = space[s-1];\n\t\t\t\tif (pad < 1 || pad > s || std::find_if(space+s-pad, space+s, std::bind2nd(std::not_equal_to<byte>(), pad)) != space+s)\n\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: invalid PKCS #7 block padding found\");\n\t\t\t\tlength = s-pad;\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (length > 1 && space[length-1] == 0)\n\t\t\t\t\t--length;\n\t\t\t\tif (space[--length] != 0x80)\n\t\t\t\t\tthrow InvalidCiphertext(\"StreamTransformationFilter: invalid ones-and-zeros padding found\");\n\t\t\t}\n\t\t\tAttachedTransformation()->Put(space, length);\n\t\t}\n\t\tbreak;\n\n\tdefault:\n\t\tassert(false);\n\t}\n}"
  },
  {
    "function_name": "StreamTransformationFilter::NextPutModifiable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "616-620",
    "snippet": "void StreamTransformationFilter::NextPutModifiable(byte *inString, size_t length)\n{\n\tm_cipher.ProcessString(inString, length);\n\tAttachedTransformation()->PutModifiable(inString, length);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "length"
          ],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 619
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.ProcessString",
          "args": [
            "inString",
            "length"
          ],
          "line": 618
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StreamTransformationFilter::NextPutModifiable(byte *inString, size_t length)\n{\n\tm_cipher.ProcessString(inString, length);\n\tAttachedTransformation()->PutModifiable(inString, length);\n}"
  },
  {
    "function_name": "StreamTransformationFilter::NextPutMultiple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "589-614",
    "snippet": "void StreamTransformationFilter::NextPutMultiple(const byte *inString, size_t length)\n{\n\tif (!length)\n\t\treturn;\n\n\tsize_t s = m_cipher.MandatoryBlockSize();\n\n\tdo\n\t{\n\t\tsize_t len = m_optimalBufferSize;\n\t\tbyte *space = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, s, length, len);\n\t\tif (len < length)\n\t\t{\n\t\t\tif (len == m_optimalBufferSize)\n\t\t\t\tlen -= m_cipher.GetOptimalBlockSizeUsed();\n\t\t\tlen = RoundDownToMultipleOf(len, s);\n\t\t}\n\t\telse\n\t\t\tlen = length;\n\t\tm_cipher.ProcessString(space, inString, len);\n\t\tAttachedTransformation()->PutModifiable(space, len);\n\t\tinString += len;\n\t\tlength -= len;\n\t}\n\twhile (length > 0);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "space",
            "len"
          ],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 609
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.ProcessString",
          "args": [
            "space",
            "inString",
            "len"
          ],
          "line": 608
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RoundDownToMultipleOf",
          "args": [
            "len",
            "s"
          ],
          "line": 604
        },
        "resolved": true,
        "details": {
          "function_name": "RoundDownToMultipleOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "346-352",
          "snippet": "inline T1 RoundDownToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (IsPowerOf2(m))\n\t\treturn n - ModPowerOf2(n, m);\n\telse\n\t\treturn n - n%m;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 RoundDownToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (IsPowerOf2(m))\n\t\treturn n - ModPowerOf2(n, m);\n\telse\n\t\treturn n - n%m;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_cipher.GetOptimalBlockSizeUsed",
          "args": [],
          "line": 603
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HelpCreatePutSpace",
          "args": [
            "*AttachedTransformation()",
            "DEFAULT_CHANNEL",
            "s",
            "length",
            "len"
          ],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 599
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.MandatoryBlockSize",
          "args": [],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "MandatoryBlockSize",
          "container": "CFB_RequireFullDataBlocks",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/strciphr.h",
          "lines": "273-273",
          "snippet": "unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}",
          "includes": [
            "#include \"strciphr.cpp\"",
            "#include \"argnames.h\"",
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.cpp\"\n#include \"argnames.h\"\n#include \"secblock.h\"\n#include \"seckey.h\"\n\nCFB_RequireFullDataBlocks {\n  unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StreamTransformationFilter::NextPutMultiple(const byte *inString, size_t length)\n{\n\tif (!length)\n\t\treturn;\n\n\tsize_t s = m_cipher.MandatoryBlockSize();\n\n\tdo\n\t{\n\t\tsize_t len = m_optimalBufferSize;\n\t\tbyte *space = HelpCreatePutSpace(*AttachedTransformation(), DEFAULT_CHANNEL, s, length, len);\n\t\tif (len < length)\n\t\t{\n\t\t\tif (len == m_optimalBufferSize)\n\t\t\t\tlen -= m_cipher.GetOptimalBlockSizeUsed();\n\t\t\tlen = RoundDownToMultipleOf(len, s);\n\t\t}\n\t\telse\n\t\t\tlen = length;\n\t\tm_cipher.ProcessString(space, inString, len);\n\t\tAttachedTransformation()->PutModifiable(space, len);\n\t\tinString += len;\n\t\tlength -= len;\n\t}\n\twhile (length > 0);\n}"
  },
  {
    "function_name": "StreamTransformationFilter::FirstPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "583-587",
    "snippet": "void StreamTransformationFilter::FirstPut(const byte *inString)\n{\n\tm_optimalBufferSize = m_cipher.OptimalBlockSize();\n\tm_optimalBufferSize = (unsigned int)STDMAX(m_optimalBufferSize, RoundDownToMultipleOf(4096U, m_optimalBufferSize));\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STDMAX",
          "args": [
            "m_optimalBufferSize",
            "RoundDownToMultipleOf(4096U, m_optimalBufferSize)"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RoundDownToMultipleOf",
          "args": [
            "4096U",
            "m_optimalBufferSize"
          ],
          "line": 586
        },
        "resolved": true,
        "details": {
          "function_name": "RoundDownToMultipleOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "346-352",
          "snippet": "inline T1 RoundDownToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (IsPowerOf2(m))\n\t\treturn n - ModPowerOf2(n, m);\n\telse\n\t\treturn n - n%m;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 RoundDownToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (IsPowerOf2(m))\n\t\treturn n - ModPowerOf2(n, m);\n\telse\n\t\treturn n - n%m;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_cipher.OptimalBlockSize",
          "args": [],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "OptimalBlockSize",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "80-81",
          "snippet": "unsigned int OptimalBlockSize() const\n\t\t{return m_hash.OptimalBlockSize();}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  unsigned int OptimalBlockSize() const\n  \t\t{return m_hash.OptimalBlockSize();}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StreamTransformationFilter::FirstPut(const byte *inString)\n{\n\tm_optimalBufferSize = m_cipher.OptimalBlockSize();\n\tm_optimalBufferSize = (unsigned int)STDMAX(m_optimalBufferSize, RoundDownToMultipleOf(4096U, m_optimalBufferSize));\n}"
  },
  {
    "function_name": "StreamTransformationFilter::InitializeDerivedAndReturnNewSizes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "565-581",
    "snippet": "void StreamTransformationFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tBlockPaddingScheme padding = parameters.GetValueWithDefault(Name::BlockPaddingScheme(), DEFAULT_PADDING);\n\tbool isBlockCipher = (m_cipher.MandatoryBlockSize() > 1 && m_cipher.MinLastBlockSize() == 0);\n\n\tif (padding == DEFAULT_PADDING)\n\t\tm_padding = isBlockCipher ? PKCS_PADDING : NO_PADDING;\n\telse\n\t\tm_padding = padding;\n\n\tif (!isBlockCipher && (m_padding == PKCS_PADDING || m_padding == ONE_AND_ZEROS_PADDING))\n\t\tthrow InvalidArgument(\"StreamTransformationFilter: PKCS_PADDING and ONE_AND_ZEROS_PADDING cannot be used with \" + m_cipher.AlgorithmName());\n\n\tfirstSize = 0;\n\tblockSize = m_cipher.MandatoryBlockSize();\n\tlastSize = LastBlockSize(m_cipher, m_padding);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LastBlockSize",
          "args": [
            "m_cipher",
            "m_padding"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "StreamTransformationFilter::LastBlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "555-563",
          "snippet": "size_t StreamTransformationFilter::LastBlockSize(StreamTransformation &c, BlockPaddingScheme padding)\n{\n\tif (c.MinLastBlockSize() > 0)\n\t\treturn c.MinLastBlockSize();\n\telse if (c.MandatoryBlockSize() > 1 && !c.IsForwardTransformation() && padding != NO_PADDING && padding != ZEROS_PADDING)\n\t\treturn c.MandatoryBlockSize();\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t StreamTransformationFilter::LastBlockSize(StreamTransformation &c, BlockPaddingScheme padding)\n{\n\tif (c.MinLastBlockSize() > 0)\n\t\treturn c.MinLastBlockSize();\n\telse if (c.MandatoryBlockSize() > 1 && !c.IsForwardTransformation() && padding != NO_PADDING && padding != ZEROS_PADDING)\n\t\treturn c.MandatoryBlockSize();\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_cipher.MandatoryBlockSize",
          "args": [],
          "line": 579
        },
        "resolved": true,
        "details": {
          "function_name": "MandatoryBlockSize",
          "container": "CFB_RequireFullDataBlocks",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/strciphr.h",
          "lines": "273-273",
          "snippet": "unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}",
          "includes": [
            "#include \"strciphr.cpp\"",
            "#include \"argnames.h\"",
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.cpp\"\n#include \"argnames.h\"\n#include \"secblock.h\"\n#include \"seckey.h\"\n\nCFB_RequireFullDataBlocks {\n  unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"StreamTransformationFilter: PKCS_PADDING and ONE_AND_ZEROS_PADDING cannot be used with \" + m_cipher.AlgorithmName()"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_cipher.AlgorithmName",
          "args": [],
          "line": 576
        },
        "resolved": true,
        "details": {
          "function_name": "AlgorithmName",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.h",
          "lines": "393-393",
          "snippet": "std::string AlgorithmName() const {return m_signer.AlgorithmName();}",
          "includes": [
            "#include <deque>",
            "#include \"algparam.h\"",
            "#include \"queue.h\"",
            "#include \"smartptr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"simple.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include \"algparam.h\"\n#include \"queue.h\"\n#include \"smartptr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"simple.h\"\n\nstd::string AlgorithmName() const {return m_signer.AlgorithmName();}"
        }
      },
      {
        "call_info": {
          "callee": "m_cipher.MinLastBlockSize",
          "args": [],
          "line": 568
        },
        "resolved": true,
        "details": {
          "function_name": "MinLastBlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modes.h",
          "lines": "211-211",
          "snippet": "unsigned int MinLastBlockSize() const {return BlockSize()+1;}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"argnames.h\"",
            "#include \"strciphr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"argnames.h\"\n#include \"strciphr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nunsigned int MinLastBlockSize() const {return BlockSize()+1;}"
        }
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "Name::BlockPaddingScheme()",
            "DEFAULT_PADDING"
          ],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::BlockPaddingScheme",
          "args": [],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StreamTransformationFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tBlockPaddingScheme padding = parameters.GetValueWithDefault(Name::BlockPaddingScheme(), DEFAULT_PADDING);\n\tbool isBlockCipher = (m_cipher.MandatoryBlockSize() > 1 && m_cipher.MinLastBlockSize() == 0);\n\n\tif (padding == DEFAULT_PADDING)\n\t\tm_padding = isBlockCipher ? PKCS_PADDING : NO_PADDING;\n\telse\n\t\tm_padding = padding;\n\n\tif (!isBlockCipher && (m_padding == PKCS_PADDING || m_padding == ONE_AND_ZEROS_PADDING))\n\t\tthrow InvalidArgument(\"StreamTransformationFilter: PKCS_PADDING and ONE_AND_ZEROS_PADDING cannot be used with \" + m_cipher.AlgorithmName());\n\n\tfirstSize = 0;\n\tblockSize = m_cipher.MandatoryBlockSize();\n\tlastSize = LastBlockSize(m_cipher, m_padding);\n}"
  },
  {
    "function_name": "StreamTransformationFilter::LastBlockSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "555-563",
    "snippet": "size_t StreamTransformationFilter::LastBlockSize(StreamTransformation &c, BlockPaddingScheme padding)\n{\n\tif (c.MinLastBlockSize() > 0)\n\t\treturn c.MinLastBlockSize();\n\telse if (c.MandatoryBlockSize() > 1 && !c.IsForwardTransformation() && padding != NO_PADDING && padding != ZEROS_PADDING)\n\t\treturn c.MandatoryBlockSize();\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "c.MandatoryBlockSize",
          "args": [],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "MandatoryBlockSize",
          "container": "CFB_RequireFullDataBlocks",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/strciphr.h",
          "lines": "273-273",
          "snippet": "unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}",
          "includes": [
            "#include \"strciphr.cpp\"",
            "#include \"argnames.h\"",
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.cpp\"\n#include \"argnames.h\"\n#include \"secblock.h\"\n#include \"seckey.h\"\n\nCFB_RequireFullDataBlocks {\n  unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.IsForwardTransformation",
          "args": [],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": "BlockCipherFinal",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "162-162",
          "snippet": "bool IsForwardTransformation() const {return DIR == ENCRYPTION;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nBlockCipherFinal {\n  bool IsForwardTransformation() const {return DIR == ENCRYPTION;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.MinLastBlockSize",
          "args": [],
          "line": 558
        },
        "resolved": true,
        "details": {
          "function_name": "MinLastBlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modes.h",
          "lines": "211-211",
          "snippet": "unsigned int MinLastBlockSize() const {return BlockSize()+1;}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"argnames.h\"",
            "#include \"strciphr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"argnames.h\"\n#include \"strciphr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nunsigned int MinLastBlockSize() const {return BlockSize()+1;}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t StreamTransformationFilter::LastBlockSize(StreamTransformation &c, BlockPaddingScheme padding)\n{\n\tif (c.MinLastBlockSize() > 0)\n\t\treturn c.MinLastBlockSize();\n\telse if (c.MandatoryBlockSize() > 1 && !c.IsForwardTransformation() && padding != NO_PADDING && padding != ZEROS_PADDING)\n\t\treturn c.MandatoryBlockSize();\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "StreamTransformationFilter::StreamTransformationFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "543-553",
    "snippet": "StreamTransformationFilter::StreamTransformationFilter(StreamTransformation &c, BufferedTransformation *attachment, BlockPaddingScheme padding, bool allowAuthenticatedSymmetricCipher)\n   : FilterWithBufferedInput(attachment)\n\t, m_cipher(c)\n{\n\tassert(c.MinLastBlockSize() == 0 || c.MinLastBlockSize() > c.MandatoryBlockSize());\n\n\tif (!allowAuthenticatedSymmetricCipher && dynamic_cast<AuthenticatedSymmetricCipher *>(&c) != 0)\n\t\tthrow InvalidArgument(\"StreamTransformationFilter: please use AuthenticatedEncryptionFilter and AuthenticatedDecryptionFilter for AuthenticatedSymmetricCipher\");\n\n\tIsolatedInitialize(MakeParameters(Name::BlockPaddingScheme(), padding));\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsolatedInitialize",
          "args": [
            "MakeParameters(Name::BlockPaddingScheme(), padding)"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "SignerFilter::IsolatedInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "918-922",
          "snippet": "void SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::BlockPaddingScheme()",
            "padding"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::BlockPaddingScheme",
          "args": [],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"StreamTransformationFilter: please use AuthenticatedEncryptionFilter and AuthenticatedDecryptionFilter for AuthenticatedSymmetricCipher\""
          ],
          "line": 550
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dynamic_cast<AuthenticatedSymmetricCipher *>",
          "args": [
            "&c"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "c.MinLastBlockSize() == 0 || c.MinLastBlockSize() > c.MandatoryBlockSize()"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "c.MandatoryBlockSize",
          "args": [],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "MandatoryBlockSize",
          "container": "CFB_RequireFullDataBlocks",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/strciphr.h",
          "lines": "273-273",
          "snippet": "unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}",
          "includes": [
            "#include \"strciphr.cpp\"",
            "#include \"argnames.h\"",
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.cpp\"\n#include \"argnames.h\"\n#include \"secblock.h\"\n#include \"seckey.h\"\n\nCFB_RequireFullDataBlocks {\n  unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "c.MinLastBlockSize",
          "args": [],
          "line": 547
        },
        "resolved": true,
        "details": {
          "function_name": "MinLastBlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modes.h",
          "lines": "211-211",
          "snippet": "unsigned int MinLastBlockSize() const {return BlockSize()+1;}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"argnames.h\"",
            "#include \"strciphr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"argnames.h\"\n#include \"strciphr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nunsigned int MinLastBlockSize() const {return BlockSize()+1;}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nStreamTransformationFilter::StreamTransformationFilter(StreamTransformation &c, BufferedTransformation *attachment, BlockPaddingScheme padding, bool allowAuthenticatedSymmetricCipher)\n   : FilterWithBufferedInput(attachment)\n\t, m_cipher(c)\n{\n\tassert(c.MinLastBlockSize() == 0 || c.MinLastBlockSize() > c.MandatoryBlockSize());\n\n\tif (!allowAuthenticatedSymmetricCipher && dynamic_cast<AuthenticatedSymmetricCipher *>(&c) != 0)\n\t\tthrow InvalidArgument(\"StreamTransformationFilter: please use AuthenticatedEncryptionFilter and AuthenticatedDecryptionFilter for AuthenticatedSymmetricCipher\");\n\n\tIsolatedInitialize(MakeParameters(Name::BlockPaddingScheme(), padding));\n}"
  },
  {
    "function_name": "ArrayXorSink::Put2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "534-539",
    "snippet": "size_t ArrayXorSink::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\txorbuf(m_buf+m_total, begin, STDMIN(length, SaturatingSubtract(m_size, m_total)));\n\tm_total += length;\n\treturn 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xorbuf",
          "args": [
            "m_buf+m_total",
            "begin",
            "STDMIN(length, SaturatingSubtract(m_size, m_total))"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "xorbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.cpp",
          "lines": "17-45",
          "snippet": "void xorbuf(byte *buf, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(buf) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(buf) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)buf)[i] ^= ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\tbuf += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)buf)[i] ^= ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\tbuf += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\tbuf[i] ^= mask[i];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <new>",
            "#include \"words.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <new>\n#include \"words.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid xorbuf(byte *buf, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(buf) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(buf) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)buf)[i] ^= ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\tbuf += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)buf)[i] ^= ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\tbuf += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\tbuf[i] ^= mask[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "STDMIN",
          "args": [
            "length",
            "SaturatingSubtract(m_size, m_total)"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SaturatingSubtract",
          "args": [
            "m_size",
            "m_total"
          ],
          "line": 536
        },
        "resolved": true,
        "details": {
          "function_name": "SaturatingSubtract",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "432-435",
          "snippet": "inline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t ArrayXorSink::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\txorbuf(m_buf+m_total, begin, STDMIN(length, SaturatingSubtract(m_size, m_total)));\n\tm_total += length;\n\treturn 0;\n}"
  },
  {
    "function_name": "ArraySink::IsolatedInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "524-532",
    "snippet": "void ArraySink::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tByteArrayParameter array;\n\tif (!parameters.GetValue(Name::OutputBuffer(), array))\n\t\tthrow InvalidArgument(\"ArraySink: missing OutputBuffer argument\");\n\tm_buf = array.begin();\n\tm_size = array.size();\n\tm_total = 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "array.size",
          "args": [],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "array.begin",
          "args": [],
          "line": 529
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"ArraySink: missing OutputBuffer argument\""
          ],
          "line": 528
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValue",
          "args": [
            "Name::OutputBuffer()",
            "array"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::OutputBuffer",
          "args": [],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ArraySink::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tByteArrayParameter array;\n\tif (!parameters.GetValue(Name::OutputBuffer(), array))\n\t\tthrow InvalidArgument(\"ArraySink: missing OutputBuffer argument\");\n\tm_buf = array.begin();\n\tm_size = array.size();\n\tm_total = 0;\n}"
  },
  {
    "function_name": "ArraySink::Put2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "510-516",
    "snippet": "size_t ArraySink::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (m_buf+m_total != begin)\n\t\tmemcpy(m_buf+m_total, begin, STDMIN(length, SaturatingSubtract(m_size, m_total)));\n\tm_total += length;\n\treturn 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m_buf+m_total",
            "begin",
            "STDMIN(length, SaturatingSubtract(m_size, m_total))"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STDMIN",
          "args": [
            "length",
            "SaturatingSubtract(m_size, m_total)"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SaturatingSubtract",
          "args": [
            "m_size",
            "m_total"
          ],
          "line": 513
        },
        "resolved": true,
        "details": {
          "function_name": "SaturatingSubtract",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "432-435",
          "snippet": "inline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t ArraySink::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (m_buf+m_total != begin)\n\t\tmemcpy(m_buf+m_total, begin, STDMIN(length, SaturatingSubtract(m_size, m_total)));\n\tm_total += length;\n\treturn 0;\n}"
  },
  {
    "function_name": "RandomNumberSink::Put2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "504-508",
    "snippet": "size_t RandomNumberSink::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tm_rng->IncorporateEntropy(begin, length);\n\treturn 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_rng->IncorporateEntropy",
          "args": [
            "begin",
            "length"
          ],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "IncorporateEntropy",
          "container": "AutoSeededX917RNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/osrng.h",
          "lines": "108-108",
          "snippet": "void IncorporateEntropy(const byte *input, size_t length) {Reseed(false, input, length);}",
          "includes": [
            "#include \"fips140.h\"",
            "#include \"sha.h\"",
            "#include \"aes.h\"",
            "#include \"rng.h\"",
            "#include \"randpool.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"fips140.h\"\n#include \"sha.h\"\n#include \"aes.h\"\n#include \"rng.h\"\n#include \"randpool.h\"\n#include \"config.h\"\n\nAutoSeededX917RNG {\n  void IncorporateEntropy(const byte *input, size_t length) {Reseed(false, input, length);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t RandomNumberSink::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tm_rng->IncorporateEntropy(begin, length);\n\treturn 0;\n}"
  },
  {
    "function_name": "RandomNumberSink::IsolatedInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "499-502",
    "snippet": "void RandomNumberSink::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tparameters.GetRequiredParameter(\"RandomNumberSink\", \"RandomNumberGeneratorPointer\", m_rng);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parameters.GetRequiredParameter",
          "args": [
            "\"RandomNumberSink\"",
            "\"RandomNumberGeneratorPointer\"",
            "m_rng"
          ],
          "line": 501
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid RandomNumberSink::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tparameters.GetRequiredParameter(\"RandomNumberSink\", \"RandomNumberGeneratorPointer\", m_rng);\n}"
  },
  {
    "function_name": "ProxyFilter::NextPutModifiable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "491-495",
    "snippet": "void ProxyFilter::NextPutModifiable(byte *s, size_t len)\n{\n\tif (m_filter.get())\n\t\tm_filter->PutModifiable(s, len);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->PutModifiable",
          "args": [
            "s",
            "len"
          ],
          "line": 494
        },
        "resolved": true,
        "details": {
          "function_name": "PutModifiable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "804-805",
          "snippet": "size_t PutModifiable(byte *inString, size_t length, bool blocking=true)\n\t\t\t{return PutModifiable2(inString, length, 0, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t PutModifiable(byte *inString, size_t length, bool blocking=true)\n\t\t\t{return PutModifiable2(inString, length, 0, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "m_filter.get",
          "args": [],
          "line": 493
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::NextPutModifiable(byte *s, size_t len)\n{\n\tif (m_filter.get())\n\t\tm_filter->PutModifiable(s, len);\n}"
  },
  {
    "function_name": "ProxyFilter::NextPutMultiple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "485-489",
    "snippet": "void ProxyFilter::NextPutMultiple(const byte *s, size_t len)\n{\n\tif (m_filter.get())\n\t\tm_filter->Put(s, len);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->Put",
          "args": [
            "s",
            "len"
          ],
          "line": 488
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "42-49",
          "snippet": "inline size_t Put(const byte *begin, size_t length)\n\t{\n\t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n\t\tif (buf+m_tail != begin)\n\t\t\tmemcpy(buf+m_tail, begin, l);\n\t\tm_tail += l;\n\t\treturn l;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Put(const byte *begin, size_t length)\n  \t{\n  \t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n  \t\tif (buf+m_tail != begin)\n  \t\t\tmemcpy(buf+m_tail, begin, l);\n  \t\tm_tail += l;\n  \t\treturn l;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_filter.get",
          "args": [],
          "line": 487
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::NextPutMultiple(const byte *s, size_t len)\n{\n\tif (m_filter.get())\n\t\tm_filter->Put(s, len);\n}"
  },
  {
    "function_name": "ProxyFilter::SetFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "473-483",
    "snippet": "void ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->Attach",
          "args": [
            "temp.release()"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "temp.release",
          "args": [],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_filter->TransferAllTo",
          "args": [
            "*proxy"
          ],
          "line": 480
        },
        "resolved": true,
        "details": {
          "function_name": "TransferAllTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "944-945",
          "snippet": "void TransferAllTo(BufferedTransformation &target, const std::string &channel=DEFAULT_CHANNEL)\n\t\t\t{TransferAllTo2(target, channel);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvoid TransferAllTo(BufferedTransformation &target, const std::string &channel=DEFAULT_CHANNEL)\n\t\t\t{TransferAllTo2(target, channel);}"
        }
      },
      {
        "call_info": {
          "callee": "m_filter.reset",
          "args": [
            "filter"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}"
  },
  {
    "function_name": "ProxyFilter::IsolatedFlush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "468-471",
    "snippet": "bool ProxyFilter::IsolatedFlush(bool hardFlush, bool blocking)\n{\n\treturn m_filter.get() ? m_filter->Flush(hardFlush, -1, blocking) : false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->Flush",
          "args": [
            "hardFlush",
            "-1",
            "blocking"
          ],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_filter.get",
          "args": [],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool ProxyFilter::IsolatedFlush(bool hardFlush, bool blocking)\n{\n\treturn m_filter.get() ? m_filter->Flush(hardFlush, -1, blocking) : false;\n}"
  },
  {
    "function_name": "ProxyFilter::ProxyFilter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "461-466",
    "snippet": "ProxyFilter::ProxyFilter(BufferedTransformation *filter, size_t firstSize, size_t lastSize, BufferedTransformation *attachment)\n\t: FilterWithBufferedInput(firstSize, 1, lastSize, attachment), m_filter(filter)\n{\n\tif (m_filter.get())\n\t\tm_filter->Attach(new OutputProxy(*this, false));\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->Attach",
          "args": [
            "new OutputProxy(*this, false)"
          ],
          "line": 465
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_filter.get",
          "args": [],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nProxyFilter::ProxyFilter(BufferedTransformation *filter, size_t firstSize, size_t lastSize, BufferedTransformation *attachment)\n\t: FilterWithBufferedInput(firstSize, 1, lastSize, attachment), m_filter(filter)\n{\n\tif (m_filter.get())\n\t\tm_filter->Attach(new OutputProxy(*this, false));\n}"
  },
  {
    "function_name": "Redirector::Initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "450-457",
    "snippet": "void Redirector::Initialize(const NameValuePairs &parameters, int propagation)\n{\n\tm_target = parameters.GetValueWithDefault(\"RedirectionTargetPointer\", (BufferedTransformation*)NULL);\n\tm_behavior = parameters.GetIntValueWithDefault(\"RedirectionBehavior\", PASS_EVERYTHING);\n\n\tif (m_target && GetPassSignals())\n\t\tm_target->Initialize(parameters, propagation);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_target->Initialize",
          "args": [
            "parameters",
            "propagation"
          ],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "Initialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rw.h",
          "lines": "54-55",
          "snippet": "void Initialize(RandomNumberGenerator &rng, unsigned int modulusBits)\n\t\t{GenerateRandomWithKeySize(rng, modulusBits);}",
          "includes": [
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n\nvoid Initialize(RandomNumberGenerator &rng, unsigned int modulusBits)\n\t\t{GenerateRandomWithKeySize(rng, modulusBits);}"
        }
      },
      {
        "call_info": {
          "callee": "GetPassSignals",
          "args": [],
          "line": 455
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetIntValueWithDefault",
          "args": [
            "\"RedirectionBehavior\"",
            "PASS_EVERYTHING"
          ],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.GetValueWithDefault",
          "args": [
            "\"RedirectionTargetPointer\"",
            "(BufferedTransformation*)NULL"
          ],
          "line": 452
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Redirector::Initialize(const NameValuePairs &parameters, int propagation)\n{\n\tm_target = parameters.GetValueWithDefault(\"RedirectionTargetPointer\", (BufferedTransformation*)NULL);\n\tm_behavior = parameters.GetIntValueWithDefault(\"RedirectionBehavior\", PASS_EVERYTHING);\n\n\tif (m_target && GetPassSignals())\n\t\tm_target->Initialize(parameters, propagation);\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::NextPutMultiple",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "436-446",
    "snippet": "void FilterWithBufferedInput::NextPutMultiple(const byte *inString, size_t length)\n{\n\tassert(m_blockSize > 1);\t// m_blockSize = 1 should always override this function\n\twhile (length > 0)\n\t{\n\t\tassert(length >= m_blockSize);\n\t\tNextPutSingle(inString);\n\t\tinString += m_blockSize;\n\t\tlength -= m_blockSize;\n\t}\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NextPutSingle",
          "args": [
            "inString"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length >= m_blockSize"
          ],
          "line": 441
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_blockSize > 1"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid FilterWithBufferedInput::NextPutMultiple(const byte *inString, size_t length)\n{\n\tassert(m_blockSize > 1);\t// m_blockSize = 1 should always override this function\n\twhile (length > 0)\n\t{\n\t\tassert(length >= m_blockSize);\n\t\tNextPutSingle(inString);\n\t\tinString += m_blockSize;\n\t\tlength -= m_blockSize;\n\t}\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::ForceNextPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "418-434",
    "snippet": "void FilterWithBufferedInput::ForceNextPut()\n{\n\tif (!m_firstInputDone)\n\t\treturn;\n\t\n\tif (m_blockSize > 1)\n\t{\n\t\twhile (m_queue.CurrentSize() >= m_blockSize)\n\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t}\n\telse\n\t{\n\t\tsize_t len;\n\t\twhile ((len = m_queue.CurrentSize()) > 0)\n\t\t\tNextPutModifiable(m_queue.GetContigousBlocks(len), len);\n\t}\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NextPutModifiable",
          "args": [
            "m_queue.GetContigousBlocks(len)",
            "len"
          ],
          "line": 432
        },
        "resolved": true,
        "details": {
          "function_name": "StreamTransformationFilter::NextPutModifiable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "616-620",
          "snippet": "void StreamTransformationFilter::NextPutModifiable(byte *inString, size_t length)\n{\n\tm_cipher.ProcessString(inString, length);\n\tAttachedTransformation()->PutModifiable(inString, length);\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StreamTransformationFilter::NextPutModifiable(byte *inString, size_t length)\n{\n\tm_cipher.ProcessString(inString, length);\n\tAttachedTransformation()->PutModifiable(inString, length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_queue.GetContigousBlocks",
          "args": [
            "len"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_queue.CurrentSize",
          "args": [],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentSize",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "27-30",
          "snippet": "inline size_t CurrentSize() const\n\t{\n\t\treturn m_tail-m_head;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t CurrentSize() const\n  \t{\n  \t\treturn m_tail-m_head;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_queue.GetBlock",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid FilterWithBufferedInput::ForceNextPut()\n{\n\tif (!m_firstInputDone)\n\t\treturn;\n\t\n\tif (m_blockSize > 1)\n\t{\n\t\twhile (m_queue.CurrentSize() >= m_blockSize)\n\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t}\n\telse\n\t{\n\t\tsize_t len;\n\t\twhile ((len = m_queue.CurrentSize()) > 0)\n\t\t\tNextPutModifiable(m_queue.GetContigousBlocks(len), len);\n\t}\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::PutMaybeModifiable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "328-416",
    "snippet": "size_t FilterWithBufferedInput::PutMaybeModifiable(byte *inString, size_t length, int messageEnd, bool blocking, bool modifiable)\n{\n\tif (!blocking)\n\t\tthrow BlockingInputOnly(\"FilterWithBufferedInput\");\n\n\tif (length != 0)\n\t{\n\t\tsize_t newLength = m_queue.CurrentSize() + length;\n\n\t\tif (!m_firstInputDone && newLength >= m_firstSize)\n\t\t{\n\t\t\tsize_t len = m_firstSize - m_queue.CurrentSize();\n\t\t\tm_queue.Put(inString, len);\n\t\t\tFirstPut(m_queue.GetContigousBlocks(m_firstSize));\n\t\t\tassert(m_queue.CurrentSize() == 0);\n\t\t\tm_queue.ResetQueue(m_blockSize, (2*m_blockSize+m_lastSize-2)/m_blockSize);\n\n\t\t\tinString += len;\n\t\t\tnewLength -= m_firstSize;\n\t\t\tm_firstInputDone = true;\n\t\t}\n\n\t\tif (m_firstInputDone)\n\t\t{\n\t\t\tif (m_blockSize == 1)\n\t\t\t{\n\t\t\t\twhile (newLength > m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tbyte *ptr = m_queue.GetContigousBlocks(len);\n\t\t\t\t\tNextPutModifiable(ptr, len);\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\n\t\t\t\tif (newLength > m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() >= m_blockSize)\n\t\t\t\t{\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tassert(m_queue.CurrentSize() < m_blockSize);\n\t\t\t\t\tsize_t len = m_blockSize - m_queue.CurrentSize();\n\t\t\t\t\tm_queue.Put(inString, len);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = RoundDownToMultipleOf(newLength - m_lastSize, m_blockSize);\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tm_queue.Put(inString, newLength - m_queue.CurrentSize());\n\t}\n\n\tif (messageEnd)\n\t{\n\t\tif (!m_firstInputDone && m_firstSize==0)\n\t\t\tFirstPut(NULL);\n\n\t\tSecByteBlock temp(m_queue.CurrentSize());\n\t\tm_queue.GetAll(temp);\n\t\tLastPut(temp, temp.size());\n\n\t\tm_firstInputDone = false;\n\t\tm_queue.ResetQueue(1, m_firstSize);\n\n\t\tOutput(1, NULL, 0, messageEnd, blocking);\n\t}\n\treturn 0;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Output",
          "args": [
            "1",
            "NULL",
            "0",
            "messageEnd",
            "blocking"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_queue.ResetQueue",
          "args": [
            "1",
            "m_firstSize"
          ],
          "line": 411
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LastPut",
          "args": [
            "temp",
            "temp.size()"
          ],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "SignatureVerificationFilter::LastPut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "987-1008",
          "snippet": "void SignatureVerificationFilter::LastPut(const byte *inString, size_t length)\n{\n\tif (m_flags & SIGNATURE_AT_BEGIN)\n\t{\n\t\tassert(length == 0);\n\t\tm_verifier.InputSignature(*m_messageAccumulator, m_signature, m_signature.size());\n\t\tm_verified = m_verifier.VerifyAndRestart(*m_messageAccumulator);\n\t}\n\telse\n\t{\n\t\tm_verifier.InputSignature(*m_messageAccumulator, inString, length);\n\t\tm_verified = m_verifier.VerifyAndRestart(*m_messageAccumulator);\n\t\tif (m_flags & PUT_SIGNATURE)\n\t\t\tAttachedTransformation()->Put(inString, length);\n\t}\n\n\tif (m_flags & PUT_RESULT)\n\t\tAttachedTransformation()->Put(m_verified);\n\n\tif ((m_flags & THROW_EXCEPTION) && !m_verified)\n\t\tthrow SignatureVerificationFailed();\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignatureVerificationFilter::LastPut(const byte *inString, size_t length)\n{\n\tif (m_flags & SIGNATURE_AT_BEGIN)\n\t{\n\t\tassert(length == 0);\n\t\tm_verifier.InputSignature(*m_messageAccumulator, m_signature, m_signature.size());\n\t\tm_verified = m_verifier.VerifyAndRestart(*m_messageAccumulator);\n\t}\n\telse\n\t{\n\t\tm_verifier.InputSignature(*m_messageAccumulator, inString, length);\n\t\tm_verified = m_verifier.VerifyAndRestart(*m_messageAccumulator);\n\t\tif (m_flags & PUT_SIGNATURE)\n\t\t\tAttachedTransformation()->Put(inString, length);\n\t}\n\n\tif (m_flags & PUT_RESULT)\n\t\tAttachedTransformation()->Put(m_verified);\n\n\tif ((m_flags & THROW_EXCEPTION) && !m_verified)\n\t\tthrow SignatureVerificationFailed();\n}"
        }
      },
      {
        "call_info": {
          "callee": "temp.size",
          "args": [],
          "line": 408
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_queue.GetAll",
          "args": [
            "temp"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_queue.CurrentSize",
          "args": [],
          "line": 406
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentSize",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "27-30",
          "snippet": "inline size_t CurrentSize() const\n\t{\n\t\treturn m_tail-m_head;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t CurrentSize() const\n  \t{\n  \t\treturn m_tail-m_head;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "FirstPut",
          "args": [
            "NULL"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "SignatureVerificationFilter::FirstPut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "959-978",
          "snippet": "void SignatureVerificationFilter::FirstPut(const byte *inString)\n{\n\tif (m_flags & SIGNATURE_AT_BEGIN)\n\t{\n\t\tif (m_verifier.SignatureUpfront())\n\t\t\tm_verifier.InputSignature(*m_messageAccumulator, inString, m_verifier.SignatureLength());\n\t\telse\n\t\t{\n\t\t\tm_signature.New(m_verifier.SignatureLength());\n\t\t\tmemcpy(m_signature, inString, m_signature.size());\n\t\t}\n\n\t\tif (m_flags & PUT_SIGNATURE)\n\t\t\tAttachedTransformation()->Put(inString, m_signature.size());\n\t}\n\telse\n\t{\n\t\tassert(!m_verifier.SignatureUpfront());\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignatureVerificationFilter::FirstPut(const byte *inString)\n{\n\tif (m_flags & SIGNATURE_AT_BEGIN)\n\t{\n\t\tif (m_verifier.SignatureUpfront())\n\t\t\tm_verifier.InputSignature(*m_messageAccumulator, inString, m_verifier.SignatureLength());\n\t\telse\n\t\t{\n\t\t\tm_signature.New(m_verifier.SignatureLength());\n\t\t\tmemcpy(m_signature, inString, m_signature.size());\n\t\t}\n\n\t\tif (m_flags & PUT_SIGNATURE)\n\t\t\tAttachedTransformation()->Put(inString, m_signature.size());\n\t}\n\telse\n\t{\n\t\tassert(!m_verifier.SignatureUpfront());\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_queue.Put",
          "args": [
            "inString",
            "newLength - m_queue.CurrentSize()"
          ],
          "line": 398
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "42-49",
          "snippet": "inline size_t Put(const byte *begin, size_t length)\n\t{\n\t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n\t\tif (buf+m_tail != begin)\n\t\t\tmemcpy(buf+m_tail, begin, l);\n\t\tm_tail += l;\n\t\treturn l;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Put(const byte *begin, size_t length)\n  \t{\n  \t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n  \t\tif (buf+m_tail != begin)\n  \t\t\tmemcpy(buf+m_tail, begin, l);\n  \t\tm_tail += l;\n  \t\treturn l;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "NextPutMaybeModifiable",
          "args": [
            "inString",
            "len",
            "modifiable"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RoundDownToMultipleOf",
          "args": [
            "newLength - m_lastSize",
            "m_blockSize"
          ],
          "line": 390
        },
        "resolved": true,
        "details": {
          "function_name": "RoundDownToMultipleOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "346-352",
          "snippet": "inline T1 RoundDownToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (IsPowerOf2(m))\n\t\treturn n - ModPowerOf2(n, m);\n\telse\n\t\treturn n - n%m;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 RoundDownToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (IsPowerOf2(m))\n\t\treturn n - ModPowerOf2(n, m);\n\telse\n\t\treturn n - n%m;\n}"
        }
      },
      {
        "call_info": {
          "callee": "NextPutModifiable",
          "args": [
            "m_queue.GetBlock()",
            "m_blockSize"
          ],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "StreamTransformationFilter::NextPutModifiable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "616-620",
          "snippet": "void StreamTransformationFilter::NextPutModifiable(byte *inString, size_t length)\n{\n\tm_cipher.ProcessString(inString, length);\n\tAttachedTransformation()->PutModifiable(inString, length);\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid StreamTransformationFilter::NextPutModifiable(byte *inString, size_t length)\n{\n\tm_cipher.ProcessString(inString, length);\n\tAttachedTransformation()->PutModifiable(inString, length);\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_queue.GetBlock",
          "args": [],
          "line": 384
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_queue.CurrentSize() < m_blockSize"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_queue.GetBlock",
          "args": [],
          "line": 374
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NextPutMaybeModifiable",
          "args": [
            "inString",
            "len",
            "modifiable"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_queue.GetContigousBlocks",
          "args": [
            "len"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_queue.ResetQueue",
          "args": [
            "m_blockSize",
            "(2*m_blockSize+m_lastSize-2)/m_blockSize"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_queue.CurrentSize() == 0"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_queue.GetContigousBlocks",
          "args": [
            "m_firstSize"
          ],
          "line": 341
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BlockingInputOnly",
          "args": [
            "\"FilterWithBufferedInput\""
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "BlockingInputOnly",
          "container": "BlockingInputOnly",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "822-822",
          "snippet": "BlockingInputOnly(const std::string &s) : NotImplemented(s + \": Nonblocking input is not implemented by this object.\") {}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nBlockingInputOnly {\n  BlockingInputOnly(const std::string &s) : NotImplemented(s + \": Nonblocking input is not implemented by this object.\") {}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t FilterWithBufferedInput::PutMaybeModifiable(byte *inString, size_t length, int messageEnd, bool blocking, bool modifiable)\n{\n\tif (!blocking)\n\t\tthrow BlockingInputOnly(\"FilterWithBufferedInput\");\n\n\tif (length != 0)\n\t{\n\t\tsize_t newLength = m_queue.CurrentSize() + length;\n\n\t\tif (!m_firstInputDone && newLength >= m_firstSize)\n\t\t{\n\t\t\tsize_t len = m_firstSize - m_queue.CurrentSize();\n\t\t\tm_queue.Put(inString, len);\n\t\t\tFirstPut(m_queue.GetContigousBlocks(m_firstSize));\n\t\t\tassert(m_queue.CurrentSize() == 0);\n\t\t\tm_queue.ResetQueue(m_blockSize, (2*m_blockSize+m_lastSize-2)/m_blockSize);\n\n\t\t\tinString += len;\n\t\t\tnewLength -= m_firstSize;\n\t\t\tm_firstInputDone = true;\n\t\t}\n\n\t\tif (m_firstInputDone)\n\t\t{\n\t\t\tif (m_blockSize == 1)\n\t\t\t{\n\t\t\t\twhile (newLength > m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tbyte *ptr = m_queue.GetContigousBlocks(len);\n\t\t\t\t\tNextPutModifiable(ptr, len);\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\n\t\t\t\tif (newLength > m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() >= m_blockSize)\n\t\t\t\t{\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tassert(m_queue.CurrentSize() < m_blockSize);\n\t\t\t\t\tsize_t len = m_blockSize - m_queue.CurrentSize();\n\t\t\t\t\tm_queue.Put(inString, len);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = RoundDownToMultipleOf(newLength - m_lastSize, m_blockSize);\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tm_queue.Put(inString, newLength - m_queue.CurrentSize());\n\t}\n\n\tif (messageEnd)\n\t{\n\t\tif (!m_firstInputDone && m_firstSize==0)\n\t\t\tFirstPut(NULL);\n\n\t\tSecByteBlock temp(m_queue.CurrentSize());\n\t\tm_queue.GetAll(temp);\n\t\tLastPut(temp, temp.size());\n\n\t\tm_firstInputDone = false;\n\t\tm_queue.ResetQueue(1, m_firstSize);\n\n\t\tOutput(1, NULL, 0, messageEnd, blocking);\n\t}\n\treturn 0;\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::IsolatedFlush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "316-326",
    "snippet": "bool FilterWithBufferedInput::IsolatedFlush(bool hardFlush, bool blocking)\n{\n\tif (!blocking)\n\t\tthrow BlockingInputOnly(\"FilterWithBufferedInput\");\n\t\n\tif (hardFlush)\n\t\tForceNextPut();\n\tFlushDerived();\n\t\n\treturn false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FlushDerived",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ForceNextPut",
          "args": [],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "FilterWithBufferedInput::ForceNextPut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "418-434",
          "snippet": "void FilterWithBufferedInput::ForceNextPut()\n{\n\tif (!m_firstInputDone)\n\t\treturn;\n\t\n\tif (m_blockSize > 1)\n\t{\n\t\twhile (m_queue.CurrentSize() >= m_blockSize)\n\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t}\n\telse\n\t{\n\t\tsize_t len;\n\t\twhile ((len = m_queue.CurrentSize()) > 0)\n\t\t\tNextPutModifiable(m_queue.GetContigousBlocks(len), len);\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid FilterWithBufferedInput::ForceNextPut()\n{\n\tif (!m_firstInputDone)\n\t\treturn;\n\t\n\tif (m_blockSize > 1)\n\t{\n\t\twhile (m_queue.CurrentSize() >= m_blockSize)\n\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t}\n\telse\n\t{\n\t\tsize_t len;\n\t\twhile ((len = m_queue.CurrentSize()) > 0)\n\t\t\tNextPutModifiable(m_queue.GetContigousBlocks(len), len);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BlockingInputOnly",
          "args": [
            "\"FilterWithBufferedInput\""
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "BlockingInputOnly",
          "container": "BlockingInputOnly",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "822-822",
          "snippet": "BlockingInputOnly(const std::string &s) : NotImplemented(s + \": Nonblocking input is not implemented by this object.\") {}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nBlockingInputOnly {\n  BlockingInputOnly(const std::string &s) : NotImplemented(s + \": Nonblocking input is not implemented by this object.\") {}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool FilterWithBufferedInput::IsolatedFlush(bool hardFlush, bool blocking)\n{\n\tif (!blocking)\n\t\tthrow BlockingInputOnly(\"FilterWithBufferedInput\");\n\t\n\tif (hardFlush)\n\t\tForceNextPut();\n\tFlushDerived();\n\t\n\treturn false;\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::IsolatedInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "307-314",
    "snippet": "void FilterWithBufferedInput::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tInitializeDerivedAndReturnNewSizes(parameters, m_firstSize, m_blockSize, m_lastSize);\n\tif (m_firstSize < 0 || m_blockSize < 1 || m_lastSize < 0)\n\t\tthrow InvalidArgument(\"FilterWithBufferedInput: invalid buffer size\");\n\tm_queue.ResetQueue(1, m_firstSize);\n\tm_firstInputDone = false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_queue.ResetQueue",
          "args": [
            "1",
            "m_firstSize"
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"FilterWithBufferedInput: invalid buffer size\""
          ],
          "line": 311
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InitializeDerivedAndReturnNewSizes",
          "args": [
            "parameters",
            "m_firstSize",
            "m_blockSize",
            "m_lastSize"
          ],
          "line": 309
        },
        "resolved": true,
        "details": {
          "function_name": "SignatureVerificationFilter::InitializeDerivedAndReturnNewSizes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "947-957",
          "snippet": "void SignatureVerificationFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tm_flags = parameters.GetValueWithDefault(Name::SignatureVerificationFilterFlags(), (word32)DEFAULT_FLAGS);\n\tm_messageAccumulator.reset(m_verifier.NewVerificationAccumulator());\n\tsize_t size = m_verifier.SignatureLength();\n\tassert(size != 0);\t// TODO: handle recoverable signature scheme\n\tm_verified = false;\n\tfirstSize = m_flags & SIGNATURE_AT_BEGIN ? size : 0;\n\tblockSize = 1;\n\tlastSize = m_flags & SIGNATURE_AT_BEGIN ? 0 : size;\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignatureVerificationFilter::InitializeDerivedAndReturnNewSizes(const NameValuePairs &parameters, size_t &firstSize, size_t &blockSize, size_t &lastSize)\n{\n\tm_flags = parameters.GetValueWithDefault(Name::SignatureVerificationFilterFlags(), (word32)DEFAULT_FLAGS);\n\tm_messageAccumulator.reset(m_verifier.NewVerificationAccumulator());\n\tsize_t size = m_verifier.SignatureLength();\n\tassert(size != 0);\t// TODO: handle recoverable signature scheme\n\tm_verified = false;\n\tfirstSize = m_flags & SIGNATURE_AT_BEGIN ? size : 0;\n\tblockSize = 1;\n\tlastSize = m_flags & SIGNATURE_AT_BEGIN ? 0 : size;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid FilterWithBufferedInput::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tInitializeDerivedAndReturnNewSizes(parameters, m_firstSize, m_blockSize, m_lastSize);\n\tif (m_firstSize < 0 || m_blockSize < 1 || m_lastSize < 0)\n\t\tthrow InvalidArgument(\"FilterWithBufferedInput: invalid buffer size\");\n\tm_queue.ResetQueue(1, m_firstSize);\n\tm_firstInputDone = false;\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::FilterWithBufferedInput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "297-305",
    "snippet": "FilterWithBufferedInput::FilterWithBufferedInput(size_t firstSize, size_t blockSize, size_t lastSize, BufferedTransformation *attachment)\n\t: Filter(attachment), m_firstSize(firstSize), m_blockSize(blockSize), m_lastSize(lastSize)\n\t, m_firstInputDone(false)\n{\n\tif (m_firstSize < 0 || m_blockSize < 1 || m_lastSize < 0)\n\t\tthrow InvalidArgument(\"FilterWithBufferedInput: invalid buffer size\");\n\n\tm_queue.ResetQueue(1, m_firstSize);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_queue.ResetQueue",
          "args": [
            "1",
            "m_firstSize"
          ],
          "line": 304
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"FilterWithBufferedInput: invalid buffer size\""
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nFilterWithBufferedInput::FilterWithBufferedInput(size_t firstSize, size_t blockSize, size_t lastSize, BufferedTransformation *attachment)\n\t: Filter(attachment), m_firstSize(firstSize), m_blockSize(blockSize), m_lastSize(lastSize)\n\t, m_firstInputDone(false)\n{\n\tif (m_firstSize < 0 || m_blockSize < 1 || m_lastSize < 0)\n\t\tthrow InvalidArgument(\"FilterWithBufferedInput: invalid buffer size\");\n\n\tm_queue.ResetQueue(1, m_firstSize);\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::FilterWithBufferedInput",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "292-295",
    "snippet": "FilterWithBufferedInput::FilterWithBufferedInput(BufferedTransformation *attachment)\n\t: Filter(attachment)\n{\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nFilterWithBufferedInput::FilterWithBufferedInput(BufferedTransformation *attachment)\n\t: Filter(attachment)\n{\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::BlockQueue::Put",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "281-290",
    "snippet": "void FilterWithBufferedInput::BlockQueue::Put(const byte *inString, size_t length)\n{\n\tassert(m_size + length <= m_buffer.size());\n\tbyte *end = (m_size < size_t(m_buffer.end()-m_begin)) ? m_begin + m_size : m_begin + m_size - m_buffer.size();\n\tsize_t len = STDMIN(length, size_t(m_buffer.end()-end));\n\tmemcpy(end, inString, len);\n\tif (len < length)\n\t\tmemcpy(m_buffer, inString+len, length-len);\n\tm_size += length;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m_buffer",
            "inString+len",
            "length-len"
          ],
          "line": 288
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "end",
            "inString",
            "len"
          ],
          "line": 286
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "STDMIN",
          "args": [
            "length",
            "size_t(m_buffer.end()-end)"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "size_t",
          "args": [
            "m_buffer.end()-end"
          ],
          "line": 285
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_buffer.end",
          "args": [],
          "line": 285
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "296-297",
          "snippet": "const_iterator end() const\n\t\t{return m_ptr+m_size;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator end() const\n  \t\t{return m_ptr+m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_buffer.size",
          "args": [],
          "line": 284
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "size_t",
          "args": [
            "m_buffer.end()-m_begin"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_size + length <= m_buffer.size()"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid FilterWithBufferedInput::BlockQueue::Put(const byte *inString, size_t length)\n{\n\tassert(m_size + length <= m_buffer.size());\n\tbyte *end = (m_size < size_t(m_buffer.end()-m_begin)) ? m_begin + m_size : m_begin + m_size - m_buffer.size();\n\tsize_t len = STDMIN(length, size_t(m_buffer.end()-end));\n\tmemcpy(end, inString, len);\n\tif (len < length)\n\t\tmemcpy(m_buffer, inString+len, length-len);\n\tm_size += length;\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::BlockQueue::GetAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "270-279",
    "snippet": "size_t FilterWithBufferedInput::BlockQueue::GetAll(byte *outString)\n{\n\tsize_t size = m_size;\n\tsize_t numberOfBytes = m_maxBlocks*m_blockSize;\n\tconst byte *ptr = GetContigousBlocks(numberOfBytes);\n\tmemcpy(outString, ptr, numberOfBytes);\n\tmemcpy(outString+numberOfBytes, m_begin, m_size);\n\tm_size = 0;\n\treturn size;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "outString+numberOfBytes",
            "m_begin",
            "m_size"
          ],
          "line": 276
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "outString",
            "ptr",
            "numberOfBytes"
          ],
          "line": 275
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetContigousBlocks",
          "args": [
            "numberOfBytes"
          ],
          "line": 274
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t FilterWithBufferedInput::BlockQueue::GetAll(byte *outString)\n{\n\tsize_t size = m_size;\n\tsize_t numberOfBytes = m_maxBlocks*m_blockSize;\n\tconst byte *ptr = GetContigousBlocks(numberOfBytes);\n\tmemcpy(outString, ptr, numberOfBytes);\n\tmemcpy(outString+numberOfBytes, m_begin, m_size);\n\tm_size = 0;\n\treturn size;\n}"
  },
  {
    "function_name": "FilterWithBufferedInput::BlockQueue::ResetQueue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "236-243",
    "snippet": "void FilterWithBufferedInput::BlockQueue::ResetQueue(size_t blockSize, size_t maxBlocks)\n{\n\tm_buffer.New(blockSize * maxBlocks);\n\tm_blockSize = blockSize;\n\tm_maxBlocks = maxBlocks;\n\tm_size = 0;\n\tm_begin = m_buffer;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_buffer.New",
          "args": [
            "blockSize * maxBlocks"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "New",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "361-365",
          "snippet": "void New(size_type newSize)\n\t{\n\t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n\t\tm_size = newSize;\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void New(size_type newSize)\n  \t{\n  \t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n  \t\tm_size = newSize;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid FilterWithBufferedInput::BlockQueue::ResetQueue(size_t blockSize, size_t maxBlocks)\n{\n\tm_buffer.New(blockSize * maxBlocks);\n\tm_blockSize = blockSize;\n\tm_maxBlocks = maxBlocks;\n\tm_size = 0;\n\tm_begin = m_buffer;\n}"
  },
  {
    "function_name": "MeterFilter::IsolatedMessageSeriesEnd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "226-232",
    "snippet": "bool MeterFilter::IsolatedMessageSeriesEnd(bool blocking)\n{\n\tm_currentMessageBytes = 0;\n\tm_currentSeriesMessages = 0;\n\tm_totalMessageSeries++;\n\treturn false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool MeterFilter::IsolatedMessageSeriesEnd(bool blocking)\n{\n\tm_currentMessageBytes = 0;\n\tm_currentSeriesMessages = 0;\n\tm_totalMessageSeries++;\n\treturn false;\n}"
  },
  {
    "function_name": "MeterFilter::PutModifiable2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "221-224",
    "snippet": "size_t MeterFilter::PutModifiable2(byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\treturn PutMaybeModifiable(begin, length, messageEnd, blocking, true);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PutMaybeModifiable",
          "args": [
            "begin",
            "length",
            "messageEnd",
            "blocking",
            "true"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "FilterWithBufferedInput::PutMaybeModifiable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "328-416",
          "snippet": "size_t FilterWithBufferedInput::PutMaybeModifiable(byte *inString, size_t length, int messageEnd, bool blocking, bool modifiable)\n{\n\tif (!blocking)\n\t\tthrow BlockingInputOnly(\"FilterWithBufferedInput\");\n\n\tif (length != 0)\n\t{\n\t\tsize_t newLength = m_queue.CurrentSize() + length;\n\n\t\tif (!m_firstInputDone && newLength >= m_firstSize)\n\t\t{\n\t\t\tsize_t len = m_firstSize - m_queue.CurrentSize();\n\t\t\tm_queue.Put(inString, len);\n\t\t\tFirstPut(m_queue.GetContigousBlocks(m_firstSize));\n\t\t\tassert(m_queue.CurrentSize() == 0);\n\t\t\tm_queue.ResetQueue(m_blockSize, (2*m_blockSize+m_lastSize-2)/m_blockSize);\n\n\t\t\tinString += len;\n\t\t\tnewLength -= m_firstSize;\n\t\t\tm_firstInputDone = true;\n\t\t}\n\n\t\tif (m_firstInputDone)\n\t\t{\n\t\t\tif (m_blockSize == 1)\n\t\t\t{\n\t\t\t\twhile (newLength > m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tbyte *ptr = m_queue.GetContigousBlocks(len);\n\t\t\t\t\tNextPutModifiable(ptr, len);\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\n\t\t\t\tif (newLength > m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() >= m_blockSize)\n\t\t\t\t{\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tassert(m_queue.CurrentSize() < m_blockSize);\n\t\t\t\t\tsize_t len = m_blockSize - m_queue.CurrentSize();\n\t\t\t\t\tm_queue.Put(inString, len);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = RoundDownToMultipleOf(newLength - m_lastSize, m_blockSize);\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tm_queue.Put(inString, newLength - m_queue.CurrentSize());\n\t}\n\n\tif (messageEnd)\n\t{\n\t\tif (!m_firstInputDone && m_firstSize==0)\n\t\t\tFirstPut(NULL);\n\n\t\tSecByteBlock temp(m_queue.CurrentSize());\n\t\tm_queue.GetAll(temp);\n\t\tLastPut(temp, temp.size());\n\n\t\tm_firstInputDone = false;\n\t\tm_queue.ResetQueue(1, m_firstSize);\n\n\t\tOutput(1, NULL, 0, messageEnd, blocking);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t FilterWithBufferedInput::PutMaybeModifiable(byte *inString, size_t length, int messageEnd, bool blocking, bool modifiable)\n{\n\tif (!blocking)\n\t\tthrow BlockingInputOnly(\"FilterWithBufferedInput\");\n\n\tif (length != 0)\n\t{\n\t\tsize_t newLength = m_queue.CurrentSize() + length;\n\n\t\tif (!m_firstInputDone && newLength >= m_firstSize)\n\t\t{\n\t\t\tsize_t len = m_firstSize - m_queue.CurrentSize();\n\t\t\tm_queue.Put(inString, len);\n\t\t\tFirstPut(m_queue.GetContigousBlocks(m_firstSize));\n\t\t\tassert(m_queue.CurrentSize() == 0);\n\t\t\tm_queue.ResetQueue(m_blockSize, (2*m_blockSize+m_lastSize-2)/m_blockSize);\n\n\t\t\tinString += len;\n\t\t\tnewLength -= m_firstSize;\n\t\t\tm_firstInputDone = true;\n\t\t}\n\n\t\tif (m_firstInputDone)\n\t\t{\n\t\t\tif (m_blockSize == 1)\n\t\t\t{\n\t\t\t\twhile (newLength > m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tbyte *ptr = m_queue.GetContigousBlocks(len);\n\t\t\t\t\tNextPutModifiable(ptr, len);\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\n\t\t\t\tif (newLength > m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() >= m_blockSize)\n\t\t\t\t{\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tassert(m_queue.CurrentSize() < m_blockSize);\n\t\t\t\t\tsize_t len = m_blockSize - m_queue.CurrentSize();\n\t\t\t\t\tm_queue.Put(inString, len);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = RoundDownToMultipleOf(newLength - m_lastSize, m_blockSize);\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tm_queue.Put(inString, newLength - m_queue.CurrentSize());\n\t}\n\n\tif (messageEnd)\n\t{\n\t\tif (!m_firstInputDone && m_firstSize==0)\n\t\t\tFirstPut(NULL);\n\n\t\tSecByteBlock temp(m_queue.CurrentSize());\n\t\tm_queue.GetAll(temp);\n\t\tLastPut(temp, temp.size());\n\n\t\tm_firstInputDone = false;\n\t\tm_queue.ResetQueue(1, m_firstSize);\n\n\t\tOutput(1, NULL, 0, messageEnd, blocking);\n\t}\n\treturn 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t MeterFilter::PutModifiable2(byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\treturn PutMaybeModifiable(begin, length, messageEnd, blocking, true);\n}"
  },
  {
    "function_name": "MeterFilter::Put2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "216-219",
    "snippet": "size_t MeterFilter::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\treturn PutMaybeModifiable(const_cast<byte *>(begin), length, messageEnd, blocking, false);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PutMaybeModifiable",
          "args": [
            "const_cast<byte *>(begin)",
            "length",
            "messageEnd",
            "blocking",
            "false"
          ],
          "line": 218
        },
        "resolved": true,
        "details": {
          "function_name": "FilterWithBufferedInput::PutMaybeModifiable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "328-416",
          "snippet": "size_t FilterWithBufferedInput::PutMaybeModifiable(byte *inString, size_t length, int messageEnd, bool blocking, bool modifiable)\n{\n\tif (!blocking)\n\t\tthrow BlockingInputOnly(\"FilterWithBufferedInput\");\n\n\tif (length != 0)\n\t{\n\t\tsize_t newLength = m_queue.CurrentSize() + length;\n\n\t\tif (!m_firstInputDone && newLength >= m_firstSize)\n\t\t{\n\t\t\tsize_t len = m_firstSize - m_queue.CurrentSize();\n\t\t\tm_queue.Put(inString, len);\n\t\t\tFirstPut(m_queue.GetContigousBlocks(m_firstSize));\n\t\t\tassert(m_queue.CurrentSize() == 0);\n\t\t\tm_queue.ResetQueue(m_blockSize, (2*m_blockSize+m_lastSize-2)/m_blockSize);\n\n\t\t\tinString += len;\n\t\t\tnewLength -= m_firstSize;\n\t\t\tm_firstInputDone = true;\n\t\t}\n\n\t\tif (m_firstInputDone)\n\t\t{\n\t\t\tif (m_blockSize == 1)\n\t\t\t{\n\t\t\t\twhile (newLength > m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tbyte *ptr = m_queue.GetContigousBlocks(len);\n\t\t\t\t\tNextPutModifiable(ptr, len);\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\n\t\t\t\tif (newLength > m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() >= m_blockSize)\n\t\t\t\t{\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tassert(m_queue.CurrentSize() < m_blockSize);\n\t\t\t\t\tsize_t len = m_blockSize - m_queue.CurrentSize();\n\t\t\t\t\tm_queue.Put(inString, len);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = RoundDownToMultipleOf(newLength - m_lastSize, m_blockSize);\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tm_queue.Put(inString, newLength - m_queue.CurrentSize());\n\t}\n\n\tif (messageEnd)\n\t{\n\t\tif (!m_firstInputDone && m_firstSize==0)\n\t\t\tFirstPut(NULL);\n\n\t\tSecByteBlock temp(m_queue.CurrentSize());\n\t\tm_queue.GetAll(temp);\n\t\tLastPut(temp, temp.size());\n\n\t\tm_firstInputDone = false;\n\t\tm_queue.ResetQueue(1, m_firstSize);\n\n\t\tOutput(1, NULL, 0, messageEnd, blocking);\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t FilterWithBufferedInput::PutMaybeModifiable(byte *inString, size_t length, int messageEnd, bool blocking, bool modifiable)\n{\n\tif (!blocking)\n\t\tthrow BlockingInputOnly(\"FilterWithBufferedInput\");\n\n\tif (length != 0)\n\t{\n\t\tsize_t newLength = m_queue.CurrentSize() + length;\n\n\t\tif (!m_firstInputDone && newLength >= m_firstSize)\n\t\t{\n\t\t\tsize_t len = m_firstSize - m_queue.CurrentSize();\n\t\t\tm_queue.Put(inString, len);\n\t\t\tFirstPut(m_queue.GetContigousBlocks(m_firstSize));\n\t\t\tassert(m_queue.CurrentSize() == 0);\n\t\t\tm_queue.ResetQueue(m_blockSize, (2*m_blockSize+m_lastSize-2)/m_blockSize);\n\n\t\t\tinString += len;\n\t\t\tnewLength -= m_firstSize;\n\t\t\tm_firstInputDone = true;\n\t\t}\n\n\t\tif (m_firstInputDone)\n\t\t{\n\t\t\tif (m_blockSize == 1)\n\t\t\t{\n\t\t\t\twhile (newLength > m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tbyte *ptr = m_queue.GetContigousBlocks(len);\n\t\t\t\t\tNextPutModifiable(ptr, len);\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\n\t\t\t\tif (newLength > m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = newLength - m_lastSize;\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\twhile (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() >= m_blockSize)\n\t\t\t\t{\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize && m_queue.CurrentSize() > 0)\n\t\t\t\t{\n\t\t\t\t\tassert(m_queue.CurrentSize() < m_blockSize);\n\t\t\t\t\tsize_t len = m_blockSize - m_queue.CurrentSize();\n\t\t\t\t\tm_queue.Put(inString, len);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tNextPutModifiable(m_queue.GetBlock(), m_blockSize);\n\t\t\t\t\tnewLength -= m_blockSize;\n\t\t\t\t}\n\n\t\t\t\tif (newLength >= m_blockSize + m_lastSize)\n\t\t\t\t{\n\t\t\t\t\tsize_t len = RoundDownToMultipleOf(newLength - m_lastSize, m_blockSize);\n\t\t\t\t\tNextPutMaybeModifiable(inString, len, modifiable);\n\t\t\t\t\tinString += len;\n\t\t\t\t\tnewLength -= len;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tm_queue.Put(inString, newLength - m_queue.CurrentSize());\n\t}\n\n\tif (messageEnd)\n\t{\n\t\tif (!m_firstInputDone && m_firstSize==0)\n\t\t\tFirstPut(NULL);\n\n\t\tSecByteBlock temp(m_queue.CurrentSize());\n\t\tm_queue.GetAll(temp);\n\t\tLastPut(temp, temp.size());\n\n\t\tm_firstInputDone = false;\n\t\tm_queue.ResetQueue(1, m_firstSize);\n\n\t\tOutput(1, NULL, 0, messageEnd, blocking);\n\t}\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<byte *>",
          "args": [
            "begin"
          ],
          "line": 218
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t MeterFilter::Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\treturn PutMaybeModifiable(const_cast<byte *>(begin), length, messageEnd, blocking, false);\n}"
  },
  {
    "function_name": "MeterFilter::PutMaybeModifiable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "158-214",
    "snippet": "size_t MeterFilter::PutMaybeModifiable(byte *begin, size_t length, int messageEnd, bool blocking, bool modifiable)\n{\n\tif (!m_transparent)\n\t\treturn 0;\n\n\tsize_t t;\n\tFILTER_BEGIN;\n\n\tm_begin = begin;\n\tm_length = length;\n\n\twhile (m_length > 0 || messageEnd)\n\t{\n\t\tif (m_length > 0  && !m_rangesToSkip.empty() && m_rangesToSkip.front().message == m_totalMessages && m_currentMessageBytes + m_length > m_rangesToSkip.front().position)\n\t\t{\n\t\t\tFILTER_OUTPUT_MAYBE_MODIFIABLE(1, m_begin, t = (size_t)SaturatingSubtract(m_rangesToSkip.front().position, m_currentMessageBytes), false, modifiable);\n\n\t\t\tassert(t < m_length);\n\t\t\tm_begin += t;\n\t\t\tm_length -= t;\n\t\t\tm_currentMessageBytes += t;\n\t\t\tm_totalBytes += t;\n\n\t\t\tif (m_currentMessageBytes + m_length < m_rangesToSkip.front().position + m_rangesToSkip.front().size)\n\t\t\t\tt = m_length;\n\t\t\telse\n\t\t\t{\n\t\t\t\tt = (size_t)SaturatingSubtract(m_rangesToSkip.front().position + m_rangesToSkip.front().size, m_currentMessageBytes);\n\t\t\t\tassert(t <= m_length);\n\t\t\t\tm_rangesToSkip.pop_front();\n\t\t\t}\n\n\t\t\tm_begin += t;\n\t\t\tm_length -= t;\n\t\t\tm_currentMessageBytes += t;\n\t\t\tm_totalBytes += t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tFILTER_OUTPUT_MAYBE_MODIFIABLE(2, m_begin, m_length, messageEnd, modifiable);\n\n\t\t\tm_currentMessageBytes += m_length;\n\t\t\tm_totalBytes += m_length;\n\t\t\tm_length = 0;\n\n\t\t\tif (messageEnd)\n\t\t\t{\n\t\t\t\tm_currentMessageBytes = 0;\n\t\t\t\tm_currentSeriesMessages++;\n\t\t\t\tm_totalMessages++;\n\t\t\t\tmessageEnd = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tFILTER_END_NO_MESSAGE_END;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FILTER_OUTPUT_MAYBE_MODIFIABLE",
          "args": [
            "2",
            "m_begin",
            "m_length",
            "messageEnd",
            "modifiable"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.pop_front",
          "args": [],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "t <= m_length"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SaturatingSubtract",
          "args": [
            "m_rangesToSkip.front().position + m_rangesToSkip.front().size",
            "m_currentMessageBytes"
          ],
          "line": 185
        },
        "resolved": true,
        "details": {
          "function_name": "SaturatingSubtract",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "432-435",
          "snippet": "inline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.front",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.front",
          "args": [],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.front",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.front",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "t < m_length"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FILTER_OUTPUT_MAYBE_MODIFIABLE",
          "args": [
            "1",
            "m_begin",
            "t = (size_t)SaturatingSubtract(m_rangesToSkip.front().position, m_currentMessageBytes)",
            "false",
            "modifiable"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.front",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.front",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.front",
          "args": [],
          "line": 171
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.empty",
          "args": [],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t MeterFilter::PutMaybeModifiable(byte *begin, size_t length, int messageEnd, bool blocking, bool modifiable)\n{\n\tif (!m_transparent)\n\t\treturn 0;\n\n\tsize_t t;\n\tFILTER_BEGIN;\n\n\tm_begin = begin;\n\tm_length = length;\n\n\twhile (m_length > 0 || messageEnd)\n\t{\n\t\tif (m_length > 0  && !m_rangesToSkip.empty() && m_rangesToSkip.front().message == m_totalMessages && m_currentMessageBytes + m_length > m_rangesToSkip.front().position)\n\t\t{\n\t\t\tFILTER_OUTPUT_MAYBE_MODIFIABLE(1, m_begin, t = (size_t)SaturatingSubtract(m_rangesToSkip.front().position, m_currentMessageBytes), false, modifiable);\n\n\t\t\tassert(t < m_length);\n\t\t\tm_begin += t;\n\t\t\tm_length -= t;\n\t\t\tm_currentMessageBytes += t;\n\t\t\tm_totalBytes += t;\n\n\t\t\tif (m_currentMessageBytes + m_length < m_rangesToSkip.front().position + m_rangesToSkip.front().size)\n\t\t\t\tt = m_length;\n\t\t\telse\n\t\t\t{\n\t\t\t\tt = (size_t)SaturatingSubtract(m_rangesToSkip.front().position + m_rangesToSkip.front().size, m_currentMessageBytes);\n\t\t\t\tassert(t <= m_length);\n\t\t\t\tm_rangesToSkip.pop_front();\n\t\t\t}\n\n\t\t\tm_begin += t;\n\t\t\tm_length -= t;\n\t\t\tm_currentMessageBytes += t;\n\t\t\tm_totalBytes += t;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tFILTER_OUTPUT_MAYBE_MODIFIABLE(2, m_begin, m_length, messageEnd, modifiable);\n\n\t\t\tm_currentMessageBytes += m_length;\n\t\t\tm_totalBytes += m_length;\n\t\t\tm_length = 0;\n\n\t\t\tif (messageEnd)\n\t\t\t{\n\t\t\t\tm_currentMessageBytes = 0;\n\t\t\t\tm_currentSeriesMessages++;\n\t\t\t\tm_totalMessages++;\n\t\t\t\tmessageEnd = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tFILTER_END_NO_MESSAGE_END;\n}"
  },
  {
    "function_name": "MeterFilter::AddRangeToSkip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "150-156",
    "snippet": "void MeterFilter::AddRangeToSkip(unsigned int message, lword position, lword size, bool sortNow)\n{\n\tMessageRange r = {message, position, size};\n\tm_rangesToSkip.push_back(r);\n\tif (sortNow)\n\t\tstd::sort(m_rangesToSkip.begin(), m_rangesToSkip.end());\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::sort",
          "args": [
            "m_rangesToSkip.begin()",
            "m_rangesToSkip.end()"
          ],
          "line": 155
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.end",
          "args": [],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "296-297",
          "snippet": "const_iterator end() const\n\t\t{return m_ptr+m_size;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator end() const\n  \t\t{return m_ptr+m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.begin",
          "args": [],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_rangesToSkip.push_back",
          "args": [
            "r"
          ],
          "line": 153
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid MeterFilter::AddRangeToSkip(unsigned int message, lword position, lword size, bool sortNow)\n{\n\tMessageRange r = {message, position, size};\n\tm_rangesToSkip.push_back(r);\n\tif (sortNow)\n\t\tstd::sort(m_rangesToSkip.begin(), m_rangesToSkip.end());\n}"
  },
  {
    "function_name": "MeterFilter::ResetMeter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "144-148",
    "snippet": "void MeterFilter::ResetMeter()\n{\n\tm_currentMessageBytes = m_totalBytes = m_currentSeriesMessages = m_totalMessages = m_totalMessageSeries = 0;\n\tm_rangesToSkip.clear();\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_rangesToSkip.clear",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid MeterFilter::ResetMeter()\n{\n\tm_currentMessageBytes = m_totalBytes = m_currentSeriesMessages = m_totalMessages = m_totalMessageSeries = 0;\n\tm_rangesToSkip.clear();\n}"
  },
  {
    "function_name": "Filter::OutputMessageSeriesEnd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "131-140",
    "snippet": "bool Filter::OutputMessageSeriesEnd(int outputSite, int propagation, bool blocking, const std::string &channel)\n{\n\tif (propagation && AttachedTransformation()->ChannelMessageSeriesEnd(channel, propagation-1, blocking))\n\t{\n\t\tm_continueAt = outputSite;\n\t\treturn true;\n\t}\n\tm_continueAt = 0;\n\treturn false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "channel",
            "propagation-1",
            "blocking"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool Filter::OutputMessageSeriesEnd(int outputSite, int propagation, bool blocking, const std::string &channel)\n{\n\tif (propagation && AttachedTransformation()->ChannelMessageSeriesEnd(channel, propagation-1, blocking))\n\t{\n\t\tm_continueAt = outputSite;\n\t\treturn true;\n\t}\n\tm_continueAt = 0;\n\treturn false;\n}"
  },
  {
    "function_name": "Filter::OutputFlush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "120-129",
    "snippet": "bool Filter::OutputFlush(int outputSite, bool hardFlush, int propagation, bool blocking, const std::string &channel)\n{\n\tif (propagation && AttachedTransformation()->ChannelFlush(channel, hardFlush, propagation-1, blocking))\n\t{\n\t\tm_continueAt = outputSite;\n\t\treturn true;\n\t}\n\tm_continueAt = 0;\n\treturn false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "channel",
            "hardFlush",
            "propagation-1",
            "blocking"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool Filter::OutputFlush(int outputSite, bool hardFlush, int propagation, bool blocking, const std::string &channel)\n{\n\tif (propagation && AttachedTransformation()->ChannelFlush(channel, hardFlush, propagation-1, blocking))\n\t{\n\t\tm_continueAt = outputSite;\n\t\treturn true;\n\t}\n\tm_continueAt = 0;\n\treturn false;\n}"
  },
  {
    "function_name": "Filter::Output",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "111-118",
    "snippet": "size_t Filter::Output(int outputSite, const byte *inString, size_t length, int messageEnd, bool blocking, const std::string &channel)\n{\n\tif (messageEnd)\n\t\tmessageEnd--;\n\tsize_t result = AttachedTransformation()->ChannelPut2(channel, inString, length, messageEnd, blocking);\n\tm_continueAt = result ? outputSite : 0;\n\treturn result;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "channel",
            "inString",
            "length",
            "messageEnd",
            "blocking"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t Filter::Output(int outputSite, const byte *inString, size_t length, int messageEnd, bool blocking, const std::string &channel)\n{\n\tif (messageEnd)\n\t\tmessageEnd--;\n\tsize_t result = AttachedTransformation()->ChannelPut2(channel, inString, length, messageEnd, blocking);\n\tm_continueAt = result ? outputSite : 0;\n\treturn result;\n}"
  },
  {
    "function_name": "Filter::OutputModifiable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "102-109",
    "snippet": "size_t Filter::OutputModifiable(int outputSite, byte *inString, size_t length, int messageEnd, bool blocking, const std::string &channel)\n{\n\tif (messageEnd)\n\t\tmessageEnd--;\n\tsize_t result = AttachedTransformation()->ChannelPutModifiable2(channel, inString, length, messageEnd, blocking);\n\tm_continueAt = result ? outputSite : 0;\n\treturn result;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "channel",
            "inString",
            "length",
            "messageEnd",
            "blocking"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t Filter::OutputModifiable(int outputSite, byte *inString, size_t length, int messageEnd, bool blocking, const std::string &channel)\n{\n\tif (messageEnd)\n\t\tmessageEnd--;\n\tsize_t result = AttachedTransformation()->ChannelPutModifiable2(channel, inString, length, messageEnd, blocking);\n\tm_continueAt = result ? outputSite : 0;\n\treturn result;\n}"
  },
  {
    "function_name": "Filter::PropagateInitialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "96-100",
    "snippet": "void Filter::PropagateInitialize(const NameValuePairs &parameters, int propagation)\n{\n\tif (propagation)\n\t\tAttachedTransformation()->Initialize(parameters, propagation-1);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "parameters",
            "propagation-1"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::PropagateInitialize(const NameValuePairs &parameters, int propagation)\n{\n\tif (propagation)\n\t\tAttachedTransformation()->Initialize(parameters, propagation-1);\n}"
  },
  {
    "function_name": "Filter::MessageSeriesEnd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "82-94",
    "snippet": "bool Filter::MessageSeriesEnd(int propagation, bool blocking)\n{\n\tswitch (m_continueAt)\n\t{\n\tcase 0:\n\t\tif (IsolatedMessageSeriesEnd(blocking))\n\t\t\treturn true;\n\tcase 1:\n\t\tif (ShouldPropagateMessageSeriesEnd() && OutputMessageSeriesEnd(1, propagation, blocking))\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OutputMessageSeriesEnd",
          "args": [
            "1",
            "propagation",
            "blocking"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ShouldPropagateMessageSeriesEnd",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "ShouldPropagateMessageSeriesEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.h",
          "lines": "111-111",
          "snippet": "bool ShouldPropagateMessageSeriesEnd() const {return m_transparent;}",
          "includes": [
            "#include <deque>",
            "#include \"algparam.h\"",
            "#include \"queue.h\"",
            "#include \"smartptr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"simple.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include \"algparam.h\"\n#include \"queue.h\"\n#include \"smartptr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"simple.h\"\n\nbool ShouldPropagateMessageSeriesEnd() const {return m_transparent;}"
        }
      },
      {
        "call_info": {
          "callee": "IsolatedMessageSeriesEnd",
          "args": [
            "blocking"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "MeterFilter::IsolatedMessageSeriesEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "226-232",
          "snippet": "bool MeterFilter::IsolatedMessageSeriesEnd(bool blocking)\n{\n\tm_currentMessageBytes = 0;\n\tm_currentSeriesMessages = 0;\n\tm_totalMessageSeries++;\n\treturn false;\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool MeterFilter::IsolatedMessageSeriesEnd(bool blocking)\n{\n\tm_currentMessageBytes = 0;\n\tm_currentSeriesMessages = 0;\n\tm_totalMessageSeries++;\n\treturn false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool Filter::MessageSeriesEnd(int propagation, bool blocking)\n{\n\tswitch (m_continueAt)\n\t{\n\tcase 0:\n\t\tif (IsolatedMessageSeriesEnd(blocking))\n\t\t\treturn true;\n\tcase 1:\n\t\tif (ShouldPropagateMessageSeriesEnd() && OutputMessageSeriesEnd(1, propagation, blocking))\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "Filter::Flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "68-80",
    "snippet": "bool Filter::Flush(bool hardFlush, int propagation, bool blocking)\n{\n\tswitch (m_continueAt)\n\t{\n\tcase 0:\n\t\tif (IsolatedFlush(hardFlush, blocking))\n\t\t\treturn true;\n\tcase 1:\n\t\tif (OutputFlush(1, hardFlush, propagation, blocking))\n\t\t\treturn true;\n\t}\n\treturn false;\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "OutputFlush",
          "args": [
            "1",
            "hardFlush",
            "propagation",
            "blocking"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsolatedFlush",
          "args": [
            "hardFlush",
            "blocking"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ProxyFilter::IsolatedFlush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "468-471",
          "snippet": "bool ProxyFilter::IsolatedFlush(bool hardFlush, bool blocking)\n{\n\treturn m_filter.get() ? m_filter->Flush(hardFlush, -1, blocking) : false;\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool ProxyFilter::IsolatedFlush(bool hardFlush, bool blocking)\n{\n\treturn m_filter.get() ? m_filter->Flush(hardFlush, -1, blocking) : false;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nbool Filter::Flush(bool hardFlush, int propagation, bool blocking)\n{\n\tswitch (m_continueAt)\n\t{\n\tcase 0:\n\t\tif (IsolatedFlush(hardFlush, blocking))\n\t\t\treturn true;\n\tcase 1:\n\t\tif (OutputFlush(1, hardFlush, propagation, blocking))\n\t\t\treturn true;\n\t}\n\treturn false;\n}"
  },
  {
    "function_name": "Filter::Initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "61-66",
    "snippet": "void Filter::Initialize(const NameValuePairs &parameters, int propagation)\n{\n\tm_continueAt = 0;\n\tIsolatedInitialize(parameters);\n\tPropagateInitialize(parameters, propagation);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PropagateInitialize",
          "args": [
            "parameters",
            "propagation"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "Filter::PropagateInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "96-100",
          "snippet": "void Filter::PropagateInitialize(const NameValuePairs &parameters, int propagation)\n{\n\tif (propagation)\n\t\tAttachedTransformation()->Initialize(parameters, propagation-1);\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::PropagateInitialize(const NameValuePairs &parameters, int propagation)\n{\n\tif (propagation)\n\t\tAttachedTransformation()->Initialize(parameters, propagation-1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsolatedInitialize",
          "args": [
            "parameters"
          ],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "SignerFilter::IsolatedInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "918-922",
          "snippet": "void SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid SignerFilter::IsolatedInitialize(const NameValuePairs &parameters)\n{\n\tm_putMessage = parameters.GetValueWithDefault(Name::PutMessage(), false);\n\tm_messageAccumulator.reset(m_signer.NewSignatureAccumulator(m_rng));\n}"
        }
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::Initialize(const NameValuePairs &parameters, int propagation)\n{\n\tm_continueAt = 0;\n\tIsolatedInitialize(parameters);\n\tPropagateInitialize(parameters, propagation);\n}"
  },
  {
    "function_name": "Filter::TransferTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "56-59",
    "snippet": "size_t Filter::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\treturn AttachedTransformation()->TransferTo2(target, transferBytes, channel, blocking);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "target",
            "transferBytes",
            "channel",
            "blocking"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t Filter::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\treturn AttachedTransformation()->TransferTo2(target, transferBytes, channel, blocking);\n}"
  },
  {
    "function_name": "Filter::CopyRangeTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "51-54",
    "snippet": "size_t Filter::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\treturn AttachedTransformation()->CopyRangeTo2(target, begin, end, channel, blocking);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "target",
            "begin",
            "end",
            "channel",
            "blocking"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nsize_t Filter::CopyRangeTo2(BufferedTransformation &target, lword &begin, lword end, const std::string &channel, bool blocking) const\n{\n\treturn AttachedTransformation()->CopyRangeTo2(target, begin, end, channel, blocking);\n}"
  },
  {
    "function_name": "Filter::Insert",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "45-49",
    "snippet": "void Filter::Insert(Filter *filter)\n{\n\tfilter->m_attachment.reset(m_attachment.release());\n\tm_attachment.reset(filter);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_attachment.reset",
          "args": [
            "filter"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filter->m_attachment.reset",
          "args": [
            "m_attachment.release()"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_attachment.release",
          "args": [],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::Insert(Filter *filter)\n{\n\tfilter->m_attachment.reset(m_attachment.release());\n\tm_attachment.reset(filter);\n}"
  },
  {
    "function_name": "Filter::Detach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "40-43",
    "snippet": "void Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_attachment.reset",
          "args": [
            "newOut"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}"
  },
  {
    "function_name": "Filter::Filter",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
    "lines": "16-19",
    "snippet": "Filter::Filter(BufferedTransformation *attachment)\n\t: m_attachment(attachment), m_continueAt(0)\n{\n}",
    "includes": [
      "#include <functional>",
      "#include <memory>",
      "#include \"argnames.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"mqueue.h\"",
      "#include \"filters.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nFilter::Filter(BufferedTransformation *attachment)\n\t: m_attachment(attachment), m_continueAt(0)\n{\n}"
  }
]