[
  {
    "function_name": "SetValue",
    "container": "ThreadLocalStorage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trdlocal.cpp",
    "lines": "46-56",
    "snippet": "void ThreadLocalStorage::SetValue(void *value)\n{\n#ifdef HAS_WINTHREADS\n\tif (!TlsSetValue(m_index, value))\n\t\tthrow Err(\"TlsSetValue\", GetLastError());\n#else\n\tint error = pthread_setspecific(m_index, value);\n\tif (error)\n\t\tthrow Err(\"pthread_key_getspecific\", error);\n#endif\n}",
    "includes": [
      "#include <windows.h>",
      "#include \"trdlocal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Err",
          "args": [
            "\"pthread_key_getspecific\"",
            "error"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "Err",
          "container": "ThreadLocalStorage::Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trdlocal.cpp",
          "lines": "16-19",
          "snippet": "ThreadLocalStorage::Err::Err(const std::string& operation, int error)\n\t: OS_Error(OTHER_ERROR, \"ThreadLocalStorage: \" + operation + \" operation failed with error 0x\" + IntToString(error, 16), operation, error)\n{\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"trdlocal.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"trdlocal.h\"\n#include \"pch.h\"\n\nThreadLocalStorage {\n  Err {\n    ThreadLocalStorage::Err::Err(const std::string& operation, int error)\n    \t: OS_Error(OTHER_ERROR, \"ThreadLocalStorage: \" + operation + \" operation failed with error 0x\" + IntToString(error, 16), operation, error)\n    {\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_setspecific",
          "args": [
            "m_index",
            "value"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastError",
          "container": "Socket",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/socketft.cpp",
          "lines": "286-293",
          "snippet": "int Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}",
          "includes": [
            "#include <sys/ioctl.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include \"wait.h\"",
            "#include \"socketft.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/ioctl.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <netdb.h>\n#include <errno.h>\n#include \"wait.h\"\n#include \"socketft.h\"\n#include \"pch.h\"\n\nSocket {\n  int Socket::GetLastError()\n  {\n  #ifdef USE_WINDOWS_STYLE_SOCKETS\n  \treturn WSAGetLastError();\n  #else\n  \treturn errno;\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TlsSetValue",
          "args": [
            "m_index",
            "value"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <windows.h>\n#include \"trdlocal.h\"\n#include \"pch.h\"\n\nThreadLocalStorage {\n  void ThreadLocalStorage::SetValue(void *value)\n  {\n  #ifdef HAS_WINTHREADS\n  \tif (!TlsSetValue(m_index, value))\n  \t\tthrow Err(\"TlsSetValue\", GetLastError());\n  #else\n  \tint error = pthread_setspecific(m_index, value);\n  \tif (error)\n  \t\tthrow Err(\"pthread_key_getspecific\", error);\n  #endif\n  }\n}"
  },
  {
    "function_name": "~ThreadLocalStorage",
    "container": "ThreadLocalStorage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trdlocal.cpp",
    "lines": "34-44",
    "snippet": "ThreadLocalStorage::~ThreadLocalStorage()\n{\n#ifdef HAS_WINTHREADS\n\tif (!TlsFree(m_index))\n\t\tthrow Err(\"TlsFree\", GetLastError());\n#else\n\tint error = pthread_key_delete(m_index);\n\tif (error)\n\t\tthrow Err(\"pthread_key_delete\", error);\n#endif\n}",
    "includes": [
      "#include <windows.h>",
      "#include \"trdlocal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Err",
          "args": [
            "\"pthread_key_delete\"",
            "error"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "Err",
          "container": "ThreadLocalStorage::Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trdlocal.cpp",
          "lines": "16-19",
          "snippet": "ThreadLocalStorage::Err::Err(const std::string& operation, int error)\n\t: OS_Error(OTHER_ERROR, \"ThreadLocalStorage: \" + operation + \" operation failed with error 0x\" + IntToString(error, 16), operation, error)\n{\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"trdlocal.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"trdlocal.h\"\n#include \"pch.h\"\n\nThreadLocalStorage {\n  Err {\n    ThreadLocalStorage::Err::Err(const std::string& operation, int error)\n    \t: OS_Error(OTHER_ERROR, \"ThreadLocalStorage: \" + operation + \" operation failed with error 0x\" + IntToString(error, 16), operation, error)\n    {\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_key_delete",
          "args": [
            "m_index"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastError",
          "container": "Socket",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/socketft.cpp",
          "lines": "286-293",
          "snippet": "int Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}",
          "includes": [
            "#include <sys/ioctl.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include \"wait.h\"",
            "#include \"socketft.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/ioctl.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <netdb.h>\n#include <errno.h>\n#include \"wait.h\"\n#include \"socketft.h\"\n#include \"pch.h\"\n\nSocket {\n  int Socket::GetLastError()\n  {\n  #ifdef USE_WINDOWS_STYLE_SOCKETS\n  \treturn WSAGetLastError();\n  #else\n  \treturn errno;\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TlsFree",
          "args": [
            "m_index"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <windows.h>\n#include \"trdlocal.h\"\n#include \"pch.h\"\n\nThreadLocalStorage {\n  ThreadLocalStorage::~ThreadLocalStorage()\n  {\n  #ifdef HAS_WINTHREADS\n  \tif (!TlsFree(m_index))\n  \t\tthrow Err(\"TlsFree\", GetLastError());\n  #else\n  \tint error = pthread_key_delete(m_index);\n  \tif (error)\n  \t\tthrow Err(\"pthread_key_delete\", error);\n  #endif\n  }\n}"
  },
  {
    "function_name": "ThreadLocalStorage",
    "container": "ThreadLocalStorage",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trdlocal.cpp",
    "lines": "21-32",
    "snippet": "ThreadLocalStorage::ThreadLocalStorage()\n{\n#ifdef HAS_WINTHREADS\n\tm_index = TlsAlloc();\n\tif (m_index == TLS_OUT_OF_INDEXES)\n\t\tthrow Err(\"TlsAlloc\", GetLastError());\n#else\n\tint error = pthread_key_create(&m_index, NULL);\n\tif (error)\n\t\tthrow Err(\"pthread_key_create\", error);\n#endif\n}",
    "includes": [
      "#include <windows.h>",
      "#include \"trdlocal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Err",
          "args": [
            "\"pthread_key_create\"",
            "error"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "Err",
          "container": "ThreadLocalStorage::Err",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trdlocal.cpp",
          "lines": "16-19",
          "snippet": "ThreadLocalStorage::Err::Err(const std::string& operation, int error)\n\t: OS_Error(OTHER_ERROR, \"ThreadLocalStorage: \" + operation + \" operation failed with error 0x\" + IntToString(error, 16), operation, error)\n{\n}",
          "includes": [
            "#include <windows.h>",
            "#include \"trdlocal.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <windows.h>\n#include \"trdlocal.h\"\n#include \"pch.h\"\n\nThreadLocalStorage {\n  Err {\n    ThreadLocalStorage::Err::Err(const std::string& operation, int error)\n    \t: OS_Error(OTHER_ERROR, \"ThreadLocalStorage: \" + operation + \" operation failed with error 0x\" + IntToString(error, 16), operation, error)\n    {\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_key_create",
          "args": [
            "&m_index",
            "NULL"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetLastError",
          "args": [],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastError",
          "container": "Socket",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/socketft.cpp",
          "lines": "286-293",
          "snippet": "int Socket::GetLastError()\n{\n#ifdef USE_WINDOWS_STYLE_SOCKETS\n\treturn WSAGetLastError();\n#else\n\treturn errno;\n#endif\n}",
          "includes": [
            "#include <sys/ioctl.h>",
            "#include <netinet/in.h>",
            "#include <arpa/inet.h>",
            "#include <unistd.h>",
            "#include <netdb.h>",
            "#include <errno.h>",
            "#include \"wait.h\"",
            "#include \"socketft.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/ioctl.h>\n#include <netinet/in.h>\n#include <arpa/inet.h>\n#include <unistd.h>\n#include <netdb.h>\n#include <errno.h>\n#include \"wait.h\"\n#include \"socketft.h\"\n#include \"pch.h\"\n\nSocket {\n  int Socket::GetLastError()\n  {\n  #ifdef USE_WINDOWS_STYLE_SOCKETS\n  \treturn WSAGetLastError();\n  #else\n  \treturn errno;\n  #endif\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TlsAlloc",
          "args": [],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <windows.h>\n#include \"trdlocal.h\"\n#include \"pch.h\"\n\nThreadLocalStorage {\n  ThreadLocalStorage::ThreadLocalStorage()\n  {\n  #ifdef HAS_WINTHREADS\n  \tm_index = TlsAlloc();\n  \tif (m_index == TLS_OUT_OF_INDEXES)\n  \t\tthrow Err(\"TlsAlloc\", GetLastError());\n  #else\n  \tint error = pthread_key_create(&m_index, NULL);\n  \tif (error)\n  \t\tthrow Err(\"pthread_key_create\", error);\n  #endif\n  }\n}"
  },
  {
    "function_name": "Err",
    "container": "ThreadLocalStorage::Err",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trdlocal.cpp",
    "lines": "16-19",
    "snippet": "ThreadLocalStorage::Err::Err(const std::string& operation, int error)\n\t: OS_Error(OTHER_ERROR, \"ThreadLocalStorage: \" + operation + \" operation failed with error 0x\" + IntToString(error, 16), operation, error)\n{\n}",
    "includes": [
      "#include <windows.h>",
      "#include \"trdlocal.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "error",
            "16"
          ],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <windows.h>\n#include \"trdlocal.h\"\n#include \"pch.h\"\n\nThreadLocalStorage {\n  Err {\n    ThreadLocalStorage::Err::Err(const std::string& operation, int error)\n    \t: OS_Error(OTHER_ERROR, \"ThreadLocalStorage: \" + operation + \" operation failed with error 0x\" + IntToString(error, 16), operation, error)\n    {\n    }\n  }\n}"
  }
]