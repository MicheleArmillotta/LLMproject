[
  {
    "function_name": "StaticAlgorithmName",
    "container": "DLIES",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "523-523",
    "snippet": "StaticAlgorithmName() {return \"DLIES\";}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDLIES {\n  StaticAlgorithmName() {return \"DLIES\";}\n}"
  },
  {
    "function_name": "Derive",
    "container": "DL_KeyDerivationAlgorithm_P1363",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "492-510",
    "snippet": "void Derive(const DL_GroupParameters<T> &params, byte *derivedKey, size_t derivedLength, const T &agreedElement, const T &ephemeralPublicKey, const NameValuePairs &parameters) const\n\t{\n\t\tSecByteBlock agreedSecret;\n\t\tif (DHAES_MODE)\n\t\t{\n\t\t\tagreedSecret.New(params.GetEncodedElementSize(true) + params.GetEncodedElementSize(false));\n\t\t\tparams.EncodeElement(true, ephemeralPublicKey, agreedSecret);\n\t\t\tparams.EncodeElement(false, agreedElement, agreedSecret + params.GetEncodedElementSize(true));\n\t\t}\n\t\telse\n\t\t{\n\t\t\tagreedSecret.New(params.GetEncodedElementSize(false));\n\t\t\tparams.EncodeElement(false, agreedElement, agreedSecret);\n\t\t}\n\n\t\tConstByteArrayParameter derivationParameters;\n\t\tparameters.GetValue(Name::KeyDerivationParameters(), derivationParameters);\n\t\tKDF::DeriveKey(derivedKey, derivedLength, agreedSecret, agreedSecret.size(), derivationParameters.begin(), derivationParameters.size());\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "KDF::DeriveKey",
          "args": [
            "derivedKey",
            "derivedLength",
            "agreedSecret",
            "agreedSecret.size()",
            "derivationParameters.begin()",
            "derivationParameters.size()"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "DeriveKey",
          "container": "P1363_KDF2",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "503-507",
          "snippet": "DeriveKey(byte *output, size_t outputLength, const byte *input, size_t inputLength, const byte *derivationParams, size_t derivationParamsLength)\n\t{\n\t\tH h;\n\t\tP1363_MGF1KDF2_Common(h, output, outputLength, input, inputLength, derivationParams, derivationParamsLength, false, 1);\n\t}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nP1363_KDF2 {\n  DeriveKey(byte *output, size_t outputLength, const byte *input, size_t inputLength, const byte *derivationParams, size_t derivationParamsLength)\n  \t{\n  \t\tH h;\n  \t\tP1363_MGF1KDF2_Common(h, output, outputLength, input, inputLength, derivationParams, derivationParamsLength, false, 1);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "derivationParameters.size",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "derivationParameters.begin",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "parameters.GetValue",
          "args": [
            "Name::KeyDerivationParameters()",
            "derivationParameters"
          ],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::KeyDerivationParameters",
          "args": [],
          "line": 508
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.EncodeElement",
          "args": [
            "false",
            "agreedElement",
            "agreedSecret"
          ],
          "line": 504
        },
        "resolved": true,
        "details": {
          "function_name": "EncodeElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "53-54",
          "snippet": "void EncodeElement(bool reversible, const Element &element, byte *encoded) const\n\t\t{element.Encode(encoded, GetModulus().ByteCount());}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid EncodeElement(bool reversible, const Element &element, byte *encoded) const\n\t\t{element.Encode(encoded, GetModulus().ByteCount());}"
        }
      },
      {
        "call_info": {
          "callee": "agreedSecret.New",
          "args": [
            "params.GetEncodedElementSize(false)"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "New",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "361-365",
          "snippet": "void New(size_type newSize)\n\t{\n\t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n\t\tm_size = newSize;\n\t}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  void New(size_type newSize)\n  \t{\n  \t\tm_ptr = m_alloc.reallocate(m_ptr, m_size, newSize, false);\n  \t\tm_size = newSize;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.GetEncodedElementSize",
          "args": [
            "false"
          ],
          "line": 503
        },
        "resolved": true,
        "details": {
          "function_name": "GetEncodedElementSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "55-55",
          "snippet": "unsigned int GetEncodedElementSize(bool reversible) const {return GetModulus().ByteCount();}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nunsigned int GetEncodedElementSize(bool reversible) const {return GetModulus().ByteCount();}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_KeyDerivationAlgorithm_P1363 {\n  void Derive(const DL_GroupParameters<T> &params, byte *derivedKey, size_t derivedLength, const T &agreedElement, const T &ephemeralPublicKey, const NameValuePairs &parameters) const\n  \t{\n  \t\tSecByteBlock agreedSecret;\n  \t\tif (DHAES_MODE)\n  \t\t{\n  \t\t\tagreedSecret.New(params.GetEncodedElementSize(true) + params.GetEncodedElementSize(false));\n  \t\t\tparams.EncodeElement(true, ephemeralPublicKey, agreedSecret);\n  \t\t\tparams.EncodeElement(false, agreedElement, agreedSecret + params.GetEncodedElementSize(true));\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t\tagreedSecret.New(params.GetEncodedElementSize(false));\n  \t\t\tparams.EncodeElement(false, agreedElement, agreedSecret);\n  \t\t}\n  \n  \t\tConstByteArrayParameter derivationParameters;\n  \t\tparameters.GetValue(Name::KeyDerivationParameters(), derivationParameters);\n  \t\tKDF::DeriveKey(derivedKey, derivedLength, agreedSecret, agreedSecret.size(), derivationParameters.begin(), derivationParameters.size());\n  \t}\n}"
  },
  {
    "function_name": "ParameterSupported",
    "container": "DL_KeyDerivationAlgorithm_P1363",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "491-491",
    "snippet": "bool ParameterSupported(const char *name) const {return strcmp(name, Name::KeyDerivationParameters()) == 0;}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "Name::KeyDerivationParameters()"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::KeyDerivationParameters",
          "args": [],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_KeyDerivationAlgorithm_P1363 {\n  bool ParameterSupported(const char *name) const {return strcmp(name, Name::KeyDerivationParameters()) == 0;}\n}"
  },
  {
    "function_name": "SymmetricDecrypt",
    "container": "DL_EncryptionAlgorithm_Xor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "451-483",
    "snippet": "DecodingResult SymmetricDecrypt(const byte *key, const byte *ciphertext, size_t ciphertextLength, byte *plaintext, const NameValuePairs &parameters) const\n\t{\n\t\tsize_t plaintextLength = GetMaxSymmetricPlaintextLength(ciphertextLength);\n\t\tconst byte *cipherKey, *macKey;\n\t\tif (DHAES_MODE)\n\t\t{\n\t\t\tmacKey = key;\n\t\t\tcipherKey = key + MAC::DEFAULT_KEYLENGTH;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcipherKey = key;\n\t\t\tmacKey = key + plaintextLength;\n\t\t}\n\n\t\tConstByteArrayParameter encodingParameters;\n\t\tparameters.GetValue(Name::EncodingParameters(), encodingParameters);\n\n\t\tMAC mac(macKey);\n\t\tmac.Update(ciphertext, plaintextLength);\n\t\tmac.Update(encodingParameters.begin(), encodingParameters.size());\n\t\tif (DHAES_MODE)\n\t\t{\n\t\t\tbyte L[8] = {0,0,0,0};\n\t\t\tPutWord(false, BIG_ENDIAN_ORDER, L+4, word32(encodingParameters.size()));\n\t\t\tmac.Update(L, 8);\n\t\t}\n\t\tif (!mac.Verify(ciphertext + plaintextLength))\n\t\t\treturn DecodingResult();\n\n\t\txorbuf(plaintext, ciphertext, cipherKey, plaintextLength);\n\t\treturn DecodingResult(plaintextLength);\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DecodingResult",
          "args": [
            "plaintextLength"
          ],
          "line": 482
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xorbuf",
          "args": [
            "plaintext",
            "ciphertext",
            "cipherKey",
            "plaintextLength"
          ],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "xorbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.cpp",
          "lines": "47-77",
          "snippet": "void xorbuf(byte *output, const byte *input, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(output) && IsAligned<word32>(input) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(output) && IsAligned<word64>(input) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)output)[i] = ((word64*)input)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\toutput += 8*i;\n\t\t\tinput += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)output)[i] = ((word32*)input)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\toutput += 4*i;\n\t\tinput += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\toutput[i] = input[i] ^ mask[i];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <new>",
            "#include \"words.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <new>\n#include \"words.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid xorbuf(byte *output, const byte *input, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(output) && IsAligned<word32>(input) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(output) && IsAligned<word64>(input) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)output)[i] = ((word64*)input)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\toutput += 8*i;\n\t\t\tinput += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)output)[i] = ((word32*)input)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\toutput += 4*i;\n\t\tinput += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\toutput[i] = input[i] ^ mask[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "DecodingResult",
          "args": [],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mac.Verify",
          "args": [
            "ciphertext + plaintextLength"
          ],
          "line": 478
        },
        "resolved": true,
        "details": {
          "function_name": "Verify",
          "container": "PK_Verifier",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "778-782",
          "snippet": "bool PK_Verifier::Verify(PK_MessageAccumulator *messageAccumulator) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn VerifyAndRestart(*m);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nPK_Verifier {\n  bool PK_Verifier::Verify(PK_MessageAccumulator *messageAccumulator) const\n  {\n  \tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n  \treturn VerifyAndRestart(*m);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mac.Update",
          "args": [
            "L",
            "8"
          ],
          "line": 476
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "Adler32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/adler32.cpp",
          "lines": "8-54",
          "snippet": "void Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}",
          "includes": [
            "#include \"adler32.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"adler32.h\"\n#include \"pch.h\"\n\nAdler32 {\n  void Adler32::Update(const byte *input, size_t length)\n  {\n  \tconst unsigned long BASE = 65521;\n  \n  \tunsigned long s1 = m_s1;\n  \tunsigned long s2 = m_s2;\n  \n  \tif (length % 8 != 0)\n  \t{\n  \t\tdo\n  \t\t{\n  \t\t\ts1 += *input++;\n  \t\t\ts2 += s1;\n  \t\t\tlength--;\n  \t\t} while (length % 8 != 0);\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\ts2 %= BASE;\n  \t}\n  \n  \twhile (length > 0)\n  \t{\n  \t\ts1 += input[0]; s2 += s1;\n  \t\ts1 += input[1]; s2 += s1;\n  \t\ts1 += input[2]; s2 += s1;\n  \t\ts1 += input[3]; s2 += s1;\n  \t\ts1 += input[4]; s2 += s1;\n  \t\ts1 += input[5]; s2 += s1;\n  \t\ts1 += input[6]; s2 += s1;\n  \t\ts1 += input[7]; s2 += s1;\n  \n  \t\tlength -= 8;\n  \t\tinput += 8;\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\tif (length % 0x8000 == 0)\n  \t\t\ts2 %= BASE;\n  \t}\n  \n  \tassert(s1 < BASE);\n  \tassert(s2 < BASE);\n  \n  \tm_s1 = (word16)s1;\n  \tm_s2 = (word16)s2;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PutWord",
          "args": [
            "false",
            "BIG_ENDIAN_ORDER",
            "L+4",
            "word32(encodingParameters.size())"
          ],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "PutWord",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1144-1153",
          "snippet": "inline void PutWord(bool assumeAligned, ByteOrder order, byte *block, T value, const byte *xorBlock = NULL)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedPutWordNonTemplate(order, block, value, xorBlock);\n\tassert(IsAligned<T>(block));\n\tassert(IsAligned<T>(xorBlock));\n#endif\n\t*reinterpret_cast<T *>(block) = ConditionalByteReverse(order, value) ^ (xorBlock ? *reinterpret_cast<const T *>(xorBlock) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline void PutWord(bool assumeAligned, ByteOrder order, byte *block, T value, const byte *xorBlock = NULL)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedPutWordNonTemplate(order, block, value, xorBlock);\n\tassert(IsAligned<T>(block));\n\tassert(IsAligned<T>(xorBlock));\n#endif\n\t*reinterpret_cast<T *>(block) = ConditionalByteReverse(order, value) ^ (xorBlock ? *reinterpret_cast<const T *>(xorBlock) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "word32",
          "args": [
            "encodingParameters.size()"
          ],
          "line": 475
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encodingParameters.size",
          "args": [],
          "line": 475
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "encodingParameters.begin",
          "args": [],
          "line": 471
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "parameters.GetValue",
          "args": [
            "Name::EncodingParameters()",
            "encodingParameters"
          ],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::EncodingParameters",
          "args": [],
          "line": 467
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetMaxSymmetricPlaintextLength",
          "args": [
            "ciphertextLength"
          ],
          "line": 453
        },
        "resolved": true,
        "details": {
          "function_name": "GetMaxSymmetricPlaintextLength",
          "container": "DL_EncryptionAlgorithm_Xor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "420-421",
          "snippet": "size_t GetMaxSymmetricPlaintextLength(size_t ciphertextLength) const\n\t\t{return (unsigned int)SaturatingSubtract(ciphertextLength, (unsigned int)MAC::DIGESTSIZE);}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_EncryptionAlgorithm_Xor {\n  size_t GetMaxSymmetricPlaintextLength(size_t ciphertextLength) const\n  \t\t{return (unsigned int)SaturatingSubtract(ciphertextLength, (unsigned int)MAC::DIGESTSIZE);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_EncryptionAlgorithm_Xor {\n  DecodingResult SymmetricDecrypt(const byte *key, const byte *ciphertext, size_t ciphertextLength, byte *plaintext, const NameValuePairs &parameters) const\n  \t{\n  \t\tsize_t plaintextLength = GetMaxSymmetricPlaintextLength(ciphertextLength);\n  \t\tconst byte *cipherKey, *macKey;\n  \t\tif (DHAES_MODE)\n  \t\t{\n  \t\t\tmacKey = key;\n  \t\t\tcipherKey = key + MAC::DEFAULT_KEYLENGTH;\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t\tcipherKey = key;\n  \t\t\tmacKey = key + plaintextLength;\n  \t\t}\n  \n  \t\tConstByteArrayParameter encodingParameters;\n  \t\tparameters.GetValue(Name::EncodingParameters(), encodingParameters);\n  \n  \t\tMAC mac(macKey);\n  \t\tmac.Update(ciphertext, plaintextLength);\n  \t\tmac.Update(encodingParameters.begin(), encodingParameters.size());\n  \t\tif (DHAES_MODE)\n  \t\t{\n  \t\t\tbyte L[8] = {0,0,0,0};\n  \t\t\tPutWord(false, BIG_ENDIAN_ORDER, L+4, word32(encodingParameters.size()));\n  \t\t\tmac.Update(L, 8);\n  \t\t}\n  \t\tif (!mac.Verify(ciphertext + plaintextLength))\n  \t\t\treturn DecodingResult();\n  \n  \t\txorbuf(plaintext, ciphertext, cipherKey, plaintextLength);\n  \t\treturn DecodingResult(plaintextLength);\n  \t}\n}"
  },
  {
    "function_name": "SymmetricEncrypt",
    "container": "DL_EncryptionAlgorithm_Xor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "422-450",
    "snippet": "void SymmetricEncrypt(RandomNumberGenerator &rng, const byte *key, const byte *plaintext, size_t plaintextLength, byte *ciphertext, const NameValuePairs &parameters) const\n\t{\n\t\tconst byte *cipherKey, *macKey;\n\t\tif (DHAES_MODE)\n\t\t{\n\t\t\tmacKey = key;\n\t\t\tcipherKey = key + MAC::DEFAULT_KEYLENGTH;\n\t\t}\n\t\telse\n\t\t{\n\t\t\tcipherKey = key;\n\t\t\tmacKey = key + plaintextLength;\n\t\t}\n\n\t\tConstByteArrayParameter encodingParameters;\n\t\tparameters.GetValue(Name::EncodingParameters(), encodingParameters);\n\n\t\txorbuf(ciphertext, plaintext, cipherKey, plaintextLength);\n\t\tMAC mac(macKey);\n\t\tmac.Update(ciphertext, plaintextLength);\n\t\tmac.Update(encodingParameters.begin(), encodingParameters.size());\n\t\tif (DHAES_MODE)\n\t\t{\n\t\t\tbyte L[8] = {0,0,0,0};\n\t\t\tPutWord(false, BIG_ENDIAN_ORDER, L+4, word32(encodingParameters.size()));\n\t\t\tmac.Update(L, 8);\n\t\t}\n\t\tmac.Final(ciphertext + plaintextLength);\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mac.Final",
          "args": [
            "ciphertext + plaintextLength"
          ],
          "line": 449
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mac.Update",
          "args": [
            "L",
            "8"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "Adler32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/adler32.cpp",
          "lines": "8-54",
          "snippet": "void Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}",
          "includes": [
            "#include \"adler32.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"adler32.h\"\n#include \"pch.h\"\n\nAdler32 {\n  void Adler32::Update(const byte *input, size_t length)\n  {\n  \tconst unsigned long BASE = 65521;\n  \n  \tunsigned long s1 = m_s1;\n  \tunsigned long s2 = m_s2;\n  \n  \tif (length % 8 != 0)\n  \t{\n  \t\tdo\n  \t\t{\n  \t\t\ts1 += *input++;\n  \t\t\ts2 += s1;\n  \t\t\tlength--;\n  \t\t} while (length % 8 != 0);\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\ts2 %= BASE;\n  \t}\n  \n  \twhile (length > 0)\n  \t{\n  \t\ts1 += input[0]; s2 += s1;\n  \t\ts1 += input[1]; s2 += s1;\n  \t\ts1 += input[2]; s2 += s1;\n  \t\ts1 += input[3]; s2 += s1;\n  \t\ts1 += input[4]; s2 += s1;\n  \t\ts1 += input[5]; s2 += s1;\n  \t\ts1 += input[6]; s2 += s1;\n  \t\ts1 += input[7]; s2 += s1;\n  \n  \t\tlength -= 8;\n  \t\tinput += 8;\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\tif (length % 0x8000 == 0)\n  \t\t\ts2 %= BASE;\n  \t}\n  \n  \tassert(s1 < BASE);\n  \tassert(s2 < BASE);\n  \n  \tm_s1 = (word16)s1;\n  \tm_s2 = (word16)s2;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PutWord",
          "args": [
            "false",
            "BIG_ENDIAN_ORDER",
            "L+4",
            "word32(encodingParameters.size())"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "PutWord",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1144-1153",
          "snippet": "inline void PutWord(bool assumeAligned, ByteOrder order, byte *block, T value, const byte *xorBlock = NULL)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedPutWordNonTemplate(order, block, value, xorBlock);\n\tassert(IsAligned<T>(block));\n\tassert(IsAligned<T>(xorBlock));\n#endif\n\t*reinterpret_cast<T *>(block) = ConditionalByteReverse(order, value) ^ (xorBlock ? *reinterpret_cast<const T *>(xorBlock) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline void PutWord(bool assumeAligned, ByteOrder order, byte *block, T value, const byte *xorBlock = NULL)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedPutWordNonTemplate(order, block, value, xorBlock);\n\tassert(IsAligned<T>(block));\n\tassert(IsAligned<T>(xorBlock));\n#endif\n\t*reinterpret_cast<T *>(block) = ConditionalByteReverse(order, value) ^ (xorBlock ? *reinterpret_cast<const T *>(xorBlock) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "word32",
          "args": [
            "encodingParameters.size()"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "encodingParameters.size",
          "args": [],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "encodingParameters.begin",
          "args": [],
          "line": 442
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "xorbuf",
          "args": [
            "ciphertext",
            "plaintext",
            "cipherKey",
            "plaintextLength"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "xorbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.cpp",
          "lines": "47-77",
          "snippet": "void xorbuf(byte *output, const byte *input, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(output) && IsAligned<word32>(input) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(output) && IsAligned<word64>(input) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)output)[i] = ((word64*)input)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\toutput += 8*i;\n\t\t\tinput += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)output)[i] = ((word32*)input)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\toutput += 4*i;\n\t\tinput += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\toutput[i] = input[i] ^ mask[i];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <new>",
            "#include \"words.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <new>\n#include \"words.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid xorbuf(byte *output, const byte *input, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(output) && IsAligned<word32>(input) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(output) && IsAligned<word64>(input) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)output)[i] = ((word64*)input)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\toutput += 8*i;\n\t\t\tinput += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)output)[i] = ((word32*)input)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\toutput += 4*i;\n\t\tinput += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\toutput[i] = input[i] ^ mask[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "parameters.GetValue",
          "args": [
            "Name::EncodingParameters()",
            "encodingParameters"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::EncodingParameters",
          "args": [],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_EncryptionAlgorithm_Xor {\n  void SymmetricEncrypt(RandomNumberGenerator &rng, const byte *key, const byte *plaintext, size_t plaintextLength, byte *ciphertext, const NameValuePairs &parameters) const\n  \t{\n  \t\tconst byte *cipherKey, *macKey;\n  \t\tif (DHAES_MODE)\n  \t\t{\n  \t\t\tmacKey = key;\n  \t\t\tcipherKey = key + MAC::DEFAULT_KEYLENGTH;\n  \t\t}\n  \t\telse\n  \t\t{\n  \t\t\tcipherKey = key;\n  \t\t\tmacKey = key + plaintextLength;\n  \t\t}\n  \n  \t\tConstByteArrayParameter encodingParameters;\n  \t\tparameters.GetValue(Name::EncodingParameters(), encodingParameters);\n  \n  \t\txorbuf(ciphertext, plaintext, cipherKey, plaintextLength);\n  \t\tMAC mac(macKey);\n  \t\tmac.Update(ciphertext, plaintextLength);\n  \t\tmac.Update(encodingParameters.begin(), encodingParameters.size());\n  \t\tif (DHAES_MODE)\n  \t\t{\n  \t\t\tbyte L[8] = {0,0,0,0};\n  \t\t\tPutWord(false, BIG_ENDIAN_ORDER, L+4, word32(encodingParameters.size()));\n  \t\t\tmac.Update(L, 8);\n  \t\t}\n  \t\tmac.Final(ciphertext + plaintextLength);\n  \t}\n}"
  },
  {
    "function_name": "GetMaxSymmetricPlaintextLength",
    "container": "DL_EncryptionAlgorithm_Xor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "420-421",
    "snippet": "size_t GetMaxSymmetricPlaintextLength(size_t ciphertextLength) const\n\t\t{return (unsigned int)SaturatingSubtract(ciphertextLength, (unsigned int)MAC::DIGESTSIZE);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SaturatingSubtract",
          "args": [
            "ciphertextLength",
            "(unsigned int)MAC::DIGESTSIZE"
          ],
          "line": 421
        },
        "resolved": true,
        "details": {
          "function_name": "SaturatingSubtract",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "432-435",
          "snippet": "inline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_EncryptionAlgorithm_Xor {\n  size_t GetMaxSymmetricPlaintextLength(size_t ciphertextLength) const\n  \t\t{return (unsigned int)SaturatingSubtract(ciphertextLength, (unsigned int)MAC::DIGESTSIZE);}\n}"
  },
  {
    "function_name": "GetSymmetricCiphertextLength",
    "container": "DL_EncryptionAlgorithm_Xor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "418-419",
    "snippet": "size_t GetSymmetricCiphertextLength(size_t plaintextLength) const\n\t\t{return plaintextLength + MAC::DIGESTSIZE;}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_EncryptionAlgorithm_Xor {\n  size_t GetSymmetricCiphertextLength(size_t plaintextLength) const\n  \t\t{return plaintextLength + MAC::DIGESTSIZE;}\n}"
  },
  {
    "function_name": "GetSymmetricKeyLength",
    "container": "DL_EncryptionAlgorithm_Xor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "416-417",
    "snippet": "size_t GetSymmetricKeyLength(size_t plaintextLength) const\n\t\t{return plaintextLength + MAC::DEFAULT_KEYLENGTH;}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_EncryptionAlgorithm_Xor {\n  size_t GetSymmetricKeyLength(size_t plaintextLength) const\n  \t\t{return plaintextLength + MAC::DEFAULT_KEYLENGTH;}\n}"
  },
  {
    "function_name": "ParameterSupported",
    "container": "DL_EncryptionAlgorithm_Xor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "415-415",
    "snippet": "bool ParameterSupported(const char *name) const {return strcmp(name, Name::EncodingParameters()) == 0;}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "Name::EncodingParameters()"
          ],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::EncodingParameters",
          "args": [],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_EncryptionAlgorithm_Xor {\n  bool ParameterSupported(const char *name) const {return strcmp(name, Name::EncodingParameters()) == 0;}\n}"
  },
  {
    "function_name": "StaticAlgorithmName",
    "container": "DSA2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "400-400",
    "snippet": "StaticAlgorithmName() {return \"DSA/\" + (std::string)H::StaticAlgorithmName();}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "H::StaticAlgorithmName",
          "args": [],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "StaticAlgorithmName",
          "container": "DLIES",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "523-523",
          "snippet": "StaticAlgorithmName() {return \"DLIES\";}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDLIES {\n  StaticAlgorithmName() {return \"DLIES\";}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDSA2 {\n  StaticAlgorithmName() {return \"DSA/\" + (std::string)H::StaticAlgorithmName();}\n}"
  },
  {
    "function_name": "DEREncode",
    "container": "DL_PrivateKey_GFP_OldFormat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "330-340",
    "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t{\n\t\tDERSequenceEncoder seq(bt);\n\t\t\tthis->GetGroupParameters().GetModulus().DEREncode(seq);\n\t\t\tif (this->GetGroupParameters().GetCofactor() != 2)\n\t\t\t\tthis->GetGroupParameters().GetSubgroupOrder().DEREncode(seq);\n\t\t\tthis->GetGroupParameters().GetGenerator().DEREncode(seq);\n\t\t\tthis->GetGroupParameters().ExponentiateBase(this->GetPrivateExponent()).DEREncode(seq);\n\t\t\tthis->GetPrivateExponent().DEREncode(seq);\n\t\tseq.MessageEnd();\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 339
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": "DERGeneralEncoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.cpp",
          "lines": "504-511",
          "snippet": "void DERGeneralEncoder::MessageEnd()\n{\n\tm_finished = true;\n\tlword length = CurrentSize();\n\tm_outQueue.Put(m_asnTag);\n\tDERLengthEncode(m_outQueue, length);\n\tTransferTo(m_outQueue);\n}",
          "includes": [
            "#include <time.h>",
            "#include <iomanip>",
            "#include \"asn.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <iomanip>\n#include \"asn.h\"\n#include \"pch.h\"\n\nDERGeneralEncoder {\n  void DERGeneralEncoder::MessageEnd()\n  {\n  \tm_finished = true;\n  \tlword length = CurrentSize();\n  \tm_outQueue.Put(m_asnTag);\n  \tDERLengthEncode(m_outQueue, length);\n  \tTransferTo(m_outQueue);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->GetPrivateExponent",
          "args": [
            "seq"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetPrivateExponent",
          "args": [],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [
            "seq"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [
            "this->GetPrivateExponent()"
          ],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetPrivateExponent",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 337
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [
            "seq"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [
            "seq"
          ],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 335
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 334
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [
            "seq"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP_OldFormat {\n  void DEREncode(BufferedTransformation &bt) const\n  \t{\n  \t\tDERSequenceEncoder seq(bt);\n  \t\t\tthis->GetGroupParameters().GetModulus().DEREncode(seq);\n  \t\t\tif (this->GetGroupParameters().GetCofactor() != 2)\n  \t\t\t\tthis->GetGroupParameters().GetSubgroupOrder().DEREncode(seq);\n  \t\t\tthis->GetGroupParameters().GetGenerator().DEREncode(seq);\n  \t\t\tthis->GetGroupParameters().ExponentiateBase(this->GetPrivateExponent()).DEREncode(seq);\n  \t\t\tthis->GetPrivateExponent().DEREncode(seq);\n  \t\tseq.MessageEnd();\n  \t}\n}"
  },
  {
    "function_name": "BERDecode",
    "container": "DL_PrivateKey_GFP_OldFormat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "307-328",
    "snippet": "void BERDecode(BufferedTransformation &bt)\n\t{\n\t\tBERSequenceDecoder seq(bt);\n\t\t\tInteger v1(seq);\n\t\t\tInteger v2(seq);\n\t\t\tInteger v3(seq);\n\t\t\tInteger v4(seq);\n\n\t\t\tif (seq.EndReached())\n\t\t\t{\n\t\t\t\tthis->AccessGroupParameters().Initialize(v1, v1/2, v2);\n\t\t\t\tthis->SetPrivateExponent(v4 % (v1/2));\t// some old keys may have x >= q\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tInteger v5(seq);\n\t\t\t\tthis->AccessGroupParameters().Initialize(v1, v2, v3);\n\t\t\t\tthis->SetPrivateExponent(v5);\n\t\t\t}\n\n\t\tseq.MessageEnd();\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": "DERGeneralEncoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.cpp",
          "lines": "504-511",
          "snippet": "void DERGeneralEncoder::MessageEnd()\n{\n\tm_finished = true;\n\tlword length = CurrentSize();\n\tm_outQueue.Put(m_asnTag);\n\tDERLengthEncode(m_outQueue, length);\n\tTransferTo(m_outQueue);\n}",
          "includes": [
            "#include <time.h>",
            "#include <iomanip>",
            "#include \"asn.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <iomanip>\n#include \"asn.h\"\n#include \"pch.h\"\n\nDERGeneralEncoder {\n  void DERGeneralEncoder::MessageEnd()\n  {\n  \tm_finished = true;\n  \tlword length = CurrentSize();\n  \tm_outQueue.Put(m_asnTag);\n  \tDERLengthEncode(m_outQueue, length);\n  \tTransferTo(m_outQueue);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->SetPrivateExponent",
          "args": [
            "v5"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "SetPrivateExponent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "97-97",
          "snippet": "void SetPrivateExponent(const Integer &d) {m_d = d;}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid SetPrivateExponent(const Integer &d) {m_d = d;}"
        }
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "v1",
            "v2",
            "v3"
          ],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "v1",
            "v1/2",
            "v2"
          ],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq.EndReached",
          "args": [],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "EndReached",
          "container": "BERGeneralDecoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.cpp",
          "lines": "413-422",
          "snippet": "bool BERGeneralDecoder::EndReached() const\n{\n\tif (m_definiteLength)\n\t\treturn m_length == 0;\n\telse\n\t{\t// check end-of-content octets\n\t\tword16 i;\n\t\treturn (m_inQueue.PeekWord16(i)==2 && i==0);\n\t}\n}",
          "includes": [
            "#include <time.h>",
            "#include <iomanip>",
            "#include \"asn.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <iomanip>\n#include \"asn.h\"\n#include \"pch.h\"\n\nBERGeneralDecoder {\n  bool BERGeneralDecoder::EndReached() const\n  {\n  \tif (m_definiteLength)\n  \t\treturn m_length == 0;\n  \telse\n  \t{\t// check end-of-content octets\n  \t\tword16 i;\n  \t\treturn (m_inQueue.PeekWord16(i)==2 && i==0);\n  \t}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP_OldFormat {\n  void BERDecode(BufferedTransformation &bt)\n  \t{\n  \t\tBERSequenceDecoder seq(bt);\n  \t\t\tInteger v1(seq);\n  \t\t\tInteger v2(seq);\n  \t\t\tInteger v3(seq);\n  \t\t\tInteger v4(seq);\n  \n  \t\t\tif (seq.EndReached())\n  \t\t\t{\n  \t\t\t\tthis->AccessGroupParameters().Initialize(v1, v1/2, v2);\n  \t\t\t\tthis->SetPrivateExponent(v4 % (v1/2));\t// some old keys may have x >= q\n  \t\t\t}\n  \t\t\telse\n  \t\t\t{\n  \t\t\t\tInteger v5(seq);\n  \t\t\t\tthis->AccessGroupParameters().Initialize(v1, v2, v3);\n  \t\t\t\tthis->SetPrivateExponent(v5);\n  \t\t\t}\n  \n  \t\tseq.MessageEnd();\n  \t}\n}"
  },
  {
    "function_name": "DEREncode",
    "container": "DL_PublicKey_GFP_OldFormat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "290-299",
    "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t{\n\t\tDERSequenceEncoder seq(bt);\n\t\t\tthis->GetGroupParameters().GetModulus().DEREncode(seq);\n\t\t\tif (this->GetGroupParameters().GetCofactor() != 2)\n\t\t\t\tthis->GetGroupParameters().GetSubgroupOrder().DEREncode(seq);\n\t\t\tthis->GetGroupParameters().GetGenerator().DEREncode(seq);\n\t\t\tthis->GetPublicElement().DEREncode(seq);\n\t\tseq.MessageEnd();\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 298
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": "DERGeneralEncoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.cpp",
          "lines": "504-511",
          "snippet": "void DERGeneralEncoder::MessageEnd()\n{\n\tm_finished = true;\n\tlword length = CurrentSize();\n\tm_outQueue.Put(m_asnTag);\n\tDERLengthEncode(m_outQueue, length);\n\tTransferTo(m_outQueue);\n}",
          "includes": [
            "#include <time.h>",
            "#include <iomanip>",
            "#include \"asn.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <iomanip>\n#include \"asn.h\"\n#include \"pch.h\"\n\nDERGeneralEncoder {\n  void DERGeneralEncoder::MessageEnd()\n  {\n  \tm_finished = true;\n  \tlword length = CurrentSize();\n  \tm_outQueue.Put(m_asnTag);\n  \tDERLengthEncode(m_outQueue, length);\n  \tTransferTo(m_outQueue);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->GetPublicElement",
          "args": [
            "seq"
          ],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetPublicElement",
          "args": [],
          "line": 297
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [
            "seq"
          ],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 296
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [
            "seq"
          ],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 295
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 294
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [
            "seq"
          ],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetGroupParameters",
          "args": [],
          "line": 293
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PublicKey_GFP_OldFormat {\n  void DEREncode(BufferedTransformation &bt) const\n  \t{\n  \t\tDERSequenceEncoder seq(bt);\n  \t\t\tthis->GetGroupParameters().GetModulus().DEREncode(seq);\n  \t\t\tif (this->GetGroupParameters().GetCofactor() != 2)\n  \t\t\t\tthis->GetGroupParameters().GetSubgroupOrder().DEREncode(seq);\n  \t\t\tthis->GetGroupParameters().GetGenerator().DEREncode(seq);\n  \t\t\tthis->GetPublicElement().DEREncode(seq);\n  \t\tseq.MessageEnd();\n  \t}\n}"
  },
  {
    "function_name": "BERDecode",
    "container": "DL_PublicKey_GFP_OldFormat",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "268-288",
    "snippet": "void BERDecode(BufferedTransformation &bt)\n\t{\n\t\tBERSequenceDecoder seq(bt);\n\t\t\tInteger v1(seq);\n\t\t\tInteger v2(seq);\n\t\t\tInteger v3(seq);\n\n\t\t\tif (seq.EndReached())\n\t\t\t{\n\t\t\t\tthis->AccessGroupParameters().Initialize(v1, v1/2, v2);\n\t\t\t\tthis->SetPublicElement(v3);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tInteger v4(seq);\n\t\t\t\tthis->AccessGroupParameters().Initialize(v1, v2, v3);\n\t\t\t\tthis->SetPublicElement(v4);\n\t\t\t}\n\n\t\tseq.MessageEnd();\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": "DERGeneralEncoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.cpp",
          "lines": "504-511",
          "snippet": "void DERGeneralEncoder::MessageEnd()\n{\n\tm_finished = true;\n\tlword length = CurrentSize();\n\tm_outQueue.Put(m_asnTag);\n\tDERLengthEncode(m_outQueue, length);\n\tTransferTo(m_outQueue);\n}",
          "includes": [
            "#include <time.h>",
            "#include <iomanip>",
            "#include \"asn.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <iomanip>\n#include \"asn.h\"\n#include \"pch.h\"\n\nDERGeneralEncoder {\n  void DERGeneralEncoder::MessageEnd()\n  {\n  \tm_finished = true;\n  \tlword length = CurrentSize();\n  \tm_outQueue.Put(m_asnTag);\n  \tDERLengthEncode(m_outQueue, length);\n  \tTransferTo(m_outQueue);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->SetPublicElement",
          "args": [
            "v4"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "v1",
            "v2",
            "v3"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->SetPublicElement",
          "args": [
            "v3"
          ],
          "line": 278
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "v1",
            "v1/2",
            "v2"
          ],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 277
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "seq.EndReached",
          "args": [],
          "line": 275
        },
        "resolved": true,
        "details": {
          "function_name": "EndReached",
          "container": "BERGeneralDecoder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.cpp",
          "lines": "413-422",
          "snippet": "bool BERGeneralDecoder::EndReached() const\n{\n\tif (m_definiteLength)\n\t\treturn m_length == 0;\n\telse\n\t{\t// check end-of-content octets\n\t\tword16 i;\n\t\treturn (m_inQueue.PeekWord16(i)==2 && i==0);\n\t}\n}",
          "includes": [
            "#include <time.h>",
            "#include <iomanip>",
            "#include \"asn.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <time.h>\n#include <iomanip>\n#include \"asn.h\"\n#include \"pch.h\"\n\nBERGeneralDecoder {\n  bool BERGeneralDecoder::EndReached() const\n  {\n  \tif (m_definiteLength)\n  \t\treturn m_length == 0;\n  \telse\n  \t{\t// check end-of-content octets\n  \t\tword16 i;\n  \t\treturn (m_inQueue.PeekWord16(i)==2 && i==0);\n  \t}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PublicKey_GFP_OldFormat {\n  void BERDecode(BufferedTransformation &bt)\n  \t{\n  \t\tBERSequenceDecoder seq(bt);\n  \t\t\tInteger v1(seq);\n  \t\t\tInteger v2(seq);\n  \t\t\tInteger v3(seq);\n  \n  \t\t\tif (seq.EndReached())\n  \t\t\t{\n  \t\t\t\tthis->AccessGroupParameters().Initialize(v1, v1/2, v2);\n  \t\t\t\tthis->SetPublicElement(v3);\n  \t\t\t}\n  \t\t\telse\n  \t\t\t{\n  \t\t\t\tInteger v4(seq);\n  \t\t\t\tthis->AccessGroupParameters().Initialize(v1, v2, v3);\n  \t\t\t\tthis->SetPublicElement(v4);\n  \t\t\t}\n  \n  \t\tseq.MessageEnd();\n  \t}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PrivateKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "243-244",
    "snippet": "void Initialize(const Integer &p, const Integer &q, const Integer &g, const Integer &x)\n\t\t{this->AccessGroupParameters().Initialize(p, q, g); this->SetPrivateExponent(x);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->SetPrivateExponent",
          "args": [
            "x"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "SetPrivateExponent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "97-97",
          "snippet": "void SetPrivateExponent(const Integer &d) {m_d = d;}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid SetPrivateExponent(const Integer &d) {m_d = d;}"
        }
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "p",
            "q",
            "g"
          ],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 244
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP {\n  void Initialize(const Integer &p, const Integer &q, const Integer &g, const Integer &x)\n  \t\t{this->AccessGroupParameters().Initialize(p, q, g); this->SetPrivateExponent(x);}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PrivateKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "241-242",
    "snippet": "void Initialize(const Integer &p, const Integer &g, const Integer &x)\n\t\t{this->AccessGroupParameters().Initialize(p, g); this->SetPrivateExponent(x);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->SetPrivateExponent",
          "args": [
            "x"
          ],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "SetPrivateExponent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "97-97",
          "snippet": "void SetPrivateExponent(const Integer &d) {m_d = d;}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid SetPrivateExponent(const Integer &d) {m_d = d;}"
        }
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "p",
            "g"
          ],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 242
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP {\n  void Initialize(const Integer &p, const Integer &g, const Integer &x)\n  \t\t{this->AccessGroupParameters().Initialize(p, g); this->SetPrivateExponent(x);}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PrivateKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "239-240",
    "snippet": "void Initialize(const DL_GroupParameters_IntegerBased &params, const Integer &x)\n\t\t{this->AccessGroupParameters().Initialize(params); this->SetPrivateExponent(x);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->SetPrivateExponent",
          "args": [
            "x"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "SetPrivateExponent",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "97-97",
          "snippet": "void SetPrivateExponent(const Integer &d) {m_d = d;}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid SetPrivateExponent(const Integer &d) {m_d = d;}"
        }
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "params"
          ],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 240
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP {\n  void Initialize(const DL_GroupParameters_IntegerBased &params, const Integer &x)\n  \t\t{this->AccessGroupParameters().Initialize(params); this->SetPrivateExponent(x);}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PrivateKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "237-238",
    "snippet": "void Initialize(RandomNumberGenerator &rng, const Integer &p, const Integer &q, const Integer &g)\n\t\t{this->GenerateRandom(rng, MakeParameters(\"Modulus\", p)(\"SubgroupOrder\", q)(\"SubgroupGenerator\", g));}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->GenerateRandom",
          "args": [
            "rng",
            "MakeParameters(\"Modulus\", p)(\"SubgroupOrder\", q)(\"SubgroupGenerator\", g)"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateRandom",
          "container": "DL_GroupParameters_IntegerBased",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
          "lines": "161-187",
          "snippet": "void DL_GroupParameters_IntegerBased::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tInteger p, q, g;\n\t\n\tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n\t{\n\t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n\t}\n\telse\n\t{\n\t\tint modulusSize, subgroupOrderSize;\n\n\t\tif (!alg.GetIntValue(\"ModulusSize\", modulusSize))\n\t\t\tmodulusSize = alg.GetIntValueWithDefault(\"KeySize\", 2048);\n\n\t\tif (!alg.GetIntValue(\"SubgroupOrderSize\", subgroupOrderSize))\n\t\t\tsubgroupOrderSize = GetDefaultSubgroupOrderSize(modulusSize);\n\n\t\tPrimeAndGenerator pg;\n\t\tpg.Generate(GetFieldType() == 1 ? 1 : -1, rng, modulusSize, subgroupOrderSize);\n\t\tp = pg.Prime();\n\t\tq = pg.SubPrime();\n\t\tg = pg.Generator();\n\t}\n\n\tInitialize(p, q, g);\n}",
          "includes": [
            "#include \"nbtheory.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"gfpcrypt.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nDL_GroupParameters_IntegerBased {\n  void DL_GroupParameters_IntegerBased::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n  {\n  \tInteger p, q, g;\n  \t\n  \tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n  \t{\n  \t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n  \t}\n  \telse\n  \t{\n  \t\tint modulusSize, subgroupOrderSize;\n  \n  \t\tif (!alg.GetIntValue(\"ModulusSize\", modulusSize))\n  \t\t\tmodulusSize = alg.GetIntValueWithDefault(\"KeySize\", 2048);\n  \n  \t\tif (!alg.GetIntValue(\"SubgroupOrderSize\", subgroupOrderSize))\n  \t\t\tsubgroupOrderSize = GetDefaultSubgroupOrderSize(modulusSize);\n  \n  \t\tPrimeAndGenerator pg;\n  \t\tpg.Generate(GetFieldType() == 1 ? 1 : -1, rng, modulusSize, subgroupOrderSize);\n  \t\tp = pg.Prime();\n  \t\tq = pg.SubPrime();\n  \t\tg = pg.Generator();\n  \t}\n  \n  \tInitialize(p, q, g);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "\"SubgroupGenerator\"",
            "g"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP {\n  void Initialize(RandomNumberGenerator &rng, const Integer &p, const Integer &q, const Integer &g)\n  \t\t{this->GenerateRandom(rng, MakeParameters(\"Modulus\", p)(\"SubgroupOrder\", q)(\"SubgroupGenerator\", g));}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PrivateKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "235-236",
    "snippet": "void Initialize(RandomNumberGenerator &rng, const Integer &p, const Integer &g)\n\t\t{this->GenerateRandom(rng, MakeParameters(\"Modulus\", p)(\"SubgroupGenerator\", g));}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->GenerateRandom",
          "args": [
            "rng",
            "MakeParameters(\"Modulus\", p)(\"SubgroupGenerator\", g)"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateRandom",
          "container": "DL_GroupParameters_IntegerBased",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
          "lines": "161-187",
          "snippet": "void DL_GroupParameters_IntegerBased::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tInteger p, q, g;\n\t\n\tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n\t{\n\t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n\t}\n\telse\n\t{\n\t\tint modulusSize, subgroupOrderSize;\n\n\t\tif (!alg.GetIntValue(\"ModulusSize\", modulusSize))\n\t\t\tmodulusSize = alg.GetIntValueWithDefault(\"KeySize\", 2048);\n\n\t\tif (!alg.GetIntValue(\"SubgroupOrderSize\", subgroupOrderSize))\n\t\t\tsubgroupOrderSize = GetDefaultSubgroupOrderSize(modulusSize);\n\n\t\tPrimeAndGenerator pg;\n\t\tpg.Generate(GetFieldType() == 1 ? 1 : -1, rng, modulusSize, subgroupOrderSize);\n\t\tp = pg.Prime();\n\t\tq = pg.SubPrime();\n\t\tg = pg.Generator();\n\t}\n\n\tInitialize(p, q, g);\n}",
          "includes": [
            "#include \"nbtheory.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"gfpcrypt.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nDL_GroupParameters_IntegerBased {\n  void DL_GroupParameters_IntegerBased::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n  {\n  \tInteger p, q, g;\n  \t\n  \tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n  \t{\n  \t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n  \t}\n  \telse\n  \t{\n  \t\tint modulusSize, subgroupOrderSize;\n  \n  \t\tif (!alg.GetIntValue(\"ModulusSize\", modulusSize))\n  \t\t\tmodulusSize = alg.GetIntValueWithDefault(\"KeySize\", 2048);\n  \n  \t\tif (!alg.GetIntValue(\"SubgroupOrderSize\", subgroupOrderSize))\n  \t\t\tsubgroupOrderSize = GetDefaultSubgroupOrderSize(modulusSize);\n  \n  \t\tPrimeAndGenerator pg;\n  \t\tpg.Generate(GetFieldType() == 1 ? 1 : -1, rng, modulusSize, subgroupOrderSize);\n  \t\tp = pg.Prime();\n  \t\tq = pg.SubPrime();\n  \t\tg = pg.Generator();\n  \t}\n  \n  \tInitialize(p, q, g);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "\"SubgroupGenerator\"",
            "g"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP {\n  void Initialize(RandomNumberGenerator &rng, const Integer &p, const Integer &g)\n  \t\t{this->GenerateRandom(rng, MakeParameters(\"Modulus\", p)(\"SubgroupGenerator\", g));}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PrivateKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "233-234",
    "snippet": "void Initialize(RandomNumberGenerator &rng, unsigned int modulusBits)\n\t\t{this->GenerateRandomWithKeySize(rng, modulusBits);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->GenerateRandomWithKeySize",
          "args": [
            "rng",
            "modulusBits"
          ],
          "line": 234
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateRandomWithKeySize",
          "container": "GeneratableCryptoMaterial",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "658-661",
          "snippet": "void GeneratableCryptoMaterial::GenerateRandomWithKeySize(RandomNumberGenerator &rng, unsigned int keySize)\n{\n\tGenerateRandom(rng, MakeParameters(\"KeySize\", (int)keySize));\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nGeneratableCryptoMaterial {\n  void GeneratableCryptoMaterial::GenerateRandomWithKeySize(RandomNumberGenerator &rng, unsigned int keySize)\n  {\n  \tGenerateRandom(rng, MakeParameters(\"KeySize\", (int)keySize));\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP {\n  void Initialize(RandomNumberGenerator &rng, unsigned int modulusBits)\n  \t\t{this->GenerateRandomWithKeySize(rng, modulusBits);}\n}"
  },
  {
    "function_name": "DEREncodePublicKey",
    "container": "DL_PublicKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "224-225",
    "snippet": "void DEREncodePublicKey(BufferedTransformation &bt) const\n\t\t{this->GetPublicElement().DEREncode(bt);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->GetPublicElement",
          "args": [
            "bt"
          ],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->GetPublicElement",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PublicKey_GFP {\n  void DEREncodePublicKey(BufferedTransformation &bt) const\n  \t\t{this->GetPublicElement().DEREncode(bt);}\n}"
  },
  {
    "function_name": "BERDecodePublicKey",
    "container": "DL_PublicKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "222-223",
    "snippet": "void BERDecodePublicKey(BufferedTransformation &bt, bool, size_t)\n\t\t{this->SetPublicElement(Integer(bt));}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->SetPublicElement",
          "args": [
            "Integer(bt)"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Integer",
          "args": [
            "bt"
          ],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertElementToInteger",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "57-58",
          "snippet": "Integer ConvertElementToInteger(const Element &element) const\n\t\t{return element;}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nInteger ConvertElementToInteger(const Element &element) const\n\t\t{return element;}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PublicKey_GFP {\n  void BERDecodePublicKey(BufferedTransformation &bt, bool, size_t)\n  \t\t{this->SetPublicElement(Integer(bt));}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PublicKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "218-219",
    "snippet": "void Initialize(const Integer &p, const Integer &q, const Integer &g, const Integer &y)\n\t\t{this->AccessGroupParameters().Initialize(p, q, g); this->SetPublicElement(y);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->SetPublicElement",
          "args": [
            "y"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "p",
            "q",
            "g"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PublicKey_GFP {\n  void Initialize(const Integer &p, const Integer &q, const Integer &g, const Integer &y)\n  \t\t{this->AccessGroupParameters().Initialize(p, q, g); this->SetPublicElement(y);}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PublicKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "216-217",
    "snippet": "void Initialize(const Integer &p, const Integer &g, const Integer &y)\n\t\t{this->AccessGroupParameters().Initialize(p, g); this->SetPublicElement(y);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->SetPublicElement",
          "args": [
            "y"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "p",
            "g"
          ],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 217
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PublicKey_GFP {\n  void Initialize(const Integer &p, const Integer &g, const Integer &y)\n  \t\t{this->AccessGroupParameters().Initialize(p, g); this->SetPublicElement(y);}\n}"
  },
  {
    "function_name": "Initialize",
    "container": "DL_PublicKey_GFP",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "214-215",
    "snippet": "void Initialize(const DL_GroupParameters_IntegerBased &params, const Integer &y)\n\t\t{this->AccessGroupParameters().Initialize(params); this->SetPublicElement(y);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->SetPublicElement",
          "args": [
            "y"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [
            "params"
          ],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->AccessGroupParameters",
          "args": [],
          "line": 215
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PublicKey_GFP {\n  void Initialize(const DL_GroupParameters_IntegerBased &params, const Integer &y)\n  \t\t{this->AccessGroupParameters().Initialize(params); this->SetPublicElement(y);}\n}"
  },
  {
    "function_name": "Verify",
    "container": "DL_Algorithm_NR",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "197-205",
    "snippet": "bool Verify(const DL_GroupParameters<T> &params, const DL_PublicKey<T> &publicKey, const Integer &e, const Integer &r, const Integer &s) const\n\t{\n\t\tconst Integer &q = params.GetSubgroupOrder();\n\t\tif (r>=q || r<1 || s>=q)\n\t\t\treturn false;\n\n\t\t// check r == (m_g^s * m_y^r + m) mod m_q\n\t\treturn r == (params.ConvertElementToInteger(publicKey.CascadeExponentiateBaseAndPublicElement(s, r)) + e) % q;\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "params.ConvertElementToInteger",
          "args": [
            "publicKey.CascadeExponentiateBaseAndPublicElement(s, r)"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertElementToInteger",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "57-58",
          "snippet": "Integer ConvertElementToInteger(const Element &element) const\n\t\t{return element;}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nInteger ConvertElementToInteger(const Element &element) const\n\t\t{return element;}"
        }
      },
      {
        "call_info": {
          "callee": "publicKey.CascadeExponentiateBaseAndPublicElement",
          "args": [
            "s",
            "r"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.GetSubgroupOrder",
          "args": [],
          "line": 199
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_Algorithm_NR {\n  bool Verify(const DL_GroupParameters<T> &params, const DL_PublicKey<T> &publicKey, const Integer &e, const Integer &r, const Integer &s) const\n  \t{\n  \t\tconst Integer &q = params.GetSubgroupOrder();\n  \t\tif (r>=q || r<1 || s>=q)\n  \t\t\treturn false;\n  \n  \t\t// check r == (m_g^s * m_y^r + m) mod m_q\n  \t\treturn r == (params.ConvertElementToInteger(publicKey.CascadeExponentiateBaseAndPublicElement(s, r)) + e) % q;\n  \t}\n}"
  },
  {
    "function_name": "Sign",
    "container": "DL_Algorithm_NR",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "189-195",
    "snippet": "void Sign(const DL_GroupParameters<T> &params, const Integer &x, const Integer &k, const Integer &e, Integer &r, Integer &s) const\n\t{\n\t\tconst Integer &q = params.GetSubgroupOrder();\n\t\tr = (r + e) % q;\n\t\ts = (k - x*r) % q;\n\t\tassert(!!r);\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!!r"
          ],
          "line": 194
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.GetSubgroupOrder",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_Algorithm_NR {\n  void Sign(const DL_GroupParameters<T> &params, const Integer &x, const Integer &k, const Integer &e, Integer &r, Integer &s) const\n  \t{\n  \t\tconst Integer &q = params.GetSubgroupOrder();\n  \t\tr = (r + e) % q;\n  \t\ts = (k - x*r) % q;\n  \t\tassert(!!r);\n  \t}\n}"
  },
  {
    "function_name": "StaticAlgorithmName",
    "container": "DL_Algorithm_NR",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "187-187",
    "snippet": "StaticAlgorithmName() {return \"NR\";}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_Algorithm_NR {\n  StaticAlgorithmName() {return \"NR\";}\n}"
  },
  {
    "function_name": "Verify",
    "container": "DL_Algorithm_GDSA",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "166-177",
    "snippet": "bool Verify(const DL_GroupParameters<T> &params, const DL_PublicKey<T> &publicKey, const Integer &e, const Integer &r, const Integer &s) const\n\t{\n\t\tconst Integer &q = params.GetSubgroupOrder();\n\t\tif (r>=q || r<1 || s>=q || s<1)\n\t\t\treturn false;\n\n\t\tInteger w = s.InverseMod(q);\n\t\tInteger u1 = (e * w) % q;\n\t\tInteger u2 = (r * w) % q;\n\t\t// verify r == (g^u1 * y^u2 mod p) mod q\n\t\treturn r == params.ConvertElementToInteger(publicKey.CascadeExponentiateBaseAndPublicElement(u1, u2)) % q;\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "params.ConvertElementToInteger",
          "args": [
            "publicKey.CascadeExponentiateBaseAndPublicElement(u1, u2)"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertElementToInteger",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "57-58",
          "snippet": "Integer ConvertElementToInteger(const Element &element) const\n\t\t{return element;}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nInteger ConvertElementToInteger(const Element &element) const\n\t\t{return element;}"
        }
      },
      {
        "call_info": {
          "callee": "publicKey.CascadeExponentiateBaseAndPublicElement",
          "args": [
            "u1",
            "u2"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.InverseMod",
          "args": [
            "q"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "InverseMod",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3983-4006",
          "snippet": "word Integer::InverseMod(word mod) const\n{\n\tword g0 = mod, g1 = *this % mod;\n\tword v0 = 0, v1 = 1;\n\tword y;\n\n\twhile (g1)\n\t{\n\t\tif (g1 == 1)\n\t\t\treturn v1;\n\t\ty = g0 / g1;\n\t\tg0 = g0 % g1;\n\t\tv0 += y * v1;\n\n\t\tif (!g0)\n\t\t\tbreak;\n\t\tif (g0 == 1)\n\t\t\treturn mod-v0;\n\t\ty = g1 / g0;\n\t\tg1 = g1 % g0;\n\t\tv1 += y * v0;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  word Integer::InverseMod(word mod) const\n  {\n  \tword g0 = mod, g1 = *this % mod;\n  \tword v0 = 0, v1 = 1;\n  \tword y;\n  \n  \twhile (g1)\n  \t{\n  \t\tif (g1 == 1)\n  \t\t\treturn v1;\n  \t\ty = g0 / g1;\n  \t\tg0 = g0 % g1;\n  \t\tv0 += y * v1;\n  \n  \t\tif (!g0)\n  \t\t\tbreak;\n  \t\tif (g0 == 1)\n  \t\t\treturn mod-v0;\n  \t\ty = g1 / g0;\n  \t\tg1 = g1 % g0;\n  \t\tv1 += y * v0;\n  \t}\n  \treturn 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.GetSubgroupOrder",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_Algorithm_GDSA {\n  bool Verify(const DL_GroupParameters<T> &params, const DL_PublicKey<T> &publicKey, const Integer &e, const Integer &r, const Integer &s) const\n  \t{\n  \t\tconst Integer &q = params.GetSubgroupOrder();\n  \t\tif (r>=q || r<1 || s>=q || s<1)\n  \t\t\treturn false;\n  \n  \t\tInteger w = s.InverseMod(q);\n  \t\tInteger u1 = (e * w) % q;\n  \t\tInteger u2 = (r * w) % q;\n  \t\t// verify r == (g^u1 * y^u2 mod p) mod q\n  \t\treturn r == params.ConvertElementToInteger(publicKey.CascadeExponentiateBaseAndPublicElement(u1, u2)) % q;\n  \t}\n}"
  },
  {
    "function_name": "Sign",
    "container": "DL_Algorithm_GDSA",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "157-164",
    "snippet": "void Sign(const DL_GroupParameters<T> &params, const Integer &x, const Integer &k, const Integer &e, Integer &r, Integer &s) const\n\t{\n\t\tconst Integer &q = params.GetSubgroupOrder();\n\t\tr %= q;\n\t\tInteger kInv = k.InverseMod(q);\n\t\ts = (kInv * (x*r + e)) % q;\n\t\tassert(!!r && !!s);\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!!r && !!s"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "k.InverseMod",
          "args": [
            "q"
          ],
          "line": 161
        },
        "resolved": true,
        "details": {
          "function_name": "InverseMod",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3983-4006",
          "snippet": "word Integer::InverseMod(word mod) const\n{\n\tword g0 = mod, g1 = *this % mod;\n\tword v0 = 0, v1 = 1;\n\tword y;\n\n\twhile (g1)\n\t{\n\t\tif (g1 == 1)\n\t\t\treturn v1;\n\t\ty = g0 / g1;\n\t\tg0 = g0 % g1;\n\t\tv0 += y * v1;\n\n\t\tif (!g0)\n\t\t\tbreak;\n\t\tif (g0 == 1)\n\t\t\treturn mod-v0;\n\t\ty = g1 / g0;\n\t\tg1 = g1 % g0;\n\t\tv1 += y * v0;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  word Integer::InverseMod(word mod) const\n  {\n  \tword g0 = mod, g1 = *this % mod;\n  \tword v0 = 0, v1 = 1;\n  \tword y;\n  \n  \twhile (g1)\n  \t{\n  \t\tif (g1 == 1)\n  \t\t\treturn v1;\n  \t\ty = g0 / g1;\n  \t\tg0 = g0 % g1;\n  \t\tv0 += y * v1;\n  \n  \t\tif (!g0)\n  \t\t\tbreak;\n  \t\tif (g0 == 1)\n  \t\t\treturn mod-v0;\n  \t\ty = g1 / g0;\n  \t\tg1 = g1 % g0;\n  \t\tv1 += y * v0;\n  \t}\n  \treturn 0;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.GetSubgroupOrder",
          "args": [],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_Algorithm_GDSA {\n  void Sign(const DL_GroupParameters<T> &params, const Integer &x, const Integer &k, const Integer &e, Integer &r, Integer &s) const\n  \t{\n  \t\tconst Integer &q = params.GetSubgroupOrder();\n  \t\tr %= q;\n  \t\tInteger kInv = k.InverseMod(q);\n  \t\ts = (kInv * (x*r + e)) % q;\n  \t\tassert(!!r && !!s);\n  \t}\n}"
  },
  {
    "function_name": "StaticAlgorithmName",
    "container": "DL_Algorithm_GDSA",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "155-155",
    "snippet": "StaticAlgorithmName() {return \"DSA-1363\";}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_Algorithm_GDSA {\n  StaticAlgorithmName() {return \"DSA-1363\";}\n}"
  },
  {
    "function_name": "GetVoidValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "127-130",
    "snippet": "bool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\treturn GetValueHelper<DL_GroupParameters_IntegerBased>(this, name, valueType, pValue).Assignable();\n\t}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetValueHelper<DL_GroupParameters_IntegerBased>",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetValueHelper<DL_GroupParameters_IntegerBased>",
          "args": [
            "this",
            "name",
            "valueType",
            "pValue"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "GetValueHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "161-164",
          "snippet": "GetValueHelperClass<T, T> GetValueHelper(const T *pObject, const char *name, const std::type_info &valueType, void *pValue, const NameValuePairs *searchFirst=NULL)\n{\n\treturn GetValueHelperClass<T, T>(pObject, name, valueType, pValue, searchFirst);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nGetValueHelperClass<T, T> GetValueHelper(const T *pObject, const char *name, const std::type_info &valueType, void *pValue, const NameValuePairs *searchFirst=NULL)\n{\n\treturn GetValueHelperClass<T, T>(pObject, name, valueType, pValue, searchFirst);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nbool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\treturn GetValueHelper<DL_GroupParameters_IntegerBased>(this, name, valueType, pValue).Assignable();\n\t}"
  },
  {
    "function_name": "SetSubgroupOrder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "67-68",
    "snippet": "void SetSubgroupOrder(const Integer &q)\n\t\t{m_q = q; ParametersChanged();}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ParametersChanged",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid SetSubgroupOrder(const Integer &q)\n\t\t{m_q = q; ParametersChanged();}"
  },
  {
    "function_name": "CRYPTOPP_API StaticAlgorithmNamePrefix",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "60-60",
    "snippet": "static std::string CRYPTOPP_API StaticAlgorithmNamePrefix() {return \"\";}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nstatic std::string CRYPTOPP_API StaticAlgorithmNamePrefix() {return \"\";}"
  },
  {
    "function_name": "ConvertElementToInteger",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "57-58",
    "snippet": "Integer ConvertElementToInteger(const Element &element) const\n\t\t{return element;}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nInteger ConvertElementToInteger(const Element &element) const\n\t\t{return element;}"
  },
  {
    "function_name": "GetEncodedElementSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "55-55",
    "snippet": "unsigned int GetEncodedElementSize(bool reversible) const {return GetModulus().ByteCount();}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nunsigned int GetEncodedElementSize(bool reversible) const {return GetModulus().ByteCount();}"
  },
  {
    "function_name": "EncodeElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "53-54",
    "snippet": "void EncodeElement(bool reversible, const Element &element, byte *encoded) const\n\t\t{element.Encode(encoded, GetModulus().ByteCount());}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "element.Encode",
          "args": [
            "encoded",
            "GetModulus().ByteCount()"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "GFP2Element",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "21-25",
          "snippet": "void Encode(byte *encodedElement, unsigned int size)\n\t{\n\t\tc1.Encode(encodedElement, size/2);\n\t\tc2.Encode(encodedElement+size/2, size/2);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2Element {\n  void Encode(byte *encodedElement, unsigned int size)\n  \t{\n  \t\tc1.Encode(encodedElement, size/2);\n  \t\tc2.Encode(encodedElement+size/2, size/2);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid EncodeElement(bool reversible, const Element &element, byte *encoded) const\n\t\t{element.Encode(encoded, GetModulus().ByteCount());}"
  },
  {
    "function_name": "FastSubgroupCheckAvailable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "52-52",
    "snippet": "bool FastSubgroupCheckAvailable() const {return GetCofactor() == 2;}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetCofactor",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "GetCofactor",
          "container": "DL_GroupParameters_EC<EC>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eccrypto.cpp",
          "lines": "544-554",
          "snippet": "Integer DL_GroupParameters_EC<EC>::GetCofactor() const\n{\n\tif (!m_k)\n\t{\n\t\tInteger q = GetCurve().FieldSize();\n\t\tInteger qSqrt = q.SquareRoot();\n\t\tm_k = (q+2*qSqrt+1)/m_n;\n\t}\n\n\treturn m_k;\n}",
          "includes": [
            "#include \"ec2n.h\"",
            "#include \"argnames.h\"",
            "#include \"hex.h\"",
            "#include \"oids.h\"",
            "#include \"nbtheory.h\"",
            "#include \"eccrypto.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ec2n.h\"\n#include \"argnames.h\"\n#include \"hex.h\"\n#include \"oids.h\"\n#include \"nbtheory.h\"\n#include \"eccrypto.h\"\n#include \"pch.h\"\n\nDL_GroupParameters_EC<EC> {\n  Integer DL_GroupParameters_EC<EC>::GetCofactor() const\n  {\n  \tif (!m_k)\n  \t{\n  \t\tInteger q = GetCurve().FieldSize();\n  \t\tInteger qSqrt = q.SquareRoot();\n  \t\tm_k = (q+2*qSqrt+1)/m_n;\n  \t}\n  \n  \treturn m_k;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nbool FastSubgroupCheckAvailable() const {return GetCofactor() == 2;}"
  },
  {
    "function_name": "GetGroupOrder",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "49-49",
    "snippet": "Integer GetGroupOrder() const {return GetFieldType() == 1 ? GetModulus()-Integer::One() : GetModulus()+Integer::One();}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Integer::One",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "One",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "44-45",
          "snippet": "Element One() const\n\t\t{return 1;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element One() const\n  \t\t{return 1;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetFieldType",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "GetFieldType",
          "container": "DL_GroupParameters_LUC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/luc.h",
          "lines": "168-168",
          "snippet": "int GetFieldType() const {return 2;}",
          "includes": [
            "#include <limits.h>",
            "#include \"dh.h\"",
            "#include \"integer.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"dh.h\"\n#include \"integer.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n\nDL_GroupParameters_LUC {\n  int GetFieldType() const {return 2;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nInteger GetGroupOrder() const {return GetFieldType() == 1 ? GetModulus()-Integer::One() : GetModulus()+Integer::One();}"
  },
  {
    "function_name": "Initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "34-35",
    "snippet": "void Initialize(const Integer &p, const Integer &q, const Integer &g)\n\t\t{SetModulusAndSubgroupGenerator(p, g); SetSubgroupOrder(q);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetSubgroupOrder",
          "args": [
            "q"
          ],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "SetSubgroupOrder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "67-68",
          "snippet": "void SetSubgroupOrder(const Integer &q)\n\t\t{m_q = q; ParametersChanged();}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid SetSubgroupOrder(const Integer &q)\n\t\t{m_q = q; ParametersChanged();}"
        }
      },
      {
        "call_info": {
          "callee": "SetModulusAndSubgroupGenerator",
          "args": [
            "p",
            "g"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid Initialize(const Integer &p, const Integer &q, const Integer &g)\n\t\t{SetModulusAndSubgroupGenerator(p, g); SetSubgroupOrder(q);}"
  },
  {
    "function_name": "Initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "32-33",
    "snippet": "void Initialize(const Integer &p, const Integer &g)\n\t\t{SetModulusAndSubgroupGenerator(p, g); SetSubgroupOrder(ComputeGroupOrder(p)/2);}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetSubgroupOrder",
          "args": [
            "ComputeGroupOrder(p)/2"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "SetSubgroupOrder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "67-68",
          "snippet": "void SetSubgroupOrder(const Integer &q)\n\t\t{m_q = q; ParametersChanged();}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid SetSubgroupOrder(const Integer &q)\n\t\t{m_q = q; ParametersChanged();}"
        }
      },
      {
        "call_info": {
          "callee": "ComputeGroupOrder",
          "args": [
            "p"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SetModulusAndSubgroupGenerator",
          "args": [
            "p",
            "g"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid Initialize(const Integer &p, const Integer &g)\n\t\t{SetModulusAndSubgroupGenerator(p, g); SetSubgroupOrder(ComputeGroupOrder(p)/2);}"
  },
  {
    "function_name": "Initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
    "lines": "30-31",
    "snippet": "void Initialize(RandomNumberGenerator &rng, unsigned int pbits)\n\t\t{GenerateRandom(rng, MakeParameters(\"ModulusSize\", (int)pbits));}",
    "includes": [
      "#include <limits.h>",
      "#include \"hmac.h\"",
      "#include \"smartptr.h\"",
      "#include \"asn.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"modexppc.h\"",
      "#include \"pubkey.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateRandom",
          "args": [
            "rng",
            "MakeParameters(\"ModulusSize\", (int)pbits)"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateRandom",
          "container": "DL_GroupParameters_IntegerBased",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
          "lines": "161-187",
          "snippet": "void DL_GroupParameters_IntegerBased::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tInteger p, q, g;\n\t\n\tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n\t{\n\t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n\t}\n\telse\n\t{\n\t\tint modulusSize, subgroupOrderSize;\n\n\t\tif (!alg.GetIntValue(\"ModulusSize\", modulusSize))\n\t\t\tmodulusSize = alg.GetIntValueWithDefault(\"KeySize\", 2048);\n\n\t\tif (!alg.GetIntValue(\"SubgroupOrderSize\", subgroupOrderSize))\n\t\t\tsubgroupOrderSize = GetDefaultSubgroupOrderSize(modulusSize);\n\n\t\tPrimeAndGenerator pg;\n\t\tpg.Generate(GetFieldType() == 1 ? 1 : -1, rng, modulusSize, subgroupOrderSize);\n\t\tp = pg.Prime();\n\t\tq = pg.SubPrime();\n\t\tg = pg.Generator();\n\t}\n\n\tInitialize(p, q, g);\n}",
          "includes": [
            "#include \"nbtheory.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"gfpcrypt.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nDL_GroupParameters_IntegerBased {\n  void DL_GroupParameters_IntegerBased::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n  {\n  \tInteger p, q, g;\n  \t\n  \tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n  \t{\n  \t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n  \t}\n  \telse\n  \t{\n  \t\tint modulusSize, subgroupOrderSize;\n  \n  \t\tif (!alg.GetIntValue(\"ModulusSize\", modulusSize))\n  \t\t\tmodulusSize = alg.GetIntValueWithDefault(\"KeySize\", 2048);\n  \n  \t\tif (!alg.GetIntValue(\"SubgroupOrderSize\", subgroupOrderSize))\n  \t\t\tsubgroupOrderSize = GetDefaultSubgroupOrderSize(modulusSize);\n  \n  \t\tPrimeAndGenerator pg;\n  \t\tpg.Generate(GetFieldType() == 1 ? 1 : -1, rng, modulusSize, subgroupOrderSize);\n  \t\tp = pg.Prime();\n  \t\tq = pg.SubPrime();\n  \t\tg = pg.Generator();\n  \t}\n  \n  \tInitialize(p, q, g);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "\"ModulusSize\"",
            "(int)pbits"
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid Initialize(RandomNumberGenerator &rng, unsigned int pbits)\n\t\t{GenerateRandom(rng, MakeParameters(\"ModulusSize\", (int)pbits));}"
  }
]