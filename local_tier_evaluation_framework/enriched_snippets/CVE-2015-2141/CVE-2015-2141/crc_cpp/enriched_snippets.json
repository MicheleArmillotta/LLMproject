[
  {
    "function_name": "TruncatedFinal",
    "container": "CRC32",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/crc.cpp",
    "lines": "149-158",
    "snippet": "void CRC32::TruncatedFinal(byte *hash, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tm_crc ^= CRC32_NEGL;\n\tfor (size_t i=0; i<size; i++)\n\t\thash[i] = GetCrcByte(i);\n\n\tReset();\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"crc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Reset",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "Reset",
          "container": "CRC32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/crc.h",
          "lines": "34-34",
          "snippet": "void Reset() {m_crc = CRC32_NEGL;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nCRC32 {\n  void Reset() {m_crc = CRC32_NEGL;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetCrcByte",
          "args": [
            "i"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "GetCrcByte",
          "container": "CRC32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/crc.h",
          "lines": "31-31",
          "snippet": "byte GetCrcByte(size_t i) const {return ((byte *)&(m_crc))[i];}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nCRC32 {\n  byte GetCrcByte(size_t i) const {return ((byte *)&(m_crc))[i];}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ThrowIfInvalidTruncatedSize",
          "args": [
            "size"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "ThrowIfInvalidTruncatedSize",
          "container": "HashTransformation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "309-313",
          "snippet": "void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nHashTransformation {\n  void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n  {\n  \tif (size > DigestSize())\n  \t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"crc.h\"\n#include \"pch.h\"\n\nCRC32 {\n  void CRC32::TruncatedFinal(byte *hash, size_t size)\n  {\n  \tThrowIfInvalidTruncatedSize(size);\n  \n  \tm_crc ^= CRC32_NEGL;\n  \tfor (size_t i=0; i<size; i++)\n  \t\thash[i] = GetCrcByte(i);\n  \n  \tReset();\n  }\n}"
  },
  {
    "function_name": "Update",
    "container": "CRC32",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/crc.cpp",
    "lines": "125-147",
    "snippet": "void CRC32::Update(const byte *s, size_t n)\n{\n\tword32 crc = m_crc;\n\n\tfor(; !IsAligned<word32>(s) && n > 0; n--)\n\t\tcrc = m_tab[CRC32_INDEX(crc) ^ *s++] ^ CRC32_SHIFTED(crc);\n\n\twhile (n >= 4)\n\t{\n\t\tcrc ^= *(const word32 *)s;\n\t\tcrc = m_tab[CRC32_INDEX(crc)] ^ CRC32_SHIFTED(crc);\n\t\tcrc = m_tab[CRC32_INDEX(crc)] ^ CRC32_SHIFTED(crc);\n\t\tcrc = m_tab[CRC32_INDEX(crc)] ^ CRC32_SHIFTED(crc);\n\t\tcrc = m_tab[CRC32_INDEX(crc)] ^ CRC32_SHIFTED(crc);\n\t\tn -= 4;\n\t\ts += 4;\n\t}\n\n\twhile (n--)\n\t\tcrc = m_tab[CRC32_INDEX(crc) ^ *s++] ^ CRC32_SHIFTED(crc);\n\n\tm_crc = crc;\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"crc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRC32_SHIFTED",
          "args": [
            "crc"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_INDEX",
          "args": [
            "crc"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_SHIFTED",
          "args": [
            "crc"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_INDEX",
          "args": [
            "crc"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_SHIFTED",
          "args": [
            "crc"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_INDEX",
          "args": [
            "crc"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_SHIFTED",
          "args": [
            "crc"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_INDEX",
          "args": [
            "crc"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_SHIFTED",
          "args": [
            "crc"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_INDEX",
          "args": [
            "crc"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_SHIFTED",
          "args": [
            "crc"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRC32_INDEX",
          "args": [
            "crc"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsAligned<word32>",
          "args": [
            "s"
          ],
          "line": 129
        },
        "resolved": true,
        "details": {
          "function_name": "IsAligned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "387-390",
          "snippet": "inline bool IsAligned(const void *p, T *dummy=NULL)\t// VC60 workaround\n{\n\treturn IsAlignedOn(p, GetAlignmentOf<T>());\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline bool IsAligned(const void *p, T *dummy=NULL)\t// VC60 workaround\n{\n\treturn IsAlignedOn(p, GetAlignmentOf<T>());\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"crc.h\"\n#include \"pch.h\"\n\nCRC32 {\n  void CRC32::Update(const byte *s, size_t n)\n  {\n  \tword32 crc = m_crc;\n  \n  \tfor(; !IsAligned<word32>(s) && n > 0; n--)\n  \t\tcrc = m_tab[CRC32_INDEX(crc) ^ *s++] ^ CRC32_SHIFTED(crc);\n  \n  \twhile (n >= 4)\n  \t{\n  \t\tcrc ^= *(const word32 *)s;\n  \t\tcrc = m_tab[CRC32_INDEX(crc)] ^ CRC32_SHIFTED(crc);\n  \t\tcrc = m_tab[CRC32_INDEX(crc)] ^ CRC32_SHIFTED(crc);\n  \t\tcrc = m_tab[CRC32_INDEX(crc)] ^ CRC32_SHIFTED(crc);\n  \t\tcrc = m_tab[CRC32_INDEX(crc)] ^ CRC32_SHIFTED(crc);\n  \t\tn -= 4;\n  \t\ts += 4;\n  \t}\n  \n  \twhile (n--)\n  \t\tcrc = m_tab[CRC32_INDEX(crc) ^ *s++] ^ CRC32_SHIFTED(crc);\n  \n  \tm_crc = crc;\n  }\n}"
  },
  {
    "function_name": "CRC32",
    "container": "CRC32",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/crc.cpp",
    "lines": "120-123",
    "snippet": "CRC32::CRC32()\n{\n\tReset();\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"crc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Reset",
          "args": [],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "Reset",
          "container": "CRC32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/crc.h",
          "lines": "34-34",
          "snippet": "void Reset() {m_crc = CRC32_NEGL;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nCRC32 {\n  void Reset() {m_crc = CRC32_NEGL;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"crc.h\"\n#include \"pch.h\"\n\nCRC32 {\n  CRC32::CRC32()\n  {\n  \tReset();\n  }\n}"
  }
]