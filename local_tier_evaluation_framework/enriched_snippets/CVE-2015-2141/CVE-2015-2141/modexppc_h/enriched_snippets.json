[
  {
    "function_name": "SetModulus",
    "container": "ModExpPrecomputation",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modexppc.h",
    "lines": "25-25",
    "snippet": "void SetModulus(const Integer &v) {m_mr.reset(new MontgomeryRepresentation(v));}",
    "includes": [
      "#include \"pubkey.h\"",
      "#include \"smartptr.h\"",
      "#include \"eprecomp.h\"",
      "#include \"modarith.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_mr.reset",
          "args": [
            "new MontgomeryRepresentation(v)"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "reset",
          "container": "member_ptr<T>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "50-50",
          "snippet": "void member_ptr<T>::reset(T *p) {delete m_p; m_p = p;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nmember_ptr<T> {\n  void member_ptr<T>::reset(T *p) {delete m_p; m_p = p;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"modarith.h\"\n\nModExpPrecomputation {\n  void SetModulus(const Integer &v) {m_mr.reset(new MontgomeryRepresentation(v));}\n}"
  },
  {
    "function_name": "DEREncodeElement",
    "container": "ModExpPrecomputation",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modexppc.h",
    "lines": "22-22",
    "snippet": "void DEREncodeElement(BufferedTransformation &bt, const Element &v) const {v.DEREncode(bt);}",
    "includes": [
      "#include \"pubkey.h\"",
      "#include \"smartptr.h\"",
      "#include \"eprecomp.h\"",
      "#include \"modarith.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "v.DEREncode",
          "args": [
            "bt"
          ],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncode",
          "container": "DL_PrivateKey_GFP_OldFormat",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "330-340",
          "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t{\n\t\tDERSequenceEncoder seq(bt);\n\t\t\tthis->GetGroupParameters().GetModulus().DEREncode(seq);\n\t\t\tif (this->GetGroupParameters().GetCofactor() != 2)\n\t\t\t\tthis->GetGroupParameters().GetSubgroupOrder().DEREncode(seq);\n\t\t\tthis->GetGroupParameters().GetGenerator().DEREncode(seq);\n\t\t\tthis->GetGroupParameters().ExponentiateBase(this->GetPrivateExponent()).DEREncode(seq);\n\t\t\tthis->GetPrivateExponent().DEREncode(seq);\n\t\tseq.MessageEnd();\n\t}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP_OldFormat {\n  void DEREncode(BufferedTransformation &bt) const\n  \t{\n  \t\tDERSequenceEncoder seq(bt);\n  \t\t\tthis->GetGroupParameters().GetModulus().DEREncode(seq);\n  \t\t\tif (this->GetGroupParameters().GetCofactor() != 2)\n  \t\t\t\tthis->GetGroupParameters().GetSubgroupOrder().DEREncode(seq);\n  \t\t\tthis->GetGroupParameters().GetGenerator().DEREncode(seq);\n  \t\t\tthis->GetGroupParameters().ExponentiateBase(this->GetPrivateExponent()).DEREncode(seq);\n  \t\t\tthis->GetPrivateExponent().DEREncode(seq);\n  \t\tseq.MessageEnd();\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"modarith.h\"\n\nModExpPrecomputation {\n  void DEREncodeElement(BufferedTransformation &bt, const Element &v) const {v.DEREncode(bt);}\n}"
  },
  {
    "function_name": "BERDecodeElement",
    "container": "ModExpPrecomputation",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modexppc.h",
    "lines": "21-21",
    "snippet": "Element BERDecodeElement(BufferedTransformation &bt) const {return Integer(bt);}",
    "includes": [
      "#include \"pubkey.h\"",
      "#include \"smartptr.h\"",
      "#include \"eprecomp.h\"",
      "#include \"modarith.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Integer",
          "args": [
            "bt"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "InverseMod",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3983-4006",
          "snippet": "word Integer::InverseMod(word mod) const\n{\n\tword g0 = mod, g1 = *this % mod;\n\tword v0 = 0, v1 = 1;\n\tword y;\n\n\twhile (g1)\n\t{\n\t\tif (g1 == 1)\n\t\t\treturn v1;\n\t\ty = g0 / g1;\n\t\tg0 = g0 % g1;\n\t\tv0 += y * v1;\n\n\t\tif (!g0)\n\t\t\tbreak;\n\t\tif (g0 == 1)\n\t\t\treturn mod-v0;\n\t\ty = g1 / g0;\n\t\tg1 = g1 % g0;\n\t\tv1 += y * v0;\n\t}\n\treturn 0;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  word Integer::InverseMod(word mod) const\n  {\n  \tword g0 = mod, g1 = *this % mod;\n  \tword v0 = 0, v1 = 1;\n  \tword y;\n  \n  \twhile (g1)\n  \t{\n  \t\tif (g1 == 1)\n  \t\t\treturn v1;\n  \t\ty = g0 / g1;\n  \t\tg0 = g0 % g1;\n  \t\tv0 += y * v1;\n  \n  \t\tif (!g0)\n  \t\t\tbreak;\n  \t\tif (g0 == 1)\n  \t\t\treturn mod-v0;\n  \t\ty = g1 / g0;\n  \t\tg1 = g1 % g0;\n  \t\tv1 += y * v0;\n  \t}\n  \treturn 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"modarith.h\"\n\nModExpPrecomputation {\n  Element BERDecodeElement(BufferedTransformation &bt) const {return Integer(bt);}\n}"
  },
  {
    "function_name": "ConvertOut",
    "container": "ModExpPrecomputation",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modexppc.h",
    "lines": "19-19",
    "snippet": "virtual Element ConvertOut(const Element &v) const {return m_mr->ConvertOut(v);}",
    "includes": [
      "#include \"pubkey.h\"",
      "#include \"smartptr.h\"",
      "#include \"eprecomp.h\"",
      "#include \"modarith.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_mr->ConvertOut",
          "args": [
            "v"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertOut",
          "container": "ModExpPrecomputation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modexppc.h",
          "lines": "19-19",
          "snippet": "virtual Element ConvertOut(const Element &v) const {return m_mr->ConvertOut(v);}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"modarith.h\"\n\nModExpPrecomputation {\n  virtual Element ConvertOut(const Element &v) const {return m_mr->ConvertOut(v);}\n}"
  },
  {
    "function_name": "ConvertIn",
    "container": "ModExpPrecomputation",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modexppc.h",
    "lines": "18-18",
    "snippet": "Element ConvertIn(const Element &v) const {return m_mr->ConvertIn(v);}",
    "includes": [
      "#include \"pubkey.h\"",
      "#include \"smartptr.h\"",
      "#include \"eprecomp.h\"",
      "#include \"modarith.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_mr->ConvertIn",
          "args": [
            "v"
          ],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertIn",
          "container": "ModExpPrecomputation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modexppc.h",
          "lines": "18-18",
          "snippet": "Element ConvertIn(const Element &v) const {return m_mr->ConvertIn(v);}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"modarith.h\"\n\nModExpPrecomputation {\n  Element ConvertIn(const Element &v) const {return m_mr->ConvertIn(v);}\n}"
  },
  {
    "function_name": "NeedConversions",
    "container": "ModExpPrecomputation",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modexppc.h",
    "lines": "17-17",
    "snippet": "bool NeedConversions() const {return true;}",
    "includes": [
      "#include \"pubkey.h\"",
      "#include \"smartptr.h\"",
      "#include \"eprecomp.h\"",
      "#include \"modarith.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"modarith.h\"\n\nModExpPrecomputation {\n  bool NeedConversions() const {return true;}\n}"
  }
]