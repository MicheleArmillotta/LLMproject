[
  {
    "function_name": "ProcessAndXorBlock",
    "container": "MARS::Dec",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/mars.cpp",
    "lines": "105-152",
    "snippet": "void MARS::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tunsigned int i;\n\tword32 a, b, c, d, l, m, r, t;\n\tconst word32 *k = m_k;\n\n\tBlock::Get(inBlock)(d)(c)(b)(a);\n\t\n\td += k[36];\tc += k[37];\tb += k[38];\ta += k[39];\n\n\tfor (i=0; i<8; i++)\n\t{\n\t\tb = (b ^ S0(a)) + S1(a>>8);\n\t\tc += S0(a>>16);\n\t\ta = rotrFixed(a, 24);\n\t\td ^= S1(a);\n\t\ta += (i%4==0) ? d : 0;\n\t\ta += (i%4==1) ? b : 0;\n\t\tt = a;\ta = b;\tb = c;\tc = d;\td = t;\n\t}\n\n\tfor (i=0; i<16; i++)\n\t{\n\t\tt = rotrFixed(a, 13);\n\t\tr = rotlFixed(a * k[35-2*i], 10);\n\t\tm = t + k[34-2*i];\n\t\tl = rotlMod((S(m) ^ rotrFixed(r, 5) ^ r), r);\n\t\tc -= rotlMod(m, rotrFixed(r, 5));\n\t\t(i<8 ? b : d) -= l;\n\t\t(i<8 ? d : b) ^= r;\n\t\ta = b;\tb = c;\tc = d;\td = t;\n\t}\n\n\tfor (i=0; i<8; i++)\n\t{\n\t\ta -= (i%4==2) ? d : 0;\n\t\ta -= (i%4==3) ? b : 0;\n\t\tb ^= S1(a);\n\t\tc -= S0(a>>24);\n\t\tt = rotlFixed(a, 24);\n\t\td = (d - S1(a>>16)) ^ S0(t);\n\t\ta = b;\tb = c;\tc = d;\td = t;\n\t}\n\n\td -= k[0];\tc -= k[1];\tb -= k[2];\ta -= k[3];\n\n\tBlock::Put(xorBlock, outBlock)(d)(c)(b)(a);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"mars.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "a"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "S0",
          "args": [
            "t"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S1",
          "args": [
            "a>>16"
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "a",
            "24"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S0",
          "args": [
            "a>>24"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S1",
          "args": [
            "a"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rotlMod",
          "args": [
            "m",
            "rotrFixed(r, 5)"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "rotlMod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "604-608",
          "snippet": "inline T rotlMod(T x, unsigned int y)\n{\n\ty %= sizeof(T)*8;\n\treturn T((x<<y) | (x>>(sizeof(T)*8-y)));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlMod(T x, unsigned int y)\n{\n\ty %= sizeof(T)*8;\n\treturn T((x<<y) | (x>>(sizeof(T)*8-y)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotrFixed",
          "args": [
            "r",
            "5"
          ],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "rotrFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "586-590",
          "snippet": "inline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S",
          "args": [
            "m"
          ],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "MinEncodedSize",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3100-3110",
          "snippet": "size_t Integer::MinEncodedSize(Signedness signedness) const\n{\n\tunsigned int outputLen = STDMAX(1U, ByteCount());\n\tif (signedness == UNSIGNED)\n\t\treturn outputLen;\n\tif (NotNegative() && (GetByte(outputLen-1) & 0x80))\n\t\toutputLen++;\n\tif (IsNegative() && *this < -Power2(outputLen*8-1))\n\t\toutputLen++;\n\treturn outputLen;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  size_t Integer::MinEncodedSize(Signedness signedness) const\n  {\n  \tunsigned int outputLen = STDMAX(1U, ByteCount());\n  \tif (signedness == UNSIGNED)\n  \t\treturn outputLen;\n  \tif (NotNegative() && (GetByte(outputLen-1) & 0x80))\n  \t\toutputLen++;\n  \tif (IsNegative() && *this < -Power2(outputLen*8-1))\n  \t\toutputLen++;\n  \treturn outputLen;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "S1",
          "args": [
            "a"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S0",
          "args": [
            "a>>16"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S1",
          "args": [
            "a>>8"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S0",
          "args": [
            "a"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "a"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"mars.h\"\n#include \"pch.h\"\n\nMARS {\n  Dec {\n    void MARS::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tunsigned int i;\n    \tword32 a, b, c, d, l, m, r, t;\n    \tconst word32 *k = m_k;\n    \n    \tBlock::Get(inBlock)(d)(c)(b)(a);\n    \t\n    \td += k[36];\tc += k[37];\tb += k[38];\ta += k[39];\n    \n    \tfor (i=0; i<8; i++)\n    \t{\n    \t\tb = (b ^ S0(a)) + S1(a>>8);\n    \t\tc += S0(a>>16);\n    \t\ta = rotrFixed(a, 24);\n    \t\td ^= S1(a);\n    \t\ta += (i%4==0) ? d : 0;\n    \t\ta += (i%4==1) ? b : 0;\n    \t\tt = a;\ta = b;\tb = c;\tc = d;\td = t;\n    \t}\n    \n    \tfor (i=0; i<16; i++)\n    \t{\n    \t\tt = rotrFixed(a, 13);\n    \t\tr = rotlFixed(a * k[35-2*i], 10);\n    \t\tm = t + k[34-2*i];\n    \t\tl = rotlMod((S(m) ^ rotrFixed(r, 5) ^ r), r);\n    \t\tc -= rotlMod(m, rotrFixed(r, 5));\n    \t\t(i<8 ? b : d) -= l;\n    \t\t(i<8 ? d : b) ^= r;\n    \t\ta = b;\tb = c;\tc = d;\td = t;\n    \t}\n    \n    \tfor (i=0; i<8; i++)\n    \t{\n    \t\ta -= (i%4==2) ? d : 0;\n    \t\ta -= (i%4==3) ? b : 0;\n    \t\tb ^= S1(a);\n    \t\tc -= S0(a>>24);\n    \t\tt = rotlFixed(a, 24);\n    \t\td = (d - S1(a>>16)) ^ S0(t);\n    \t\ta = b;\tb = c;\tc = d;\td = t;\n    \t}\n    \n    \td -= k[0];\tc -= k[1];\tb -= k[2];\ta -= k[3];\n    \n    \tBlock::Put(xorBlock, outBlock)(d)(c)(b)(a);\n    }\n  }\n}"
  },
  {
    "function_name": "ProcessAndXorBlock",
    "container": "MARS::Enc",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/mars.cpp",
    "lines": "56-103",
    "snippet": "void MARS::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tunsigned int i;\n\tword32 a, b, c, d, l, m, r, t;\n\tconst word32 *k = m_k;\n\t\n\tBlock::Get(inBlock)(a)(b)(c)(d);\n\n\ta += k[0];\tb += k[1];\tc += k[2];\td += k[3];\n\n\tfor (i=0; i<8; i++)\n\t{\n\t\tb = (b ^ S0(a)) + S1(a>>8);\n\t\tc += S0(a>>16);\n\t\ta = rotrFixed(a, 24);\n\t\td ^= S1(a);\n\t\ta += (i%4==0) ? d : 0;\n\t\ta += (i%4==1) ? b : 0;\n\t\tt = a;\ta = b;\tb = c;\tc = d;\td = t;\n\t}\n\n\tfor (i=0; i<16; i++)\n\t{\n\t\tt = rotlFixed(a, 13);\n\t\tr = rotlFixed(t * k[2*i+5], 10);\n\t\tm = a + k[2*i+4];\n\t\tl = rotlMod((S(m) ^ rotrFixed(r, 5) ^ r), r);\n\t\tc += rotlMod(m, rotrFixed(r, 5));\n\t\t(i<8 ? b : d) += l;\n\t\t(i<8 ? d : b) ^= r;\n\t\ta = b;\tb = c;\tc = d;\td = t;\n\t}\n\n\tfor (i=0; i<8; i++)\n\t{\n\t\ta -= (i%4==2) ? d : 0;\n\t\ta -= (i%4==3) ? b : 0;\n\t\tb ^= S1(a);\n\t\tc -= S0(a>>24);\n\t\tt = rotlFixed(a, 24);\n\t\td = (d - S1(a>>16)) ^ S0(t);\n\t\ta = b;\tb = c;\tc = d;\td = t;\n\t}\n\n\ta -= k[36];\tb -= k[37];\tc -= k[38];\td -= k[39];\n\n\tBlock::Put(xorBlock, outBlock)(a)(b)(c)(d);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"mars.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "d"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "S0",
          "args": [
            "t"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S1",
          "args": [
            "a>>16"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "a",
            "24"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S0",
          "args": [
            "a>>24"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S1",
          "args": [
            "a"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rotlMod",
          "args": [
            "m",
            "rotrFixed(r, 5)"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "rotlMod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "604-608",
          "snippet": "inline T rotlMod(T x, unsigned int y)\n{\n\ty %= sizeof(T)*8;\n\treturn T((x<<y) | (x>>(sizeof(T)*8-y)));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlMod(T x, unsigned int y)\n{\n\ty %= sizeof(T)*8;\n\treturn T((x<<y) | (x>>(sizeof(T)*8-y)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotrFixed",
          "args": [
            "r",
            "5"
          ],
          "line": 83
        },
        "resolved": true,
        "details": {
          "function_name": "rotrFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "586-590",
          "snippet": "inline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "S",
          "args": [
            "m"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "MinEncodedSize",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3100-3110",
          "snippet": "size_t Integer::MinEncodedSize(Signedness signedness) const\n{\n\tunsigned int outputLen = STDMAX(1U, ByteCount());\n\tif (signedness == UNSIGNED)\n\t\treturn outputLen;\n\tif (NotNegative() && (GetByte(outputLen-1) & 0x80))\n\t\toutputLen++;\n\tif (IsNegative() && *this < -Power2(outputLen*8-1))\n\t\toutputLen++;\n\treturn outputLen;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  size_t Integer::MinEncodedSize(Signedness signedness) const\n  {\n  \tunsigned int outputLen = STDMAX(1U, ByteCount());\n  \tif (signedness == UNSIGNED)\n  \t\treturn outputLen;\n  \tif (NotNegative() && (GetByte(outputLen-1) & 0x80))\n  \t\toutputLen++;\n  \tif (IsNegative() && *this < -Power2(outputLen*8-1))\n  \t\toutputLen++;\n  \treturn outputLen;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "S1",
          "args": [
            "a"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S0",
          "args": [
            "a>>16"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S1",
          "args": [
            "a>>8"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "S0",
          "args": [
            "a"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "d"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"mars.h\"\n#include \"pch.h\"\n\nMARS {\n  Enc {\n    void MARS::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tunsigned int i;\n    \tword32 a, b, c, d, l, m, r, t;\n    \tconst word32 *k = m_k;\n    \t\n    \tBlock::Get(inBlock)(a)(b)(c)(d);\n    \n    \ta += k[0];\tb += k[1];\tc += k[2];\td += k[3];\n    \n    \tfor (i=0; i<8; i++)\n    \t{\n    \t\tb = (b ^ S0(a)) + S1(a>>8);\n    \t\tc += S0(a>>16);\n    \t\ta = rotrFixed(a, 24);\n    \t\td ^= S1(a);\n    \t\ta += (i%4==0) ? d : 0;\n    \t\ta += (i%4==1) ? b : 0;\n    \t\tt = a;\ta = b;\tb = c;\tc = d;\td = t;\n    \t}\n    \n    \tfor (i=0; i<16; i++)\n    \t{\n    \t\tt = rotlFixed(a, 13);\n    \t\tr = rotlFixed(t * k[2*i+5], 10);\n    \t\tm = a + k[2*i+4];\n    \t\tl = rotlMod((S(m) ^ rotrFixed(r, 5) ^ r), r);\n    \t\tc += rotlMod(m, rotrFixed(r, 5));\n    \t\t(i<8 ? b : d) += l;\n    \t\t(i<8 ? d : b) ^= r;\n    \t\ta = b;\tb = c;\tc = d;\td = t;\n    \t}\n    \n    \tfor (i=0; i<8; i++)\n    \t{\n    \t\ta -= (i%4==2) ? d : 0;\n    \t\ta -= (i%4==3) ? b : 0;\n    \t\tb ^= S1(a);\n    \t\tc -= S0(a>>24);\n    \t\tt = rotlFixed(a, 24);\n    \t\td = (d - S1(a>>16)) ^ S0(t);\n    \t\ta = b;\tb = c;\tc = d;\td = t;\n    \t}\n    \n    \ta -= k[36];\tb -= k[37];\tc -= k[38];\td -= k[39];\n    \n    \tBlock::Put(xorBlock, outBlock)(a)(b)(c)(d);\n    }\n  }\n}"
  },
  {
    "function_name": "UncheckedSetKey",
    "container": "MARS::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/mars.cpp",
    "lines": "11-48",
    "snippet": "void MARS::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\t// Initialize T[] with the key data\n\tFixedSizeSecBlock<word32, 15> T;\n\tGetUserKey(LITTLE_ENDIAN_ORDER, T.begin(), 15, userKey, length);\n\tT[length/4] = length/4;\n\n\tfor (unsigned int j=0; j<4; j++)\t// compute 10 words of K[] in each iteration\n\t{\n\t\tunsigned int i;\n\t\t// Do linear transformation\n\t\tfor (i=0; i<15; i++)\n\t\t\tT[i] = T[i] ^ rotlFixed(T[(i+8)%15] ^ T[(i+13)%15], 3) ^ (4*i+j);\n\n\t\t// Do four rounds of stirring\n\t\tfor (unsigned int k=0; k<4; k++)\n\t\t\tfor (i=0; i<15; i++)\n\t\t\t   T[i] = rotlFixed(T[i] + Sbox[T[(i+14)%15]%512], 9);\n\n\t\t// Store next 10 key words into K[]\n\t\tfor (i=0; i<10; i++)\n\t\t\tm_k[10*j+i] = T[4*i%15];\n\t}\n\n\t// Modify multiplication key-words\n\tfor(unsigned int i = 5; i < 37; i += 2)\n\t{\n\t\tword32 m, w = m_k[i] | 3;\n\t\tm = (~w ^ (w<<1)) & (~w ^ (w>>1)) & 0x7ffffffe;\n\t\tm &= m>>1; m &= m>>2; m &= m>>4;\n\t\tm |= m<<1; m |= m<<2; m |= m<<4;\n\t\tm &= 0x7ffffffc;\n\t\tw ^= rotlMod(Sbox[265 + (m_k[i] & 3)], m_k[i-1]) & m;\n\t\tm_k[i] = w;\n\t}\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"mars.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rotlMod",
          "args": [
            "Sbox[265 + (m_k[i] & 3)]",
            "m_k[i-1]"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "rotlMod",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "604-608",
          "snippet": "inline T rotlMod(T x, unsigned int y)\n{\n\ty %= sizeof(T)*8;\n\treturn T((x<<y) | (x>>(sizeof(T)*8-y)));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlMod(T x, unsigned int y)\n{\n\ty %= sizeof(T)*8;\n\treturn T((x<<y) | (x>>(sizeof(T)*8-y)));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "T[i] + Sbox[T[(i+14)%15]%512]",
            "9"
          ],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserKey",
          "args": [
            "LITTLE_ENDIAN_ORDER",
            "T.begin()",
            "15",
            "userKey",
            "length"
          ],
          "line": 17
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "946-953",
          "snippet": "inline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [
            "#define memcpy_s CryptoPP::memcpy_s"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\n#define memcpy_s CryptoPP::memcpy_s\n\ninline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}"
        }
      },
      {
        "call_info": {
          "callee": "T.begin",
          "args": [],
          "line": 17
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "length"
          ],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"mars.h\"\n#include \"pch.h\"\n\nMARS {\n  Base {\n    void MARS::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n    {\n    \tAssertValidKeyLength(length);\n    \n    \t// Initialize T[] with the key data\n    \tFixedSizeSecBlock<word32, 15> T;\n    \tGetUserKey(LITTLE_ENDIAN_ORDER, T.begin(), 15, userKey, length);\n    \tT[length/4] = length/4;\n    \n    \tfor (unsigned int j=0; j<4; j++)\t// compute 10 words of K[] in each iteration\n    \t{\n    \t\tunsigned int i;\n    \t\t// Do linear transformation\n    \t\tfor (i=0; i<15; i++)\n    \t\t\tT[i] = T[i] ^ rotlFixed(T[(i+8)%15] ^ T[(i+13)%15], 3) ^ (4*i+j);\n    \n    \t\t// Do four rounds of stirring\n    \t\tfor (unsigned int k=0; k<4; k++)\n    \t\t\tfor (i=0; i<15; i++)\n    \t\t\t   T[i] = rotlFixed(T[i] + Sbox[T[(i+14)%15]%512], 9);\n    \n    \t\t// Store next 10 key words into K[]\n    \t\tfor (i=0; i<10; i++)\n    \t\t\tm_k[10*j+i] = T[4*i%15];\n    \t}\n    \n    \t// Modify multiplication key-words\n    \tfor(unsigned int i = 5; i < 37; i += 2)\n    \t{\n    \t\tword32 m, w = m_k[i] | 3;\n    \t\tm = (~w ^ (w<<1)) & (~w ^ (w>>1)) & 0x7ffffffe;\n    \t\tm &= m>>1; m &= m>>2; m &= m>>4;\n    \t\tm |= m<<1; m |= m<<2; m |= m<<4;\n    \t\tm &= 0x7ffffffc;\n    \t\tw ^= rotlMod(Sbox[265 + (m_k[i] & 3)], m_k[i-1]) & m;\n    \t\tm_k[i] = w;\n    \t}\n    }\n  }\n}"
  }
]