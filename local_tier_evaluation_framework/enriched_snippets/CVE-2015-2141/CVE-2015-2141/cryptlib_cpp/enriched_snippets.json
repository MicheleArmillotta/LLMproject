[
  {
    "function_name": "AuthenticatedKeyAgreementDomain::GenerateEphemeralKeyPair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "820-824",
    "snippet": "void AuthenticatedKeyAgreementDomain::GenerateEphemeralKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n{\n\tGenerateEphemeralPrivateKey(rng, privateKey);\n\tGenerateEphemeralPublicKey(rng, privateKey, publicKey);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateEphemeralPublicKey",
          "args": [
            "rng",
            "privateKey",
            "publicKey"
          ],
          "line": 823
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateEphemeralPublicKey",
          "container": "MQV_Domain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/mqv.h",
          "lines": "75-78",
          "snippet": "void GenerateEphemeralPublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n\t{\n\t\tmemcpy(publicKey, privateKey+StaticPrivateKeyLength(), EphemeralPublicKeyLength());\n\t}",
          "includes": [
            "#include \"gfpcrypt.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gfpcrypt.h\"\n\nMQV_Domain {\n  void GenerateEphemeralPublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n  \t{\n  \t\tmemcpy(publicKey, privateKey+StaticPrivateKeyLength(), EphemeralPublicKeyLength());\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GenerateEphemeralPrivateKey",
          "args": [
            "rng",
            "privateKey"
          ],
          "line": 822
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateEphemeralPrivateKey",
          "container": "MQV_Domain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/mqv.h",
          "lines": "66-73",
          "snippet": "void GenerateEphemeralPrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n\t{\n\t\tconst DL_GroupParameters<Element> &params = GetAbstractGroupParameters();\n\t\tInteger x(rng, Integer::One(), params.GetMaxExponent());\n\t\tx.Encode(privateKey, StaticPrivateKeyLength());\n\t\tElement y = params.ExponentiateBase(x);\n\t\tparams.EncodeElement(true, y, privateKey+StaticPrivateKeyLength());\n\t}",
          "includes": [
            "#include \"gfpcrypt.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gfpcrypt.h\"\n\nMQV_Domain {\n  void GenerateEphemeralPrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n  \t{\n  \t\tconst DL_GroupParameters<Element> &params = GetAbstractGroupParameters();\n  \t\tInteger x(rng, Integer::One(), params.GetMaxExponent());\n  \t\tx.Encode(privateKey, StaticPrivateKeyLength());\n  \t\tElement y = params.ExponentiateBase(x);\n  \t\tparams.EncodeElement(true, y, privateKey+StaticPrivateKeyLength());\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedKeyAgreementDomain::GenerateEphemeralKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n{\n\tGenerateEphemeralPrivateKey(rng, privateKey);\n\tGenerateEphemeralPublicKey(rng, privateKey, publicKey);\n}"
  },
  {
    "function_name": "AuthenticatedKeyAgreementDomain::GenerateStaticKeyPair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "814-818",
    "snippet": "void AuthenticatedKeyAgreementDomain::GenerateStaticKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n{\n\tGenerateStaticPrivateKey(rng, privateKey);\n\tGenerateStaticPublicKey(rng, privateKey, publicKey);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateStaticPublicKey",
          "args": [
            "rng",
            "privateKey",
            "publicKey"
          ],
          "line": 817
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateStaticPublicKey",
          "container": "DH2",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
          "lines": "31-32",
          "snippet": "void GenerateStaticPublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n\t\t{d1.GeneratePublicKey(rng, privateKey, publicKey);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  void GenerateStaticPublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n  \t\t{d1.GeneratePublicKey(rng, privateKey, publicKey);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GenerateStaticPrivateKey",
          "args": [
            "rng",
            "privateKey"
          ],
          "line": 816
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateStaticPrivateKey",
          "container": "MQV_Domain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/mqv.h",
          "lines": "49-53",
          "snippet": "void GenerateStaticPrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n\t{\n\t\tInteger x(rng, Integer::One(), GetAbstractGroupParameters().GetMaxExponent());\n\t\tx.Encode(privateKey, StaticPrivateKeyLength());\n\t}",
          "includes": [
            "#include \"gfpcrypt.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gfpcrypt.h\"\n\nMQV_Domain {\n  void GenerateStaticPrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n  \t{\n  \t\tInteger x(rng, Integer::One(), GetAbstractGroupParameters().GetMaxExponent());\n  \t\tx.Encode(privateKey, StaticPrivateKeyLength());\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedKeyAgreementDomain::GenerateStaticKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n{\n\tGenerateStaticPrivateKey(rng, privateKey);\n\tGenerateStaticPublicKey(rng, privateKey, publicKey);\n}"
  },
  {
    "function_name": "SimpleKeyAgreementDomain::GenerateKeyPair",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "808-812",
    "snippet": "void SimpleKeyAgreementDomain::GenerateKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n{\n\tGeneratePrivateKey(rng, privateKey);\n\tGeneratePublicKey(rng, privateKey, publicKey);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GeneratePublicKey",
          "args": [
            "rng",
            "privateKey",
            "publicKey"
          ],
          "line": 811
        },
        "resolved": true,
        "details": {
          "function_name": "GeneratePublicKey",
          "container": "DH_Domain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh.h",
          "lines": "58-77",
          "snippet": "void GeneratePublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n\t{\n\t\tBase::GeneratePublicKey(rng, privateKey, publicKey);\n\n\t\tif (FIPS_140_2_ComplianceEnabled())\n\t\t{\n\t\t\tSecByteBlock privateKey2(this->PrivateKeyLength());\n\t\t\tthis->GeneratePrivateKey(rng, privateKey2);\n\n\t\t\tSecByteBlock publicKey2(this->PublicKeyLength());\n\t\t\tBase::GeneratePublicKey(rng, privateKey2, publicKey2);\n\n\t\t\tSecByteBlock agreedValue(this->AgreedValueLength()), agreedValue2(this->AgreedValueLength());\n\t\t\tbool agreed1 = this->Agree(agreedValue, privateKey, publicKey2);\n\t\t\tbool agreed2 = this->Agree(agreedValue2, privateKey2, publicKey);\n\n\t\t\tif (!agreed1 || !agreed2 || agreedValue != agreedValue2)\n\t\t\t\tthrow SelfTestFailure(this->AlgorithmName() + \": pairwise consistency test failed\");\n\t\t}\n\t}",
          "includes": [
            "#include \"gfpcrypt.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gfpcrypt.h\"\n\nDH_Domain {\n  void GeneratePublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n  \t{\n  \t\tBase::GeneratePublicKey(rng, privateKey, publicKey);\n  \n  \t\tif (FIPS_140_2_ComplianceEnabled())\n  \t\t{\n  \t\t\tSecByteBlock privateKey2(this->PrivateKeyLength());\n  \t\t\tthis->GeneratePrivateKey(rng, privateKey2);\n  \n  \t\t\tSecByteBlock publicKey2(this->PublicKeyLength());\n  \t\t\tBase::GeneratePublicKey(rng, privateKey2, publicKey2);\n  \n  \t\t\tSecByteBlock agreedValue(this->AgreedValueLength()), agreedValue2(this->AgreedValueLength());\n  \t\t\tbool agreed1 = this->Agree(agreedValue, privateKey, publicKey2);\n  \t\t\tbool agreed2 = this->Agree(agreedValue2, privateKey2, publicKey);\n  \n  \t\t\tif (!agreed1 || !agreed2 || agreedValue != agreedValue2)\n  \t\t\t\tthrow SelfTestFailure(this->AlgorithmName() + \": pairwise consistency test failed\");\n  \t\t}\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GeneratePrivateKey",
          "args": [
            "rng",
            "privateKey"
          ],
          "line": 810
        },
        "resolved": true,
        "details": {
          "function_name": "XTR_DH::GeneratePrivateKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.cpp",
          "lines": "77-81",
          "snippet": "void XTR_DH::GeneratePrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n{\n\tInteger x(rng, Integer::Zero(), m_q-1);\n\tx.Encode(privateKey, PrivateKeyLength());\n}",
          "includes": [
            "#include \"argnames.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"xtrcrypt.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"argnames.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"xtrcrypt.h\"\n#include \"pch.h\"\n\nvoid XTR_DH::GeneratePrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n{\n\tInteger x(rng, Integer::Zero(), m_q-1);\n\tx.Encode(privateKey, PrivateKeyLength());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyAgreementDomain::GenerateKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n{\n\tGeneratePrivateKey(rng, privateKey);\n\tGeneratePublicKey(rng, privateKey, publicKey);\n}"
  },
  {
    "function_name": "PK_Verifier::RecoverMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "798-806",
    "snippet": "DecodingResult PK_Verifier::RecoverMessage(byte *recoveredMessage, \n\tconst byte *nonrecoverableMessage, size_t nonrecoverableMessageLength, \n\tconst byte *signature, size_t signatureLength) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(NewVerificationAccumulator());\n\tInputSignature(*m, signature, signatureLength);\n\tm->Update(nonrecoverableMessage, nonrecoverableMessageLength);\n\treturn RecoverAndRestart(recoveredMessage, *m);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RecoverAndRestart",
          "args": [
            "recoveredMessage",
            "*m"
          ],
          "line": 805
        },
        "resolved": true,
        "details": {
          "function_name": "TF_VerifierBase::RecoverAndRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.cpp",
          "lines": "120-133",
          "snippet": "DecodingResult TF_VerifierBase::RecoverAndRestart(byte *recoveredMessage, PK_MessageAccumulator &messageAccumulator) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tDecodingResult result = encoding.RecoverMessageFromRepresentative(\n\t\tma.AccessHash(), id, ma.m_empty, ma.m_representative, MessageRepresentativeBitLength(), recoveredMessage);\n\tma.m_empty = true;\n\treturn result;\n}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"pch.h\"\n\nDecodingResult TF_VerifierBase::RecoverAndRestart(byte *recoveredMessage, PK_MessageAccumulator &messageAccumulator) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tDecodingResult result = encoding.RecoverMessageFromRepresentative(\n\t\tma.AccessHash(), id, ma.m_empty, ma.m_representative, MessageRepresentativeBitLength(), recoveredMessage);\n\tma.m_empty = true;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m->Update",
          "args": [
            "nonrecoverableMessage",
            "nonrecoverableMessageLength"
          ],
          "line": 804
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InputSignature",
          "args": [
            "*m",
            "signature",
            "signatureLength"
          ],
          "line": 803
        },
        "resolved": true,
        "details": {
          "function_name": "TF_VerifierBase::InputSignature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.cpp",
          "lines": "89-103",
          "snippet": "void TF_VerifierBase::InputSignature(PK_MessageAccumulator &messageAccumulator, const byte *signature, size_t signatureLength) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tma.m_representative.New(MessageRepresentativeLength());\n\tInteger x = GetTrapdoorFunctionInterface().ApplyFunction(Integer(signature, signatureLength));\n\tif (x.BitCount() > MessageRepresentativeBitLength())\n\t\tx = Integer::Zero();\t// don't return false here to prevent timing attack\n\tx.Encode(ma.m_representative, ma.m_representative.size());\n}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"pch.h\"\n\nvoid TF_VerifierBase::InputSignature(PK_MessageAccumulator &messageAccumulator, const byte *signature, size_t signatureLength) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tma.m_representative.New(MessageRepresentativeLength());\n\tInteger x = GetTrapdoorFunctionInterface().ApplyFunction(Integer(signature, signatureLength));\n\tif (x.BitCount() > MessageRepresentativeBitLength())\n\t\tx = Integer::Zero();\t// don't return false here to prevent timing attack\n\tx.Encode(ma.m_representative, ma.m_representative.size());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nDecodingResult PK_Verifier::RecoverMessage(byte *recoveredMessage, \n\tconst byte *nonrecoverableMessage, size_t nonrecoverableMessageLength, \n\tconst byte *signature, size_t signatureLength) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(NewVerificationAccumulator());\n\tInputSignature(*m, signature, signatureLength);\n\tm->Update(nonrecoverableMessage, nonrecoverableMessageLength);\n\treturn RecoverAndRestart(recoveredMessage, *m);\n}"
  },
  {
    "function_name": "PK_Verifier::Recover",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "792-796",
    "snippet": "DecodingResult PK_Verifier::Recover(byte *recoveredMessage, PK_MessageAccumulator *messageAccumulator) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn RecoverAndRestart(recoveredMessage, *m);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RecoverAndRestart",
          "args": [
            "recoveredMessage",
            "*m"
          ],
          "line": 795
        },
        "resolved": true,
        "details": {
          "function_name": "TF_VerifierBase::RecoverAndRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.cpp",
          "lines": "120-133",
          "snippet": "DecodingResult TF_VerifierBase::RecoverAndRestart(byte *recoveredMessage, PK_MessageAccumulator &messageAccumulator) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tDecodingResult result = encoding.RecoverMessageFromRepresentative(\n\t\tma.AccessHash(), id, ma.m_empty, ma.m_representative, MessageRepresentativeBitLength(), recoveredMessage);\n\tma.m_empty = true;\n\treturn result;\n}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"pch.h\"\n\nDecodingResult TF_VerifierBase::RecoverAndRestart(byte *recoveredMessage, PK_MessageAccumulator &messageAccumulator) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tDecodingResult result = encoding.RecoverMessageFromRepresentative(\n\t\tma.AccessHash(), id, ma.m_empty, ma.m_representative, MessageRepresentativeBitLength(), recoveredMessage);\n\tma.m_empty = true;\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nDecodingResult PK_Verifier::Recover(byte *recoveredMessage, PK_MessageAccumulator *messageAccumulator) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn RecoverAndRestart(recoveredMessage, *m);\n}"
  },
  {
    "function_name": "PK_Verifier::VerifyMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "784-790",
    "snippet": "bool PK_Verifier::VerifyMessage(const byte *message, size_t messageLen, const byte *signature, size_t signatureLength) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(NewVerificationAccumulator());\n\tInputSignature(*m, signature, signatureLength);\n\tm->Update(message, messageLen);\n\treturn VerifyAndRestart(*m);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VerifyAndRestart",
          "args": [
            "*m"
          ],
          "line": 789
        },
        "resolved": true,
        "details": {
          "function_name": "TF_VerifierBase::VerifyAndRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.cpp",
          "lines": "105-118",
          "snippet": "bool TF_VerifierBase::VerifyAndRestart(PK_MessageAccumulator &messageAccumulator) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tbool result = encoding.VerifyMessageRepresentative(\n\t\tma.AccessHash(), id, ma.m_empty, ma.m_representative, MessageRepresentativeBitLength());\n\tma.m_empty = true;\n\treturn result;\n}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"pch.h\"\n\nbool TF_VerifierBase::VerifyAndRestart(PK_MessageAccumulator &messageAccumulator) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tbool result = encoding.VerifyMessageRepresentative(\n\t\tma.AccessHash(), id, ma.m_empty, ma.m_representative, MessageRepresentativeBitLength());\n\tma.m_empty = true;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m->Update",
          "args": [
            "message",
            "messageLen"
          ],
          "line": 788
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InputSignature",
          "args": [
            "*m",
            "signature",
            "signatureLength"
          ],
          "line": 787
        },
        "resolved": true,
        "details": {
          "function_name": "TF_VerifierBase::InputSignature",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.cpp",
          "lines": "89-103",
          "snippet": "void TF_VerifierBase::InputSignature(PK_MessageAccumulator &messageAccumulator, const byte *signature, size_t signatureLength) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tma.m_representative.New(MessageRepresentativeLength());\n\tInteger x = GetTrapdoorFunctionInterface().ApplyFunction(Integer(signature, signatureLength));\n\tif (x.BitCount() > MessageRepresentativeBitLength())\n\t\tx = Integer::Zero();\t// don't return false here to prevent timing attack\n\tx.Encode(ma.m_representative, ma.m_representative.size());\n}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"pch.h\"\n\nvoid TF_VerifierBase::InputSignature(PK_MessageAccumulator &messageAccumulator, const byte *signature, size_t signatureLength) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tma.m_representative.New(MessageRepresentativeLength());\n\tInteger x = GetTrapdoorFunctionInterface().ApplyFunction(Integer(signature, signatureLength));\n\tif (x.BitCount() > MessageRepresentativeBitLength())\n\t\tx = Integer::Zero();\t// don't return false here to prevent timing attack\n\tx.Encode(ma.m_representative, ma.m_representative.size());\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool PK_Verifier::VerifyMessage(const byte *message, size_t messageLen, const byte *signature, size_t signatureLength) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(NewVerificationAccumulator());\n\tInputSignature(*m, signature, signatureLength);\n\tm->Update(message, messageLen);\n\treturn VerifyAndRestart(*m);\n}"
  },
  {
    "function_name": "PK_Verifier::Verify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "778-782",
    "snippet": "bool PK_Verifier::Verify(PK_MessageAccumulator *messageAccumulator) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn VerifyAndRestart(*m);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VerifyAndRestart",
          "args": [
            "*m"
          ],
          "line": 781
        },
        "resolved": true,
        "details": {
          "function_name": "TF_VerifierBase::VerifyAndRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.cpp",
          "lines": "105-118",
          "snippet": "bool TF_VerifierBase::VerifyAndRestart(PK_MessageAccumulator &messageAccumulator) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tbool result = encoding.VerifyMessageRepresentative(\n\t\tma.AccessHash(), id, ma.m_empty, ma.m_representative, MessageRepresentativeBitLength());\n\tma.m_empty = true;\n\treturn result;\n}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"pch.h\"\n\nbool TF_VerifierBase::VerifyAndRestart(PK_MessageAccumulator &messageAccumulator) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tbool result = encoding.VerifyMessageRepresentative(\n\t\tma.AccessHash(), id, ma.m_empty, ma.m_representative, MessageRepresentativeBitLength());\n\tma.m_empty = true;\n\treturn result;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool PK_Verifier::Verify(PK_MessageAccumulator *messageAccumulator) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn VerifyAndRestart(*m);\n}"
  },
  {
    "function_name": "PK_Signer::SignMessageWithRecovery",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "769-776",
    "snippet": "size_t PK_Signer::SignMessageWithRecovery(RandomNumberGenerator &rng, const byte *recoverableMessage, size_t recoverableMessageLength, \n\tconst byte *nonrecoverableMessage, size_t nonrecoverableMessageLength, byte *signature) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(NewSignatureAccumulator(rng));\n\tInputRecoverableMessage(*m, recoverableMessage, recoverableMessageLength);\n\tm->Update(nonrecoverableMessage, nonrecoverableMessageLength);\n\treturn SignAndRestart(rng, *m, signature, false);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SignAndRestart",
          "args": [
            "rng",
            "*m",
            "signature",
            "false"
          ],
          "line": 775
        },
        "resolved": true,
        "details": {
          "function_name": "SignAndRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "1018-1062",
          "snippet": "size_t SignAndRestart(RandomNumberGenerator &rng, PK_MessageAccumulator &messageAccumulator, byte *signature, bool restart) const\n\t{\n\t\tthis->GetMaterial().DoQuickSanityCheck();\n\n\t\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\t\tconst DL_ElgamalLikeSignatureAlgorithm<T> &alg = this->GetSignatureAlgorithm();\n\t\tconst DL_GroupParameters<T> &params = this->GetAbstractGroupParameters();\n\t\tconst DL_PrivateKey<T> &key = this->GetKeyInterface();\n\n\t\tSecByteBlock representative(this->MessageRepresentativeLength());\n\t\tthis->GetMessageEncodingInterface().ComputeMessageRepresentative(\n\t\t\trng, \n\t\t\tma.m_recoverableMessage, ma.m_recoverableMessage.size(), \n\t\t\tma.AccessHash(), this->GetHashIdentifier(), ma.m_empty, \n\t\t\trepresentative, this->MessageRepresentativeBitLength());\n\t\tma.m_empty = true;\n\t\tInteger e(representative, representative.size());\n\n\t\t// hash message digest into random number k to prevent reusing the same k on a different messages\n\t\t// after virtual machine rollback\n\t\tif (rng.CanIncorporateEntropy())\n\t\t\trng.IncorporateEntropy(representative, representative.size());\n\t\tInteger k(rng, 1, params.GetSubgroupOrder()-1);\n\t\tInteger r, s;\n\t\tr = params.ConvertElementToInteger(params.ExponentiateBase(k));\n\t\talg.Sign(params, key.GetPrivateExponent(), k, e, r, s);\n\n\t\t/*\n\t\tInteger r, s;\n\t\tif (this->MaxRecoverableLength() > 0)\n\t\t\tr.Decode(ma.m_semisignature, ma.m_semisignature.size());\n\t\telse\n\t\t\tr.Decode(ma.m_presignature, ma.m_presignature.size());\n\t\talg.Sign(params, key.GetPrivateExponent(), ma.m_k, e, r, s);\n\t\t*/\n\n\t\tsize_t rLen = alg.RLen(params);\n\t\tr.Encode(signature, rLen);\n\t\ts.Encode(signature+rLen, alg.SLen(params));\n\n\t\tif (restart)\n\t\t\tRestartMessageAccumulator(rng, ma);\n\n\t\treturn this->SignatureLength();\n\t}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nsize_t SignAndRestart(RandomNumberGenerator &rng, PK_MessageAccumulator &messageAccumulator, byte *signature, bool restart) const\n\t{\n\t\tthis->GetMaterial().DoQuickSanityCheck();\n\n\t\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\t\tconst DL_ElgamalLikeSignatureAlgorithm<T> &alg = this->GetSignatureAlgorithm();\n\t\tconst DL_GroupParameters<T> &params = this->GetAbstractGroupParameters();\n\t\tconst DL_PrivateKey<T> &key = this->GetKeyInterface();\n\n\t\tSecByteBlock representative(this->MessageRepresentativeLength());\n\t\tthis->GetMessageEncodingInterface().ComputeMessageRepresentative(\n\t\t\trng, \n\t\t\tma.m_recoverableMessage, ma.m_recoverableMessage.size(), \n\t\t\tma.AccessHash(), this->GetHashIdentifier(), ma.m_empty, \n\t\t\trepresentative, this->MessageRepresentativeBitLength());\n\t\tma.m_empty = true;\n\t\tInteger e(representative, representative.size());\n\n\t\t// hash message digest into random number k to prevent reusing the same k on a different messages\n\t\t// after virtual machine rollback\n\t\tif (rng.CanIncorporateEntropy())\n\t\t\trng.IncorporateEntropy(representative, representative.size());\n\t\tInteger k(rng, 1, params.GetSubgroupOrder()-1);\n\t\tInteger r, s;\n\t\tr = params.ConvertElementToInteger(params.ExponentiateBase(k));\n\t\talg.Sign(params, key.GetPrivateExponent(), k, e, r, s);\n\n\t\t/*\n\t\tInteger r, s;\n\t\tif (this->MaxRecoverableLength() > 0)\n\t\t\tr.Decode(ma.m_semisignature, ma.m_semisignature.size());\n\t\telse\n\t\t\tr.Decode(ma.m_presignature, ma.m_presignature.size());\n\t\talg.Sign(params, key.GetPrivateExponent(), ma.m_k, e, r, s);\n\t\t*/\n\n\t\tsize_t rLen = alg.RLen(params);\n\t\tr.Encode(signature, rLen);\n\t\ts.Encode(signature+rLen, alg.SLen(params));\n\n\t\tif (restart)\n\t\t\tRestartMessageAccumulator(rng, ma);\n\n\t\treturn this->SignatureLength();\n\t}"
        }
      },
      {
        "call_info": {
          "callee": "m->Update",
          "args": [
            "nonrecoverableMessage",
            "nonrecoverableMessageLength"
          ],
          "line": 774
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InputRecoverableMessage",
          "args": [
            "*m",
            "recoverableMessage",
            "recoverableMessageLength"
          ],
          "line": 773
        },
        "resolved": true,
        "details": {
          "function_name": "TF_SignerBase::InputRecoverableMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.cpp",
          "lines": "44-65",
          "snippet": "void TF_SignerBase::InputRecoverableMessage(PK_MessageAccumulator &messageAccumulator, const byte *recoverableMessage, size_t recoverableMessageLength) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tsize_t maxRecoverableLength = encoding.MaxRecoverableLength(MessageRepresentativeBitLength(), GetHashIdentifier().second, ma.AccessHash().DigestSize());\n\n\tif (maxRecoverableLength == 0)\n\t\t{throw NotImplemented(\"TF_SignerBase: this algorithm does not support messsage recovery or the key is too short\");}\n\tif (recoverableMessageLength > maxRecoverableLength)\n\t\tthrow InvalidArgument(\"TF_SignerBase: the recoverable message part is too long for the given key and algorithm\");\n\n\tma.m_recoverableMessage.Assign(recoverableMessage, recoverableMessageLength);\n\tencoding.ProcessRecoverableMessage(\n\t\tma.AccessHash(), \n\t\trecoverableMessage, recoverableMessageLength,\n\t\tNULL, 0, ma.m_semisignature);\n}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"pch.h\"\n\nvoid TF_SignerBase::InputRecoverableMessage(PK_MessageAccumulator &messageAccumulator, const byte *recoverableMessage, size_t recoverableMessageLength) const\n{\n\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\tHashIdentifier id = GetHashIdentifier();\n\tconst MessageEncodingInterface &encoding = GetMessageEncodingInterface();\n\n\tif (MessageRepresentativeBitLength() < encoding.MinRepresentativeBitLength(id.second, ma.AccessHash().DigestSize()))\n\t\tthrow PK_SignatureScheme::KeyTooShort();\n\n\tsize_t maxRecoverableLength = encoding.MaxRecoverableLength(MessageRepresentativeBitLength(), GetHashIdentifier().second, ma.AccessHash().DigestSize());\n\n\tif (maxRecoverableLength == 0)\n\t\t{throw NotImplemented(\"TF_SignerBase: this algorithm does not support messsage recovery or the key is too short\");}\n\tif (recoverableMessageLength > maxRecoverableLength)\n\t\tthrow InvalidArgument(\"TF_SignerBase: the recoverable message part is too long for the given key and algorithm\");\n\n\tma.m_recoverableMessage.Assign(recoverableMessage, recoverableMessageLength);\n\tencoding.ProcessRecoverableMessage(\n\t\tma.AccessHash(), \n\t\trecoverableMessage, recoverableMessageLength,\n\t\tNULL, 0, ma.m_semisignature);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t PK_Signer::SignMessageWithRecovery(RandomNumberGenerator &rng, const byte *recoverableMessage, size_t recoverableMessageLength, \n\tconst byte *nonrecoverableMessage, size_t nonrecoverableMessageLength, byte *signature) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(NewSignatureAccumulator(rng));\n\tInputRecoverableMessage(*m, recoverableMessage, recoverableMessageLength);\n\tm->Update(nonrecoverableMessage, nonrecoverableMessageLength);\n\treturn SignAndRestart(rng, *m, signature, false);\n}"
  },
  {
    "function_name": "PK_Signer::SignMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "762-767",
    "snippet": "size_t PK_Signer::SignMessage(RandomNumberGenerator &rng, const byte *message, size_t messageLen, byte *signature) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(NewSignatureAccumulator(rng));\n\tm->Update(message, messageLen);\n\treturn SignAndRestart(rng, *m, signature, false);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SignAndRestart",
          "args": [
            "rng",
            "*m",
            "signature",
            "false"
          ],
          "line": 766
        },
        "resolved": true,
        "details": {
          "function_name": "SignAndRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "1018-1062",
          "snippet": "size_t SignAndRestart(RandomNumberGenerator &rng, PK_MessageAccumulator &messageAccumulator, byte *signature, bool restart) const\n\t{\n\t\tthis->GetMaterial().DoQuickSanityCheck();\n\n\t\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\t\tconst DL_ElgamalLikeSignatureAlgorithm<T> &alg = this->GetSignatureAlgorithm();\n\t\tconst DL_GroupParameters<T> &params = this->GetAbstractGroupParameters();\n\t\tconst DL_PrivateKey<T> &key = this->GetKeyInterface();\n\n\t\tSecByteBlock representative(this->MessageRepresentativeLength());\n\t\tthis->GetMessageEncodingInterface().ComputeMessageRepresentative(\n\t\t\trng, \n\t\t\tma.m_recoverableMessage, ma.m_recoverableMessage.size(), \n\t\t\tma.AccessHash(), this->GetHashIdentifier(), ma.m_empty, \n\t\t\trepresentative, this->MessageRepresentativeBitLength());\n\t\tma.m_empty = true;\n\t\tInteger e(representative, representative.size());\n\n\t\t// hash message digest into random number k to prevent reusing the same k on a different messages\n\t\t// after virtual machine rollback\n\t\tif (rng.CanIncorporateEntropy())\n\t\t\trng.IncorporateEntropy(representative, representative.size());\n\t\tInteger k(rng, 1, params.GetSubgroupOrder()-1);\n\t\tInteger r, s;\n\t\tr = params.ConvertElementToInteger(params.ExponentiateBase(k));\n\t\talg.Sign(params, key.GetPrivateExponent(), k, e, r, s);\n\n\t\t/*\n\t\tInteger r, s;\n\t\tif (this->MaxRecoverableLength() > 0)\n\t\t\tr.Decode(ma.m_semisignature, ma.m_semisignature.size());\n\t\telse\n\t\t\tr.Decode(ma.m_presignature, ma.m_presignature.size());\n\t\talg.Sign(params, key.GetPrivateExponent(), ma.m_k, e, r, s);\n\t\t*/\n\n\t\tsize_t rLen = alg.RLen(params);\n\t\tr.Encode(signature, rLen);\n\t\ts.Encode(signature+rLen, alg.SLen(params));\n\n\t\tif (restart)\n\t\t\tRestartMessageAccumulator(rng, ma);\n\n\t\treturn this->SignatureLength();\n\t}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nsize_t SignAndRestart(RandomNumberGenerator &rng, PK_MessageAccumulator &messageAccumulator, byte *signature, bool restart) const\n\t{\n\t\tthis->GetMaterial().DoQuickSanityCheck();\n\n\t\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\t\tconst DL_ElgamalLikeSignatureAlgorithm<T> &alg = this->GetSignatureAlgorithm();\n\t\tconst DL_GroupParameters<T> &params = this->GetAbstractGroupParameters();\n\t\tconst DL_PrivateKey<T> &key = this->GetKeyInterface();\n\n\t\tSecByteBlock representative(this->MessageRepresentativeLength());\n\t\tthis->GetMessageEncodingInterface().ComputeMessageRepresentative(\n\t\t\trng, \n\t\t\tma.m_recoverableMessage, ma.m_recoverableMessage.size(), \n\t\t\tma.AccessHash(), this->GetHashIdentifier(), ma.m_empty, \n\t\t\trepresentative, this->MessageRepresentativeBitLength());\n\t\tma.m_empty = true;\n\t\tInteger e(representative, representative.size());\n\n\t\t// hash message digest into random number k to prevent reusing the same k on a different messages\n\t\t// after virtual machine rollback\n\t\tif (rng.CanIncorporateEntropy())\n\t\t\trng.IncorporateEntropy(representative, representative.size());\n\t\tInteger k(rng, 1, params.GetSubgroupOrder()-1);\n\t\tInteger r, s;\n\t\tr = params.ConvertElementToInteger(params.ExponentiateBase(k));\n\t\talg.Sign(params, key.GetPrivateExponent(), k, e, r, s);\n\n\t\t/*\n\t\tInteger r, s;\n\t\tif (this->MaxRecoverableLength() > 0)\n\t\t\tr.Decode(ma.m_semisignature, ma.m_semisignature.size());\n\t\telse\n\t\t\tr.Decode(ma.m_presignature, ma.m_presignature.size());\n\t\talg.Sign(params, key.GetPrivateExponent(), ma.m_k, e, r, s);\n\t\t*/\n\n\t\tsize_t rLen = alg.RLen(params);\n\t\tr.Encode(signature, rLen);\n\t\ts.Encode(signature+rLen, alg.SLen(params));\n\n\t\tif (restart)\n\t\t\tRestartMessageAccumulator(rng, ma);\n\n\t\treturn this->SignatureLength();\n\t}"
        }
      },
      {
        "call_info": {
          "callee": "m->Update",
          "args": [
            "message",
            "messageLen"
          ],
          "line": 765
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t PK_Signer::SignMessage(RandomNumberGenerator &rng, const byte *message, size_t messageLen, byte *signature) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(NewSignatureAccumulator(rng));\n\tm->Update(message, messageLen);\n\treturn SignAndRestart(rng, *m, signature, false);\n}"
  },
  {
    "function_name": "PK_Signer::Sign",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "756-760",
    "snippet": "size_t PK_Signer::Sign(RandomNumberGenerator &rng, PK_MessageAccumulator *messageAccumulator, byte *signature) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn SignAndRestart(rng, *m, signature, false);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SignAndRestart",
          "args": [
            "rng",
            "*m",
            "signature",
            "false"
          ],
          "line": 759
        },
        "resolved": true,
        "details": {
          "function_name": "SignAndRestart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "1018-1062",
          "snippet": "size_t SignAndRestart(RandomNumberGenerator &rng, PK_MessageAccumulator &messageAccumulator, byte *signature, bool restart) const\n\t{\n\t\tthis->GetMaterial().DoQuickSanityCheck();\n\n\t\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\t\tconst DL_ElgamalLikeSignatureAlgorithm<T> &alg = this->GetSignatureAlgorithm();\n\t\tconst DL_GroupParameters<T> &params = this->GetAbstractGroupParameters();\n\t\tconst DL_PrivateKey<T> &key = this->GetKeyInterface();\n\n\t\tSecByteBlock representative(this->MessageRepresentativeLength());\n\t\tthis->GetMessageEncodingInterface().ComputeMessageRepresentative(\n\t\t\trng, \n\t\t\tma.m_recoverableMessage, ma.m_recoverableMessage.size(), \n\t\t\tma.AccessHash(), this->GetHashIdentifier(), ma.m_empty, \n\t\t\trepresentative, this->MessageRepresentativeBitLength());\n\t\tma.m_empty = true;\n\t\tInteger e(representative, representative.size());\n\n\t\t// hash message digest into random number k to prevent reusing the same k on a different messages\n\t\t// after virtual machine rollback\n\t\tif (rng.CanIncorporateEntropy())\n\t\t\trng.IncorporateEntropy(representative, representative.size());\n\t\tInteger k(rng, 1, params.GetSubgroupOrder()-1);\n\t\tInteger r, s;\n\t\tr = params.ConvertElementToInteger(params.ExponentiateBase(k));\n\t\talg.Sign(params, key.GetPrivateExponent(), k, e, r, s);\n\n\t\t/*\n\t\tInteger r, s;\n\t\tif (this->MaxRecoverableLength() > 0)\n\t\t\tr.Decode(ma.m_semisignature, ma.m_semisignature.size());\n\t\telse\n\t\t\tr.Decode(ma.m_presignature, ma.m_presignature.size());\n\t\talg.Sign(params, key.GetPrivateExponent(), ma.m_k, e, r, s);\n\t\t*/\n\n\t\tsize_t rLen = alg.RLen(params);\n\t\tr.Encode(signature, rLen);\n\t\ts.Encode(signature+rLen, alg.SLen(params));\n\n\t\tif (restart)\n\t\t\tRestartMessageAccumulator(rng, ma);\n\n\t\treturn this->SignatureLength();\n\t}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nsize_t SignAndRestart(RandomNumberGenerator &rng, PK_MessageAccumulator &messageAccumulator, byte *signature, bool restart) const\n\t{\n\t\tthis->GetMaterial().DoQuickSanityCheck();\n\n\t\tPK_MessageAccumulatorBase &ma = static_cast<PK_MessageAccumulatorBase &>(messageAccumulator);\n\t\tconst DL_ElgamalLikeSignatureAlgorithm<T> &alg = this->GetSignatureAlgorithm();\n\t\tconst DL_GroupParameters<T> &params = this->GetAbstractGroupParameters();\n\t\tconst DL_PrivateKey<T> &key = this->GetKeyInterface();\n\n\t\tSecByteBlock representative(this->MessageRepresentativeLength());\n\t\tthis->GetMessageEncodingInterface().ComputeMessageRepresentative(\n\t\t\trng, \n\t\t\tma.m_recoverableMessage, ma.m_recoverableMessage.size(), \n\t\t\tma.AccessHash(), this->GetHashIdentifier(), ma.m_empty, \n\t\t\trepresentative, this->MessageRepresentativeBitLength());\n\t\tma.m_empty = true;\n\t\tInteger e(representative, representative.size());\n\n\t\t// hash message digest into random number k to prevent reusing the same k on a different messages\n\t\t// after virtual machine rollback\n\t\tif (rng.CanIncorporateEntropy())\n\t\t\trng.IncorporateEntropy(representative, representative.size());\n\t\tInteger k(rng, 1, params.GetSubgroupOrder()-1);\n\t\tInteger r, s;\n\t\tr = params.ConvertElementToInteger(params.ExponentiateBase(k));\n\t\talg.Sign(params, key.GetPrivateExponent(), k, e, r, s);\n\n\t\t/*\n\t\tInteger r, s;\n\t\tif (this->MaxRecoverableLength() > 0)\n\t\t\tr.Decode(ma.m_semisignature, ma.m_semisignature.size());\n\t\telse\n\t\t\tr.Decode(ma.m_presignature, ma.m_presignature.size());\n\t\talg.Sign(params, key.GetPrivateExponent(), ma.m_k, e, r, s);\n\t\t*/\n\n\t\tsize_t rLen = alg.RLen(params);\n\t\tr.Encode(signature, rLen);\n\t\ts.Encode(signature+rLen, alg.SLen(params));\n\n\t\tif (restart)\n\t\t\tRestartMessageAccumulator(rng, ma);\n\n\t\treturn this->SignatureLength();\n\t}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t PK_Signer::Sign(RandomNumberGenerator &rng, PK_MessageAccumulator *messageAccumulator, byte *signature) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn SignAndRestart(rng, *m, signature, false);\n}"
  },
  {
    "function_name": "Put2",
    "container": "PK_DefaultDecryptionFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "717-741",
    "snippet": "size_t Put2(const byte *inString, size_t length, int messageEnd, bool blocking)\n\t{\n\t\tFILTER_BEGIN;\n\t\tm_ciphertextQueue.Put(inString, length);\n\n\t\tif (messageEnd)\n\t\t{\n\t\t\t{\n\t\t\tsize_t ciphertextLength;\n\t\t\tif (!SafeConvert(m_ciphertextQueue.CurrentSize(), ciphertextLength))\n\t\t\t\tthrow InvalidArgument(\"PK_DefaultDecryptionFilter: ciphertext too long\");\n\t\t\tsize_t maxPlaintextLength = m_decryptor.MaxPlaintextLength(ciphertextLength);\n\n\t\t\tSecByteBlock ciphertext(ciphertextLength);\n\t\t\tm_ciphertextQueue.Get(ciphertext, ciphertextLength);\n\t\t\tm_plaintext.resize(maxPlaintextLength);\n\t\t\tm_result = m_decryptor.Decrypt(m_rng, ciphertext, ciphertextLength, m_plaintext, m_parameters);\n\t\t\tif (!m_result.isValidCoding)\n\t\t\t\tthrow InvalidCiphertext(m_decryptor.AlgorithmName() + \": invalid ciphertext\");\n\t\t\t}\n\n\t\t\tFILTER_OUTPUT(1, m_plaintext, m_result.messageLength, messageEnd);\n\t\t}\n\t\tFILTER_END_NO_MESSAGE_END;\n\t}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FILTER_OUTPUT",
          "args": [
            "1",
            "m_plaintext",
            "m_result.messageLength",
            "messageEnd"
          ],
          "line": 738
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidCiphertext",
          "args": [
            "m_decryptor.AlgorithmName() + \": invalid ciphertext\""
          ],
          "line": 735
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_decryptor.AlgorithmName",
          "args": [],
          "line": 735
        },
        "resolved": true,
        "details": {
          "function_name": "AlgorithmName",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "291-291",
          "snippet": "std::string AlgorithmName() const {return \"NullRNG\";}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  std::string AlgorithmName() const {return \"NullRNG\";}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_decryptor.Decrypt",
          "args": [
            "m_rng",
            "ciphertext",
            "ciphertextLength",
            "m_plaintext",
            "m_parameters"
          ],
          "line": 733
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_plaintext.resize",
          "args": [
            "maxPlaintextLength"
          ],
          "line": 732
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "203-211",
          "snippet": "void resize(size_t newSize)\n\t{\n\t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n\t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n\t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n\t\tdelete [] this->m_ptr;\n\t\tthis->m_size = newSize;\n\t\tthis->m_ptr = newPtr;\n\t}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  void resize(size_t newSize)\n  \t{\n  \t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n  \t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n  \t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n  \t\tdelete [] this->m_ptr;\n  \t\tthis->m_size = newSize;\n  \t\tthis->m_ptr = newPtr;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_ciphertextQueue.Get",
          "args": [
            "ciphertext",
            "ciphertextLength"
          ],
          "line": 731
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "88-93",
          "snippet": "inline size_t Get(byte *outString, size_t getMax)\n\t{\n\t\tsize_t len = Peek(outString, getMax);\n\t\tm_head += len;\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Get(byte *outString, size_t getMax)\n  \t{\n  \t\tsize_t len = Peek(outString, getMax);\n  \t\tm_head += len;\n  \t\treturn len;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_decryptor.MaxPlaintextLength",
          "args": [
            "ciphertextLength"
          ],
          "line": 728
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"PK_DefaultDecryptionFilter: ciphertext too long\""
          ],
          "line": 727
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SafeConvert",
          "args": [
            "m_ciphertextQueue.CurrentSize()",
            "ciphertextLength"
          ],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "SafeConvert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "299-305",
          "snippet": "inline bool SafeConvert(T1 from, T2 &to)\n{\n\tto = (T2)from;\n\tif (from != to || (from > 0) != (to > 0))\n\t\treturn false;\n\treturn true;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline bool SafeConvert(T1 from, T2 &to)\n{\n\tto = (T2)from;\n\tif (from != to || (from > 0) != (to > 0))\n\t\treturn false;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_ciphertextQueue.CurrentSize",
          "args": [],
          "line": 726
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentSize",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "27-30",
          "snippet": "inline size_t CurrentSize() const\n\t{\n\t\treturn m_tail-m_head;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t CurrentSize() const\n  \t{\n  \t\treturn m_tail-m_head;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_ciphertextQueue.Put",
          "args": [
            "inString",
            "length"
          ],
          "line": 720
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "788-789",
          "snippet": "size_t Put(const byte *inString, size_t length, bool blocking=true)\n\t\t\t{return Put2(inString, length, 0, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(const byte *inString, size_t length, bool blocking=true)\n\t\t\t{return Put2(inString, length, 0, blocking);}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nPK_DefaultDecryptionFilter {\n  size_t Put2(const byte *inString, size_t length, int messageEnd, bool blocking)\n  \t{\n  \t\tFILTER_BEGIN;\n  \t\tm_ciphertextQueue.Put(inString, length);\n  \n  \t\tif (messageEnd)\n  \t\t{\n  \t\t\t{\n  \t\t\tsize_t ciphertextLength;\n  \t\t\tif (!SafeConvert(m_ciphertextQueue.CurrentSize(), ciphertextLength))\n  \t\t\t\tthrow InvalidArgument(\"PK_DefaultDecryptionFilter: ciphertext too long\");\n  \t\t\tsize_t maxPlaintextLength = m_decryptor.MaxPlaintextLength(ciphertextLength);\n  \n  \t\t\tSecByteBlock ciphertext(ciphertextLength);\n  \t\t\tm_ciphertextQueue.Get(ciphertext, ciphertextLength);\n  \t\t\tm_plaintext.resize(maxPlaintextLength);\n  \t\t\tm_result = m_decryptor.Decrypt(m_rng, ciphertext, ciphertextLength, m_plaintext, m_parameters);\n  \t\t\tif (!m_result.isValidCoding)\n  \t\t\t\tthrow InvalidCiphertext(m_decryptor.AlgorithmName() + \": invalid ciphertext\");\n  \t\t\t}\n  \n  \t\t\tFILTER_OUTPUT(1, m_plaintext, m_result.messageLength, messageEnd);\n  \t\t}\n  \t\tFILTER_END_NO_MESSAGE_END;\n  \t}\n}"
  },
  {
    "function_name": "PK_DefaultDecryptionFilter",
    "container": "PK_DefaultDecryptionFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "711-715",
    "snippet": "PK_DefaultDecryptionFilter(RandomNumberGenerator &rng, const PK_Decryptor &decryptor, BufferedTransformation *attachment, const NameValuePairs &parameters)\n\t\t: m_rng(rng), m_decryptor(decryptor), m_parameters(parameters)\n\t{\n\t\tDetach(attachment);\n\t}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Detach",
          "args": [
            "attachment"
          ],
          "line": 714
        },
        "resolved": true,
        "details": {
          "function_name": "Filter::Detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "40-43",
          "snippet": "void Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nPK_DefaultDecryptionFilter {\n  PK_DefaultDecryptionFilter(RandomNumberGenerator &rng, const PK_Decryptor &decryptor, BufferedTransformation *attachment, const NameValuePairs &parameters)\n  \t\t: m_rng(rng), m_decryptor(decryptor), m_parameters(parameters)\n  \t{\n  \t\tDetach(attachment);\n  \t}\n}"
  },
  {
    "function_name": "Put2",
    "container": "PK_DefaultEncryptionFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "672-694",
    "snippet": "size_t Put2(const byte *inString, size_t length, int messageEnd, bool blocking)\n\t{\n\t\tFILTER_BEGIN;\n\t\tm_plaintextQueue.Put(inString, length);\n\n\t\tif (messageEnd)\n\t\t{\n\t\t\t{\n\t\t\tsize_t plaintextLength;\n\t\t\tif (!SafeConvert(m_plaintextQueue.CurrentSize(), plaintextLength))\n\t\t\t\tthrow InvalidArgument(\"PK_DefaultEncryptionFilter: plaintext too long\");\n\t\t\tsize_t ciphertextLength = m_encryptor.CiphertextLength(plaintextLength);\n\n\t\t\tSecByteBlock plaintext(plaintextLength);\n\t\t\tm_plaintextQueue.Get(plaintext, plaintextLength);\n\t\t\tm_ciphertext.resize(ciphertextLength);\n\t\t\tm_encryptor.Encrypt(m_rng, plaintext, plaintextLength, m_ciphertext, m_parameters);\n\t\t\t}\n\t\t\t\n\t\t\tFILTER_OUTPUT(1, m_ciphertext, m_ciphertext.size(), messageEnd);\n\t\t}\n\t\tFILTER_END_NO_MESSAGE_END;\n\t}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "FILTER_OUTPUT",
          "args": [
            "1",
            "m_ciphertext",
            "m_ciphertext.size()",
            "messageEnd"
          ],
          "line": 691
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_ciphertext.size",
          "args": [],
          "line": 691
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_encryptor.Encrypt",
          "args": [
            "m_rng",
            "plaintext",
            "plaintextLength",
            "m_ciphertext",
            "m_parameters"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_ciphertext.resize",
          "args": [
            "ciphertextLength"
          ],
          "line": 687
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "203-211",
          "snippet": "void resize(size_t newSize)\n\t{\n\t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n\t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n\t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n\t\tdelete [] this->m_ptr;\n\t\tthis->m_size = newSize;\n\t\tthis->m_ptr = newPtr;\n\t}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  void resize(size_t newSize)\n  \t{\n  \t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n  \t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n  \t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n  \t\tdelete [] this->m_ptr;\n  \t\tthis->m_size = newSize;\n  \t\tthis->m_ptr = newPtr;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_plaintextQueue.Get",
          "args": [
            "plaintext",
            "plaintextLength"
          ],
          "line": 686
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "88-93",
          "snippet": "inline size_t Get(byte *outString, size_t getMax)\n\t{\n\t\tsize_t len = Peek(outString, getMax);\n\t\tm_head += len;\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Get(byte *outString, size_t getMax)\n  \t{\n  \t\tsize_t len = Peek(outString, getMax);\n  \t\tm_head += len;\n  \t\treturn len;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_encryptor.CiphertextLength",
          "args": [
            "plaintextLength"
          ],
          "line": 683
        },
        "resolved": true,
        "details": {
          "function_name": "CiphertextLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "144-145",
          "snippet": "size_t CiphertextLength(size_t plaintextLength) const\n\t\t{return plaintextLength <= FixedMaxPlaintextLength() ? FixedCiphertextLength() : 0;}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nsize_t CiphertextLength(size_t plaintextLength) const\n\t\t{return plaintextLength <= FixedMaxPlaintextLength() ? FixedCiphertextLength() : 0;}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"PK_DefaultEncryptionFilter: plaintext too long\""
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SafeConvert",
          "args": [
            "m_plaintextQueue.CurrentSize()",
            "plaintextLength"
          ],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "SafeConvert",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "299-305",
          "snippet": "inline bool SafeConvert(T1 from, T2 &to)\n{\n\tto = (T2)from;\n\tif (from != to || (from > 0) != (to > 0))\n\t\treturn false;\n\treturn true;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline bool SafeConvert(T1 from, T2 &to)\n{\n\tto = (T2)from;\n\tif (from != to || (from > 0) != (to > 0))\n\t\treturn false;\n\treturn true;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_plaintextQueue.CurrentSize",
          "args": [],
          "line": 681
        },
        "resolved": true,
        "details": {
          "function_name": "CurrentSize",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "27-30",
          "snippet": "inline size_t CurrentSize() const\n\t{\n\t\treturn m_tail-m_head;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t CurrentSize() const\n  \t{\n  \t\treturn m_tail-m_head;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_plaintextQueue.Put",
          "args": [
            "inString",
            "length"
          ],
          "line": 675
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "788-789",
          "snippet": "size_t Put(const byte *inString, size_t length, bool blocking=true)\n\t\t\t{return Put2(inString, length, 0, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(const byte *inString, size_t length, bool blocking=true)\n\t\t\t{return Put2(inString, length, 0, blocking);}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nPK_DefaultEncryptionFilter {\n  size_t Put2(const byte *inString, size_t length, int messageEnd, bool blocking)\n  \t{\n  \t\tFILTER_BEGIN;\n  \t\tm_plaintextQueue.Put(inString, length);\n  \n  \t\tif (messageEnd)\n  \t\t{\n  \t\t\t{\n  \t\t\tsize_t plaintextLength;\n  \t\t\tif (!SafeConvert(m_plaintextQueue.CurrentSize(), plaintextLength))\n  \t\t\t\tthrow InvalidArgument(\"PK_DefaultEncryptionFilter: plaintext too long\");\n  \t\t\tsize_t ciphertextLength = m_encryptor.CiphertextLength(plaintextLength);\n  \n  \t\t\tSecByteBlock plaintext(plaintextLength);\n  \t\t\tm_plaintextQueue.Get(plaintext, plaintextLength);\n  \t\t\tm_ciphertext.resize(ciphertextLength);\n  \t\t\tm_encryptor.Encrypt(m_rng, plaintext, plaintextLength, m_ciphertext, m_parameters);\n  \t\t\t}\n  \t\t\t\n  \t\t\tFILTER_OUTPUT(1, m_ciphertext, m_ciphertext.size(), messageEnd);\n  \t\t}\n  \t\tFILTER_END_NO_MESSAGE_END;\n  \t}\n}"
  },
  {
    "function_name": "PK_DefaultEncryptionFilter",
    "container": "PK_DefaultEncryptionFilter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "666-670",
    "snippet": "PK_DefaultEncryptionFilter(RandomNumberGenerator &rng, const PK_Encryptor &encryptor, BufferedTransformation *attachment, const NameValuePairs &parameters)\n\t\t: m_rng(rng), m_encryptor(encryptor), m_parameters(parameters)\n\t{\n\t\tDetach(attachment);\n\t}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Detach",
          "args": [
            "attachment"
          ],
          "line": 669
        },
        "resolved": true,
        "details": {
          "function_name": "Filter::Detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "40-43",
          "snippet": "void Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nPK_DefaultEncryptionFilter {\n  PK_DefaultEncryptionFilter(RandomNumberGenerator &rng, const PK_Encryptor &encryptor, BufferedTransformation *attachment, const NameValuePairs &parameters)\n  \t\t: m_rng(rng), m_encryptor(encryptor), m_parameters(parameters)\n  \t{\n  \t\tDetach(attachment);\n  \t}\n}"
  },
  {
    "function_name": "GeneratableCryptoMaterial::GenerateRandomWithKeySize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "658-661",
    "snippet": "void GeneratableCryptoMaterial::GenerateRandomWithKeySize(RandomNumberGenerator &rng, unsigned int keySize)\n{\n\tGenerateRandom(rng, MakeParameters(\"KeySize\", (int)keySize));\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateRandom",
          "args": [
            "rng",
            "MakeParameters(\"KeySize\", (int)keySize)"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "InvertibleRabinFunction::GenerateRandom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rabin.cpp",
          "lines": "75-114",
          "snippet": "void InvertibleRabinFunction::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tint modulusSize = 2048;\n\talg.GetIntValue(\"ModulusSize\", modulusSize) || alg.GetIntValue(\"KeySize\", modulusSize);\n\n\tif (modulusSize < 16)\n\t\tthrow InvalidArgument(\"InvertibleRabinFunction: specified modulus size is too small\");\n\n\t// VC70 workaround: putting these after primeParam causes overlapped stack allocation\n\tbool rFound=false, sFound=false;\n\tInteger t=2;\n\n\tAlgorithmParameters primeParam = MakeParametersForTwoPrimesOfEqualSize(modulusSize)\n\t\t(\"EquivalentTo\", 3)(\"Mod\", 4);\n\tm_p.GenerateRandom(rng, primeParam);\n\tm_q.GenerateRandom(rng, primeParam);\n\n\twhile (!(rFound && sFound))\n\t{\n\t\tint jp = Jacobi(t, m_p);\n\t\tint jq = Jacobi(t, m_q);\n\n\t\tif (!rFound && jp==1 && jq==-1)\n\t\t{\n\t\t\tm_r = t;\n\t\t\trFound = true;\n\t\t}\n\n\t\tif (!sFound && jp==-1 && jq==1)\n\t\t{\n\t\t\tm_s = t;\n\t\t\tsFound = true;\n\t\t}\n\n\t\t++t;\n\t}\n\n\tm_n = m_p * m_q;\n\tm_u = m_q.InverseMod(m_p);\n}",
          "includes": [
            "#include \"modarith.h\"",
            "#include \"sha.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"rabin.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n#include \"sha.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"rabin.h\"\n#include \"pch.h\"\n\nvoid InvertibleRabinFunction::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tint modulusSize = 2048;\n\talg.GetIntValue(\"ModulusSize\", modulusSize) || alg.GetIntValue(\"KeySize\", modulusSize);\n\n\tif (modulusSize < 16)\n\t\tthrow InvalidArgument(\"InvertibleRabinFunction: specified modulus size is too small\");\n\n\t// VC70 workaround: putting these after primeParam causes overlapped stack allocation\n\tbool rFound=false, sFound=false;\n\tInteger t=2;\n\n\tAlgorithmParameters primeParam = MakeParametersForTwoPrimesOfEqualSize(modulusSize)\n\t\t(\"EquivalentTo\", 3)(\"Mod\", 4);\n\tm_p.GenerateRandom(rng, primeParam);\n\tm_q.GenerateRandom(rng, primeParam);\n\n\twhile (!(rFound && sFound))\n\t{\n\t\tint jp = Jacobi(t, m_p);\n\t\tint jq = Jacobi(t, m_q);\n\n\t\tif (!rFound && jp==1 && jq==-1)\n\t\t{\n\t\t\tm_r = t;\n\t\t\trFound = true;\n\t\t}\n\n\t\tif (!sFound && jp==-1 && jq==1)\n\t\t{\n\t\t\tm_s = t;\n\t\t\tsFound = true;\n\t\t}\n\n\t\t++t;\n\t}\n\n\tm_n = m_p * m_q;\n\tm_u = m_q.InverseMod(m_p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "\"KeySize\"",
            "(int)keySize"
          ],
          "line": 660
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid GeneratableCryptoMaterial::GenerateRandomWithKeySize(RandomNumberGenerator &rng, unsigned int keySize)\n{\n\tGenerateRandom(rng, MakeParameters(\"KeySize\", (int)keySize));\n}"
  },
  {
    "function_name": "BufferedTransformation::Attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "650-656",
    "snippet": "void BufferedTransformation::Attach(BufferedTransformation *newOut)\n{\n\tif (AttachedTransformation() && AttachedTransformation()->Attachable())\n\t\tAttachedTransformation()->Attach(newOut);\n\telse\n\t\tDetach(newOut);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Detach",
          "args": [
            "newOut"
          ],
          "line": 655
        },
        "resolved": true,
        "details": {
          "function_name": "Filter::Detach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "40-43",
          "snippet": "void Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid Filter::Detach(BufferedTransformation *newOut)\n{\n\tm_attachment.reset(newOut);\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "newOut"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid BufferedTransformation::Attach(BufferedTransformation *newOut)\n{\n\tif (AttachedTransformation() && AttachedTransformation()->Attachable())\n\t\tAttachedTransformation()->Attach(newOut);\n\telse\n\t\tDetach(newOut);\n}"
  },
  {
    "function_name": "BufferedTransformation::GetWord32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "645-648",
    "snippet": "size_t BufferedTransformation::GetWord32(word32 &value, ByteOrder order)\n{\n\treturn (size_t)Skip(PeekWord32(value, order));\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Skip",
          "args": [
            "PeekWord32(value, order)"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::Skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "443-449",
          "snippet": "lword BufferedTransformation::Skip(lword skipMax)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Skip(skipMax);\n\telse\n\t\treturn TransferTo(TheBitBucket(), skipMax);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nlword BufferedTransformation::Skip(lword skipMax)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Skip(skipMax);\n\telse\n\t\treturn TransferTo(TheBitBucket(), skipMax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PeekWord32",
          "args": [
            "value",
            "order"
          ],
          "line": 647
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::PeekWord32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "627-638",
          "snippet": "size_t BufferedTransformation::PeekWord32(word32 &value, ByteOrder order) const\n{\n\tbyte buf[4] = {0, 0, 0, 0};\n\tsize_t len = Peek(buf, 4);\n\n\tif (order)\n\t\tvalue = (buf[0] << 24) | (buf[1] << 16) | (buf[2] << 8) | buf [3];\n\telse\n\t\tvalue = (buf[3] << 24) | (buf[2] << 16) | (buf[1] << 8) | buf [0];\n\n\treturn len;\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::PeekWord32(word32 &value, ByteOrder order) const\n{\n\tbyte buf[4] = {0, 0, 0, 0};\n\tsize_t len = Peek(buf, 4);\n\n\tif (order)\n\t\tvalue = (buf[0] << 24) | (buf[1] << 16) | (buf[2] << 8) | buf [3];\n\telse\n\t\tvalue = (buf[3] << 24) | (buf[2] << 16) | (buf[1] << 8) | buf [0];\n\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::GetWord32(word32 &value, ByteOrder order)\n{\n\treturn (size_t)Skip(PeekWord32(value, order));\n}"
  },
  {
    "function_name": "BufferedTransformation::GetWord16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "640-643",
    "snippet": "size_t BufferedTransformation::GetWord16(word16 &value, ByteOrder order)\n{\n\treturn (size_t)Skip(PeekWord16(value, order));\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Skip",
          "args": [
            "PeekWord16(value, order)"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::Skip",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "443-449",
          "snippet": "lword BufferedTransformation::Skip(lword skipMax)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Skip(skipMax);\n\telse\n\t\treturn TransferTo(TheBitBucket(), skipMax);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nlword BufferedTransformation::Skip(lword skipMax)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Skip(skipMax);\n\telse\n\t\treturn TransferTo(TheBitBucket(), skipMax);\n}"
        }
      },
      {
        "call_info": {
          "callee": "PeekWord16",
          "args": [
            "value",
            "order"
          ],
          "line": 642
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::PeekWord16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "614-625",
          "snippet": "size_t BufferedTransformation::PeekWord16(word16 &value, ByteOrder order) const\n{\n\tbyte buf[2] = {0, 0};\n\tsize_t len = Peek(buf, 2);\n\n\tif (order)\n\t\tvalue = (buf[0] << 8) | buf[1];\n\telse\n\t\tvalue = (buf[1] << 8) | buf[0];\n\n\treturn len;\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::PeekWord16(word16 &value, ByteOrder order) const\n{\n\tbyte buf[2] = {0, 0};\n\tsize_t len = Peek(buf, 2);\n\n\tif (order)\n\t\tvalue = (buf[0] << 8) | buf[1];\n\telse\n\t\tvalue = (buf[1] << 8) | buf[0];\n\n\treturn len;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::GetWord16(word16 &value, ByteOrder order)\n{\n\treturn (size_t)Skip(PeekWord16(value, order));\n}"
  },
  {
    "function_name": "BufferedTransformation::PeekWord32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "627-638",
    "snippet": "size_t BufferedTransformation::PeekWord32(word32 &value, ByteOrder order) const\n{\n\tbyte buf[4] = {0, 0, 0, 0};\n\tsize_t len = Peek(buf, 4);\n\n\tif (order)\n\t\tvalue = (buf[0] << 24) | (buf[1] << 16) | (buf[2] << 8) | buf [3];\n\telse\n\t\tvalue = (buf[3] << 24) | (buf[2] << 16) | (buf[1] << 8) | buf [0];\n\n\treturn len;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Peek",
          "args": [
            "buf",
            "4"
          ],
          "line": 630
        },
        "resolved": true,
        "details": {
          "function_name": "Peek",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "60-65",
          "snippet": "inline size_t Peek(byte *target, size_t copyMax) const\n\t{\n\t\tsize_t len = STDMIN(copyMax, m_tail-m_head);\n\t\tmemcpy(target, buf+m_head, len);\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Peek(byte *target, size_t copyMax) const\n  \t{\n  \t\tsize_t len = STDMIN(copyMax, m_tail-m_head);\n  \t\tmemcpy(target, buf+m_head, len);\n  \t\treturn len;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::PeekWord32(word32 &value, ByteOrder order) const\n{\n\tbyte buf[4] = {0, 0, 0, 0};\n\tsize_t len = Peek(buf, 4);\n\n\tif (order)\n\t\tvalue = (buf[0] << 24) | (buf[1] << 16) | (buf[2] << 8) | buf [3];\n\telse\n\t\tvalue = (buf[3] << 24) | (buf[2] << 16) | (buf[1] << 8) | buf [0];\n\n\treturn len;\n}"
  },
  {
    "function_name": "BufferedTransformation::PeekWord16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "614-625",
    "snippet": "size_t BufferedTransformation::PeekWord16(word16 &value, ByteOrder order) const\n{\n\tbyte buf[2] = {0, 0};\n\tsize_t len = Peek(buf, 2);\n\n\tif (order)\n\t\tvalue = (buf[0] << 8) | buf[1];\n\telse\n\t\tvalue = (buf[1] << 8) | buf[0];\n\n\treturn len;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Peek",
          "args": [
            "buf",
            "2"
          ],
          "line": 617
        },
        "resolved": true,
        "details": {
          "function_name": "Peek",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "60-65",
          "snippet": "inline size_t Peek(byte *target, size_t copyMax) const\n\t{\n\t\tsize_t len = STDMIN(copyMax, m_tail-m_head);\n\t\tmemcpy(target, buf+m_head, len);\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Peek(byte *target, size_t copyMax) const\n  \t{\n  \t\tsize_t len = STDMIN(copyMax, m_tail-m_head);\n  \t\tmemcpy(target, buf+m_head, len);\n  \t\treturn len;\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::PeekWord16(word16 &value, ByteOrder order) const\n{\n\tbyte buf[2] = {0, 0};\n\tsize_t len = Peek(buf, 2);\n\n\tif (order)\n\t\tvalue = (buf[0] << 8) | buf[1];\n\telse\n\t\tvalue = (buf[1] << 8) | buf[0];\n\n\treturn len;\n}"
  },
  {
    "function_name": "BufferedTransformation::PutWord32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "609-612",
    "snippet": "size_t BufferedTransformation::PutWord32(word32 value, ByteOrder order, bool blocking)\n{\n\treturn ChannelPutWord32(DEFAULT_CHANNEL, value, order, blocking);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChannelPutWord32",
          "args": [
            "DEFAULT_CHANNEL",
            "value",
            "order",
            "blocking"
          ],
          "line": 611
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::ChannelPutWord32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "598-602",
          "snippet": "size_t BufferedTransformation::ChannelPutWord32(const std::string &channel, word32 value, ByteOrder order, bool blocking)\n{\n\tPutWord(false, order, m_buf, value);\n\treturn ChannelPut(channel, m_buf, 4, blocking);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::ChannelPutWord32(const std::string &channel, word32 value, ByteOrder order, bool blocking)\n{\n\tPutWord(false, order, m_buf, value);\n\treturn ChannelPut(channel, m_buf, 4, blocking);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::PutWord32(word32 value, ByteOrder order, bool blocking)\n{\n\treturn ChannelPutWord32(DEFAULT_CHANNEL, value, order, blocking);\n}"
  },
  {
    "function_name": "BufferedTransformation::PutWord16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "604-607",
    "snippet": "size_t BufferedTransformation::PutWord16(word16 value, ByteOrder order, bool blocking)\n{\n\treturn ChannelPutWord16(DEFAULT_CHANNEL, value, order, blocking);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChannelPutWord16",
          "args": [
            "DEFAULT_CHANNEL",
            "value",
            "order",
            "blocking"
          ],
          "line": 606
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::ChannelPutWord16",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "592-596",
          "snippet": "size_t BufferedTransformation::ChannelPutWord16(const std::string &channel, word16 value, ByteOrder order, bool blocking)\n{\n\tPutWord(false, order, m_buf, value);\n\treturn ChannelPut(channel, m_buf, 2, blocking);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::ChannelPutWord16(const std::string &channel, word16 value, ByteOrder order, bool blocking)\n{\n\tPutWord(false, order, m_buf, value);\n\treturn ChannelPut(channel, m_buf, 2, blocking);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::PutWord16(word16 value, ByteOrder order, bool blocking)\n{\n\treturn ChannelPutWord16(DEFAULT_CHANNEL, value, order, blocking);\n}"
  },
  {
    "function_name": "BufferedTransformation::ChannelPutWord32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "598-602",
    "snippet": "size_t BufferedTransformation::ChannelPutWord32(const std::string &channel, word32 value, ByteOrder order, bool blocking)\n{\n\tPutWord(false, order, m_buf, value);\n\treturn ChannelPut(channel, m_buf, 4, blocking);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChannelPut",
          "args": [
            "channel",
            "m_buf",
            "4",
            "blocking"
          ],
          "line": 601
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutWord",
          "args": [
            "false",
            "order",
            "m_buf",
            "value"
          ],
          "line": 600
        },
        "resolved": true,
        "details": {
          "function_name": "PutWord",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1144-1153",
          "snippet": "inline void PutWord(bool assumeAligned, ByteOrder order, byte *block, T value, const byte *xorBlock = NULL)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedPutWordNonTemplate(order, block, value, xorBlock);\n\tassert(IsAligned<T>(block));\n\tassert(IsAligned<T>(xorBlock));\n#endif\n\t*reinterpret_cast<T *>(block) = ConditionalByteReverse(order, value) ^ (xorBlock ? *reinterpret_cast<const T *>(xorBlock) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline void PutWord(bool assumeAligned, ByteOrder order, byte *block, T value, const byte *xorBlock = NULL)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedPutWordNonTemplate(order, block, value, xorBlock);\n\tassert(IsAligned<T>(block));\n\tassert(IsAligned<T>(xorBlock));\n#endif\n\t*reinterpret_cast<T *>(block) = ConditionalByteReverse(order, value) ^ (xorBlock ? *reinterpret_cast<const T *>(xorBlock) : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::ChannelPutWord32(const std::string &channel, word32 value, ByteOrder order, bool blocking)\n{\n\tPutWord(false, order, m_buf, value);\n\treturn ChannelPut(channel, m_buf, 4, blocking);\n}"
  },
  {
    "function_name": "BufferedTransformation::ChannelPutWord16",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "592-596",
    "snippet": "size_t BufferedTransformation::ChannelPutWord16(const std::string &channel, word16 value, ByteOrder order, bool blocking)\n{\n\tPutWord(false, order, m_buf, value);\n\treturn ChannelPut(channel, m_buf, 2, blocking);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChannelPut",
          "args": [
            "channel",
            "m_buf",
            "2",
            "blocking"
          ],
          "line": 595
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutWord",
          "args": [
            "false",
            "order",
            "m_buf",
            "value"
          ],
          "line": 594
        },
        "resolved": true,
        "details": {
          "function_name": "PutWord",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1144-1153",
          "snippet": "inline void PutWord(bool assumeAligned, ByteOrder order, byte *block, T value, const byte *xorBlock = NULL)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedPutWordNonTemplate(order, block, value, xorBlock);\n\tassert(IsAligned<T>(block));\n\tassert(IsAligned<T>(xorBlock));\n#endif\n\t*reinterpret_cast<T *>(block) = ConditionalByteReverse(order, value) ^ (xorBlock ? *reinterpret_cast<const T *>(xorBlock) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline void PutWord(bool assumeAligned, ByteOrder order, byte *block, T value, const byte *xorBlock = NULL)\n{\n#ifndef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (!assumeAligned)\n\t\treturn UnalignedPutWordNonTemplate(order, block, value, xorBlock);\n\tassert(IsAligned<T>(block));\n\tassert(IsAligned<T>(xorBlock));\n#endif\n\t*reinterpret_cast<T *>(block) = ConditionalByteReverse(order, value) ^ (xorBlock ? *reinterpret_cast<const T *>(xorBlock) : 0);\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::ChannelPutWord16(const std::string &channel, word16 value, ByteOrder order, bool blocking)\n{\n\tPutWord(false, order, m_buf, value);\n\treturn ChannelPut(channel, m_buf, 2, blocking);\n}"
  },
  {
    "function_name": "BufferedTransformation::SetRetrievalChannel",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "586-590",
    "snippet": "void BufferedTransformation::SetRetrievalChannel(const std::string &channel)\n{\n\tif (AttachedTransformation())\n\t\tAttachedTransformation()->SetRetrievalChannel(channel);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "channel"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid BufferedTransformation::SetRetrievalChannel(const std::string &channel)\n{\n\tif (AttachedTransformation())\n\t\tAttachedTransformation()->SetRetrievalChannel(channel);\n}"
  },
  {
    "function_name": "BufferedTransformation::CopyAllTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "575-584",
    "snippet": "void BufferedTransformation::CopyAllTo(BufferedTransformation &target, const std::string &channel) const\n{\n\tif (AttachedTransformation())\n\t\tAttachedTransformation()->CopyAllTo(target, channel);\n\telse\n\t{\n\t\tassert(!NumberOfMessageSeries());\n\t\twhile (CopyMessagesTo(target, UINT_MAX, channel)) {}\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CopyMessagesTo",
          "args": [
            "target",
            "UINT_MAX",
            "channel"
          ],
          "line": 582
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::CopyMessagesTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "524-530",
          "snippet": "unsigned int BufferedTransformation::CopyMessagesTo(BufferedTransformation &target, unsigned int count, const std::string &channel) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->CopyMessagesTo(target, count, channel);\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int BufferedTransformation::CopyMessagesTo(BufferedTransformation &target, unsigned int count, const std::string &channel) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->CopyMessagesTo(target, count, channel);\n\telse\n\t\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!NumberOfMessageSeries()"
          ],
          "line": 581
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumberOfMessageSeries",
          "args": [],
          "line": 581
        },
        "resolved": true,
        "details": {
          "function_name": "NumberOfMessageSeries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "951-951",
          "snippet": "virtual unsigned int NumberOfMessageSeries() const {return 0;}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvirtual unsigned int NumberOfMessageSeries() const {return 0;}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "target",
            "channel"
          ],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 578
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 577
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid BufferedTransformation::CopyAllTo(BufferedTransformation &target, const std::string &channel) const\n{\n\tif (AttachedTransformation())\n\t\tAttachedTransformation()->CopyAllTo(target, channel);\n\telse\n\t{\n\t\tassert(!NumberOfMessageSeries());\n\t\twhile (CopyMessagesTo(target, UINT_MAX, channel)) {}\n\t}\n}"
  },
  {
    "function_name": "BufferedTransformation::TransferAllTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "543-573",
    "snippet": "size_t BufferedTransformation::TransferAllTo2(BufferedTransformation &target, const std::string &channel, bool blocking)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->TransferAllTo2(target, channel, blocking);\n\telse\n\t{\n\t\tassert(!NumberOfMessageSeries());\n\n\t\tunsigned int messageCount;\n\t\tdo\n\t\t{\n\t\t\tmessageCount = UINT_MAX;\n\t\t\tsize_t blockedBytes = TransferMessagesTo2(target, messageCount, channel, blocking);\n\t\t\tif (blockedBytes)\n\t\t\t\treturn blockedBytes;\n\t\t}\n\t\twhile (messageCount != 0);\n\n\t\tlword byteCount;\n\t\tdo\n\t\t{\n\t\t\tbyteCount = ULONG_MAX;\n\t\t\tsize_t blockedBytes = TransferTo2(target, byteCount, channel, blocking);\n\t\t\tif (blockedBytes)\n\t\t\t\treturn blockedBytes;\n\t\t}\n\t\twhile (byteCount != 0);\n\n\t\treturn 0;\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TransferTo2",
          "args": [
            "target",
            "byteCount",
            "channel",
            "blocking"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "FileStore::TransferTo2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/files.cpp",
          "lines": "76-113",
          "snippet": "size_t FileStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tif (!m_stream)\n\t{\n\t\ttransferBytes = 0;\n\t\treturn 0;\n\t}\n\n\tlword size=transferBytes;\n\ttransferBytes = 0;\n\n\tif (m_waiting)\n\t\tgoto output;\n\n\twhile (size && m_stream->good())\n\t{\n\t\t{\n\t\tsize_t spaceSize = 1024;\n\t\tm_space = HelpCreatePutSpace(target, channel, 1, UnsignedMin(size_t(0)-1, size), spaceSize);\n\n\t\tm_stream->read((char *)m_space, (unsigned int)STDMIN(size, (lword)spaceSize));\n\t\t}\n\t\tm_len = (size_t)m_stream->gcount();\n\t\tsize_t blockedBytes;\noutput:\n\t\tblockedBytes = target.ChannelPutModifiable2(channel, m_space, m_len, 0, blocking);\n\t\tm_waiting = blockedBytes > 0;\n\t\tif (m_waiting)\n\t\t\treturn blockedBytes;\n\t\tsize -= m_len;\n\t\ttransferBytes += m_len;\n\t}\n\n\tif (!m_stream->good() && !m_stream->eof())\n\t\tthrow ReadErr();\n\n\treturn 0;\n}",
          "includes": [
            "#include <limits>",
            "#include \"files.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits>\n#include \"files.h\"\n#include \"pch.h\"\n\nsize_t FileStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tif (!m_stream)\n\t{\n\t\ttransferBytes = 0;\n\t\treturn 0;\n\t}\n\n\tlword size=transferBytes;\n\ttransferBytes = 0;\n\n\tif (m_waiting)\n\t\tgoto output;\n\n\twhile (size && m_stream->good())\n\t{\n\t\t{\n\t\tsize_t spaceSize = 1024;\n\t\tm_space = HelpCreatePutSpace(target, channel, 1, UnsignedMin(size_t(0)-1, size), spaceSize);\n\n\t\tm_stream->read((char *)m_space, (unsigned int)STDMIN(size, (lword)spaceSize));\n\t\t}\n\t\tm_len = (size_t)m_stream->gcount();\n\t\tsize_t blockedBytes;\noutput:\n\t\tblockedBytes = target.ChannelPutModifiable2(channel, m_space, m_len, 0, blocking);\n\t\tm_waiting = blockedBytes > 0;\n\t\tif (m_waiting)\n\t\t\treturn blockedBytes;\n\t\tsize -= m_len;\n\t\ttransferBytes += m_len;\n\t}\n\n\tif (!m_stream->good() && !m_stream->eof())\n\t\tthrow ReadErr();\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TransferMessagesTo2",
          "args": [
            "target",
            "messageCount",
            "channel",
            "blocking"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::TransferMessagesTo2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "494-522",
          "snippet": "size_t BufferedTransformation::TransferMessagesTo2(BufferedTransformation &target, unsigned int &messageCount, const std::string &channel, bool blocking)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->TransferMessagesTo2(target, messageCount, channel, blocking);\n\telse\n\t{\n\t\tunsigned int maxMessages = messageCount;\n\t\tfor (messageCount=0; messageCount < maxMessages && AnyMessages(); messageCount++)\n\t\t{\n\t\t\tsize_t blockedBytes;\n\t\t\tlword transferredBytes;\n\n\t\t\twhile (AnyRetrievable())\n\t\t\t{\n\t\t\t\ttransferredBytes = LWORD_MAX;\n\t\t\t\tblockedBytes = TransferTo2(target, transferredBytes, channel, blocking);\n\t\t\t\tif (blockedBytes > 0)\n\t\t\t\t\treturn blockedBytes;\n\t\t\t}\n\n\t\t\tif (target.ChannelMessageEnd(channel, GetAutoSignalPropagation(), blocking))\n\t\t\t\treturn 1;\n\n\t\t\tbool result = GetNextMessage();\n\t\t\tassert(result);\n\t\t}\n\t\treturn 0;\n\t}\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::TransferMessagesTo2(BufferedTransformation &target, unsigned int &messageCount, const std::string &channel, bool blocking)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->TransferMessagesTo2(target, messageCount, channel, blocking);\n\telse\n\t{\n\t\tunsigned int maxMessages = messageCount;\n\t\tfor (messageCount=0; messageCount < maxMessages && AnyMessages(); messageCount++)\n\t\t{\n\t\t\tsize_t blockedBytes;\n\t\t\tlword transferredBytes;\n\n\t\t\twhile (AnyRetrievable())\n\t\t\t{\n\t\t\t\ttransferredBytes = LWORD_MAX;\n\t\t\t\tblockedBytes = TransferTo2(target, transferredBytes, channel, blocking);\n\t\t\t\tif (blockedBytes > 0)\n\t\t\t\t\treturn blockedBytes;\n\t\t\t}\n\n\t\t\tif (target.ChannelMessageEnd(channel, GetAutoSignalPropagation(), blocking))\n\t\t\t\treturn 1;\n\n\t\t\tbool result = GetNextMessage();\n\t\t\tassert(result);\n\t\t}\n\t\treturn 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!NumberOfMessageSeries()"
          ],
          "line": 549
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NumberOfMessageSeries",
          "args": [],
          "line": 549
        },
        "resolved": true,
        "details": {
          "function_name": "NumberOfMessageSeries",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "951-951",
          "snippet": "virtual unsigned int NumberOfMessageSeries() const {return 0;}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvirtual unsigned int NumberOfMessageSeries() const {return 0;}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "target",
            "channel",
            "blocking"
          ],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 546
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::TransferAllTo2(BufferedTransformation &target, const std::string &channel, bool blocking)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->TransferAllTo2(target, channel, blocking);\n\telse\n\t{\n\t\tassert(!NumberOfMessageSeries());\n\n\t\tunsigned int messageCount;\n\t\tdo\n\t\t{\n\t\t\tmessageCount = UINT_MAX;\n\t\t\tsize_t blockedBytes = TransferMessagesTo2(target, messageCount, channel, blocking);\n\t\t\tif (blockedBytes)\n\t\t\t\treturn blockedBytes;\n\t\t}\n\t\twhile (messageCount != 0);\n\n\t\tlword byteCount;\n\t\tdo\n\t\t{\n\t\t\tbyteCount = ULONG_MAX;\n\t\t\tsize_t blockedBytes = TransferTo2(target, byteCount, channel, blocking);\n\t\t\tif (blockedBytes)\n\t\t\t\treturn blockedBytes;\n\t\t}\n\t\twhile (byteCount != 0);\n\n\t\treturn 0;\n\t}\n}"
  },
  {
    "function_name": "BufferedTransformation::SkipAll",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "532-541",
    "snippet": "void BufferedTransformation::SkipAll()\n{\n\tif (AttachedTransformation())\n\t\tAttachedTransformation()->SkipAll();\n\telse\n\t{\n\t\twhile (SkipMessages()) {}\n\t\twhile (Skip()) {}\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Skip",
          "args": [],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SkipMessages",
          "args": [],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid BufferedTransformation::SkipAll()\n{\n\tif (AttachedTransformation())\n\t\tAttachedTransformation()->SkipAll();\n\telse\n\t{\n\t\twhile (SkipMessages()) {}\n\t\twhile (Skip()) {}\n\t}\n}"
  },
  {
    "function_name": "BufferedTransformation::CopyMessagesTo",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "524-530",
    "snippet": "unsigned int BufferedTransformation::CopyMessagesTo(BufferedTransformation &target, unsigned int count, const std::string &channel) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->CopyMessagesTo(target, count, channel);\n\telse\n\t\treturn 0;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "target",
            "count",
            "channel"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int BufferedTransformation::CopyMessagesTo(BufferedTransformation &target, unsigned int count, const std::string &channel) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->CopyMessagesTo(target, count, channel);\n\telse\n\t\treturn 0;\n}"
  },
  {
    "function_name": "BufferedTransformation::TransferMessagesTo2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "494-522",
    "snippet": "size_t BufferedTransformation::TransferMessagesTo2(BufferedTransformation &target, unsigned int &messageCount, const std::string &channel, bool blocking)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->TransferMessagesTo2(target, messageCount, channel, blocking);\n\telse\n\t{\n\t\tunsigned int maxMessages = messageCount;\n\t\tfor (messageCount=0; messageCount < maxMessages && AnyMessages(); messageCount++)\n\t\t{\n\t\t\tsize_t blockedBytes;\n\t\t\tlword transferredBytes;\n\n\t\t\twhile (AnyRetrievable())\n\t\t\t{\n\t\t\t\ttransferredBytes = LWORD_MAX;\n\t\t\t\tblockedBytes = TransferTo2(target, transferredBytes, channel, blocking);\n\t\t\t\tif (blockedBytes > 0)\n\t\t\t\t\treturn blockedBytes;\n\t\t\t}\n\n\t\t\tif (target.ChannelMessageEnd(channel, GetAutoSignalPropagation(), blocking))\n\t\t\t\treturn 1;\n\n\t\t\tbool result = GetNextMessage();\n\t\t\tassert(result);\n\t\t}\n\t\treturn 0;\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "result"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetNextMessage",
          "args": [],
          "line": 517
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::GetNextMessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "475-484",
          "snippet": "bool BufferedTransformation::GetNextMessage()\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->GetNextMessage();\n\telse\n\t{\n\t\tassert(!AnyMessages());\n\t\treturn false;\n\t}\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::GetNextMessage()\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->GetNextMessage();\n\telse\n\t{\n\t\tassert(!AnyMessages());\n\t\treturn false;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "target.ChannelMessageEnd",
          "args": [
            "channel",
            "GetAutoSignalPropagation()",
            "blocking"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetAutoSignalPropagation",
          "args": [],
          "line": 514
        },
        "resolved": true,
        "details": {
          "function_name": "GetAutoSignalPropagation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "860-860",
          "snippet": "virtual int GetAutoSignalPropagation() const {return 0;}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvirtual int GetAutoSignalPropagation() const {return 0;}"
        }
      },
      {
        "call_info": {
          "callee": "TransferTo2",
          "args": [
            "target",
            "transferredBytes",
            "channel",
            "blocking"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "FileStore::TransferTo2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/files.cpp",
          "lines": "76-113",
          "snippet": "size_t FileStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tif (!m_stream)\n\t{\n\t\ttransferBytes = 0;\n\t\treturn 0;\n\t}\n\n\tlword size=transferBytes;\n\ttransferBytes = 0;\n\n\tif (m_waiting)\n\t\tgoto output;\n\n\twhile (size && m_stream->good())\n\t{\n\t\t{\n\t\tsize_t spaceSize = 1024;\n\t\tm_space = HelpCreatePutSpace(target, channel, 1, UnsignedMin(size_t(0)-1, size), spaceSize);\n\n\t\tm_stream->read((char *)m_space, (unsigned int)STDMIN(size, (lword)spaceSize));\n\t\t}\n\t\tm_len = (size_t)m_stream->gcount();\n\t\tsize_t blockedBytes;\noutput:\n\t\tblockedBytes = target.ChannelPutModifiable2(channel, m_space, m_len, 0, blocking);\n\t\tm_waiting = blockedBytes > 0;\n\t\tif (m_waiting)\n\t\t\treturn blockedBytes;\n\t\tsize -= m_len;\n\t\ttransferBytes += m_len;\n\t}\n\n\tif (!m_stream->good() && !m_stream->eof())\n\t\tthrow ReadErr();\n\n\treturn 0;\n}",
          "includes": [
            "#include <limits>",
            "#include \"files.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits>\n#include \"files.h\"\n#include \"pch.h\"\n\nsize_t FileStore::TransferTo2(BufferedTransformation &target, lword &transferBytes, const std::string &channel, bool blocking)\n{\n\tif (!m_stream)\n\t{\n\t\ttransferBytes = 0;\n\t\treturn 0;\n\t}\n\n\tlword size=transferBytes;\n\ttransferBytes = 0;\n\n\tif (m_waiting)\n\t\tgoto output;\n\n\twhile (size && m_stream->good())\n\t{\n\t\t{\n\t\tsize_t spaceSize = 1024;\n\t\tm_space = HelpCreatePutSpace(target, channel, 1, UnsignedMin(size_t(0)-1, size), spaceSize);\n\n\t\tm_stream->read((char *)m_space, (unsigned int)STDMIN(size, (lword)spaceSize));\n\t\t}\n\t\tm_len = (size_t)m_stream->gcount();\n\t\tsize_t blockedBytes;\noutput:\n\t\tblockedBytes = target.ChannelPutModifiable2(channel, m_space, m_len, 0, blocking);\n\t\tm_waiting = blockedBytes > 0;\n\t\tif (m_waiting)\n\t\t\treturn blockedBytes;\n\t\tsize -= m_len;\n\t\ttransferBytes += m_len;\n\t}\n\n\tif (!m_stream->good() && !m_stream->eof())\n\t\tthrow ReadErr();\n\n\treturn 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AnyRetrievable",
          "args": [],
          "line": 506
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::AnyRetrievable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "394-403",
          "snippet": "bool BufferedTransformation::AnyRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyRetrievable();\n\telse\n\t{\n\t\tbyte b;\n\t\treturn Peek(b) != 0;\n\t}\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::AnyRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyRetrievable();\n\telse\n\t{\n\t\tbyte b;\n\t\treturn Peek(b) != 0;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AnyMessages",
          "args": [],
          "line": 501
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::AnyMessages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "467-473",
          "snippet": "bool BufferedTransformation::AnyMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyMessages();\n\telse\n\t\treturn NumberOfMessages() != 0;\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::AnyMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyMessages();\n\telse\n\t\treturn NumberOfMessages() != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "target",
            "messageCount",
            "channel",
            "blocking"
          ],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 497
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::TransferMessagesTo2(BufferedTransformation &target, unsigned int &messageCount, const std::string &channel, bool blocking)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->TransferMessagesTo2(target, messageCount, channel, blocking);\n\telse\n\t{\n\t\tunsigned int maxMessages = messageCount;\n\t\tfor (messageCount=0; messageCount < maxMessages && AnyMessages(); messageCount++)\n\t\t{\n\t\t\tsize_t blockedBytes;\n\t\t\tlword transferredBytes;\n\n\t\t\twhile (AnyRetrievable())\n\t\t\t{\n\t\t\t\ttransferredBytes = LWORD_MAX;\n\t\t\t\tblockedBytes = TransferTo2(target, transferredBytes, channel, blocking);\n\t\t\t\tif (blockedBytes > 0)\n\t\t\t\t\treturn blockedBytes;\n\t\t\t}\n\n\t\t\tif (target.ChannelMessageEnd(channel, GetAutoSignalPropagation(), blocking))\n\t\t\t\treturn 1;\n\n\t\t\tbool result = GetNextMessage();\n\t\t\tassert(result);\n\t\t}\n\t\treturn 0;\n\t}\n}"
  },
  {
    "function_name": "BufferedTransformation::SkipMessages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "486-492",
    "snippet": "unsigned int BufferedTransformation::SkipMessages(unsigned int count)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->SkipMessages(count);\n\telse\n\t\treturn TransferMessagesTo(TheBitBucket(), count);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TransferMessagesTo",
          "args": [
            "TheBitBucket()",
            "count"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TheBitBucket",
          "args": [],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "count"
          ],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 489
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 488
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int BufferedTransformation::SkipMessages(unsigned int count)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->SkipMessages(count);\n\telse\n\t\treturn TransferMessagesTo(TheBitBucket(), count);\n}"
  },
  {
    "function_name": "BufferedTransformation::GetNextMessage",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "475-484",
    "snippet": "bool BufferedTransformation::GetNextMessage()\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->GetNextMessage();\n\telse\n\t{\n\t\tassert(!AnyMessages());\n\t\treturn false;\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!AnyMessages()"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AnyMessages",
          "args": [],
          "line": 481
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::AnyMessages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "467-473",
          "snippet": "bool BufferedTransformation::AnyMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyMessages();\n\telse\n\t\treturn NumberOfMessages() != 0;\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::AnyMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyMessages();\n\telse\n\t\treturn NumberOfMessages() != 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 478
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 477
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::GetNextMessage()\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->GetNextMessage();\n\telse\n\t{\n\t\tassert(!AnyMessages());\n\t\treturn false;\n\t}\n}"
  },
  {
    "function_name": "BufferedTransformation::AnyMessages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "467-473",
    "snippet": "bool BufferedTransformation::AnyMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyMessages();\n\telse\n\t\treturn NumberOfMessages() != 0;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NumberOfMessages",
          "args": [],
          "line": 472
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::NumberOfMessages",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "459-465",
          "snippet": "unsigned int BufferedTransformation::NumberOfMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->NumberOfMessages();\n\telse\n\t\treturn CopyMessagesTo(TheBitBucket());\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int BufferedTransformation::NumberOfMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->NumberOfMessages();\n\telse\n\t\treturn CopyMessagesTo(TheBitBucket());\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 470
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 469
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::AnyMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyMessages();\n\telse\n\t\treturn NumberOfMessages() != 0;\n}"
  },
  {
    "function_name": "BufferedTransformation::NumberOfMessages",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "459-465",
    "snippet": "unsigned int BufferedTransformation::NumberOfMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->NumberOfMessages();\n\telse\n\t\treturn CopyMessagesTo(TheBitBucket());\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CopyMessagesTo",
          "args": [
            "TheBitBucket()"
          ],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TheBitBucket",
          "args": [],
          "line": 464
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 462
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 461
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int BufferedTransformation::NumberOfMessages() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->NumberOfMessages();\n\telse\n\t\treturn CopyMessagesTo(TheBitBucket());\n}"
  },
  {
    "function_name": "BufferedTransformation::TotalBytesRetrievable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "451-457",
    "snippet": "lword BufferedTransformation::TotalBytesRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->TotalBytesRetrievable();\n\telse\n\t\treturn MaxRetrievable();\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MaxRetrievable",
          "args": [],
          "line": 456
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::MaxRetrievable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "386-392",
          "snippet": "lword BufferedTransformation::MaxRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->MaxRetrievable();\n\telse\n\t\treturn CopyTo(TheBitBucket());\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nlword BufferedTransformation::MaxRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->MaxRetrievable();\n\telse\n\t\treturn CopyTo(TheBitBucket());\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 454
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 453
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nlword BufferedTransformation::TotalBytesRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->TotalBytesRetrievable();\n\telse\n\t\treturn MaxRetrievable();\n}"
  },
  {
    "function_name": "BufferedTransformation::Skip",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "443-449",
    "snippet": "lword BufferedTransformation::Skip(lword skipMax)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Skip(skipMax);\n\telse\n\t\treturn TransferTo(TheBitBucket(), skipMax);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TransferTo",
          "args": [
            "TheBitBucket()",
            "skipMax"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "TransferTo",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "103-109",
          "snippet": "inline size_t TransferTo(BufferedTransformation &target, lword transferMax, const std::string &channel=DEFAULT_CHANNEL)\n\t{\n\t\tsize_t len = UnsignedMin(m_tail-m_head, transferMax);\n\t\ttarget.ChannelPutModifiable(channel, buf+m_head, len);\n\t\tm_head += len;\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t TransferTo(BufferedTransformation &target, lword transferMax, const std::string &channel=DEFAULT_CHANNEL)\n  \t{\n  \t\tsize_t len = UnsignedMin(m_tail-m_head, transferMax);\n  \t\ttarget.ChannelPutModifiable(channel, buf+m_head, len);\n  \t\tm_head += len;\n  \t\treturn len;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "TheBitBucket",
          "args": [],
          "line": 448
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "skipMax"
          ],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 446
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nlword BufferedTransformation::Skip(lword skipMax)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Skip(skipMax);\n\telse\n\t\treturn TransferTo(TheBitBucket(), skipMax);\n}"
  },
  {
    "function_name": "BufferedTransformation::Peek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "432-441",
    "snippet": "size_t BufferedTransformation::Peek(byte *outString, size_t peekMax) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Peek(outString, peekMax);\n\telse\n\t{\n\t\tArraySink arraySink(outString, peekMax);\n\t\treturn (size_t)CopyTo(arraySink, peekMax);\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CopyTo",
          "args": [
            "arraySink",
            "peekMax"
          ],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "CopyTo",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "74-79",
          "snippet": "inline size_t CopyTo(BufferedTransformation &target, size_t copyMax, const std::string &channel=DEFAULT_CHANNEL) const\n\t{\n\t\tsize_t len = STDMIN(copyMax, m_tail-m_head);\n\t\ttarget.ChannelPut(channel, buf+m_head, len);\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t CopyTo(BufferedTransformation &target, size_t copyMax, const std::string &channel=DEFAULT_CHANNEL) const\n  \t{\n  \t\tsize_t len = STDMIN(copyMax, m_tail-m_head);\n  \t\ttarget.ChannelPut(channel, buf+m_head, len);\n  \t\treturn len;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "outString",
            "peekMax"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::Peek(byte *outString, size_t peekMax) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Peek(outString, peekMax);\n\telse\n\t{\n\t\tArraySink arraySink(outString, peekMax);\n\t\treturn (size_t)CopyTo(arraySink, peekMax);\n\t}\n}"
  },
  {
    "function_name": "BufferedTransformation::Peek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "424-430",
    "snippet": "size_t BufferedTransformation::Peek(byte &outByte) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Peek(outByte);\n\telse\n\t\treturn Peek(&outByte, 1);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Peek",
          "args": [
            "&outByte",
            "1"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "Peek",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "60-65",
          "snippet": "inline size_t Peek(byte *target, size_t copyMax) const\n\t{\n\t\tsize_t len = STDMIN(copyMax, m_tail-m_head);\n\t\tmemcpy(target, buf+m_head, len);\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Peek(byte *target, size_t copyMax) const\n  \t{\n  \t\tsize_t len = STDMIN(copyMax, m_tail-m_head);\n  \t\tmemcpy(target, buf+m_head, len);\n  \t\treturn len;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "outByte"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::Peek(byte &outByte) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Peek(outByte);\n\telse\n\t\treturn Peek(&outByte, 1);\n}"
  },
  {
    "function_name": "BufferedTransformation::Get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "413-422",
    "snippet": "size_t BufferedTransformation::Get(byte *outString, size_t getMax)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Get(outString, getMax);\n\telse\n\t{\n\t\tArraySink arraySink(outString, getMax);\n\t\treturn (size_t)TransferTo(arraySink, getMax);\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TransferTo",
          "args": [
            "arraySink",
            "getMax"
          ],
          "line": 420
        },
        "resolved": true,
        "details": {
          "function_name": "TransferTo",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "103-109",
          "snippet": "inline size_t TransferTo(BufferedTransformation &target, lword transferMax, const std::string &channel=DEFAULT_CHANNEL)\n\t{\n\t\tsize_t len = UnsignedMin(m_tail-m_head, transferMax);\n\t\ttarget.ChannelPutModifiable(channel, buf+m_head, len);\n\t\tm_head += len;\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t TransferTo(BufferedTransformation &target, lword transferMax, const std::string &channel=DEFAULT_CHANNEL)\n  \t{\n  \t\tsize_t len = UnsignedMin(m_tail-m_head, transferMax);\n  \t\ttarget.ChannelPutModifiable(channel, buf+m_head, len);\n  \t\tm_head += len;\n  \t\treturn len;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "outString",
            "getMax"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 415
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::Get(byte *outString, size_t getMax)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Get(outString, getMax);\n\telse\n\t{\n\t\tArraySink arraySink(outString, getMax);\n\t\treturn (size_t)TransferTo(arraySink, getMax);\n\t}\n}"
  },
  {
    "function_name": "BufferedTransformation::Get",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "405-411",
    "snippet": "size_t BufferedTransformation::Get(byte &outByte)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Get(outByte);\n\telse\n\t\treturn Get(&outByte, 1);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Get",
          "args": [
            "&outByte",
            "1"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "GetRoundsAndThrowIfInvalid",
          "container": "FixedBlockSize::FixedRounds::VariableRounds",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "54-59",
          "snippet": "inline unsigned int GetRoundsAndThrowIfInvalid(const NameValuePairs &param, const Algorithm *alg)\n\t{\n\t\tint rounds = param.GetIntValueWithDefault(\"Rounds\", DEFAULT_ROUNDS);\n\t\tThrowIfInvalidRounds(rounds, alg);\n\t\treturn (unsigned int)rounds;\n\t}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nFixedBlockSize {\n  FixedRounds {\n    VariableRounds {\n      inline unsigned int GetRoundsAndThrowIfInvalid(const NameValuePairs &param, const Algorithm *alg)\n      \t{\n      \t\tint rounds = param.GetIntValueWithDefault(\"Rounds\", DEFAULT_ROUNDS);\n      \t\tThrowIfInvalidRounds(rounds, alg);\n      \t\treturn (unsigned int)rounds;\n      \t}\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "outByte"
          ],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 408
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::Get(byte &outByte)\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Get(outByte);\n\telse\n\t\treturn Get(&outByte, 1);\n}"
  },
  {
    "function_name": "BufferedTransformation::AnyRetrievable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "394-403",
    "snippet": "bool BufferedTransformation::AnyRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyRetrievable();\n\telse\n\t{\n\t\tbyte b;\n\t\treturn Peek(b) != 0;\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Peek",
          "args": [
            "b"
          ],
          "line": 401
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::Peek",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "424-430",
          "snippet": "size_t BufferedTransformation::Peek(byte &outByte) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Peek(outByte);\n\telse\n\t\treturn Peek(&outByte, 1);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::Peek(byte &outByte) const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->Peek(outByte);\n\telse\n\t\treturn Peek(&outByte, 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 397
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::AnyRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->AnyRetrievable();\n\telse\n\t{\n\t\tbyte b;\n\t\treturn Peek(b) != 0;\n\t}\n}"
  },
  {
    "function_name": "BufferedTransformation::MaxRetrievable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "386-392",
    "snippet": "lword BufferedTransformation::MaxRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->MaxRetrievable();\n\telse\n\t\treturn CopyTo(TheBitBucket());\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CopyTo",
          "args": [
            "TheBitBucket()"
          ],
          "line": 391
        },
        "resolved": true,
        "details": {
          "function_name": "CopyTo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "907-908",
          "snippet": "lword CopyTo(BufferedTransformation &target, lword copyMax=LWORD_MAX, const std::string &channel=DEFAULT_CHANNEL) const\n\t\t\t{return CopyRangeTo(target, 0, copyMax, channel);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nlword CopyTo(BufferedTransformation &target, lword copyMax=LWORD_MAX, const std::string &channel=DEFAULT_CHANNEL) const\n\t\t\t{return CopyRangeTo(target, 0, copyMax, channel);}"
        }
      },
      {
        "call_info": {
          "callee": "TheBitBucket",
          "args": [],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 388
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nlword BufferedTransformation::MaxRetrievable() const\n{\n\tif (AttachedTransformation())\n\t\treturn AttachedTransformation()->MaxRetrievable();\n\telse\n\t\treturn CopyTo(TheBitBucket());\n}"
  },
  {
    "function_name": "BufferedTransformation::ChannelMessageSeriesEnd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "378-384",
    "snippet": "bool BufferedTransformation::ChannelMessageSeriesEnd(const std::string &channel, int propagation, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn MessageSeriesEnd(propagation, blocking);\n\telse\n\t\tthrow NoChannelSupport(AlgorithmName());\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NoChannelSupport",
          "args": [
            "AlgorithmName()"
          ],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "NoChannelSupport",
          "container": "NoChannelSupport",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "969-969",
          "snippet": "NoChannelSupport(const std::string &name) : NotImplemented(name + \": this object doesn't support multiple channels\") {}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nNoChannelSupport {\n  NoChannelSupport(const std::string &name) : NotImplemented(name + \": this object doesn't support multiple channels\") {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AlgorithmName",
          "args": [],
          "line": 383
        },
        "resolved": true,
        "details": {
          "function_name": "AlgorithmName",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "291-291",
          "snippet": "std::string AlgorithmName() const {return \"NullRNG\";}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  std::string AlgorithmName() const {return \"NullRNG\";}\n}"
        }
      },
      {
        "call_info": {
          "callee": "MessageSeriesEnd",
          "args": [
            "propagation",
            "blocking"
          ],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::MessageSeriesEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "340-344",
          "snippet": "bool BufferedTransformation::MessageSeriesEnd(int propagation, bool blocking)\n{\n\tassert(!AttachedTransformation());\n\treturn IsolatedMessageSeriesEnd(blocking);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::MessageSeriesEnd(int propagation, bool blocking)\n{\n\tassert(!AttachedTransformation());\n\treturn IsolatedMessageSeriesEnd(blocking);\n}"
        }
      },
      {
        "call_info": {
          "callee": "channel.empty",
          "args": [],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::ChannelMessageSeriesEnd(const std::string &channel, int propagation, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn MessageSeriesEnd(propagation, blocking);\n\telse\n\t\tthrow NoChannelSupport(AlgorithmName());\n}"
  },
  {
    "function_name": "BufferedTransformation::ChannelFlush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "370-376",
    "snippet": "bool BufferedTransformation::ChannelFlush(const std::string &channel, bool completeFlush, int propagation, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn Flush(completeFlush, propagation, blocking);\n\telse\n\t\tthrow NoChannelSupport(AlgorithmName());\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NoChannelSupport",
          "args": [
            "AlgorithmName()"
          ],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "NoChannelSupport",
          "container": "NoChannelSupport",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "969-969",
          "snippet": "NoChannelSupport(const std::string &name) : NotImplemented(name + \": this object doesn't support multiple channels\") {}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nNoChannelSupport {\n  NoChannelSupport(const std::string &name) : NotImplemented(name + \": this object doesn't support multiple channels\") {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AlgorithmName",
          "args": [],
          "line": 375
        },
        "resolved": true,
        "details": {
          "function_name": "AlgorithmName",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "291-291",
          "snippet": "std::string AlgorithmName() const {return \"NullRNG\";}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  std::string AlgorithmName() const {return \"NullRNG\";}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Flush",
          "args": [
            "completeFlush",
            "propagation",
            "blocking"
          ],
          "line": 373
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::Flush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "334-338",
          "snippet": "bool BufferedTransformation::Flush(bool hardFlush, int propagation, bool blocking)\n{\n\tassert(!AttachedTransformation());\n\treturn IsolatedFlush(hardFlush, blocking);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::Flush(bool hardFlush, int propagation, bool blocking)\n{\n\tassert(!AttachedTransformation());\n\treturn IsolatedFlush(hardFlush, blocking);\n}"
        }
      },
      {
        "call_info": {
          "callee": "channel.empty",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::ChannelFlush(const std::string &channel, bool completeFlush, int propagation, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn Flush(completeFlush, propagation, blocking);\n\telse\n\t\tthrow NoChannelSupport(AlgorithmName());\n}"
  },
  {
    "function_name": "BufferedTransformation::ChannelPutModifiable2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "362-368",
    "snippet": "size_t BufferedTransformation::ChannelPutModifiable2(const std::string &channel, byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn PutModifiable2(begin, length, messageEnd, blocking);\n\telse\n\t\treturn ChannelPut2(channel, begin, length, messageEnd, blocking);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ChannelPut2",
          "args": [
            "channel",
            "begin",
            "length",
            "messageEnd",
            "blocking"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "BufferedTransformation::ChannelPut2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "354-360",
          "snippet": "size_t BufferedTransformation::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn Put2(begin, length, messageEnd, blocking);\n\telse\n\t\tthrow NoChannelSupport(AlgorithmName());\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn Put2(begin, length, messageEnd, blocking);\n\telse\n\t\tthrow NoChannelSupport(AlgorithmName());\n}"
        }
      },
      {
        "call_info": {
          "callee": "PutModifiable2",
          "args": [
            "begin",
            "length",
            "messageEnd",
            "blocking"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "PutModifiable2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "817-818",
          "snippet": "virtual size_t PutModifiable2(byte *inString, size_t length, int messageEnd, bool blocking)\n\t\t\t{return Put2(inString, length, messageEnd, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvirtual size_t PutModifiable2(byte *inString, size_t length, int messageEnd, bool blocking)\n\t\t\t{return Put2(inString, length, messageEnd, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "channel.empty",
          "args": [],
          "line": 364
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::ChannelPutModifiable2(const std::string &channel, byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn PutModifiable2(begin, length, messageEnd, blocking);\n\telse\n\t\treturn ChannelPut2(channel, begin, length, messageEnd, blocking);\n}"
  },
  {
    "function_name": "BufferedTransformation::ChannelPut2",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "354-360",
    "snippet": "size_t BufferedTransformation::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn Put2(begin, length, messageEnd, blocking);\n\telse\n\t\tthrow NoChannelSupport(AlgorithmName());\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NoChannelSupport",
          "args": [
            "AlgorithmName()"
          ],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "NoChannelSupport",
          "container": "NoChannelSupport",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "969-969",
          "snippet": "NoChannelSupport(const std::string &name) : NotImplemented(name + \": this object doesn't support multiple channels\") {}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nNoChannelSupport {\n  NoChannelSupport(const std::string &name) : NotImplemented(name + \": this object doesn't support multiple channels\") {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AlgorithmName",
          "args": [],
          "line": 359
        },
        "resolved": true,
        "details": {
          "function_name": "AlgorithmName",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "291-291",
          "snippet": "std::string AlgorithmName() const {return \"NullRNG\";}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  std::string AlgorithmName() const {return \"NullRNG\";}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Put2",
          "args": [
            "begin",
            "length",
            "messageEnd",
            "blocking"
          ],
          "line": 357
        },
        "resolved": true,
        "details": {
          "function_name": "Put2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/simple.h",
          "lines": "203-204",
          "snippet": "size_t Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n\t\t{return 0;}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"cryptlib.h\"\n\nsize_t Put2(const byte *begin, size_t length, int messageEnd, bool blocking)\n\t\t{return 0;}"
        }
      },
      {
        "call_info": {
          "callee": "channel.empty",
          "args": [],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BufferedTransformation::ChannelPut2(const std::string &channel, const byte *begin, size_t length, int messageEnd, bool blocking)\n{\n\tif (channel.empty())\n\t\treturn Put2(begin, length, messageEnd, blocking);\n\telse\n\t\tthrow NoChannelSupport(AlgorithmName());\n}"
  },
  {
    "function_name": "BufferedTransformation::MessageSeriesEnd",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "340-344",
    "snippet": "bool BufferedTransformation::MessageSeriesEnd(int propagation, bool blocking)\n{\n\tassert(!AttachedTransformation());\n\treturn IsolatedMessageSeriesEnd(blocking);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsolatedMessageSeriesEnd",
          "args": [
            "blocking"
          ],
          "line": 343
        },
        "resolved": true,
        "details": {
          "function_name": "IsolatedMessageSeriesEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "835-835",
          "snippet": "virtual bool IsolatedMessageSeriesEnd(bool blocking) {return false;}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvirtual bool IsolatedMessageSeriesEnd(bool blocking) {return false;}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!AttachedTransformation()"
          ],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 342
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::MessageSeriesEnd(int propagation, bool blocking)\n{\n\tassert(!AttachedTransformation());\n\treturn IsolatedMessageSeriesEnd(blocking);\n}"
  },
  {
    "function_name": "BufferedTransformation::Flush",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "334-338",
    "snippet": "bool BufferedTransformation::Flush(bool hardFlush, int propagation, bool blocking)\n{\n\tassert(!AttachedTransformation());\n\treturn IsolatedFlush(hardFlush, blocking);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsolatedFlush",
          "args": [
            "hardFlush",
            "blocking"
          ],
          "line": 337
        },
        "resolved": true,
        "details": {
          "function_name": "FileSink::IsolatedFlush",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/files.cpp",
          "lines": "221-231",
          "snippet": "bool FileSink::IsolatedFlush(bool hardFlush, bool blocking)\n{\n\tif (!m_stream)\n\t\tthrow Err(\"FileSink: output stream not opened\");\n\n\tm_stream->flush();\n\tif (!m_stream->good())\n\t\tthrow WriteErr();\n\n\treturn false;\n}",
          "includes": [
            "#include <limits>",
            "#include \"files.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits>\n#include \"files.h\"\n#include \"pch.h\"\n\nbool FileSink::IsolatedFlush(bool hardFlush, bool blocking)\n{\n\tif (!m_stream)\n\t\tthrow Err(\"FileSink: output stream not opened\");\n\n\tm_stream->flush();\n\tif (!m_stream->good())\n\t\tthrow WriteErr();\n\n\treturn false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!AttachedTransformation()"
          ],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 336
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool BufferedTransformation::Flush(bool hardFlush, int propagation, bool blocking)\n{\n\tassert(!AttachedTransformation());\n\treturn IsolatedFlush(hardFlush, blocking);\n}"
  },
  {
    "function_name": "BufferedTransformation::Initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "328-332",
    "snippet": "void BufferedTransformation::Initialize(const NameValuePairs &parameters, int propagation)\n{\n\tassert(!AttachedTransformation());\n\tIsolatedInitialize(parameters);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IsolatedInitialize",
          "args": [
            "parameters"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "IsolatedInitialize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "833-833",
          "snippet": "virtual void IsolatedInitialize(const NameValuePairs &parameters) {throw NotImplemented(\"BufferedTransformation: this object can't be reinitialized\");}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvirtual void IsolatedInitialize(const NameValuePairs &parameters) {throw NotImplemented(\"BufferedTransformation: this object can't be reinitialized\");}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!AttachedTransformation()"
          ],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 330
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid BufferedTransformation::Initialize(const NameValuePairs &parameters, int propagation)\n{\n\tassert(!AttachedTransformation());\n\tIsolatedInitialize(parameters);\n}"
  },
  {
    "function_name": "BufferedTransformation::GetWaitObjects",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "321-326",
    "snippet": "void BufferedTransformation::GetWaitObjects(WaitObjectContainer &container, CallStack const& callStack)\n{\n\tBufferedTransformation *t = AttachedTransformation();\n\tif (t)\n\t\tt->GetWaitObjects(container, callStack);  // reduce clutter by not adding to stack here\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "t->GetWaitObjects",
          "args": [
            "container",
            "callStack"
          ],
          "line": 325
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid BufferedTransformation::GetWaitObjects(WaitObjectContainer &container, CallStack const& callStack)\n{\n\tBufferedTransformation *t = AttachedTransformation();\n\tif (t)\n\t\tt->GetWaitObjects(container, callStack);  // reduce clutter by not adding to stack here\n}"
  },
  {
    "function_name": "BufferedTransformation::GetMaxWaitObjectCount",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "315-319",
    "snippet": "unsigned int BufferedTransformation::GetMaxWaitObjectCount() const\n{\n\tconst BufferedTransformation *t = AttachedTransformation();\n\treturn t ? t->GetMaxWaitObjectCount() : 0;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "t->GetMaxWaitObjectCount",
          "args": [],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "GetMaxWaitObjectCount",
          "container": "LimitedBandwidth",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/network.h",
          "lines": "38-38",
          "snippet": "unsigned int GetMaxWaitObjectCount() const { return 0; }",
          "includes": [
            "#include <deque>",
            "#include \"hrtimer.h\"",
            "#include \"filters.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include \"hrtimer.h\"\n#include \"filters.h\"\n#include \"config.h\"\n\nLimitedBandwidth {\n  unsigned int GetMaxWaitObjectCount() const { return 0; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 317
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int BufferedTransformation::GetMaxWaitObjectCount() const\n{\n\tconst BufferedTransformation *t = AttachedTransformation();\n\treturn t ? t->GetMaxWaitObjectCount() : 0;\n}"
  },
  {
    "function_name": "HashTransformation::ThrowIfInvalidTruncatedSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "309-313",
    "snippet": "void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\""
          ],
          "line": 312
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "size"
          ],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "IntToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "409-429",
          "snippet": "std::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nstd::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DigestSize",
          "args": [],
          "line": 312
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}"
  },
  {
    "function_name": "HashTransformation::TruncatedVerify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "301-307",
    "snippet": "bool HashTransformation::TruncatedVerify(const byte *digestIn, size_t digestLength)\n{\n\tThrowIfInvalidTruncatedSize(digestLength);\n\tSecByteBlock digest(digestLength);\n\tTruncatedFinal(digest, digestLength);\n\treturn VerifyBufsEqual(digest, digestIn, digestLength);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VerifyBufsEqual",
          "args": [
            "digest",
            "digestIn",
            "digestLength"
          ],
          "line": 306
        },
        "resolved": true,
        "details": {
          "function_name": "VerifyBufsEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.cpp",
          "lines": "79-113",
          "snippet": "bool VerifyBufsEqual(const byte *buf, const byte *mask, size_t count)\n{\n\tsize_t i;\n\tbyte acc8 = 0;\n\n\tif (IsAligned<word32>(buf) && IsAligned<word32>(mask))\n\t{\n\t\tword32 acc32 = 0;\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(buf) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tword64 acc64 = 0;\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\tacc64 |= ((word64*)buf)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn acc64 == 0;\n\t\t\tbuf += 8*i;\n\t\t\tmask += 8*i;\n\t\t\tacc32 = word32(acc64) | word32(acc64>>32);\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\tacc32 |= ((word32*)buf)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn acc32 == 0;\n\t\tbuf += 4*i;\n\t\tmask += 4*i;\n\t\tacc8 = byte(acc32) | byte(acc32>>8) | byte(acc32>>16) | byte(acc32>>24);\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\tacc8 |= buf[i] ^ mask[i];\n\treturn acc8 == 0;\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <new>",
            "#include \"words.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <new>\n#include \"words.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nbool VerifyBufsEqual(const byte *buf, const byte *mask, size_t count)\n{\n\tsize_t i;\n\tbyte acc8 = 0;\n\n\tif (IsAligned<word32>(buf) && IsAligned<word32>(mask))\n\t{\n\t\tword32 acc32 = 0;\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(buf) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tword64 acc64 = 0;\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\tacc64 |= ((word64*)buf)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn acc64 == 0;\n\t\t\tbuf += 8*i;\n\t\t\tmask += 8*i;\n\t\t\tacc32 = word32(acc64) | word32(acc64>>32);\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\tacc32 |= ((word32*)buf)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn acc32 == 0;\n\t\tbuf += 4*i;\n\t\tmask += 4*i;\n\t\tacc8 = byte(acc32) | byte(acc32>>8) | byte(acc32>>16) | byte(acc32>>24);\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\tacc8 |= buf[i] ^ mask[i];\n\treturn acc8 == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "TruncatedFinal",
          "args": [
            "digest",
            "digestLength"
          ],
          "line": 305
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedFinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "1341-1342",
          "snippet": "void TruncatedFinal(byte *digest, size_t digestSize) \n\t\t{throw NotImplemented(\"PK_MessageAccumulator: TruncatedFinal() should not be called\");}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvoid TruncatedFinal(byte *digest, size_t digestSize) \n\t\t{throw NotImplemented(\"PK_MessageAccumulator: TruncatedFinal() should not be called\");}"
        }
      },
      {
        "call_info": {
          "callee": "ThrowIfInvalidTruncatedSize",
          "args": [
            "digestLength"
          ],
          "line": 303
        },
        "resolved": true,
        "details": {
          "function_name": "HashTransformation::ThrowIfInvalidTruncatedSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "309-313",
          "snippet": "void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool HashTransformation::TruncatedVerify(const byte *digestIn, size_t digestLength)\n{\n\tThrowIfInvalidTruncatedSize(digestLength);\n\tSecByteBlock digest(digestLength);\n\tTruncatedFinal(digest, digestLength);\n\treturn VerifyBufsEqual(digest, digestIn, digestLength);\n}"
  },
  {
    "function_name": "GenerateBlock",
    "container": "ClassNullRNG",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "292-292",
    "snippet": "void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NotImplemented",
          "args": [
            "\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\""
          ],
          "line": 292
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}\n}"
  },
  {
    "function_name": "AlgorithmName",
    "container": "ClassNullRNG",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "291-291",
    "snippet": "std::string AlgorithmName() const {return \"NullRNG\";}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  std::string AlgorithmName() const {return \"NullRNG\";}\n}"
  },
  {
    "function_name": "RandomNumberGenerator::GenerateIntoBufferedTransformation",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "275-285",
    "snippet": "void RandomNumberGenerator::GenerateIntoBufferedTransformation(BufferedTransformation &target, const std::string &channel, lword length)\n{\n\tFixedSizeSecBlock<byte, 256> buffer;\n\twhile (length)\n\t{\n\t\tsize_t len = UnsignedMin(buffer.size(), length);\n\t\tGenerateBlock(buffer, len);\n\t\ttarget.ChannelPut(channel, buffer, len);\n\t\tlength -= len;\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "target.ChannelPut",
          "args": [
            "channel",
            "buffer",
            "len"
          ],
          "line": 282
        },
        "resolved": true,
        "details": {
          "function_name": "ChannelPut",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "975-976",
          "snippet": "size_t ChannelPut(const std::string &channel, const byte *inString, size_t length, bool blocking=true)\n\t\t\t{return ChannelPut2(channel, inString, length, 0, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t ChannelPut(const std::string &channel, const byte *inString, size_t length, bool blocking=true)\n\t\t\t{return ChannelPut2(channel, inString, length, 0, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "GenerateBlock",
          "args": [
            "buffer",
            "len"
          ],
          "line": 281
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateBlock",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "292-292",
          "snippet": "void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}\n}"
        }
      },
      {
        "call_info": {
          "callee": "UnsignedMin",
          "args": [
            "buffer.size()",
            "length"
          ],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "UnsignedMin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "182-192",
          "snippet": "inline const T1 UnsignedMin(const T1& a, const T2& b)\n{\n\tCRYPTOPP_COMPILE_ASSERT((sizeof(T1)<=sizeof(T2) && T2(-1)>0) || (sizeof(T1)>sizeof(T2) && T1(-1)>0));\n\tassert(a==0 || a>0);\t// GCC workaround: get rid of the warning \"comparison is always true due to limited range of data type\"\n\tassert(b>=0);\n\n\tif (sizeof(T1)<=sizeof(T2))\n\t\treturn b < (T2)a ? (T1)b : a;\n\telse\n\t\treturn (T1)b < a ? (T1)b : a;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline const T1 UnsignedMin(const T1& a, const T2& b)\n{\n\tCRYPTOPP_COMPILE_ASSERT((sizeof(T1)<=sizeof(T2) && T2(-1)>0) || (sizeof(T1)>sizeof(T2) && T1(-1)>0));\n\tassert(a==0 || a>0);\t// GCC workaround: get rid of the warning \"comparison is always true due to limited range of data type\"\n\tassert(b>=0);\n\n\tif (sizeof(T1)<=sizeof(T2))\n\t\treturn b < (T2)a ? (T1)b : a;\n\telse\n\t\treturn (T1)b < a ? (T1)b : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer.size",
          "args": [],
          "line": 280
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid RandomNumberGenerator::GenerateIntoBufferedTransformation(BufferedTransformation &target, const std::string &channel, lword length)\n{\n\tFixedSizeSecBlock<byte, 256> buffer;\n\twhile (length)\n\t{\n\t\tsize_t len = UnsignedMin(buffer.size(), length);\n\t\tGenerateBlock(buffer, len);\n\t\ttarget.ChannelPut(channel, buffer, len);\n\t\tlength -= len;\n\t}\n}"
  },
  {
    "function_name": "RandomNumberGenerator::DiscardBytes",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "270-273",
    "snippet": "void RandomNumberGenerator::DiscardBytes(size_t n)\n{\n\tGenerateIntoBufferedTransformation(TheBitBucket(), DEFAULT_CHANNEL, n);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateIntoBufferedTransformation",
          "args": [
            "TheBitBucket()",
            "DEFAULT_CHANNEL",
            "n"
          ],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "RandomNumberGenerator::GenerateIntoBufferedTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "275-285",
          "snippet": "void RandomNumberGenerator::GenerateIntoBufferedTransformation(BufferedTransformation &target, const std::string &channel, lword length)\n{\n\tFixedSizeSecBlock<byte, 256> buffer;\n\twhile (length)\n\t{\n\t\tsize_t len = UnsignedMin(buffer.size(), length);\n\t\tGenerateBlock(buffer, len);\n\t\ttarget.ChannelPut(channel, buffer, len);\n\t\tlength -= len;\n\t}\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid RandomNumberGenerator::GenerateIntoBufferedTransformation(BufferedTransformation &target, const std::string &channel, lword length)\n{\n\tFixedSizeSecBlock<byte, 256> buffer;\n\twhile (length)\n\t{\n\t\tsize_t len = UnsignedMin(buffer.size(), length);\n\t\tGenerateBlock(buffer, len);\n\t\ttarget.ChannelPut(channel, buffer, len);\n\t\tlength -= len;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "TheBitBucket",
          "args": [],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid RandomNumberGenerator::DiscardBytes(size_t n)\n{\n\tGenerateIntoBufferedTransformation(TheBitBucket(), DEFAULT_CHANNEL, n);\n}"
  },
  {
    "function_name": "RandomNumberGenerator::GenerateBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "264-268",
    "snippet": "void RandomNumberGenerator::GenerateBlock(byte *output, size_t size)\n{\n\tArraySink s(output, size);\n\tGenerateIntoBufferedTransformation(s, DEFAULT_CHANNEL, size);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateIntoBufferedTransformation",
          "args": [
            "s",
            "DEFAULT_CHANNEL",
            "size"
          ],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "RandomNumberGenerator::GenerateIntoBufferedTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "275-285",
          "snippet": "void RandomNumberGenerator::GenerateIntoBufferedTransformation(BufferedTransformation &target, const std::string &channel, lword length)\n{\n\tFixedSizeSecBlock<byte, 256> buffer;\n\twhile (length)\n\t{\n\t\tsize_t len = UnsignedMin(buffer.size(), length);\n\t\tGenerateBlock(buffer, len);\n\t\ttarget.ChannelPut(channel, buffer, len);\n\t\tlength -= len;\n\t}\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid RandomNumberGenerator::GenerateIntoBufferedTransformation(BufferedTransformation &target, const std::string &channel, lword length)\n{\n\tFixedSizeSecBlock<byte, 256> buffer;\n\twhile (length)\n\t{\n\t\tsize_t len = UnsignedMin(buffer.size(), length);\n\t\tGenerateBlock(buffer, len);\n\t\ttarget.ChannelPut(channel, buffer, len);\n\t\tlength -= len;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid RandomNumberGenerator::GenerateBlock(byte *output, size_t size)\n{\n\tArraySink s(output, size);\n\tGenerateIntoBufferedTransformation(s, DEFAULT_CHANNEL, size);\n}"
  },
  {
    "function_name": "RandomNumberGenerator::GenerateWord32",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "248-262",
    "snippet": "word32 RandomNumberGenerator::GenerateWord32(word32 min, word32 max)\n{\n\tword32 range = max-min;\n\tconst int maxBits = BitPrecision(range);\n\n\tword32 value;\n\n\tdo\n\t{\n\t\tGenerateBlock((byte *)&value, sizeof(value));\n\t\tvalue = Crop(value, maxBits);\n\t} while (value > range);\n\n\treturn value+min;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Crop",
          "args": [
            "value",
            "maxBits"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "Crop",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "290-296",
          "snippet": "inline T Crop(T value, size_t size)\n{\n\tif (size < 8*sizeof(value))\n    \treturn T(value & ((T(1) << size) - 1));\n\telse\n\t\treturn value;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T Crop(T value, size_t size)\n{\n\tif (size < 8*sizeof(value))\n    \treturn T(value & ((T(1) << size) - 1));\n\telse\n\t\treturn value;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GenerateBlock",
          "args": [
            "(byte *)&value",
            "sizeof(value)"
          ],
          "line": 257
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateBlock",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "292-292",
          "snippet": "void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitPrecision",
          "args": [
            "range"
          ],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "BitPrecision",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "238-255",
          "snippet": "unsigned int BitPrecision(const T &value)\n{\n\tif (!value)\n\t\treturn 0;\n\n\tunsigned int l=0, h=8*sizeof(value);\n\n\twhile (h-l > 1)\n\t{\n\t\tunsigned int t = (l+h)/2;\n\t\tif (value >> t)\n\t\t\tl = t;\n\t\telse\n\t\t\th = t;\n\t}\n\n\treturn h;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nunsigned int BitPrecision(const T &value)\n{\n\tif (!value)\n\t\treturn 0;\n\n\tunsigned int l=0, h=8*sizeof(value);\n\n\twhile (h-l > 1)\n\t{\n\t\tunsigned int t = (l+h)/2;\n\t\tif (value >> t)\n\t\t\tl = t;\n\t\telse\n\t\t\th = t;\n\t}\n\n\treturn h;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nword32 RandomNumberGenerator::GenerateWord32(word32 min, word32 max)\n{\n\tword32 range = max-min;\n\tconst int maxBits = BitPrecision(range);\n\n\tword32 value;\n\n\tdo\n\t{\n\t\tGenerateBlock((byte *)&value, sizeof(value));\n\t\tvalue = Crop(value, maxBits);\n\t} while (value > range);\n\n\treturn value+min;\n}"
  },
  {
    "function_name": "RandomNumberGenerator::GenerateByte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "241-246",
    "snippet": "byte RandomNumberGenerator::GenerateByte()\n{\n\tbyte b;\n\tGenerateBlock(&b, 1);\n\treturn b;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateBlock",
          "args": [
            "&b",
            "1"
          ],
          "line": 244
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateBlock",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "292-292",
          "snippet": "void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbyte RandomNumberGenerator::GenerateByte()\n{\n\tbyte b;\n\tGenerateBlock(&b, 1);\n\treturn b;\n}"
  },
  {
    "function_name": "RandomNumberGenerator::GenerateBit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "236-239",
    "snippet": "unsigned int RandomNumberGenerator::GenerateBit()\n{\n\treturn GenerateByte() & 1;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateByte",
          "args": [],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "RandomNumberGenerator::GenerateByte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "241-246",
          "snippet": "byte RandomNumberGenerator::GenerateByte()\n{\n\tbyte b;\n\tGenerateBlock(&b, 1);\n\treturn b;\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbyte RandomNumberGenerator::GenerateByte()\n{\n\tbyte b;\n\tGenerateBlock(&b, 1);\n\treturn b;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int RandomNumberGenerator::GenerateBit()\n{\n\treturn GenerateByte() & 1;\n}"
  },
  {
    "function_name": "AuthenticatedSymmetricCipher::DecryptAndVerify",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "227-234",
    "snippet": "bool AuthenticatedSymmetricCipher::DecryptAndVerify(byte *message, const byte *mac, size_t macLength, const byte *iv, int ivLength, const byte *header, size_t headerLength, const byte *ciphertext, size_t ciphertextLength)\n{\n\tResynchronize(iv, ivLength);\n\tSpecifyDataLengths(headerLength, ciphertextLength);\n\tUpdate(header, headerLength);\n\tProcessString(message, ciphertext, ciphertextLength);\n\treturn TruncatedVerify(mac, macLength);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TruncatedVerify",
          "args": [
            "mac",
            "macLength"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedVerify",
          "container": "TruncatedHashTemplate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/trunhash.h",
          "lines": "36-37",
          "snippet": "bool TruncatedVerify(const byte *digest, size_t digestLength)\n\t\t{return m_hm.TruncatedVerify(digest, digestLength);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nTruncatedHashTemplate {\n  bool TruncatedVerify(const byte *digest, size_t digestLength)\n  \t\t{return m_hm.TruncatedVerify(digest, digestLength);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ProcessString",
          "args": [
            "message",
            "ciphertext",
            "ciphertextLength"
          ],
          "line": 232
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Update",
          "args": [
            "header",
            "headerLength"
          ],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "Adler32::Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/adler32.cpp",
          "lines": "8-54",
          "snippet": "void Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}",
          "includes": [
            "#include \"adler32.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"adler32.h\"\n#include \"pch.h\"\n\nvoid Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SpecifyDataLengths",
          "args": [
            "headerLength",
            "ciphertextLength"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Resynchronize",
          "args": [
            "iv",
            "ivLength"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "VMAC_Base::Resynchronize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/vmac.cpp",
          "lines": "99-131",
          "snippet": "void VMAC_Base::Resynchronize(const byte *nonce, int len)\n{\n\tsize_t length = ThrowIfInvalidIVLength(len);\n\tsize_t s = IVSize();\n\tbyte *storedNonce = m_nonce();\n\n\tif (m_is128)\n\t{\n\t\tmemset(storedNonce, 0, s-length);\n\t\tmemcpy(storedNonce+s-length, nonce, length);\n\t\tAccessCipher().ProcessBlock(storedNonce, m_pad());\n\t}\n\telse\n\t{\n\t\tif (m_padCached && (storedNonce[s-1] | 1) == (nonce[length-1] | 1))\n\t\t{\n\t\t\tm_padCached = VerifyBufsEqual(storedNonce+s-length, nonce, length-1);\n\t\t\tfor (size_t i=0; m_padCached && i<s-length; i++)\n\t\t\t\tm_padCached = (storedNonce[i] == 0);\n\t\t}\n\t\tif (!m_padCached)\n\t\t{\n\t\t\tmemset(storedNonce, 0, s-length);\n\t\t\tmemcpy(storedNonce+s-length, nonce, length-1);\n\t\t\tstoredNonce[s-1] = nonce[length-1] & 0xfe;\n\t\t\tAccessCipher().ProcessBlock(storedNonce, m_pad());\n\t\t\tm_padCached = true;\n\t\t}\n\t\tstoredNonce[s-1] = nonce[length-1];\n\t}\n\tm_isFirstBlock = true;\n\tRestart();\n}",
          "includes": [
            "#include <intrin.h>",
            "#include \"cpu.h\"",
            "#include \"argnames.h\"",
            "#include \"vmac.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [
            "#define const\t// Turbo C++ 2006 workaround"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <intrin.h>\n#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"vmac.h\"\n#include \"pch.h\"\n\n#define const\t// Turbo C++ 2006 workaround\n\nvoid VMAC_Base::Resynchronize(const byte *nonce, int len)\n{\n\tsize_t length = ThrowIfInvalidIVLength(len);\n\tsize_t s = IVSize();\n\tbyte *storedNonce = m_nonce();\n\n\tif (m_is128)\n\t{\n\t\tmemset(storedNonce, 0, s-length);\n\t\tmemcpy(storedNonce+s-length, nonce, length);\n\t\tAccessCipher().ProcessBlock(storedNonce, m_pad());\n\t}\n\telse\n\t{\n\t\tif (m_padCached && (storedNonce[s-1] | 1) == (nonce[length-1] | 1))\n\t\t{\n\t\t\tm_padCached = VerifyBufsEqual(storedNonce+s-length, nonce, length-1);\n\t\t\tfor (size_t i=0; m_padCached && i<s-length; i++)\n\t\t\t\tm_padCached = (storedNonce[i] == 0);\n\t\t}\n\t\tif (!m_padCached)\n\t\t{\n\t\t\tmemset(storedNonce, 0, s-length);\n\t\t\tmemcpy(storedNonce+s-length, nonce, length-1);\n\t\t\tstoredNonce[s-1] = nonce[length-1] & 0xfe;\n\t\t\tAccessCipher().ProcessBlock(storedNonce, m_pad());\n\t\t\tm_padCached = true;\n\t\t}\n\t\tstoredNonce[s-1] = nonce[length-1];\n\t}\n\tm_isFirstBlock = true;\n\tRestart();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nbool AuthenticatedSymmetricCipher::DecryptAndVerify(byte *message, const byte *mac, size_t macLength, const byte *iv, int ivLength, const byte *header, size_t headerLength, const byte *ciphertext, size_t ciphertextLength)\n{\n\tResynchronize(iv, ivLength);\n\tSpecifyDataLengths(headerLength, ciphertextLength);\n\tUpdate(header, headerLength);\n\tProcessString(message, ciphertext, ciphertextLength);\n\treturn TruncatedVerify(mac, macLength);\n}"
  },
  {
    "function_name": "AuthenticatedSymmetricCipher::EncryptAndAuthenticate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "218-225",
    "snippet": "void AuthenticatedSymmetricCipher::EncryptAndAuthenticate(byte *ciphertext, byte *mac, size_t macSize, const byte *iv, int ivLength, const byte *header, size_t headerLength, const byte *message, size_t messageLength)\n{\n\tResynchronize(iv, ivLength);\n\tSpecifyDataLengths(headerLength, messageLength);\n\tUpdate(header, headerLength);\n\tProcessString(ciphertext, message, messageLength);\n\tTruncatedFinal(mac, macSize);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TruncatedFinal",
          "args": [
            "mac",
            "macSize"
          ],
          "line": 224
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedFinal",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "1341-1342",
          "snippet": "void TruncatedFinal(byte *digest, size_t digestSize) \n\t\t{throw NotImplemented(\"PK_MessageAccumulator: TruncatedFinal() should not be called\");}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nvoid TruncatedFinal(byte *digest, size_t digestSize) \n\t\t{throw NotImplemented(\"PK_MessageAccumulator: TruncatedFinal() should not be called\");}"
        }
      },
      {
        "call_info": {
          "callee": "ProcessString",
          "args": [
            "ciphertext",
            "message",
            "messageLength"
          ],
          "line": 223
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Update",
          "args": [
            "header",
            "headerLength"
          ],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "Adler32::Update",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/adler32.cpp",
          "lines": "8-54",
          "snippet": "void Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}",
          "includes": [
            "#include \"adler32.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"adler32.h\"\n#include \"pch.h\"\n\nvoid Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SpecifyDataLengths",
          "args": [
            "headerLength",
            "messageLength"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Resynchronize",
          "args": [
            "iv",
            "ivLength"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "VMAC_Base::Resynchronize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/vmac.cpp",
          "lines": "99-131",
          "snippet": "void VMAC_Base::Resynchronize(const byte *nonce, int len)\n{\n\tsize_t length = ThrowIfInvalidIVLength(len);\n\tsize_t s = IVSize();\n\tbyte *storedNonce = m_nonce();\n\n\tif (m_is128)\n\t{\n\t\tmemset(storedNonce, 0, s-length);\n\t\tmemcpy(storedNonce+s-length, nonce, length);\n\t\tAccessCipher().ProcessBlock(storedNonce, m_pad());\n\t}\n\telse\n\t{\n\t\tif (m_padCached && (storedNonce[s-1] | 1) == (nonce[length-1] | 1))\n\t\t{\n\t\t\tm_padCached = VerifyBufsEqual(storedNonce+s-length, nonce, length-1);\n\t\t\tfor (size_t i=0; m_padCached && i<s-length; i++)\n\t\t\t\tm_padCached = (storedNonce[i] == 0);\n\t\t}\n\t\tif (!m_padCached)\n\t\t{\n\t\t\tmemset(storedNonce, 0, s-length);\n\t\t\tmemcpy(storedNonce+s-length, nonce, length-1);\n\t\t\tstoredNonce[s-1] = nonce[length-1] & 0xfe;\n\t\t\tAccessCipher().ProcessBlock(storedNonce, m_pad());\n\t\t\tm_padCached = true;\n\t\t}\n\t\tstoredNonce[s-1] = nonce[length-1];\n\t}\n\tm_isFirstBlock = true;\n\tRestart();\n}",
          "includes": [
            "#include <intrin.h>",
            "#include \"cpu.h\"",
            "#include \"argnames.h\"",
            "#include \"vmac.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [
            "#define const\t// Turbo C++ 2006 workaround"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <intrin.h>\n#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"vmac.h\"\n#include \"pch.h\"\n\n#define const\t// Turbo C++ 2006 workaround\n\nvoid VMAC_Base::Resynchronize(const byte *nonce, int len)\n{\n\tsize_t length = ThrowIfInvalidIVLength(len);\n\tsize_t s = IVSize();\n\tbyte *storedNonce = m_nonce();\n\n\tif (m_is128)\n\t{\n\t\tmemset(storedNonce, 0, s-length);\n\t\tmemcpy(storedNonce+s-length, nonce, length);\n\t\tAccessCipher().ProcessBlock(storedNonce, m_pad());\n\t}\n\telse\n\t{\n\t\tif (m_padCached && (storedNonce[s-1] | 1) == (nonce[length-1] | 1))\n\t\t{\n\t\t\tm_padCached = VerifyBufsEqual(storedNonce+s-length, nonce, length-1);\n\t\t\tfor (size_t i=0; m_padCached && i<s-length; i++)\n\t\t\t\tm_padCached = (storedNonce[i] == 0);\n\t\t}\n\t\tif (!m_padCached)\n\t\t{\n\t\t\tmemset(storedNonce, 0, s-length);\n\t\t\tmemcpy(storedNonce+s-length, nonce, length-1);\n\t\t\tstoredNonce[s-1] = nonce[length-1] & 0xfe;\n\t\t\tAccessCipher().ProcessBlock(storedNonce, m_pad());\n\t\t\tm_padCached = true;\n\t\t}\n\t\tstoredNonce[s-1] = nonce[length-1];\n\t}\n\tm_isFirstBlock = true;\n\tRestart();\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedSymmetricCipher::EncryptAndAuthenticate(byte *ciphertext, byte *mac, size_t macSize, const byte *iv, int ivLength, const byte *header, size_t headerLength, const byte *message, size_t messageLength)\n{\n\tResynchronize(iv, ivLength);\n\tSpecifyDataLengths(headerLength, messageLength);\n\tUpdate(header, headerLength);\n\tProcessString(ciphertext, message, messageLength);\n\tTruncatedFinal(mac, macSize);\n}"
  },
  {
    "function_name": "AuthenticatedSymmetricCipher::SpecifyDataLengths",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "204-216",
    "snippet": "void AuthenticatedSymmetricCipher::SpecifyDataLengths(lword headerLength, lword messageLength, lword footerLength)\n{\n\tif (headerLength > MaxHeaderLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": header length \" + IntToString(headerLength) + \" exceeds the maximum of \" + IntToString(MaxHeaderLength()));\n\n\tif (messageLength > MaxMessageLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": message length \" + IntToString(messageLength) + \" exceeds the maximum of \" + IntToString(MaxMessageLength()));\n\t\t\n\tif (footerLength > MaxFooterLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": footer length \" + IntToString(footerLength) + \" exceeds the maximum of \" + IntToString(MaxFooterLength()));\n\n\tUncheckedSpecifyDataLengths(headerLength, messageLength, footerLength);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "UncheckedSpecifyDataLengths",
          "args": [
            "headerLength",
            "messageLength",
            "footerLength"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "CCM_Base::UncheckedSpecifyDataLengths",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/ccm.cpp",
          "lines": "51-91",
          "snippet": "void CCM_Base::UncheckedSpecifyDataLengths(lword headerLength, lword messageLength, lword footerLength)\r\n{\r\n\tif (m_state != State_IVSet)\r\n\t\tthrow BadState(AlgorithmName(), \"SpecifyDataLengths\", \"or after State_IVSet\");\r\n\r\n\tm_aadLength = headerLength; \r\n\tm_messageLength = messageLength;\r\n\r\n\tbyte *cbcBuffer = CBC_Buffer();\r\n\tconst BlockCipher &cipher = GetBlockCipher();\r\n\r\n\tcbcBuffer[0] = byte(64*(headerLength>0) + 8*((m_digestSize-2)/2) + (m_L-1));\t// flag\r\n\tPutWord<word64>(true, BIG_ENDIAN_ORDER, cbcBuffer+REQUIRED_BLOCKSIZE-8, m_messageLength);\r\n\tmemcpy(cbcBuffer+1, m_buffer+1, REQUIRED_BLOCKSIZE-1-m_L);\r\n\tcipher.ProcessBlock(cbcBuffer);\r\n\r\n\tif (headerLength>0)\r\n\t{\r\n\t\tassert(m_bufferedDataLength == 0);\r\n\r\n\t\tif (headerLength < ((1<<16) - (1<<8)))\r\n\t\t{\r\n\t\t\tPutWord<word16>(true, BIG_ENDIAN_ORDER, m_buffer, (word16)headerLength);\r\n\t\t\tm_bufferedDataLength = 2;\r\n\t\t}\r\n\t\telse if (headerLength < (W64LIT(1)<<32))\r\n\t\t{\r\n\t\t\tm_buffer[0] = 0xff;\r\n\t\t\tm_buffer[1] = 0xfe;\r\n\t\t\tPutWord<word32>(false, BIG_ENDIAN_ORDER, m_buffer+2, (word32)headerLength);\r\n\t\t\tm_bufferedDataLength = 6;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tm_buffer[0] = 0xff;\r\n\t\t\tm_buffer[1] = 0xff;\r\n\t\t\tPutWord<word64>(false, BIG_ENDIAN_ORDER, m_buffer+2, headerLength);\r\n\t\t\tm_bufferedDataLength = 10;\r\n\t\t}\r\n\t}\r\n}",
          "includes": [
            "#include \"ccm.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ccm.h\"\n#include \"pch.h\"\n\nvoid CCM_Base::UncheckedSpecifyDataLengths(lword headerLength, lword messageLength, lword footerLength)\r\n{\r\n\tif (m_state != State_IVSet)\r\n\t\tthrow BadState(AlgorithmName(), \"SpecifyDataLengths\", \"or after State_IVSet\");\r\n\r\n\tm_aadLength = headerLength; \r\n\tm_messageLength = messageLength;\r\n\r\n\tbyte *cbcBuffer = CBC_Buffer();\r\n\tconst BlockCipher &cipher = GetBlockCipher();\r\n\r\n\tcbcBuffer[0] = byte(64*(headerLength>0) + 8*((m_digestSize-2)/2) + (m_L-1));\t// flag\r\n\tPutWord<word64>(true, BIG_ENDIAN_ORDER, cbcBuffer+REQUIRED_BLOCKSIZE-8, m_messageLength);\r\n\tmemcpy(cbcBuffer+1, m_buffer+1, REQUIRED_BLOCKSIZE-1-m_L);\r\n\tcipher.ProcessBlock(cbcBuffer);\r\n\r\n\tif (headerLength>0)\r\n\t{\r\n\t\tassert(m_bufferedDataLength == 0);\r\n\r\n\t\tif (headerLength < ((1<<16) - (1<<8)))\r\n\t\t{\r\n\t\t\tPutWord<word16>(true, BIG_ENDIAN_ORDER, m_buffer, (word16)headerLength);\r\n\t\t\tm_bufferedDataLength = 2;\r\n\t\t}\r\n\t\telse if (headerLength < (W64LIT(1)<<32))\r\n\t\t{\r\n\t\t\tm_buffer[0] = 0xff;\r\n\t\t\tm_buffer[1] = 0xfe;\r\n\t\t\tPutWord<word32>(false, BIG_ENDIAN_ORDER, m_buffer+2, (word32)headerLength);\r\n\t\t\tm_bufferedDataLength = 6;\r\n\t\t}\r\n\t\telse\r\n\t\t{\r\n\t\t\tm_buffer[0] = 0xff;\r\n\t\t\tm_buffer[1] = 0xff;\r\n\t\t\tPutWord<word64>(false, BIG_ENDIAN_ORDER, m_buffer+2, headerLength);\r\n\t\t\tm_bufferedDataLength = 10;\r\n\t\t}\r\n\t}\r\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "GetAlgorithm().AlgorithmName() + \": footer length \" + IntToString(footerLength) + \" exceeds the maximum of \" + IntToString(MaxFooterLength())"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "MaxFooterLength()"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "IntToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "409-429",
          "snippet": "std::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nstd::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MaxFooterLength",
          "args": [],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetAlgorithm",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlgorithmID",
          "container": "DL_KeyImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "728-728",
          "snippet": "O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nDL_KeyImpl {\n  O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "MaxFooterLength",
          "args": [],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "GetAlgorithm().AlgorithmName() + \": message length \" + IntToString(messageLength) + \" exceeds the maximum of \" + IntToString(MaxMessageLength())"
          ],
          "line": 210
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MaxMessageLength",
          "args": [],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "MaxMessageLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eax.h",
          "lines": "41-42",
          "snippet": "lword MaxMessageLength() const\n\t\t{return LWORD_MAX;}",
          "includes": [
            "#include \"cmac.h\"",
            "#include \"modes.h\"",
            "#include \"authenc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cmac.h\"\n#include \"modes.h\"\n#include \"authenc.h\"\n\nlword MaxMessageLength() const\n\t\t{return LWORD_MAX;}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "GetAlgorithm().AlgorithmName() + \": header length \" + IntToString(headerLength) + \" exceeds the maximum of \" + IntToString(MaxHeaderLength())"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MaxHeaderLength",
          "args": [],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "MaxHeaderLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eax.h",
          "lines": "39-40",
          "snippet": "lword MaxHeaderLength() const\n\t\t{return LWORD_MAX;}",
          "includes": [
            "#include \"cmac.h\"",
            "#include \"modes.h\"",
            "#include \"authenc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cmac.h\"\n#include \"modes.h\"\n#include \"authenc.h\"\n\nlword MaxHeaderLength() const\n\t\t{return LWORD_MAX;}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid AuthenticatedSymmetricCipher::SpecifyDataLengths(lword headerLength, lword messageLength, lword footerLength)\n{\n\tif (headerLength > MaxHeaderLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": header length \" + IntToString(headerLength) + \" exceeds the maximum of \" + IntToString(MaxHeaderLength()));\n\n\tif (messageLength > MaxMessageLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": message length \" + IntToString(messageLength) + \" exceeds the maximum of \" + IntToString(MaxMessageLength()));\n\t\t\n\tif (footerLength > MaxFooterLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": footer length \" + IntToString(footerLength) + \" exceeds the maximum of \" + IntToString(MaxFooterLength()));\n\n\tUncheckedSpecifyDataLengths(headerLength, messageLength, footerLength);\n}"
  },
  {
    "function_name": "StreamTransformation::ProcessLastBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "194-202",
    "snippet": "void StreamTransformation::ProcessLastBlock(byte *outString, const byte *inString, size_t length)\n{\n\tassert(MinLastBlockSize() == 0);\t// this function should be overriden otherwise\n\n\tif (length == MandatoryBlockSize())\n\t\tProcessData(outString, inString, length);\n\telse if (length != 0)\n\t\tthrow NotImplemented(AlgorithmName() + \": this object does't support a special last block\");\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NotImplemented",
          "args": [
            "AlgorithmName() + \": this object does't support a special last block\""
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AlgorithmName",
          "args": [],
          "line": 201
        },
        "resolved": true,
        "details": {
          "function_name": "AlgorithmName",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "291-291",
          "snippet": "std::string AlgorithmName() const {return \"NullRNG\";}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  std::string AlgorithmName() const {return \"NullRNG\";}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ProcessData",
          "args": [
            "outString",
            "inString",
            "length"
          ],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "CFB_CipherTemplate<BASE>::ProcessData",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/strciphr.cpp",
          "lines": "177-230",
          "snippet": "void CFB_CipherTemplate<BASE>::ProcessData(byte *outString, const byte *inString, size_t length)\n{\n\tassert(length % this->MandatoryBlockSize() == 0);\n\n\tPolicyInterface &policy = this->AccessPolicy();\n\tunsigned int bytesPerIteration = policy.GetBytesPerIteration();\n\tunsigned int alignment = policy.GetAlignment();\n\tbyte *reg = policy.GetRegisterBegin();\n\n\tif (m_leftOver)\n\t{\n\t\tsize_t len = STDMIN(m_leftOver, length);\n\t\tCombineMessageAndShiftRegister(outString, reg + bytesPerIteration - m_leftOver, inString, len);\n\t\tm_leftOver -= len;\n\t\tlength -= len;\n\t\tinString += len;\n\t\toutString += len;\n\t}\n\n\tif (!length)\n\t\treturn;\n\n\tassert(m_leftOver == 0);\n\n\tif (policy.CanIterate() && length >= bytesPerIteration && IsAlignedOn(outString, alignment))\n\t{\n\t\tif (IsAlignedOn(inString, alignment))\n\t\t\tpolicy.Iterate(outString, inString, GetCipherDir(*this), length / bytesPerIteration);\n\t\telse\n\t\t{\n\t\t\tmemcpy(outString, inString, length);\n\t\t\tpolicy.Iterate(outString, outString, GetCipherDir(*this), length / bytesPerIteration);\n\t\t}\n\t\tinString += length - length % bytesPerIteration;\n\t\toutString += length - length % bytesPerIteration;\n\t\tlength %= bytesPerIteration;\n\t}\n\n\twhile (length >= bytesPerIteration)\n\t{\n\t\tpolicy.TransformRegister();\n\t\tCombineMessageAndShiftRegister(outString, reg, inString, bytesPerIteration);\n\t\tlength -= bytesPerIteration;\n\t\tinString += bytesPerIteration;\n\t\toutString += bytesPerIteration;\n\t}\n\n\tif (length > 0)\n\t{\n\t\tpolicy.TransformRegister();\n\t\tCombineMessageAndShiftRegister(outString, reg, inString, length);\n\t\tm_leftOver = bytesPerIteration - length;\n\t}\n}",
          "includes": [
            "#include \"strciphr.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n#include \"pch.h\"\n\nvoid CFB_CipherTemplate<BASE>::ProcessData(byte *outString, const byte *inString, size_t length)\n{\n\tassert(length % this->MandatoryBlockSize() == 0);\n\n\tPolicyInterface &policy = this->AccessPolicy();\n\tunsigned int bytesPerIteration = policy.GetBytesPerIteration();\n\tunsigned int alignment = policy.GetAlignment();\n\tbyte *reg = policy.GetRegisterBegin();\n\n\tif (m_leftOver)\n\t{\n\t\tsize_t len = STDMIN(m_leftOver, length);\n\t\tCombineMessageAndShiftRegister(outString, reg + bytesPerIteration - m_leftOver, inString, len);\n\t\tm_leftOver -= len;\n\t\tlength -= len;\n\t\tinString += len;\n\t\toutString += len;\n\t}\n\n\tif (!length)\n\t\treturn;\n\n\tassert(m_leftOver == 0);\n\n\tif (policy.CanIterate() && length >= bytesPerIteration && IsAlignedOn(outString, alignment))\n\t{\n\t\tif (IsAlignedOn(inString, alignment))\n\t\t\tpolicy.Iterate(outString, inString, GetCipherDir(*this), length / bytesPerIteration);\n\t\telse\n\t\t{\n\t\t\tmemcpy(outString, inString, length);\n\t\t\tpolicy.Iterate(outString, outString, GetCipherDir(*this), length / bytesPerIteration);\n\t\t}\n\t\tinString += length - length % bytesPerIteration;\n\t\toutString += length - length % bytesPerIteration;\n\t\tlength %= bytesPerIteration;\n\t}\n\n\twhile (length >= bytesPerIteration)\n\t{\n\t\tpolicy.TransformRegister();\n\t\tCombineMessageAndShiftRegister(outString, reg, inString, bytesPerIteration);\n\t\tlength -= bytesPerIteration;\n\t\tinString += bytesPerIteration;\n\t\toutString += bytesPerIteration;\n\t}\n\n\tif (length > 0)\n\t{\n\t\tpolicy.TransformRegister();\n\t\tCombineMessageAndShiftRegister(outString, reg, inString, length);\n\t\tm_leftOver = bytesPerIteration - length;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "MandatoryBlockSize",
          "args": [],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "MandatoryBlockSize",
          "container": "CFB_RequireFullDataBlocks",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/strciphr.h",
          "lines": "273-273",
          "snippet": "unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}",
          "includes": [
            "#include \"strciphr.cpp\"",
            "#include \"argnames.h\"",
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.cpp\"\n#include \"argnames.h\"\n#include \"secblock.h\"\n#include \"seckey.h\"\n\nCFB_RequireFullDataBlocks {\n  unsigned int MandatoryBlockSize() const {return this->OptimalBlockSize();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "MinLastBlockSize() == 0"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MinLastBlockSize",
          "args": [],
          "line": 196
        },
        "resolved": true,
        "details": {
          "function_name": "MinLastBlockSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/modes.h",
          "lines": "211-211",
          "snippet": "unsigned int MinLastBlockSize() const {return BlockSize()+1;}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"argnames.h\"",
            "#include \"strciphr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"argnames.h\"\n#include \"strciphr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nunsigned int MinLastBlockSize() const {return BlockSize()+1;}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid StreamTransformation::ProcessLastBlock(byte *outString, const byte *inString, size_t length)\n{\n\tassert(MinLastBlockSize() == 0);\t// this function should be overriden otherwise\n\n\tif (length == MandatoryBlockSize())\n\t\tProcessData(outString, inString, length);\n\telse if (length != 0)\n\t\tthrow NotImplemented(AlgorithmName() + \": this object does't support a special last block\");\n}"
  },
  {
    "function_name": "HashTransformation::OptimalDataAlignment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "189-192",
    "snippet": "unsigned int HashTransformation::OptimalDataAlignment() const\n{\n\treturn GetAlignmentOf<word32>();\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetAlignmentOf<word32>",
          "args": [],
          "line": 191
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlignmentOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "363-379",
          "snippet": "inline unsigned int GetAlignmentOf(T *dummy=NULL)\t// VC60 workaround\n{\n#ifdef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (sizeof(T) < 16)\n\t\treturn 1;\n#endif\n\n#if (_MSC_VER >= 1300)\n\treturn __alignof(T);\n#elif defined(__GNUC__)\n\treturn __alignof__(T);\n#elif CRYPTOPP_BOOL_SLOW_WORD64\n\treturn UnsignedMin(4U, sizeof(T));\n#else\n\treturn sizeof(T);\n#endif\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline unsigned int GetAlignmentOf(T *dummy=NULL)\t// VC60 workaround\n{\n#ifdef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (sizeof(T) < 16)\n\t\treturn 1;\n#endif\n\n#if (_MSC_VER >= 1300)\n\treturn __alignof(T);\n#elif defined(__GNUC__)\n\treturn __alignof__(T);\n#elif CRYPTOPP_BOOL_SLOW_WORD64\n\treturn UnsignedMin(4U, sizeof(T));\n#else\n\treturn sizeof(T);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int HashTransformation::OptimalDataAlignment() const\n{\n\treturn GetAlignmentOf<word32>();\n}"
  },
  {
    "function_name": "StreamTransformation::OptimalDataAlignment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "184-187",
    "snippet": "unsigned int StreamTransformation::OptimalDataAlignment() const\n{\n\treturn GetAlignmentOf<word32>();\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetAlignmentOf<word32>",
          "args": [],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlignmentOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "363-379",
          "snippet": "inline unsigned int GetAlignmentOf(T *dummy=NULL)\t// VC60 workaround\n{\n#ifdef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (sizeof(T) < 16)\n\t\treturn 1;\n#endif\n\n#if (_MSC_VER >= 1300)\n\treturn __alignof(T);\n#elif defined(__GNUC__)\n\treturn __alignof__(T);\n#elif CRYPTOPP_BOOL_SLOW_WORD64\n\treturn UnsignedMin(4U, sizeof(T));\n#else\n\treturn sizeof(T);\n#endif\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline unsigned int GetAlignmentOf(T *dummy=NULL)\t// VC60 workaround\n{\n#ifdef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (sizeof(T) < 16)\n\t\treturn 1;\n#endif\n\n#if (_MSC_VER >= 1300)\n\treturn __alignof(T);\n#elif defined(__GNUC__)\n\treturn __alignof__(T);\n#elif CRYPTOPP_BOOL_SLOW_WORD64\n\treturn UnsignedMin(4U, sizeof(T));\n#else\n\treturn sizeof(T);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int StreamTransformation::OptimalDataAlignment() const\n{\n\treturn GetAlignmentOf<word32>();\n}"
  },
  {
    "function_name": "BlockTransformation::OptimalDataAlignment",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "179-182",
    "snippet": "unsigned int BlockTransformation::OptimalDataAlignment() const\n{\n\treturn GetAlignmentOf<word32>();\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetAlignmentOf<word32>",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlignmentOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "363-379",
          "snippet": "inline unsigned int GetAlignmentOf(T *dummy=NULL)\t// VC60 workaround\n{\n#ifdef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (sizeof(T) < 16)\n\t\treturn 1;\n#endif\n\n#if (_MSC_VER >= 1300)\n\treturn __alignof(T);\n#elif defined(__GNUC__)\n\treturn __alignof__(T);\n#elif CRYPTOPP_BOOL_SLOW_WORD64\n\treturn UnsignedMin(4U, sizeof(T));\n#else\n\treturn sizeof(T);\n#endif\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline unsigned int GetAlignmentOf(T *dummy=NULL)\t// VC60 workaround\n{\n#ifdef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (sizeof(T) < 16)\n\t\treturn 1;\n#endif\n\n#if (_MSC_VER >= 1300)\n\treturn __alignof(T);\n#elif defined(__GNUC__)\n\treturn __alignof__(T);\n#elif CRYPTOPP_BOOL_SLOW_WORD64\n\treturn UnsignedMin(4U, sizeof(T));\n#else\n\treturn sizeof(T);\n#endif\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nunsigned int BlockTransformation::OptimalDataAlignment() const\n{\n\treturn GetAlignmentOf<word32>();\n}"
  },
  {
    "function_name": "BlockTransformation::AdvancedProcessBlocks",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "141-177",
    "snippet": "size_t BlockTransformation::AdvancedProcessBlocks(const byte *inBlocks, const byte *xorBlocks, byte *outBlocks, size_t length, word32 flags) const\n{\n\tsize_t blockSize = BlockSize();\n\tsize_t inIncrement = (flags & (BT_InBlockIsCounter|BT_DontIncrementInOutPointers)) ? 0 : blockSize;\n\tsize_t xorIncrement = xorBlocks ? blockSize : 0;\n\tsize_t outIncrement = (flags & BT_DontIncrementInOutPointers) ? 0 : blockSize;\n\n\tif (flags & BT_ReverseDirection)\n\t{\n\t\tassert(length % blockSize == 0);\n\t\tinBlocks += length - blockSize;\n\t\txorBlocks += length - blockSize;\n\t\toutBlocks += length - blockSize;\n\t\tinIncrement = 0-inIncrement;\n\t\txorIncrement = 0-xorIncrement;\n\t\toutIncrement = 0-outIncrement;\n\t}\n\n\twhile (length >= blockSize)\n\t{\n\t\tif (flags & BT_XorInput)\n\t\t{\n\t\t\txorbuf(outBlocks, xorBlocks, inBlocks, blockSize);\n\t\t\tProcessBlock(outBlocks);\n\t\t}\n\t\telse\n\t\t\tProcessAndXorBlock(inBlocks, xorBlocks, outBlocks);\n\t\tif (flags & BT_InBlockIsCounter)\n\t\t\tconst_cast<byte *>(inBlocks)[blockSize-1]++;\n\t\tinBlocks += inIncrement;\n\t\toutBlocks += outIncrement;\n\t\txorBlocks += xorIncrement;\n\t\tlength -= blockSize;\n\t}\n\n\treturn length;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "const_cast<byte *>",
          "args": [
            "inBlocks"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ProcessAndXorBlock",
          "args": [
            "inBlocks",
            "xorBlocks",
            "outBlocks"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "SKIPJACK::Dec::ProcessAndXorBlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/skipjack.cpp",
          "lines": "152-198",
          "snippet": "void SKIPJACK::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword16 w1, w2, w3, w4;\n\tBlock::Get(inBlock)(w4)(w3)(w2)(w1);\n\n\t/* stepping rule A: */\n\th1(tab, w2); w3 ^= w2 ^ 32;\n\th0(tab, w3); w4 ^= w3 ^ 31;\n\th4(tab, w4); w1 ^= w4 ^ 30;\n\th3(tab, w1); w2 ^= w1 ^ 29;\n\th2(tab, w2); w3 ^= w2 ^ 28;\n\th1(tab, w3); w4 ^= w3 ^ 27;\n\th0(tab, w4); w1 ^= w4 ^ 26;\n\th4(tab, w1); w2 ^= w1 ^ 25;\n\n\t/* stepping rule B: */\n\tw1 ^= w2 ^ 24; h3(tab, w2);\n\tw2 ^= w3 ^ 23; h2(tab, w3);\n\tw3 ^= w4 ^ 22; h1(tab, w4);\n\tw4 ^= w1 ^ 21; h0(tab, w1);\n\tw1 ^= w2 ^ 20; h4(tab, w2);\n\tw2 ^= w3 ^ 19; h3(tab, w3);\n\tw3 ^= w4 ^ 18; h2(tab, w4);\n\tw4 ^= w1 ^ 17; h1(tab, w1);\n\n\t/* stepping rule A: */\n\th0(tab, w2); w3 ^= w2 ^ 16;\n\th4(tab, w3); w4 ^= w3 ^ 15;\n\th3(tab, w4); w1 ^= w4 ^ 14;\n\th2(tab, w1); w2 ^= w1 ^ 13;\n\th1(tab, w2); w3 ^= w2 ^ 12;\n\th0(tab, w3); w4 ^= w3 ^ 11;\n\th4(tab, w4); w1 ^= w4 ^ 10;\n\th3(tab, w1); w2 ^= w1 ^  9;\n\n\t/* stepping rule B: */\n\tw1 ^= w2 ^ 8; h2(tab, w2);\n\tw2 ^= w3 ^ 7; h1(tab, w3);\n\tw3 ^= w4 ^ 6; h0(tab, w4);\n\tw4 ^= w1 ^ 5; h4(tab, w1);\n\tw1 ^= w2 ^ 4; h3(tab, w2);\n\tw2 ^= w3 ^ 3; h2(tab, w3);\n\tw3 ^= w4 ^ 2; h1(tab, w4);\n\tw4 ^= w1 ^ 1; h0(tab, w1);\n\n\tBlock::Put(xorBlock, outBlock)(w4)(w3)(w2)(w1);\n}",
          "includes": [
            "#include \"skipjack.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"skipjack.h\"\n#include \"pch.h\"\n\nvoid SKIPJACK::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword16 w1, w2, w3, w4;\n\tBlock::Get(inBlock)(w4)(w3)(w2)(w1);\n\n\t/* stepping rule A: */\n\th1(tab, w2); w3 ^= w2 ^ 32;\n\th0(tab, w3); w4 ^= w3 ^ 31;\n\th4(tab, w4); w1 ^= w4 ^ 30;\n\th3(tab, w1); w2 ^= w1 ^ 29;\n\th2(tab, w2); w3 ^= w2 ^ 28;\n\th1(tab, w3); w4 ^= w3 ^ 27;\n\th0(tab, w4); w1 ^= w4 ^ 26;\n\th4(tab, w1); w2 ^= w1 ^ 25;\n\n\t/* stepping rule B: */\n\tw1 ^= w2 ^ 24; h3(tab, w2);\n\tw2 ^= w3 ^ 23; h2(tab, w3);\n\tw3 ^= w4 ^ 22; h1(tab, w4);\n\tw4 ^= w1 ^ 21; h0(tab, w1);\n\tw1 ^= w2 ^ 20; h4(tab, w2);\n\tw2 ^= w3 ^ 19; h3(tab, w3);\n\tw3 ^= w4 ^ 18; h2(tab, w4);\n\tw4 ^= w1 ^ 17; h1(tab, w1);\n\n\t/* stepping rule A: */\n\th0(tab, w2); w3 ^= w2 ^ 16;\n\th4(tab, w3); w4 ^= w3 ^ 15;\n\th3(tab, w4); w1 ^= w4 ^ 14;\n\th2(tab, w1); w2 ^= w1 ^ 13;\n\th1(tab, w2); w3 ^= w2 ^ 12;\n\th0(tab, w3); w4 ^= w3 ^ 11;\n\th4(tab, w4); w1 ^= w4 ^ 10;\n\th3(tab, w1); w2 ^= w1 ^  9;\n\n\t/* stepping rule B: */\n\tw1 ^= w2 ^ 8; h2(tab, w2);\n\tw2 ^= w3 ^ 7; h1(tab, w3);\n\tw3 ^= w4 ^ 6; h0(tab, w4);\n\tw4 ^= w1 ^ 5; h4(tab, w1);\n\tw1 ^= w2 ^ 4; h3(tab, w2);\n\tw2 ^= w3 ^ 3; h2(tab, w3);\n\tw3 ^= w4 ^ 2; h1(tab, w4);\n\tw4 ^= w1 ^ 1; h0(tab, w1);\n\n\tBlock::Put(xorBlock, outBlock)(w4)(w3)(w2)(w1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ProcessBlock",
          "args": [
            "outBlocks"
          ],
          "line": 164
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "xorbuf",
          "args": [
            "outBlocks",
            "xorBlocks",
            "inBlocks",
            "blockSize"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "xorbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.cpp",
          "lines": "47-77",
          "snippet": "void xorbuf(byte *output, const byte *input, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(output) && IsAligned<word32>(input) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(output) && IsAligned<word64>(input) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)output)[i] = ((word64*)input)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\toutput += 8*i;\n\t\t\tinput += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)output)[i] = ((word32*)input)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\toutput += 4*i;\n\t\tinput += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\toutput[i] = input[i] ^ mask[i];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <new>",
            "#include \"words.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <new>\n#include \"words.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid xorbuf(byte *output, const byte *input, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(output) && IsAligned<word32>(input) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(output) && IsAligned<word64>(input) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)output)[i] = ((word64*)input)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\toutput += 8*i;\n\t\t\tinput += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)output)[i] = ((word32*)input)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\toutput += 4*i;\n\t\tinput += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\toutput[i] = input[i] ^ mask[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length % blockSize == 0"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BlockSize",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "IVSize",
          "container": "FixedBlockSize::FixedRounds",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "139-139",
          "snippet": "unsigned int IVSize() const {return INFO::IV_LENGTH;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nFixedBlockSize {\n  FixedRounds {\n    unsigned int IVSize() const {return INFO::IV_LENGTH;}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t BlockTransformation::AdvancedProcessBlocks(const byte *inBlocks, const byte *xorBlocks, byte *outBlocks, size_t length, word32 flags) const\n{\n\tsize_t blockSize = BlockSize();\n\tsize_t inIncrement = (flags & (BT_InBlockIsCounter|BT_DontIncrementInOutPointers)) ? 0 : blockSize;\n\tsize_t xorIncrement = xorBlocks ? blockSize : 0;\n\tsize_t outIncrement = (flags & BT_DontIncrementInOutPointers) ? 0 : blockSize;\n\n\tif (flags & BT_ReverseDirection)\n\t{\n\t\tassert(length % blockSize == 0);\n\t\tinBlocks += length - blockSize;\n\t\txorBlocks += length - blockSize;\n\t\toutBlocks += length - blockSize;\n\t\tinIncrement = 0-inIncrement;\n\t\txorIncrement = 0-xorIncrement;\n\t\toutIncrement = 0-outIncrement;\n\t}\n\n\twhile (length >= blockSize)\n\t{\n\t\tif (flags & BT_XorInput)\n\t\t{\n\t\t\txorbuf(outBlocks, xorBlocks, inBlocks, blockSize);\n\t\t\tProcessBlock(outBlocks);\n\t\t}\n\t\telse\n\t\t\tProcessAndXorBlock(inBlocks, xorBlocks, outBlocks);\n\t\tif (flags & BT_InBlockIsCounter)\n\t\t\tconst_cast<byte *>(inBlocks)[blockSize-1]++;\n\t\tinBlocks += inIncrement;\n\t\toutBlocks += outIncrement;\n\t\txorBlocks += xorIncrement;\n\t\tlength -= blockSize;\n\t}\n\n\treturn length;\n}"
  },
  {
    "function_name": "SimpleKeyingInterface::GetNextIV",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "136-139",
    "snippet": "void SimpleKeyingInterface::GetNextIV(RandomNumberGenerator &rng, byte *IV)\n{\n\trng.GenerateBlock(IV, IVSize());\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rng.GenerateBlock",
          "args": [
            "IV",
            "IVSize()"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateBlock",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "292-292",
          "snippet": "void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  void GenerateBlock(byte *output, size_t size) {throw NotImplemented(\"NullRNG: NullRNG should only be passed to functions that don't need to generate random bytes\");}\n}"
        }
      },
      {
        "call_info": {
          "callee": "IVSize",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "IVSize",
          "container": "FixedBlockSize::FixedRounds",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "139-139",
          "snippet": "unsigned int IVSize() const {return INFO::IV_LENGTH;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nFixedBlockSize {\n  FixedRounds {\n    unsigned int IVSize() const {return INFO::IV_LENGTH;}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::GetNextIV(RandomNumberGenerator &rng, byte *IV)\n{\n\trng.GenerateBlock(IV, IVSize());\n}"
  },
  {
    "function_name": "SimpleKeyingInterface::ThrowIfInvalidIVLength",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "94-104",
    "snippet": "size_t SimpleKeyingInterface::ThrowIfInvalidIVLength(int size)\n{\n\tif (size < 0)\n\t\treturn IVSize();\n\telse if ((size_t)size < MinIVLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": IV length \" + IntToString(size) + \" is less than the minimum of \" + IntToString(MinIVLength()));\n\telse if ((size_t)size > MaxIVLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": IV length \" + IntToString(size) + \" exceeds the maximum of \" + IntToString(MaxIVLength()));\n\telse\n\t\treturn size;\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "GetAlgorithm().AlgorithmName() + \": IV length \" + IntToString(size) + \" exceeds the maximum of \" + IntToString(MaxIVLength())"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IntToString",
          "args": [
            "MaxIVLength()"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "IntToString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "409-429",
          "snippet": "std::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nstd::string IntToString(T a, unsigned int base = 10)\n{\n\tif (a == 0)\n\t\treturn \"0\";\n\tbool negate = false;\n\tif (a < 0)\n\t{\n\t\tnegate = true;\n\t\ta = 0-a;\t// VC .NET does not like -a\n\t}\n\tstd::string result;\n\twhile (a > 0)\n\t{\n\t\tT digit = a % base;\n\t\tresult = char((digit < 10 ? '0' : ('a' - 10)) + digit) + result;\n\t\ta /= base;\n\t}\n\tif (negate)\n\t\tresult = \"-\" + result;\n\treturn result;\n}"
        }
      },
      {
        "call_info": {
          "callee": "MaxIVLength",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "MaxIVLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eax.h",
          "lines": "35-36",
          "snippet": "unsigned int MaxIVLength() const\n\t\t{return UINT_MAX;}",
          "includes": [
            "#include \"cmac.h\"",
            "#include \"modes.h\"",
            "#include \"authenc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cmac.h\"\n#include \"modes.h\"\n#include \"authenc.h\"\n\nunsigned int MaxIVLength() const\n\t\t{return UINT_MAX;}"
        }
      },
      {
        "call_info": {
          "callee": "GetAlgorithm",
          "args": [],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlgorithmID",
          "container": "DL_KeyImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "728-728",
          "snippet": "O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nDL_KeyImpl {\n  O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "GetAlgorithm().AlgorithmName() + \": IV length \" + IntToString(size) + \" is less than the minimum of \" + IntToString(MinIVLength())"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MinIVLength",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "MinIVLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/vmac.h",
          "lines": "15-15",
          "snippet": "unsigned int MinIVLength() const {return 1;}",
          "includes": [
            "#include \"seckey.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"seckey.h\"\n#include \"iterhash.h\"\n\nunsigned int MinIVLength() const {return 1;}"
        }
      },
      {
        "call_info": {
          "callee": "IVSize",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "IVSize",
          "container": "FixedBlockSize::FixedRounds",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "139-139",
          "snippet": "unsigned int IVSize() const {return INFO::IV_LENGTH;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nFixedBlockSize {\n  FixedRounds {\n    unsigned int IVSize() const {return INFO::IV_LENGTH;}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nsize_t SimpleKeyingInterface::ThrowIfInvalidIVLength(int size)\n{\n\tif (size < 0)\n\t\treturn IVSize();\n\telse if ((size_t)size < MinIVLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": IV length \" + IntToString(size) + \" is less than the minimum of \" + IntToString(MinIVLength()));\n\telse if ((size_t)size > MaxIVLength())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": IV length \" + IntToString(size) + \" exceeds the maximum of \" + IntToString(MaxIVLength()));\n\telse\n\t\treturn size;\n}"
  },
  {
    "function_name": "SimpleKeyingInterface::ThrowIfInvalidIV",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "88-92",
    "snippet": "void SimpleKeyingInterface::ThrowIfInvalidIV(const byte *iv)\n{\n\tif (!iv && IVRequirement() == UNPREDICTABLE_RANDOM_IV)\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": this object cannot use a null IV\");\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "GetAlgorithm().AlgorithmName() + \": this object cannot use a null IV\""
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetAlgorithm",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlgorithmID",
          "container": "DL_KeyImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "728-728",
          "snippet": "O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nDL_KeyImpl {\n  O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "IVRequirement",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "IVRequirement",
          "container": "FixedBlockSize::FixedRounds",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "138-138",
          "snippet": "SimpleKeyingInterface::IV_Requirement IVRequirement() const {return (SimpleKeyingInterface::IV_Requirement)INFO::IV_REQUIREMENT;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nFixedBlockSize {\n  FixedRounds {\n    SimpleKeyingInterface::IV_Requirement IVRequirement() const {return (SimpleKeyingInterface::IV_Requirement)INFO::IV_REQUIREMENT;}\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::ThrowIfInvalidIV(const byte *iv)\n{\n\tif (!iv && IVRequirement() == UNPREDICTABLE_RANDOM_IV)\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": this object cannot use a null IV\");\n}"
  },
  {
    "function_name": "SimpleKeyingInterface::ThrowIfResynchronizable",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "82-86",
    "snippet": "void SimpleKeyingInterface::ThrowIfResynchronizable()\n{\n\tif (IsResynchronizable())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": this object requires an IV\");\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "GetAlgorithm().AlgorithmName() + \": this object requires an IV\""
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetAlgorithm",
          "args": [],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlgorithmID",
          "container": "DL_KeyImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "728-728",
          "snippet": "O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nDL_KeyImpl {\n  O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsResynchronizable",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::ThrowIfResynchronizable()\n{\n\tif (IsResynchronizable())\n\t\tthrow InvalidArgument(GetAlgorithm().AlgorithmName() + \": this object requires an IV\");\n}"
  },
  {
    "function_name": "SimpleKeyingInterface::ThrowIfInvalidKeyLength",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "76-80",
    "snippet": "void SimpleKeyingInterface::ThrowIfInvalidKeyLength(size_t length)\n{\n\tif (!IsValidKeyLength(length))\n\t\tthrow InvalidKeyLength(GetAlgorithm().AlgorithmName(), length);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InvalidKeyLength",
          "args": [
            "GetAlgorithm().AlgorithmName()",
            "length"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetAlgorithm",
          "args": [],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlgorithmID",
          "container": "DL_KeyImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "728-728",
          "snippet": "O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nDL_KeyImpl {\n  O GetAlgorithmID() const {return GetGroupParameters().GetAlgorithmID();}\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsValidKeyLength",
          "args": [
            "length"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "IsValidKeyLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eax.h",
          "lines": "25-26",
          "snippet": "bool IsValidKeyLength(size_t n) const\n\t\t{return GetMAC().IsValidKeyLength(n);}",
          "includes": [
            "#include \"cmac.h\"",
            "#include \"modes.h\"",
            "#include \"authenc.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cmac.h\"\n#include \"modes.h\"\n#include \"authenc.h\"\n\nbool IsValidKeyLength(size_t n) const\n\t\t{return GetMAC().IsValidKeyLength(n);}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::ThrowIfInvalidKeyLength(size_t length)\n{\n\tif (!IsValidKeyLength(length))\n\t\tthrow InvalidKeyLength(GetAlgorithm().AlgorithmName(), length);\n}"
  },
  {
    "function_name": "SimpleKeyingInterface::SetKeyWithIV",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "71-74",
    "snippet": "void SimpleKeyingInterface::SetKeyWithIV(const byte *key, size_t length, const byte *iv, size_t ivLength)\n{\n\tSetKey(key, length, MakeParameters(Name::IV(), ConstByteArrayParameter(iv, ivLength)));\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetKey",
          "args": [
            "key",
            "length",
            "MakeParameters(Name::IV(), ConstByteArrayParameter(iv, ivLength))"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "SimpleKeyingInterface::SetKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "60-64",
          "snippet": "void SimpleKeyingInterface::SetKey(const byte *key, size_t length, const NameValuePairs &params)\n{\n\tthis->ThrowIfInvalidKeyLength(length);\n\tthis->UncheckedSetKey(key, (unsigned int)length, params);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::SetKey(const byte *key, size_t length, const NameValuePairs &params)\n{\n\tthis->ThrowIfInvalidKeyLength(length);\n\tthis->UncheckedSetKey(key, (unsigned int)length, params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::IV()",
            "ConstByteArrayParameter(iv, ivLength)"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ConstByteArrayParameter",
          "args": [
            "iv",
            "ivLength"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "ConstByteArrayParameter",
          "container": "ConstByteArrayParameter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "24-28",
          "snippet": "ConstByteArrayParameter(const T &string, bool deepCopy = false)\n\t{\n        CRYPTOPP_COMPILE_ASSERT(sizeof(CPP_TYPENAME T::value_type) == 1);\n\t\tAssign((const byte *)string.data(), string.size(), deepCopy);\n\t}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nConstByteArrayParameter {\n  ConstByteArrayParameter(const T &string, bool deepCopy = false)\n  \t{\n          CRYPTOPP_COMPILE_ASSERT(sizeof(CPP_TYPENAME T::value_type) == 1);\n  \t\tAssign((const byte *)string.data(), string.size(), deepCopy);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::IV",
          "args": [],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::SetKeyWithIV(const byte *key, size_t length, const byte *iv, size_t ivLength)\n{\n\tSetKey(key, length, MakeParameters(Name::IV(), ConstByteArrayParameter(iv, ivLength)));\n}"
  },
  {
    "function_name": "SimpleKeyingInterface::SetKeyWithRounds",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "66-69",
    "snippet": "void SimpleKeyingInterface::SetKeyWithRounds(const byte *key, size_t length, int rounds)\n{\n\tSetKey(key, length, MakeParameters(Name::Rounds(), rounds));\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetKey",
          "args": [
            "key",
            "length",
            "MakeParameters(Name::Rounds(), rounds)"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "SimpleKeyingInterface::SetKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "60-64",
          "snippet": "void SimpleKeyingInterface::SetKey(const byte *key, size_t length, const NameValuePairs &params)\n{\n\tthis->ThrowIfInvalidKeyLength(length);\n\tthis->UncheckedSetKey(key, (unsigned int)length, params);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::SetKey(const byte *key, size_t length, const NameValuePairs &params)\n{\n\tthis->ThrowIfInvalidKeyLength(length);\n\tthis->UncheckedSetKey(key, (unsigned int)length, params);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::Rounds()",
            "rounds"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::Rounds",
          "args": [],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::SetKeyWithRounds(const byte *key, size_t length, int rounds)\n{\n\tSetKey(key, length, MakeParameters(Name::Rounds(), rounds));\n}"
  },
  {
    "function_name": "SimpleKeyingInterface::SetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "60-64",
    "snippet": "void SimpleKeyingInterface::SetKey(const byte *key, size_t length, const NameValuePairs &params)\n{\n\tthis->ThrowIfInvalidKeyLength(length);\n\tthis->UncheckedSetKey(key, (unsigned int)length, params);\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->UncheckedSetKey",
          "args": [
            "key",
            "(unsigned int)length",
            "params"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "UncheckedSetKey",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "49-53",
          "snippet": "void UncheckedSetKey(const byte *key, unsigned int length, const NameValuePairs &params)\n\t{\n\t\tm_key.Assign(key, length);\n\t\tRestart();\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void UncheckedSetKey(const byte *key, unsigned int length, const NameValuePairs &params)\n  \t{\n  \t\tm_key.Assign(key, length);\n  \t\tRestart();\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "this->ThrowIfInvalidKeyLength",
          "args": [
            "length"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid SimpleKeyingInterface::SetKey(const byte *key, size_t length, const NameValuePairs &params)\n{\n\tthis->ThrowIfInvalidKeyLength(length);\n\tthis->UncheckedSetKey(key, (unsigned int)length, params);\n}"
  },
  {
    "function_name": "Algorithm::Algorithm",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "48-58",
    "snippet": "Algorithm::Algorithm(bool checkSelfTestStatus)\n{\n\tif (checkSelfTestStatus && FIPS_140_2_ComplianceEnabled())\n\t{\n\t\tif (GetPowerUpSelfTestStatus() == POWER_UP_SELF_TEST_NOT_DONE && !PowerUpSelfTestInProgressOnThisThread())\n\t\t\tthrow SelfTestFailure(\"Cryptographic algorithms are disabled before the power-up self tests are performed.\");\n\n\t\tif (GetPowerUpSelfTestStatus() == POWER_UP_SELF_TEST_FAILED)\n\t\t\tthrow SelfTestFailure(\"Cryptographic algorithms are disabled after a power-up self test failed.\");\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SelfTestFailure",
          "args": [
            "\"Cryptographic algorithms are disabled after a power-up self test failed.\""
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetPowerUpSelfTestStatus",
          "args": [],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "CRYPTOPP_API GetPowerUpSelfTestStatus",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/fips140.cpp",
          "lines": "38-41",
          "snippet": "PowerUpSelfTestStatus CRYPTOPP_API GetPowerUpSelfTestStatus()\n{\n\treturn g_powerUpSelfTestStatus;\n}",
          "includes": [
            "#include \"trdlocal.h\"\t// needs to be included last for cygwin",
            "#include \"fips140.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trdlocal.h\"\t// needs to be included last for cygwin\n#include \"fips140.h\"\n#include \"pch.h\"\n\nPowerUpSelfTestStatus CRYPTOPP_API GetPowerUpSelfTestStatus()\n{\n\treturn g_powerUpSelfTestStatus;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SelfTestFailure",
          "args": [
            "\"Cryptographic algorithms are disabled before the power-up self tests are performed.\""
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PowerUpSelfTestInProgressOnThisThread",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "PowerUpSelfTestInProgressOnThisThread",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/fips140.cpp",
          "lines": "51-59",
          "snippet": "bool PowerUpSelfTestInProgressOnThisThread()\n{\n#if CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2\n\treturn AccessPowerUpSelfTestInProgress().GetValue() != NULL;\n#else\n\tassert(false);\t// should not be called\n\treturn false;\n#endif\n}",
          "includes": [
            "#include \"trdlocal.h\"\t// needs to be included last for cygwin",
            "#include \"fips140.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [
            "#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trdlocal.h\"\t// needs to be included last for cygwin\n#include \"fips140.h\"\n#include \"pch.h\"\n\n#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0\n\nbool PowerUpSelfTestInProgressOnThisThread()\n{\n#if CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2\n\treturn AccessPowerUpSelfTestInProgress().GetValue() != NULL;\n#else\n\tassert(false);\t// should not be called\n\treturn false;\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "FIPS_140_2_ComplianceEnabled",
          "args": [],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "FIPS_140_2_ComplianceEnabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/fips140.cpp",
          "lines": "28-31",
          "snippet": "bool FIPS_140_2_ComplianceEnabled()\n{\n\treturn CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2;\n}",
          "includes": [
            "#include \"trdlocal.h\"\t// needs to be included last for cygwin",
            "#include \"fips140.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [
            "#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trdlocal.h\"\t// needs to be included last for cygwin\n#include \"fips140.h\"\n#include \"pch.h\"\n\n#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0\n\nbool FIPS_140_2_ComplianceEnabled()\n{\n\treturn CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nAlgorithm::Algorithm(bool checkSelfTestStatus)\n{\n\tif (checkSelfTestStatus && FIPS_140_2_ComplianceEnabled())\n\t{\n\t\tif (GetPowerUpSelfTestStatus() == POWER_UP_SELF_TEST_NOT_DONE && !PowerUpSelfTestInProgressOnThisThread())\n\t\t\tthrow SelfTestFailure(\"Cryptographic algorithms are disabled before the power-up self tests are performed.\");\n\n\t\tif (GetPowerUpSelfTestStatus() == POWER_UP_SELF_TEST_FAILED)\n\t\t\tthrow SelfTestFailure(\"Cryptographic algorithms are disabled after a power-up self test failed.\");\n\t}\n}"
  },
  {
    "function_name": "GetVoidValue",
    "container": "NullNameValuePairs",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
    "lines": "36-36",
    "snippet": "bool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const {return false;}",
    "includes": [
      "#include <memory>",
      "#include \"osrng.h\"",
      "#include \"trdlocal.h\"",
      "#include \"fltrimpl.h\"",
      "#include \"argnames.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"filters.h\"",
      "#include \"misc.h\"",
      "#include \"cryptlib.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nNullNameValuePairs {\n  bool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const {return false;}\n}"
  }
]