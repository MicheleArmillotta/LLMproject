[
  {
    "function_name": "GenerateEphemeralKeyPair",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "44-45",
    "snippet": "void GenerateEphemeralKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n\t\t{d2.GenerateKeyPair(rng, privateKey, publicKey);}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d2.GenerateKeyPair",
          "args": [
            "rng",
            "privateKey",
            "publicKey"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  void GenerateEphemeralKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n  \t\t{d2.GenerateKeyPair(rng, privateKey, publicKey);}\n}"
  },
  {
    "function_name": "GenerateEphemeralPublicKey",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "42-43",
    "snippet": "void GenerateEphemeralPublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n\t\t{d2.GeneratePublicKey(rng, privateKey, publicKey);}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d2.GeneratePublicKey",
          "args": [
            "rng",
            "privateKey",
            "publicKey"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "GeneratePublicKey",
          "container": "DH_Domain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh.h",
          "lines": "58-77",
          "snippet": "void GeneratePublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n\t{\n\t\tBase::GeneratePublicKey(rng, privateKey, publicKey);\n\n\t\tif (FIPS_140_2_ComplianceEnabled())\n\t\t{\n\t\t\tSecByteBlock privateKey2(this->PrivateKeyLength());\n\t\t\tthis->GeneratePrivateKey(rng, privateKey2);\n\n\t\t\tSecByteBlock publicKey2(this->PublicKeyLength());\n\t\t\tBase::GeneratePublicKey(rng, privateKey2, publicKey2);\n\n\t\t\tSecByteBlock agreedValue(this->AgreedValueLength()), agreedValue2(this->AgreedValueLength());\n\t\t\tbool agreed1 = this->Agree(agreedValue, privateKey, publicKey2);\n\t\t\tbool agreed2 = this->Agree(agreedValue2, privateKey2, publicKey);\n\n\t\t\tif (!agreed1 || !agreed2 || agreedValue != agreedValue2)\n\t\t\t\tthrow SelfTestFailure(this->AlgorithmName() + \": pairwise consistency test failed\");\n\t\t}\n\t}",
          "includes": [
            "#include \"gfpcrypt.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gfpcrypt.h\"\n\nDH_Domain {\n  void GeneratePublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n  \t{\n  \t\tBase::GeneratePublicKey(rng, privateKey, publicKey);\n  \n  \t\tif (FIPS_140_2_ComplianceEnabled())\n  \t\t{\n  \t\t\tSecByteBlock privateKey2(this->PrivateKeyLength());\n  \t\t\tthis->GeneratePrivateKey(rng, privateKey2);\n  \n  \t\t\tSecByteBlock publicKey2(this->PublicKeyLength());\n  \t\t\tBase::GeneratePublicKey(rng, privateKey2, publicKey2);\n  \n  \t\t\tSecByteBlock agreedValue(this->AgreedValueLength()), agreedValue2(this->AgreedValueLength());\n  \t\t\tbool agreed1 = this->Agree(agreedValue, privateKey, publicKey2);\n  \t\t\tbool agreed2 = this->Agree(agreedValue2, privateKey2, publicKey);\n  \n  \t\t\tif (!agreed1 || !agreed2 || agreedValue != agreedValue2)\n  \t\t\t\tthrow SelfTestFailure(this->AlgorithmName() + \": pairwise consistency test failed\");\n  \t\t}\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  void GenerateEphemeralPublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n  \t\t{d2.GeneratePublicKey(rng, privateKey, publicKey);}\n}"
  },
  {
    "function_name": "GenerateEphemeralPrivateKey",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "40-41",
    "snippet": "void GenerateEphemeralPrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n\t\t{d2.GeneratePrivateKey(rng, privateKey);}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d2.GeneratePrivateKey",
          "args": [
            "rng",
            "privateKey"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  void GenerateEphemeralPrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n  \t\t{d2.GeneratePrivateKey(rng, privateKey);}\n}"
  },
  {
    "function_name": "EphemeralPublicKeyLength",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "38-39",
    "snippet": "unsigned int EphemeralPublicKeyLength() const\n\t\t{return d2.PublicKeyLength();}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d2.PublicKeyLength",
          "args": [],
          "line": 39
        },
        "resolved": true,
        "details": {
          "function_name": "PublicKeyLength",
          "container": "XTR_DH",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.h",
          "lines": "31-31",
          "snippet": "unsigned int PublicKeyLength() const {return 2*m_p.ByteCount();}",
          "includes": [
            "#include \"xtr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xtr.h\"\n\nXTR_DH {\n  unsigned int PublicKeyLength() const {return 2*m_p.ByteCount();}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  unsigned int EphemeralPublicKeyLength() const\n  \t\t{return d2.PublicKeyLength();}\n}"
  },
  {
    "function_name": "EphemeralPrivateKeyLength",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "36-37",
    "snippet": "unsigned int EphemeralPrivateKeyLength() const\n\t\t{return d2.PrivateKeyLength();}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d2.PrivateKeyLength",
          "args": [],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "PrivateKeyLength",
          "container": "XTR_DH",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.h",
          "lines": "30-30",
          "snippet": "unsigned int PrivateKeyLength() const {return m_q.ByteCount();}",
          "includes": [
            "#include \"xtr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xtr.h\"\n\nXTR_DH {\n  unsigned int PrivateKeyLength() const {return m_q.ByteCount();}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  unsigned int EphemeralPrivateKeyLength() const\n  \t\t{return d2.PrivateKeyLength();}\n}"
  },
  {
    "function_name": "GenerateStaticKeyPair",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "33-34",
    "snippet": "void GenerateStaticKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n\t\t{d1.GenerateKeyPair(rng, privateKey, publicKey);}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d1.GenerateKeyPair",
          "args": [
            "rng",
            "privateKey",
            "publicKey"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  void GenerateStaticKeyPair(RandomNumberGenerator &rng, byte *privateKey, byte *publicKey) const\n  \t\t{d1.GenerateKeyPair(rng, privateKey, publicKey);}\n}"
  },
  {
    "function_name": "GenerateStaticPublicKey",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "31-32",
    "snippet": "void GenerateStaticPublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n\t\t{d1.GeneratePublicKey(rng, privateKey, publicKey);}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d1.GeneratePublicKey",
          "args": [
            "rng",
            "privateKey",
            "publicKey"
          ],
          "line": 32
        },
        "resolved": true,
        "details": {
          "function_name": "GeneratePublicKey",
          "container": "DH_Domain",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh.h",
          "lines": "58-77",
          "snippet": "void GeneratePublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n\t{\n\t\tBase::GeneratePublicKey(rng, privateKey, publicKey);\n\n\t\tif (FIPS_140_2_ComplianceEnabled())\n\t\t{\n\t\t\tSecByteBlock privateKey2(this->PrivateKeyLength());\n\t\t\tthis->GeneratePrivateKey(rng, privateKey2);\n\n\t\t\tSecByteBlock publicKey2(this->PublicKeyLength());\n\t\t\tBase::GeneratePublicKey(rng, privateKey2, publicKey2);\n\n\t\t\tSecByteBlock agreedValue(this->AgreedValueLength()), agreedValue2(this->AgreedValueLength());\n\t\t\tbool agreed1 = this->Agree(agreedValue, privateKey, publicKey2);\n\t\t\tbool agreed2 = this->Agree(agreedValue2, privateKey2, publicKey);\n\n\t\t\tif (!agreed1 || !agreed2 || agreedValue != agreedValue2)\n\t\t\t\tthrow SelfTestFailure(this->AlgorithmName() + \": pairwise consistency test failed\");\n\t\t}\n\t}",
          "includes": [
            "#include \"gfpcrypt.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gfpcrypt.h\"\n\nDH_Domain {\n  void GeneratePublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n  \t{\n  \t\tBase::GeneratePublicKey(rng, privateKey, publicKey);\n  \n  \t\tif (FIPS_140_2_ComplianceEnabled())\n  \t\t{\n  \t\t\tSecByteBlock privateKey2(this->PrivateKeyLength());\n  \t\t\tthis->GeneratePrivateKey(rng, privateKey2);\n  \n  \t\t\tSecByteBlock publicKey2(this->PublicKeyLength());\n  \t\t\tBase::GeneratePublicKey(rng, privateKey2, publicKey2);\n  \n  \t\t\tSecByteBlock agreedValue(this->AgreedValueLength()), agreedValue2(this->AgreedValueLength());\n  \t\t\tbool agreed1 = this->Agree(agreedValue, privateKey, publicKey2);\n  \t\t\tbool agreed2 = this->Agree(agreedValue2, privateKey2, publicKey);\n  \n  \t\t\tif (!agreed1 || !agreed2 || agreedValue != agreedValue2)\n  \t\t\t\tthrow SelfTestFailure(this->AlgorithmName() + \": pairwise consistency test failed\");\n  \t\t}\n  \t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  void GenerateStaticPublicKey(RandomNumberGenerator &rng, const byte *privateKey, byte *publicKey) const\n  \t\t{d1.GeneratePublicKey(rng, privateKey, publicKey);}\n}"
  },
  {
    "function_name": "GenerateStaticPrivateKey",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "29-30",
    "snippet": "void GenerateStaticPrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n\t\t{d1.GeneratePrivateKey(rng, privateKey);}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d1.GeneratePrivateKey",
          "args": [
            "rng",
            "privateKey"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  void GenerateStaticPrivateKey(RandomNumberGenerator &rng, byte *privateKey) const\n  \t\t{d1.GeneratePrivateKey(rng, privateKey);}\n}"
  },
  {
    "function_name": "StaticPublicKeyLength",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "27-28",
    "snippet": "unsigned int StaticPublicKeyLength() const\n\t\t{return d1.PublicKeyLength();}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d1.PublicKeyLength",
          "args": [],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "PublicKeyLength",
          "container": "XTR_DH",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.h",
          "lines": "31-31",
          "snippet": "unsigned int PublicKeyLength() const {return 2*m_p.ByteCount();}",
          "includes": [
            "#include \"xtr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xtr.h\"\n\nXTR_DH {\n  unsigned int PublicKeyLength() const {return 2*m_p.ByteCount();}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  unsigned int StaticPublicKeyLength() const\n  \t\t{return d1.PublicKeyLength();}\n}"
  },
  {
    "function_name": "StaticPrivateKeyLength",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "25-26",
    "snippet": "unsigned int StaticPrivateKeyLength() const\n\t\t{return d1.PrivateKeyLength();}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "d1.PrivateKeyLength",
          "args": [],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "PrivateKeyLength",
          "container": "XTR_DH",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtrcrypt.h",
          "lines": "30-30",
          "snippet": "unsigned int PrivateKeyLength() const {return m_q.ByteCount();}",
          "includes": [
            "#include \"xtr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"xtr.h\"\n\nXTR_DH {\n  unsigned int PrivateKeyLength() const {return m_q.ByteCount();}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  unsigned int StaticPrivateKeyLength() const\n  \t\t{return d1.PrivateKeyLength();}\n}"
  },
  {
    "function_name": "AgreedValueLength",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "22-23",
    "snippet": "unsigned int AgreedValueLength() const\n\t\t{return d1.AgreedValueLength() + d2.AgreedValueLength();}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  unsigned int AgreedValueLength() const\n  \t\t{return d1.AgreedValueLength() + d2.AgreedValueLength();}\n}"
  },
  {
    "function_name": "DH2",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "17-18",
    "snippet": "DH2(SimpleKeyAgreementDomain &staticDomain, SimpleKeyAgreementDomain &ephemeralDomain)\n\t\t: d1(staticDomain), d2(ephemeralDomain) {}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  DH2(SimpleKeyAgreementDomain &staticDomain, SimpleKeyAgreementDomain &ephemeralDomain)\n  \t\t: d1(staticDomain), d2(ephemeralDomain) {}\n}"
  },
  {
    "function_name": "DH2",
    "container": "DH2",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dh2.h",
    "lines": "15-16",
    "snippet": "DH2(SimpleKeyAgreementDomain &domain)\n\t\t: d1(domain), d2(domain) {}",
    "includes": [
      "#include \"cryptlib.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cryptlib.h\"\n\nDH2 {\n  DH2(SimpleKeyAgreementDomain &domain)\n  \t\t: d1(domain), d2(domain) {}\n}"
  }
]