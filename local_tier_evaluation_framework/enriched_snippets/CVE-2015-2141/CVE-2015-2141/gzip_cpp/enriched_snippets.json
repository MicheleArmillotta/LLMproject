[
  {
    "function_name": "ProcessPoststreamTail",
    "container": "Gunzip",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.cpp",
    "lines": "84-97",
    "snippet": "void Gunzip::ProcessPoststreamTail()\n{\n\tSecByteBlock crc(4);\n\tif (m_inQueue.Get(crc, 4) != 4)\n\t\tthrow TailErr();\n\tif (!m_crc.Verify(crc))\n\t\tthrow CrcErr();\n\n\tword32 lengthCheck;\n\tif (m_inQueue.GetWord32(lengthCheck, LITTLE_ENDIAN_ORDER) != 4)\n\t\tthrow TailErr();\n\tif (lengthCheck != m_length)\n\t\tthrow LengthErr();\n}",
    "includes": [
      "#include \"gzip.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LengthErr",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "LengthErr",
          "container": "Gunzip::LengthErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.h",
          "lines": "39-39",
          "snippet": "LengthErr() : Err(DATA_INTEGRITY_CHECK_FAILED, \"Gunzip: length check error\") {}",
          "includes": [
            "#include \"crc.h\"",
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"crc.h\"\n#include \"zinflate.h\"\n#include \"zdeflate.h\"\n\nGunzip {\n  LengthErr {\n    LengthErr() : Err(DATA_INTEGRITY_CHECK_FAILED, \"Gunzip: length check error\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "TailErr",
          "args": [],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "TailErr",
          "container": "Gunzip::TailErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.h",
          "lines": "37-37",
          "snippet": "TailErr() : Err(INVALID_DATA_FORMAT, \"Gunzip: tail too short\") {}",
          "includes": [
            "#include \"crc.h\"",
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"crc.h\"\n#include \"zinflate.h\"\n#include \"zdeflate.h\"\n\nGunzip {\n  TailErr {\n    TailErr() : Err(INVALID_DATA_FORMAT, \"Gunzip: tail too short\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.GetWord32",
          "args": [
            "lengthCheck",
            "LITTLE_ENDIAN_ORDER"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "GetWord32",
          "container": "BufferedTransformation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "645-648",
          "snippet": "size_t BufferedTransformation::GetWord32(word32 &value, ByteOrder order)\n{\n\treturn (size_t)Skip(PeekWord32(value, order));\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nBufferedTransformation {\n  size_t BufferedTransformation::GetWord32(word32 &value, ByteOrder order)\n  {\n  \treturn (size_t)Skip(PeekWord32(value, order));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CrcErr",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "CrcErr",
          "container": "Gunzip::CrcErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.h",
          "lines": "38-38",
          "snippet": "CrcErr() : Err(DATA_INTEGRITY_CHECK_FAILED, \"Gunzip: CRC check error\") {}",
          "includes": [
            "#include \"crc.h\"",
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"crc.h\"\n#include \"zinflate.h\"\n#include \"zdeflate.h\"\n\nGunzip {\n  CrcErr {\n    CrcErr() : Err(DATA_INTEGRITY_CHECK_FAILED, \"Gunzip: CRC check error\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_crc.Verify",
          "args": [
            "crc"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "Verify",
          "container": "PK_Verifier",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "778-782",
          "snippet": "bool PK_Verifier::Verify(PK_MessageAccumulator *messageAccumulator) const\n{\n\tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n\treturn VerifyAndRestart(*m);\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nPK_Verifier {\n  bool PK_Verifier::Verify(PK_MessageAccumulator *messageAccumulator) const\n  {\n  \tstd::auto_ptr<PK_MessageAccumulator> m(messageAccumulator);\n  \treturn VerifyAndRestart(*m);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.Get",
          "args": [
            "crc",
            "4"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ByteQueue::Walker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "492-496",
          "snippet": "size_t ByteQueue::Walker::Get(byte *outString, size_t getMax)\n{\n\tArraySink sink(outString, getMax);\n\treturn (size_t)TransferTo(sink, getMax);\n}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueue {\n  Walker {\n    size_t ByteQueue::Walker::Get(byte *outString, size_t getMax)\n    {\n    \tArraySink sink(outString, getMax);\n    \treturn (size_t)TransferTo(sink, getMax);\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"gzip.h\"\n#include \"pch.h\"\n\nGunzip {\n  void Gunzip::ProcessPoststreamTail()\n  {\n  \tSecByteBlock crc(4);\n  \tif (m_inQueue.Get(crc, 4) != 4)\n  \t\tthrow TailErr();\n  \tif (!m_crc.Verify(crc))\n  \t\tthrow CrcErr();\n  \n  \tword32 lengthCheck;\n  \tif (m_inQueue.GetWord32(lengthCheck, LITTLE_ENDIAN_ORDER) != 4)\n  \t\tthrow TailErr();\n  \tif (lengthCheck != m_length)\n  \t\tthrow LengthErr();\n  }\n}"
  },
  {
    "function_name": "ProcessDecompressedData",
    "container": "Gunzip",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.cpp",
    "lines": "77-82",
    "snippet": "void Gunzip::ProcessDecompressedData(const byte *inString, size_t length)\n{\n\tAttachedTransformation()->Put(inString, length);\n\tm_crc.Update(inString, length);\n\tm_length += (word32)length;\n}",
    "includes": [
      "#include \"gzip.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_crc.Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "Adler32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/adler32.cpp",
          "lines": "8-54",
          "snippet": "void Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}",
          "includes": [
            "#include \"adler32.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"adler32.h\"\n#include \"pch.h\"\n\nAdler32 {\n  void Adler32::Update(const byte *input, size_t length)\n  {\n  \tconst unsigned long BASE = 65521;\n  \n  \tunsigned long s1 = m_s1;\n  \tunsigned long s2 = m_s2;\n  \n  \tif (length % 8 != 0)\n  \t{\n  \t\tdo\n  \t\t{\n  \t\t\ts1 += *input++;\n  \t\t\ts2 += s1;\n  \t\t\tlength--;\n  \t\t} while (length % 8 != 0);\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\ts2 %= BASE;\n  \t}\n  \n  \twhile (length > 0)\n  \t{\n  \t\ts1 += input[0]; s2 += s1;\n  \t\ts1 += input[1]; s2 += s1;\n  \t\ts1 += input[2]; s2 += s1;\n  \t\ts1 += input[3]; s2 += s1;\n  \t\ts1 += input[4]; s2 += s1;\n  \t\ts1 += input[5]; s2 += s1;\n  \t\ts1 += input[6]; s2 += s1;\n  \t\ts1 += input[7]; s2 += s1;\n  \n  \t\tlength -= 8;\n  \t\tinput += 8;\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\tif (length % 0x8000 == 0)\n  \t\t\ts2 %= BASE;\n  \t}\n  \n  \tassert(s1 < BASE);\n  \tassert(s2 < BASE);\n  \n  \tm_s1 = (word16)s1;\n  \tm_s2 = (word16)s2;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "inString",
            "length"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gzip.h\"\n#include \"pch.h\"\n\nGunzip {\n  void Gunzip::ProcessDecompressedData(const byte *inString, size_t length)\n  {\n  \tAttachedTransformation()->Put(inString, length);\n  \tm_crc.Update(inString, length);\n  \tm_length += (word32)length;\n  }\n}"
  },
  {
    "function_name": "ProcessPrestreamHeader",
    "container": "Gunzip",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.cpp",
    "lines": "44-75",
    "snippet": "void Gunzip::ProcessPrestreamHeader()\n{\n\tm_length = 0;\n\tm_crc.Restart();\n\n\tbyte buf[6];\n\tbyte b, flags;\n\n\tif (m_inQueue.Get(buf, 2)!=2) throw HeaderErr();\n\tif (buf[0] != MAGIC1 || buf[1] != MAGIC2) throw HeaderErr();\n\tif (!m_inQueue.Skip(1)) throw HeaderErr();\t // skip extra flags\n\tif (!m_inQueue.Get(flags)) throw HeaderErr();\n\tif (flags & (ENCRYPTED | CONTINUED)) throw HeaderErr();\n\tif (m_inQueue.Skip(6)!=6) throw HeaderErr();    // Skip file time, extra flags and OS type\n\n\tif (flags & EXTRA_FIELDS)\t// skip extra fields\n\t{\n\t\tword16 length;\n\t\tif (m_inQueue.GetWord16(length, LITTLE_ENDIAN_ORDER) != 2) throw HeaderErr();\n\t\tif (m_inQueue.Skip(length)!=length) throw HeaderErr();\n\t}\n\n\tif (flags & FILENAME)\t// skip filename\n\t\tdo\n\t\t\tif(!m_inQueue.Get(b)) throw HeaderErr();\n\t\twhile (b);\n\n\tif (flags & COMMENTS)\t// skip comments\n\t\tdo\n\t\t\tif(!m_inQueue.Get(b)) throw HeaderErr();\n\t\twhile (b);\n}",
    "includes": [
      "#include \"gzip.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HeaderErr",
          "args": [],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "HeaderErr",
          "container": "Gunzip::HeaderErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.h",
          "lines": "36-36",
          "snippet": "HeaderErr() : Err(INVALID_DATA_FORMAT, \"Gunzip: header decoding error\") {}",
          "includes": [
            "#include \"crc.h\"",
            "#include \"zinflate.h\"",
            "#include \"zdeflate.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"crc.h\"\n#include \"zinflate.h\"\n#include \"zdeflate.h\"\n\nGunzip {\n  HeaderErr {\n    HeaderErr() : Err(INVALID_DATA_FORMAT, \"Gunzip: header decoding error\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.Get",
          "args": [
            "b"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.Skip",
          "args": [
            "length"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "Skip",
          "container": "FileStore",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/files.cpp",
          "lines": "168-179",
          "snippet": "lword FileStore::Skip(lword skipMax)\n{\n\tif (!m_stream)\n\t\treturn 0;\n\n\tlword oldPos = m_stream->tellg();\n\tstd::istream::off_type offset;\n\tif (!SafeConvert(skipMax, offset))\n\t\tthrow InvalidArgument(\"FileStore: maximum seek offset exceeded\");\n\tm_stream->seekg(offset, ios::cur);\n\treturn (lword)m_stream->tellg() - oldPos;\n}",
          "includes": [
            "#include <limits>",
            "#include \"files.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits>\n#include \"files.h\"\n#include \"pch.h\"\n\nFileStore {\n  lword FileStore::Skip(lword skipMax)\n  {\n  \tif (!m_stream)\n  \t\treturn 0;\n  \n  \tlword oldPos = m_stream->tellg();\n  \tstd::istream::off_type offset;\n  \tif (!SafeConvert(skipMax, offset))\n  \t\tthrow InvalidArgument(\"FileStore: maximum seek offset exceeded\");\n  \tm_stream->seekg(offset, ios::cur);\n  \treturn (lword)m_stream->tellg() - oldPos;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.GetWord16",
          "args": [
            "length",
            "LITTLE_ENDIAN_ORDER"
          ],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "GetWord16",
          "container": "BufferedTransformation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "640-643",
          "snippet": "size_t BufferedTransformation::GetWord16(word16 &value, ByteOrder order)\n{\n\treturn (size_t)Skip(PeekWord16(value, order));\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nBufferedTransformation {\n  size_t BufferedTransformation::GetWord16(word16 &value, ByteOrder order)\n  {\n  \treturn (size_t)Skip(PeekWord16(value, order));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_inQueue.Get",
          "args": [
            "buf",
            "2"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ByteQueue::Walker",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "492-496",
          "snippet": "size_t ByteQueue::Walker::Get(byte *outString, size_t getMax)\n{\n\tArraySink sink(outString, getMax);\n\treturn (size_t)TransferTo(sink, getMax);\n}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueue {\n  Walker {\n    size_t ByteQueue::Walker::Get(byte *outString, size_t getMax)\n    {\n    \tArraySink sink(outString, getMax);\n    \treturn (size_t)TransferTo(sink, getMax);\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_crc.Restart",
          "args": [],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "Restart",
          "container": "IteratedHashBase<T, BASE>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.cpp",
          "lines": "120-124",
          "snippet": "void IteratedHashBase<T, BASE>::Restart()\n{\n\tm_countLo = m_countHi = 0;\n\tInit();\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"iterhash.h\"\n\nIteratedHashBase<T, BASE> {\n  void IteratedHashBase<T, BASE>::Restart()\n  {\n  \tm_countLo = m_countHi = 0;\n  \tInit();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"gzip.h\"\n#include \"pch.h\"\n\nGunzip {\n  void Gunzip::ProcessPrestreamHeader()\n  {\n  \tm_length = 0;\n  \tm_crc.Restart();\n  \n  \tbyte buf[6];\n  \tbyte b, flags;\n  \n  \tif (m_inQueue.Get(buf, 2)!=2) throw HeaderErr();\n  \tif (buf[0] != MAGIC1 || buf[1] != MAGIC2) throw HeaderErr();\n  \tif (!m_inQueue.Skip(1)) throw HeaderErr();\t // skip extra flags\n  \tif (!m_inQueue.Get(flags)) throw HeaderErr();\n  \tif (flags & (ENCRYPTED | CONTINUED)) throw HeaderErr();\n  \tif (m_inQueue.Skip(6)!=6) throw HeaderErr();    // Skip file time, extra flags and OS type\n  \n  \tif (flags & EXTRA_FIELDS)\t// skip extra fields\n  \t{\n  \t\tword16 length;\n  \t\tif (m_inQueue.GetWord16(length, LITTLE_ENDIAN_ORDER) != 2) throw HeaderErr();\n  \t\tif (m_inQueue.Skip(length)!=length) throw HeaderErr();\n  \t}\n  \n  \tif (flags & FILENAME)\t// skip filename\n  \t\tdo\n  \t\t\tif(!m_inQueue.Get(b)) throw HeaderErr();\n  \t\twhile (b);\n  \n  \tif (flags & COMMENTS)\t// skip comments\n  \t\tdo\n  \t\t\tif(!m_inQueue.Get(b)) throw HeaderErr();\n  \t\twhile (b);\n  }\n}"
  },
  {
    "function_name": "Gunzip",
    "container": "Gunzip",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.cpp",
    "lines": "39-42",
    "snippet": "Gunzip::Gunzip(BufferedTransformation *attachment, bool repeat, int propagation)\n\t: Inflator(attachment, repeat, propagation)\n{\n}",
    "includes": [
      "#include \"gzip.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"gzip.h\"\n#include \"pch.h\"\n\nGunzip {\n  Gunzip::Gunzip(BufferedTransformation *attachment, bool repeat, int propagation)\n  \t: Inflator(attachment, repeat, propagation)\n  {\n  }\n}"
  },
  {
    "function_name": "WritePoststreamTail",
    "container": "Gzip",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.cpp",
    "lines": "29-35",
    "snippet": "void Gzip::WritePoststreamTail()\n{\n\tSecByteBlock crc(4);\n\tm_crc.Final(crc);\n\tAttachedTransformation()->Put(crc, 4);\n\tAttachedTransformation()->PutWord32(m_totalLen, LITTLE_ENDIAN_ORDER);\n}",
    "includes": [
      "#include \"gzip.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "m_totalLen",
            "LITTLE_ENDIAN_ORDER"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "crc",
            "4"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_crc.Final",
          "args": [
            "crc"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gzip.h\"\n#include \"pch.h\"\n\nGzip {\n  void Gzip::WritePoststreamTail()\n  {\n  \tSecByteBlock crc(4);\n  \tm_crc.Final(crc);\n  \tAttachedTransformation()->Put(crc, 4);\n  \tAttachedTransformation()->PutWord32(m_totalLen, LITTLE_ENDIAN_ORDER);\n  }\n}"
  },
  {
    "function_name": "ProcessUncompressedData",
    "container": "Gzip",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.cpp",
    "lines": "23-27",
    "snippet": "void Gzip::ProcessUncompressedData(const byte *inString, size_t length)\n{\n\tm_crc.Update(inString, length);\n\tm_totalLen += (word32)length;\n}",
    "includes": [
      "#include \"gzip.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_crc.Update",
          "args": [
            "inString",
            "length"
          ],
          "line": 25
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "Adler32",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/adler32.cpp",
          "lines": "8-54",
          "snippet": "void Adler32::Update(const byte *input, size_t length)\n{\n\tconst unsigned long BASE = 65521;\n\n\tunsigned long s1 = m_s1;\n\tunsigned long s2 = m_s2;\n\n\tif (length % 8 != 0)\n\t{\n\t\tdo\n\t\t{\n\t\t\ts1 += *input++;\n\t\t\ts2 += s1;\n\t\t\tlength--;\n\t\t} while (length % 8 != 0);\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\ts2 %= BASE;\n\t}\n\n\twhile (length > 0)\n\t{\n\t\ts1 += input[0]; s2 += s1;\n\t\ts1 += input[1]; s2 += s1;\n\t\ts1 += input[2]; s2 += s1;\n\t\ts1 += input[3]; s2 += s1;\n\t\ts1 += input[4]; s2 += s1;\n\t\ts1 += input[5]; s2 += s1;\n\t\ts1 += input[6]; s2 += s1;\n\t\ts1 += input[7]; s2 += s1;\n\n\t\tlength -= 8;\n\t\tinput += 8;\n\n\t\tif (s1 >= BASE)\n\t\t\ts1 -= BASE;\n\t\tif (length % 0x8000 == 0)\n\t\t\ts2 %= BASE;\n\t}\n\n\tassert(s1 < BASE);\n\tassert(s2 < BASE);\n\n\tm_s1 = (word16)s1;\n\tm_s2 = (word16)s2;\n}",
          "includes": [
            "#include \"adler32.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"adler32.h\"\n#include \"pch.h\"\n\nAdler32 {\n  void Adler32::Update(const byte *input, size_t length)\n  {\n  \tconst unsigned long BASE = 65521;\n  \n  \tunsigned long s1 = m_s1;\n  \tunsigned long s2 = m_s2;\n  \n  \tif (length % 8 != 0)\n  \t{\n  \t\tdo\n  \t\t{\n  \t\t\ts1 += *input++;\n  \t\t\ts2 += s1;\n  \t\t\tlength--;\n  \t\t} while (length % 8 != 0);\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\ts2 %= BASE;\n  \t}\n  \n  \twhile (length > 0)\n  \t{\n  \t\ts1 += input[0]; s2 += s1;\n  \t\ts1 += input[1]; s2 += s1;\n  \t\ts1 += input[2]; s2 += s1;\n  \t\ts1 += input[3]; s2 += s1;\n  \t\ts1 += input[4]; s2 += s1;\n  \t\ts1 += input[5]; s2 += s1;\n  \t\ts1 += input[6]; s2 += s1;\n  \t\ts1 += input[7]; s2 += s1;\n  \n  \t\tlength -= 8;\n  \t\tinput += 8;\n  \n  \t\tif (s1 >= BASE)\n  \t\t\ts1 -= BASE;\n  \t\tif (length % 0x8000 == 0)\n  \t\t\ts2 %= BASE;\n  \t}\n  \n  \tassert(s1 < BASE);\n  \tassert(s2 < BASE);\n  \n  \tm_s1 = (word16)s1;\n  \tm_s2 = (word16)s2;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"gzip.h\"\n#include \"pch.h\"\n\nGzip {\n  void Gzip::ProcessUncompressedData(const byte *inString, size_t length)\n  {\n  \tm_crc.Update(inString, length);\n  \tm_totalLen += (word32)length;\n  }\n}"
  },
  {
    "function_name": "WritePrestreamHeader",
    "container": "Gzip",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gzip.cpp",
    "lines": "8-21",
    "snippet": "void Gzip::WritePrestreamHeader()\n{\n\tm_totalLen = 0;\n\tm_crc.Restart();\n\n\tAttachedTransformation()->Put(MAGIC1);\n\tAttachedTransformation()->Put(MAGIC2);\n\tAttachedTransformation()->Put(DEFLATED);\n\tAttachedTransformation()->Put(0);\t\t// general flag\n\tAttachedTransformation()->PutWord32(0);\t// time stamp\n\tbyte extra = (GetDeflateLevel() == 1) ? FAST : ((GetDeflateLevel() == 9) ? SLOW : 0);\n\tAttachedTransformation()->Put(extra);\n\tAttachedTransformation()->Put(GZIP_OS_CODE);\n}",
    "includes": [
      "#include \"gzip.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "GZIP_OS_CODE"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "extra"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDeflateLevel",
          "args": [],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "GetDeflateLevel",
          "container": "Deflator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zdeflate.h",
          "lines": "69-69",
          "snippet": "int GetDeflateLevel() const {return m_deflateLevel;}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"filters.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"filters.h\"\n\nDeflator {\n  int GetDeflateLevel() const {return m_deflateLevel;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "0"
          ],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "0"
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "DEFLATED"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "MAGIC2"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "MAGIC1"
          ],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_crc.Restart",
          "args": [],
          "line": 11
        },
        "resolved": true,
        "details": {
          "function_name": "Restart",
          "container": "IteratedHashBase<T, BASE>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.cpp",
          "lines": "120-124",
          "snippet": "void IteratedHashBase<T, BASE>::Restart()\n{\n\tm_countLo = m_countHi = 0;\n\tInit();\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"iterhash.h\"\n\nIteratedHashBase<T, BASE> {\n  void IteratedHashBase<T, BASE>::Restart()\n  {\n  \tm_countLo = m_countHi = 0;\n  \tInit();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"gzip.h\"\n#include \"pch.h\"\n\nGzip {\n  void Gzip::WritePrestreamHeader()\n  {\n  \tm_totalLen = 0;\n  \tm_crc.Restart();\n  \n  \tAttachedTransformation()->Put(MAGIC1);\n  \tAttachedTransformation()->Put(MAGIC2);\n  \tAttachedTransformation()->Put(DEFLATED);\n  \tAttachedTransformation()->Put(0);\t\t// general flag\n  \tAttachedTransformation()->PutWord32(0);\t// time stamp\n  \tbyte extra = (GetDeflateLevel() == 1) ? FAST : ((GetDeflateLevel() == 9) ? SLOW : 0);\n  \tAttachedTransformation()->Put(extra);\n  \tAttachedTransformation()->Put(GZIP_OS_CODE);\n  }\n}"
  }
]