[
  {
    "function_name": "resize",
    "container": "vector_member_ptrs",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "203-211",
    "snippet": "void resize(size_t newSize)\n\t{\n\t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n\t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n\t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n\t\tdelete [] this->m_ptr;\n\t\tthis->m_size = newSize;\n\t\tthis->m_ptr = newPtr;\n\t}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "newPtr[i].reset",
          "args": [
            "this->m_ptr[i].release()"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "this->m_ptr[i].release",
          "args": [],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  void resize(size_t newSize)\n  \t{\n  \t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n  \t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n  \t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n  \t\tdelete [] this->m_ptr;\n  \t\tthis->m_size = newSize;\n  \t\tthis->m_ptr = newPtr;\n  \t}\n}"
  },
  {
    "function_name": "size",
    "container": "vector_member_ptrs",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "202-202",
    "snippet": "size_t size() const {return this->m_size;}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
  },
  {
    "function_name": "vector_member_ptrs",
    "container": "vector_member_ptrs",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "192-193",
    "snippet": "vector_member_ptrs(size_t size=0)\n\t\t: m_size(size), m_ptr(new member_ptr<T>[size]) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  vector_member_ptrs(size_t size=0)\n  \t\t: m_size(size), m_ptr(new member_ptr<T>[size]) {}\n}"
  },
  {
    "function_name": "counted_ptr<T>::attach",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "146-160",
    "snippet": "void counted_ptr<T>::attach(const T &r)\n{\n\tif (m_p && --m_p->m_referenceCount == 0)\n\t\tdelete m_p;\n\tif (r.m_referenceCount == 0)\n\t{\n\t\tm_p = r.clone();\n\t\tm_p->m_referenceCount = 1;\n\t}\n\telse\n\t{\n\t\tm_p = const_cast<T *>(&r);\n\t\tm_p->m_referenceCount++;\n\t}\n}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "const_cast<T *>",
          "args": [
            "&r"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.clone",
          "args": [],
          "line": 152
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvoid counted_ptr<T>::attach(const T &r)\n{\n\tif (m_p && --m_p->m_referenceCount == 0)\n\t\tdelete m_p;\n\tif (r.m_referenceCount == 0)\n\t{\n\t\tm_p = r.clone();\n\t\tm_p->m_referenceCount = 1;\n\t}\n\telse\n\t{\n\t\tm_p = const_cast<T *>(&r);\n\t\tm_p->m_referenceCount++;\n\t}\n}"
  },
  {
    "function_name": "counted_ptr<T>::~counted_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "140-144",
    "snippet": "counted_ptr<T>::~counted_ptr()\n{\n\tif (m_p && --m_p->m_referenceCount == 0)\n\t\tdelete m_p;\n}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\ncounted_ptr<T>::~counted_ptr()\n{\n\tif (m_p && --m_p->m_referenceCount == 0)\n\t\tdelete m_p;\n}"
  },
  {
    "function_name": "counted_ptr<T>::counted_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "133-138",
    "snippet": "counted_ptr<T>::counted_ptr(const counted_ptr<T>& rhs)\n\t: m_p(rhs.m_p)\n{\n\tif (m_p)\n\t\tm_p->m_referenceCount++;\n}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\ncounted_ptr<T>::counted_ptr(const counted_ptr<T>& rhs)\n\t: m_p(rhs.m_p)\n{\n\tif (m_p)\n\t\tm_p->m_referenceCount++;\n}"
  },
  {
    "function_name": "counted_ptr<T>::counted_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "126-131",
    "snippet": "counted_ptr<T>::counted_ptr(T *p)\n\t: m_p(p) \n{\n\tif (m_p)\n\t\tm_p->m_referenceCount = 1;\n}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\ncounted_ptr<T>::counted_ptr(T *p)\n\t: m_p(p) \n{\n\tif (m_p)\n\t\tm_p->m_referenceCount = 1;\n}"
  },
  {
    "function_name": "counted_ptr",
    "container": "counted_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "104-104",
    "snippet": "counted_ptr(const T &r) : m_p(0) {attach(r);}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "attach",
          "args": [
            "r"
          ],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "counted_ptr<T>::attach",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "146-160",
          "snippet": "void counted_ptr<T>::attach(const T &r)\n{\n\tif (m_p && --m_p->m_referenceCount == 0)\n\t\tdelete m_p;\n\tif (r.m_referenceCount == 0)\n\t{\n\t\tm_p = r.clone();\n\t\tm_p->m_referenceCount = 1;\n\t}\n\telse\n\t{\n\t\tm_p = const_cast<T *>(&r);\n\t\tm_p->m_referenceCount++;\n\t}\n}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvoid counted_ptr<T>::attach(const T &r)\n{\n\tif (m_p && --m_p->m_referenceCount == 0)\n\t\tdelete m_p;\n\tif (r.m_referenceCount == 0)\n\t{\n\t\tm_p = r.clone();\n\t\tm_p->m_referenceCount = 1;\n\t}\n\telse\n\t{\n\t\tm_p = const_cast<T *>(&r);\n\t\tm_p->m_referenceCount++;\n\t}\n}"
        }
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\ncounted_ptr {\n  counted_ptr(const T &r) : m_p(0) {attach(r);}\n}"
  },
  {
    "function_name": "clonable_ptr",
    "container": "clonable_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "84-85",
    "snippet": "clonable_ptr(const clonable_ptr<T>& rhs)\n\t\t: member_ptr<T>(rhs.m_p ? rhs.m_p->Clone() : NULL) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rhs.m_p->Clone",
          "args": [],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nclonable_ptr {\n  clonable_ptr(const clonable_ptr<T>& rhs)\n  \t\t: member_ptr<T>(rhs.m_p ? rhs.m_p->Clone() : NULL) {}\n}"
  },
  {
    "function_name": "clonable_ptr",
    "container": "clonable_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "83-83",
    "snippet": "clonable_ptr(T *p = NULL) : member_ptr<T>(p) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nclonable_ptr {\n  clonable_ptr(T *p = NULL) : member_ptr<T>(p) {}\n}"
  },
  {
    "function_name": "clonable_ptr",
    "container": "clonable_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "82-82",
    "snippet": "clonable_ptr(const T &obj) : member_ptr<T>(obj.Clone()) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "obj.Clone",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nclonable_ptr {\n  clonable_ptr(const T &obj) : member_ptr<T>(obj.Clone()) {}\n}"
  },
  {
    "function_name": "value_ptr",
    "container": "value_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "59-60",
    "snippet": "value_ptr(const value_ptr<T>& rhs)\n\t\t: member_ptr<T>(rhs.m_p ? new T(*rhs.m_p) : NULL) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvalue_ptr {\n  value_ptr(const value_ptr<T>& rhs)\n  \t\t: member_ptr<T>(rhs.m_p ? new T(*rhs.m_p) : NULL) {}\n}"
  },
  {
    "function_name": "value_ptr",
    "container": "value_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "58-58",
    "snippet": "value_ptr(T *p = NULL) : member_ptr<T>(p) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvalue_ptr {\n  value_ptr(T *p = NULL) : member_ptr<T>(p) {}\n}"
  },
  {
    "function_name": "value_ptr",
    "container": "value_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "57-57",
    "snippet": "value_ptr(const T &obj) : member_ptr<T>(new T(obj)) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvalue_ptr {\n  value_ptr(const T &obj) : member_ptr<T>(new T(obj)) {}\n}"
  },
  {
    "function_name": "member_ptr<T>::reset",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "50-50",
    "snippet": "void member_ptr<T>::reset(T *p) {delete m_p; m_p = p;}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvoid member_ptr<T>::reset(T *p) {delete m_p; m_p = p;}"
  },
  {
    "function_name": "member_ptr<T>::~member_ptr",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "49-49",
    "snippet": "member_ptr<T>::~member_ptr() {delete m_p;}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nmember_ptr<T>::~member_ptr() {delete m_p;}"
  },
  {
    "function_name": "member_ptr",
    "container": "member_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "20-20",
    "snippet": "explicit member_ptr(T *p = NULL) : m_p(p) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nmember_ptr {\n  explicit member_ptr(T *p = NULL) : m_p(p) {}\n}"
  },
  {
    "function_name": "simple_ptr",
    "container": "simple_ptr",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
    "lines": "12-12",
    "snippet": "simple_ptr(T *p = NULL) : m_p(p) {}",
    "includes": [
      "#include <algorithm>",
      "#include \"config.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nsimple_ptr {\n  simple_ptr(T *p = NULL) : m_p(p) {}\n}"
  }
]