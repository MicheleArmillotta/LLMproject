[
  {
    "function_name": "InvertibleRSAFunction_ISO::CalculateInverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "296-300",
    "snippet": "Integer InvertibleRSAFunction_ISO::CalculateInverse(RandomNumberGenerator &rng, const Integer &x) const \n{\n\tInteger t = InvertibleRSAFunction::CalculateInverse(rng, x);\n\treturn STDMIN(t, m_n-t);\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STDMIN",
          "args": [
            "t",
            "m_n-t"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvertibleRSAFunction::CalculateInverse",
          "args": [
            "rng",
            "x"
          ],
          "line": 298
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nInteger InvertibleRSAFunction_ISO::CalculateInverse(RandomNumberGenerator &rng, const Integer &x) const \n{\n\tInteger t = InvertibleRSAFunction::CalculateInverse(rng, x);\n\treturn STDMIN(t, m_n-t);\n}"
  },
  {
    "function_name": "RSAFunction_ISO::ApplyFunction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "290-294",
    "snippet": "Integer RSAFunction_ISO::ApplyFunction(const Integer &x) const\n{\n\tInteger t = RSAFunction::ApplyFunction(x);\n\treturn t % 16 == 12 ? t : m_n - t;\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RSAFunction::ApplyFunction",
          "args": [
            "x"
          ],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "RSAFunction::ApplyFunction",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
          "lines": "64-68",
          "snippet": "Integer RSAFunction::ApplyFunction(const Integer &x) const\n{\n\tDoQuickSanityCheck();\n\treturn a_exp_b_mod_c(x, m_e, m_n);\n}",
          "includes": [
            "#include \"pssr.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"rsa.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nInteger RSAFunction::ApplyFunction(const Integer &x) const\n{\n\tDoQuickSanityCheck();\n\treturn a_exp_b_mod_c(x, m_e, m_n);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nInteger RSAFunction_ISO::ApplyFunction(const Integer &x) const\n{\n\tInteger t = RSAFunction::ApplyFunction(x);\n\treturn t % 16 == 12 ? t : m_n - t;\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::AssignFrom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "276-286",
    "snippet": "void InvertibleRSAFunction::AssignFrom(const NameValuePairs &source)\n{\n\tAssignFromHelper<RSAFunction>(this, source)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(Prime1)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(Prime2)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(PrivateExponent)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(ModPrime1PrivateExponent)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(ModPrime2PrivateExponent)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(MultiplicativeInverseOfPrime2ModPrime1)\n\t\t;\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "MultiplicativeInverseOfPrime2ModPrime1"
          ],
          "line": 284
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "ModPrime2PrivateExponent"
          ],
          "line": 283
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "ModPrime1PrivateExponent"
          ],
          "line": 282
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "PrivateExponent"
          ],
          "line": 281
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "Prime2"
          ],
          "line": 280
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "Prime1"
          ],
          "line": 279
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssignFromHelper<RSAFunction>",
          "args": [
            "this",
            "source"
          ],
          "line": 278
        },
        "resolved": true,
        "details": {
          "function_name": "AssignFromHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "235-238",
          "snippet": "AssignFromHelperClass<T, T> AssignFromHelper(T *pObject, const NameValuePairs &source)\n{\n\treturn AssignFromHelperClass<T, T>(pObject, source);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAssignFromHelperClass<T, T> AssignFromHelper(T *pObject, const NameValuePairs &source)\n{\n\treturn AssignFromHelperClass<T, T>(pObject, source);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid InvertibleRSAFunction::AssignFrom(const NameValuePairs &source)\n{\n\tAssignFromHelper<RSAFunction>(this, source)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(Prime1)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(Prime2)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(PrivateExponent)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(ModPrime1PrivateExponent)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(ModPrime2PrivateExponent)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(MultiplicativeInverseOfPrime2ModPrime1)\n\t\t;\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::GetVoidValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "264-274",
    "snippet": "bool InvertibleRSAFunction::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\treturn GetValueHelper<RSAFunction>(this, name, valueType, pValue).Assignable()\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Prime1)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Prime2)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(PrivateExponent)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(ModPrime1PrivateExponent)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(ModPrime2PrivateExponent)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(MultiplicativeInverseOfPrime2ModPrime1)\n\t\t;\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "MultiplicativeInverseOfPrime2ModPrime1"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "ModPrime2PrivateExponent"
          ],
          "line": 271
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "ModPrime1PrivateExponent"
          ],
          "line": 270
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "PrivateExponent"
          ],
          "line": 269
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "Prime2"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "Prime1"
          ],
          "line": 267
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetValueHelper<RSAFunction>",
          "args": [],
          "line": 266
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetValueHelper<RSAFunction>",
          "args": [
            "this",
            "name",
            "valueType",
            "pValue"
          ],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "GetValueHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "161-164",
          "snippet": "GetValueHelperClass<T, T> GetValueHelper(const T *pObject, const char *name, const std::type_info &valueType, void *pValue, const NameValuePairs *searchFirst=NULL)\n{\n\treturn GetValueHelperClass<T, T>(pObject, name, valueType, pValue, searchFirst);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nGetValueHelperClass<T, T> GetValueHelper(const T *pObject, const char *name, const std::type_info &valueType, void *pValue, const NameValuePairs *searchFirst=NULL)\n{\n\treturn GetValueHelperClass<T, T>(pObject, name, valueType, pValue, searchFirst);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nbool InvertibleRSAFunction::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\treturn GetValueHelper<RSAFunction>(this, name, valueType, pValue).Assignable()\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Prime1)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Prime2)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(PrivateExponent)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(ModPrime1PrivateExponent)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(ModPrime2PrivateExponent)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(MultiplicativeInverseOfPrime2ModPrime1)\n\t\t;\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::Validate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "243-262",
    "snippet": "bool InvertibleRSAFunction::Validate(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tbool pass = RSAFunction::Validate(rng, level);\n\tpass = pass && m_p > Integer::One() && m_p.IsOdd() && m_p < m_n;\n\tpass = pass && m_q > Integer::One() && m_q.IsOdd() && m_q < m_n;\n\tpass = pass && m_d > Integer::One() && m_d.IsOdd() && m_d < m_n;\n\tpass = pass && m_dp > Integer::One() && m_dp.IsOdd() && m_dp < m_p;\n\tpass = pass && m_dq > Integer::One() && m_dq.IsOdd() && m_dq < m_q;\n\tpass = pass && m_u.IsPositive() && m_u < m_p;\n\tif (level >= 1)\n\t{\n\t\tpass = pass && m_p * m_q == m_n;\n\t\tpass = pass && m_e*m_d % LCM(m_p-1, m_q-1) == 1;\n\t\tpass = pass && m_dp == m_d%(m_p-1) && m_dq == m_d%(m_q-1);\n\t\tpass = pass && m_u * m_q % m_p == 1;\n\t}\n\tif (level >= 2)\n\t\tpass = pass && VerifyPrime(rng, m_p, level-2) && VerifyPrime(rng, m_q, level-2);\n\treturn pass;\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VerifyPrime",
          "args": [
            "rng",
            "m_q",
            "level-2"
          ],
          "line": 260
        },
        "resolved": true,
        "details": {
          "function_name": "VerifyPrime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.cpp",
          "lines": "247-253",
          "snippet": "bool VerifyPrime(RandomNumberGenerator &rng, const Integer &p, unsigned int level)\n{\n\tbool pass = IsPrime(p) && RabinMillerTest(rng, p, 1);\n\tif (level >= 1)\n\t\tpass = pass && RabinMillerTest(rng, p, 10);\n\treturn pass;\n}",
          "includes": [
            "#include <omp.h>",
            "#include <vector>",
            "#include <math.h>",
            "#include \"algparam.h\"",
            "#include \"modarith.h\"",
            "#include \"nbtheory.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <omp.h>\n#include <vector>\n#include <math.h>\n#include \"algparam.h\"\n#include \"modarith.h\"\n#include \"nbtheory.h\"\n#include \"pch.h\"\n\nbool VerifyPrime(RandomNumberGenerator &rng, const Integer &p, unsigned int level)\n{\n\tbool pass = IsPrime(p) && RabinMillerTest(rng, p, 1);\n\tif (level >= 1)\n\t\tpass = pass && RabinMillerTest(rng, p, 10);\n\treturn pass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "LCM",
          "args": [
            "m_p-1",
            "m_q-1"
          ],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "LCM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.h",
          "lines": "67-68",
          "snippet": "inline Integer LCM(const Integer &a, const Integer &b)\n\t{return a/Integer::Gcd(a,b)*b;}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"integer.h\"\n\ninline Integer LCM(const Integer &a, const Integer &b)\n\t{return a/Integer::Gcd(a,b)*b;}"
        }
      },
      {
        "call_info": {
          "callee": "m_u.IsPositive",
          "args": [],
          "line": 251
        },
        "resolved": true,
        "details": {
          "function_name": "IsPositive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "205-205",
          "snippet": "bool IsPositive() const {return NotNegative() && NotZero();}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsPositive() const {return NotNegative() && NotZero();}"
        }
      },
      {
        "call_info": {
          "callee": "m_dq.IsOdd",
          "args": [],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "IsOdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "211-211",
          "snippet": "bool IsOdd() const\t{return GetBit(0) == 1;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsOdd() const\t{return GetBit(0) == 1;}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::One",
          "args": [],
          "line": 250
        },
        "resolved": true,
        "details": {
          "function_name": "One",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "44-45",
          "snippet": "Element One() const\n\t\t{return 1;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element One() const\n  \t\t{return 1;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nbool InvertibleRSAFunction::Validate(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tbool pass = RSAFunction::Validate(rng, level);\n\tpass = pass && m_p > Integer::One() && m_p.IsOdd() && m_p < m_n;\n\tpass = pass && m_q > Integer::One() && m_q.IsOdd() && m_q < m_n;\n\tpass = pass && m_d > Integer::One() && m_d.IsOdd() && m_d < m_n;\n\tpass = pass && m_dp > Integer::One() && m_dp.IsOdd() && m_dp < m_p;\n\tpass = pass && m_dq > Integer::One() && m_dq.IsOdd() && m_dq < m_q;\n\tpass = pass && m_u.IsPositive() && m_u < m_p;\n\tif (level >= 1)\n\t{\n\t\tpass = pass && m_p * m_q == m_n;\n\t\tpass = pass && m_e*m_d % LCM(m_p-1, m_q-1) == 1;\n\t\tpass = pass && m_dp == m_d%(m_p-1) && m_dq == m_d%(m_q-1);\n\t\tpass = pass && m_u * m_q % m_p == 1;\n\t}\n\tif (level >= 2)\n\t\tpass = pass && VerifyPrime(rng, m_p, level-2) && VerifyPrime(rng, m_q, level-2);\n\treturn pass;\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::CalculateInverse",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "223-241",
    "snippet": "Integer InvertibleRSAFunction::CalculateInverse(RandomNumberGenerator &rng, const Integer &x) const \n{\n\tDoQuickSanityCheck();\n\tModularArithmetic modn(m_n);\n\tInteger r, rInv;\n\tdo {\t// do this in a loop for people using small numbers for testing\n\t\tr.Randomize(rng, Integer::One(), m_n - Integer::One());\n\t\trInv = modn.MultiplicativeInverse(r);\n\t} while (rInv.IsZero());\n\tInteger re = modn.Exponentiate(r, m_e);\n\tre = modn.Multiply(re, x);\t\t\t// blind\n\t// here we follow the notation of PKCS #1 and let u=q inverse mod p\n\t// but in ModRoot, u=p inverse mod q, so we reverse the order of p and q\n\tInteger y = ModularRoot(re, m_dq, m_dp, m_q, m_p, m_u);\n\ty = modn.Multiply(y, rInv);\t\t\t\t// unblind\n\tif (modn.Exponentiate(y, m_e) != x)\t\t// check\n\t\tthrow Exception(Exception::OTHER_ERROR, \"InvertibleRSAFunction: computational error during private key operation\");\n\treturn y;\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Exception",
          "args": [
            "Exception::OTHER_ERROR",
            "\"InvertibleRSAFunction: computational error during private key operation\""
          ],
          "line": 239
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "modn.Exponentiate",
          "args": [
            "y",
            "m_e"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "Exponentiate",
          "container": "GFP2_ONB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "158-164",
          "snippet": "Element Exponentiate(const Element &a, const Integer &e) const\n\t{\n\t\tInteger edivp, emodp;\n\t\tInteger::Divide(emodp, edivp, e, modp.GetModulus());\n\t\tElement b = PthPower(a);\n\t\treturn AbstractRing<GFP2Element>::CascadeExponentiate(a, emodp, b, edivp);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2_ONB {\n  Element Exponentiate(const Element &a, const Integer &e) const\n  \t{\n  \t\tInteger edivp, emodp;\n  \t\tInteger::Divide(emodp, edivp, e, modp.GetModulus());\n  \t\tElement b = PthPower(a);\n  \t\treturn AbstractRing<GFP2Element>::CascadeExponentiate(a, emodp, b, edivp);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "modn.Multiply",
          "args": [
            "y",
            "rInv"
          ],
          "line": 237
        },
        "resolved": true,
        "details": {
          "function_name": "Multiply",
          "container": "Word",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "309-314",
          "snippet": "static Word Multiply(hword a, hword b)\n\t{\n\t\tWord r;\n\t\tr.m_whole = (word)a * b;\n\t\treturn r;\n\t}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nWord {\n  static Word Multiply(hword a, hword b)\n  \t{\n  \t\tWord r;\n  \t\tr.m_whole = (word)a * b;\n  \t\treturn r;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ModularRoot",
          "args": [
            "re",
            "m_dq",
            "m_dp",
            "m_q",
            "m_p",
            "m_u"
          ],
          "line": 236
        },
        "resolved": true,
        "details": {
          "function_name": "ModularRoot",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.cpp",
          "lines": "646-659",
          "snippet": "Integer ModularRoot(const Integer &a, const Integer &dp, const Integer &dq,\n\t\t\t\t\tconst Integer &p, const Integer &q, const Integer &u)\n{\n\tInteger p2, q2;\n\t#pragma omp parallel\n\t\t#pragma omp sections\n\t\t{\n\t\t\t#pragma omp section\n\t\t\t\tp2 = ModularExponentiation((a % p), dp, p);\n\t\t\t#pragma omp section\n\t\t\t\tq2 = ModularExponentiation((a % q), dq, q);\n\t\t}\n\treturn CRT(p2, p, q2, q, u);\n}",
          "includes": [
            "#include <omp.h>",
            "#include <vector>",
            "#include <math.h>",
            "#include \"algparam.h\"",
            "#include \"modarith.h\"",
            "#include \"nbtheory.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <omp.h>\n#include <vector>\n#include <math.h>\n#include \"algparam.h\"\n#include \"modarith.h\"\n#include \"nbtheory.h\"\n#include \"pch.h\"\n\nInteger ModularRoot(const Integer &a, const Integer &dp, const Integer &dq,\n\t\t\t\t\tconst Integer &p, const Integer &q, const Integer &u)\n{\n\tInteger p2, q2;\n\t#pragma omp parallel\n\t\t#pragma omp sections\n\t\t{\n\t\t\t#pragma omp section\n\t\t\t\tp2 = ModularExponentiation((a % p), dp, p);\n\t\t\t#pragma omp section\n\t\t\t\tq2 = ModularExponentiation((a % q), dq, q);\n\t\t}\n\treturn CRT(p2, p, q2, q, u);\n}"
        }
      },
      {
        "call_info": {
          "callee": "rInv.IsZero",
          "args": [],
          "line": 231
        },
        "resolved": true,
        "details": {
          "function_name": "IsZero",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "197-197",
          "snippet": "bool IsZero() const {return !*this;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsZero() const {return !*this;}"
        }
      },
      {
        "call_info": {
          "callee": "modn.MultiplicativeInverse",
          "args": [
            "r"
          ],
          "line": 230
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.Randomize",
          "args": [
            "rng",
            "Integer::One()",
            "m_n - Integer::One()"
          ],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "Integer::Randomize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3210-3225",
          "snippet": "void Integer::Randomize(RandomNumberGenerator &rng, const Integer &min, const Integer &max)\n{\n\tif (min > max)\n\t\tthrow InvalidArgument(\"Integer: Min must be no greater than Max\");\n\n\tInteger range = max - min;\n\tconst unsigned int nbits = range.BitCount();\n\n\tdo\n\t{\n\t\tRandomize(rng, nbits);\n\t}\n\twhile (*this > range);\n\n\t*this += min;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nvoid Integer::Randomize(RandomNumberGenerator &rng, const Integer &min, const Integer &max)\n{\n\tif (min > max)\n\t\tthrow InvalidArgument(\"Integer: Min must be no greater than Max\");\n\n\tInteger range = max - min;\n\tconst unsigned int nbits = range.BitCount();\n\n\tdo\n\t{\n\t\tRandomize(rng, nbits);\n\t}\n\twhile (*this > range);\n\n\t*this += min;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::One",
          "args": [],
          "line": 229
        },
        "resolved": true,
        "details": {
          "function_name": "One",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "44-45",
          "snippet": "Element One() const\n\t\t{return 1;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element One() const\n  \t\t{return 1;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "DoQuickSanityCheck",
          "args": [],
          "line": 225
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nInteger InvertibleRSAFunction::CalculateInverse(RandomNumberGenerator &rng, const Integer &x) const \n{\n\tDoQuickSanityCheck();\n\tModularArithmetic modn(m_n);\n\tInteger r, rInv;\n\tdo {\t// do this in a loop for people using small numbers for testing\n\t\tr.Randomize(rng, Integer::One(), m_n - Integer::One());\n\t\trInv = modn.MultiplicativeInverse(r);\n\t} while (rInv.IsZero());\n\tInteger re = modn.Exponentiate(r, m_e);\n\tre = modn.Multiply(re, x);\t\t\t// blind\n\t// here we follow the notation of PKCS #1 and let u=q inverse mod p\n\t// but in ModRoot, u=p inverse mod q, so we reverse the order of p and q\n\tInteger y = ModularRoot(re, m_dq, m_dp, m_q, m_p, m_u);\n\ty = modn.Multiply(y, rInv);\t\t\t\t// unblind\n\tif (modn.Exponentiate(y, m_e) != x)\t\t// check\n\t\tthrow Exception(Exception::OTHER_ERROR, \"InvertibleRSAFunction: computational error during private key operation\");\n\treturn y;\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::DEREncodePrivateKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "208-221",
    "snippet": "void InvertibleRSAFunction::DEREncodePrivateKey(BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder privateKey(bt);\n\t\tDEREncodeUnsigned<word32>(privateKey, 0);\t// version\n\t\tm_n.DEREncode(privateKey);\n\t\tm_e.DEREncode(privateKey);\n\t\tm_d.DEREncode(privateKey);\n\t\tm_p.DEREncode(privateKey);\n\t\tm_q.DEREncode(privateKey);\n\t\tm_dp.DEREncode(privateKey);\n\t\tm_dq.DEREncode(privateKey);\n\t\tm_u.DEREncode(privateKey);\n\tprivateKey.MessageEnd();\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "privateKey.MessageEnd",
          "args": [],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "m_u.DEREncode",
          "args": [
            "privateKey"
          ],
          "line": 219
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "67-68",
          "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "DEREncodeUnsigned<word32>",
          "args": [
            "privateKey",
            "0"
          ],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncodeUnsigned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
          "lines": "296-320",
          "snippet": "size_t DEREncodeUnsigned(BufferedTransformation &out, T w, byte asnTag = INTEGER)\n{\n\tbyte buf[sizeof(w)+1];\n\tunsigned int bc;\n\tif (asnTag == BOOLEAN)\n\t{\n\t\tbuf[sizeof(w)] = w ? 0xff : 0;\n\t\tbc = 1;\n\t}\n\telse\n\t{\n\t\tbuf[0] = 0;\n\t\tfor (unsigned int i=0; i<sizeof(w); i++)\n\t\t\tbuf[i+1] = byte(w >> (sizeof(w)-1-i)*8);\n\t\tbc = sizeof(w);\n\t\twhile (bc > 1 && buf[sizeof(w)+1-bc] == 0)\n\t\t\t--bc;\n\t\tif (buf[sizeof(w)+1-bc] & 0x80)\n\t\t\t++bc;\n\t}\n\tout.Put(asnTag);\n\tsize_t lengthBytes = DERLengthEncode(out, bc);\n\tout.Put(buf+sizeof(w)+1-bc, bc);\n\treturn 1+lengthBytes+bc;\n}",
          "includes": [
            "#include <vector>",
            "#include \"queue.h\"",
            "#include \"filters.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CRYPTOPP_DLL void CRYPTOPP_API DEREncodeNull(BufferedTransformation &out);",
            "CRYPTOPP_DLL size_t CRYPTOPP_API DEREncodeTextString(BufferedTransformation &out, const std::string &str, byte asnTag);",
            "CRYPTOPP_DLL size_t CRYPTOPP_API BERDecodeTextString(BufferedTransformation &in, std::string &str, byte asnTag);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\nCRYPTOPP_DLL void CRYPTOPP_API DEREncodeNull(BufferedTransformation &out);\nCRYPTOPP_DLL size_t CRYPTOPP_API DEREncodeTextString(BufferedTransformation &out, const std::string &str, byte asnTag);\nCRYPTOPP_DLL size_t CRYPTOPP_API BERDecodeTextString(BufferedTransformation &in, std::string &str, byte asnTag);\n\nsize_t DEREncodeUnsigned(BufferedTransformation &out, T w, byte asnTag = INTEGER)\n{\n\tbyte buf[sizeof(w)+1];\n\tunsigned int bc;\n\tif (asnTag == BOOLEAN)\n\t{\n\t\tbuf[sizeof(w)] = w ? 0xff : 0;\n\t\tbc = 1;\n\t}\n\telse\n\t{\n\t\tbuf[0] = 0;\n\t\tfor (unsigned int i=0; i<sizeof(w); i++)\n\t\t\tbuf[i+1] = byte(w >> (sizeof(w)-1-i)*8);\n\t\tbc = sizeof(w);\n\t\twhile (bc > 1 && buf[sizeof(w)+1-bc] == 0)\n\t\t\t--bc;\n\t\tif (buf[sizeof(w)+1-bc] & 0x80)\n\t\t\t++bc;\n\t}\n\tout.Put(asnTag);\n\tsize_t lengthBytes = DERLengthEncode(out, bc);\n\tout.Put(buf+sizeof(w)+1-bc, bc);\n\treturn 1+lengthBytes+bc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid InvertibleRSAFunction::DEREncodePrivateKey(BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder privateKey(bt);\n\t\tDEREncodeUnsigned<word32>(privateKey, 0);\t// version\n\t\tm_n.DEREncode(privateKey);\n\t\tm_e.DEREncode(privateKey);\n\t\tm_d.DEREncode(privateKey);\n\t\tm_p.DEREncode(privateKey);\n\t\tm_q.DEREncode(privateKey);\n\t\tm_dp.DEREncode(privateKey);\n\t\tm_dq.DEREncode(privateKey);\n\t\tm_u.DEREncode(privateKey);\n\tprivateKey.MessageEnd();\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::BERDecodePrivateKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "192-206",
    "snippet": "void InvertibleRSAFunction::BERDecodePrivateKey(BufferedTransformation &bt, bool, size_t)\n{\n\tBERSequenceDecoder privateKey(bt);\n\t\tword32 version;\n\t\tBERDecodeUnsigned<word32>(privateKey, version, INTEGER, 0, 0);\t// check version\n\t\tm_n.BERDecode(privateKey);\n\t\tm_e.BERDecode(privateKey);\n\t\tm_d.BERDecode(privateKey);\n\t\tm_p.BERDecode(privateKey);\n\t\tm_q.BERDecode(privateKey);\n\t\tm_dp.BERDecode(privateKey);\n\t\tm_dq.BERDecode(privateKey);\n\t\tm_u.BERDecode(privateKey);\n\tprivateKey.MessageEnd();\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "privateKey.MessageEnd",
          "args": [],
          "line": 205
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "m_u.BERDecode",
          "args": [
            "privateKey"
          ],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "BERDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "65-66",
          "snippet": "void BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "BERDecodeUnsigned<word32>",
          "args": [
            "privateKey",
            "version",
            "INTEGER",
            "0",
            "0"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid InvertibleRSAFunction::BERDecodePrivateKey(BufferedTransformation &bt, bool, size_t)\n{\n\tBERSequenceDecoder privateKey(bt);\n\t\tword32 version;\n\t\tBERDecodeUnsigned<word32>(privateKey, version, INTEGER, 0, 0);\t// check version\n\t\tm_n.BERDecode(privateKey);\n\t\tm_e.BERDecode(privateKey);\n\t\tm_d.BERDecode(privateKey);\n\t\tm_p.BERDecode(privateKey);\n\t\tm_q.BERDecode(privateKey);\n\t\tm_dp.BERDecode(privateKey);\n\t\tm_dq.BERDecode(privateKey);\n\t\tm_u.BERDecode(privateKey);\n\tprivateKey.MessageEnd();\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::Initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "148-190",
    "snippet": "void InvertibleRSAFunction::Initialize(const Integer &n, const Integer &e, const Integer &d)\n{\n\tif (n.IsEven() || e.IsEven() | d.IsEven())\n\t\tthrow InvalidArgument(\"InvertibleRSAFunction: input is not a valid RSA private key\");\n\n\tm_n = n;\n\tm_e = e;\n\tm_d = d;\n\n\tInteger r = --(d*e);\n\tunsigned int s = 0;\n\twhile (r.IsEven())\n\t{\n\t\tr >>= 1;\n\t\ts++;\n\t}\n\n\tModularArithmetic modn(n);\n\tfor (Integer i = 2; ; ++i)\n\t{\n\t\tInteger a = modn.Exponentiate(i, r);\n\t\tif (a == 1)\n\t\t\tcontinue;\n\t\tInteger b;\n\t\tunsigned int j = 0;\n\t\twhile (a != n-1)\n\t\t{\n\t\t\tb = modn.Square(a);\n\t\t\tif (b == 1)\n\t\t\t{\n\t\t\t\tm_p = GCD(a-1, n);\n\t\t\t\tm_q = n/m_p;\n\t\t\t\tm_dp = m_d % (m_p-1);\n\t\t\t\tm_dq = m_d % (m_q-1);\n\t\t\t\tm_u = m_q.InverseMod(m_p);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (++j == s)\n\t\t\t\tthrow InvalidArgument(\"InvertibleRSAFunction: input is not a valid RSA private key\");\n\t\t\ta = b;\n\t\t}\n\t}\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"InvertibleRSAFunction: input is not a valid RSA private key\""
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_q.InverseMod",
          "args": [
            "m_p"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GCD",
          "args": [
            "a-1",
            "n"
          ],
          "line": 178
        },
        "resolved": true,
        "details": {
          "function_name": "GCD",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.h",
          "lines": "63-64",
          "snippet": "inline Integer GCD(const Integer &a, const Integer &b)\n\t{return Integer::Gcd(a,b);}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"integer.h\"\n\ninline Integer GCD(const Integer &a, const Integer &b)\n\t{return Integer::Gcd(a,b);}"
        }
      },
      {
        "call_info": {
          "callee": "modn.Square",
          "args": [
            "a"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "Square",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "49-50",
          "snippet": "Element Square(Element a) const\n\t\t{return Multiply(a, a);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Square(Element a) const\n  \t\t{return Multiply(a, a);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "modn.Exponentiate",
          "args": [
            "i",
            "r"
          ],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "Exponentiate",
          "container": "GFP2_ONB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "158-164",
          "snippet": "Element Exponentiate(const Element &a, const Integer &e) const\n\t{\n\t\tInteger edivp, emodp;\n\t\tInteger::Divide(emodp, edivp, e, modp.GetModulus());\n\t\tElement b = PthPower(a);\n\t\treturn AbstractRing<GFP2Element>::CascadeExponentiate(a, emodp, b, edivp);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2_ONB {\n  Element Exponentiate(const Element &a, const Integer &e) const\n  \t{\n  \t\tInteger edivp, emodp;\n  \t\tInteger::Divide(emodp, edivp, e, modp.GetModulus());\n  \t\tElement b = PthPower(a);\n  \t\treturn AbstractRing<GFP2Element>::CascadeExponentiate(a, emodp, b, edivp);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "r.IsEven",
          "args": [],
          "line": 159
        },
        "resolved": true,
        "details": {
          "function_name": "IsEven",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "209-209",
          "snippet": "bool IsEven() const {return GetBit(0) == 0;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsEven() const {return GetBit(0) == 0;}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"InvertibleRSAFunction: input is not a valid RSA private key\""
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid InvertibleRSAFunction::Initialize(const Integer &n, const Integer &e, const Integer &d)\n{\n\tif (n.IsEven() || e.IsEven() | d.IsEven())\n\t\tthrow InvalidArgument(\"InvertibleRSAFunction: input is not a valid RSA private key\");\n\n\tm_n = n;\n\tm_e = e;\n\tm_d = d;\n\n\tInteger r = --(d*e);\n\tunsigned int s = 0;\n\twhile (r.IsEven())\n\t{\n\t\tr >>= 1;\n\t\ts++;\n\t}\n\n\tModularArithmetic modn(n);\n\tfor (Integer i = 2; ; ++i)\n\t{\n\t\tInteger a = modn.Exponentiate(i, r);\n\t\tif (a == 1)\n\t\t\tcontinue;\n\t\tInteger b;\n\t\tunsigned int j = 0;\n\t\twhile (a != n-1)\n\t\t{\n\t\t\tb = modn.Square(a);\n\t\t\tif (b == 1)\n\t\t\t{\n\t\t\t\tm_p = GCD(a-1, n);\n\t\t\t\tm_q = n/m_p;\n\t\t\t\tm_dp = m_d % (m_p-1);\n\t\t\t\tm_dq = m_d % (m_q-1);\n\t\t\t\tm_u = m_q.InverseMod(m_p);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (++j == s)\n\t\t\t\tthrow InvalidArgument(\"InvertibleRSAFunction: input is not a valid RSA private key\");\n\t\t\ta = b;\n\t\t}\n\t}\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::Initialize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "143-146",
    "snippet": "void InvertibleRSAFunction::Initialize(RandomNumberGenerator &rng, unsigned int keybits, const Integer &e)\n{\n\tGenerateRandom(rng, MakeParameters(Name::ModulusSize(), (int)keybits)(Name::PublicExponent(), e+e.IsEven()));\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GenerateRandom",
          "args": [
            "rng",
            "MakeParameters(Name::ModulusSize(), (int)keybits)(Name::PublicExponent(), e+e.IsEven())"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "InvertibleRabinFunction::GenerateRandom",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rabin.cpp",
          "lines": "75-114",
          "snippet": "void InvertibleRabinFunction::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tint modulusSize = 2048;\n\talg.GetIntValue(\"ModulusSize\", modulusSize) || alg.GetIntValue(\"KeySize\", modulusSize);\n\n\tif (modulusSize < 16)\n\t\tthrow InvalidArgument(\"InvertibleRabinFunction: specified modulus size is too small\");\n\n\t// VC70 workaround: putting these after primeParam causes overlapped stack allocation\n\tbool rFound=false, sFound=false;\n\tInteger t=2;\n\n\tAlgorithmParameters primeParam = MakeParametersForTwoPrimesOfEqualSize(modulusSize)\n\t\t(\"EquivalentTo\", 3)(\"Mod\", 4);\n\tm_p.GenerateRandom(rng, primeParam);\n\tm_q.GenerateRandom(rng, primeParam);\n\n\twhile (!(rFound && sFound))\n\t{\n\t\tint jp = Jacobi(t, m_p);\n\t\tint jq = Jacobi(t, m_q);\n\n\t\tif (!rFound && jp==1 && jq==-1)\n\t\t{\n\t\t\tm_r = t;\n\t\t\trFound = true;\n\t\t}\n\n\t\tif (!sFound && jp==-1 && jq==1)\n\t\t{\n\t\t\tm_s = t;\n\t\t\tsFound = true;\n\t\t}\n\n\t\t++t;\n\t}\n\n\tm_n = m_p * m_q;\n\tm_u = m_q.InverseMod(m_p);\n}",
          "includes": [
            "#include \"modarith.h\"",
            "#include \"sha.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"rabin.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n#include \"sha.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"rabin.h\"\n#include \"pch.h\"\n\nvoid InvertibleRabinFunction::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tint modulusSize = 2048;\n\talg.GetIntValue(\"ModulusSize\", modulusSize) || alg.GetIntValue(\"KeySize\", modulusSize);\n\n\tif (modulusSize < 16)\n\t\tthrow InvalidArgument(\"InvertibleRabinFunction: specified modulus size is too small\");\n\n\t// VC70 workaround: putting these after primeParam causes overlapped stack allocation\n\tbool rFound=false, sFound=false;\n\tInteger t=2;\n\n\tAlgorithmParameters primeParam = MakeParametersForTwoPrimesOfEqualSize(modulusSize)\n\t\t(\"EquivalentTo\", 3)(\"Mod\", 4);\n\tm_p.GenerateRandom(rng, primeParam);\n\tm_q.GenerateRandom(rng, primeParam);\n\n\twhile (!(rFound && sFound))\n\t{\n\t\tint jp = Jacobi(t, m_p);\n\t\tint jq = Jacobi(t, m_q);\n\n\t\tif (!rFound && jp==1 && jq==-1)\n\t\t{\n\t\t\tm_r = t;\n\t\t\trFound = true;\n\t\t}\n\n\t\tif (!sFound && jp==-1 && jq==1)\n\t\t{\n\t\t\tm_s = t;\n\t\t\tsFound = true;\n\t\t}\n\n\t\t++t;\n\t}\n\n\tm_n = m_p * m_q;\n\tm_u = m_q.InverseMod(m_p);\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::PublicExponent()",
            "e+e.IsEven()"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParameters",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "387-390",
          "snippet": "AlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParameters MakeParameters(const char *name, const T &value, bool throwIfNotUsed = true)\n{\n\treturn AlgorithmParameters()(name, value, throwIfNotUsed);\n}"
        }
      },
      {
        "call_info": {
          "callee": "e.IsEven",
          "args": [],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "IsEven",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "209-209",
          "snippet": "bool IsEven() const {return GetBit(0) == 0;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsEven() const {return GetBit(0) == 0;}"
        }
      },
      {
        "call_info": {
          "callee": "Name::PublicExponent",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::ModulusSize",
          "args": [],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid InvertibleRSAFunction::Initialize(RandomNumberGenerator &rng, unsigned int keybits, const Integer &e)\n{\n\tGenerateRandom(rng, MakeParameters(Name::ModulusSize(), (int)keybits)(Name::PublicExponent(), e+e.IsEven()));\n}"
  },
  {
    "function_name": "InvertibleRSAFunction::GenerateRandom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "104-141",
    "snippet": "void InvertibleRSAFunction::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tint modulusSize = 2048;\n\talg.GetIntValue(Name::ModulusSize(), modulusSize) || alg.GetIntValue(Name::KeySize(), modulusSize);\n\n\tif (modulusSize < 16)\n\t\tthrow InvalidArgument(\"InvertibleRSAFunction: specified modulus size is too small\");\n\n\tm_e = alg.GetValueWithDefault(Name::PublicExponent(), Integer(17));\n\n\tif (m_e < 3 || m_e.IsEven())\n\t\tthrow InvalidArgument(\"InvertibleRSAFunction: invalid public exponent\");\n\n\tRSAPrimeSelector selector(m_e);\n\tAlgorithmParameters primeParam = MakeParametersForTwoPrimesOfEqualSize(modulusSize)\n\t\t(Name::PointerToPrimeSelector(), selector.GetSelectorPointer());\n\tm_p.GenerateRandom(rng, primeParam);\n\tm_q.GenerateRandom(rng, primeParam);\n\n\tm_d = m_e.InverseMod(LCM(m_p-1, m_q-1));\n\tassert(m_d.IsPositive());\n\n\tm_dp = m_d % (m_p-1);\n\tm_dq = m_d % (m_q-1);\n\tm_n = m_p * m_q;\n\tm_u = m_q.InverseMod(m_p);\n\n\tif (FIPS_140_2_ComplianceEnabled())\n\t{\n\t\tRSASS<PKCS1v15, SHA>::Signer signer(*this);\n\t\tRSASS<PKCS1v15, SHA>::Verifier verifier(signer);\n\t\tSignaturePairwiseConsistencyTest_FIPS_140_Only(signer, verifier);\n\n\t\tRSAES<OAEP<SHA> >::Decryptor decryptor(*this);\n\t\tRSAES<OAEP<SHA> >::Encryptor encryptor(decryptor);\n\t\tEncryptionPairwiseConsistencyTest_FIPS_140_Only(encryptor, decryptor);\n\t}\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "EncryptionPairwiseConsistencyTest_FIPS_140_Only",
          "args": [
            "encryptor",
            "decryptor"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "EncryptionPairwiseConsistencyTest_FIPS_140_Only",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/fips140.cpp",
          "lines": "68-73",
          "snippet": "void EncryptionPairwiseConsistencyTest_FIPS_140_Only(const PK_Encryptor &encryptor, const PK_Decryptor &decryptor)\n{\n#if CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2\n\tEncryptionPairwiseConsistencyTest(encryptor, decryptor);\n#endif\n}",
          "includes": [
            "#include \"trdlocal.h\"\t// needs to be included last for cygwin",
            "#include \"fips140.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [
            "#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trdlocal.h\"\t// needs to be included last for cygwin\n#include \"fips140.h\"\n#include \"pch.h\"\n\n#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0\n\nvoid EncryptionPairwiseConsistencyTest_FIPS_140_Only(const PK_Encryptor &encryptor, const PK_Decryptor &decryptor)\n{\n#if CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2\n\tEncryptionPairwiseConsistencyTest(encryptor, decryptor);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "SignaturePairwiseConsistencyTest_FIPS_140_Only",
          "args": [
            "signer",
            "verifier"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "SignaturePairwiseConsistencyTest_FIPS_140_Only",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/fips140.cpp",
          "lines": "75-80",
          "snippet": "void SignaturePairwiseConsistencyTest_FIPS_140_Only(const PK_Signer &signer, const PK_Verifier &verifier)\n{\n#if CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2\n\tSignaturePairwiseConsistencyTest(signer, verifier);\n#endif\n}",
          "includes": [
            "#include \"trdlocal.h\"\t// needs to be included last for cygwin",
            "#include \"fips140.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [
            "#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trdlocal.h\"\t// needs to be included last for cygwin\n#include \"fips140.h\"\n#include \"pch.h\"\n\n#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0\n\nvoid SignaturePairwiseConsistencyTest_FIPS_140_Only(const PK_Signer &signer, const PK_Verifier &verifier)\n{\n#if CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2\n\tSignaturePairwiseConsistencyTest(signer, verifier);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "FIPS_140_2_ComplianceEnabled",
          "args": [],
          "line": 131
        },
        "resolved": true,
        "details": {
          "function_name": "FIPS_140_2_ComplianceEnabled",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/fips140.cpp",
          "lines": "28-31",
          "snippet": "bool FIPS_140_2_ComplianceEnabled()\n{\n\treturn CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2;\n}",
          "includes": [
            "#include \"trdlocal.h\"\t// needs to be included last for cygwin",
            "#include \"fips140.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [
            "#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"trdlocal.h\"\t// needs to be included last for cygwin\n#include \"fips140.h\"\n#include \"pch.h\"\n\n#define CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2 0\n\nbool FIPS_140_2_ComplianceEnabled()\n{\n\treturn CRYPTOPP_ENABLE_COMPLIANCE_WITH_FIPS_140_2;\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_q.InverseMod",
          "args": [
            "m_p"
          ],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_d.IsPositive()"
          ],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_d.IsPositive",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "IsPositive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "205-205",
          "snippet": "bool IsPositive() const {return NotNegative() && NotZero();}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsPositive() const {return NotNegative() && NotZero();}"
        }
      },
      {
        "call_info": {
          "callee": "m_e.InverseMod",
          "args": [
            "LCM(m_p-1, m_q-1)"
          ],
          "line": 123
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "LCM",
          "args": [
            "m_p-1",
            "m_q-1"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "LCM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.h",
          "lines": "67-68",
          "snippet": "inline Integer LCM(const Integer &a, const Integer &b)\n\t{return a/Integer::Gcd(a,b)*b;}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"integer.h\"\n\ninline Integer LCM(const Integer &a, const Integer &b)\n\t{return a/Integer::Gcd(a,b)*b;}"
        }
      },
      {
        "call_info": {
          "callee": "m_q.GenerateRandom",
          "args": [
            "rng",
            "primeParam"
          ],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateRandom",
          "container": "DL_PrivateKeyImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "779-788",
          "snippet": "void GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &params)\n\t{\n\t\tif (!params.GetThisObject(this->AccessGroupParameters()))\n\t\t\tthis->AccessGroupParameters().GenerateRandom(rng, params);\n//\t\tstd::pair<const byte *, int> seed;\n\t\tInteger x(rng, Integer::One(), GetAbstractGroupParameters().GetMaxExponent());\n//\t\t\tInteger::ANY, Integer::Zero(), Integer::One(),\n//\t\t\tparams.GetValue(\"DeterministicKeyGenerationSeed\", seed) ? &seed : NULL);\n\t\tSetPrivateExponent(x);\n\t}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nDL_PrivateKeyImpl {\n  void GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &params)\n  \t{\n  \t\tif (!params.GetThisObject(this->AccessGroupParameters()))\n  \t\t\tthis->AccessGroupParameters().GenerateRandom(rng, params);\n  //\t\tstd::pair<const byte *, int> seed;\n  \t\tInteger x(rng, Integer::One(), GetAbstractGroupParameters().GetMaxExponent());\n  //\t\t\tInteger::ANY, Integer::Zero(), Integer::One(),\n  //\t\t\tparams.GetValue(\"DeterministicKeyGenerationSeed\", seed) ? &seed : NULL);\n  \t\tSetPrivateExponent(x);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "MakeParametersForTwoPrimesOfEqualSize",
          "args": [
            "Name::PointerToPrimeSelector()",
            "selector.GetSelectorPointer()"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "selector.GetSelectorPointer",
          "args": [],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::PointerToPrimeSelector",
          "args": [],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParametersForTwoPrimesOfEqualSize",
          "args": [
            "modulusSize"
          ],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "MakeParametersForTwoPrimesOfEqualSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.cpp",
          "lines": "265-284",
          "snippet": "AlgorithmParameters MakeParametersForTwoPrimesOfEqualSize(unsigned int productBitLength)\n{\n\tif (productBitLength < 16)\n\t\tthrow InvalidArgument(\"invalid bit length\");\n\n\tInteger minP, maxP;\n\n\tif (productBitLength%2==0)\n\t{\n\t\tminP = Integer(182) << (productBitLength/2-8);\n\t\tmaxP = Integer::Power2(productBitLength/2)-1;\n\t}\n\telse\n\t{\n\t\tminP = Integer::Power2((productBitLength-1)/2);\n\t\tmaxP = Integer(181) << ((productBitLength+1)/2-8);\n\t}\n\n\treturn MakeParameters(\"RandomNumberType\", Integer::PRIME)(\"Min\", minP)(\"Max\", maxP);\n}",
          "includes": [
            "#include <omp.h>",
            "#include <vector>",
            "#include <math.h>",
            "#include \"algparam.h\"",
            "#include \"modarith.h\"",
            "#include \"nbtheory.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <omp.h>\n#include <vector>\n#include <math.h>\n#include \"algparam.h\"\n#include \"modarith.h\"\n#include \"nbtheory.h\"\n#include \"pch.h\"\n\nAlgorithmParameters MakeParametersForTwoPrimesOfEqualSize(unsigned int productBitLength)\n{\n\tif (productBitLength < 16)\n\t\tthrow InvalidArgument(\"invalid bit length\");\n\n\tInteger minP, maxP;\n\n\tif (productBitLength%2==0)\n\t{\n\t\tminP = Integer(182) << (productBitLength/2-8);\n\t\tmaxP = Integer::Power2(productBitLength/2)-1;\n\t}\n\telse\n\t{\n\t\tminP = Integer::Power2((productBitLength-1)/2);\n\t\tmaxP = Integer(181) << ((productBitLength+1)/2-8);\n\t}\n\n\treturn MakeParameters(\"RandomNumberType\", Integer::PRIME)(\"Min\", minP)(\"Max\", maxP);\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"InvertibleRSAFunction: invalid public exponent\""
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_e.IsEven",
          "args": [],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "IsEven",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "209-209",
          "snippet": "bool IsEven() const {return GetBit(0) == 0;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsEven() const {return GetBit(0) == 0;}"
        }
      },
      {
        "call_info": {
          "callee": "alg.GetValueWithDefault",
          "args": [
            "Name::PublicExponent()",
            "Integer(17)"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Integer",
          "args": [
            "17"
          ],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "Integer::Integer",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3034-3038",
          "snippet": "Integer::Integer(const wchar_t *str)\n\t: reg(2), sign(POSITIVE)\n{\n\t*this = StringToInteger(str);\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger::Integer(const wchar_t *str)\n\t: reg(2), sign(POSITIVE)\n{\n\t*this = StringToInteger(str);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Name::PublicExponent",
          "args": [],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"InvertibleRSAFunction: specified modulus size is too small\""
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetIntValue",
          "args": [
            "Name::KeySize()",
            "modulusSize"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::KeySize",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetIntValue",
          "args": [
            "Name::ModulusSize()",
            "modulusSize"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::ModulusSize",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid InvertibleRSAFunction::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tint modulusSize = 2048;\n\talg.GetIntValue(Name::ModulusSize(), modulusSize) || alg.GetIntValue(Name::KeySize(), modulusSize);\n\n\tif (modulusSize < 16)\n\t\tthrow InvalidArgument(\"InvertibleRSAFunction: specified modulus size is too small\");\n\n\tm_e = alg.GetValueWithDefault(Name::PublicExponent(), Integer(17));\n\n\tif (m_e < 3 || m_e.IsEven())\n\t\tthrow InvalidArgument(\"InvertibleRSAFunction: invalid public exponent\");\n\n\tRSAPrimeSelector selector(m_e);\n\tAlgorithmParameters primeParam = MakeParametersForTwoPrimesOfEqualSize(modulusSize)\n\t\t(Name::PointerToPrimeSelector(), selector.GetSelectorPointer());\n\tm_p.GenerateRandom(rng, primeParam);\n\tm_q.GenerateRandom(rng, primeParam);\n\n\tm_d = m_e.InverseMod(LCM(m_p-1, m_q-1));\n\tassert(m_d.IsPositive());\n\n\tm_dp = m_d % (m_p-1);\n\tm_dq = m_d % (m_q-1);\n\tm_n = m_p * m_q;\n\tm_u = m_q.InverseMod(m_p);\n\n\tif (FIPS_140_2_ComplianceEnabled())\n\t{\n\t\tRSASS<PKCS1v15, SHA>::Signer signer(*this);\n\t\tRSASS<PKCS1v15, SHA>::Verifier verifier(signer);\n\t\tSignaturePairwiseConsistencyTest_FIPS_140_Only(signer, verifier);\n\n\t\tRSAES<OAEP<SHA> >::Decryptor decryptor(*this);\n\t\tRSAES<OAEP<SHA> >::Encryptor encryptor(decryptor);\n\t\tEncryptionPairwiseConsistencyTest_FIPS_140_Only(encryptor, decryptor);\n\t}\n}"
  },
  {
    "function_name": "IsAcceptable",
    "container": "RSAPrimeSelector",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "100-100",
    "snippet": "bool IsAcceptable(const Integer &candidate) const {return RelativelyPrime(m_e, candidate-Integer::One());}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RelativelyPrime",
          "args": [
            "m_e",
            "candidate-Integer::One()"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "RelativelyPrime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.h",
          "lines": "65-66",
          "snippet": "inline bool RelativelyPrime(const Integer &a, const Integer &b)\n\t{return Integer::Gcd(a,b) == Integer::One();}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"integer.h\"\n\ninline bool RelativelyPrime(const Integer &a, const Integer &b)\n\t{return Integer::Gcd(a,b) == Integer::One();}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::One",
          "args": [],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "One",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "44-45",
          "snippet": "Element One() const\n\t\t{return 1;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element One() const\n  \t\t{return 1;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nRSAPrimeSelector {\n  bool IsAcceptable(const Integer &candidate) const {return RelativelyPrime(m_e, candidate-Integer::One());}\n}"
  },
  {
    "function_name": "RSAPrimeSelector",
    "container": "RSAPrimeSelector",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "99-99",
    "snippet": "RSAPrimeSelector(const Integer &e) : m_e(e) {}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nRSAPrimeSelector {\n  RSAPrimeSelector(const Integer &e) : m_e(e) {}\n}"
  },
  {
    "function_name": "RSAFunction::AssignFrom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "86-92",
    "snippet": "void RSAFunction::AssignFrom(const NameValuePairs &source)\n{\n\tAssignFromHelper(this, source)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(Modulus)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(PublicExponent)\n\t\t;\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "PublicExponent"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "Modulus"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssignFromHelper",
          "args": [
            "this",
            "source"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "AssignFromHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "235-238",
          "snippet": "AssignFromHelperClass<T, T> AssignFromHelper(T *pObject, const NameValuePairs &source)\n{\n\treturn AssignFromHelperClass<T, T>(pObject, source);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAssignFromHelperClass<T, T> AssignFromHelper(T *pObject, const NameValuePairs &source)\n{\n\treturn AssignFromHelperClass<T, T>(pObject, source);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid RSAFunction::AssignFrom(const NameValuePairs &source)\n{\n\tAssignFromHelper(this, source)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(Modulus)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(PublicExponent)\n\t\t;\n}"
  },
  {
    "function_name": "RSAFunction::GetVoidValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "78-84",
    "snippet": "bool RSAFunction::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\treturn GetValueHelper(this, name, valueType, pValue).Assignable()\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Modulus)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(PublicExponent)\n\t\t;\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "PublicExponent"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "Modulus"
          ],
          "line": 81
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetValueHelper",
          "args": [],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetValueHelper",
          "args": [
            "this",
            "name",
            "valueType",
            "pValue"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "GetValueHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "161-164",
          "snippet": "GetValueHelperClass<T, T> GetValueHelper(const T *pObject, const char *name, const std::type_info &valueType, void *pValue, const NameValuePairs *searchFirst=NULL)\n{\n\treturn GetValueHelperClass<T, T>(pObject, name, valueType, pValue, searchFirst);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nGetValueHelperClass<T, T> GetValueHelper(const T *pObject, const char *name, const std::type_info &valueType, void *pValue, const NameValuePairs *searchFirst=NULL)\n{\n\treturn GetValueHelperClass<T, T>(pObject, name, valueType, pValue, searchFirst);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nbool RSAFunction::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\treturn GetValueHelper(this, name, valueType, pValue).Assignable()\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Modulus)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(PublicExponent)\n\t\t;\n}"
  },
  {
    "function_name": "RSAFunction::Validate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "70-76",
    "snippet": "bool RSAFunction::Validate(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tbool pass = true;\n\tpass = pass && m_n > Integer::One() && m_n.IsOdd();\n\tpass = pass && m_e > Integer::One() && m_e.IsOdd() && m_e < m_n;\n\treturn pass;\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_e.IsOdd",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "IsOdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "211-211",
          "snippet": "bool IsOdd() const\t{return GetBit(0) == 1;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsOdd() const\t{return GetBit(0) == 1;}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::One",
          "args": [],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "One",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "44-45",
          "snippet": "Element One() const\n\t\t{return 1;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element One() const\n  \t\t{return 1;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nbool RSAFunction::Validate(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tbool pass = true;\n\tpass = pass && m_n > Integer::One() && m_n.IsOdd();\n\tpass = pass && m_e > Integer::One() && m_e.IsOdd() && m_e < m_n;\n\treturn pass;\n}"
  },
  {
    "function_name": "RSAFunction::ApplyFunction",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "64-68",
    "snippet": "Integer RSAFunction::ApplyFunction(const Integer &x) const\n{\n\tDoQuickSanityCheck();\n\treturn a_exp_b_mod_c(x, m_e, m_n);\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a_exp_b_mod_c",
          "args": [
            "x",
            "m_e",
            "m_n"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DoQuickSanityCheck",
          "args": [],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nInteger RSAFunction::ApplyFunction(const Integer &x) const\n{\n\tDoQuickSanityCheck();\n\treturn a_exp_b_mod_c(x, m_e, m_n);\n}"
  },
  {
    "function_name": "RSAFunction::DEREncodePublicKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "56-62",
    "snippet": "void RSAFunction::DEREncodePublicKey(BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder seq(bt);\n\t\tm_n.DEREncode(seq);\n\t\tm_e.DEREncode(seq);\n\tseq.MessageEnd();\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "m_e.DEREncode",
          "args": [
            "seq"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "67-68",
          "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid RSAFunction::DEREncodePublicKey(BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder seq(bt);\n\t\tm_n.DEREncode(seq);\n\t\tm_e.DEREncode(seq);\n\tseq.MessageEnd();\n}"
  },
  {
    "function_name": "RSAFunction::BERDecodePublicKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "48-54",
    "snippet": "void RSAFunction::BERDecodePublicKey(BufferedTransformation &bt, bool, size_t)\n{\n\tBERSequenceDecoder seq(bt);\n\t\tm_n.BERDecode(seq);\n\t\tm_e.BERDecode(seq);\n\tseq.MessageEnd();\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "m_e.BERDecode",
          "args": [
            "seq"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "BERDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "65-66",
          "snippet": "void BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid RSAFunction::BERDecodePublicKey(BufferedTransformation &bt, bool, size_t)\n{\n\tBERSequenceDecoder seq(bt);\n\t\tm_n.BERDecode(seq);\n\t\tm_e.BERDecode(seq);\n\tseq.MessageEnd();\n}"
  },
  {
    "function_name": "RSAFunction::GetAlgorithmID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "43-46",
    "snippet": "OID RSAFunction::GetAlgorithmID() const\n{\n\treturn ASN1::rsaEncryption();\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASN1::rsaEncryption",
          "args": [],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nOID RSAFunction::GetAlgorithmID() const\n{\n\treturn ASN1::rsaEncryption();\n}"
  },
  {
    "function_name": "RSA_TestInstantiations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.cpp",
    "lines": "16-35",
    "snippet": "void RSA_TestInstantiations()\n{\n\tRSASS<PKCS1v15, SHA>::Verifier x1(1, 1);\n\tRSASS<PKCS1v15, SHA>::Signer x2(NullRNG(), 1);\n\tRSASS<PKCS1v15, SHA>::Verifier x3(x2);\n\tRSASS<PKCS1v15, SHA>::Verifier x4(x2.GetKey());\n\tRSASS<PSS, SHA>::Verifier x5(x3);\n#ifndef __MWERKS__\n\tRSASS<PSSR, SHA>::Signer x6 = x2;\n\tx3 = x2;\n\tx6 = x2;\n#endif\n\tRSAES<PKCS1v15>::Encryptor x7(x2);\n#ifndef __GNUC__\n\tRSAES<PKCS1v15>::Encryptor x8(x3);\n#endif\n\tRSAES<OAEP<SHA> >::Encryptor x9(x2);\n\n\tx4 = x2.GetKey();\n}",
    "includes": [
      "#include \"pssr.h\"",
      "#include \"fips140.h\"",
      "#include \"algparam.h\"",
      "#include \"sha.h\"",
      "#include \"nbtheory.h\"",
      "#include \"modarith.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"rsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "x2.GetKey",
          "args": [],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "x2.GetKey",
          "args": [],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NullRNG",
          "args": [],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "AlgorithmName",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "291-291",
          "snippet": "std::string AlgorithmName() const {return \"NullRNG\";}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  std::string AlgorithmName() const {return \"NullRNG\";}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"pssr.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"rsa.h\"\n#include \"pch.h\"\n\nvoid RSA_TestInstantiations()\n{\n\tRSASS<PKCS1v15, SHA>::Verifier x1(1, 1);\n\tRSASS<PKCS1v15, SHA>::Signer x2(NullRNG(), 1);\n\tRSASS<PKCS1v15, SHA>::Verifier x3(x2);\n\tRSASS<PKCS1v15, SHA>::Verifier x4(x2.GetKey());\n\tRSASS<PSS, SHA>::Verifier x5(x3);\n#ifndef __MWERKS__\n\tRSASS<PSSR, SHA>::Signer x6 = x2;\n\tx3 = x2;\n\tx6 = x2;\n#endif\n\tRSAES<PKCS1v15>::Encryptor x7(x2);\n#ifndef __GNUC__\n\tRSAES<PKCS1v15>::Encryptor x8(x3);\n#endif\n\tRSAES<OAEP<SHA> >::Encryptor x9(x2);\n\n\tx4 = x2.GetKey();\n}"
  }
]