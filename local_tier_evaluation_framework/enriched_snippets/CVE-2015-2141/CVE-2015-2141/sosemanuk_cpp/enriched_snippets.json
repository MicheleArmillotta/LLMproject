[
  {
    "function_name": "CipherResynchronize",
    "container": "SosemanukPolicy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sosemanuk.cpp",
    "lines": "22-82",
    "snippet": "void SosemanukPolicy::CipherResynchronize(byte *keystreamBuffer, const byte *iv, size_t length)\n{\n\tassert(length==16);\n\n\tword32 a, b, c, d, e;\n\t\n\ttypedef BlockGetAndPut<word32, LittleEndian> Block;\n\tBlock::Get(iv)(a)(b)(c)(d);\n\n\tconst word32 *k = m_key;\n\tunsigned int i=1;\n\n\tdo\n\t{\n\t\tbeforeS0(KX); beforeS0(S0); afterS0(LT);\n\t\tafterS0(KX); afterS0(S1); afterS1(LT);\n\t\tif (i == 3)\t// after 18th round\n\t\t{\n\t\t\tm_state[4] = b;\n\t\t\tm_state[5] = e;\n\t\t\tm_state[10] = c;\n\t\t\tm_state[11] = a;\n\t\t}\n\t\tafterS1(KX); afterS1(S2); afterS2(LT);\n\t\tafterS2(KX); afterS2(S3); afterS3(LT);\n\t\tif (i == 2)\t// after 12th round\n\t\t{\n\t\t\tm_state[6] = c;\n\t\t\tm_state[7] = d;\n\t\t\tm_state[8] = b;\n\t\t\tm_state[9] = e;\n\t\t}\n\t\tafterS3(KX); afterS3(S4); afterS4(LT);\n\t\tafterS4(KX); afterS4(S5); afterS5(LT);\n\t\tafterS5(KX); afterS5(S6); afterS6(LT);\n\t\tafterS6(KX); afterS6(S7); afterS7(LT);\n\n\t\tif (i == 3)\n\t\t\tbreak;\n\n\t\t++i;\n\t\tc = b;\n\t\tb = e;\n\t\te = d;\n\t\td = a;\n\t\ta = e;\n\t\tk += 32;\n\t}\n\twhile (true);\n\n\tafterS7(KX);\n\n\tm_state[0] = a;\n\tm_state[1] = b;\n\tm_state[2] = e;\n\tm_state[3] = d;\n\n#define XMUX(c, x, y)   (x ^ (y & (0 - (c & 1))))\n\tm_state[11] += XMUX(m_state[10], m_state[1], m_state[8]);\n\tm_state[10] = rotlFixed(m_state[10] * 0x54655307, 7);\n}",
    "includes": [
      "#include \"serpentp.h\"",
      "#include \"cpu.h\"",
      "#include \"misc.h\"",
      "#include \"sosemanuk.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "m_state[10] * 0x54655307",
            "7"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "XMUX",
          "args": [
            "m_state[10]",
            "m_state[1]",
            "m_state[8]"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS7",
          "args": [
            "KX"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS7",
          "args": [
            "LT"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "S7"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "KX"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "LT"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "S6"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "KX"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "LT"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "S5"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "KX"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "LT"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "S4"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "KX"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "LT"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "S3"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "KX"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "LT"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "S2"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "KX"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "LT"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "S1"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "KX"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "LT"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeS0",
          "args": [
            "S0"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeS0",
          "args": [
            "KX"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "d"
          ],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length==16"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"serpentp.h\"\n#include \"cpu.h\"\n#include \"misc.h\"\n#include \"sosemanuk.h\"\n#include \"pch.h\"\n\nSosemanukPolicy {\n  void SosemanukPolicy::CipherResynchronize(byte *keystreamBuffer, const byte *iv, size_t length)\n  {\n  \tassert(length==16);\n  \n  \tword32 a, b, c, d, e;\n  \t\n  \ttypedef BlockGetAndPut<word32, LittleEndian> Block;\n  \tBlock::Get(iv)(a)(b)(c)(d);\n  \n  \tconst word32 *k = m_key;\n  \tunsigned int i=1;\n  \n  \tdo\n  \t{\n  \t\tbeforeS0(KX); beforeS0(S0); afterS0(LT);\n  \t\tafterS0(KX); afterS0(S1); afterS1(LT);\n  \t\tif (i == 3)\t// after 18th round\n  \t\t{\n  \t\t\tm_state[4] = b;\n  \t\t\tm_state[5] = e;\n  \t\t\tm_state[10] = c;\n  \t\t\tm_state[11] = a;\n  \t\t}\n  \t\tafterS1(KX); afterS1(S2); afterS2(LT);\n  \t\tafterS2(KX); afterS2(S3); afterS3(LT);\n  \t\tif (i == 2)\t// after 12th round\n  \t\t{\n  \t\t\tm_state[6] = c;\n  \t\t\tm_state[7] = d;\n  \t\t\tm_state[8] = b;\n  \t\t\tm_state[9] = e;\n  \t\t}\n  \t\tafterS3(KX); afterS3(S4); afterS4(LT);\n  \t\tafterS4(KX); afterS4(S5); afterS5(LT);\n  \t\tafterS5(KX); afterS5(S6); afterS6(LT);\n  \t\tafterS6(KX); afterS6(S7); afterS7(LT);\n  \n  \t\tif (i == 3)\n  \t\t\tbreak;\n  \n  \t\t++i;\n  \t\tc = b;\n  \t\tb = e;\n  \t\te = d;\n  \t\td = a;\n  \t\ta = e;\n  \t\tk += 32;\n  \t}\n  \twhile (true);\n  \n  \tafterS7(KX);\n  \n  \tm_state[0] = a;\n  \tm_state[1] = b;\n  \tm_state[2] = e;\n  \tm_state[3] = d;\n  \n  #define XMUX(c, x, y)   (x ^ (y & (0 - (c & 1))))\n  \tm_state[11] += XMUX(m_state[10], m_state[1], m_state[8]);\n  \tm_state[10] = rotlFixed(m_state[10] * 0x54655307, 7);\n  }\n}"
  },
  {
    "function_name": "CipherSetKey",
    "container": "SosemanukPolicy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sosemanuk.cpp",
    "lines": "17-20",
    "snippet": "void SosemanukPolicy::CipherSetKey(const NameValuePairs &params, const byte *userKey, size_t keylen)\n{\n\tSerpent_KeySchedule(m_key, 24, userKey, keylen);\n}",
    "includes": [
      "#include \"serpentp.h\"",
      "#include \"cpu.h\"",
      "#include \"misc.h\"",
      "#include \"sosemanuk.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Serpent_KeySchedule",
          "args": [
            "m_key",
            "24",
            "userKey",
            "keylen"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "Serpent_KeySchedule",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/serpent.cpp",
          "lines": "11-40",
          "snippet": "void Serpent_KeySchedule(word32 *k, unsigned int rounds, const byte *userKey, size_t keylen)\n{\n\tFixedSizeSecBlock<word32, 8> k0;\n\tGetUserKey(LITTLE_ENDIAN_ORDER, k0.begin(), 8, userKey, keylen);\n\tif (keylen < 32)\n\t\tk0[keylen/4] |= word32(1) << ((keylen%4)*8);\n\n\tword32 t = k0[7];\n\tunsigned int i;\n\tfor (i = 0; i < 8; ++i)\n\t\tk[i] = k0[i] = t = rotlFixed(k0[i] ^ k0[(i+3)%8] ^ k0[(i+5)%8] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tfor (i = 8; i < 4*(rounds+1); ++i)\n\t\tk[i] = t = rotlFixed(k[i-8] ^ k[i-5] ^ k[i-3] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tk -= 20;\n\n\tword32 a,b,c,d,e;\n\tfor (i=0; i<rounds/8; i++)\n\t{\n\t\tafterS2(LK); afterS2(S3); afterS3(SK);\n\t\tafterS1(LK); afterS1(S2); afterS2(SK);\n\t\tafterS0(LK); afterS0(S1); afterS1(SK);\n\t\tbeforeS0(LK); beforeS0(S0); afterS0(SK);\n\t\tk += 8*4;\n\t\tafterS6(LK); afterS6(S7); afterS7(SK);\n\t\tafterS5(LK); afterS5(S6); afterS6(SK);\n\t\tafterS4(LK); afterS4(S5); afterS5(SK);\n\t\tafterS3(LK); afterS3(S4); afterS4(SK);\n\t}\n\tafterS2(LK); afterS2(S3); afterS3(SK);\n}",
          "includes": [
            "#include \"serpentp.h\"",
            "#include \"misc.h\"",
            "#include \"serpent.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"serpentp.h\"\n#include \"misc.h\"\n#include \"serpent.h\"\n#include \"pch.h\"\n\nvoid Serpent_KeySchedule(word32 *k, unsigned int rounds, const byte *userKey, size_t keylen)\n{\n\tFixedSizeSecBlock<word32, 8> k0;\n\tGetUserKey(LITTLE_ENDIAN_ORDER, k0.begin(), 8, userKey, keylen);\n\tif (keylen < 32)\n\t\tk0[keylen/4] |= word32(1) << ((keylen%4)*8);\n\n\tword32 t = k0[7];\n\tunsigned int i;\n\tfor (i = 0; i < 8; ++i)\n\t\tk[i] = k0[i] = t = rotlFixed(k0[i] ^ k0[(i+3)%8] ^ k0[(i+5)%8] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tfor (i = 8; i < 4*(rounds+1); ++i)\n\t\tk[i] = t = rotlFixed(k[i-8] ^ k[i-5] ^ k[i-3] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tk -= 20;\n\n\tword32 a,b,c,d,e;\n\tfor (i=0; i<rounds/8; i++)\n\t{\n\t\tafterS2(LK); afterS2(S3); afterS3(SK);\n\t\tafterS1(LK); afterS1(S2); afterS2(SK);\n\t\tafterS0(LK); afterS0(S1); afterS1(SK);\n\t\tbeforeS0(LK); beforeS0(S0); afterS0(SK);\n\t\tk += 8*4;\n\t\tafterS6(LK); afterS6(S7); afterS7(SK);\n\t\tafterS5(LK); afterS5(S6); afterS6(SK);\n\t\tafterS4(LK); afterS4(S5); afterS5(SK);\n\t\tafterS3(LK); afterS3(S4); afterS4(SK);\n\t}\n\tafterS2(LK); afterS2(S3); afterS3(SK);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"serpentp.h\"\n#include \"cpu.h\"\n#include \"misc.h\"\n#include \"sosemanuk.h\"\n#include \"pch.h\"\n\nSosemanukPolicy {\n  void SosemanukPolicy::CipherSetKey(const NameValuePairs &params, const byte *userKey, size_t keylen)\n  {\n  \tSerpent_KeySchedule(m_key, 24, userKey, keylen);\n  }\n}"
  }
]