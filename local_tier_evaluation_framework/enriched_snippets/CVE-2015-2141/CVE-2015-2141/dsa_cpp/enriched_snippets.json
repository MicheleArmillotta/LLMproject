[
  {
    "function_name": "DSAConvertSignatureFormat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dsa.cpp",
    "lines": "12-59",
    "snippet": "size_t DSAConvertSignatureFormat(byte *buffer, size_t bufferSize, DSASignatureFormat toFormat, const byte *signature, size_t signatureLen, DSASignatureFormat fromFormat)\n{\n\tInteger r, s;\n\tStringStore store(signature, signatureLen);\n\tArraySink sink(buffer, bufferSize);\n\n\tswitch (fromFormat)\n\t{\n\tcase DSA_P1363:\n\t\tr.Decode(store, signatureLen/2);\n\t\ts.Decode(store, signatureLen/2);\n\t\tbreak;\n\tcase DSA_DER:\n\t{\n\t\tBERSequenceDecoder seq(store);\n\t\tr.BERDecode(seq);\n\t\ts.BERDecode(seq);\n\t\tseq.MessageEnd();\n\t\tbreak;\n\t}\n\tcase DSA_OPENPGP:\n\t\tr.OpenPGPDecode(store);\n\t\ts.OpenPGPDecode(store);\n\t\tbreak;\n\t}\n\n\tswitch (toFormat)\n\t{\n\tcase DSA_P1363:\n\t\tr.Encode(sink, bufferSize/2);\n\t\ts.Encode(sink, bufferSize/2);\n\t\tbreak;\n\tcase DSA_DER:\n\t{\n\t\tDERSequenceEncoder seq(sink);\n\t\tr.DEREncode(seq);\n\t\ts.DEREncode(seq);\n\t\tseq.MessageEnd();\n\t\tbreak;\n\t}\n\tcase DSA_OPENPGP:\n\t\tr.OpenPGPEncode(sink);\n\t\ts.OpenPGPEncode(sink);\n\t\tbreak;\n\t}\n\n\treturn (size_t)sink.TotalPutLength();\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"dsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "sink.TotalPutLength",
          "args": [],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.OpenPGPEncode",
          "args": [
            "sink"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.OpenPGPEncode",
          "args": [
            "sink"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "Integer::OpenPGPEncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3177-3184",
          "snippet": "size_t Integer::OpenPGPEncode(BufferedTransformation &bt) const\n{\n\tword16 bitCount = BitCount();\n\tbt.PutWord16(bitCount);\n\tsize_t byteCount = BitsToBytes(bitCount);\n\tEncode(bt, byteCount);\n\treturn 2 + byteCount;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nsize_t Integer::OpenPGPEncode(BufferedTransformation &bt) const\n{\n\tword16 bitCount = BitCount();\n\tbt.PutWord16(bitCount);\n\tsize_t byteCount = BitsToBytes(bitCount);\n\tEncode(bt, byteCount);\n\treturn 2 + byteCount;\n}"
        }
      },
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "s.DEREncode",
          "args": [
            "seq"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "67-68",
          "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "s.Encode",
          "args": [
            "sink",
            "bufferSize/2"
          ],
          "line": 42
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "GFP2Element",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "21-25",
          "snippet": "void Encode(byte *encodedElement, unsigned int size)\n\t{\n\t\tc1.Encode(encodedElement, size/2);\n\t\tc2.Encode(encodedElement+size/2, size/2);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2Element {\n  void Encode(byte *encodedElement, unsigned int size)\n  \t{\n  \t\tc1.Encode(encodedElement, size/2);\n  \t\tc2.Encode(encodedElement+size/2, size/2);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.OpenPGPDecode",
          "args": [
            "store"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.OpenPGPDecode",
          "args": [
            "store"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "Integer::OpenPGPDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3192-3198",
          "snippet": "void Integer::OpenPGPDecode(BufferedTransformation &bt)\n{\n\tword16 bitCount;\n\tif (bt.GetWord16(bitCount) != 2 || bt.MaxRetrievable() < BitsToBytes(bitCount))\n\t\tthrow OpenPGPDecodeErr();\n\tDecode(bt, BitsToBytes(bitCount));\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nvoid Integer::OpenPGPDecode(BufferedTransformation &bt)\n{\n\tword16 bitCount;\n\tif (bt.GetWord16(bitCount) != 2 || bt.MaxRetrievable() < BitsToBytes(bitCount))\n\t\tthrow OpenPGPDecodeErr();\n\tDecode(bt, BitsToBytes(bitCount));\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.BERDecode",
          "args": [
            "seq"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "BERDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "65-66",
          "snippet": "void BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "s.Decode",
          "args": [
            "store",
            "signatureLen/2"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "r.Decode",
          "args": [
            "store",
            "signatureLen/2"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "HuffmanDecoder::Decode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/zinflate.cpp",
          "lines": "202-210",
          "snippet": "bool HuffmanDecoder::Decode(LowFirstBitReader &reader, value_t &value) const\n{\n\treader.FillBuffer(m_maxCodeBits);\n\tunsigned int codeBits = Decode(reader.PeekBuffer(), value);\n\tif (codeBits > reader.BitsBuffered())\n\t\treturn false;\n\treader.SkipBits(codeBits);\n\treturn true;\n}",
          "includes": [
            "#include \"zinflate.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"zinflate.h\"\n#include \"pch.h\"\n\nbool HuffmanDecoder::Decode(LowFirstBitReader &reader, value_t &value) const\n{\n\treader.FillBuffer(m_maxCodeBits);\n\tunsigned int codeBits = Decode(reader.PeekBuffer(), value);\n\tif (codeBits > reader.BitsBuffered())\n\t\treturn false;\n\treader.SkipBits(codeBits);\n\treturn true;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"dsa.h\"\n#include \"pch.h\"\n\nsize_t DSAConvertSignatureFormat(byte *buffer, size_t bufferSize, DSASignatureFormat toFormat, const byte *signature, size_t signatureLen, DSASignatureFormat fromFormat)\n{\n\tInteger r, s;\n\tStringStore store(signature, signatureLen);\n\tArraySink sink(buffer, bufferSize);\n\n\tswitch (fromFormat)\n\t{\n\tcase DSA_P1363:\n\t\tr.Decode(store, signatureLen/2);\n\t\ts.Decode(store, signatureLen/2);\n\t\tbreak;\n\tcase DSA_DER:\n\t{\n\t\tBERSequenceDecoder seq(store);\n\t\tr.BERDecode(seq);\n\t\ts.BERDecode(seq);\n\t\tseq.MessageEnd();\n\t\tbreak;\n\t}\n\tcase DSA_OPENPGP:\n\t\tr.OpenPGPDecode(store);\n\t\ts.OpenPGPDecode(store);\n\t\tbreak;\n\t}\n\n\tswitch (toFormat)\n\t{\n\tcase DSA_P1363:\n\t\tr.Encode(sink, bufferSize/2);\n\t\ts.Encode(sink, bufferSize/2);\n\t\tbreak;\n\tcase DSA_DER:\n\t{\n\t\tDERSequenceEncoder seq(sink);\n\t\tr.DEREncode(seq);\n\t\ts.DEREncode(seq);\n\t\tseq.MessageEnd();\n\t\tbreak;\n\t}\n\tcase DSA_OPENPGP:\n\t\tr.OpenPGPEncode(sink);\n\t\ts.OpenPGPEncode(sink);\n\t\tbreak;\n\t}\n\n\treturn (size_t)sink.TotalPutLength();\n}"
  }
]