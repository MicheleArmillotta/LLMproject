[
  {
    "function_name": "AlgorithmParameters::GetVoidValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "65-71",
    "snippet": "bool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn false;\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_next->GetVoidValue",
          "args": [
            "name",
            "valueType",
            "pValue"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "GetVoidValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "127-130",
          "snippet": "bool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\treturn GetValueHelper<DL_GroupParameters_IntegerBased>(this, name, valueType, pValue).Assignable();\n\t}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nbool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\treturn GetValueHelper<DL_GroupParameters_IntegerBased>(this, name, valueType, pValue).Assignable();\n\t}"
        }
      },
      {
        "call_info": {
          "callee": "m_next.get",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nbool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn false;\n}"
  },
  {
    "function_name": "AlgorithmParameters::AlgorithmParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "53-57",
    "snippet": "AlgorithmParameters::AlgorithmParameters(const AlgorithmParameters &x)\n\t: m_defaultThrowIfNotUsed(x.m_defaultThrowIfNotUsed)\n{\n\tm_next.reset(const_cast<AlgorithmParameters &>(x).m_next.release());\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_next.reset",
          "args": [
            "const_cast<AlgorithmParameters &>(x).m_next.release()"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<AlgorithmParameters &>",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<AlgorithmParameters &>",
          "args": [
            "x"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParameters::AlgorithmParameters(const AlgorithmParameters &x)\n\t: m_defaultThrowIfNotUsed(x.m_defaultThrowIfNotUsed)\n{\n\tm_next.reset(const_cast<AlgorithmParameters &>(x).m_next.release());\n}"
  },
  {
    "function_name": "AlgorithmParameters::AlgorithmParameters",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "48-51",
    "snippet": "AlgorithmParameters::AlgorithmParameters()\n\t: m_defaultThrowIfNotUsed(true)\n{\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParameters::AlgorithmParameters()\n\t: m_defaultThrowIfNotUsed(true)\n{\n}"
  },
  {
    "function_name": "AlgorithmParametersBase::GetVoidValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "26-46",
    "snippet": "bool AlgorithmParametersBase::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (strcmp(name, \"ValueNames\") == 0)\n\t{\n\t\tNameValuePairs::ThrowIfTypeMismatch(name, typeid(std::string), valueType);\n\t\tif (m_next.get())\n\t\t    m_next->GetVoidValue(name, valueType, pValue);\n\t\t(*reinterpret_cast<std::string *>(pValue) += m_name) += \";\";\n\t\treturn true;\n\t}\n\telse if (strcmp(name, m_name) == 0)\n\t{\n\t\tAssignValue(name, valueType, pValue);\n\t\tm_used = true;\n\t\treturn true;\n\t}\n\telse if (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t    return false;\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_next->GetVoidValue",
          "args": [
            "name",
            "valueType",
            "pValue"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "GetVoidValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "127-130",
          "snippet": "bool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\treturn GetValueHelper<DL_GroupParameters_IntegerBased>(this, name, valueType, pValue).Assignable();\n\t}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nbool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\treturn GetValueHelper<DL_GroupParameters_IntegerBased>(this, name, valueType, pValue).Assignable();\n\t}"
        }
      },
      {
        "call_info": {
          "callee": "m_next.get",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssignValue",
          "args": [
            "name",
            "valueType",
            "pValue"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "AssignValue",
          "container": "AlgorithmParametersTemplate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "310-318",
          "snippet": "void AssignValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\t// special case for retrieving an Integer parameter when an int was passed in\n\t\tif (!(g_pAssignIntToInteger != NULL && typeid(T) == typeid(int) && g_pAssignIntToInteger(valueType, pValue, &m_value)))\n\t\t{\n\t\t\tNameValuePairs::ThrowIfTypeMismatch(name, typeid(T), valueType);\n\t\t\t*reinterpret_cast<T *>(pValue) = m_value;\n\t\t}\n\t}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParametersTemplate {\n  void AssignValue(const char *name, const std::type_info &valueType, void *pValue) const\n  \t{\n  \t\t// special case for retrieving an Integer parameter when an int was passed in\n  \t\tif (!(g_pAssignIntToInteger != NULL && typeid(T) == typeid(int) && g_pAssignIntToInteger(valueType, pValue, &m_value)))\n  \t\t{\n  \t\t\tNameValuePairs::ThrowIfTypeMismatch(name, typeid(T), valueType);\n  \t\t\t*reinterpret_cast<T *>(pValue) = m_value;\n  \t\t}\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "m_name"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<std::string *>",
          "args": [
            "pValue"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_next.get",
          "args": [],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NameValuePairs::ThrowIfTypeMismatch",
          "args": [
            "name",
            "typeid(std::string)",
            "valueType"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeid",
          "args": [
            "std::string"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"ValueNames\""
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nbool AlgorithmParametersBase::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (strcmp(name, \"ValueNames\") == 0)\n\t{\n\t\tNameValuePairs::ThrowIfTypeMismatch(name, typeid(std::string), valueType);\n\t\tif (m_next.get())\n\t\t    m_next->GetVoidValue(name, valueType, pValue);\n\t\t(*reinterpret_cast<std::string *>(pValue) += m_name) += \";\";\n\t\treturn true;\n\t}\n\telse if (strcmp(name, m_name) == 0)\n\t{\n\t\tAssignValue(name, valueType, pValue);\n\t\tm_used = true;\n\t\treturn true;\n\t}\n\telse if (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t    return false;\n}"
  },
  {
    "function_name": "AlgorithmParametersBase::operator=",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "21-24",
    "snippet": "void AlgorithmParametersBase::operator=(const AlgorithmParametersBase& rhs)\n{\n\tassert(false);\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "false"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nvoid AlgorithmParametersBase::operator=(const AlgorithmParametersBase& rhs)\n{\n\tassert(false);\n}"
  },
  {
    "function_name": "CombinedNameValuePairs::GetVoidValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "13-19",
    "snippet": "bool CombinedNameValuePairs::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (strcmp(name, \"ValueNames\") == 0)\n\t\treturn m_pairs1.GetVoidValue(name, valueType, pValue) && m_pairs2.GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn m_pairs1.GetVoidValue(name, valueType, pValue) || m_pairs2.GetVoidValue(name, valueType, pValue);\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_pairs2.GetVoidValue",
          "args": [
            "name",
            "valueType",
            "pValue"
          ],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "GetVoidValue",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "127-130",
          "snippet": "bool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\treturn GetValueHelper<DL_GroupParameters_IntegerBased>(this, name, valueType, pValue).Assignable();\n\t}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nbool GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\treturn GetValueHelper<DL_GroupParameters_IntegerBased>(this, name, valueType, pValue).Assignable();\n\t}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"ValueNames\""
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nbool CombinedNameValuePairs::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (strcmp(name, \"ValueNames\") == 0)\n\t\treturn m_pairs1.GetVoidValue(name, valueType, pValue) && m_pairs2.GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn m_pairs1.GetVoidValue(name, valueType, pValue) || m_pairs2.GetVoidValue(name, valueType, pValue);\n}"
  }
]