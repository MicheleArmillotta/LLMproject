[
  {
    "function_name": "GetVoidValue",
    "container": "AlgorithmParameters",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "65-71",
    "snippet": "bool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn false;\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_next->GetVoidValue",
          "args": [
            "name",
            "valueType",
            "pValue"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "GetVoidValue",
          "container": "AlgorithmParameters",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
          "lines": "65-71",
          "snippet": "bool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn false;\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "m_next.get",
          "args": [],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParameters {\n  bool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n  {\n  \tif (m_next.get())\n  \t\treturn m_next->GetVoidValue(name, valueType, pValue);\n  \telse\n  \t\treturn false;\n  }\n}"
  },
  {
    "function_name": "AlgorithmParameters",
    "container": "AlgorithmParameters",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "53-57",
    "snippet": "AlgorithmParameters::AlgorithmParameters(const AlgorithmParameters &x)\n\t: m_defaultThrowIfNotUsed(x.m_defaultThrowIfNotUsed)\n{\n\tm_next.reset(const_cast<AlgorithmParameters &>(x).m_next.release());\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_next.reset",
          "args": [
            "const_cast<AlgorithmParameters &>(x).m_next.release()"
          ],
          "line": 56
        },
        "resolved": true,
        "details": {
          "function_name": "reset",
          "container": "member_ptr<T>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "50-50",
          "snippet": "void member_ptr<T>::reset(T *p) {delete m_p; m_p = p;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nmember_ptr<T> {\n  void member_ptr<T>::reset(T *p) {delete m_p; m_p = p;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "const_cast<AlgorithmParameters &>",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "const_cast<AlgorithmParameters &>",
          "args": [
            "x"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParameters {\n  AlgorithmParameters::AlgorithmParameters(const AlgorithmParameters &x)\n  \t: m_defaultThrowIfNotUsed(x.m_defaultThrowIfNotUsed)\n  {\n  \tm_next.reset(const_cast<AlgorithmParameters &>(x).m_next.release());\n  }\n}"
  },
  {
    "function_name": "AlgorithmParameters",
    "container": "AlgorithmParameters",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "48-51",
    "snippet": "AlgorithmParameters::AlgorithmParameters()\n\t: m_defaultThrowIfNotUsed(true)\n{\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParameters {\n  AlgorithmParameters::AlgorithmParameters()\n  \t: m_defaultThrowIfNotUsed(true)\n  {\n  }\n}"
  },
  {
    "function_name": "GetVoidValue",
    "container": "AlgorithmParametersBase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "26-46",
    "snippet": "bool AlgorithmParametersBase::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (strcmp(name, \"ValueNames\") == 0)\n\t{\n\t\tNameValuePairs::ThrowIfTypeMismatch(name, typeid(std::string), valueType);\n\t\tif (m_next.get())\n\t\t    m_next->GetVoidValue(name, valueType, pValue);\n\t\t(*reinterpret_cast<std::string *>(pValue) += m_name) += \";\";\n\t\treturn true;\n\t}\n\telse if (strcmp(name, m_name) == 0)\n\t{\n\t\tAssignValue(name, valueType, pValue);\n\t\tm_used = true;\n\t\treturn true;\n\t}\n\telse if (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t    return false;\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_next->GetVoidValue",
          "args": [
            "name",
            "valueType",
            "pValue"
          ],
          "line": 43
        },
        "resolved": true,
        "details": {
          "function_name": "GetVoidValue",
          "container": "AlgorithmParameters",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
          "lines": "65-71",
          "snippet": "bool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn false;\n}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParameters {\n  bool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n  {\n  \tif (m_next.get())\n  \t\treturn m_next->GetVoidValue(name, valueType, pValue);\n  \telse\n  \t\treturn false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_next.get",
          "args": [],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssignValue",
          "args": [
            "name",
            "valueType",
            "pValue"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "AssignValue",
          "container": "AlgorithmParametersTemplate",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "310-318",
          "snippet": "void AssignValue(const char *name, const std::type_info &valueType, void *pValue) const\n\t{\n\t\t// special case for retrieving an Integer parameter when an int was passed in\n\t\tif (!(g_pAssignIntToInteger != NULL && typeid(T) == typeid(int) && g_pAssignIntToInteger(valueType, pValue, &m_value)))\n\t\t{\n\t\t\tNameValuePairs::ThrowIfTypeMismatch(name, typeid(T), valueType);\n\t\t\t*reinterpret_cast<T *>(pValue) = m_value;\n\t\t}\n\t}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAlgorithmParametersTemplate {\n  void AssignValue(const char *name, const std::type_info &valueType, void *pValue) const\n  \t{\n  \t\t// special case for retrieving an Integer parameter when an int was passed in\n  \t\tif (!(g_pAssignIntToInteger != NULL && typeid(T) == typeid(int) && g_pAssignIntToInteger(valueType, pValue, &m_value)))\n  \t\t{\n  \t\t\tNameValuePairs::ThrowIfTypeMismatch(name, typeid(T), valueType);\n  \t\t\t*reinterpret_cast<T *>(pValue) = m_value;\n  \t\t}\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "m_name"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<std::string *>",
          "args": [
            "pValue"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_next.get",
          "args": [],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "NameValuePairs::ThrowIfTypeMismatch",
          "args": [
            "name",
            "typeid(std::string)",
            "valueType"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "typeid",
          "args": [
            "std::string"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"ValueNames\""
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParametersBase {\n  bool AlgorithmParametersBase::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n  {\n  \tif (strcmp(name, \"ValueNames\") == 0)\n  \t{\n  \t\tNameValuePairs::ThrowIfTypeMismatch(name, typeid(std::string), valueType);\n  \t\tif (m_next.get())\n  \t\t    m_next->GetVoidValue(name, valueType, pValue);\n  \t\t(*reinterpret_cast<std::string *>(pValue) += m_name) += \";\";\n  \t\treturn true;\n  \t}\n  \telse if (strcmp(name, m_name) == 0)\n  \t{\n  \t\tAssignValue(name, valueType, pValue);\n  \t\tm_used = true;\n  \t\treturn true;\n  \t}\n  \telse if (m_next.get())\n  \t\treturn m_next->GetVoidValue(name, valueType, pValue);\n  \telse\n  \t    return false;\n  }\n}"
  },
  {
    "function_name": "operator=",
    "container": "AlgorithmParametersBase",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "21-24",
    "snippet": "void AlgorithmParametersBase::operator=(const AlgorithmParametersBase& rhs)\n{\n\tassert(false);\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "false"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParametersBase {\n  void AlgorithmParametersBase::operator=(const AlgorithmParametersBase& rhs)\n  {\n  \tassert(false);\n  }\n}"
  },
  {
    "function_name": "GetVoidValue",
    "container": "CombinedNameValuePairs",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
    "lines": "13-19",
    "snippet": "bool CombinedNameValuePairs::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (strcmp(name, \"ValueNames\") == 0)\n\t\treturn m_pairs1.GetVoidValue(name, valueType, pValue) && m_pairs2.GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn m_pairs1.GetVoidValue(name, valueType, pValue) || m_pairs2.GetVoidValue(name, valueType, pValue);\n}",
    "includes": [
      "#include \"algparam.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_pairs2.GetVoidValue",
          "args": [
            "name",
            "valueType",
            "pValue"
          ],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "GetVoidValue",
          "container": "AlgorithmParameters",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.cpp",
          "lines": "65-71",
          "snippet": "bool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\tif (m_next.get())\n\t\treturn m_next->GetVoidValue(name, valueType, pValue);\n\telse\n\t\treturn false;\n}",
          "includes": [
            "#include \"algparam.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nAlgorithmParameters {\n  bool AlgorithmParameters::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n  {\n  \tif (m_next.get())\n  \t\treturn m_next->GetVoidValue(name, valueType, pValue);\n  \telse\n  \t\treturn false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strcmp",
          "args": [
            "name",
            "\"ValueNames\""
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"algparam.h\"\n#include \"pch.h\"\n\nCombinedNameValuePairs {\n  bool CombinedNameValuePairs::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n  {\n  \tif (strcmp(name, \"ValueNames\") == 0)\n  \t\treturn m_pairs1.GetVoidValue(name, valueType, pValue) && m_pairs2.GetVoidValue(name, valueType, pValue);\n  \telse\n  \t\treturn m_pairs1.GetVoidValue(name, valueType, pValue) || m_pairs2.GetVoidValue(name, valueType, pValue);\n  }\n}"
  }
]