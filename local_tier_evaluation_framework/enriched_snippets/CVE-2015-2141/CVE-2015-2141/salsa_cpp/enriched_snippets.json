[
  {
    "function_name": "CipherResynchronize",
    "container": "XSalsa20_Policy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/salsa.cpp",
    "lines": "568-597",
    "snippet": "void XSalsa20_Policy::CipherResynchronize(byte *keystreamBuffer, const byte *IV, size_t length)\n{\n\tassert(length==24);\n\n\tword32 x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n\n\tGetBlock<word32, LittleEndian> get(IV);\n\tget(x14)(x11)(x8)(x5)(m_state[14])(m_state[11]);\n\n\tx13 = m_key[0];\t\tx10 = m_key[1];\t\tx7 = m_key[2];\t\tx4 = m_key[3];\n\tx15 = m_key[4];\t\tx12 = m_key[5];\t\tx9 = m_key[6];\t\tx6 = m_key[7];\n\tx0 = m_state[0];\tx1 = m_state[1];\tx2 = m_state[2];\tx3 = m_state[3];\n\n\tfor (int i=m_rounds; i>0; i-=2)\n\t{\n\t\tQUARTER_ROUND(x0, x4, x8, x12)\n\t\tQUARTER_ROUND(x1, x5, x9, x13)\n\t\tQUARTER_ROUND(x2, x6, x10, x14)\n\t\tQUARTER_ROUND(x3, x7, x11, x15)\n\n\t\tQUARTER_ROUND(x0, x13, x10, x7)\n\t\tQUARTER_ROUND(x1, x14, x11, x4)\n\t\tQUARTER_ROUND(x2, x15, x8, x5)\n\t\tQUARTER_ROUND(x3, x12, x9, x6)\n\t}\n\n\tm_state[13] = x0;\tm_state[10] = x1;\tm_state[7] = x2;\tm_state[4] = x3;\n\tm_state[15] = x14;\tm_state[12] = x11;\tm_state[9] = x8;\tm_state[6] = x5;\n\tm_state[8] = m_state[5] = 0;\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"salsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QUARTER_ROUND",
          "args": [
            "x3",
            "x12",
            "x9",
            "x6"
          ],
          "line": 591
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUARTER_ROUND",
          "args": [
            "x2",
            "x15",
            "x8",
            "x5"
          ],
          "line": 590
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUARTER_ROUND",
          "args": [
            "x1",
            "x14",
            "x11",
            "x4"
          ],
          "line": 589
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUARTER_ROUND",
          "args": [
            "x0",
            "x13",
            "x10",
            "x7"
          ],
          "line": 588
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUARTER_ROUND",
          "args": [
            "x3",
            "x7",
            "x11",
            "x15"
          ],
          "line": 586
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUARTER_ROUND",
          "args": [
            "x2",
            "x6",
            "x10",
            "x14"
          ],
          "line": 585
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUARTER_ROUND",
          "args": [
            "x1",
            "x5",
            "x9",
            "x13"
          ],
          "line": 584
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUARTER_ROUND",
          "args": [
            "x0",
            "x4",
            "x8",
            "x12"
          ],
          "line": 583
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get",
          "args": [
            "m_state[11]"
          ],
          "line": 575
        },
        "resolved": true,
        "details": {
          "function_name": "Unget",
          "container": "ByteQueue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "378-381",
          "snippet": "void ByteQueue::Unget(byte inByte)\n{\n\tUnget(&inByte, 1);\n}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueue {\n  void ByteQueue::Unget(byte inByte)\n  {\n  \tUnget(&inByte, 1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length==24"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"misc.h\"\n#include \"salsa.h\"\n#include \"pch.h\"\n\nXSalsa20_Policy {\n  void XSalsa20_Policy::CipherResynchronize(byte *keystreamBuffer, const byte *IV, size_t length)\n  {\n  \tassert(length==24);\n  \n  \tword32 x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n  \n  \tGetBlock<word32, LittleEndian> get(IV);\n  \tget(x14)(x11)(x8)(x5)(m_state[14])(m_state[11]);\n  \n  \tx13 = m_key[0];\t\tx10 = m_key[1];\t\tx7 = m_key[2];\t\tx4 = m_key[3];\n  \tx15 = m_key[4];\t\tx12 = m_key[5];\t\tx9 = m_key[6];\t\tx6 = m_key[7];\n  \tx0 = m_state[0];\tx1 = m_state[1];\tx2 = m_state[2];\tx3 = m_state[3];\n  \n  \tfor (int i=m_rounds; i>0; i-=2)\n  \t{\n  \t\tQUARTER_ROUND(x0, x4, x8, x12)\n  \t\tQUARTER_ROUND(x1, x5, x9, x13)\n  \t\tQUARTER_ROUND(x2, x6, x10, x14)\n  \t\tQUARTER_ROUND(x3, x7, x11, x15)\n  \n  \t\tQUARTER_ROUND(x0, x13, x10, x7)\n  \t\tQUARTER_ROUND(x1, x14, x11, x4)\n  \t\tQUARTER_ROUND(x2, x15, x8, x5)\n  \t\tQUARTER_ROUND(x3, x12, x9, x6)\n  \t}\n  \n  \tm_state[13] = x0;\tm_state[10] = x1;\tm_state[7] = x2;\tm_state[4] = x3;\n  \tm_state[15] = x14;\tm_state[12] = x11;\tm_state[9] = x8;\tm_state[6] = x5;\n  \tm_state[8] = m_state[5] = 0;\n  }\n}"
  },
  {
    "function_name": "CipherSetKey",
    "container": "XSalsa20_Policy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/salsa.cpp",
    "lines": "550-566",
    "snippet": "void XSalsa20_Policy::CipherSetKey(const NameValuePairs &params, const byte *key, size_t length)\n{\n\tm_rounds = params.GetIntValueWithDefault(Name::Rounds(), 20);\n\n\tif (!(m_rounds == 8 || m_rounds == 12 || m_rounds == 20))\n\t\tthrow InvalidRounds(XSalsa20::StaticAlgorithmName(), m_rounds);\n\n\tGetUserKey(LITTLE_ENDIAN_ORDER, m_key.begin(), m_key.size(), key, length);\n\tif (length == 16)\n\t\tmemcpy(m_key.begin()+4, m_key.begin(), 16);\n\n\t// \"expand 32-byte k\"\n\tm_state[0] = 0x61707865;\n\tm_state[1] = 0x3320646e;\n\tm_state[2] = 0x79622d32;\n\tm_state[3] = 0x6b206574;\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"salsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m_key.begin()+4",
            "m_key.begin()",
            "16"
          ],
          "line": 559
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_key.begin",
          "args": [],
          "line": 559
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetUserKey",
          "args": [
            "LITTLE_ENDIAN_ORDER",
            "m_key.begin()",
            "m_key.size()",
            "key",
            "length"
          ],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "946-953",
          "snippet": "inline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [
            "#define memcpy_s CryptoPP::memcpy_s"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\n#define memcpy_s CryptoPP::memcpy_s\n\ninline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_key.size",
          "args": [],
          "line": 557
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidRounds",
          "args": [
            "XSalsa20::StaticAlgorithmName()",
            "m_rounds"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "ThrowIfInvalidRounds",
          "container": "FixedBlockSize::FixedRounds::VariableRounds",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "48-52",
          "snippet": "inline void ThrowIfInvalidRounds(int rounds, const Algorithm *alg)\n\t{\n\t\tif (rounds < MIN_ROUNDS || rounds > MAX_ROUNDS)\n\t\t\tthrow InvalidRounds(alg->AlgorithmName(), rounds);\n\t}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nFixedBlockSize {\n  FixedRounds {\n    VariableRounds {\n      inline void ThrowIfInvalidRounds(int rounds, const Algorithm *alg)\n      \t{\n      \t\tif (rounds < MIN_ROUNDS || rounds > MAX_ROUNDS)\n      \t\t\tthrow InvalidRounds(alg->AlgorithmName(), rounds);\n      \t}\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "XSalsa20::StaticAlgorithmName",
          "args": [],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "StaticAlgorithmName",
          "container": "CBC_MAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cbcmac.h",
          "lines": "41-41",
          "snippet": "static std::string StaticAlgorithmName() {return std::string(\"CBC-MAC(\") + T::StaticAlgorithmName() + \")\";}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"seckey.h\"\n\nCBC_MAC {\n  static std::string StaticAlgorithmName() {return std::string(\"CBC-MAC(\") + T::StaticAlgorithmName() + \")\";}\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.GetIntValueWithDefault",
          "args": [
            "Name::Rounds()",
            "20"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Rounds",
          "args": [],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"misc.h\"\n#include \"salsa.h\"\n#include \"pch.h\"\n\nXSalsa20_Policy {\n  void XSalsa20_Policy::CipherSetKey(const NameValuePairs &params, const byte *key, size_t length)\n  {\n  \tm_rounds = params.GetIntValueWithDefault(Name::Rounds(), 20);\n  \n  \tif (!(m_rounds == 8 || m_rounds == 12 || m_rounds == 20))\n  \t\tthrow InvalidRounds(XSalsa20::StaticAlgorithmName(), m_rounds);\n  \n  \tGetUserKey(LITTLE_ENDIAN_ORDER, m_key.begin(), m_key.size(), key, length);\n  \tif (length == 16)\n  \t\tmemcpy(m_key.begin()+4, m_key.begin(), 16);\n  \n  \t// \"expand 32-byte k\"\n  \tm_state[0] = 0x61707865;\n  \tm_state[1] = 0x3320646e;\n  \tm_state[2] = 0x79622d32;\n  \tm_state[3] = 0x6b206574;\n  }\n}"
  },
  {
    "function_name": "GetOptimalBlockSize",
    "container": "Salsa20_Policy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/salsa.cpp",
    "lines": "66-74",
    "snippet": "unsigned int Salsa20_Policy::GetOptimalBlockSize() const\n{\n#if CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE\n\tif (HasSSE2())\n\t\treturn 4*BYTES_PER_ITERATION;\n\telse\n#endif\n\t\treturn BYTES_PER_ITERATION;\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"salsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HasSSE2",
          "args": [],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "HasSSE2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cpu.h",
          "lines": "123-128",
          "snippet": "inline bool HasSSE2()\n{\n\tif (!g_x86DetectionDone)\n\t\tDetectX86Features();\n\treturn g_hasSSE2;\n}",
          "includes": [
            "#include <wmmintrin.h>",
            "#include <smmintrin.h>",
            "#include <tmmintrin.h>",
            "#include <emmintrin.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <wmmintrin.h>\n#include <smmintrin.h>\n#include <tmmintrin.h>\n#include <emmintrin.h>\n#include \"config.h\"\n\ninline bool HasSSE2()\n{\n\tif (!g_x86DetectionDone)\n\t\tDetectX86Features();\n\treturn g_hasSSE2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"misc.h\"\n#include \"salsa.h\"\n#include \"pch.h\"\n\nSalsa20_Policy {\n  unsigned int Salsa20_Policy::GetOptimalBlockSize() const\n  {\n  #if CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE\n  \tif (HasSSE2())\n  \t\treturn 4*BYTES_PER_ITERATION;\n  \telse\n  #endif\n  \t\treturn BYTES_PER_ITERATION;\n  }\n}"
  },
  {
    "function_name": "GetAlignment",
    "container": "Salsa20_Policy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/salsa.cpp",
    "lines": "56-64",
    "snippet": "unsigned int Salsa20_Policy::GetAlignment() const\n{\n#if CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE\n\tif (HasSSE2())\n\t\treturn 16;\n\telse\n#endif\n\t\treturn GetAlignmentOf<word32>();\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"salsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetAlignmentOf<word32>",
          "args": [],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "GetAlignmentOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "363-379",
          "snippet": "inline unsigned int GetAlignmentOf(T *dummy=NULL)\t// VC60 workaround\n{\n#ifdef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (sizeof(T) < 16)\n\t\treturn 1;\n#endif\n\n#if (_MSC_VER >= 1300)\n\treturn __alignof(T);\n#elif defined(__GNUC__)\n\treturn __alignof__(T);\n#elif CRYPTOPP_BOOL_SLOW_WORD64\n\treturn UnsignedMin(4U, sizeof(T));\n#else\n\treturn sizeof(T);\n#endif\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline unsigned int GetAlignmentOf(T *dummy=NULL)\t// VC60 workaround\n{\n#ifdef CRYPTOPP_ALLOW_UNALIGNED_DATA_ACCESS\n\tif (sizeof(T) < 16)\n\t\treturn 1;\n#endif\n\n#if (_MSC_VER >= 1300)\n\treturn __alignof(T);\n#elif defined(__GNUC__)\n\treturn __alignof__(T);\n#elif CRYPTOPP_BOOL_SLOW_WORD64\n\treturn UnsignedMin(4U, sizeof(T));\n#else\n\treturn sizeof(T);\n#endif\n}"
        }
      },
      {
        "call_info": {
          "callee": "HasSSE2",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "HasSSE2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cpu.h",
          "lines": "123-128",
          "snippet": "inline bool HasSSE2()\n{\n\tif (!g_x86DetectionDone)\n\t\tDetectX86Features();\n\treturn g_hasSSE2;\n}",
          "includes": [
            "#include <wmmintrin.h>",
            "#include <smmintrin.h>",
            "#include <tmmintrin.h>",
            "#include <emmintrin.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <wmmintrin.h>\n#include <smmintrin.h>\n#include <tmmintrin.h>\n#include <emmintrin.h>\n#include \"config.h\"\n\ninline bool HasSSE2()\n{\n\tif (!g_x86DetectionDone)\n\t\tDetectX86Features();\n\treturn g_hasSSE2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"misc.h\"\n#include \"salsa.h\"\n#include \"pch.h\"\n\nSalsa20_Policy {\n  unsigned int Salsa20_Policy::GetAlignment() const\n  {\n  #if CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE\n  \tif (HasSSE2())\n  \t\treturn 16;\n  \telse\n  #endif\n  \t\treturn GetAlignmentOf<word32>();\n  }\n}"
  },
  {
    "function_name": "SeekToIteration",
    "container": "Salsa20_Policy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/salsa.cpp",
    "lines": "49-53",
    "snippet": "void Salsa20_Policy::SeekToIteration(lword iterationCount)\n{\n\tm_state[8] = (word32)iterationCount;\n\tm_state[5] = (word32)SafeRightShift<32>(iterationCount);\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"salsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SafeRightShift<32>",
          "args": [
            "iterationCount"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "SafeRightShift",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1257-1260",
          "snippet": "inline T SafeRightShift(T value)\n{\n\treturn SafeShifter<(bits>=(8*sizeof(T)))>::RightShift(value, bits);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T SafeRightShift(T value)\n{\n\treturn SafeShifter<(bits>=(8*sizeof(T)))>::RightShift(value, bits);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"misc.h\"\n#include \"salsa.h\"\n#include \"pch.h\"\n\nSalsa20_Policy {\n  void Salsa20_Policy::SeekToIteration(lword iterationCount)\n  {\n  \tm_state[8] = (word32)iterationCount;\n  \tm_state[5] = (word32)SafeRightShift<32>(iterationCount);\n  }\n}"
  },
  {
    "function_name": "CipherResynchronize",
    "container": "Salsa20_Policy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/salsa.cpp",
    "lines": "41-47",
    "snippet": "void Salsa20_Policy::CipherResynchronize(byte *keystreamBuffer, const byte *IV, size_t length)\n{\n\tassert(length==8);\n\tGetBlock<word32, LittleEndian> get(IV);\n\tget(m_state[14])(m_state[11]);\n\tm_state[8] = m_state[5] = 0;\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"salsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get",
          "args": [
            "m_state[11]"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "Unget",
          "container": "ByteQueue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "378-381",
          "snippet": "void ByteQueue::Unget(byte inByte)\n{\n\tUnget(&inByte, 1);\n}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueue {\n  void ByteQueue::Unget(byte inByte)\n  {\n  \tUnget(&inByte, 1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "length==8"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"misc.h\"\n#include \"salsa.h\"\n#include \"pch.h\"\n\nSalsa20_Policy {\n  void Salsa20_Policy::CipherResynchronize(byte *keystreamBuffer, const byte *IV, size_t length)\n  {\n  \tassert(length==8);\n  \tGetBlock<word32, LittleEndian> get(IV);\n  \tget(m_state[14])(m_state[11]);\n  \tm_state[8] = m_state[5] = 0;\n  }\n}"
  },
  {
    "function_name": "CipherSetKey",
    "container": "Salsa20_Policy",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/salsa.cpp",
    "lines": "21-39",
    "snippet": "void Salsa20_Policy::CipherSetKey(const NameValuePairs &params, const byte *key, size_t length)\n{\n\tm_rounds = params.GetIntValueWithDefault(Name::Rounds(), 20);\n\n\tif (!(m_rounds == 8 || m_rounds == 12 || m_rounds == 20))\n\t\tthrow InvalidRounds(Salsa20::StaticAlgorithmName(), m_rounds);\n\n\t// m_state is reordered for SSE2\n\tGetBlock<word32, LittleEndian> get1(key);\n\tget1(m_state[13])(m_state[10])(m_state[7])(m_state[4]);\n\tGetBlock<word32, LittleEndian> get2(key + length - 16);\n\tget2(m_state[15])(m_state[12])(m_state[9])(m_state[6]);\n\n\t// \"expand 16-byte k\" or \"expand 32-byte k\"\n\tm_state[0] = 0x61707865;\n\tm_state[1] = (length == 16) ? 0x3120646e : 0x3320646e;\n\tm_state[2] = (length == 16) ? 0x79622d36 : 0x79622d32;\n\tm_state[3] = 0x6b206574;\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"salsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "get2",
          "args": [
            "m_state[6]"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get2",
          "args": [
            "m_state[9]"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get2",
          "args": [
            "m_state[12]"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get2",
          "args": [
            "m_state[15]"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get1",
          "args": [
            "m_state[4]"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get1",
          "args": [
            "m_state[7]"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get1",
          "args": [
            "m_state[10]"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "get1",
          "args": [
            "m_state[13]"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidRounds",
          "args": [
            "Salsa20::StaticAlgorithmName()",
            "m_rounds"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "ThrowIfInvalidRounds",
          "container": "FixedBlockSize::FixedRounds::VariableRounds",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "48-52",
          "snippet": "inline void ThrowIfInvalidRounds(int rounds, const Algorithm *alg)\n\t{\n\t\tif (rounds < MIN_ROUNDS || rounds > MAX_ROUNDS)\n\t\t\tthrow InvalidRounds(alg->AlgorithmName(), rounds);\n\t}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nFixedBlockSize {\n  FixedRounds {\n    VariableRounds {\n      inline void ThrowIfInvalidRounds(int rounds, const Algorithm *alg)\n      \t{\n      \t\tif (rounds < MIN_ROUNDS || rounds > MAX_ROUNDS)\n      \t\t\tthrow InvalidRounds(alg->AlgorithmName(), rounds);\n      \t}\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Salsa20::StaticAlgorithmName",
          "args": [],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "StaticAlgorithmName",
          "container": "CBC_MAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cbcmac.h",
          "lines": "41-41",
          "snippet": "static std::string StaticAlgorithmName() {return std::string(\"CBC-MAC(\") + T::StaticAlgorithmName() + \")\";}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"seckey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"seckey.h\"\n\nCBC_MAC {\n  static std::string StaticAlgorithmName() {return std::string(\"CBC-MAC(\") + T::StaticAlgorithmName() + \")\";}\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.GetIntValueWithDefault",
          "args": [
            "Name::Rounds()",
            "20"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::Rounds",
          "args": [],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"misc.h\"\n#include \"salsa.h\"\n#include \"pch.h\"\n\nSalsa20_Policy {\n  void Salsa20_Policy::CipherSetKey(const NameValuePairs &params, const byte *key, size_t length)\n  {\n  \tm_rounds = params.GetIntValueWithDefault(Name::Rounds(), 20);\n  \n  \tif (!(m_rounds == 8 || m_rounds == 12 || m_rounds == 20))\n  \t\tthrow InvalidRounds(Salsa20::StaticAlgorithmName(), m_rounds);\n  \n  \t// m_state is reordered for SSE2\n  \tGetBlock<word32, LittleEndian> get1(key);\n  \tget1(m_state[13])(m_state[10])(m_state[7])(m_state[4]);\n  \tGetBlock<word32, LittleEndian> get2(key + length - 16);\n  \tget2(m_state[15])(m_state[12])(m_state[9])(m_state[6]);\n  \n  \t// \"expand 16-byte k\" or \"expand 32-byte k\"\n  \tm_state[0] = 0x61707865;\n  \tm_state[1] = (length == 16) ? 0x3120646e : 0x3320646e;\n  \tm_state[2] = (length == 16) ? 0x79622d36 : 0x79622d32;\n  \tm_state[3] = 0x6b206574;\n  }\n}"
  },
  {
    "function_name": "Salsa20_TestInstantiations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/salsa.cpp",
    "lines": "16-19",
    "snippet": "void Salsa20_TestInstantiations()\n{\n\tSalsa20::Encryption x;\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"salsa.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"argnames.h\"\n#include \"misc.h\"\n#include \"salsa.h\"\n#include \"pch.h\"\n\nvoid Salsa20_TestInstantiations()\n{\n\tSalsa20::Encryption x;\n}"
  }
]