[
  {
    "function_name": "DefaultDecryptorWithMAC::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "251-256",
    "snippet": "void DefaultDecryptorWithMAC::LastPut(const byte *inString, size_t length)\n{\n\tm_filter->MessageEnd();\n\tif (m_throwException && !CheckLastMAC())\n\t\tthrow MACBadErr();\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MACBadErr",
          "args": [],
          "line": 255
        },
        "resolved": true,
        "details": {
          "function_name": "MACBadErr",
          "container": "DefaultDecryptorWithMAC::MACBadErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.h",
          "lines": "84-84",
          "snippet": "MACBadErr() : DefaultDecryptor::Err(\"DefaultDecryptorWithMAC: MAC check failed\") {}",
          "includes": [
            "#include \"modes.h\"",
            "#include \"filters.h\"",
            "#include \"des.h\"",
            "#include \"hmac.h\"",
            "#include \"sha.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modes.h\"\n#include \"filters.h\"\n#include \"des.h\"\n#include \"hmac.h\"\n#include \"sha.h\"\n\nDefaultDecryptorWithMAC {\n  MACBadErr {\n    MACBadErr() : DefaultDecryptor::Err(\"DefaultDecryptorWithMAC: MAC check failed\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CheckLastMAC",
          "args": [],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "DefaultDecryptorWithMAC::CheckLastMAC",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
          "lines": "246-249",
          "snippet": "bool DefaultDecryptorWithMAC::CheckLastMAC() const\n{\n\treturn m_hashVerifier->GetLastResult();\n}",
          "includes": [
            "#include <memory>",
            "#include <time.h>",
            "#include \"queue.h\"",
            "#include \"default.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nbool DefaultDecryptorWithMAC::CheckLastMAC() const\n{\n\treturn m_hashVerifier->GetLastResult();\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_filter->MessageEnd",
          "args": [],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nvoid DefaultDecryptorWithMAC::LastPut(const byte *inString, size_t length)\n{\n\tm_filter->MessageEnd();\n\tif (m_throwException && !CheckLastMAC())\n\t\tthrow MACBadErr();\n}"
  },
  {
    "function_name": "DefaultDecryptorWithMAC::CheckLastMAC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "246-249",
    "snippet": "bool DefaultDecryptorWithMAC::CheckLastMAC() const\n{\n\treturn m_hashVerifier->GetLastResult();\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_hashVerifier->GetLastResult",
          "args": [],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "GetLastResult",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.h",
          "lines": "374-374",
          "snippet": "bool GetLastResult() const {return m_hashVerifier.GetLastResult();}",
          "includes": [
            "#include <deque>",
            "#include \"algparam.h\"",
            "#include \"queue.h\"",
            "#include \"smartptr.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"simple.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include \"algparam.h\"\n#include \"queue.h\"\n#include \"smartptr.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"simple.h\"\n\nbool GetLastResult() const {return m_hashVerifier.GetLastResult();}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nbool DefaultDecryptorWithMAC::CheckLastMAC() const\n{\n\treturn m_hashVerifier->GetLastResult();\n}"
  },
  {
    "function_name": "DefaultDecryptorWithMAC::CurrentState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "241-244",
    "snippet": "DefaultDecryptor::State DefaultDecryptorWithMAC::CurrentState() const\n{\n\treturn static_cast<const DefaultDecryptor *>(m_filter.get())->CurrentState();\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<const DefaultDecryptor *>",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<const DefaultDecryptor *>",
          "args": [
            "m_filter.get()"
          ],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_filter.get",
          "args": [],
          "line": 243
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nDefaultDecryptor::State DefaultDecryptorWithMAC::CurrentState() const\n{\n\treturn static_cast<const DefaultDecryptor *>(m_filter.get())->CurrentState();\n}"
  },
  {
    "function_name": "DefaultDecryptorWithMAC::DefaultDecryptorWithMAC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "233-239",
    "snippet": "DefaultDecryptorWithMAC::DefaultDecryptorWithMAC(const byte *passphrase, size_t passphraseLength, BufferedTransformation *attachment, bool throwException)\n\t: ProxyFilter(NULL, 0, 0, attachment)\n\t, m_mac(NewDefaultEncryptorMAC(passphrase, passphraseLength))\n\t, m_throwException(throwException)\n{\n\tSetFilter(new DefaultDecryptor(passphrase, passphraseLength, m_hashVerifier=new HashVerifier(*m_mac, NULL, HashVerifier::PUT_MESSAGE), throwException));\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetFilter",
          "args": [
            "new DefaultDecryptor(passphrase, passphraseLength, m_hashVerifier=new HashVerifier(*m_mac, NULL, HashVerifier::PUT_MESSAGE), throwException)"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "ProxyFilter::SetFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "473-483",
          "snippet": "void ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "NewDefaultEncryptorMAC",
          "args": [
            "passphrase",
            "passphraseLength"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nDefaultDecryptorWithMAC::DefaultDecryptorWithMAC(const byte *passphrase, size_t passphraseLength, BufferedTransformation *attachment, bool throwException)\n\t: ProxyFilter(NULL, 0, 0, attachment)\n\t, m_mac(NewDefaultEncryptorMAC(passphrase, passphraseLength))\n\t, m_throwException(throwException)\n{\n\tSetFilter(new DefaultDecryptor(passphrase, passphraseLength, m_hashVerifier=new HashVerifier(*m_mac, NULL, HashVerifier::PUT_MESSAGE), throwException));\n}"
  },
  {
    "function_name": "DefaultDecryptorWithMAC::DefaultDecryptorWithMAC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "225-231",
    "snippet": "DefaultDecryptorWithMAC::DefaultDecryptorWithMAC(const char *passphrase, BufferedTransformation *attachment, bool throwException)\n\t: ProxyFilter(NULL, 0, 0, attachment)\n\t, m_mac(NewDefaultEncryptorMAC((const byte *)passphrase, strlen(passphrase)))\n\t, m_throwException(throwException)\n{\n\tSetFilter(new DefaultDecryptor(passphrase, m_hashVerifier=new HashVerifier(*m_mac, NULL, HashVerifier::PUT_MESSAGE), throwException));\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetFilter",
          "args": [
            "new DefaultDecryptor(passphrase, m_hashVerifier=new HashVerifier(*m_mac, NULL, HashVerifier::PUT_MESSAGE), throwException)"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "ProxyFilter::SetFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "473-483",
          "snippet": "void ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "NewDefaultEncryptorMAC",
          "args": [
            "(const byte *)passphrase",
            "strlen(passphrase)"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "passphrase"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nDefaultDecryptorWithMAC::DefaultDecryptorWithMAC(const char *passphrase, BufferedTransformation *attachment, bool throwException)\n\t: ProxyFilter(NULL, 0, 0, attachment)\n\t, m_mac(NewDefaultEncryptorMAC((const byte *)passphrase, strlen(passphrase)))\n\t, m_throwException(throwException)\n{\n\tSetFilter(new DefaultDecryptor(passphrase, m_hashVerifier=new HashVerifier(*m_mac, NULL, HashVerifier::PUT_MESSAGE), throwException));\n}"
  },
  {
    "function_name": "DefaultEncryptorWithMAC::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "218-221",
    "snippet": "void DefaultEncryptorWithMAC::LastPut(const byte *inString, size_t length)\n{\n\tm_filter->MessageEnd();\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->MessageEnd",
          "args": [],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nvoid DefaultEncryptorWithMAC::LastPut(const byte *inString, size_t length)\n{\n\tm_filter->MessageEnd();\n}"
  },
  {
    "function_name": "DefaultEncryptorWithMAC::DefaultEncryptorWithMAC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "211-216",
    "snippet": "DefaultEncryptorWithMAC::DefaultEncryptorWithMAC(const byte *passphrase, size_t passphraseLength, BufferedTransformation *attachment)\n\t: ProxyFilter(NULL, 0, 0, attachment)\n\t, m_mac(NewDefaultEncryptorMAC(passphrase, passphraseLength))\n{\n\tSetFilter(new HashFilter(*m_mac, new DefaultEncryptor(passphrase, passphraseLength), true));\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetFilter",
          "args": [
            "new HashFilter(*m_mac, new DefaultEncryptor(passphrase, passphraseLength), true)"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "ProxyFilter::SetFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "473-483",
          "snippet": "void ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "NewDefaultEncryptorMAC",
          "args": [
            "passphrase",
            "passphraseLength"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nDefaultEncryptorWithMAC::DefaultEncryptorWithMAC(const byte *passphrase, size_t passphraseLength, BufferedTransformation *attachment)\n\t: ProxyFilter(NULL, 0, 0, attachment)\n\t, m_mac(NewDefaultEncryptorMAC(passphrase, passphraseLength))\n{\n\tSetFilter(new HashFilter(*m_mac, new DefaultEncryptor(passphrase, passphraseLength), true));\n}"
  },
  {
    "function_name": "DefaultEncryptorWithMAC::DefaultEncryptorWithMAC",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "204-209",
    "snippet": "DefaultEncryptorWithMAC::DefaultEncryptorWithMAC(const char *passphrase, BufferedTransformation *attachment)\n\t: ProxyFilter(NULL, 0, 0, attachment)\n\t, m_mac(NewDefaultEncryptorMAC((const byte *)passphrase, strlen(passphrase)))\n{\n\tSetFilter(new HashFilter(*m_mac, new DefaultEncryptor(passphrase), true));\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetFilter",
          "args": [
            "new HashFilter(*m_mac, new DefaultEncryptor(passphrase), true)"
          ],
          "line": 208
        },
        "resolved": true,
        "details": {
          "function_name": "ProxyFilter::SetFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "473-483",
          "snippet": "void ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "NewDefaultEncryptorMAC",
          "args": [
            "(const byte *)passphrase",
            "strlen(passphrase)"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "passphrase"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nDefaultEncryptorWithMAC::DefaultEncryptorWithMAC(const char *passphrase, BufferedTransformation *attachment)\n\t: ProxyFilter(NULL, 0, 0, attachment)\n\t, m_mac(NewDefaultEncryptorMAC((const byte *)passphrase, strlen(passphrase)))\n{\n\tSetFilter(new HashFilter(*m_mac, new DefaultEncryptor(passphrase), true));\n}"
  },
  {
    "function_name": "DefaultDecryptor::CheckKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "161-191",
    "snippet": "void DefaultDecryptor::CheckKey(const byte *salt, const byte *keyCheck)\n{\n\tSecByteBlock check(STDMAX((unsigned int)2*BLOCKSIZE, (unsigned int)DefaultHashModule::DIGESTSIZE));\n\n\tDefaultHashModule hash;\n\thash.Update(m_passphrase, m_passphrase.size());\n\thash.Update(salt, SALTLENGTH);\n\thash.Final(check);\n\n\tSecByteBlock key(KEYLENGTH);\n\tSecByteBlock IV(BLOCKSIZE);\n\tGenerateKeyIV(m_passphrase, m_passphrase.size(), salt, SALTLENGTH, key, IV);\n\n\tm_cipher.SetKeyWithIV(key, key.size(), IV);\n\tstd::auto_ptr<StreamTransformationFilter> decryptor(new StreamTransformationFilter(m_cipher));\n\n\tdecryptor->Put(keyCheck, BLOCKSIZE);\n\tdecryptor->ForceNextPut();\n\tdecryptor->Get(check+BLOCKSIZE, BLOCKSIZE);\n\n\tSetFilter(decryptor.release());\n\n\tif (!VerifyBufsEqual(check, check+BLOCKSIZE, BLOCKSIZE))\n\t{\n\t\tm_state = KEY_BAD;\n\t\tif (m_throwException)\n\t\t\tthrow KeyBadErr();\n\t}\n\telse\n\t\tm_state = KEY_GOOD;\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned int SALTLENGTH = 8;",
      "static const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;",
      "static const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "KeyBadErr",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "KeyBadErr",
          "container": "DefaultDecryptor::KeyBadErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.h",
          "lines": "45-45",
          "snippet": "KeyBadErr() : Err(\"DefaultDecryptor: cannot decrypt message with this passphrase\") {}",
          "includes": [
            "#include \"modes.h\"",
            "#include \"filters.h\"",
            "#include \"des.h\"",
            "#include \"hmac.h\"",
            "#include \"sha.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modes.h\"\n#include \"filters.h\"\n#include \"des.h\"\n#include \"hmac.h\"\n#include \"sha.h\"\n\nDefaultDecryptor {\n  KeyBadErr {\n    KeyBadErr() : Err(\"DefaultDecryptor: cannot decrypt message with this passphrase\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "VerifyBufsEqual",
          "args": [
            "check",
            "check+BLOCKSIZE",
            "BLOCKSIZE"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "VerifyBufsEqual",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.cpp",
          "lines": "79-113",
          "snippet": "bool VerifyBufsEqual(const byte *buf, const byte *mask, size_t count)\n{\n\tsize_t i;\n\tbyte acc8 = 0;\n\n\tif (IsAligned<word32>(buf) && IsAligned<word32>(mask))\n\t{\n\t\tword32 acc32 = 0;\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(buf) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tword64 acc64 = 0;\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\tacc64 |= ((word64*)buf)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn acc64 == 0;\n\t\t\tbuf += 8*i;\n\t\t\tmask += 8*i;\n\t\t\tacc32 = word32(acc64) | word32(acc64>>32);\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\tacc32 |= ((word32*)buf)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn acc32 == 0;\n\t\tbuf += 4*i;\n\t\tmask += 4*i;\n\t\tacc8 = byte(acc32) | byte(acc32>>8) | byte(acc32>>16) | byte(acc32>>24);\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\tacc8 |= buf[i] ^ mask[i];\n\treturn acc8 == 0;\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <new>",
            "#include \"words.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <new>\n#include \"words.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nbool VerifyBufsEqual(const byte *buf, const byte *mask, size_t count)\n{\n\tsize_t i;\n\tbyte acc8 = 0;\n\n\tif (IsAligned<word32>(buf) && IsAligned<word32>(mask))\n\t{\n\t\tword32 acc32 = 0;\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(buf) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tword64 acc64 = 0;\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\tacc64 |= ((word64*)buf)[i] ^ ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn acc64 == 0;\n\t\t\tbuf += 8*i;\n\t\t\tmask += 8*i;\n\t\t\tacc32 = word32(acc64) | word32(acc64>>32);\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\tacc32 |= ((word32*)buf)[i] ^ ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn acc32 == 0;\n\t\tbuf += 4*i;\n\t\tmask += 4*i;\n\t\tacc8 = byte(acc32) | byte(acc32>>8) | byte(acc32>>16) | byte(acc32>>24);\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\tacc8 |= buf[i] ^ mask[i];\n\treturn acc8 == 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetFilter",
          "args": [
            "decryptor.release()"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "ProxyFilter::SetFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "473-483",
          "snippet": "void ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "decryptor.release",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decryptor->Get",
          "args": [
            "check+BLOCKSIZE",
            "BLOCKSIZE"
          ],
          "line": 179
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "88-93",
          "snippet": "inline size_t Get(byte *outString, size_t getMax)\n\t{\n\t\tsize_t len = Peek(outString, getMax);\n\t\tm_head += len;\n\t\treturn len;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Get(byte *outString, size_t getMax)\n  \t{\n  \t\tsize_t len = Peek(outString, getMax);\n  \t\tm_head += len;\n  \t\treturn len;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "decryptor->ForceNextPut",
          "args": [],
          "line": 178
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "decryptor->Put",
          "args": [
            "keyCheck",
            "BLOCKSIZE"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "42-49",
          "snippet": "inline size_t Put(const byte *begin, size_t length)\n\t{\n\t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n\t\tif (buf+m_tail != begin)\n\t\t\tmemcpy(buf+m_tail, begin, l);\n\t\tm_tail += l;\n\t\treturn l;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Put(const byte *begin, size_t length)\n  \t{\n  \t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n  \t\tif (buf+m_tail != begin)\n  \t\t\tmemcpy(buf+m_tail, begin, l);\n  \t\tm_tail += l;\n  \t\treturn l;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_cipher.SetKeyWithIV",
          "args": [
            "key",
            "key.size()",
            "IV"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.size",
          "args": [],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GenerateKeyIV",
          "args": [
            "m_passphrase",
            "m_passphrase.size()",
            "salt",
            "SALTLENGTH",
            "key",
            "IV"
          ],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateKeyIV",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
          "lines": "59-68",
          "snippet": "static void GenerateKeyIV(const byte *passphrase, size_t passphraseLength, const byte *salt, size_t saltLength, byte *key, byte *IV)\n{\n\tSecByteBlock temp(passphraseLength+saltLength);\n\tmemcpy(temp, passphrase, passphraseLength);\n\tmemcpy(temp+passphraseLength, salt, saltLength);\n\tSecByteBlock keyIV(KEYLENGTH+BLOCKSIZE);\n\tMash(temp, passphraseLength + saltLength, keyIV, KEYLENGTH+BLOCKSIZE, MASH_ITERATIONS);\n\tmemcpy(key, keyIV, KEYLENGTH);\n\tmemcpy(IV, keyIV+KEYLENGTH, BLOCKSIZE);\n}",
          "includes": [
            "#include <memory>",
            "#include <time.h>",
            "#include \"queue.h\"",
            "#include \"default.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int MASH_ITERATIONS = 200;",
            "static const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;",
            "static const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic const unsigned int MASH_ITERATIONS = 200;\nstatic const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;\nstatic const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;\n\nstatic void GenerateKeyIV(const byte *passphrase, size_t passphraseLength, const byte *salt, size_t saltLength, byte *key, byte *IV)\n{\n\tSecByteBlock temp(passphraseLength+saltLength);\n\tmemcpy(temp, passphrase, passphraseLength);\n\tmemcpy(temp+passphraseLength, salt, saltLength);\n\tSecByteBlock keyIV(KEYLENGTH+BLOCKSIZE);\n\tMash(temp, passphraseLength + saltLength, keyIV, KEYLENGTH+BLOCKSIZE, MASH_ITERATIONS);\n\tmemcpy(key, keyIV, KEYLENGTH);\n\tmemcpy(IV, keyIV+KEYLENGTH, BLOCKSIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.Final",
          "args": [
            "check"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.Update",
          "args": [
            "salt",
            "SALTLENGTH"
          ],
          "line": 167
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "STDMAX",
          "args": [
            "(unsigned int)2*BLOCKSIZE",
            "(unsigned int)DefaultHashModule::DIGESTSIZE"
          ],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic const unsigned int SALTLENGTH = 8;\nstatic const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;\nstatic const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;\n\nvoid DefaultDecryptor::CheckKey(const byte *salt, const byte *keyCheck)\n{\n\tSecByteBlock check(STDMAX((unsigned int)2*BLOCKSIZE, (unsigned int)DefaultHashModule::DIGESTSIZE));\n\n\tDefaultHashModule hash;\n\thash.Update(m_passphrase, m_passphrase.size());\n\thash.Update(salt, SALTLENGTH);\n\thash.Final(check);\n\n\tSecByteBlock key(KEYLENGTH);\n\tSecByteBlock IV(BLOCKSIZE);\n\tGenerateKeyIV(m_passphrase, m_passphrase.size(), salt, SALTLENGTH, key, IV);\n\n\tm_cipher.SetKeyWithIV(key, key.size(), IV);\n\tstd::auto_ptr<StreamTransformationFilter> decryptor(new StreamTransformationFilter(m_cipher));\n\n\tdecryptor->Put(keyCheck, BLOCKSIZE);\n\tdecryptor->ForceNextPut();\n\tdecryptor->Get(check+BLOCKSIZE, BLOCKSIZE);\n\n\tSetFilter(decryptor.release());\n\n\tif (!VerifyBufsEqual(check, check+BLOCKSIZE, BLOCKSIZE))\n\t{\n\t\tm_state = KEY_BAD;\n\t\tif (m_throwException)\n\t\t\tthrow KeyBadErr();\n\t}\n\telse\n\t\tm_state = KEY_GOOD;\n}"
  },
  {
    "function_name": "DefaultDecryptor::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "146-159",
    "snippet": "void DefaultDecryptor::LastPut(const byte *inString, size_t length)\n{\n\tif (m_filter.get() == NULL)\n\t{\n\t\tm_state = KEY_BAD;\n\t\tif (m_throwException)\n\t\t\tthrow KeyBadErr();\n\t}\n\telse\n\t{\n\t\tm_filter->MessageEnd();\n\t\tm_state = WAITING_FOR_KEYCHECK;\n\t}\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->MessageEnd",
          "args": [],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "KeyBadErr",
          "args": [],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "KeyBadErr",
          "container": "DefaultDecryptor::KeyBadErr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.h",
          "lines": "45-45",
          "snippet": "KeyBadErr() : Err(\"DefaultDecryptor: cannot decrypt message with this passphrase\") {}",
          "includes": [
            "#include \"modes.h\"",
            "#include \"filters.h\"",
            "#include \"des.h\"",
            "#include \"hmac.h\"",
            "#include \"sha.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modes.h\"\n#include \"filters.h\"\n#include \"des.h\"\n#include \"hmac.h\"\n#include \"sha.h\"\n\nDefaultDecryptor {\n  KeyBadErr {\n    KeyBadErr() : Err(\"DefaultDecryptor: cannot decrypt message with this passphrase\") {}\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_filter.get",
          "args": [],
          "line": 148
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nvoid DefaultDecryptor::LastPut(const byte *inString, size_t length)\n{\n\tif (m_filter.get() == NULL)\n\t{\n\t\tm_state = KEY_BAD;\n\t\tif (m_throwException)\n\t\t\tthrow KeyBadErr();\n\t}\n\telse\n\t{\n\t\tm_filter->MessageEnd();\n\t\tm_state = WAITING_FOR_KEYCHECK;\n\t}\n}"
  },
  {
    "function_name": "DefaultDecryptor::FirstPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "141-144",
    "snippet": "void DefaultDecryptor::FirstPut(const byte *inString)\n{\n\tCheckKey(inString, inString+SALTLENGTH);\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned int SALTLENGTH = 8;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckKey",
          "args": [
            "inString",
            "inString+SALTLENGTH"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic const unsigned int SALTLENGTH = 8;\n\nvoid DefaultDecryptor::FirstPut(const byte *inString)\n{\n\tCheckKey(inString, inString+SALTLENGTH);\n}"
  },
  {
    "function_name": "DefaultDecryptor::DefaultDecryptor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "133-139",
    "snippet": "DefaultDecryptor::DefaultDecryptor(const byte *passphrase, size_t passphraseLength, BufferedTransformation *attachment, bool throwException)\n\t: ProxyFilter(NULL, SALTLENGTH+BLOCKSIZE, 0, attachment)\n\t, m_state(WAITING_FOR_KEYCHECK)\n\t, m_passphrase(passphrase, passphraseLength)\n\t, m_throwException(throwException)\n{\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned int SALTLENGTH = 8;",
      "static const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;"
    ],
    "called_functions": [],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic const unsigned int SALTLENGTH = 8;\nstatic const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;\n\nDefaultDecryptor::DefaultDecryptor(const byte *passphrase, size_t passphraseLength, BufferedTransformation *attachment, bool throwException)\n\t: ProxyFilter(NULL, SALTLENGTH+BLOCKSIZE, 0, attachment)\n\t, m_state(WAITING_FOR_KEYCHECK)\n\t, m_passphrase(passphrase, passphraseLength)\n\t, m_throwException(throwException)\n{\n}"
  },
  {
    "function_name": "DefaultDecryptor::DefaultDecryptor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "125-131",
    "snippet": "DefaultDecryptor::DefaultDecryptor(const char *p, BufferedTransformation *attachment, bool throwException)\n\t: ProxyFilter(NULL, SALTLENGTH+BLOCKSIZE, 0, attachment)\n\t, m_state(WAITING_FOR_KEYCHECK)\n\t, m_passphrase((const byte *)p, strlen(p))\n\t, m_throwException(throwException)\n{\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned int SALTLENGTH = 8;",
      "static const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "p"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic const unsigned int SALTLENGTH = 8;\nstatic const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;\n\nDefaultDecryptor::DefaultDecryptor(const char *p, BufferedTransformation *attachment, bool throwException)\n\t: ProxyFilter(NULL, SALTLENGTH+BLOCKSIZE, 0, attachment)\n\t, m_state(WAITING_FOR_KEYCHECK)\n\t, m_passphrase((const byte *)p, strlen(p))\n\t, m_throwException(throwException)\n{\n}"
  },
  {
    "function_name": "DefaultEncryptor::LastPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "118-121",
    "snippet": "void DefaultEncryptor::LastPut(const byte *inString, size_t length)\n{\n\tm_filter->MessageEnd();\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->MessageEnd",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nvoid DefaultEncryptor::LastPut(const byte *inString, size_t length)\n{\n\tm_filter->MessageEnd();\n}"
  },
  {
    "function_name": "DefaultEncryptor::FirstPut",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "83-116",
    "snippet": "void DefaultEncryptor::FirstPut(const byte *)\n{\n\t// VC60 workaround: __LINE__ expansion bug\n\tCRYPTOPP_COMPILE_ASSERT_INSTANCE(SALTLENGTH <= DefaultHashModule::DIGESTSIZE, 1);\n\tCRYPTOPP_COMPILE_ASSERT_INSTANCE(BLOCKSIZE <= DefaultHashModule::DIGESTSIZE, 2);\n\n\tSecByteBlock salt(DefaultHashModule::DIGESTSIZE), keyCheck(DefaultHashModule::DIGESTSIZE);\n\tDefaultHashModule hash;\n\n\t// use hash(passphrase | time | clock) as salt\n\thash.Update(m_passphrase, m_passphrase.size());\n\ttime_t t=time(0);\n\thash.Update((byte *)&t, sizeof(t));\n\tclock_t c=clock();\n\thash.Update((byte *)&c, sizeof(c));\n\thash.Final(salt);\n\n\t// use hash(passphrase | salt) as key check\n\thash.Update(m_passphrase, m_passphrase.size());\n\thash.Update(salt, SALTLENGTH);\n\thash.Final(keyCheck);\n\n\tAttachedTransformation()->Put(salt, SALTLENGTH);\n\n\t// mash passphrase and salt together into key and IV\n\tSecByteBlock key(KEYLENGTH);\n\tSecByteBlock IV(BLOCKSIZE);\n\tGenerateKeyIV(m_passphrase, m_passphrase.size(), salt, SALTLENGTH, key, IV);\n\n\tm_cipher.SetKeyWithIV(key, key.size(), IV);\n\tSetFilter(new StreamTransformationFilter(m_cipher));\n\n\tm_filter->Put(keyCheck, BLOCKSIZE);\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned int SALTLENGTH = 8;",
      "static const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;",
      "static const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_filter->Put",
          "args": [
            "keyCheck",
            "BLOCKSIZE"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": "ByteQueueNode",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "42-49",
          "snippet": "inline size_t Put(const byte *begin, size_t length)\n\t{\n\t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n\t\tif (buf+m_tail != begin)\n\t\t\tmemcpy(buf+m_tail, begin, l);\n\t\tm_tail += l;\n\t\treturn l;\n\t}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueueNode {\n  inline size_t Put(const byte *begin, size_t length)\n  \t{\n  \t\tsize_t l = STDMIN(length, MaxSize()-m_tail);\n  \t\tif (buf+m_tail != begin)\n  \t\t\tmemcpy(buf+m_tail, begin, l);\n  \t\tm_tail += l;\n  \t\treturn l;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "SetFilter",
          "args": [
            "new StreamTransformationFilter(m_cipher)"
          ],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "ProxyFilter::SetFilter",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/filters.cpp",
          "lines": "473-483",
          "snippet": "void ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}",
          "includes": [
            "#include <functional>",
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"mqueue.h\"",
            "#include \"filters.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <functional>\n#include <memory>\n#include \"argnames.h\"\n#include \"fltrimpl.h\"\n#include \"mqueue.h\"\n#include \"filters.h\"\n#include \"pch.h\"\n\nvoid ProxyFilter::SetFilter(Filter *filter)\n{\n\tm_filter.reset(filter);\n\tif (filter)\n\t{\n\t\tOutputProxy *proxy;\n\t\tstd::auto_ptr<OutputProxy> temp(proxy = new OutputProxy(*this, false));\n\t\tm_filter->TransferAllTo(*proxy);\n\t\tm_filter->Attach(temp.release());\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_cipher.SetKeyWithIV",
          "args": [
            "key",
            "key.size()",
            "IV"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.size",
          "args": [],
          "line": 112
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GenerateKeyIV",
          "args": [
            "m_passphrase",
            "m_passphrase.size()",
            "salt",
            "SALTLENGTH",
            "key",
            "IV"
          ],
          "line": 110
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateKeyIV",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
          "lines": "59-68",
          "snippet": "static void GenerateKeyIV(const byte *passphrase, size_t passphraseLength, const byte *salt, size_t saltLength, byte *key, byte *IV)\n{\n\tSecByteBlock temp(passphraseLength+saltLength);\n\tmemcpy(temp, passphrase, passphraseLength);\n\tmemcpy(temp+passphraseLength, salt, saltLength);\n\tSecByteBlock keyIV(KEYLENGTH+BLOCKSIZE);\n\tMash(temp, passphraseLength + saltLength, keyIV, KEYLENGTH+BLOCKSIZE, MASH_ITERATIONS);\n\tmemcpy(key, keyIV, KEYLENGTH);\n\tmemcpy(IV, keyIV+KEYLENGTH, BLOCKSIZE);\n}",
          "includes": [
            "#include <memory>",
            "#include <time.h>",
            "#include \"queue.h\"",
            "#include \"default.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const unsigned int MASH_ITERATIONS = 200;",
            "static const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;",
            "static const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic const unsigned int MASH_ITERATIONS = 200;\nstatic const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;\nstatic const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;\n\nstatic void GenerateKeyIV(const byte *passphrase, size_t passphraseLength, const byte *salt, size_t saltLength, byte *key, byte *IV)\n{\n\tSecByteBlock temp(passphraseLength+saltLength);\n\tmemcpy(temp, passphrase, passphraseLength);\n\tmemcpy(temp+passphraseLength, salt, saltLength);\n\tSecByteBlock keyIV(KEYLENGTH+BLOCKSIZE);\n\tMash(temp, passphraseLength + saltLength, keyIV, KEYLENGTH+BLOCKSIZE, MASH_ITERATIONS);\n\tmemcpy(key, keyIV, KEYLENGTH);\n\tmemcpy(IV, keyIV+KEYLENGTH, BLOCKSIZE);\n}"
        }
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [
            "salt",
            "SALTLENGTH"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AttachedTransformation",
          "args": [],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.Final",
          "args": [
            "keyCheck"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.Update",
          "args": [
            "salt",
            "SALTLENGTH"
          ],
          "line": 102
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.Final",
          "args": [
            "salt"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clock",
          "args": [],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "time",
          "args": [
            "0"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_COMPILE_ASSERT_INSTANCE",
          "args": [
            "BLOCKSIZE <= DefaultHashModule::DIGESTSIZE",
            "2"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_COMPILE_ASSERT_INSTANCE",
          "args": [
            "SALTLENGTH <= DefaultHashModule::DIGESTSIZE",
            "1"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic const unsigned int SALTLENGTH = 8;\nstatic const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;\nstatic const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;\n\nvoid DefaultEncryptor::FirstPut(const byte *)\n{\n\t// VC60 workaround: __LINE__ expansion bug\n\tCRYPTOPP_COMPILE_ASSERT_INSTANCE(SALTLENGTH <= DefaultHashModule::DIGESTSIZE, 1);\n\tCRYPTOPP_COMPILE_ASSERT_INSTANCE(BLOCKSIZE <= DefaultHashModule::DIGESTSIZE, 2);\n\n\tSecByteBlock salt(DefaultHashModule::DIGESTSIZE), keyCheck(DefaultHashModule::DIGESTSIZE);\n\tDefaultHashModule hash;\n\n\t// use hash(passphrase | time | clock) as salt\n\thash.Update(m_passphrase, m_passphrase.size());\n\ttime_t t=time(0);\n\thash.Update((byte *)&t, sizeof(t));\n\tclock_t c=clock();\n\thash.Update((byte *)&c, sizeof(c));\n\thash.Final(salt);\n\n\t// use hash(passphrase | salt) as key check\n\thash.Update(m_passphrase, m_passphrase.size());\n\thash.Update(salt, SALTLENGTH);\n\thash.Final(keyCheck);\n\n\tAttachedTransformation()->Put(salt, SALTLENGTH);\n\n\t// mash passphrase and salt together into key and IV\n\tSecByteBlock key(KEYLENGTH);\n\tSecByteBlock IV(BLOCKSIZE);\n\tGenerateKeyIV(m_passphrase, m_passphrase.size(), salt, SALTLENGTH, key, IV);\n\n\tm_cipher.SetKeyWithIV(key, key.size(), IV);\n\tSetFilter(new StreamTransformationFilter(m_cipher));\n\n\tm_filter->Put(keyCheck, BLOCKSIZE);\n}"
  },
  {
    "function_name": "DefaultEncryptor::DefaultEncryptor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "77-80",
    "snippet": "DefaultEncryptor::DefaultEncryptor(const byte *passphrase, size_t passphraseLength, BufferedTransformation *attachment)\n\t: ProxyFilter(NULL, 0, 0, attachment), m_passphrase(passphrase, passphraseLength)\n{\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nDefaultEncryptor::DefaultEncryptor(const byte *passphrase, size_t passphraseLength, BufferedTransformation *attachment)\n\t: ProxyFilter(NULL, 0, 0, attachment), m_passphrase(passphrase, passphraseLength)\n{\n}"
  },
  {
    "function_name": "DefaultEncryptor::DefaultEncryptor",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "72-75",
    "snippet": "DefaultEncryptor::DefaultEncryptor(const char *passphrase, BufferedTransformation *attachment)\n\t: ProxyFilter(NULL, 0, 0, attachment), m_passphrase((const byte *)passphrase, strlen(passphrase))\n{\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "passphrase"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nDefaultEncryptor::DefaultEncryptor(const char *passphrase, BufferedTransformation *attachment)\n\t: ProxyFilter(NULL, 0, 0, attachment), m_passphrase((const byte *)passphrase, strlen(passphrase))\n{\n}"
  },
  {
    "function_name": "GenerateKeyIV",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "59-68",
    "snippet": "static void GenerateKeyIV(const byte *passphrase, size_t passphraseLength, const byte *salt, size_t saltLength, byte *key, byte *IV)\n{\n\tSecByteBlock temp(passphraseLength+saltLength);\n\tmemcpy(temp, passphrase, passphraseLength);\n\tmemcpy(temp+passphraseLength, salt, saltLength);\n\tSecByteBlock keyIV(KEYLENGTH+BLOCKSIZE);\n\tMash(temp, passphraseLength + saltLength, keyIV, KEYLENGTH+BLOCKSIZE, MASH_ITERATIONS);\n\tmemcpy(key, keyIV, KEYLENGTH);\n\tmemcpy(IV, keyIV+KEYLENGTH, BLOCKSIZE);\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const unsigned int MASH_ITERATIONS = 200;",
      "static const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;",
      "static const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "IV",
            "keyIV+KEYLENGTH",
            "BLOCKSIZE"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "key",
            "keyIV",
            "KEYLENGTH"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Mash",
          "args": [
            "temp",
            "passphraseLength + saltLength",
            "keyIV",
            "KEYLENGTH+BLOCKSIZE",
            "MASH_ITERATIONS"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "temp+passphraseLength",
            "salt",
            "saltLength"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "temp",
            "passphrase",
            "passphraseLength"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic const unsigned int MASH_ITERATIONS = 200;\nstatic const unsigned int BLOCKSIZE = Default_BlockCipher::Encryption::BLOCKSIZE;\nstatic const unsigned int KEYLENGTH = Default_BlockCipher::Encryption::DEFAULT_KEYLENGTH;\n\nstatic void GenerateKeyIV(const byte *passphrase, size_t passphraseLength, const byte *salt, size_t saltLength, byte *key, byte *IV)\n{\n\tSecByteBlock temp(passphraseLength+saltLength);\n\tmemcpy(temp, passphrase, passphraseLength);\n\tmemcpy(temp+passphraseLength, salt, saltLength);\n\tSecByteBlock keyIV(KEYLENGTH+BLOCKSIZE);\n\tMash(temp, passphraseLength + saltLength, keyIV, KEYLENGTH+BLOCKSIZE, MASH_ITERATIONS);\n\tmemcpy(key, keyIV, KEYLENGTH);\n\tmemcpy(IV, keyIV+KEYLENGTH, BLOCKSIZE);\n}"
  },
  {
    "function_name": "Mash",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/default.cpp",
    "lines": "22-57",
    "snippet": "static void Mash(const byte *in, size_t inLen, byte *out, size_t outLen, int iterations)\n{\n\tif (BytePrecision(outLen) > 2)\n\t\tthrow InvalidArgument(\"Mash: output legnth too large\");\n\n\tsize_t bufSize = RoundUpToMultipleOf(outLen, (size_t)DefaultHashModule::DIGESTSIZE);\n\tbyte b[2];\n\tSecByteBlock buf(bufSize);\n\tSecByteBlock outBuf(bufSize);\n\tDefaultHashModule hash;\n\n\tunsigned int i;\n\tfor(i=0; i<outLen; i+=DefaultHashModule::DIGESTSIZE)\n\t{\n\t\tb[0] = (byte) (i >> 8);\n\t\tb[1] = (byte) i;\n\t\thash.Update(b, 2);\n\t\thash.Update(in, inLen);\n\t\thash.Final(outBuf+i);\n\t}\n\n\twhile (iterations-- > 1)\n\t{\n\t\tmemcpy(buf, outBuf, bufSize);\n\t\tfor (i=0; i<bufSize; i+=DefaultHashModule::DIGESTSIZE)\n\t\t{\n\t\t\tb[0] = (byte) (i >> 8);\n\t\t\tb[1] = (byte) i;\n\t\t\thash.Update(b, 2);\n\t\t\thash.Update(buf, bufSize);\n\t\t\thash.Final(outBuf+i);\n\t\t}\n\t}\n\n\tmemcpy(out, outBuf, outLen);\n}",
    "includes": [
      "#include <memory>",
      "#include <time.h>",
      "#include \"queue.h\"",
      "#include \"default.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "out",
            "outBuf",
            "outLen"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.Final",
          "args": [
            "outBuf+i"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.Update",
          "args": [
            "buf",
            "bufSize"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "61-66",
          "snippet": "void Update(const byte *input, size_t length)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.Update(input, length);\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void Update(const byte *input, size_t length)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.Update(input, length);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "i >> 8"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "buf",
            "outBuf",
            "bufSize"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.Final",
          "args": [
            "outBuf+i"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "",
          "args": [
            "i >> 8"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RoundUpToMultipleOf",
          "args": [
            "outLen",
            "(size_t)DefaultHashModule::DIGESTSIZE"
          ],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "RoundUpToMultipleOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "355-360",
          "snippet": "inline T1 RoundUpToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (n+m-1 < n)\n\t\tthrow InvalidArgument(\"RoundUpToMultipleOf: integer overflow\");\n\treturn RoundDownToMultipleOf(n+m-1, m);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 RoundUpToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (n+m-1 < n)\n\t\tthrow InvalidArgument(\"RoundUpToMultipleOf: integer overflow\");\n\treturn RoundDownToMultipleOf(n+m-1, m);\n}"
        }
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"Mash: output legnth too large\""
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BytePrecision",
          "args": [
            "outLen"
          ],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "BytePrecision",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "218-235",
          "snippet": "unsigned int BytePrecision(const T &value)\n{\n\tif (!value)\n\t\treturn 0;\n\n\tunsigned int l=0, h=8*sizeof(value);\n\n\twhile (h-l > 8)\n\t{\n\t\tunsigned int t = (l+h)/2;\n\t\tif (value >> t)\n\t\t\tl = t;\n\t\telse\n\t\t\th = t;\n\t}\n\n\treturn h/8;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nunsigned int BytePrecision(const T &value)\n{\n\tif (!value)\n\t\treturn 0;\n\n\tunsigned int l=0, h=8*sizeof(value);\n\n\twhile (h-l > 8)\n\t{\n\t\tunsigned int t = (l+h)/2;\n\t\tif (value >> t)\n\t\t\tl = t;\n\t\telse\n\t\t\th = t;\n\t}\n\n\treturn h/8;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <memory>\n#include <time.h>\n#include \"queue.h\"\n#include \"default.h\"\n#include \"pch.h\"\n\nstatic void Mash(const byte *in, size_t inLen, byte *out, size_t outLen, int iterations)\n{\n\tif (BytePrecision(outLen) > 2)\n\t\tthrow InvalidArgument(\"Mash: output legnth too large\");\n\n\tsize_t bufSize = RoundUpToMultipleOf(outLen, (size_t)DefaultHashModule::DIGESTSIZE);\n\tbyte b[2];\n\tSecByteBlock buf(bufSize);\n\tSecByteBlock outBuf(bufSize);\n\tDefaultHashModule hash;\n\n\tunsigned int i;\n\tfor(i=0; i<outLen; i+=DefaultHashModule::DIGESTSIZE)\n\t{\n\t\tb[0] = (byte) (i >> 8);\n\t\tb[1] = (byte) i;\n\t\thash.Update(b, 2);\n\t\thash.Update(in, inLen);\n\t\thash.Final(outBuf+i);\n\t}\n\n\twhile (iterations-- > 1)\n\t{\n\t\tmemcpy(buf, outBuf, bufSize);\n\t\tfor (i=0; i<bufSize; i+=DefaultHashModule::DIGESTSIZE)\n\t\t{\n\t\t\tb[0] = (byte) (i >> 8);\n\t\t\tb[1] = (byte) i;\n\t\t\thash.Update(b, 2);\n\t\t\thash.Update(buf, bufSize);\n\t\t\thash.Final(outBuf+i);\n\t\t}\n\t}\n\n\tmemcpy(out, outBuf, outLen);\n}"
  }
]