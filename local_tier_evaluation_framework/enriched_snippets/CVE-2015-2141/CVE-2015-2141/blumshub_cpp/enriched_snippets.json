[
  {
    "function_name": "Seek",
    "container": "BlumBlumShub",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "54-61",
    "snippet": "void BlumBlumShub::Seek(lword index)\n{\n\tInteger i(Integer::POSITIVE, index);\n\ti *= 8;\n\tInteger e = a_exp_b_mod_c (2, i / maxBits + 1, (p-1)*(q-1));\n\tcurrent = modn.Exponentiate(x0, e);\n\tbitsLeft = maxBits - i % maxBits;\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "modn.Exponentiate",
          "args": [
            "x0",
            "e"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "Exponentiate",
          "container": "AbstractRing<T>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algebra.cpp",
          "lines": "315-320",
          "snippet": "T AbstractRing<T>::Exponentiate(const Element &base, const Integer &exponent) const\n{\n\tElement result;\n\tSimultaneousExponentiate(&result, base, &exponent, 1);\n\treturn result;\n}",
          "includes": [
            "#include <vector>",
            "#include \"integer.h\"",
            "#include \"algebra.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"integer.h\"\n#include \"algebra.h\"\n#include \"pch.h\"\n\nAbstractRing<T> {\n  T AbstractRing<T>::Exponentiate(const Element &base, const Integer &exponent) const\n  {\n  \tElement result;\n  \tSimultaneousExponentiate(&result, base, &exponent, 1);\n  \treturn result;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "a_exp_b_mod_c",
          "args": [
            "2",
            "i / maxBits + 1",
            "(p-1)*(q-1)"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "a_exp_b_mod_c",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3947-3951",
          "snippet": "Integer a_exp_b_mod_c(const Integer &x, const Integer& e, const Integer& m)\n{\n\tModularArithmetic mr(m);\n\treturn mr.Exponentiate(x, e);\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger a_exp_b_mod_c(const Integer &x, const Integer& e, const Integer& m)\n{\n\tModularArithmetic mr(m);\n\treturn mr.Exponentiate(x, e);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nBlumBlumShub {\n  void BlumBlumShub::Seek(lword index)\n  {\n  \tInteger i(Integer::POSITIVE, index);\n  \ti *= 8;\n  \tInteger e = a_exp_b_mod_c (2, i / maxBits + 1, (p-1)*(q-1));\n  \tcurrent = modn.Exponentiate(x0, e);\n  \tbitsLeft = maxBits - i % maxBits;\n  }\n}"
  },
  {
    "function_name": "BlumBlumShub",
    "container": "BlumBlumShub",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "47-52",
    "snippet": "BlumBlumShub::BlumBlumShub(const Integer &p, const Integer &q, const Integer &seed)\n\t: PublicBlumBlumShub(p*q, seed),\n\t  p(p), q(q),\n\t  x0(modn.Square(seed))\n{\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "modn.Square",
          "args": [
            "seed"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "Square",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "49-50",
          "snippet": "Element Square(Element a) const\n\t\t{return Multiply(a, a);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Square(Element a) const\n  \t\t{return Multiply(a, a);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nBlumBlumShub {\n  BlumBlumShub::BlumBlumShub(const Integer &p, const Integer &q, const Integer &seed)\n  \t: PublicBlumBlumShub(p*q, seed),\n  \t  p(p), q(q),\n  \t  x0(modn.Square(seed))\n  {\n  }\n}"
  },
  {
    "function_name": "ProcessData",
    "container": "PublicBlumBlumShub",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "41-45",
    "snippet": "void PublicBlumBlumShub::ProcessData(byte *outString, const byte *inString, size_t length)\n{\n\twhile (length--)\n\t\t*outString++ = *inString++ ^ PublicBlumBlumShub::GenerateByte();\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PublicBlumBlumShub::GenerateByte",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateByte",
          "container": "PublicBlumBlumShub",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
          "lines": "27-33",
          "snippet": "byte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}",
          "includes": [
            "#include \"blumshub.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub {\n  byte PublicBlumBlumShub::GenerateByte()\n  {\n  \tbyte b=0;\n  \tfor (int i=0; i<8; i++)\n  \t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n  \treturn b;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub {\n  void PublicBlumBlumShub::ProcessData(byte *outString, const byte *inString, size_t length)\n  {\n  \twhile (length--)\n  \t\t*outString++ = *inString++ ^ PublicBlumBlumShub::GenerateByte();\n  }\n}"
  },
  {
    "function_name": "GenerateBlock",
    "container": "PublicBlumBlumShub",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "35-39",
    "snippet": "void PublicBlumBlumShub::GenerateBlock(byte *output, size_t size)\n{\n\twhile (size--)\n\t\t*output++ = PublicBlumBlumShub::GenerateByte();\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PublicBlumBlumShub::GenerateByte",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateByte",
          "container": "PublicBlumBlumShub",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
          "lines": "27-33",
          "snippet": "byte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}",
          "includes": [
            "#include \"blumshub.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub {\n  byte PublicBlumBlumShub::GenerateByte()\n  {\n  \tbyte b=0;\n  \tfor (int i=0; i<8; i++)\n  \t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n  \treturn b;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub {\n  void PublicBlumBlumShub::GenerateBlock(byte *output, size_t size)\n  {\n  \twhile (size--)\n  \t\t*output++ = PublicBlumBlumShub::GenerateByte();\n  }\n}"
  },
  {
    "function_name": "GenerateByte",
    "container": "PublicBlumBlumShub",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "27-33",
    "snippet": "byte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PublicBlumBlumShub::GenerateBit",
          "args": [],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateBit",
          "container": "PublicBlumBlumShub",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
          "lines": "16-25",
          "snippet": "unsigned int PublicBlumBlumShub::GenerateBit()\n{\n\tif (bitsLeft==0)\n\t{\n\t\tcurrent = modn.Square(current);\n\t\tbitsLeft = maxBits;\n\t}\n\n\treturn current.GetBit(--bitsLeft);\n}",
          "includes": [
            "#include \"blumshub.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub {\n  unsigned int PublicBlumBlumShub::GenerateBit()\n  {\n  \tif (bitsLeft==0)\n  \t{\n  \t\tcurrent = modn.Square(current);\n  \t\tbitsLeft = maxBits;\n  \t}\n  \n  \treturn current.GetBit(--bitsLeft);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub {\n  byte PublicBlumBlumShub::GenerateByte()\n  {\n  \tbyte b=0;\n  \tfor (int i=0; i<8; i++)\n  \t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n  \treturn b;\n  }\n}"
  },
  {
    "function_name": "GenerateBit",
    "container": "PublicBlumBlumShub",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "16-25",
    "snippet": "unsigned int PublicBlumBlumShub::GenerateBit()\n{\n\tif (bitsLeft==0)\n\t{\n\t\tcurrent = modn.Square(current);\n\t\tbitsLeft = maxBits;\n\t}\n\n\treturn current.GetBit(--bitsLeft);\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current.GetBit",
          "args": [
            "--bitsLeft"
          ],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "GetBit",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "2894-2900",
          "snippet": "bool Integer::GetBit(size_t n) const\n{\n\tif (n/WORD_BITS >= reg.size())\n\t\treturn 0;\n\telse\n\t\treturn bool((reg[n/WORD_BITS] >> (n % WORD_BITS)) & 1);\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  bool Integer::GetBit(size_t n) const\n  {\n  \tif (n/WORD_BITS >= reg.size())\n  \t\treturn 0;\n  \telse\n  \t\treturn bool((reg[n/WORD_BITS] >> (n % WORD_BITS)) & 1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "modn.Square",
          "args": [
            "current"
          ],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "Square",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "49-50",
          "snippet": "Element Square(Element a) const\n\t\t{return Multiply(a, a);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Square(Element a) const\n  \t\t{return Multiply(a, a);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub {\n  unsigned int PublicBlumBlumShub::GenerateBit()\n  {\n  \tif (bitsLeft==0)\n  \t{\n  \t\tcurrent = modn.Square(current);\n  \t\tbitsLeft = maxBits;\n  \t}\n  \n  \treturn current.GetBit(--bitsLeft);\n  }\n}"
  },
  {
    "function_name": "PublicBlumBlumShub",
    "container": "PublicBlumBlumShub",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "8-14",
    "snippet": "PublicBlumBlumShub::PublicBlumBlumShub(const Integer &n, const Integer &seed)\n\t: modn(n),\n\t  maxBits(BitPrecision(n.BitCount())-1)\n{\n\tcurrent = modn.Square(modn.Square(seed));\n\tbitsLeft = maxBits;\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "modn.Square",
          "args": [
            "modn.Square(seed)"
          ],
          "line": 12
        },
        "resolved": true,
        "details": {
          "function_name": "Square",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "49-50",
          "snippet": "Element Square(Element a) const\n\t\t{return Multiply(a, a);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Square(Element a) const\n  \t\t{return Multiply(a, a);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitPrecision",
          "args": [
            "n.BitCount()"
          ],
          "line": 10
        },
        "resolved": true,
        "details": {
          "function_name": "BitPrecision",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "238-255",
          "snippet": "unsigned int BitPrecision(const T &value)\n{\n\tif (!value)\n\t\treturn 0;\n\n\tunsigned int l=0, h=8*sizeof(value);\n\n\twhile (h-l > 1)\n\t{\n\t\tunsigned int t = (l+h)/2;\n\t\tif (value >> t)\n\t\t\tl = t;\n\t\telse\n\t\t\th = t;\n\t}\n\n\treturn h;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nunsigned int BitPrecision(const T &value)\n{\n\tif (!value)\n\t\treturn 0;\n\n\tunsigned int l=0, h=8*sizeof(value);\n\n\twhile (h-l > 1)\n\t{\n\t\tunsigned int t = (l+h)/2;\n\t\tif (value >> t)\n\t\t\tl = t;\n\t\telse\n\t\t\th = t;\n\t}\n\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "n.BitCount",
          "args": [],
          "line": 10
        },
        "resolved": true,
        "details": {
          "function_name": "BitCount",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3054-3061",
          "snippet": "unsigned int Integer::BitCount() const\n{\n\tunsigned wordCount = WordCount();\n\tif (wordCount)\n\t\treturn (wordCount-1)*WORD_BITS + BitPrecision(reg[wordCount-1]);\n\telse\n\t\treturn 0;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  unsigned int Integer::BitCount() const\n  {\n  \tunsigned wordCount = WordCount();\n  \tif (wordCount)\n  \t\treturn (wordCount-1)*WORD_BITS + BitPrecision(reg[wordCount-1]);\n  \telse\n  \t\treturn 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub {\n  PublicBlumBlumShub::PublicBlumBlumShub(const Integer &n, const Integer &seed)\n  \t: modn(n),\n  \t  maxBits(BitPrecision(n.BitCount())-1)\n  {\n  \tcurrent = modn.Square(modn.Square(seed));\n  \tbitsLeft = maxBits;\n  }\n}"
  }
]