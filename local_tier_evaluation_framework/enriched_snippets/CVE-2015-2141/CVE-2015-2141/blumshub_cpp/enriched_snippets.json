[
  {
    "function_name": "BlumBlumShub::Seek",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "54-61",
    "snippet": "void BlumBlumShub::Seek(lword index)\n{\n\tInteger i(Integer::POSITIVE, index);\n\ti *= 8;\n\tInteger e = a_exp_b_mod_c (2, i / maxBits + 1, (p-1)*(q-1));\n\tcurrent = modn.Exponentiate(x0, e);\n\tbitsLeft = maxBits - i % maxBits;\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "modn.Exponentiate",
          "args": [
            "x0",
            "e"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "Exponentiate",
          "container": "GFP2_ONB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "158-164",
          "snippet": "Element Exponentiate(const Element &a, const Integer &e) const\n\t{\n\t\tInteger edivp, emodp;\n\t\tInteger::Divide(emodp, edivp, e, modp.GetModulus());\n\t\tElement b = PthPower(a);\n\t\treturn AbstractRing<GFP2Element>::CascadeExponentiate(a, emodp, b, edivp);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2_ONB {\n  Element Exponentiate(const Element &a, const Integer &e) const\n  \t{\n  \t\tInteger edivp, emodp;\n  \t\tInteger::Divide(emodp, edivp, e, modp.GetModulus());\n  \t\tElement b = PthPower(a);\n  \t\treturn AbstractRing<GFP2Element>::CascadeExponentiate(a, emodp, b, edivp);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "a_exp_b_mod_c",
          "args": [
            "2",
            "i / maxBits + 1",
            "(p-1)*(q-1)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nvoid BlumBlumShub::Seek(lword index)\n{\n\tInteger i(Integer::POSITIVE, index);\n\ti *= 8;\n\tInteger e = a_exp_b_mod_c (2, i / maxBits + 1, (p-1)*(q-1));\n\tcurrent = modn.Exponentiate(x0, e);\n\tbitsLeft = maxBits - i % maxBits;\n}"
  },
  {
    "function_name": "BlumBlumShub::BlumBlumShub",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "47-52",
    "snippet": "BlumBlumShub::BlumBlumShub(const Integer &p, const Integer &q, const Integer &seed)\n\t: PublicBlumBlumShub(p*q, seed),\n\t  p(p), q(q),\n\t  x0(modn.Square(seed))\n{\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "modn.Square",
          "args": [
            "seed"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "Square",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "49-50",
          "snippet": "Element Square(Element a) const\n\t\t{return Multiply(a, a);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Square(Element a) const\n  \t\t{return Multiply(a, a);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nBlumBlumShub::BlumBlumShub(const Integer &p, const Integer &q, const Integer &seed)\n\t: PublicBlumBlumShub(p*q, seed),\n\t  p(p), q(q),\n\t  x0(modn.Square(seed))\n{\n}"
  },
  {
    "function_name": "PublicBlumBlumShub::ProcessData",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "41-45",
    "snippet": "void PublicBlumBlumShub::ProcessData(byte *outString, const byte *inString, size_t length)\n{\n\twhile (length--)\n\t\t*outString++ = *inString++ ^ PublicBlumBlumShub::GenerateByte();\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PublicBlumBlumShub::GenerateByte",
          "args": [],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "PublicBlumBlumShub::GenerateByte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
          "lines": "27-33",
          "snippet": "byte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}",
          "includes": [
            "#include \"blumshub.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nbyte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nvoid PublicBlumBlumShub::ProcessData(byte *outString, const byte *inString, size_t length)\n{\n\twhile (length--)\n\t\t*outString++ = *inString++ ^ PublicBlumBlumShub::GenerateByte();\n}"
  },
  {
    "function_name": "PublicBlumBlumShub::GenerateBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "35-39",
    "snippet": "void PublicBlumBlumShub::GenerateBlock(byte *output, size_t size)\n{\n\twhile (size--)\n\t\t*output++ = PublicBlumBlumShub::GenerateByte();\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PublicBlumBlumShub::GenerateByte",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "PublicBlumBlumShub::GenerateByte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
          "lines": "27-33",
          "snippet": "byte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}",
          "includes": [
            "#include \"blumshub.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nbyte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nvoid PublicBlumBlumShub::GenerateBlock(byte *output, size_t size)\n{\n\twhile (size--)\n\t\t*output++ = PublicBlumBlumShub::GenerateByte();\n}"
  },
  {
    "function_name": "PublicBlumBlumShub::GenerateByte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "27-33",
    "snippet": "byte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PublicBlumBlumShub::GenerateBit",
          "args": [],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "PublicBlumBlumShub::GenerateBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
          "lines": "16-25",
          "snippet": "unsigned int PublicBlumBlumShub::GenerateBit()\n{\n\tif (bitsLeft==0)\n\t{\n\t\tcurrent = modn.Square(current);\n\t\tbitsLeft = maxBits;\n\t}\n\n\treturn current.GetBit(--bitsLeft);\n}",
          "includes": [
            "#include \"blumshub.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nunsigned int PublicBlumBlumShub::GenerateBit()\n{\n\tif (bitsLeft==0)\n\t{\n\t\tcurrent = modn.Square(current);\n\t\tbitsLeft = maxBits;\n\t}\n\n\treturn current.GetBit(--bitsLeft);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nbyte PublicBlumBlumShub::GenerateByte()\n{\n\tbyte b=0;\n\tfor (int i=0; i<8; i++)\n\t\tb = (b << 1) | PublicBlumBlumShub::GenerateBit();\n\treturn b;\n}"
  },
  {
    "function_name": "PublicBlumBlumShub::GenerateBit",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "16-25",
    "snippet": "unsigned int PublicBlumBlumShub::GenerateBit()\n{\n\tif (bitsLeft==0)\n\t{\n\t\tcurrent = modn.Square(current);\n\t\tbitsLeft = maxBits;\n\t}\n\n\treturn current.GetBit(--bitsLeft);\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "current.GetBit",
          "args": [
            "--bitsLeft"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "modn.Square",
          "args": [
            "current"
          ],
          "line": 20
        },
        "resolved": true,
        "details": {
          "function_name": "Square",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "49-50",
          "snippet": "Element Square(Element a) const\n\t\t{return Multiply(a, a);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Square(Element a) const\n  \t\t{return Multiply(a, a);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nunsigned int PublicBlumBlumShub::GenerateBit()\n{\n\tif (bitsLeft==0)\n\t{\n\t\tcurrent = modn.Square(current);\n\t\tbitsLeft = maxBits;\n\t}\n\n\treturn current.GetBit(--bitsLeft);\n}"
  },
  {
    "function_name": "PublicBlumBlumShub::PublicBlumBlumShub",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blumshub.cpp",
    "lines": "8-14",
    "snippet": "PublicBlumBlumShub::PublicBlumBlumShub(const Integer &n, const Integer &seed)\n\t: modn(n),\n\t  maxBits(BitPrecision(n.BitCount())-1)\n{\n\tcurrent = modn.Square(modn.Square(seed));\n\tbitsLeft = maxBits;\n}",
    "includes": [
      "#include \"blumshub.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "modn.Square",
          "args": [
            "modn.Square(seed)"
          ],
          "line": 12
        },
        "resolved": true,
        "details": {
          "function_name": "Square",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "49-50",
          "snippet": "Element Square(Element a) const\n\t\t{return Multiply(a, a);}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Square(Element a) const\n  \t\t{return Multiply(a, a);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitPrecision",
          "args": [
            "n.BitCount()"
          ],
          "line": 10
        },
        "resolved": true,
        "details": {
          "function_name": "BitPrecision",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "238-255",
          "snippet": "unsigned int BitPrecision(const T &value)\n{\n\tif (!value)\n\t\treturn 0;\n\n\tunsigned int l=0, h=8*sizeof(value);\n\n\twhile (h-l > 1)\n\t{\n\t\tunsigned int t = (l+h)/2;\n\t\tif (value >> t)\n\t\t\tl = t;\n\t\telse\n\t\t\th = t;\n\t}\n\n\treturn h;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nunsigned int BitPrecision(const T &value)\n{\n\tif (!value)\n\t\treturn 0;\n\n\tunsigned int l=0, h=8*sizeof(value);\n\n\twhile (h-l > 1)\n\t{\n\t\tunsigned int t = (l+h)/2;\n\t\tif (value >> t)\n\t\t\tl = t;\n\t\telse\n\t\t\th = t;\n\t}\n\n\treturn h;\n}"
        }
      },
      {
        "call_info": {
          "callee": "n.BitCount",
          "args": [],
          "line": 10
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"blumshub.h\"\n#include \"pch.h\"\n\nPublicBlumBlumShub::PublicBlumBlumShub(const Integer &n, const Integer &seed)\n\t: modn(n),\n\t  maxBits(BitPrecision(n.BitCount())-1)\n{\n\tcurrent = modn.Square(modn.Square(seed));\n\tbitsLeft = maxBits;\n}"
  }
]