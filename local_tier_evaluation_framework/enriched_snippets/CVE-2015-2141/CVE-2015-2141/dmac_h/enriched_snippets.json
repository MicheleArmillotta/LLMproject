[
  {
    "function_name": "TruncatedFinal",
    "container": "DMAC_Base<T>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
    "lines": "66-78",
    "snippet": "void DMAC_Base<T>::TruncatedFinal(byte *mac, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tbyte pad[T::BLOCKSIZE];\n\tbyte padByte = byte(T::BLOCKSIZE-m_counter);\n\tmemset(pad, padByte, padByte);\n\tm_mac1.Update(pad, padByte);\n\tm_mac1.TruncatedFinal(mac, size);\n\tm_f2.ProcessBlock(mac);\n\n\tm_counter = 0;\t// reset for next message\n}",
    "includes": [
      "#include \"cbcmac.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_f2.ProcessBlock",
          "args": [
            "mac"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_mac1.TruncatedFinal",
          "args": [
            "mac",
            "size"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedFinal",
          "container": "DMAC_Base<T>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
          "lines": "66-78",
          "snippet": "void DMAC_Base<T>::TruncatedFinal(byte *mac, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tbyte pad[T::BLOCKSIZE];\n\tbyte padByte = byte(T::BLOCKSIZE-m_counter);\n\tmemset(pad, padByte, padByte);\n\tm_mac1.Update(pad, padByte);\n\tm_mac1.TruncatedFinal(mac, size);\n\tm_f2.ProcessBlock(mac);\n\n\tm_counter = 0;\t// reset for next message\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "m_mac1.Update",
          "args": [
            "pad",
            "padByte"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "DMAC_Base<T>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
          "lines": "59-63",
          "snippet": "void DMAC_Base<T>::Update(const byte *input, size_t length)\n{\n\tm_mac1.Update(input, length);\n\tm_counter = (unsigned int)((m_counter + length) % T::BLOCKSIZE);\n}",
          "includes": [
            "#include \"cbcmac.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cbcmac.h\"\n\nDMAC_Base<T> {\n  void DMAC_Base<T>::Update(const byte *input, size_t length)\n  {\n  \tm_mac1.Update(input, length);\n  \tm_counter = (unsigned int)((m_counter + length) % T::BLOCKSIZE);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pad",
            "padByte",
            "padByte"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "byte",
          "args": [
            "T::BLOCKSIZE-m_counter"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ThrowIfInvalidTruncatedSize",
          "args": [
            "size"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "ThrowIfInvalidTruncatedSize",
          "container": "HashTransformation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "309-313",
          "snippet": "void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nHashTransformation {\n  void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n  {\n  \tif (size > DigestSize())\n  \t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cbcmac.h\"\n\nDMAC_Base<T> {\n  void DMAC_Base<T>::TruncatedFinal(byte *mac, size_t size)\n  {\n  \tThrowIfInvalidTruncatedSize(size);\n  \n  \tbyte pad[T::BLOCKSIZE];\n  \tbyte padByte = byte(T::BLOCKSIZE-m_counter);\n  \tmemset(pad, padByte, padByte);\n  \tm_mac1.Update(pad, padByte);\n  \tm_mac1.TruncatedFinal(mac, size);\n  \tm_f2.ProcessBlock(mac);\n  \n  \tm_counter = 0;\t// reset for next message\n  }\n}"
  },
  {
    "function_name": "Update",
    "container": "DMAC_Base<T>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
    "lines": "59-63",
    "snippet": "void DMAC_Base<T>::Update(const byte *input, size_t length)\n{\n\tm_mac1.Update(input, length);\n\tm_counter = (unsigned int)((m_counter + length) % T::BLOCKSIZE);\n}",
    "includes": [
      "#include \"cbcmac.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_mac1.Update",
          "args": [
            "input",
            "length"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "Update",
          "container": "DMAC_Base<T>",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
          "lines": "59-63",
          "snippet": "void DMAC_Base<T>::Update(const byte *input, size_t length)\n{\n\tm_mac1.Update(input, length);\n\tm_counter = (unsigned int)((m_counter + length) % T::BLOCKSIZE);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"cbcmac.h\"\n\nDMAC_Base<T> {\n  void DMAC_Base<T>::Update(const byte *input, size_t length)\n  {\n  \tm_mac1.Update(input, length);\n  \tm_counter = (unsigned int)((m_counter + length) % T::BLOCKSIZE);\n  }\n}"
  },
  {
    "function_name": "UncheckedSetKey",
    "container": "DMAC_Base<T>",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
    "lines": "48-56",
    "snippet": "void DMAC_Base<T>::UncheckedSetKey(const byte *key, unsigned int length, const NameValuePairs &params)\n{\n\tm_subkeylength = T::StaticGetValidKeyLength(T::BLOCKSIZE);\n\tm_subkeys.resize(2*UnsignedMin((unsigned int)T::BLOCKSIZE, m_subkeylength));\n\tm_mac1.SetKey(GenerateSubKeys(key, length), m_subkeylength, params);\n\tm_f2.SetKey(m_subkeys+m_subkeys.size()/2, m_subkeylength, params);\n\tm_counter = 0;\n\tm_subkeys.resize(0);\n}",
    "includes": [
      "#include \"cbcmac.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_subkeys.resize",
          "args": [
            "0"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "203-211",
          "snippet": "void resize(size_t newSize)\n\t{\n\t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n\t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n\t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n\t\tdelete [] this->m_ptr;\n\t\tthis->m_size = newSize;\n\t\tthis->m_ptr = newPtr;\n\t}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  void resize(size_t newSize)\n  \t{\n  \t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n  \t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n  \t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n  \t\tdelete [] this->m_ptr;\n  \t\tthis->m_size = newSize;\n  \t\tthis->m_ptr = newPtr;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_f2.SetKey",
          "args": [
            "m_subkeys+m_subkeys.size()/2",
            "m_subkeylength",
            "params"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "SetKey",
          "container": "AuthenticatedSymmetricCipherBase",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/authenc.cpp",
          "lines": "48-60",
          "snippet": "void AuthenticatedSymmetricCipherBase::SetKey(const byte *userKey, size_t keylength, const NameValuePairs &params)\r\n{\r\n\tm_bufferedDataLength = 0;\r\n\tm_state = State_Start;\r\n\r\n\tSetKeyWithoutResync(userKey, keylength, params);\r\n\tm_state = State_KeySet;\r\n\r\n\tsize_t length;\r\n\tconst byte *iv = GetIVAndThrowIfInvalid(params, length);\r\n\tif (iv)\r\n\t\tResynchronize(iv, (int)length);\r\n}",
          "includes": [
            "#include \"authenc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"authenc.h\"\n#include \"pch.h\"\n\nAuthenticatedSymmetricCipherBase {\n  void AuthenticatedSymmetricCipherBase::SetKey(const byte *userKey, size_t keylength, const NameValuePairs &params)\r\n  {\r\n  \tm_bufferedDataLength = 0;\r\n  \tm_state = State_Start;\r\n  \r\n  \tSetKeyWithoutResync(userKey, keylength, params);\r\n  \tm_state = State_KeySet;\r\n  \r\n  \tsize_t length;\r\n  \tconst byte *iv = GetIVAndThrowIfInvalid(params, length);\r\n  \tif (iv)\r\n  \t\tResynchronize(iv, (int)length);\r\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_subkeys.size",
          "args": [],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GenerateSubKeys",
          "args": [
            "key",
            "length"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "UnsignedMin",
          "args": [
            "(unsigned int)T::BLOCKSIZE",
            "m_subkeylength"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "UnsignedMin",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "182-192",
          "snippet": "inline const T1 UnsignedMin(const T1& a, const T2& b)\n{\n\tCRYPTOPP_COMPILE_ASSERT((sizeof(T1)<=sizeof(T2) && T2(-1)>0) || (sizeof(T1)>sizeof(T2) && T1(-1)>0));\n\tassert(a==0 || a>0);\t// GCC workaround: get rid of the warning \"comparison is always true due to limited range of data type\"\n\tassert(b>=0);\n\n\tif (sizeof(T1)<=sizeof(T2))\n\t\treturn b < (T2)a ? (T1)b : a;\n\telse\n\t\treturn (T1)b < a ? (T1)b : a;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline const T1 UnsignedMin(const T1& a, const T2& b)\n{\n\tCRYPTOPP_COMPILE_ASSERT((sizeof(T1)<=sizeof(T2) && T2(-1)>0) || (sizeof(T1)>sizeof(T2) && T1(-1)>0));\n\tassert(a==0 || a>0);\t// GCC workaround: get rid of the warning \"comparison is always true due to limited range of data type\"\n\tassert(b>=0);\n\n\tif (sizeof(T1)<=sizeof(T2))\n\t\treturn b < (T2)a ? (T1)b : a;\n\telse\n\t\treturn (T1)b < a ? (T1)b : a;\n}"
        }
      },
      {
        "call_info": {
          "callee": "T::StaticGetValidKeyLength",
          "args": [
            "T::BLOCKSIZE"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "StaticGetValidKeyLength",
          "container": "FixedBlockSize::FixedRounds::SameKeyLengthAs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "123-124",
          "snippet": "StaticGetValidKeyLength(size_t keylength)\n\t\t{return T::StaticGetValidKeyLength(keylength);}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\nFixedBlockSize {\n  FixedRounds {\n    SameKeyLengthAs {\n      StaticGetValidKeyLength(size_t keylength)\n      \t\t{return T::StaticGetValidKeyLength(keylength);}\n    }\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cbcmac.h\"\n\nDMAC_Base<T> {\n  void DMAC_Base<T>::UncheckedSetKey(const byte *key, unsigned int length, const NameValuePairs &params)\n  {\n  \tm_subkeylength = T::StaticGetValidKeyLength(T::BLOCKSIZE);\n  \tm_subkeys.resize(2*UnsignedMin((unsigned int)T::BLOCKSIZE, m_subkeylength));\n  \tm_mac1.SetKey(GenerateSubKeys(key, length), m_subkeylength, params);\n  \tm_f2.SetKey(m_subkeys+m_subkeys.size()/2, m_subkeylength, params);\n  \tm_counter = 0;\n  \tm_subkeys.resize(0);\n  }\n}"
  },
  {
    "function_name": "DMAC",
    "container": "DMAC",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
    "lines": "43-44",
    "snippet": "DMAC(const byte *key, size_t length=DMAC_Base<T>::DEFAULT_KEYLENGTH)\n\t\t{this->SetKey(key, length);}",
    "includes": [
      "#include \"cbcmac.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "this->SetKey",
          "args": [
            "key",
            "length"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cbcmac.h\"\n\nDMAC {\n  DMAC(const byte *key, size_t length=DMAC_Base<T>::DEFAULT_KEYLENGTH)\n  \t\t{this->SetKey(key, length);}\n}"
  },
  {
    "function_name": "DMAC",
    "container": "DMAC",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
    "lines": "42-42",
    "snippet": "DMAC() {}",
    "includes": [
      "#include \"cbcmac.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cbcmac.h\"\n\nDMAC {\n  DMAC() {}\n}"
  },
  {
    "function_name": "DigestSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/dmac.h",
    "lines": "22-22",
    "snippet": "unsigned int DigestSize() const {return DIGESTSIZE;}",
    "includes": [
      "#include \"cbcmac.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cbcmac.h\"\n\nunsigned int DigestSize() const {return DIGESTSIZE;}"
  }
]