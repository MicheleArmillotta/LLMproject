[
  {
    "function_name": "DiscardBytes",
    "container": "ARC4_Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
    "lines": "100-117",
    "snippet": "void ARC4_Base::DiscardBytes(size_t length)\n{\n\tif (length == 0)\n\t\treturn;\n\n\tbyte *const s = m_state;\n\tunsigned int x = m_x;\n\tunsigned int y = m_y;\n\n\tdo\n\t{\n\t\tMakeByte(x, y, s);\n\t}\n\twhile(--length);\n\n\tm_x = x;\n\tm_y = y;\n}",
    "includes": [
      "#include \"arc4.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MakeByte",
          "args": [
            "x",
            "y",
            "s"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "MakeByte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
          "lines": "54-63",
          "snippet": "static inline unsigned int MakeByte(T &x, T &y, byte *s)\n{\n\tunsigned int a = s[x];\n\ty = (y+a) & 0xff;\n\tunsigned int b = s[y];\n\ts[x] = b;\n\ts[y] = a;\n\tx = (x+1) & 0xff;\n\treturn s[(a+b) & 0xff];\n}",
          "includes": [
            "#include \"arc4.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nstatic inline unsigned int MakeByte(T &x, T &y, byte *s)\n{\n\tunsigned int a = s[x];\n\ty = (y+a) & 0xff;\n\tunsigned int b = s[y];\n\ts[x] = b;\n\ts[y] = a;\n\tx = (x+1) & 0xff;\n\treturn s[(a+b) & 0xff];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nARC4_Base {\n  void ARC4_Base::DiscardBytes(size_t length)\n  {\n  \tif (length == 0)\n  \t\treturn;\n  \n  \tbyte *const s = m_state;\n  \tunsigned int x = m_x;\n  \tunsigned int y = m_y;\n  \n  \tdo\n  \t{\n  \t\tMakeByte(x, y, s);\n  \t}\n  \twhile(--length);\n  \n  \tm_x = x;\n  \tm_y = y;\n  }\n}"
  },
  {
    "function_name": "ProcessData",
    "container": "ARC4_Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
    "lines": "71-98",
    "snippet": "void ARC4_Base::ProcessData(byte *outString, const byte *inString, size_t length)\n{\n\tif (length == 0)\n\t\treturn;\n\n\tbyte *const s = m_state;\n\tunsigned int x = m_x;\n\tunsigned int y = m_y;\n\n\tif (inString == outString)\n\t{\n\t\tdo\n\t\t{\n\t\t\t*outString++ ^= MakeByte(x, y, s);\n\t\t} while (--length);\n\t}\n\telse\n\t{\n\t\tdo\n\t\t{\n\t\t\t*outString++ = *inString++ ^ MakeByte(x, y, s);\n\t\t}\n\t\twhile(--length);\n\t}\n\n\tm_x = x;\n\tm_y = y;\n}",
    "includes": [
      "#include \"arc4.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MakeByte",
          "args": [
            "x",
            "y",
            "s"
          ],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "MakeByte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
          "lines": "54-63",
          "snippet": "static inline unsigned int MakeByte(T &x, T &y, byte *s)\n{\n\tunsigned int a = s[x];\n\ty = (y+a) & 0xff;\n\tunsigned int b = s[y];\n\ts[x] = b;\n\ts[y] = a;\n\tx = (x+1) & 0xff;\n\treturn s[(a+b) & 0xff];\n}",
          "includes": [
            "#include \"arc4.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nstatic inline unsigned int MakeByte(T &x, T &y, byte *s)\n{\n\tunsigned int a = s[x];\n\ty = (y+a) & 0xff;\n\tunsigned int b = s[y];\n\ts[x] = b;\n\ts[y] = a;\n\tx = (x+1) & 0xff;\n\treturn s[(a+b) & 0xff];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nARC4_Base {\n  void ARC4_Base::ProcessData(byte *outString, const byte *inString, size_t length)\n  {\n  \tif (length == 0)\n  \t\treturn;\n  \n  \tbyte *const s = m_state;\n  \tunsigned int x = m_x;\n  \tunsigned int y = m_y;\n  \n  \tif (inString == outString)\n  \t{\n  \t\tdo\n  \t\t{\n  \t\t\t*outString++ ^= MakeByte(x, y, s);\n  \t\t} while (--length);\n  \t}\n  \telse\n  \t{\n  \t\tdo\n  \t\t{\n  \t\t\t*outString++ = *inString++ ^ MakeByte(x, y, s);\n  \t\t}\n  \t\twhile(--length);\n  \t}\n  \n  \tm_x = x;\n  \tm_y = y;\n  }\n}"
  },
  {
    "function_name": "GenerateBlock",
    "container": "ARC4_Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
    "lines": "65-69",
    "snippet": "void ARC4_Base::GenerateBlock(byte *output, size_t size)\n{\n\twhile (size--)\n\t\t*output++ = MakeByte(m_x, m_y, m_state);\n}",
    "includes": [
      "#include \"arc4.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MakeByte",
          "args": [
            "m_x",
            "m_y",
            "m_state"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "MakeByte",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
          "lines": "54-63",
          "snippet": "static inline unsigned int MakeByte(T &x, T &y, byte *s)\n{\n\tunsigned int a = s[x];\n\ty = (y+a) & 0xff;\n\tunsigned int b = s[y];\n\ts[x] = b;\n\ts[y] = a;\n\tx = (x+1) & 0xff;\n\treturn s[(a+b) & 0xff];\n}",
          "includes": [
            "#include \"arc4.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nstatic inline unsigned int MakeByte(T &x, T &y, byte *s)\n{\n\tunsigned int a = s[x];\n\ty = (y+a) & 0xff;\n\tunsigned int b = s[y];\n\ts[x] = b;\n\ts[y] = a;\n\tx = (x+1) & 0xff;\n\treturn s[(a+b) & 0xff];\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nARC4_Base {\n  void ARC4_Base::GenerateBlock(byte *output, size_t size)\n  {\n  \twhile (size--)\n  \t\t*output++ = MakeByte(m_x, m_y, m_state);\n  }\n}"
  },
  {
    "function_name": "MakeByte",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
    "lines": "54-63",
    "snippet": "static inline unsigned int MakeByte(T &x, T &y, byte *s)\n{\n\tunsigned int a = s[x];\n\ty = (y+a) & 0xff;\n\tunsigned int b = s[y];\n\ts[x] = b;\n\ts[y] = a;\n\tx = (x+1) & 0xff;\n\treturn s[(a+b) & 0xff];\n}",
    "includes": [
      "#include \"arc4.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nstatic inline unsigned int MakeByte(T &x, T &y, byte *s)\n{\n\tunsigned int a = s[x];\n\ty = (y+a) & 0xff;\n\tunsigned int b = s[y];\n\ts[x] = b;\n\ts[y] = a;\n\tx = (x+1) & 0xff;\n\treturn s[(a+b) & 0xff];\n}"
  },
  {
    "function_name": "UncheckedSetKey",
    "container": "ARC4_Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
    "lines": "26-51",
    "snippet": "void ARC4_Base::UncheckedSetKey(const byte *key, unsigned int keyLen, const NameValuePairs &params)\n{\n\tAssertValidKeyLength(keyLen);\n\n\tm_x = 1;\n\tm_y = 0;\n\n\tunsigned int i;\n\tfor (i=0; i<256; i++)\n\t\tm_state[i] = i;\n\n\tunsigned int keyIndex = 0, stateIndex = 0;\n\tfor (i=0; i<256; i++)\n\t{\n\t\tunsigned int a = m_state[i];\n\t\tstateIndex += key[keyIndex] + a;\n\t\tstateIndex &= 0xff;\n\t\tm_state[i] = m_state[stateIndex];\n\t\tm_state[stateIndex] = a;\n\t\tif (++keyIndex >= keyLen)\n\t\t\tkeyIndex = 0;\n\t}\n\n\tint discardBytes = params.GetIntValueWithDefault(\"DiscardBytes\", GetDefaultDiscardBytes());\n\tDiscardBytes(discardBytes);\n}",
    "includes": [
      "#include \"arc4.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DiscardBytes",
          "args": [
            "discardBytes"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "DiscardBytes",
          "container": "ARC4_Base",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
          "lines": "100-117",
          "snippet": "void ARC4_Base::DiscardBytes(size_t length)\n{\n\tif (length == 0)\n\t\treturn;\n\n\tbyte *const s = m_state;\n\tunsigned int x = m_x;\n\tunsigned int y = m_y;\n\n\tdo\n\t{\n\t\tMakeByte(x, y, s);\n\t}\n\twhile(--length);\n\n\tm_x = x;\n\tm_y = y;\n}",
          "includes": [
            "#include \"arc4.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nARC4_Base {\n  void ARC4_Base::DiscardBytes(size_t length)\n  {\n  \tif (length == 0)\n  \t\treturn;\n  \n  \tbyte *const s = m_state;\n  \tunsigned int x = m_x;\n  \tunsigned int y = m_y;\n  \n  \tdo\n  \t{\n  \t\tMakeByte(x, y, s);\n  \t}\n  \twhile(--length);\n  \n  \tm_x = x;\n  \tm_y = y;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "params.GetIntValueWithDefault",
          "args": [
            "\"DiscardBytes\"",
            "GetDefaultDiscardBytes()"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetDefaultDiscardBytes",
          "args": [],
          "line": 49
        },
        "resolved": true,
        "details": {
          "function_name": "GetDefaultDiscardBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.h",
          "lines": "32-32",
          "snippet": "virtual unsigned int GetDefaultDiscardBytes() const {return 0;}",
          "includes": [
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n\nvirtual unsigned int GetDefaultDiscardBytes() const {return 0;}"
        }
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "keyLen"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nARC4_Base {\n  void ARC4_Base::UncheckedSetKey(const byte *key, unsigned int keyLen, const NameValuePairs &params)\n  {\n  \tAssertValidKeyLength(keyLen);\n  \n  \tm_x = 1;\n  \tm_y = 0;\n  \n  \tunsigned int i;\n  \tfor (i=0; i<256; i++)\n  \t\tm_state[i] = i;\n  \n  \tunsigned int keyIndex = 0, stateIndex = 0;\n  \tfor (i=0; i<256; i++)\n  \t{\n  \t\tunsigned int a = m_state[i];\n  \t\tstateIndex += key[keyIndex] + a;\n  \t\tstateIndex &= 0xff;\n  \t\tm_state[i] = m_state[stateIndex];\n  \t\tm_state[stateIndex] = a;\n  \t\tif (++keyIndex >= keyLen)\n  \t\t\tkeyIndex = 0;\n  \t}\n  \n  \tint discardBytes = params.GetIntValueWithDefault(\"DiscardBytes\", GetDefaultDiscardBytes());\n  \tDiscardBytes(discardBytes);\n  }\n}"
  },
  {
    "function_name": "~ARC4_Base",
    "container": "ARC4_Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
    "lines": "21-24",
    "snippet": "ARC4_Base::~ARC4_Base()\n{\n\tm_x = m_y = 0;\n}",
    "includes": [
      "#include \"arc4.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nARC4_Base {\n  ARC4_Base::~ARC4_Base()\n  {\n  \tm_x = m_y = 0;\n  }\n}"
  },
  {
    "function_name": "ARC4_TestInstantiations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.cpp",
    "lines": "16-19",
    "snippet": "void ARC4_TestInstantiations()\n{\n\tARC4 x;\n}",
    "includes": [
      "#include \"arc4.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"arc4.h\"\n#include \"pch.h\"\n\nvoid ARC4_TestInstantiations()\n{\n\tARC4 x;\n}"
  }
]