[
  {
    "function_name": "Tiger::TruncatedFinal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/tiger.cpp",
    "lines": "17-31",
    "snippet": "void Tiger::TruncatedFinal(byte *hash, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tPadLastBlock(56, 0x01);\n\tCorrectEndianess(m_data, m_data, 56);\n\n\tm_data[7] = GetBitCountLo();\n\n\tTransform(m_state, m_data);\n\tCorrectEndianess(m_state, m_state, DigestSize());\n\tmemcpy(hash, m_state, size);\n\n\tRestart();\t\t// reinit for next use\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"misc.h\"",
      "#include \"tiger.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Restart",
          "args": [],
          "line": 30
        },
        "resolved": true,
        "details": {
          "function_name": "IteratedHashBase<T, BASE>::Restart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.cpp",
          "lines": "120-124",
          "snippet": "void IteratedHashBase<T, BASE>::Restart()\n{\n\tm_countLo = m_countHi = 0;\n\tInit();\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"iterhash.h\"\n\nvoid IteratedHashBase<T, BASE>::Restart()\n{\n\tm_countLo = m_countHi = 0;\n\tInit();\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "hash",
            "m_state",
            "size"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CorrectEndianess",
          "args": [
            "m_state",
            "m_state",
            "DigestSize()"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DigestSize",
          "args": [],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Transform",
          "args": [
            "m_state",
            "m_data"
          ],
          "line": 26
        },
        "resolved": true,
        "details": {
          "function_name": "MD4::Transform",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/md4.cpp",
          "lines": "33-107",
          "snippet": "void MD4::Transform (word32 *digest, const word32 *in)\n{\n// #define F(x, y, z) (((x) & (y)) | ((~x) & (z)))\n#define F(x, y, z) ((z) ^ ((x) & ((y) ^ (z))))\n#define G(x, y, z) (((x) & (y)) | ((x) & (z)) | ((y) & (z)))\n#define H(x, y, z) ((x) ^ (y) ^ (z))\n\n    word32 A, B, C, D;\n\n\tA=digest[0];\n\tB=digest[1];\n\tC=digest[2];\n\tD=digest[3];\n\n#define function(a,b,c,d,k,s) a=rotlFixed(a+F(b,c,d)+in[k],s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 1, 7);\n\t  function(C,D,A,B, 2,11);\n\t  function(B,C,D,A, 3,19);\n\t  function(A,B,C,D, 4, 3);\n\t  function(D,A,B,C, 5, 7);\n\t  function(C,D,A,B, 6,11);\n\t  function(B,C,D,A, 7,19);\n\t  function(A,B,C,D, 8, 3);\n\t  function(D,A,B,C, 9, 7);\n\t  function(C,D,A,B,10,11);\n\t  function(B,C,D,A,11,19);\n\t  function(A,B,C,D,12, 3);\n\t  function(D,A,B,C,13, 7);\n\t  function(C,D,A,B,14,11);\n\t  function(B,C,D,A,15,19);\n\n#undef function\t  \n#define function(a,b,c,d,k,s) a=rotlFixed(a+G(b,c,d)+in[k]+0x5a827999,s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 4, 5);\n\t  function(C,D,A,B, 8, 9);\n\t  function(B,C,D,A,12,13);\n\t  function(A,B,C,D, 1, 3);\n\t  function(D,A,B,C, 5, 5);\n\t  function(C,D,A,B, 9, 9);\n\t  function(B,C,D,A,13,13);\n\t  function(A,B,C,D, 2, 3);\n\t  function(D,A,B,C, 6, 5);\n\t  function(C,D,A,B,10, 9);\n\t  function(B,C,D,A,14,13);\n\t  function(A,B,C,D, 3, 3);\n\t  function(D,A,B,C, 7, 5);\n\t  function(C,D,A,B,11, 9);\n\t  function(B,C,D,A,15,13);\n\n#undef function\t \n#define function(a,b,c,d,k,s) a=rotlFixed(a+H(b,c,d)+in[k]+0x6ed9eba1,s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 8, 9);\n\t  function(C,D,A,B, 4,11);\n\t  function(B,C,D,A,12,15);\n\t  function(A,B,C,D, 2, 3);\n\t  function(D,A,B,C,10, 9);\n\t  function(C,D,A,B, 6,11);\n\t  function(B,C,D,A,14,15);\n\t  function(A,B,C,D, 1, 3);\n\t  function(D,A,B,C, 9, 9);\n\t  function(C,D,A,B, 5,11);\n\t  function(B,C,D,A,13,15);\n\t  function(A,B,C,D, 3, 3);\n\t  function(D,A,B,C,11, 9);\n\t  function(C,D,A,B, 7,11);\n\t  function(B,C,D,A,15,15);\n\n\tdigest[0]+=A;\n\tdigest[1]+=B;\n\tdigest[2]+=C;\n\tdigest[3]+=D;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"md4.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"md4.h\"\n#include \"pch.h\"\n\nvoid MD4::Transform (word32 *digest, const word32 *in)\n{\n// #define F(x, y, z) (((x) & (y)) | ((~x) & (z)))\n#define F(x, y, z) ((z) ^ ((x) & ((y) ^ (z))))\n#define G(x, y, z) (((x) & (y)) | ((x) & (z)) | ((y) & (z)))\n#define H(x, y, z) ((x) ^ (y) ^ (z))\n\n    word32 A, B, C, D;\n\n\tA=digest[0];\n\tB=digest[1];\n\tC=digest[2];\n\tD=digest[3];\n\n#define function(a,b,c,d,k,s) a=rotlFixed(a+F(b,c,d)+in[k],s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 1, 7);\n\t  function(C,D,A,B, 2,11);\n\t  function(B,C,D,A, 3,19);\n\t  function(A,B,C,D, 4, 3);\n\t  function(D,A,B,C, 5, 7);\n\t  function(C,D,A,B, 6,11);\n\t  function(B,C,D,A, 7,19);\n\t  function(A,B,C,D, 8, 3);\n\t  function(D,A,B,C, 9, 7);\n\t  function(C,D,A,B,10,11);\n\t  function(B,C,D,A,11,19);\n\t  function(A,B,C,D,12, 3);\n\t  function(D,A,B,C,13, 7);\n\t  function(C,D,A,B,14,11);\n\t  function(B,C,D,A,15,19);\n\n#undef function\t  \n#define function(a,b,c,d,k,s) a=rotlFixed(a+G(b,c,d)+in[k]+0x5a827999,s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 4, 5);\n\t  function(C,D,A,B, 8, 9);\n\t  function(B,C,D,A,12,13);\n\t  function(A,B,C,D, 1, 3);\n\t  function(D,A,B,C, 5, 5);\n\t  function(C,D,A,B, 9, 9);\n\t  function(B,C,D,A,13,13);\n\t  function(A,B,C,D, 2, 3);\n\t  function(D,A,B,C, 6, 5);\n\t  function(C,D,A,B,10, 9);\n\t  function(B,C,D,A,14,13);\n\t  function(A,B,C,D, 3, 3);\n\t  function(D,A,B,C, 7, 5);\n\t  function(C,D,A,B,11, 9);\n\t  function(B,C,D,A,15,13);\n\n#undef function\t \n#define function(a,b,c,d,k,s) a=rotlFixed(a+H(b,c,d)+in[k]+0x6ed9eba1,s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 8, 9);\n\t  function(C,D,A,B, 4,11);\n\t  function(B,C,D,A,12,15);\n\t  function(A,B,C,D, 2, 3);\n\t  function(D,A,B,C,10, 9);\n\t  function(C,D,A,B, 6,11);\n\t  function(B,C,D,A,14,15);\n\t  function(A,B,C,D, 1, 3);\n\t  function(D,A,B,C, 9, 9);\n\t  function(C,D,A,B, 5,11);\n\t  function(B,C,D,A,13,15);\n\t  function(A,B,C,D, 3, 3);\n\t  function(D,A,B,C,11, 9);\n\t  function(C,D,A,B, 7,11);\n\t  function(B,C,D,A,15,15);\n\n\tdigest[0]+=A;\n\tdigest[1]+=B;\n\tdigest[2]+=C;\n\tdigest[3]+=D;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetBitCountLo",
          "args": [],
          "line": 24
        },
        "resolved": true,
        "details": {
          "function_name": "GetBitCountLo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.h",
          "lines": "36-36",
          "snippet": "inline T GetBitCountLo() const {return m_countLo << 3;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\ninline T GetBitCountLo() const {return m_countLo << 3;}"
        }
      },
      {
        "call_info": {
          "callee": "CorrectEndianess",
          "args": [
            "m_data",
            "m_data",
            "56"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PadLastBlock",
          "args": [
            "56",
            "0x01"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "IteratedHashBase<T, BASE>::PadLastBlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.cpp",
          "lines": "103-118",
          "snippet": "void IteratedHashBase<T, BASE>::PadLastBlock(unsigned int lastBlockSize, byte padFirst)\n{\n\tunsigned int blockSize = this->BlockSize();\n\tunsigned int num = ModPowerOf2(m_countLo, blockSize);\n\tT* dataBuf = this->DataBuf();\n\tbyte* data = (byte *)dataBuf;\n\tdata[num++] = padFirst;\n\tif (num <= lastBlockSize)\n\t\tmemset(data+num, 0, lastBlockSize-num);\n\telse\n\t{\n\t\tmemset(data+num, 0, blockSize-num);\n\t\tHashBlock(dataBuf);\n\t\tmemset(data, 0, lastBlockSize);\n\t}\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"iterhash.h\"\n\nvoid IteratedHashBase<T, BASE>::PadLastBlock(unsigned int lastBlockSize, byte padFirst)\n{\n\tunsigned int blockSize = this->BlockSize();\n\tunsigned int num = ModPowerOf2(m_countLo, blockSize);\n\tT* dataBuf = this->DataBuf();\n\tbyte* data = (byte *)dataBuf;\n\tdata[num++] = padFirst;\n\tif (num <= lastBlockSize)\n\t\tmemset(data+num, 0, lastBlockSize-num);\n\telse\n\t{\n\t\tmemset(data+num, 0, blockSize-num);\n\t\tHashBlock(dataBuf);\n\t\tmemset(data, 0, lastBlockSize);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ThrowIfInvalidTruncatedSize",
          "args": [
            "size"
          ],
          "line": 19
        },
        "resolved": true,
        "details": {
          "function_name": "HashTransformation::ThrowIfInvalidTruncatedSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "309-313",
          "snippet": "void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"misc.h\"\n#include \"tiger.h\"\n#include \"pch.h\"\n\nvoid Tiger::TruncatedFinal(byte *hash, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tPadLastBlock(56, 0x01);\n\tCorrectEndianess(m_data, m_data, 56);\n\n\tm_data[7] = GetBitCountLo();\n\n\tTransform(m_state, m_data);\n\tCorrectEndianess(m_state, m_state, DigestSize());\n\tmemcpy(hash, m_state, size);\n\n\tRestart();\t\t// reinit for next use\n}"
  },
  {
    "function_name": "Tiger::InitState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/tiger.cpp",
    "lines": "10-15",
    "snippet": "void Tiger::InitState(HashWordType *state)\n{\n\tstate[0] = W64LIT(0x0123456789ABCDEF);\n\tstate[1] = W64LIT(0xFEDCBA9876543210);\n\tstate[2] = W64LIT(0xF096A5B4C3B2E187);\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"misc.h\"",
      "#include \"tiger.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "W64LIT",
          "args": [
            "0xF096A5B4C3B2E187"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "W64LIT",
          "args": [
            "0xFEDCBA9876543210"
          ],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "W64LIT",
          "args": [
            "0x0123456789ABCDEF"
          ],
          "line": 12
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"misc.h\"\n#include \"tiger.h\"\n#include \"pch.h\"\n\nvoid Tiger::InitState(HashWordType *state)\n{\n\tstate[0] = W64LIT(0x0123456789ABCDEF);\n\tstate[1] = W64LIT(0xFEDCBA9876543210);\n\tstate[2] = W64LIT(0xF096A5B4C3B2E187);\n}"
  }
]