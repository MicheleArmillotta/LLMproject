[
  {
    "function_name": "ProcessAndXorBlock",
    "container": "SEED::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seed.cpp",
    "lines": "84-102",
    "snippet": "void SEED::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\r\n{\r\n\ttypedef BlockGetAndPut<word32, BigEndian> Block;\r\n\tword32 a0, a1, b0, b1, t0, t1;\r\n\tBlock::Get(inBlock)(a0)(a1)(b0)(b1);\r\n\r\n\tfor (int i=0; i<ROUNDS; i+=2)\r\n\t{\r\n\t\tt0 = b0 ^ m_k[2*i+0]; t1 = b1 ^ m_k[2*i+1] ^ t0;\r\n\t\tt1 = G(t1); t0 += t1; t0 = G(t0); t1 += t0; t1 = G(t1);\r\n\t\ta0 ^= t0 + t1; a1 ^= t1;\r\n\r\n\t\tt0 = a0 ^ m_k[2*i+2]; t1 = a1 ^ m_k[2*i+3] ^ t0;\r\n\t\tt1 = G(t1); t0 += t1; t0 = G(t0); t1 += t0; t1 = G(t1);\r\n\t\tb0 ^= t0 + t1; b1 ^= t1;\r\n\t}\r\n\r\n\tBlock::Put(xorBlock, outBlock)(b0)(b1)(a0)(a1);\r\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"seed.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "a1"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "G",
          "args": [
            "t1"
          ],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "OpenPGPDecode",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3192-3198",
          "snippet": "void Integer::OpenPGPDecode(BufferedTransformation &bt)\n{\n\tword16 bitCount;\n\tif (bt.GetWord16(bitCount) != 2 || bt.MaxRetrievable() < BitsToBytes(bitCount))\n\t\tthrow OpenPGPDecodeErr();\n\tDecode(bt, BitsToBytes(bitCount));\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  void Integer::OpenPGPDecode(BufferedTransformation &bt)\n  {\n  \tword16 bitCount;\n  \tif (bt.GetWord16(bitCount) != 2 || bt.MaxRetrievable() < BitsToBytes(bitCount))\n  \t\tthrow OpenPGPDecodeErr();\n  \tDecode(bt, BitsToBytes(bitCount));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "b1"
          ],
          "line": 88
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"seed.h\"\n#include \"pch.h\"\n\nSEED {\n  Base {\n    void SEED::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\r\n    {\r\n    \ttypedef BlockGetAndPut<word32, BigEndian> Block;\r\n    \tword32 a0, a1, b0, b1, t0, t1;\r\n    \tBlock::Get(inBlock)(a0)(a1)(b0)(b1);\r\n    \r\n    \tfor (int i=0; i<ROUNDS; i+=2)\r\n    \t{\r\n    \t\tt0 = b0 ^ m_k[2*i+0]; t1 = b1 ^ m_k[2*i+1] ^ t0;\r\n    \t\tt1 = G(t1); t0 += t1; t0 = G(t0); t1 += t0; t1 = G(t1);\r\n    \t\ta0 ^= t0 + t1; a1 ^= t1;\r\n    \r\n    \t\tt0 = a0 ^ m_k[2*i+2]; t1 = a1 ^ m_k[2*i+3] ^ t0;\r\n    \t\tt1 = G(t1); t0 += t1; t0 = G(t0); t1 += t0; t1 = G(t1);\r\n    \t\tb0 ^= t0 + t1; b1 ^= t1;\r\n    \t}\r\n    \r\n    \tBlock::Put(xorBlock, outBlock)(b0)(b1)(a0)(a1);\r\n    }\n  }\n}"
  },
  {
    "function_name": "UncheckedSetKey",
    "container": "SEED::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seed.cpp",
    "lines": "55-82",
    "snippet": "void SEED::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &params)\r\n{\r\n\tAssertValidKeyLength(length);\r\n\r\n\tword64 key01, key23;\r\n\tGetBlock<word64, BigEndian> get(userKey);\r\n\tget(key01)(key23);\r\n\tword32 *k = m_k;\r\n\tsize_t kInc = 2;\r\n\tif (!IsForwardTransformation())\r\n\t{\r\n\t\tk = k+30;\r\n\t\tkInc = 0-kInc;\r\n\t}\r\n\r\n\tfor (int i=0; i<ROUNDS; i++)\r\n\t{\r\n\t\tword32 t0 = word32(key01>>32) + word32(key23>>32) - s_kc[i];\r\n\t\tword32 t1 = word32(key01) - word32(key23) + s_kc[i];\r\n\t\tk[0] = G(t0);\r\n\t\tk[1] = G(t1);\r\n\t\tk+=kInc;\r\n\t\tif (i&1)\r\n\t\t\tkey23 = rotlFixed<word64>(key23, 8);\r\n\t\telse\r\n\t\t\tkey01 = rotrFixed<word64>(key01, 8);\r\n\t}\r\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"seed.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const word32 s_kc[16] = {\r\n\t0x9e3779b9, 0x3c6ef373, 0x78dde6e6, 0xf1bbcdcc, 0xe3779b99, 0xc6ef3733, 0x8dde6e67, 0x1bbcdccf,\r\n\t0x3779b99e, 0x6ef3733c, 0xdde6e678, 0xbbcdccf1, 0x779b99e3, 0xef3733c6, 0xde6e678d, 0xbcdccf1b};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "rotrFixed<word64>",
          "args": [
            "key01",
            "8"
          ],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "rotrFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "586-590",
          "snippet": "inline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotlFixed<word64>",
          "args": [
            "key23",
            "8"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "G",
          "args": [
            "t1"
          ],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "OpenPGPDecode",
          "container": "Integer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3192-3198",
          "snippet": "void Integer::OpenPGPDecode(BufferedTransformation &bt)\n{\n\tword16 bitCount;\n\tif (bt.GetWord16(bitCount) != 2 || bt.MaxRetrievable() < BitsToBytes(bitCount))\n\t\tthrow OpenPGPDecodeErr();\n\tDecode(bt, BitsToBytes(bitCount));\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger {\n  void Integer::OpenPGPDecode(BufferedTransformation &bt)\n  {\n  \tword16 bitCount;\n  \tif (bt.GetWord16(bitCount) != 2 || bt.MaxRetrievable() < BitsToBytes(bitCount))\n  \t\tthrow OpenPGPDecodeErr();\n  \tDecode(bt, BitsToBytes(bitCount));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "word32",
          "args": [
            "key23"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "word32",
          "args": [
            "key01"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "word32",
          "args": [
            "key23>>32"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "word32",
          "args": [
            "key01>>32"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsForwardTransformation",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.h",
          "lines": "25-25",
          "snippet": "bool IsForwardTransformation() const {return true;}",
          "includes": [
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n\nbool IsForwardTransformation() const {return true;}"
        }
      },
      {
        "call_info": {
          "callee": "get",
          "args": [
            "key23"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "Unget",
          "container": "ByteQueue",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/queue.cpp",
          "lines": "378-381",
          "snippet": "void ByteQueue::Unget(byte inByte)\n{\n\tUnget(&inByte, 1);\n}",
          "includes": [
            "#include \"filters.h\"",
            "#include \"queue.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"filters.h\"\n#include \"queue.h\"\n#include \"pch.h\"\n\nByteQueue {\n  void ByteQueue::Unget(byte inByte)\n  {\n  \tUnget(&inByte, 1);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "length"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"seed.h\"\n#include \"pch.h\"\n\nstatic const word32 s_kc[16] = {\r\n\t0x9e3779b9, 0x3c6ef373, 0x78dde6e6, 0xf1bbcdcc, 0xe3779b99, 0xc6ef3733, 0x8dde6e67, 0x1bbcdccf,\r\n\t0x3779b99e, 0x6ef3733c, 0xdde6e678, 0xbbcdccf1, 0x779b99e3, 0xef3733c6, 0xde6e678d, 0xbcdccf1b};\n\nSEED {\n  Base {\n    void SEED::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &params)\r\n    {\r\n    \tAssertValidKeyLength(length);\r\n    \r\n    \tword64 key01, key23;\r\n    \tGetBlock<word64, BigEndian> get(userKey);\r\n    \tget(key01)(key23);\r\n    \tword32 *k = m_k;\r\n    \tsize_t kInc = 2;\r\n    \tif (!IsForwardTransformation())\r\n    \t{\r\n    \t\tk = k+30;\r\n    \t\tkInc = 0-kInc;\r\n    \t}\r\n    \r\n    \tfor (int i=0; i<ROUNDS; i++)\r\n    \t{\r\n    \t\tword32 t0 = word32(key01>>32) + word32(key23>>32) - s_kc[i];\r\n    \t\tword32 t1 = word32(key01) - word32(key23) + s_kc[i];\r\n    \t\tk[0] = G(t0);\r\n    \t\tk[1] = G(t1);\r\n    \t\tk+=kInc;\r\n    \t\tif (i&1)\r\n    \t\t\tkey23 = rotlFixed<word64>(key23, 8);\r\n    \t\telse\r\n    \t\t\tkey01 = rotrFixed<word64>(key01, 8);\r\n    \t}\r\n    }\n  }\n}"
  }
]