[
  {
    "function_name": "Whirlpool::Transform",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/whrlpool.cpp",
    "lines": "392-699",
    "snippet": "void Whirlpool::Transform(word64 *digest, const word64 *block)\n{\n#if CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE\n\tif (HasISSE())\n\t{\n\t\t// MMX version has the same structure as C version below\n#ifdef __GNUC__\n\t#if CRYPTOPP_BOOL_X64\n\t\tword64 workspace[16];\n\t#endif\n\t__asm__ __volatile__\n\t(\n\t\t\".intel_syntax noprefix;\"\n\t\tAS_PUSH_IF86(\tbx)\n\t\tAS2(\tmov\t\tAS_REG_6, WORD_REG(ax))\n#else\n\t#if _MSC_VER < 1300\n\t\tAS_PUSH_IF86(\tbx)\n\t#endif\n\t\tAS2(\tlea\t\tAS_REG_6, [Whirlpool_C])\n\t\tAS2(\tmov\t\tWORD_REG(cx), digest)\n\t\tAS2(\tmov\t\tWORD_REG(dx), block)\n#endif\n#if CRYPTOPP_BOOL_X86\n\t\tAS2(\tmov\t\teax, esp)\n\t\tAS2(\tand\t\tesp, -16)\n\t\tAS2(\tsub\t\tesp, 16*8)\n\t\tAS1(\tpush\teax)\n\t#define SSE2_workspace\tesp+WORD_SZ\n#else\n\t#define SSE2_workspace\t%3\n#endif\n\t\tAS2(\txor\t\tesi, esi)\n\t\tASL(0)\n\t\tAS2(\tmovq\tmm0, [WORD_REG(cx)+8*WORD_REG(si)])\n\t\tAS2(\tmovq\t[SSE2_workspace+8*WORD_REG(si)], mm0)\t\t// k\n\t\tAS2(\tpxor\tmm0, [WORD_REG(dx)+8*WORD_REG(si)])\n\t\tAS2(\tmovq\t[SSE2_workspace+64+8*WORD_REG(si)], mm0)\t// s\n\t\tAS2(\tmovq\t[WORD_REG(cx)+8*WORD_REG(si)], mm0)\n\t\tAS1(\tinc\t\tWORD_REG(si))\n\t\tAS2(\tcmp\t\tWORD_REG(si), 8)\n\t\tASJ(\tjne,\t0, b)\n\n\t\tAS2(\txor\t\tesi, esi)\n\t\tASL(1)\n\n#define KSL0(a, b)\tAS2(movq\tmm##a, b)\n#define KSL1(a, b)\tAS2(pxor\tmm##a, b)\n\n#define KSL(op, i, a, b, c, d)\t\\\n\tAS2(mov\t\teax, [SSE2_workspace+8*i])\\\n\tAS2(movzx\tedi, al)\\\n\tKSL##op(a, [AS_REG_6+3*2048+8*WORD_REG(di)])\\\n\tAS2(movzx\tedi, ah)\\\n\tKSL##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n\tAS2(shr\t\teax, 16)\\\n\tAS2(movzx\tedi, al)\\\n\tAS2(shr\t\teax, 8)\\\n\tKSL##op(c, [AS_REG_6+1*2048+8*WORD_REG(di)])\\\n\tKSL##op(d, [AS_REG_6+0*2048+8*WORD_REG(ax)])\n\n#define KSH0(a, b)\t\\\n\tASS(pshufw\tmm##a, mm##a, 1, 0, 3, 2)\\\n\tAS2(pxor\tmm##a, b)\n#define KSH1(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\n#define KSH2(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\\\n\tAS2(movq\t[SSE2_workspace+8*a], mm##a)\n\n#define KSH(op, i, a, b, c, d)\t\\\n\tAS2(mov\t\teax, [SSE2_workspace+8*((i+4)-8*((i+4)/8))+4])\\\n\tAS2(movzx\tedi, al)\\\n\tKSH##op(a, [AS_REG_6+3*2048+8*WORD_REG(di)])\\\n\tAS2(movzx\tedi, ah)\\\n\tKSH##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n\tAS2(shr\t\teax, 16)\\\n\tAS2(movzx\tedi, al)\\\n\tAS2(shr\t\teax, 8)\\\n\tKSH##op(c, [AS_REG_6+1*2048+8*WORD_REG(di)])\\\n\tKSH##op(d, [AS_REG_6+0*2048+8*WORD_REG(ax)])\n\n#define TSL(op, i, a, b, c, d)\t\\\n\tAS2(mov\t\teax, [SSE2_workspace+64+8*i])\\\n\tAS2(movzx\tedi, al)\\\n\tKSL##op(a, [AS_REG_6+3*2048+8*WORD_REG(di)])\\\n\tAS2(movzx\tedi, ah)\\\n\tKSL##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n\tAS2(shr\t\teax, 16)\\\n\tAS2(movzx\tedi, al)\\\n\tAS2(shr\t\teax, 8)\\\n\tKSL##op(c, [AS_REG_6+1*2048+8*WORD_REG(di)])\\\n\tKSL##op(d, [AS_REG_6+0*2048+8*WORD_REG(ax)])\n\n#define TSH0(a, b)\t\\\n\tASS(pshufw\tmm##a, mm##a, 1, 0, 3, 2)\\\n\tAS2(pxor\tmm##a, [SSE2_workspace+8*a])\\\n\tAS2(pxor\tmm##a, b)\n#define TSH1(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\n#define TSH2(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\\\n\tAS2(movq\t[SSE2_workspace+64+8*a], mm##a)\n#define TSH3(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\\\n\tAS2(pxor\tmm##a, [WORD_REG(cx)+8*a])\\\n\tAS2(movq\t[WORD_REG(cx)+8*a], mm##a)\n\n#define TSH(op, i, a, b, c, d)\t\\\n\tAS2(mov\t\teax, [SSE2_workspace+64+8*((i+4)-8*((i+4)/8))+4])\\\n\tAS2(movzx\tedi, al)\\\n\tTSH##op(a, [AS_REG_6+3*2048+8*WORD_REG(di)])\\\n\tAS2(movzx\tedi, ah)\\\n\tTSH##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n\tAS2(shr\t\teax, 16)\\\n\tAS2(movzx\tedi, al)\\\n\tAS2(shr\t\teax, 8)\\\n\tTSH##op(c, [AS_REG_6+1*2048+8*WORD_REG(di)])\\\n\tTSH##op(d, [AS_REG_6+0*2048+8*WORD_REG(ax)])\n\n\t\tKSL(0, 4, 3, 2, 1, 0)\n\t\tKSL(0, 0, 7, 6, 5, 4)\n\t\tKSL(1, 1, 0, 7, 6, 5)\n\t\tKSL(1, 2, 1, 0, 7, 6)\n\t\tKSL(1, 3, 2, 1, 0, 7)\n\t\tKSL(1, 5, 4, 3, 2, 1)\n\t\tKSL(1, 6, 5, 4, 3, 2)\n\t\tKSL(1, 7, 6, 5, 4, 3)\n\t\tKSH(0, 0, 7, 6, 5, 4)\n\t\tKSH(0, 4, 3, 2, 1, 0)\n\t\tKSH(1, 1, 0, 7, 6, 5)\n\t\tKSH(1, 2, 1, 0, 7, 6)\n\t\tKSH(1, 5, 4, 3, 2, 1)\n\t\tKSH(1, 6, 5, 4, 3, 2)\n\t\tKSH(2, 3, 2, 1, 0, 7)\n\t\tKSH(2, 7, 6, 5, 4, 3)\n\n\t\tAS2(\tpxor\tmm0, [AS_REG_6 + 8*1024 + WORD_REG(si)*8])\n\t\tAS2(\tmovq\t[SSE2_workspace], mm0)\n\n\t\tTSL(0, 4, 3, 2, 1, 0)\n\t\tTSL(0, 0, 7, 6, 5, 4)\n\t\tTSL(1, 1, 0, 7, 6, 5)\n\t\tTSL(1, 2, 1, 0, 7, 6)\n\t\tTSL(1, 3, 2, 1, 0, 7)\n\t\tTSL(1, 5, 4, 3, 2, 1)\n\t\tTSL(1, 6, 5, 4, 3, 2)\n\t\tTSL(1, 7, 6, 5, 4, 3)\n\t\tTSH(0, 0, 7, 6, 5, 4)\n\t\tTSH(0, 4, 3, 2, 1, 0)\n\t\tTSH(1, 1, 0, 7, 6, 5)\n\t\tTSH(1, 2, 1, 0, 7, 6)\n\t\tTSH(1, 5, 4, 3, 2, 1)\n\t\tTSH(1, 6, 5, 4, 3, 2)\n\n\t\tAS1(\tinc\t\tWORD_REG(si))\n\t\tAS2(\tcmp\t\tWORD_REG(si), 10)\n\t\tASJ(\tje,\t\t2, f)\n\n\t\tTSH(2, 3, 2, 1, 0, 7)\n\t\tTSH(2, 7, 6, 5, 4, 3)\n\n\t\tASJ(\tjmp,\t1, b)\n\t\tASL(2)\n\n\t\tTSH(3, 3, 2, 1, 0, 7)\n\t\tTSH(3, 7, 6, 5, 4, 3)\n\n#undef KSL\n#undef KSH\n#undef TSL\n#undef TSH\n\n\t\tAS_POP_IF86(\tsp)\n\t\tAS1(\temms)\n\n#if defined(__GNUC__) || (defined(_MSC_VER) && _MSC_VER < 1300)\n\t\tAS_POP_IF86(\tbx)\n#endif\n#ifdef __GNUC__\n\t\t\".att_syntax prefix;\"\n\t\t\t:\n\t\t\t: \"a\" (Whirlpool_C), \"c\" (digest), \"d\" (block)\n\t#if CRYPTOPP_BOOL_X64\n\t\t\t, \"r\" (workspace)\n\t#endif\n\t\t\t: \"%esi\", \"%edi\", \"memory\", \"cc\"\n\t#if CRYPTOPP_BOOL_X64\n\t\t\t, \"%r9\"\n\t#endif\n\t\t);\n#endif\n\t}\n\telse\n#endif\t\t// #ifdef CRYPTOPP_X86_ASM_AVAILABLE\n\t{\n\tword64 s[8];\t// the cipher state\n\tword64 k[8];\t// the round key\n\n\t// Compute and apply K^0 to the cipher state\n\t// Also apply part of the Miyaguchi-Preneel compression function\n\tfor (int i=0; i<8; i++)\n\t\tdigest[i] = s[i] = block[i] ^ (k[i] = digest[i]);\n\n#define KSL(op, i, a, b, c, d)\t\\\n\tt = (word32)k[i];\\\n\tw##a = Whirlpool_C[3*256 + (byte)t] ^ (op ? w##a : 0);\\\n\tt >>= 8;\\\n\tw##b = Whirlpool_C[2*256 + (byte)t] ^ (op ? w##b : 0);\\\n\tt >>= 8;\\\n\tw##c = Whirlpool_C[1*256 + (byte)t] ^ (op ? w##c : 0);\\\n\tt >>= 8;\\\n\tw##d = Whirlpool_C[0*256 + t]       ^ (op ? w##d : 0);\n\n#define KSH(op, i, a, b, c, d)\t\\\n\tt = (word32)(k[(i+4)%8]>>32);\\\n\tw##a = Whirlpool_C[3*256 + (byte)t] ^ (op ? w##a : rotrFixed(w##a, 32));\\\n\tif (op==2) k[a] = w##a;\\\n\tt >>= 8;\\\n\tw##b = Whirlpool_C[2*256 + (byte)t] ^ (op ? w##b : rotrFixed(w##b, 32));\\\n\tif (op==2) k[b] = w##b;\\\n\tt >>= 8;\\\n\tw##c = Whirlpool_C[1*256 + (byte)t] ^ (op ? w##c : rotrFixed(w##c, 32));\\\n\tif (op==2) k[c] = w##c;\\\n\tt >>= 8;\\\n\tw##d = Whirlpool_C[0*256 + t]       ^ (op ? w##d : rotrFixed(w##d, 32));\\\n\tif (op==2) k[d] = w##d;\\\n\n#define TSL(op, i, a, b, c, d)\t\\\n\tt = (word32)s[i];\\\n\tw##a = Whirlpool_C[3*256 + (byte)t] ^ (op ? w##a : 0);\\\n\tt >>= 8;\\\n\tw##b = Whirlpool_C[2*256 + (byte)t] ^ (op ? w##b : 0);\\\n\tt >>= 8;\\\n\tw##c = Whirlpool_C[1*256 + (byte)t] ^ (op ? w##c : 0);\\\n\tt >>= 8;\\\n\tw##d = Whirlpool_C[0*256 + t]       ^ (op ? w##d : 0);\n\n#define TSH_OP(op, a, b)\t\\\n\tw##a = Whirlpool_C[b*256 + (byte)t] ^ (op ? w##a : rotrFixed(w##a, 32) ^ k[a]);\\\n\tif (op==2) s[a] = w##a;\\\n\tif (op==3) digest[a] ^= w##a;\\\n\n#define TSH(op, i, a, b, c, d)\t\\\n\tt = (word32)(s[(i+4)%8]>>32);\\\n\tTSH_OP(op, a, 3);\\\n\tt >>= 8;\\\n\tTSH_OP(op, b, 2);\\\n\tt >>= 8;\\\n\tTSH_OP(op, c, 1);\\\n\tt >>= 8;\\\n\tTSH_OP(op, d, 0);\\\n\n\t// Iterate over all rounds:\n\tint r=0;\n\twhile (true)\n\t{\n\t\tword64 w0, w1, w2, w3, w4, w5, w6, w7;\t// temporary storage\n\t\tword32 t;\n\n\t\tKSL(0, 4, 3, 2, 1, 0)\n\t\tKSL(0, 0, 7, 6, 5, 4)\n\t\tKSL(1, 1, 0, 7, 6, 5)\n\t\tKSL(1, 2, 1, 0, 7, 6)\n\t\tKSL(1, 3, 2, 1, 0, 7)\n\t\tKSL(1, 5, 4, 3, 2, 1)\n\t\tKSL(1, 6, 5, 4, 3, 2)\n\t\tKSL(1, 7, 6, 5, 4, 3)\n\t\tKSH(0, 0, 7, 6, 5, 4)\n\t\tKSH(0, 4, 3, 2, 1, 0)\n\t\tKSH(1, 1, 0, 7, 6, 5)\n\t\tKSH(1, 2, 1, 0, 7, 6)\n\t\tKSH(1, 5, 4, 3, 2, 1)\n\t\tKSH(1, 6, 5, 4, 3, 2)\n\t\tKSH(2, 3, 2, 1, 0, 7)\n\t\tKSH(2, 7, 6, 5, 4, 3)\n\n\t\tk[0] ^= Whirlpool_C[1024+r];\n\n\t\tTSL(0, 4, 3, 2, 1, 0)\n\t\tTSL(0, 0, 7, 6, 5, 4)\n\t\tTSL(1, 1, 0, 7, 6, 5)\n\t\tTSL(1, 2, 1, 0, 7, 6)\n\t\tTSL(1, 3, 2, 1, 0, 7)\n\t\tTSL(1, 5, 4, 3, 2, 1)\n\t\tTSL(1, 6, 5, 4, 3, 2)\n\t\tTSL(1, 7, 6, 5, 4, 3)\n\t\tTSH(0, 0, 7, 6, 5, 4)\n\t\tTSH(0, 4, 3, 2, 1, 0)\n\t\tTSH(1, 1, 0, 7, 6, 5)\n\t\tTSH(1, 2, 1, 0, 7, 6)\n\t\tTSH(1, 5, 4, 3, 2, 1)\n\t\tTSH(1, 6, 5, 4, 3, 2)\n\n\t\tif (++r < R)\n\t\t{\n\t\t\tTSH(2, 3, 2, 1, 0, 7)\n\t\t\tTSH(2, 7, 6, 5, 4, 3)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tTSH(3, 3, 2, 1, 0, 7)\n\t\t\tTSH(3, 7, 6, 5, 4, 3)\n\t\t\tbreak;\n\t\t}\n\t}\n\t}\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"misc.h\"",
      "#include \"whrlpool.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [
      "#define SSE2_workspace\t%3",
      "#define SSE2_workspace\tesp+WORD_SZ",
      "#define R 10"
    ],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "3",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 694
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "3",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 693
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "2",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 689
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "2",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 688
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "1",
            "6",
            "5",
            "4",
            "3",
            "2"
          ],
          "line": 684
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "1",
            "5",
            "4",
            "3",
            "2",
            "1"
          ],
          "line": 683
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "1",
            "2",
            "1",
            "0",
            "7",
            "6"
          ],
          "line": 682
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "1",
            "1",
            "0",
            "7",
            "6",
            "5"
          ],
          "line": 681
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "0",
            "4",
            "3",
            "2",
            "1",
            "0"
          ],
          "line": 680
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "0",
            "0",
            "7",
            "6",
            "5",
            "4"
          ],
          "line": 679
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 678
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "6",
            "5",
            "4",
            "3",
            "2"
          ],
          "line": 677
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "5",
            "4",
            "3",
            "2",
            "1"
          ],
          "line": 676
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 675
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "2",
            "1",
            "0",
            "7",
            "6"
          ],
          "line": 674
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "1",
            "0",
            "7",
            "6",
            "5"
          ],
          "line": 673
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "0",
            "0",
            "7",
            "6",
            "5",
            "4"
          ],
          "line": 672
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "0",
            "4",
            "3",
            "2",
            "1",
            "0"
          ],
          "line": 671
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "2",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 667
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "2",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 666
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "1",
            "6",
            "5",
            "4",
            "3",
            "2"
          ],
          "line": 665
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "1",
            "5",
            "4",
            "3",
            "2",
            "1"
          ],
          "line": 664
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "1",
            "2",
            "1",
            "0",
            "7",
            "6"
          ],
          "line": 663
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "1",
            "1",
            "0",
            "7",
            "6",
            "5"
          ],
          "line": 662
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "0",
            "4",
            "3",
            "2",
            "1",
            "0"
          ],
          "line": 661
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "0",
            "0",
            "7",
            "6",
            "5",
            "4"
          ],
          "line": 660
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 659
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "6",
            "5",
            "4",
            "3",
            "2"
          ],
          "line": 658
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "5",
            "4",
            "3",
            "2",
            "1"
          ],
          "line": 657
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 656
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "2",
            "1",
            "0",
            "7",
            "6"
          ],
          "line": 655
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "1",
            "0",
            "7",
            "6",
            "5"
          ],
          "line": 654
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "0",
            "0",
            "7",
            "6",
            "5",
            "4"
          ],
          "line": 653
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "0",
            "4",
            "3",
            "2",
            "1",
            "0"
          ],
          "line": 652
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "\"r\"",
          "args": [
            "workspace"
          ],
          "line": 576
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "\"d\"",
          "args": [
            "block"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "\"c\"",
          "args": [
            "digest"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "\"a\"",
          "args": [
            "Whirlpool_C"
          ],
          "line": 574
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AS_POP_IF86",
          "args": [
            "bx"
          ],
          "line": 569
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AS1",
          "args": [
            "emms"
          ],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AS_POP_IF86",
          "args": [
            "sp"
          ],
          "line": 565
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "3",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 558
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "3",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 557
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASL",
          "args": [
            "2"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASJ",
          "args": [
            "jmp",
            "1",
            "b"
          ],
          "line": 554
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "2",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "1",
            "6",
            "5",
            "4",
            "3",
            "2"
          ],
          "line": 545
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "1",
            "5",
            "4",
            "3",
            "2",
            "1"
          ],
          "line": 544
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "1",
            "2",
            "1",
            "0",
            "7",
            "6"
          ],
          "line": 543
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "1",
            "1",
            "0",
            "7",
            "6",
            "5"
          ],
          "line": 542
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "0",
            "4",
            "3",
            "2",
            "1",
            "0"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSH",
          "args": [
            "0",
            "0",
            "7",
            "6",
            "5",
            "4"
          ],
          "line": 540
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 539
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "6",
            "5",
            "4",
            "3",
            "2"
          ],
          "line": 538
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "5",
            "4",
            "3",
            "2",
            "1"
          ],
          "line": 537
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 536
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "2",
            "1",
            "0",
            "7",
            "6"
          ],
          "line": 535
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "1",
            "1",
            "0",
            "7",
            "6",
            "5"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "0",
            "0",
            "7",
            "6",
            "5",
            "4"
          ],
          "line": 533
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TSL",
          "args": [
            "0",
            "4",
            "3",
            "2",
            "1",
            "0"
          ],
          "line": 532
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AS2",
          "args": [
            "movq\t[SSE2_workspace]",
            "mm0"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "si"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "2",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 527
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "2",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 526
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "1",
            "6",
            "5",
            "4",
            "3",
            "2"
          ],
          "line": 525
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "1",
            "5",
            "4",
            "3",
            "2",
            "1"
          ],
          "line": 524
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "1",
            "2",
            "1",
            "0",
            "7",
            "6"
          ],
          "line": 523
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "1",
            "1",
            "0",
            "7",
            "6",
            "5"
          ],
          "line": 522
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "0",
            "4",
            "3",
            "2",
            "1",
            "0"
          ],
          "line": 521
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSH",
          "args": [
            "0",
            "0",
            "7",
            "6",
            "5",
            "4"
          ],
          "line": 520
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "7",
            "6",
            "5",
            "4",
            "3"
          ],
          "line": 519
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "6",
            "5",
            "4",
            "3",
            "2"
          ],
          "line": 518
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "5",
            "4",
            "3",
            "2",
            "1"
          ],
          "line": 517
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "3",
            "2",
            "1",
            "0",
            "7"
          ],
          "line": 516
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "2",
            "1",
            "0",
            "7",
            "6"
          ],
          "line": 515
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "1",
            "1",
            "0",
            "7",
            "6",
            "5"
          ],
          "line": 514
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "0",
            "0",
            "7",
            "6",
            "5",
            "4"
          ],
          "line": 513
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "KSL",
          "args": [
            "0",
            "4",
            "3",
            "2",
            "1",
            "0"
          ],
          "line": 512
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AS2",
          "args": [
            "movq\t[WORD_REG(cx)+8*WORD_REG(si)]",
            "mm0"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "si"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "cx"
          ],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AS2",
          "args": [
            "movq\t[SSE2_workspace+64+8*WORD_REG(si)]",
            "mm0"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "si"
          ],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "si"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "dx"
          ],
          "line": 428
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AS2",
          "args": [
            "movq\t[SSE2_workspace+8*WORD_REG(si)]",
            "mm0"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "si"
          ],
          "line": 427
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "si"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "WORD_REG",
          "args": [
            "cx"
          ],
          "line": 426
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASL",
          "args": [
            "0"
          ],
          "line": 425
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AS_PUSH_IF86",
          "args": [
            "bx"
          ],
          "line": 409
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HasISSE",
          "args": [],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "HasISSE",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cpu.h",
          "lines": "130-135",
          "snippet": "inline bool HasISSE()\n{\n\tif (!g_x86DetectionDone)\n\t\tDetectX86Features();\n\treturn g_hasISSE;\n}",
          "includes": [
            "#include <wmmintrin.h>",
            "#include <smmintrin.h>",
            "#include <tmmintrin.h>",
            "#include <emmintrin.h>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <wmmintrin.h>\n#include <smmintrin.h>\n#include <tmmintrin.h>\n#include <emmintrin.h>\n#include \"config.h\"\n\ninline bool HasISSE()\n{\n\tif (!g_x86DetectionDone)\n\t\tDetectX86Features();\n\treturn g_hasISSE;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"misc.h\"\n#include \"whrlpool.h\"\n#include \"pch.h\"\n\n#define SSE2_workspace\t%3\n#define SSE2_workspace\tesp+WORD_SZ\n#define R 10\n\nvoid Whirlpool::Transform(word64 *digest, const word64 *block)\n{\n#if CRYPTOPP_BOOL_SSE2_ASM_AVAILABLE\n\tif (HasISSE())\n\t{\n\t\t// MMX version has the same structure as C version below\n#ifdef __GNUC__\n\t#if CRYPTOPP_BOOL_X64\n\t\tword64 workspace[16];\n\t#endif\n\t__asm__ __volatile__\n\t(\n\t\t\".intel_syntax noprefix;\"\n\t\tAS_PUSH_IF86(\tbx)\n\t\tAS2(\tmov\t\tAS_REG_6, WORD_REG(ax))\n#else\n\t#if _MSC_VER < 1300\n\t\tAS_PUSH_IF86(\tbx)\n\t#endif\n\t\tAS2(\tlea\t\tAS_REG_6, [Whirlpool_C])\n\t\tAS2(\tmov\t\tWORD_REG(cx), digest)\n\t\tAS2(\tmov\t\tWORD_REG(dx), block)\n#endif\n#if CRYPTOPP_BOOL_X86\n\t\tAS2(\tmov\t\teax, esp)\n\t\tAS2(\tand\t\tesp, -16)\n\t\tAS2(\tsub\t\tesp, 16*8)\n\t\tAS1(\tpush\teax)\n\t#define SSE2_workspace\tesp+WORD_SZ\n#else\n\t#define SSE2_workspace\t%3\n#endif\n\t\tAS2(\txor\t\tesi, esi)\n\t\tASL(0)\n\t\tAS2(\tmovq\tmm0, [WORD_REG(cx)+8*WORD_REG(si)])\n\t\tAS2(\tmovq\t[SSE2_workspace+8*WORD_REG(si)], mm0)\t\t// k\n\t\tAS2(\tpxor\tmm0, [WORD_REG(dx)+8*WORD_REG(si)])\n\t\tAS2(\tmovq\t[SSE2_workspace+64+8*WORD_REG(si)], mm0)\t// s\n\t\tAS2(\tmovq\t[WORD_REG(cx)+8*WORD_REG(si)], mm0)\n\t\tAS1(\tinc\t\tWORD_REG(si))\n\t\tAS2(\tcmp\t\tWORD_REG(si), 8)\n\t\tASJ(\tjne,\t0, b)\n\n\t\tAS2(\txor\t\tesi, esi)\n\t\tASL(1)\n\n#define KSL0(a, b)\tAS2(movq\tmm##a, b)\n#define KSL1(a, b)\tAS2(pxor\tmm##a, b)\n\n#define KSL(op, i, a, b, c, d)\t\\\n\tAS2(mov\t\teax, [SSE2_workspace+8*i])\\\n\tAS2(movzx\tedi, al)\\\n\tKSL##op(a, [AS_REG_6+3*2048+8*WORD_REG(di)])\\\n\tAS2(movzx\tedi, ah)\\\n\tKSL##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n\tAS2(shr\t\teax, 16)\\\n\tAS2(movzx\tedi, al)\\\n\tAS2(shr\t\teax, 8)\\\n\tKSL##op(c, [AS_REG_6+1*2048+8*WORD_REG(di)])\\\n\tKSL##op(d, [AS_REG_6+0*2048+8*WORD_REG(ax)])\n\n#define KSH0(a, b)\t\\\n\tASS(pshufw\tmm##a, mm##a, 1, 0, 3, 2)\\\n\tAS2(pxor\tmm##a, b)\n#define KSH1(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\n#define KSH2(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\\\n\tAS2(movq\t[SSE2_workspace+8*a], mm##a)\n\n#define KSH(op, i, a, b, c, d)\t\\\n\tAS2(mov\t\teax, [SSE2_workspace+8*((i+4)-8*((i+4)/8))+4])\\\n\tAS2(movzx\tedi, al)\\\n\tKSH##op(a, [AS_REG_6+3*2048+8*WORD_REG(di)])\\\n\tAS2(movzx\tedi, ah)\\\n\tKSH##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n\tAS2(shr\t\teax, 16)\\\n\tAS2(movzx\tedi, al)\\\n\tAS2(shr\t\teax, 8)\\\n\tKSH##op(c, [AS_REG_6+1*2048+8*WORD_REG(di)])\\\n\tKSH##op(d, [AS_REG_6+0*2048+8*WORD_REG(ax)])\n\n#define TSL(op, i, a, b, c, d)\t\\\n\tAS2(mov\t\teax, [SSE2_workspace+64+8*i])\\\n\tAS2(movzx\tedi, al)\\\n\tKSL##op(a, [AS_REG_6+3*2048+8*WORD_REG(di)])\\\n\tAS2(movzx\tedi, ah)\\\n\tKSL##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n\tAS2(shr\t\teax, 16)\\\n\tAS2(movzx\tedi, al)\\\n\tAS2(shr\t\teax, 8)\\\n\tKSL##op(c, [AS_REG_6+1*2048+8*WORD_REG(di)])\\\n\tKSL##op(d, [AS_REG_6+0*2048+8*WORD_REG(ax)])\n\n#define TSH0(a, b)\t\\\n\tASS(pshufw\tmm##a, mm##a, 1, 0, 3, 2)\\\n\tAS2(pxor\tmm##a, [SSE2_workspace+8*a])\\\n\tAS2(pxor\tmm##a, b)\n#define TSH1(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\n#define TSH2(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\\\n\tAS2(movq\t[SSE2_workspace+64+8*a], mm##a)\n#define TSH3(a, b)\t\\\n\tAS2(pxor\tmm##a, b)\\\n\tAS2(pxor\tmm##a, [WORD_REG(cx)+8*a])\\\n\tAS2(movq\t[WORD_REG(cx)+8*a], mm##a)\n\n#define TSH(op, i, a, b, c, d)\t\\\n\tAS2(mov\t\teax, [SSE2_workspace+64+8*((i+4)-8*((i+4)/8))+4])\\\n\tAS2(movzx\tedi, al)\\\n\tTSH##op(a, [AS_REG_6+3*2048+8*WORD_REG(di)])\\\n\tAS2(movzx\tedi, ah)\\\n\tTSH##op(b, [AS_REG_6+2*2048+8*WORD_REG(di)])\\\n\tAS2(shr\t\teax, 16)\\\n\tAS2(movzx\tedi, al)\\\n\tAS2(shr\t\teax, 8)\\\n\tTSH##op(c, [AS_REG_6+1*2048+8*WORD_REG(di)])\\\n\tTSH##op(d, [AS_REG_6+0*2048+8*WORD_REG(ax)])\n\n\t\tKSL(0, 4, 3, 2, 1, 0)\n\t\tKSL(0, 0, 7, 6, 5, 4)\n\t\tKSL(1, 1, 0, 7, 6, 5)\n\t\tKSL(1, 2, 1, 0, 7, 6)\n\t\tKSL(1, 3, 2, 1, 0, 7)\n\t\tKSL(1, 5, 4, 3, 2, 1)\n\t\tKSL(1, 6, 5, 4, 3, 2)\n\t\tKSL(1, 7, 6, 5, 4, 3)\n\t\tKSH(0, 0, 7, 6, 5, 4)\n\t\tKSH(0, 4, 3, 2, 1, 0)\n\t\tKSH(1, 1, 0, 7, 6, 5)\n\t\tKSH(1, 2, 1, 0, 7, 6)\n\t\tKSH(1, 5, 4, 3, 2, 1)\n\t\tKSH(1, 6, 5, 4, 3, 2)\n\t\tKSH(2, 3, 2, 1, 0, 7)\n\t\tKSH(2, 7, 6, 5, 4, 3)\n\n\t\tAS2(\tpxor\tmm0, [AS_REG_6 + 8*1024 + WORD_REG(si)*8])\n\t\tAS2(\tmovq\t[SSE2_workspace], mm0)\n\n\t\tTSL(0, 4, 3, 2, 1, 0)\n\t\tTSL(0, 0, 7, 6, 5, 4)\n\t\tTSL(1, 1, 0, 7, 6, 5)\n\t\tTSL(1, 2, 1, 0, 7, 6)\n\t\tTSL(1, 3, 2, 1, 0, 7)\n\t\tTSL(1, 5, 4, 3, 2, 1)\n\t\tTSL(1, 6, 5, 4, 3, 2)\n\t\tTSL(1, 7, 6, 5, 4, 3)\n\t\tTSH(0, 0, 7, 6, 5, 4)\n\t\tTSH(0, 4, 3, 2, 1, 0)\n\t\tTSH(1, 1, 0, 7, 6, 5)\n\t\tTSH(1, 2, 1, 0, 7, 6)\n\t\tTSH(1, 5, 4, 3, 2, 1)\n\t\tTSH(1, 6, 5, 4, 3, 2)\n\n\t\tAS1(\tinc\t\tWORD_REG(si))\n\t\tAS2(\tcmp\t\tWORD_REG(si), 10)\n\t\tASJ(\tje,\t\t2, f)\n\n\t\tTSH(2, 3, 2, 1, 0, 7)\n\t\tTSH(2, 7, 6, 5, 4, 3)\n\n\t\tASJ(\tjmp,\t1, b)\n\t\tASL(2)\n\n\t\tTSH(3, 3, 2, 1, 0, 7)\n\t\tTSH(3, 7, 6, 5, 4, 3)\n\n#undef KSL\n#undef KSH\n#undef TSL\n#undef TSH\n\n\t\tAS_POP_IF86(\tsp)\n\t\tAS1(\temms)\n\n#if defined(__GNUC__) || (defined(_MSC_VER) && _MSC_VER < 1300)\n\t\tAS_POP_IF86(\tbx)\n#endif\n#ifdef __GNUC__\n\t\t\".att_syntax prefix;\"\n\t\t\t:\n\t\t\t: \"a\" (Whirlpool_C), \"c\" (digest), \"d\" (block)\n\t#if CRYPTOPP_BOOL_X64\n\t\t\t, \"r\" (workspace)\n\t#endif\n\t\t\t: \"%esi\", \"%edi\", \"memory\", \"cc\"\n\t#if CRYPTOPP_BOOL_X64\n\t\t\t, \"%r9\"\n\t#endif\n\t\t);\n#endif\n\t}\n\telse\n#endif\t\t// #ifdef CRYPTOPP_X86_ASM_AVAILABLE\n\t{\n\tword64 s[8];\t// the cipher state\n\tword64 k[8];\t// the round key\n\n\t// Compute and apply K^0 to the cipher state\n\t// Also apply part of the Miyaguchi-Preneel compression function\n\tfor (int i=0; i<8; i++)\n\t\tdigest[i] = s[i] = block[i] ^ (k[i] = digest[i]);\n\n#define KSL(op, i, a, b, c, d)\t\\\n\tt = (word32)k[i];\\\n\tw##a = Whirlpool_C[3*256 + (byte)t] ^ (op ? w##a : 0);\\\n\tt >>= 8;\\\n\tw##b = Whirlpool_C[2*256 + (byte)t] ^ (op ? w##b : 0);\\\n\tt >>= 8;\\\n\tw##c = Whirlpool_C[1*256 + (byte)t] ^ (op ? w##c : 0);\\\n\tt >>= 8;\\\n\tw##d = Whirlpool_C[0*256 + t]       ^ (op ? w##d : 0);\n\n#define KSH(op, i, a, b, c, d)\t\\\n\tt = (word32)(k[(i+4)%8]>>32);\\\n\tw##a = Whirlpool_C[3*256 + (byte)t] ^ (op ? w##a : rotrFixed(w##a, 32));\\\n\tif (op==2) k[a] = w##a;\\\n\tt >>= 8;\\\n\tw##b = Whirlpool_C[2*256 + (byte)t] ^ (op ? w##b : rotrFixed(w##b, 32));\\\n\tif (op==2) k[b] = w##b;\\\n\tt >>= 8;\\\n\tw##c = Whirlpool_C[1*256 + (byte)t] ^ (op ? w##c : rotrFixed(w##c, 32));\\\n\tif (op==2) k[c] = w##c;\\\n\tt >>= 8;\\\n\tw##d = Whirlpool_C[0*256 + t]       ^ (op ? w##d : rotrFixed(w##d, 32));\\\n\tif (op==2) k[d] = w##d;\\\n\n#define TSL(op, i, a, b, c, d)\t\\\n\tt = (word32)s[i];\\\n\tw##a = Whirlpool_C[3*256 + (byte)t] ^ (op ? w##a : 0);\\\n\tt >>= 8;\\\n\tw##b = Whirlpool_C[2*256 + (byte)t] ^ (op ? w##b : 0);\\\n\tt >>= 8;\\\n\tw##c = Whirlpool_C[1*256 + (byte)t] ^ (op ? w##c : 0);\\\n\tt >>= 8;\\\n\tw##d = Whirlpool_C[0*256 + t]       ^ (op ? w##d : 0);\n\n#define TSH_OP(op, a, b)\t\\\n\tw##a = Whirlpool_C[b*256 + (byte)t] ^ (op ? w##a : rotrFixed(w##a, 32) ^ k[a]);\\\n\tif (op==2) s[a] = w##a;\\\n\tif (op==3) digest[a] ^= w##a;\\\n\n#define TSH(op, i, a, b, c, d)\t\\\n\tt = (word32)(s[(i+4)%8]>>32);\\\n\tTSH_OP(op, a, 3);\\\n\tt >>= 8;\\\n\tTSH_OP(op, b, 2);\\\n\tt >>= 8;\\\n\tTSH_OP(op, c, 1);\\\n\tt >>= 8;\\\n\tTSH_OP(op, d, 0);\\\n\n\t// Iterate over all rounds:\n\tint r=0;\n\twhile (true)\n\t{\n\t\tword64 w0, w1, w2, w3, w4, w5, w6, w7;\t// temporary storage\n\t\tword32 t;\n\n\t\tKSL(0, 4, 3, 2, 1, 0)\n\t\tKSL(0, 0, 7, 6, 5, 4)\n\t\tKSL(1, 1, 0, 7, 6, 5)\n\t\tKSL(1, 2, 1, 0, 7, 6)\n\t\tKSL(1, 3, 2, 1, 0, 7)\n\t\tKSL(1, 5, 4, 3, 2, 1)\n\t\tKSL(1, 6, 5, 4, 3, 2)\n\t\tKSL(1, 7, 6, 5, 4, 3)\n\t\tKSH(0, 0, 7, 6, 5, 4)\n\t\tKSH(0, 4, 3, 2, 1, 0)\n\t\tKSH(1, 1, 0, 7, 6, 5)\n\t\tKSH(1, 2, 1, 0, 7, 6)\n\t\tKSH(1, 5, 4, 3, 2, 1)\n\t\tKSH(1, 6, 5, 4, 3, 2)\n\t\tKSH(2, 3, 2, 1, 0, 7)\n\t\tKSH(2, 7, 6, 5, 4, 3)\n\n\t\tk[0] ^= Whirlpool_C[1024+r];\n\n\t\tTSL(0, 4, 3, 2, 1, 0)\n\t\tTSL(0, 0, 7, 6, 5, 4)\n\t\tTSL(1, 1, 0, 7, 6, 5)\n\t\tTSL(1, 2, 1, 0, 7, 6)\n\t\tTSL(1, 3, 2, 1, 0, 7)\n\t\tTSL(1, 5, 4, 3, 2, 1)\n\t\tTSL(1, 6, 5, 4, 3, 2)\n\t\tTSL(1, 7, 6, 5, 4, 3)\n\t\tTSH(0, 0, 7, 6, 5, 4)\n\t\tTSH(0, 4, 3, 2, 1, 0)\n\t\tTSH(1, 1, 0, 7, 6, 5)\n\t\tTSH(1, 2, 1, 0, 7, 6)\n\t\tTSH(1, 5, 4, 3, 2, 1)\n\t\tTSH(1, 6, 5, 4, 3, 2)\n\n\t\tif (++r < R)\n\t\t{\n\t\t\tTSH(2, 3, 2, 1, 0, 7)\n\t\t\tTSH(2, 7, 6, 5, 4, 3)\n\t\t}\n\t\telse\n\t\t{\n\t\t\tTSH(3, 3, 2, 1, 0, 7)\n\t\t\tTSH(3, 7, 6, 5, 4, 3)\n\t\t\tbreak;\n\t\t}\n\t}\n\t}\n}"
  },
  {
    "function_name": "Whirlpool::TruncatedFinal",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/whrlpool.cpp",
    "lines": "83-100",
    "snippet": "void Whirlpool::TruncatedFinal(byte *hash, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tPadLastBlock(32);\n\tCorrectEndianess(m_data, m_data, 32);\n\n\tm_data[m_data.size()-4] = 0;\n\tm_data[m_data.size()-3] = 0;\n\tm_data[m_data.size()-2] = GetBitCountHi();\n\tm_data[m_data.size()-1] = GetBitCountLo();\n\n\tTransform(m_state, m_data);\n\tCorrectEndianess(m_state, m_state, DigestSize());\n\tmemcpy(hash, m_state, size);\n\n\tRestart();\t\t// reinit for next use\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"misc.h\"",
      "#include \"whrlpool.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Restart",
          "args": [],
          "line": 99
        },
        "resolved": true,
        "details": {
          "function_name": "IteratedHashBase<T, BASE>::Restart",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.cpp",
          "lines": "120-124",
          "snippet": "void IteratedHashBase<T, BASE>::Restart()\n{\n\tm_countLo = m_countHi = 0;\n\tInit();\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"iterhash.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"iterhash.h\"\n\nvoid IteratedHashBase<T, BASE>::Restart()\n{\n\tm_countLo = m_countHi = 0;\n\tInit();\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "hash",
            "m_state",
            "size"
          ],
          "line": 97
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CorrectEndianess",
          "args": [
            "m_state",
            "m_state",
            "DigestSize()"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DigestSize",
          "args": [],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Transform",
          "args": [
            "m_state",
            "m_data"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "MD4::Transform",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/md4.cpp",
          "lines": "33-107",
          "snippet": "void MD4::Transform (word32 *digest, const word32 *in)\n{\n// #define F(x, y, z) (((x) & (y)) | ((~x) & (z)))\n#define F(x, y, z) ((z) ^ ((x) & ((y) ^ (z))))\n#define G(x, y, z) (((x) & (y)) | ((x) & (z)) | ((y) & (z)))\n#define H(x, y, z) ((x) ^ (y) ^ (z))\n\n    word32 A, B, C, D;\n\n\tA=digest[0];\n\tB=digest[1];\n\tC=digest[2];\n\tD=digest[3];\n\n#define function(a,b,c,d,k,s) a=rotlFixed(a+F(b,c,d)+in[k],s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 1, 7);\n\t  function(C,D,A,B, 2,11);\n\t  function(B,C,D,A, 3,19);\n\t  function(A,B,C,D, 4, 3);\n\t  function(D,A,B,C, 5, 7);\n\t  function(C,D,A,B, 6,11);\n\t  function(B,C,D,A, 7,19);\n\t  function(A,B,C,D, 8, 3);\n\t  function(D,A,B,C, 9, 7);\n\t  function(C,D,A,B,10,11);\n\t  function(B,C,D,A,11,19);\n\t  function(A,B,C,D,12, 3);\n\t  function(D,A,B,C,13, 7);\n\t  function(C,D,A,B,14,11);\n\t  function(B,C,D,A,15,19);\n\n#undef function\t  \n#define function(a,b,c,d,k,s) a=rotlFixed(a+G(b,c,d)+in[k]+0x5a827999,s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 4, 5);\n\t  function(C,D,A,B, 8, 9);\n\t  function(B,C,D,A,12,13);\n\t  function(A,B,C,D, 1, 3);\n\t  function(D,A,B,C, 5, 5);\n\t  function(C,D,A,B, 9, 9);\n\t  function(B,C,D,A,13,13);\n\t  function(A,B,C,D, 2, 3);\n\t  function(D,A,B,C, 6, 5);\n\t  function(C,D,A,B,10, 9);\n\t  function(B,C,D,A,14,13);\n\t  function(A,B,C,D, 3, 3);\n\t  function(D,A,B,C, 7, 5);\n\t  function(C,D,A,B,11, 9);\n\t  function(B,C,D,A,15,13);\n\n#undef function\t \n#define function(a,b,c,d,k,s) a=rotlFixed(a+H(b,c,d)+in[k]+0x6ed9eba1,s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 8, 9);\n\t  function(C,D,A,B, 4,11);\n\t  function(B,C,D,A,12,15);\n\t  function(A,B,C,D, 2, 3);\n\t  function(D,A,B,C,10, 9);\n\t  function(C,D,A,B, 6,11);\n\t  function(B,C,D,A,14,15);\n\t  function(A,B,C,D, 1, 3);\n\t  function(D,A,B,C, 9, 9);\n\t  function(C,D,A,B, 5,11);\n\t  function(B,C,D,A,13,15);\n\t  function(A,B,C,D, 3, 3);\n\t  function(D,A,B,C,11, 9);\n\t  function(C,D,A,B, 7,11);\n\t  function(B,C,D,A,15,15);\n\n\tdigest[0]+=A;\n\tdigest[1]+=B;\n\tdigest[2]+=C;\n\tdigest[3]+=D;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"md4.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"md4.h\"\n#include \"pch.h\"\n\nvoid MD4::Transform (word32 *digest, const word32 *in)\n{\n// #define F(x, y, z) (((x) & (y)) | ((~x) & (z)))\n#define F(x, y, z) ((z) ^ ((x) & ((y) ^ (z))))\n#define G(x, y, z) (((x) & (y)) | ((x) & (z)) | ((y) & (z)))\n#define H(x, y, z) ((x) ^ (y) ^ (z))\n\n    word32 A, B, C, D;\n\n\tA=digest[0];\n\tB=digest[1];\n\tC=digest[2];\n\tD=digest[3];\n\n#define function(a,b,c,d,k,s) a=rotlFixed(a+F(b,c,d)+in[k],s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 1, 7);\n\t  function(C,D,A,B, 2,11);\n\t  function(B,C,D,A, 3,19);\n\t  function(A,B,C,D, 4, 3);\n\t  function(D,A,B,C, 5, 7);\n\t  function(C,D,A,B, 6,11);\n\t  function(B,C,D,A, 7,19);\n\t  function(A,B,C,D, 8, 3);\n\t  function(D,A,B,C, 9, 7);\n\t  function(C,D,A,B,10,11);\n\t  function(B,C,D,A,11,19);\n\t  function(A,B,C,D,12, 3);\n\t  function(D,A,B,C,13, 7);\n\t  function(C,D,A,B,14,11);\n\t  function(B,C,D,A,15,19);\n\n#undef function\t  \n#define function(a,b,c,d,k,s) a=rotlFixed(a+G(b,c,d)+in[k]+0x5a827999,s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 4, 5);\n\t  function(C,D,A,B, 8, 9);\n\t  function(B,C,D,A,12,13);\n\t  function(A,B,C,D, 1, 3);\n\t  function(D,A,B,C, 5, 5);\n\t  function(C,D,A,B, 9, 9);\n\t  function(B,C,D,A,13,13);\n\t  function(A,B,C,D, 2, 3);\n\t  function(D,A,B,C, 6, 5);\n\t  function(C,D,A,B,10, 9);\n\t  function(B,C,D,A,14,13);\n\t  function(A,B,C,D, 3, 3);\n\t  function(D,A,B,C, 7, 5);\n\t  function(C,D,A,B,11, 9);\n\t  function(B,C,D,A,15,13);\n\n#undef function\t \n#define function(a,b,c,d,k,s) a=rotlFixed(a+H(b,c,d)+in[k]+0x6ed9eba1,s);\t \n\t  function(A,B,C,D, 0, 3);\n\t  function(D,A,B,C, 8, 9);\n\t  function(C,D,A,B, 4,11);\n\t  function(B,C,D,A,12,15);\n\t  function(A,B,C,D, 2, 3);\n\t  function(D,A,B,C,10, 9);\n\t  function(C,D,A,B, 6,11);\n\t  function(B,C,D,A,14,15);\n\t  function(A,B,C,D, 1, 3);\n\t  function(D,A,B,C, 9, 9);\n\t  function(C,D,A,B, 5,11);\n\t  function(B,C,D,A,13,15);\n\t  function(A,B,C,D, 3, 3);\n\t  function(D,A,B,C,11, 9);\n\t  function(C,D,A,B, 7,11);\n\t  function(B,C,D,A,15,15);\n\n\tdigest[0]+=A;\n\tdigest[1]+=B;\n\tdigest[2]+=C;\n\tdigest[3]+=D;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetBitCountLo",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "GetBitCountLo",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/iterhash.h",
          "lines": "36-36",
          "snippet": "inline T GetBitCountLo() const {return m_countLo << 3;}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\ninline T GetBitCountLo() const {return m_countLo << 3;}"
        }
      },
      {
        "call_info": {
          "callee": "m_data.size",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetBitCountHi",
          "args": [],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CorrectEndianess",
          "args": [
            "m_data",
            "m_data",
            "32"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PadLastBlock",
          "args": [
            "32"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ThrowIfInvalidTruncatedSize",
          "args": [
            "size"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "HashTransformation::ThrowIfInvalidTruncatedSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "309-313",
          "snippet": "void HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nvoid HashTransformation::ThrowIfInvalidTruncatedSize(size_t size) const\n{\n\tif (size > DigestSize())\n\t\tthrow InvalidArgument(\"HashTransformation: can't truncate a \" + IntToString(DigestSize()) + \" byte digest to \" + IntToString(size) + \" bytes\");\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"misc.h\"\n#include \"whrlpool.h\"\n#include \"pch.h\"\n\nvoid Whirlpool::TruncatedFinal(byte *hash, size_t size)\n{\n\tThrowIfInvalidTruncatedSize(size);\n\n\tPadLastBlock(32);\n\tCorrectEndianess(m_data, m_data, 32);\n\n\tm_data[m_data.size()-4] = 0;\n\tm_data[m_data.size()-3] = 0;\n\tm_data[m_data.size()-2] = GetBitCountHi();\n\tm_data[m_data.size()-1] = GetBitCountLo();\n\n\tTransform(m_state, m_data);\n\tCorrectEndianess(m_state, m_state, DigestSize());\n\tmemcpy(hash, m_state, size);\n\n\tRestart();\t\t// reinit for next use\n}"
  },
  {
    "function_name": "Whirlpool::InitState",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/whrlpool.cpp",
    "lines": "78-81",
    "snippet": "void Whirlpool::InitState(HashWordType *state)\n{\n\tmemset(state, 0, 8*sizeof(state[0]));\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"misc.h\"",
      "#include \"whrlpool.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "state",
            "0",
            "8*sizeof(state[0])"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"misc.h\"\n#include \"whrlpool.h\"\n#include \"pch.h\"\n\nvoid Whirlpool::InitState(HashWordType *state)\n{\n\tmemset(state, 0, 8*sizeof(state[0]));\n}"
  },
  {
    "function_name": "Whirlpool_TestInstantiations",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/whrlpool.cpp",
    "lines": "73-76",
    "snippet": "void Whirlpool_TestInstantiations()\n{\n\tWhirlpool x;\n}",
    "includes": [
      "#include \"cpu.h\"",
      "#include \"misc.h\"",
      "#include \"whrlpool.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"cpu.h\"\n#include \"misc.h\"\n#include \"whrlpool.h\"\n#include \"pch.h\"\n\nvoid Whirlpool_TestInstantiations()\n{\n\tWhirlpool x;\n}"
  }
]