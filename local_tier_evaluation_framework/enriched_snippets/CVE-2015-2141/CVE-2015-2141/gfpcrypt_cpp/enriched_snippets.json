[
  {
    "function_name": "DL_GroupParameters_IntegerBased::GetDefaultSubgroupOrderSize",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "266-269",
    "snippet": "unsigned int DL_GroupParameters_IntegerBased::GetDefaultSubgroupOrderSize(unsigned int modulusSize) const\n{\n\treturn 2*DiscreteLogWorkFactor(GetFieldType()*modulusSize);\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DiscreteLogWorkFactor",
          "args": [
            "GetFieldType()*modulusSize"
          ],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "DiscreteLogWorkFactor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.cpp",
          "lines": "1027-1032",
          "snippet": "unsigned int DiscreteLogWorkFactor(unsigned int n)\n{\n\t// assuming discrete log takes about the same time as factoring\n\tif (n<5) return 0;\n\telse return (unsigned int)(2.4 * pow((double)n, 1.0/3.0) * pow(log(double(n)), 2.0/3.0) - 5);\n}",
          "includes": [
            "#include <omp.h>",
            "#include <vector>",
            "#include <math.h>",
            "#include \"algparam.h\"",
            "#include \"modarith.h\"",
            "#include \"nbtheory.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <omp.h>\n#include <vector>\n#include <math.h>\n#include \"algparam.h\"\n#include \"modarith.h\"\n#include \"nbtheory.h\"\n#include \"pch.h\"\n\nunsigned int DiscreteLogWorkFactor(unsigned int n)\n{\n\t// assuming discrete log takes about the same time as factoring\n\tif (n<5) return 0;\n\telse return (unsigned int)(2.4 * pow((double)n, 1.0/3.0) * pow(log(double(n)), 2.0/3.0) - 5);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetFieldType",
          "args": [],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "GetFieldType",
          "container": "DL_GroupParameters_LUC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/luc.h",
          "lines": "168-168",
          "snippet": "int GetFieldType() const {return 2;}",
          "includes": [
            "#include <limits.h>",
            "#include \"dh.h\"",
            "#include \"integer.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"dh.h\"\n#include \"integer.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n\nDL_GroupParameters_LUC {\n  int GetFieldType() const {return 2;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nunsigned int DL_GroupParameters_IntegerBased::GetDefaultSubgroupOrderSize(unsigned int modulusSize) const\n{\n\treturn 2*DiscreteLogWorkFactor(GetFieldType()*modulusSize);\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::GetMaxExponent",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "261-264",
    "snippet": "Integer DL_GroupParameters_IntegerBased::GetMaxExponent() const\n{\n\treturn STDMIN(GetSubgroupOrder()-1, Integer::Power2(2*DiscreteLogWorkFactor(GetFieldType()*GetModulus().BitCount())));\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "STDMIN",
          "args": [
            "GetSubgroupOrder()-1",
            "Integer::Power2(2*DiscreteLogWorkFactor(GetFieldType()*GetModulus().BitCount()))"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Integer::Power2",
          "args": [
            "2*DiscreteLogWorkFactor(GetFieldType()*GetModulus().BitCount())"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "Integer::Power2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "2846-2851",
          "snippet": "Integer Integer::Power2(size_t e)\n{\n\tInteger r((word)0, BitsToWords(e+1));\n\tr.SetBit(e);\n\treturn r;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger Integer::Power2(size_t e)\n{\n\tInteger r((word)0, BitsToWords(e+1));\n\tr.SetBit(e);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "DiscreteLogWorkFactor",
          "args": [
            "GetFieldType()*GetModulus().BitCount()"
          ],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "DiscreteLogWorkFactor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.cpp",
          "lines": "1027-1032",
          "snippet": "unsigned int DiscreteLogWorkFactor(unsigned int n)\n{\n\t// assuming discrete log takes about the same time as factoring\n\tif (n<5) return 0;\n\telse return (unsigned int)(2.4 * pow((double)n, 1.0/3.0) * pow(log(double(n)), 2.0/3.0) - 5);\n}",
          "includes": [
            "#include <omp.h>",
            "#include <vector>",
            "#include <math.h>",
            "#include \"algparam.h\"",
            "#include \"modarith.h\"",
            "#include \"nbtheory.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <omp.h>\n#include <vector>\n#include <math.h>\n#include \"algparam.h\"\n#include \"modarith.h\"\n#include \"nbtheory.h\"\n#include \"pch.h\"\n\nunsigned int DiscreteLogWorkFactor(unsigned int n)\n{\n\t// assuming discrete log takes about the same time as factoring\n\tif (n<5) return 0;\n\telse return (unsigned int)(2.4 * pow((double)n, 1.0/3.0) * pow(log(double(n)), 2.0/3.0) - 5);\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetFieldType",
          "args": [],
          "line": 263
        },
        "resolved": true,
        "details": {
          "function_name": "GetFieldType",
          "container": "DL_GroupParameters_LUC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/luc.h",
          "lines": "168-168",
          "snippet": "int GetFieldType() const {return 2;}",
          "includes": [
            "#include <limits.h>",
            "#include \"dh.h\"",
            "#include \"integer.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"dh.h\"\n#include \"integer.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n\nDL_GroupParameters_LUC {\n  int GetFieldType() const {return 2;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetSubgroupOrder",
          "args": [],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nInteger DL_GroupParameters_IntegerBased::GetMaxExponent() const\n{\n\treturn STDMIN(GetSubgroupOrder()-1, Integer::Power2(2*DiscreteLogWorkFactor(GetFieldType()*GetModulus().BitCount())));\n}"
  },
  {
    "function_name": "DL_GroupParameters_GFP::CascadeExponentiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "255-259",
    "snippet": "DL_GroupParameters_GFP::Element DL_GroupParameters_GFP::CascadeExponentiate(const Element &element1, const Integer &exponent1, const Element &element2, const Integer &exponent2) const\n{\n\tModularArithmetic ma(GetModulus());\n\treturn ma.CascadeExponentiate(element1, exponent1, element2, exponent2);\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ma.CascadeExponentiate",
          "args": [
            "element1",
            "exponent1",
            "element2",
            "exponent2"
          ],
          "line": 258
        },
        "resolved": true,
        "details": {
          "function_name": "CascadeExponentiate",
          "container": "DL_GroupParameters_LUC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/luc.h",
          "lines": "158-159",
          "snippet": "Element CascadeExponentiate(const Element &element1, const Integer &exponent1, const Element &element2, const Integer &exponent2) const\n\t\t{throw NotImplemented(\"LUC_GroupParameters: MultiplyElements can not be implemented\");}",
          "includes": [
            "#include <limits.h>",
            "#include \"dh.h\"",
            "#include \"integer.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"dh.h\"\n#include \"integer.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n\nDL_GroupParameters_LUC {\n  Element CascadeExponentiate(const Element &element1, const Integer &exponent1, const Element &element2, const Integer &exponent2) const\n  \t\t{throw NotImplemented(\"LUC_GroupParameters: MultiplyElements can not be implemented\");}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nDL_GroupParameters_GFP::Element DL_GroupParameters_GFP::CascadeExponentiate(const Element &element1, const Integer &exponent1, const Element &element2, const Integer &exponent2) const\n{\n\tModularArithmetic ma(GetModulus());\n\treturn ma.CascadeExponentiate(element1, exponent1, element2, exponent2);\n}"
  },
  {
    "function_name": "DL_GroupParameters_GFP::MultiplyElements",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "250-253",
    "snippet": "DL_GroupParameters_GFP::Element DL_GroupParameters_GFP::MultiplyElements(const Element &a, const Element &b) const\n{\n\treturn a_times_b_mod_c(a, b, GetModulus());\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "a_times_b_mod_c",
          "args": [
            "a",
            "b",
            "GetModulus()"
          ],
          "line": 252
        },
        "resolved": true,
        "details": {
          "function_name": "a_times_b_mod_c",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3942-3945",
          "snippet": "Integer a_times_b_mod_c(const Integer &x, const Integer& y, const Integer& m)\n{\n\treturn x*y%m;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger a_times_b_mod_c(const Integer &x, const Integer& y, const Integer& m)\n{\n\treturn x*y%m;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nDL_GroupParameters_GFP::Element DL_GroupParameters_GFP::MultiplyElements(const Element &a, const Element &b) const\n{\n\treturn a_times_b_mod_c(a, b, GetModulus());\n}"
  },
  {
    "function_name": "DL_GroupParameters_GFP::SimultaneousExponentiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "244-248",
    "snippet": "void DL_GroupParameters_GFP::SimultaneousExponentiate(Element *results, const Element &base, const Integer *exponents, unsigned int exponentsCount) const\n{\n\tModularArithmetic ma(GetModulus());\n\tma.SimultaneousExponentiate(results, base, exponents, exponentsCount);\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ma.SimultaneousExponentiate",
          "args": [
            "results",
            "base",
            "exponents",
            "exponentsCount"
          ],
          "line": 247
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid DL_GroupParameters_GFP::SimultaneousExponentiate(Element *results, const Element &base, const Integer *exponents, unsigned int exponentsCount) const\n{\n\tModularArithmetic ma(GetModulus());\n\tma.SimultaneousExponentiate(results, base, exponents, exponentsCount);\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::GetAlgorithmID",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "239-242",
    "snippet": "OID DL_GroupParameters_IntegerBased::GetAlgorithmID() const\n{\n\treturn ASN1::id_dsa();\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASN1::id_dsa",
          "args": [],
          "line": 241
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nOID DL_GroupParameters_IntegerBased::GetAlgorithmID() const\n{\n\treturn ASN1::id_dsa();\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::AssignFrom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "231-237",
    "snippet": "void DL_GroupParameters_IntegerBased::AssignFrom(const NameValuePairs &source)\n{\n\tAssignFromHelper(this, source)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY2(Modulus, SubgroupGenerator)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(SubgroupOrder)\n\t\t;\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY",
          "args": [
            "SubgroupOrder"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CRYPTOPP_SET_FUNCTION_ENTRY2",
          "args": [
            "Modulus",
            "SubgroupGenerator"
          ],
          "line": 234
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssignFromHelper",
          "args": [
            "this",
            "source"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "AssignFromHelper",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algparam.h",
          "lines": "235-238",
          "snippet": "AssignFromHelperClass<T, T> AssignFromHelper(T *pObject, const NameValuePairs &source)\n{\n\treturn AssignFromHelperClass<T, T>(pObject, source);\n}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nAssignFromHelperClass<T, T> AssignFromHelper(T *pObject, const NameValuePairs &source)\n{\n\treturn AssignFromHelperClass<T, T>(pObject, source);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid DL_GroupParameters_IntegerBased::AssignFrom(const NameValuePairs &source)\n{\n\tAssignFromHelper(this, source)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY2(Modulus, SubgroupGenerator)\n\t\tCRYPTOPP_SET_FUNCTION_ENTRY(SubgroupOrder)\n\t\t;\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::GetVoidValue",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "225-229",
    "snippet": "bool DL_GroupParameters_IntegerBased::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\treturn GetValueHelper<DL_GroupParameters<Element> >(this, name, valueType, pValue)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Modulus);\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CRYPTOPP_GET_FUNCTION_ENTRY",
          "args": [
            "Modulus"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetValueHelper<DL_GroupParameters<Element> >",
          "args": [
            "this",
            "name",
            "valueType",
            "pValue"
          ],
          "line": 227
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nbool DL_GroupParameters_IntegerBased::GetVoidValue(const char *name, const std::type_info &valueType, void *pValue) const\n{\n\treturn GetValueHelper<DL_GroupParameters<Element> >(this, name, valueType, pValue)\n\t\tCRYPTOPP_GET_FUNCTION_ENTRY(Modulus);\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::DEREncode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "216-223",
    "snippet": "void DL_GroupParameters_IntegerBased::DEREncode(BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder parameters(bt);\n\t\tGetModulus().DEREncode(parameters);\n\t\tm_q.DEREncode(parameters);\n\t\tGetSubgroupGenerator().DEREncode(parameters);\n\tparameters.MessageEnd();\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parameters.MessageEnd",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "GetSubgroupGenerator",
          "args": [
            "parameters"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSubgroupGenerator",
          "args": [],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_q.DEREncode",
          "args": [
            "parameters"
          ],
          "line": 220
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "67-68",
          "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [
            "parameters"
          ],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 219
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid DL_GroupParameters_IntegerBased::DEREncode(BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder parameters(bt);\n\t\tGetModulus().DEREncode(parameters);\n\t\tm_q.DEREncode(parameters);\n\t\tGetSubgroupGenerator().DEREncode(parameters);\n\tparameters.MessageEnd();\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::BERDecode",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "197-214",
    "snippet": "void DL_GroupParameters_IntegerBased::BERDecode(BufferedTransformation &bt)\n{\n\tBERSequenceDecoder parameters(bt);\n\t\tInteger p(parameters);\n\t\tInteger q(parameters);\n\t\tInteger g;\n\t\tif (parameters.EndReached())\n\t\t{\n\t\t\tg = q;\n\t\t\tq = ComputeGroupOrder(p) / 2;\n\t\t}\n\t\telse\n\t\t\tg.BERDecode(parameters);\n\tparameters.MessageEnd();\n\n\tSetModulusAndSubgroupGenerator(p, g);\n\tSetSubgroupOrder(q);\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetSubgroupOrder",
          "args": [
            "q"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "SetSubgroupOrder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "67-68",
          "snippet": "void SetSubgroupOrder(const Integer &q)\n\t\t{m_q = q; ParametersChanged();}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nvoid SetSubgroupOrder(const Integer &q)\n\t\t{m_q = q; ParametersChanged();}"
        }
      },
      {
        "call_info": {
          "callee": "SetModulusAndSubgroupGenerator",
          "args": [
            "p",
            "g"
          ],
          "line": 212
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.MessageEnd",
          "args": [],
          "line": 210
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "g.BERDecode",
          "args": [
            "parameters"
          ],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "BERDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "65-66",
          "snippet": "void BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "ComputeGroupOrder",
          "args": [
            "p"
          ],
          "line": 206
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parameters.EndReached",
          "args": [],
          "line": 203
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid DL_GroupParameters_IntegerBased::BERDecode(BufferedTransformation &bt)\n{\n\tBERSequenceDecoder parameters(bt);\n\t\tInteger p(parameters);\n\t\tInteger q(parameters);\n\t\tInteger g;\n\t\tif (parameters.EndReached())\n\t\t{\n\t\t\tg = q;\n\t\t\tq = ComputeGroupOrder(p) / 2;\n\t\t}\n\t\telse\n\t\t\tg.BERDecode(parameters);\n\tparameters.MessageEnd();\n\n\tSetModulusAndSubgroupGenerator(p, g);\n\tSetSubgroupOrder(q);\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::DecodeElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "189-195",
    "snippet": "Integer DL_GroupParameters_IntegerBased::DecodeElement(const byte *encoded, bool checkForGroupMembership) const\n{\n\tInteger g(encoded, GetModulus().ByteCount());\n\tif (!ValidateElement(1, g, NULL))\n\t\tthrow DL_BadElement();\n\treturn g;\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DL_BadElement",
          "args": [],
          "line": 193
        },
        "resolved": true,
        "details": {
          "function_name": "DL_BadElement",
          "container": "DL_BadElement",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "516-516",
          "snippet": "DL_BadElement() : InvalidDataFormat(\"CryptoPP: invalid group element\") {}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nDL_BadElement {\n  DL_BadElement() : InvalidDataFormat(\"CryptoPP: invalid group element\") {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ValidateElement",
          "args": [
            "1",
            "g",
            "NULL"
          ],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "DL_GroupParameters_IntegerBased::ValidateElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
          "lines": "127-159",
          "snippet": "bool DL_GroupParameters_IntegerBased::ValidateElement(unsigned int level, const Integer &g, const DL_FixedBasePrecomputation<Integer> *gpc) const\n{\n\tconst Integer &p = GetModulus(), &q = GetSubgroupOrder();\n\n\tbool pass = true;\n\tpass = pass && GetFieldType() == 1 ? g.IsPositive() : g.NotNegative();\n\tpass = pass && g < p && !IsIdentity(g);\n\n\tif (level >= 1)\n\t{\n\t\tif (gpc)\n\t\t\tpass = pass && gpc->Exponentiate(GetGroupPrecomputation(), Integer::One()) == g;\n\t}\n\tif (level >= 2)\n\t{\n\t\tif (GetFieldType() == 2)\n\t\t\tpass = pass && Jacobi(g*g-4, p)==-1;\n\n\t\t// verifying that Lucas((p+1)/2, w, p)==2 is omitted because it's too costly\n\t\t// and at most 1 bit is leaked if it's false\n\t\tbool fullValidate = (GetFieldType() == 2 && level >= 3) || !FastSubgroupCheckAvailable();\n\n\t\tif (fullValidate && pass)\n\t\t{\n\t\t\tInteger gp = gpc ? gpc->Exponentiate(GetGroupPrecomputation(), q) : ExponentiateElement(g, q);\n\t\t\tpass = pass && IsIdentity(gp);\n\t\t}\n\t\telse if (GetFieldType() == 1)\n\t\t\tpass = pass && Jacobi(g, p) == 1;\n\t}\n\n\treturn pass;\n}",
          "includes": [
            "#include \"nbtheory.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"gfpcrypt.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nbool DL_GroupParameters_IntegerBased::ValidateElement(unsigned int level, const Integer &g, const DL_FixedBasePrecomputation<Integer> *gpc) const\n{\n\tconst Integer &p = GetModulus(), &q = GetSubgroupOrder();\n\n\tbool pass = true;\n\tpass = pass && GetFieldType() == 1 ? g.IsPositive() : g.NotNegative();\n\tpass = pass && g < p && !IsIdentity(g);\n\n\tif (level >= 1)\n\t{\n\t\tif (gpc)\n\t\t\tpass = pass && gpc->Exponentiate(GetGroupPrecomputation(), Integer::One()) == g;\n\t}\n\tif (level >= 2)\n\t{\n\t\tif (GetFieldType() == 2)\n\t\t\tpass = pass && Jacobi(g*g-4, p)==-1;\n\n\t\t// verifying that Lucas((p+1)/2, w, p)==2 is omitted because it's too costly\n\t\t// and at most 1 bit is leaked if it's false\n\t\tbool fullValidate = (GetFieldType() == 2 && level >= 3) || !FastSubgroupCheckAvailable();\n\n\t\tif (fullValidate && pass)\n\t\t{\n\t\t\tInteger gp = gpc ? gpc->Exponentiate(GetGroupPrecomputation(), q) : ExponentiateElement(g, q);\n\t\t\tpass = pass && IsIdentity(gp);\n\t\t}\n\t\telse if (GetFieldType() == 1)\n\t\t\tpass = pass && Jacobi(g, p) == 1;\n\t}\n\n\treturn pass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 191
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nInteger DL_GroupParameters_IntegerBased::DecodeElement(const byte *encoded, bool checkForGroupMembership) const\n{\n\tInteger g(encoded, GetModulus().ByteCount());\n\tif (!ValidateElement(1, g, NULL))\n\t\tthrow DL_BadElement();\n\treturn g;\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::GenerateRandom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "161-187",
    "snippet": "void DL_GroupParameters_IntegerBased::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tInteger p, q, g;\n\t\n\tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n\t{\n\t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n\t}\n\telse\n\t{\n\t\tint modulusSize, subgroupOrderSize;\n\n\t\tif (!alg.GetIntValue(\"ModulusSize\", modulusSize))\n\t\t\tmodulusSize = alg.GetIntValueWithDefault(\"KeySize\", 2048);\n\n\t\tif (!alg.GetIntValue(\"SubgroupOrderSize\", subgroupOrderSize))\n\t\t\tsubgroupOrderSize = GetDefaultSubgroupOrderSize(modulusSize);\n\n\t\tPrimeAndGenerator pg;\n\t\tpg.Generate(GetFieldType() == 1 ? 1 : -1, rng, modulusSize, subgroupOrderSize);\n\t\tp = pg.Prime();\n\t\tq = pg.SubPrime();\n\t\tg = pg.Generator();\n\t}\n\n\tInitialize(p, q, g);\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Initialize",
          "args": [
            "p",
            "q",
            "g"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "Initialize",
          "container": "DL_PrivateKey_GFP",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "241-242",
          "snippet": "void Initialize(const Integer &p, const Integer &g, const Integer &x)\n\t\t{this->AccessGroupParameters().Initialize(p, g); this->SetPrivateExponent(x);}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP {\n  void Initialize(const Integer &p, const Integer &g, const Integer &x)\n  \t\t{this->AccessGroupParameters().Initialize(p, g); this->SetPrivateExponent(x);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "pg.Generator",
          "args": [],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg.SubPrime",
          "args": [],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg.Prime",
          "args": [],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pg.Generate",
          "args": [
            "GetFieldType() == 1 ? 1 : -1",
            "rng",
            "modulusSize",
            "subgroupOrderSize"
          ],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetFieldType",
          "args": [],
          "line": 180
        },
        "resolved": true,
        "details": {
          "function_name": "GetFieldType",
          "container": "DL_GroupParameters_LUC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/luc.h",
          "lines": "168-168",
          "snippet": "int GetFieldType() const {return 2;}",
          "includes": [
            "#include <limits.h>",
            "#include \"dh.h\"",
            "#include \"integer.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"dh.h\"\n#include \"integer.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n\nDL_GroupParameters_LUC {\n  int GetFieldType() const {return 2;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetDefaultSubgroupOrderSize",
          "args": [
            "modulusSize"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "DL_GroupParameters_IntegerBased::GetDefaultSubgroupOrderSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
          "lines": "266-269",
          "snippet": "unsigned int DL_GroupParameters_IntegerBased::GetDefaultSubgroupOrderSize(unsigned int modulusSize) const\n{\n\treturn 2*DiscreteLogWorkFactor(GetFieldType()*modulusSize);\n}",
          "includes": [
            "#include \"nbtheory.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"gfpcrypt.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nunsigned int DL_GroupParameters_IntegerBased::GetDefaultSubgroupOrderSize(unsigned int modulusSize) const\n{\n\treturn 2*DiscreteLogWorkFactor(GetFieldType()*modulusSize);\n}"
        }
      },
      {
        "call_info": {
          "callee": "alg.GetIntValue",
          "args": [
            "\"SubgroupOrderSize\"",
            "subgroupOrderSize"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetIntValueWithDefault",
          "args": [
            "\"KeySize\"",
            "2048"
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetIntValue",
          "args": [
            "\"ModulusSize\"",
            "modulusSize"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetValueWithDefault",
          "args": [
            "\"SubgroupOrder\"",
            "ComputeGroupOrder(p)/2"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ComputeGroupOrder",
          "args": [
            "p"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetValue",
          "args": [
            "\"SubgroupGenerator\"",
            "g"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetValue",
          "args": [
            "\"Modulus\"",
            "p"
          ],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid DL_GroupParameters_IntegerBased::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tInteger p, q, g;\n\t\n\tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n\t{\n\t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n\t}\n\telse\n\t{\n\t\tint modulusSize, subgroupOrderSize;\n\n\t\tif (!alg.GetIntValue(\"ModulusSize\", modulusSize))\n\t\t\tmodulusSize = alg.GetIntValueWithDefault(\"KeySize\", 2048);\n\n\t\tif (!alg.GetIntValue(\"SubgroupOrderSize\", subgroupOrderSize))\n\t\t\tsubgroupOrderSize = GetDefaultSubgroupOrderSize(modulusSize);\n\n\t\tPrimeAndGenerator pg;\n\t\tpg.Generate(GetFieldType() == 1 ? 1 : -1, rng, modulusSize, subgroupOrderSize);\n\t\tp = pg.Prime();\n\t\tq = pg.SubPrime();\n\t\tg = pg.Generator();\n\t}\n\n\tInitialize(p, q, g);\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::ValidateElement",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "127-159",
    "snippet": "bool DL_GroupParameters_IntegerBased::ValidateElement(unsigned int level, const Integer &g, const DL_FixedBasePrecomputation<Integer> *gpc) const\n{\n\tconst Integer &p = GetModulus(), &q = GetSubgroupOrder();\n\n\tbool pass = true;\n\tpass = pass && GetFieldType() == 1 ? g.IsPositive() : g.NotNegative();\n\tpass = pass && g < p && !IsIdentity(g);\n\n\tif (level >= 1)\n\t{\n\t\tif (gpc)\n\t\t\tpass = pass && gpc->Exponentiate(GetGroupPrecomputation(), Integer::One()) == g;\n\t}\n\tif (level >= 2)\n\t{\n\t\tif (GetFieldType() == 2)\n\t\t\tpass = pass && Jacobi(g*g-4, p)==-1;\n\n\t\t// verifying that Lucas((p+1)/2, w, p)==2 is omitted because it's too costly\n\t\t// and at most 1 bit is leaked if it's false\n\t\tbool fullValidate = (GetFieldType() == 2 && level >= 3) || !FastSubgroupCheckAvailable();\n\n\t\tif (fullValidate && pass)\n\t\t{\n\t\t\tInteger gp = gpc ? gpc->Exponentiate(GetGroupPrecomputation(), q) : ExponentiateElement(g, q);\n\t\t\tpass = pass && IsIdentity(gp);\n\t\t}\n\t\telse if (GetFieldType() == 1)\n\t\t\tpass = pass && Jacobi(g, p) == 1;\n\t}\n\n\treturn pass;\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Jacobi",
          "args": [
            "g",
            "p"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "Jacobi",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.cpp",
          "lines": "785-810",
          "snippet": "int Jacobi(const Integer &aIn, const Integer &bIn)\n{\n\tassert(bIn.IsOdd());\n\n\tInteger b = bIn, a = aIn%bIn;\n\tint result = 1;\n\n\twhile (!!a)\n\t{\n\t\tunsigned i=0;\n\t\twhile (a.GetBit(i)==0)\n\t\t\ti++;\n\t\ta>>=i;\n\n\t\tif (i%2==1 && (b%8==3 || b%8==5))\n\t\t\tresult = -result;\n\n\t\tif (a%4==3 && b%4==3)\n\t\t\tresult = -result;\n\n\t\tstd::swap(a, b);\n\t\ta %= b;\n\t}\n\n\treturn (b==1) ? result : 0;\n}",
          "includes": [
            "#include <omp.h>",
            "#include <vector>",
            "#include <math.h>",
            "#include \"algparam.h\"",
            "#include \"modarith.h\"",
            "#include \"nbtheory.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <omp.h>\n#include <vector>\n#include <math.h>\n#include \"algparam.h\"\n#include \"modarith.h\"\n#include \"nbtheory.h\"\n#include \"pch.h\"\n\nint Jacobi(const Integer &aIn, const Integer &bIn)\n{\n\tassert(bIn.IsOdd());\n\n\tInteger b = bIn, a = aIn%bIn;\n\tint result = 1;\n\n\twhile (!!a)\n\t{\n\t\tunsigned i=0;\n\t\twhile (a.GetBit(i)==0)\n\t\t\ti++;\n\t\ta>>=i;\n\n\t\tif (i%2==1 && (b%8==3 || b%8==5))\n\t\t\tresult = -result;\n\n\t\tif (a%4==3 && b%4==3)\n\t\t\tresult = -result;\n\n\t\tstd::swap(a, b);\n\t\ta %= b;\n\t}\n\n\treturn (b==1) ? result : 0;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetFieldType",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "GetFieldType",
          "container": "DL_GroupParameters_LUC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/luc.h",
          "lines": "168-168",
          "snippet": "int GetFieldType() const {return 2;}",
          "includes": [
            "#include <limits.h>",
            "#include \"dh.h\"",
            "#include \"integer.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"dh.h\"\n#include \"integer.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n\nDL_GroupParameters_LUC {\n  int GetFieldType() const {return 2;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsIdentity",
          "args": [
            "gp"
          ],
          "line": 152
        },
        "resolved": true,
        "details": {
          "function_name": "IsIdentity",
          "container": "DL_GroupParameters_EC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eccrypto.h",
          "lines": "94-94",
          "snippet": "bool IsIdentity(const Element &element) const {return element.identity;}",
          "includes": [
            "#include \"eccrypto.cpp\"",
            "#include \"ec2n.h\"",
            "#include \"ecp.h\"",
            "#include \"mqv.h\"",
            "#include \"dh.h\"",
            "#include \"gfpcrypt.h\"",
            "#include \"sha.h\"",
            "#include \"hmac.h\"",
            "#include \"asn.h\"",
            "#include \"integer.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eccrypto.cpp\"\n#include \"ec2n.h\"\n#include \"ecp.h\"\n#include \"mqv.h\"\n#include \"dh.h\"\n#include \"gfpcrypt.h\"\n#include \"sha.h\"\n#include \"hmac.h\"\n#include \"asn.h\"\n#include \"integer.h\"\n#include \"pubkey.h\"\n\nDL_GroupParameters_EC {\n  bool IsIdentity(const Element &element) const {return element.identity;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "ExponentiateElement",
          "args": [
            "g",
            "q"
          ],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gpc->Exponentiate",
          "args": [
            "GetGroupPrecomputation()",
            "q"
          ],
          "line": 151
        },
        "resolved": true,
        "details": {
          "function_name": "Exponentiate",
          "container": "GFP2_ONB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "158-164",
          "snippet": "Element Exponentiate(const Element &a, const Integer &e) const\n\t{\n\t\tInteger edivp, emodp;\n\t\tInteger::Divide(emodp, edivp, e, modp.GetModulus());\n\t\tElement b = PthPower(a);\n\t\treturn AbstractRing<GFP2Element>::CascadeExponentiate(a, emodp, b, edivp);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2_ONB {\n  Element Exponentiate(const Element &a, const Integer &e) const\n  \t{\n  \t\tInteger edivp, emodp;\n  \t\tInteger::Divide(emodp, edivp, e, modp.GetModulus());\n  \t\tElement b = PthPower(a);\n  \t\treturn AbstractRing<GFP2Element>::CascadeExponentiate(a, emodp, b, edivp);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetGroupPrecomputation",
          "args": [],
          "line": 151
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "FastSubgroupCheckAvailable",
          "args": [],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "FastSubgroupCheckAvailable",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "52-52",
          "snippet": "bool FastSubgroupCheckAvailable() const {return GetCofactor() == 2;}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nbool FastSubgroupCheckAvailable() const {return GetCofactor() == 2;}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::One",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "One",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "44-45",
          "snippet": "Element One() const\n\t\t{return 1;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element One() const\n  \t\t{return 1;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetGroupPrecomputation",
          "args": [],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "g.NotNegative",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "NotNegative",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "203-203",
          "snippet": "bool NotNegative() const {return !IsNegative();}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool NotNegative() const {return !IsNegative();}"
        }
      },
      {
        "call_info": {
          "callee": "g.IsPositive",
          "args": [],
          "line": 132
        },
        "resolved": true,
        "details": {
          "function_name": "IsPositive",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "205-205",
          "snippet": "bool IsPositive() const {return NotNegative() && NotZero();}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsPositive() const {return NotNegative() && NotZero();}"
        }
      },
      {
        "call_info": {
          "callee": "GetSubgroupOrder",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 129
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nbool DL_GroupParameters_IntegerBased::ValidateElement(unsigned int level, const Integer &g, const DL_FixedBasePrecomputation<Integer> *gpc) const\n{\n\tconst Integer &p = GetModulus(), &q = GetSubgroupOrder();\n\n\tbool pass = true;\n\tpass = pass && GetFieldType() == 1 ? g.IsPositive() : g.NotNegative();\n\tpass = pass && g < p && !IsIdentity(g);\n\n\tif (level >= 1)\n\t{\n\t\tif (gpc)\n\t\t\tpass = pass && gpc->Exponentiate(GetGroupPrecomputation(), Integer::One()) == g;\n\t}\n\tif (level >= 2)\n\t{\n\t\tif (GetFieldType() == 2)\n\t\t\tpass = pass && Jacobi(g*g-4, p)==-1;\n\n\t\t// verifying that Lucas((p+1)/2, w, p)==2 is omitted because it's too costly\n\t\t// and at most 1 bit is leaked if it's false\n\t\tbool fullValidate = (GetFieldType() == 2 && level >= 3) || !FastSubgroupCheckAvailable();\n\n\t\tif (fullValidate && pass)\n\t\t{\n\t\t\tInteger gp = gpc ? gpc->Exponentiate(GetGroupPrecomputation(), q) : ExponentiateElement(g, q);\n\t\t\tpass = pass && IsIdentity(gp);\n\t\t}\n\t\telse if (GetFieldType() == 1)\n\t\t\tpass = pass && Jacobi(g, p) == 1;\n\t}\n\n\treturn pass;\n}"
  },
  {
    "function_name": "DL_GroupParameters_IntegerBased::ValidateGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "111-125",
    "snippet": "bool DL_GroupParameters_IntegerBased::ValidateGroup(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tconst Integer &p = GetModulus(), &q = GetSubgroupOrder();\n\n\tbool pass = true;\n\tpass = pass && p > Integer::One() && p.IsOdd();\n\tpass = pass && q > Integer::One() && q.IsOdd();\n\n\tif (level >= 1)\n\t\tpass = pass && GetCofactor() > Integer::One() && GetGroupOrder() % q == Integer::Zero();\n\tif (level >= 2)\n\t\tpass = pass && VerifyPrime(rng, q, level-2) && VerifyPrime(rng, p, level-2);\n\n\treturn pass;\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "VerifyPrime",
          "args": [
            "rng",
            "p",
            "level-2"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "VerifyPrime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/nbtheory.cpp",
          "lines": "247-253",
          "snippet": "bool VerifyPrime(RandomNumberGenerator &rng, const Integer &p, unsigned int level)\n{\n\tbool pass = IsPrime(p) && RabinMillerTest(rng, p, 1);\n\tif (level >= 1)\n\t\tpass = pass && RabinMillerTest(rng, p, 10);\n\treturn pass;\n}",
          "includes": [
            "#include <omp.h>",
            "#include <vector>",
            "#include <math.h>",
            "#include \"algparam.h\"",
            "#include \"modarith.h\"",
            "#include \"nbtheory.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <omp.h>\n#include <vector>\n#include <math.h>\n#include \"algparam.h\"\n#include \"modarith.h\"\n#include \"nbtheory.h\"\n#include \"pch.h\"\n\nbool VerifyPrime(RandomNumberGenerator &rng, const Integer &p, unsigned int level)\n{\n\tbool pass = IsPrime(p) && RabinMillerTest(rng, p, 1);\n\tif (level >= 1)\n\t\tpass = pass && RabinMillerTest(rng, p, 10);\n\treturn pass;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::Zero",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "Zero",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "23-24",
          "snippet": "Element Zero() const\n\t\t{return 0;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Zero() const\n  \t\t{return 0;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetGroupOrder",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "GetGroupOrder",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "49-49",
          "snippet": "Integer GetGroupOrder() const {return GetFieldType() == 1 ? GetModulus()-Integer::One() : GetModulus()+Integer::One();}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nInteger GetGroupOrder() const {return GetFieldType() == 1 ? GetModulus()-Integer::One() : GetModulus()+Integer::One();}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::One",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "One",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "44-45",
          "snippet": "Element One() const\n\t\t{return 1;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element One() const\n  \t\t{return 1;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetCofactor",
          "args": [],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "DL_GroupParameters_EC<EC>::GetCofactor",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eccrypto.cpp",
          "lines": "544-554",
          "snippet": "Integer DL_GroupParameters_EC<EC>::GetCofactor() const\n{\n\tif (!m_k)\n\t{\n\t\tInteger q = GetCurve().FieldSize();\n\t\tInteger qSqrt = q.SquareRoot();\n\t\tm_k = (q+2*qSqrt+1)/m_n;\n\t}\n\n\treturn m_k;\n}",
          "includes": [
            "#include \"ec2n.h\"",
            "#include \"argnames.h\"",
            "#include \"hex.h\"",
            "#include \"oids.h\"",
            "#include \"nbtheory.h\"",
            "#include \"eccrypto.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"ec2n.h\"\n#include \"argnames.h\"\n#include \"hex.h\"\n#include \"oids.h\"\n#include \"nbtheory.h\"\n#include \"eccrypto.h\"\n#include \"pch.h\"\n\nInteger DL_GroupParameters_EC<EC>::GetCofactor() const\n{\n\tif (!m_k)\n\t{\n\t\tInteger q = GetCurve().FieldSize();\n\t\tInteger qSqrt = q.SquareRoot();\n\t\tm_k = (q+2*qSqrt+1)/m_n;\n\t}\n\n\treturn m_k;\n}"
        }
      },
      {
        "call_info": {
          "callee": "q.IsOdd",
          "args": [],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "IsOdd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.h",
          "lines": "211-211",
          "snippet": "bool IsOdd() const\t{return GetBit(0) == 1;}",
          "includes": [
            "#include <algorithm>",
            "#include <iosfwd>",
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include <iosfwd>\n#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nbool IsOdd() const\t{return GetBit(0) == 1;}"
        }
      },
      {
        "call_info": {
          "callee": "GetSubgroupOrder",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nbool DL_GroupParameters_IntegerBased::ValidateGroup(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tconst Integer &p = GetModulus(), &q = GetSubgroupOrder();\n\n\tbool pass = true;\n\tpass = pass && p > Integer::One() && p.IsOdd();\n\tpass = pass && q > Integer::One() && q.IsOdd();\n\n\tif (level >= 1)\n\t\tpass = pass && GetCofactor() > Integer::One() && GetGroupOrder() % q == Integer::Zero();\n\tif (level >= 2)\n\t\tpass = pass && VerifyPrime(rng, q, level-2) && VerifyPrime(rng, p, level-2);\n\n\treturn pass;\n}"
  },
  {
    "function_name": "DL_SignatureMessageEncodingMethod_NR::ComputeMessageRepresentative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "89-109",
    "snippet": "void DL_SignatureMessageEncodingMethod_NR::ComputeMessageRepresentative(RandomNumberGenerator &rng, \n\tconst byte *recoverableMessage, size_t recoverableMessageLength,\n\tHashTransformation &hash, HashIdentifier hashIdentifier, bool messageEmpty,\n\tbyte *representative, size_t representativeBitLength) const\n{\n\tassert(recoverableMessageLength == 0);\n\tassert(hashIdentifier.second == 0);\n\tconst size_t representativeByteLength = BitsToBytes(representativeBitLength);\n\tconst size_t digestSize = hash.DigestSize();\n\tconst size_t paddingLength = SaturatingSubtract(representativeByteLength, digestSize);\n\n\tmemset(representative, 0, paddingLength);\n\thash.TruncatedFinal(representative+paddingLength, STDMIN(representativeByteLength, digestSize));\n\n\tif (digestSize*8 >= representativeBitLength)\n\t{\n\t\tInteger h(representative, representativeByteLength);\n\t\th >>= representativeByteLength*8 - representativeBitLength + 1;\n\t\th.Encode(representative, representativeByteLength);\n\t}\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "h.Encode",
          "args": [
            "representative",
            "representativeByteLength"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "GFP2Element",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "21-25",
          "snippet": "void Encode(byte *encodedElement, unsigned int size)\n\t{\n\t\tc1.Encode(encodedElement, size/2);\n\t\tc2.Encode(encodedElement+size/2, size/2);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2Element {\n  void Encode(byte *encodedElement, unsigned int size)\n  \t{\n  \t\tc1.Encode(encodedElement, size/2);\n  \t\tc2.Encode(encodedElement+size/2, size/2);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.TruncatedFinal",
          "args": [
            "representative+paddingLength",
            "STDMIN(representativeByteLength, digestSize)"
          ],
          "line": 101
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedFinal",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "68-74",
          "snippet": "void TruncatedFinal(byte *digest, size_t digestSize)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.TruncatedFinal(digest, digestSize);\n\t\tm_keyed = false;\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void TruncatedFinal(byte *digest, size_t digestSize)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.TruncatedFinal(digest, digestSize);\n  \t\tm_keyed = false;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "STDMIN",
          "args": [
            "representativeByteLength",
            "digestSize"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "representative",
            "0",
            "paddingLength"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SaturatingSubtract",
          "args": [
            "representativeByteLength",
            "digestSize"
          ],
          "line": 98
        },
        "resolved": true,
        "details": {
          "function_name": "SaturatingSubtract",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "432-435",
          "snippet": "inline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.DigestSize",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitsToBytes",
          "args": [
            "representativeBitLength"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "BitsToBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "307-310",
          "snippet": "inline size_t BitsToBytes(size_t bitCount)\n{\n\treturn ((bitCount+7)/(8));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline size_t BitsToBytes(size_t bitCount)\n{\n\treturn ((bitCount+7)/(8));\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "hashIdentifier.second == 0"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "recoverableMessageLength == 0"
          ],
          "line": 94
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid DL_SignatureMessageEncodingMethod_NR::ComputeMessageRepresentative(RandomNumberGenerator &rng, \n\tconst byte *recoverableMessage, size_t recoverableMessageLength,\n\tHashTransformation &hash, HashIdentifier hashIdentifier, bool messageEmpty,\n\tbyte *representative, size_t representativeBitLength) const\n{\n\tassert(recoverableMessageLength == 0);\n\tassert(hashIdentifier.second == 0);\n\tconst size_t representativeByteLength = BitsToBytes(representativeBitLength);\n\tconst size_t digestSize = hash.DigestSize();\n\tconst size_t paddingLength = SaturatingSubtract(representativeByteLength, digestSize);\n\n\tmemset(representative, 0, paddingLength);\n\thash.TruncatedFinal(representative+paddingLength, STDMIN(representativeByteLength, digestSize));\n\n\tif (digestSize*8 >= representativeBitLength)\n\t{\n\t\tInteger h(representative, representativeByteLength);\n\t\th >>= representativeByteLength*8 - representativeBitLength + 1;\n\t\th.Encode(representative, representativeByteLength);\n\t}\n}"
  },
  {
    "function_name": "DL_SignatureMessageEncodingMethod_DSA::ComputeMessageRepresentative",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "67-87",
    "snippet": "void DL_SignatureMessageEncodingMethod_DSA::ComputeMessageRepresentative(RandomNumberGenerator &rng, \n\tconst byte *recoverableMessage, size_t recoverableMessageLength,\n\tHashTransformation &hash, HashIdentifier hashIdentifier, bool messageEmpty,\n\tbyte *representative, size_t representativeBitLength) const\n{\n\tassert(recoverableMessageLength == 0);\n\tassert(hashIdentifier.second == 0);\n\tconst size_t representativeByteLength = BitsToBytes(representativeBitLength);\n\tconst size_t digestSize = hash.DigestSize();\n\tconst size_t paddingLength = SaturatingSubtract(representativeByteLength, digestSize);\n\n\tmemset(representative, 0, paddingLength);\n\thash.TruncatedFinal(representative+paddingLength, STDMIN(representativeByteLength, digestSize));\n\n\tif (digestSize*8 > representativeBitLength)\n\t{\n\t\tInteger h(representative, representativeByteLength);\n\t\th >>= representativeByteLength*8 - representativeBitLength;\n\t\th.Encode(representative, representativeByteLength);\n\t}\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "h.Encode",
          "args": [
            "representative",
            "representativeByteLength"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "Encode",
          "container": "GFP2Element",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/xtr.h",
          "lines": "21-25",
          "snippet": "void Encode(byte *encodedElement, unsigned int size)\n\t{\n\t\tc1.Encode(encodedElement, size/2);\n\t\tc2.Encode(encodedElement+size/2, size/2);\n\t}",
          "includes": [
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"modarith.h\"\n\nGFP2Element {\n  void Encode(byte *encodedElement, unsigned int size)\n  \t{\n  \t\tc1.Encode(encodedElement, size/2);\n  \t\tc2.Encode(encodedElement+size/2, size/2);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.TruncatedFinal",
          "args": [
            "representative+paddingLength",
            "STDMIN(representativeByteLength, digestSize)"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "TruncatedFinal",
          "container": "HermeticHashFunctionMAC",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/panama.h",
          "lines": "68-74",
          "snippet": "void TruncatedFinal(byte *digest, size_t digestSize)\n\t{\n\t\tif (!m_keyed)\n\t\t\tKeyHash();\n\t\tm_hash.TruncatedFinal(digest, digestSize);\n\t\tm_keyed = false;\n\t}",
          "includes": [
            "#include \"iterhash.h\"",
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"iterhash.h\"\n#include \"strciphr.h\"\n\nHermeticHashFunctionMAC {\n  void TruncatedFinal(byte *digest, size_t digestSize)\n  \t{\n  \t\tif (!m_keyed)\n  \t\t\tKeyHash();\n  \t\tm_hash.TruncatedFinal(digest, digestSize);\n  \t\tm_keyed = false;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "STDMIN",
          "args": [
            "representativeByteLength",
            "digestSize"
          ],
          "line": 79
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "representative",
            "0",
            "paddingLength"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SaturatingSubtract",
          "args": [
            "representativeByteLength",
            "digestSize"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "SaturatingSubtract",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "432-435",
          "snippet": "inline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 SaturatingSubtract(const T1 &a, const T2 &b)\n{\n\treturn T1((a > b) ? (a - b) : 0);\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.DigestSize",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "DigestSize",
          "container": "SHA3",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/sha3.h",
          "lines": "16-16",
          "snippet": "unsigned int DigestSize() const {return m_digestSize;}",
          "includes": [
            "#include \"secblock.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"secblock.h\"\n#include \"cryptlib.h\"\n\nSHA3 {\n  unsigned int DigestSize() const {return m_digestSize;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BitsToBytes",
          "args": [
            "representativeBitLength"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "BitsToBytes",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "307-310",
          "snippet": "inline size_t BitsToBytes(size_t bitCount)\n{\n\treturn ((bitCount+7)/(8));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline size_t BitsToBytes(size_t bitCount)\n{\n\treturn ((bitCount+7)/(8));\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "hashIdentifier.second == 0"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "recoverableMessageLength == 0"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid DL_SignatureMessageEncodingMethod_DSA::ComputeMessageRepresentative(RandomNumberGenerator &rng, \n\tconst byte *recoverableMessage, size_t recoverableMessageLength,\n\tHashTransformation &hash, HashIdentifier hashIdentifier, bool messageEmpty,\n\tbyte *representative, size_t representativeBitLength) const\n{\n\tassert(recoverableMessageLength == 0);\n\tassert(hashIdentifier.second == 0);\n\tconst size_t representativeByteLength = BitsToBytes(representativeBitLength);\n\tconst size_t digestSize = hash.DigestSize();\n\tconst size_t paddingLength = SaturatingSubtract(representativeByteLength, digestSize);\n\n\tmemset(representative, 0, paddingLength);\n\thash.TruncatedFinal(representative+paddingLength, STDMIN(representativeByteLength, digestSize));\n\n\tif (digestSize*8 > representativeBitLength)\n\t{\n\t\tInteger h(representative, representativeByteLength);\n\t\th >>= representativeByteLength*8 - representativeBitLength;\n\t\th.Encode(representative, representativeByteLength);\n\t}\n}"
  },
  {
    "function_name": "DL_GroupParameters_DSA::ValidateGroup",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "59-65",
    "snippet": "bool DL_GroupParameters_DSA::ValidateGroup(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tbool pass = DL_GroupParameters_GFP::ValidateGroup(rng, level);\n\tint pSize = GetModulus().BitCount(), qSize = GetSubgroupOrder().BitCount();\n\tpass = pass && ((pSize==1024 && qSize==160) || (pSize==2048 && qSize==224) || (pSize==2048 && qSize==256) || (pSize==3072 && qSize==256));\n\treturn pass;\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetSubgroupOrder",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetSubgroupOrder",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetModulus",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DL_GroupParameters_GFP::ValidateGroup",
          "args": [
            "rng",
            "level"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nbool DL_GroupParameters_DSA::ValidateGroup(RandomNumberGenerator &rng, unsigned int level) const\n{\n\tbool pass = DL_GroupParameters_GFP::ValidateGroup(rng, level);\n\tint pSize = GetModulus().BitCount(), qSize = GetSubgroupOrder().BitCount();\n\tpass = pass && ((pSize==1024 && qSize==160) || (pSize==2048 && qSize==224) || (pSize==2048 && qSize==256) || (pSize==3072 && qSize==256));\n\treturn pass;\n}"
  },
  {
    "function_name": "DL_GroupParameters_DSA::GenerateRandom",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "26-57",
    "snippet": "void DL_GroupParameters_DSA::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tInteger p, q, g;\n\n\tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n\t{\n\t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n\t\tInitialize(p, q, g);\n\t}\n\telse\n\t{\n\t\tint modulusSize = 1024, defaultSubgroupOrderSize;\n\t\talg.GetIntValue(\"ModulusSize\", modulusSize) || alg.GetIntValue(\"KeySize\", modulusSize);\n\n\t\tswitch (modulusSize)\n\t\t{\n\t\tcase 1024:\n\t\t\tdefaultSubgroupOrderSize = 160;\n\t\t\tbreak;\n\t\tcase 2048:\n\t\t\tdefaultSubgroupOrderSize = 224;\n\t\t\tbreak;\n\t\tcase 3072:\n\t\t\tdefaultSubgroupOrderSize = 256;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthrow InvalidArgument(\"DSA: not a valid prime length\");\n\t\t}\n\n\t\tDL_GroupParameters_GFP::GenerateRandom(rng, CombinedNameValuePairs(alg, MakeParameters(Name::SubgroupOrderSize(), defaultSubgroupOrderSize, false)));\n\t}\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DL_GroupParameters_GFP::GenerateRandom",
          "args": [
            "rng",
            "CombinedNameValuePairs(alg, MakeParameters(Name::SubgroupOrderSize(), defaultSubgroupOrderSize, false))"
          ],
          "line": 55
        },
        "resolved": true,
        "details": {
          "function_name": "GenerateRandom",
          "container": "DL_PrivateKeyImpl",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/pubkey.h",
          "lines": "779-788",
          "snippet": "void GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &params)\n\t{\n\t\tif (!params.GetThisObject(this->AccessGroupParameters()))\n\t\t\tthis->AccessGroupParameters().GenerateRandom(rng, params);\n//\t\tstd::pair<const byte *, int> seed;\n\t\tInteger x(rng, Integer::One(), GetAbstractGroupParameters().GetMaxExponent());\n//\t\t\tInteger::ANY, Integer::Zero(), Integer::One(),\n//\t\t\tparams.GetValue(\"DeterministicKeyGenerationSeed\", seed) ? &seed : NULL);\n\t\tSetPrivateExponent(x);\n\t}",
          "includes": [
            "#include <memory>",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"eprecomp.h\"",
            "#include \"filters.h\"",
            "#include \"modarith.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"eprecomp.h\"\n#include \"filters.h\"\n#include \"modarith.h\"\n\nDL_PrivateKeyImpl {\n  void GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &params)\n  \t{\n  \t\tif (!params.GetThisObject(this->AccessGroupParameters()))\n  \t\t\tthis->AccessGroupParameters().GenerateRandom(rng, params);\n  //\t\tstd::pair<const byte *, int> seed;\n  \t\tInteger x(rng, Integer::One(), GetAbstractGroupParameters().GetMaxExponent());\n  //\t\t\tInteger::ANY, Integer::Zero(), Integer::One(),\n  //\t\t\tparams.GetValue(\"DeterministicKeyGenerationSeed\", seed) ? &seed : NULL);\n  \t\tSetPrivateExponent(x);\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "CombinedNameValuePairs",
          "args": [
            "alg",
            "MakeParameters(Name::SubgroupOrderSize(), defaultSubgroupOrderSize, false)"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "MakeParameters",
          "args": [
            "Name::SubgroupOrderSize()",
            "defaultSubgroupOrderSize",
            "false"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::SubgroupOrderSize",
          "args": [],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"DSA: not a valid prime length\""
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetIntValue",
          "args": [
            "\"KeySize\"",
            "modulusSize"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetIntValue",
          "args": [
            "\"ModulusSize\"",
            "modulusSize"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Initialize",
          "args": [
            "p",
            "q",
            "g"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "Initialize",
          "container": "DL_PrivateKey_GFP",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.h",
          "lines": "241-242",
          "snippet": "void Initialize(const Integer &p, const Integer &g, const Integer &x)\n\t\t{this->AccessGroupParameters().Initialize(p, g); this->SetPrivateExponent(x);}",
          "includes": [
            "#include <limits.h>",
            "#include \"hmac.h\"",
            "#include \"smartptr.h\"",
            "#include \"asn.h\"",
            "#include \"algparam.h\"",
            "#include \"sha.h\"",
            "#include \"modexppc.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <limits.h>\n#include \"hmac.h\"\n#include \"smartptr.h\"\n#include \"asn.h\"\n#include \"algparam.h\"\n#include \"sha.h\"\n#include \"modexppc.h\"\n#include \"pubkey.h\"\n\nDL_PrivateKey_GFP {\n  void Initialize(const Integer &p, const Integer &g, const Integer &x)\n  \t\t{this->AccessGroupParameters().Initialize(p, g); this->SetPrivateExponent(x);}\n}"
        }
      },
      {
        "call_info": {
          "callee": "alg.GetValueWithDefault",
          "args": [
            "\"SubgroupOrder\"",
            "ComputeGroupOrder(p)/2"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ComputeGroupOrder",
          "args": [
            "p"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetValue",
          "args": [
            "\"SubgroupGenerator\"",
            "g"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alg.GetValue",
          "args": [
            "\"Modulus\"",
            "p"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid DL_GroupParameters_DSA::GenerateRandom(RandomNumberGenerator &rng, const NameValuePairs &alg)\n{\n\tInteger p, q, g;\n\n\tif (alg.GetValue(\"Modulus\", p) && alg.GetValue(\"SubgroupGenerator\", g))\n\t{\n\t\tq = alg.GetValueWithDefault(\"SubgroupOrder\", ComputeGroupOrder(p)/2);\n\t\tInitialize(p, q, g);\n\t}\n\telse\n\t{\n\t\tint modulusSize = 1024, defaultSubgroupOrderSize;\n\t\talg.GetIntValue(\"ModulusSize\", modulusSize) || alg.GetIntValue(\"KeySize\", modulusSize);\n\n\t\tswitch (modulusSize)\n\t\t{\n\t\tcase 1024:\n\t\t\tdefaultSubgroupOrderSize = 160;\n\t\t\tbreak;\n\t\tcase 2048:\n\t\t\tdefaultSubgroupOrderSize = 224;\n\t\t\tbreak;\n\t\tcase 3072:\n\t\t\tdefaultSubgroupOrderSize = 256;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthrow InvalidArgument(\"DSA: not a valid prime length\");\n\t\t}\n\n\t\tDL_GroupParameters_GFP::GenerateRandom(rng, CombinedNameValuePairs(alg, MakeParameters(Name::SubgroupOrderSize(), defaultSubgroupOrderSize, false)));\n\t}\n}"
  },
  {
    "function_name": "TestInstantiations_gfpcrypt",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gfpcrypt.cpp",
    "lines": "14-24",
    "snippet": "void TestInstantiations_gfpcrypt()\n{\n\tGDSA<SHA>::Signer test;\n\tGDSA<SHA>::Verifier test1;\n\tDSA::Signer test5(NullRNG(), 100);\n\tDSA::Signer test2(test5);\n\tNR<SHA>::Signer test3;\n\tNR<SHA>::Verifier test4;\n\tDLIES<>::Encryptor test6;\n\tDLIES<>::Decryptor test7;\n}",
    "includes": [
      "#include \"nbtheory.h\"",
      "#include \"oids.h\"",
      "#include \"asn.h\"",
      "#include \"gfpcrypt.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "NullRNG",
          "args": [],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "AlgorithmName",
          "container": "ClassNullRNG",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.cpp",
          "lines": "291-291",
          "snippet": "std::string AlgorithmName() const {return \"NullRNG\";}",
          "includes": [
            "#include <memory>",
            "#include \"osrng.h\"",
            "#include \"trdlocal.h\"",
            "#include \"fltrimpl.h\"",
            "#include \"argnames.h\"",
            "#include \"fips140.h\"",
            "#include \"algparam.h\"",
            "#include \"filters.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <memory>\n#include \"osrng.h\"\n#include \"trdlocal.h\"\n#include \"fltrimpl.h\"\n#include \"argnames.h\"\n#include \"fips140.h\"\n#include \"algparam.h\"\n#include \"filters.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n#include \"pch.h\"\n\nClassNullRNG {\n  std::string AlgorithmName() const {return \"NullRNG\";}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"nbtheory.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"gfpcrypt.h\"\n#include \"pch.h\"\n\nvoid TestInstantiations_gfpcrypt()\n{\n\tGDSA<SHA>::Signer test;\n\tGDSA<SHA>::Verifier test1;\n\tDSA::Signer test5(NullRNG(), 100);\n\tDSA::Signer test2(test5);\n\tNR<SHA>::Signer test3;\n\tNR<SHA>::Verifier test4;\n\tDLIES<>::Encryptor test6;\n\tDLIES<>::Decryptor test7;\n}"
  }
]