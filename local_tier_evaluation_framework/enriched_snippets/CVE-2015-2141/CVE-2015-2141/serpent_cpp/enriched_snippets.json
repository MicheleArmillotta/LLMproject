[
  {
    "function_name": "ProcessAndXorBlock",
    "container": "Serpent::Dec",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/serpent.cpp",
    "lines": "89-121",
    "snippet": "void Serpent::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 a, b, c, d, e;\n\t\n\tBlock::Get(inBlock)(a)(b)(c)(d);\n\n\tconst word32 *k = m_key + 96;\n\tunsigned int i=4;\n\n\tbeforeI7(KX);\n\tgoto start;\n\n\tdo\n\t{\n\t\tc = b;\n\t\tb = d;\n\t\td = e;\n\t\tk -= 32;\n\t\tbeforeI7(ILT);\nstart:\n\t\t            beforeI7(I7); afterI7(KX); \n\t\tafterI7(ILT); afterI7(I6); afterI6(KX); \n\t\tafterI6(ILT); afterI6(I5); afterI5(KX); \n\t\tafterI5(ILT); afterI5(I4); afterI4(KX); \n\t\tafterI4(ILT); afterI4(I3); afterI3(KX); \n\t\tafterI3(ILT); afterI3(I2); afterI2(KX); \n\t\tafterI2(ILT); afterI2(I1); afterI1(KX); \n\t\tafterI1(ILT); afterI1(I0); afterI0(KX);\n\t}\n\twhile (--i != 0);\n\t\n\tBlock::Put(xorBlock, outBlock)(a)(d)(b)(e);\n}",
    "includes": [
      "#include \"serpentp.h\"",
      "#include \"misc.h\"",
      "#include \"serpent.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "e"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "afterI0",
          "args": [
            "KX"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI1",
          "args": [
            "I0"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI1",
          "args": [
            "ILT"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI1",
          "args": [
            "KX"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI2",
          "args": [
            "I1"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI2",
          "args": [
            "ILT"
          ],
          "line": 115
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI2",
          "args": [
            "KX"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI3",
          "args": [
            "I2"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI3",
          "args": [
            "ILT"
          ],
          "line": 114
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI3",
          "args": [
            "KX"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI4",
          "args": [
            "I3"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI4",
          "args": [
            "ILT"
          ],
          "line": 113
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI4",
          "args": [
            "KX"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI5",
          "args": [
            "I4"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI5",
          "args": [
            "ILT"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI5",
          "args": [
            "KX"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI6",
          "args": [
            "I5"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI6",
          "args": [
            "ILT"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI6",
          "args": [
            "KX"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI7",
          "args": [
            "I6"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI7",
          "args": [
            "ILT"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterI7",
          "args": [
            "KX"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeI7",
          "args": [
            "I7"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeI7",
          "args": [
            "ILT"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeI7",
          "args": [
            "KX"
          ],
          "line": 98
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "d"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"serpentp.h\"\n#include \"misc.h\"\n#include \"serpent.h\"\n#include \"pch.h\"\n\nSerpent {\n  Dec {\n    void Serpent::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tword32 a, b, c, d, e;\n    \t\n    \tBlock::Get(inBlock)(a)(b)(c)(d);\n    \n    \tconst word32 *k = m_key + 96;\n    \tunsigned int i=4;\n    \n    \tbeforeI7(KX);\n    \tgoto start;\n    \n    \tdo\n    \t{\n    \t\tc = b;\n    \t\tb = d;\n    \t\td = e;\n    \t\tk -= 32;\n    \t\tbeforeI7(ILT);\n    start:\n    \t\t            beforeI7(I7); afterI7(KX); \n    \t\tafterI7(ILT); afterI7(I6); afterI6(KX); \n    \t\tafterI6(ILT); afterI6(I5); afterI5(KX); \n    \t\tafterI5(ILT); afterI5(I4); afterI4(KX); \n    \t\tafterI4(ILT); afterI4(I3); afterI3(KX); \n    \t\tafterI3(ILT); afterI3(I2); afterI2(KX); \n    \t\tafterI2(ILT); afterI2(I1); afterI1(KX); \n    \t\tafterI1(ILT); afterI1(I0); afterI0(KX);\n    \t}\n    \twhile (--i != 0);\n    \t\n    \tBlock::Put(xorBlock, outBlock)(a)(d)(b)(e);\n    }\n  }\n}"
  },
  {
    "function_name": "ProcessAndXorBlock",
    "container": "Serpent::Enc",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/serpent.cpp",
    "lines": "50-87",
    "snippet": "void Serpent::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 a, b, c, d, e;\n\t\n\tBlock::Get(inBlock)(a)(b)(c)(d);\n\n\tconst word32 *k = m_key;\n\tunsigned int i=1;\n\n\tdo\n\t{\n\t\tbeforeS0(KX); beforeS0(S0); afterS0(LT);\n\t\tafterS0(KX); afterS0(S1); afterS1(LT);\n\t\tafterS1(KX); afterS1(S2); afterS2(LT);\n\t\tafterS2(KX); afterS2(S3); afterS3(LT);\n\t\tafterS3(KX); afterS3(S4); afterS4(LT);\n\t\tafterS4(KX); afterS4(S5); afterS5(LT);\n\t\tafterS5(KX); afterS5(S6); afterS6(LT);\n\t\tafterS6(KX); afterS6(S7);\n\n\t\tif (i == 4)\n\t\t\tbreak;\n\n\t\t++i;\n\t\tc = b;\n\t\tb = e;\n\t\te = d;\n\t\td = a;\n\t\ta = e;\n\t\tk += 32;\n\t\tbeforeS0(LT);\n\t}\n\twhile (true);\n\n\tafterS7(KX);\n\t\n\tBlock::Put(xorBlock, outBlock)(d)(e)(b)(a);\n}",
    "includes": [
      "#include \"serpentp.h\"",
      "#include \"misc.h\"",
      "#include \"serpent.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "a"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "afterS7",
          "args": [
            "KX"
          ],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeS0",
          "args": [
            "LT"
          ],
          "line": 80
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "S7"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "KX"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "LT"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "S6"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "KX"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "LT"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "S5"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "KX"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "LT"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "S4"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "KX"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "LT"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "S3"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "KX"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "LT"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "S2"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "KX"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "LT"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "S1"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "KX"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "LT"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeS0",
          "args": [
            "S0"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeS0",
          "args": [
            "KX"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "d"
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"serpentp.h\"\n#include \"misc.h\"\n#include \"serpent.h\"\n#include \"pch.h\"\n\nSerpent {\n  Enc {\n    void Serpent::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tword32 a, b, c, d, e;\n    \t\n    \tBlock::Get(inBlock)(a)(b)(c)(d);\n    \n    \tconst word32 *k = m_key;\n    \tunsigned int i=1;\n    \n    \tdo\n    \t{\n    \t\tbeforeS0(KX); beforeS0(S0); afterS0(LT);\n    \t\tafterS0(KX); afterS0(S1); afterS1(LT);\n    \t\tafterS1(KX); afterS1(S2); afterS2(LT);\n    \t\tafterS2(KX); afterS2(S3); afterS3(LT);\n    \t\tafterS3(KX); afterS3(S4); afterS4(LT);\n    \t\tafterS4(KX); afterS4(S5); afterS5(LT);\n    \t\tafterS5(KX); afterS5(S6); afterS6(LT);\n    \t\tafterS6(KX); afterS6(S7);\n    \n    \t\tif (i == 4)\n    \t\t\tbreak;\n    \n    \t\t++i;\n    \t\tc = b;\n    \t\tb = e;\n    \t\te = d;\n    \t\td = a;\n    \t\ta = e;\n    \t\tk += 32;\n    \t\tbeforeS0(LT);\n    \t}\n    \twhile (true);\n    \n    \tafterS7(KX);\n    \t\n    \tBlock::Put(xorBlock, outBlock)(d)(e)(b)(a);\n    }\n  }\n}"
  },
  {
    "function_name": "UncheckedSetKey",
    "container": "Serpent::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/serpent.cpp",
    "lines": "42-46",
    "snippet": "void Serpent::Base::UncheckedSetKey(const byte *userKey, unsigned int keylen, const NameValuePairs &)\n{\n\tAssertValidKeyLength(keylen);\n\tSerpent_KeySchedule(m_key, 32, userKey, keylen);\n}",
    "includes": [
      "#include \"serpentp.h\"",
      "#include \"misc.h\"",
      "#include \"serpent.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Serpent_KeySchedule",
          "args": [
            "m_key",
            "32",
            "userKey",
            "keylen"
          ],
          "line": 45
        },
        "resolved": true,
        "details": {
          "function_name": "Serpent_KeySchedule",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/serpent.cpp",
          "lines": "11-40",
          "snippet": "void Serpent_KeySchedule(word32 *k, unsigned int rounds, const byte *userKey, size_t keylen)\n{\n\tFixedSizeSecBlock<word32, 8> k0;\n\tGetUserKey(LITTLE_ENDIAN_ORDER, k0.begin(), 8, userKey, keylen);\n\tif (keylen < 32)\n\t\tk0[keylen/4] |= word32(1) << ((keylen%4)*8);\n\n\tword32 t = k0[7];\n\tunsigned int i;\n\tfor (i = 0; i < 8; ++i)\n\t\tk[i] = k0[i] = t = rotlFixed(k0[i] ^ k0[(i+3)%8] ^ k0[(i+5)%8] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tfor (i = 8; i < 4*(rounds+1); ++i)\n\t\tk[i] = t = rotlFixed(k[i-8] ^ k[i-5] ^ k[i-3] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tk -= 20;\n\n\tword32 a,b,c,d,e;\n\tfor (i=0; i<rounds/8; i++)\n\t{\n\t\tafterS2(LK); afterS2(S3); afterS3(SK);\n\t\tafterS1(LK); afterS1(S2); afterS2(SK);\n\t\tafterS0(LK); afterS0(S1); afterS1(SK);\n\t\tbeforeS0(LK); beforeS0(S0); afterS0(SK);\n\t\tk += 8*4;\n\t\tafterS6(LK); afterS6(S7); afterS7(SK);\n\t\tafterS5(LK); afterS5(S6); afterS6(SK);\n\t\tafterS4(LK); afterS4(S5); afterS5(SK);\n\t\tafterS3(LK); afterS3(S4); afterS4(SK);\n\t}\n\tafterS2(LK); afterS2(S3); afterS3(SK);\n}",
          "includes": [
            "#include \"serpentp.h\"",
            "#include \"misc.h\"",
            "#include \"serpent.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"serpentp.h\"\n#include \"misc.h\"\n#include \"serpent.h\"\n#include \"pch.h\"\n\nvoid Serpent_KeySchedule(word32 *k, unsigned int rounds, const byte *userKey, size_t keylen)\n{\n\tFixedSizeSecBlock<word32, 8> k0;\n\tGetUserKey(LITTLE_ENDIAN_ORDER, k0.begin(), 8, userKey, keylen);\n\tif (keylen < 32)\n\t\tk0[keylen/4] |= word32(1) << ((keylen%4)*8);\n\n\tword32 t = k0[7];\n\tunsigned int i;\n\tfor (i = 0; i < 8; ++i)\n\t\tk[i] = k0[i] = t = rotlFixed(k0[i] ^ k0[(i+3)%8] ^ k0[(i+5)%8] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tfor (i = 8; i < 4*(rounds+1); ++i)\n\t\tk[i] = t = rotlFixed(k[i-8] ^ k[i-5] ^ k[i-3] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tk -= 20;\n\n\tword32 a,b,c,d,e;\n\tfor (i=0; i<rounds/8; i++)\n\t{\n\t\tafterS2(LK); afterS2(S3); afterS3(SK);\n\t\tafterS1(LK); afterS1(S2); afterS2(SK);\n\t\tafterS0(LK); afterS0(S1); afterS1(SK);\n\t\tbeforeS0(LK); beforeS0(S0); afterS0(SK);\n\t\tk += 8*4;\n\t\tafterS6(LK); afterS6(S7); afterS7(SK);\n\t\tafterS5(LK); afterS5(S6); afterS6(SK);\n\t\tafterS4(LK); afterS4(S5); afterS5(SK);\n\t\tafterS3(LK); afterS3(S4); afterS4(SK);\n\t}\n\tafterS2(LK); afterS2(S3); afterS3(SK);\n}"
        }
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "keylen"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"serpentp.h\"\n#include \"misc.h\"\n#include \"serpent.h\"\n#include \"pch.h\"\n\nSerpent {\n  Base {\n    void Serpent::Base::UncheckedSetKey(const byte *userKey, unsigned int keylen, const NameValuePairs &)\n    {\n    \tAssertValidKeyLength(keylen);\n    \tSerpent_KeySchedule(m_key, 32, userKey, keylen);\n    }\n  }\n}"
  },
  {
    "function_name": "Serpent_KeySchedule",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/serpent.cpp",
    "lines": "11-40",
    "snippet": "void Serpent_KeySchedule(word32 *k, unsigned int rounds, const byte *userKey, size_t keylen)\n{\n\tFixedSizeSecBlock<word32, 8> k0;\n\tGetUserKey(LITTLE_ENDIAN_ORDER, k0.begin(), 8, userKey, keylen);\n\tif (keylen < 32)\n\t\tk0[keylen/4] |= word32(1) << ((keylen%4)*8);\n\n\tword32 t = k0[7];\n\tunsigned int i;\n\tfor (i = 0; i < 8; ++i)\n\t\tk[i] = k0[i] = t = rotlFixed(k0[i] ^ k0[(i+3)%8] ^ k0[(i+5)%8] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tfor (i = 8; i < 4*(rounds+1); ++i)\n\t\tk[i] = t = rotlFixed(k[i-8] ^ k[i-5] ^ k[i-3] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tk -= 20;\n\n\tword32 a,b,c,d,e;\n\tfor (i=0; i<rounds/8; i++)\n\t{\n\t\tafterS2(LK); afterS2(S3); afterS3(SK);\n\t\tafterS1(LK); afterS1(S2); afterS2(SK);\n\t\tafterS0(LK); afterS0(S1); afterS1(SK);\n\t\tbeforeS0(LK); beforeS0(S0); afterS0(SK);\n\t\tk += 8*4;\n\t\tafterS6(LK); afterS6(S7); afterS7(SK);\n\t\tafterS5(LK); afterS5(S6); afterS6(SK);\n\t\tafterS4(LK); afterS4(S5); afterS5(SK);\n\t\tafterS3(LK); afterS3(S4); afterS4(SK);\n\t}\n\tafterS2(LK); afterS2(S3); afterS3(SK);\n}",
    "includes": [
      "#include \"serpentp.h\"",
      "#include \"misc.h\"",
      "#include \"serpent.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "SK"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "S3"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "LK"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "SK"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "S4"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "LK"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "SK"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "S5"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS4",
          "args": [
            "LK"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "SK"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "S6"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS5",
          "args": [
            "LK"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS7",
          "args": [
            "SK"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "S7"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS6",
          "args": [
            "LK"
          ],
          "line": 34
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "SK"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeS0",
          "args": [
            "S0"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "beforeS0",
          "args": [
            "LK"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "SK"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "S1"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS0",
          "args": [
            "LK"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "SK"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "S2"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS1",
          "args": [
            "LK"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS3",
          "args": [
            "SK"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "S3"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "afterS2",
          "args": [
            "LK"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "k[i-8] ^ k[i-5] ^ k[i-3] ^ t ^ 0x9e3779b9 ^ i",
            "11"
          ],
          "line": 23
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "word32",
          "args": [
            "1"
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetUserKey",
          "args": [
            "LITTLE_ENDIAN_ORDER",
            "k0.begin()",
            "8",
            "userKey",
            "keylen"
          ],
          "line": 14
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "946-953",
          "snippet": "inline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [
            "#define memcpy_s CryptoPP::memcpy_s"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\n#define memcpy_s CryptoPP::memcpy_s\n\ninline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}"
        }
      },
      {
        "call_info": {
          "callee": "k0.begin",
          "args": [],
          "line": 14
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"serpentp.h\"\n#include \"misc.h\"\n#include \"serpent.h\"\n#include \"pch.h\"\n\nvoid Serpent_KeySchedule(word32 *k, unsigned int rounds, const byte *userKey, size_t keylen)\n{\n\tFixedSizeSecBlock<word32, 8> k0;\n\tGetUserKey(LITTLE_ENDIAN_ORDER, k0.begin(), 8, userKey, keylen);\n\tif (keylen < 32)\n\t\tk0[keylen/4] |= word32(1) << ((keylen%4)*8);\n\n\tword32 t = k0[7];\n\tunsigned int i;\n\tfor (i = 0; i < 8; ++i)\n\t\tk[i] = k0[i] = t = rotlFixed(k0[i] ^ k0[(i+3)%8] ^ k0[(i+5)%8] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tfor (i = 8; i < 4*(rounds+1); ++i)\n\t\tk[i] = t = rotlFixed(k[i-8] ^ k[i-5] ^ k[i-3] ^ t ^ 0x9e3779b9 ^ i, 11);\n\tk -= 20;\n\n\tword32 a,b,c,d,e;\n\tfor (i=0; i<rounds/8; i++)\n\t{\n\t\tafterS2(LK); afterS2(S3); afterS3(SK);\n\t\tafterS1(LK); afterS1(S2); afterS2(SK);\n\t\tafterS0(LK); afterS0(S1); afterS1(SK);\n\t\tbeforeS0(LK); beforeS0(S0); afterS0(SK);\n\t\tk += 8*4;\n\t\tafterS6(LK); afterS6(S7); afterS7(SK);\n\t\tafterS5(LK); afterS5(S6); afterS6(SK);\n\t\tafterS4(LK); afterS4(S5); afterS5(SK);\n\t\tafterS3(LK); afterS3(S4); afterS4(SK);\n\t}\n\tafterS2(LK); afterS2(S3); afterS3(SK);\n}"
  }
]