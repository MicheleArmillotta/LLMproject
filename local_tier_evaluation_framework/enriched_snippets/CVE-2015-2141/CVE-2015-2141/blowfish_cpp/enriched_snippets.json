[
  {
    "function_name": "ProcessAndXorBlock",
    "container": "Blowfish::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blowfish.cpp",
    "lines": "71-97",
    "snippet": "void Blowfish::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\ttypedef BlockGetAndPut<word32, BigEndian> Block;\n\n\tword32 left, right;\n\tBlock::Get(inBlock)(left)(right);\n\n\tconst word32 *const s=sbox;\n\tconst word32 *p=pbox;\n\n\tleft ^= p[0];\n\n\tfor (unsigned i=0; i<ROUNDS/2; i++)\n\t{\n\t\tright ^= (((s[GETBYTE(left,3)] + s[256+GETBYTE(left,2)])\n\t\t\t  ^ s[2*256+GETBYTE(left,1)]) + s[3*256+GETBYTE(left,0)])\n\t\t\t  ^ p[2*i+1];\n\n\t\tleft ^= (((s[GETBYTE(right,3)] + s[256+GETBYTE(right,2)])\n\t\t\t ^ s[2*256+GETBYTE(right,1)]) + s[3*256+GETBYTE(right,0)])\n\t\t\t ^ p[2*i+2];\n\t}\n\n\tright ^= p[ROUNDS+1];\n\n\tBlock::Put(xorBlock, outBlock)(right)(left);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"blowfish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "left"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "right",
            "0"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "right",
            "1"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "right",
            "2"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "right",
            "3"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "left",
            "0"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "left",
            "1"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "left",
            "2"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "left",
            "3"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "right"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"blowfish.h\"\n#include \"pch.h\"\n\nBlowfish {\n  Base {\n    void Blowfish::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \ttypedef BlockGetAndPut<word32, BigEndian> Block;\n    \n    \tword32 left, right;\n    \tBlock::Get(inBlock)(left)(right);\n    \n    \tconst word32 *const s=sbox;\n    \tconst word32 *p=pbox;\n    \n    \tleft ^= p[0];\n    \n    \tfor (unsigned i=0; i<ROUNDS/2; i++)\n    \t{\n    \t\tright ^= (((s[GETBYTE(left,3)] + s[256+GETBYTE(left,2)])\n    \t\t\t  ^ s[2*256+GETBYTE(left,1)]) + s[3*256+GETBYTE(left,0)])\n    \t\t\t  ^ p[2*i+1];\n    \n    \t\tleft ^= (((s[GETBYTE(right,3)] + s[256+GETBYTE(right,2)])\n    \t\t\t ^ s[2*256+GETBYTE(right,1)]) + s[3*256+GETBYTE(right,0)])\n    \t\t\t ^ p[2*i+2];\n    \t}\n    \n    \tright ^= p[ROUNDS+1];\n    \n    \tBlock::Put(xorBlock, outBlock)(right)(left);\n    }\n  }\n}"
  },
  {
    "function_name": "crypt_block",
    "container": "Blowfish::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blowfish.cpp",
    "lines": "44-69",
    "snippet": "void Blowfish::Base::crypt_block(const word32 in[2], word32 out[2]) const\n{\n\tword32 left = in[0];\n\tword32 right = in[1];\n\n\tconst word32 *const s=sbox;\n\tconst word32 *p=pbox;\n\n\tleft ^= p[0];\n\n\tfor (unsigned i=0; i<ROUNDS/2; i++)\n\t{\n\t\tright ^= (((s[GETBYTE(left,3)] + s[256+GETBYTE(left,2)])\n\t\t\t  ^ s[2*256+GETBYTE(left,1)]) + s[3*256+GETBYTE(left,0)])\n\t\t\t  ^ p[2*i+1];\n\n\t\tleft ^= (((s[GETBYTE(right,3)] + s[256+GETBYTE(right,2)])\n\t\t\t ^ s[2*256+GETBYTE(right,1)]) + s[3*256+GETBYTE(right,0)])\n\t\t\t ^ p[2*i+2];\n\t}\n\n\tright ^= p[ROUNDS+1];\n\n\tout[0] = right;\n\tout[1] = left;\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"blowfish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "right",
            "0"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "right",
            "1"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "right",
            "2"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "right",
            "3"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "left",
            "0"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "left",
            "1"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "left",
            "2"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "left",
            "3"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"blowfish.h\"\n#include \"pch.h\"\n\nBlowfish {\n  Base {\n    void Blowfish::Base::crypt_block(const word32 in[2], word32 out[2]) const\n    {\n    \tword32 left = in[0];\n    \tword32 right = in[1];\n    \n    \tconst word32 *const s=sbox;\n    \tconst word32 *p=pbox;\n    \n    \tleft ^= p[0];\n    \n    \tfor (unsigned i=0; i<ROUNDS/2; i++)\n    \t{\n    \t\tright ^= (((s[GETBYTE(left,3)] + s[256+GETBYTE(left,2)])\n    \t\t\t  ^ s[2*256+GETBYTE(left,1)]) + s[3*256+GETBYTE(left,0)])\n    \t\t\t  ^ p[2*i+1];\n    \n    \t\tleft ^= (((s[GETBYTE(right,3)] + s[256+GETBYTE(right,2)])\n    \t\t\t ^ s[2*256+GETBYTE(right,1)]) + s[3*256+GETBYTE(right,0)])\n    \t\t\t ^ p[2*i+2];\n    \t}\n    \n    \tright ^= p[ROUNDS+1];\n    \n    \tout[0] = right;\n    \tout[1] = left;\n    }\n  }\n}"
  },
  {
    "function_name": "UncheckedSetKey",
    "container": "Blowfish::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blowfish.cpp",
    "lines": "9-41",
    "snippet": "void Blowfish::Base::UncheckedSetKey(const byte *key_string, unsigned int keylength, const NameValuePairs &)\n{\n\tAssertValidKeyLength(keylength);\n\n\tunsigned i, j=0, k;\n\tword32 data, dspace[2] = {0, 0};\n\n\tmemcpy(pbox, p_init, sizeof(p_init));\n\tmemcpy(sbox, s_init, sizeof(s_init));\n\n\t// Xor key string into encryption key vector\n\tfor (i=0 ; i<ROUNDS+2 ; ++i)\n\t{\n\t\tdata = 0 ;\n\t\tfor (k=0 ; k<4 ; ++k )\n\t\t\tdata = (data << 8) | key_string[j++ % keylength];\n\t\tpbox[i] ^= data;\n\t}\n\n\tcrypt_block(dspace, pbox);\n\n\tfor (i=0; i<ROUNDS; i+=2)\n\t\tcrypt_block(pbox+i, pbox+i+2);\n\n\tcrypt_block(pbox+ROUNDS, sbox);\n\n\tfor (i=0; i<4*256-2; i+=2)\n\t\tcrypt_block(sbox+i, sbox+i+2);\n\n\tif (!IsForwardTransformation())\n\t\tfor (i=0; i<(ROUNDS+2)/2; i++)\n\t\t\tstd::swap(pbox[i], pbox[ROUNDS+1-i]);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"blowfish.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::swap",
          "args": [
            "pbox[i]",
            "pbox[ROUNDS+1-i]"
          ],
          "line": 40
        },
        "resolved": true,
        "details": {
          "function_name": "swap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/polynomi.h",
          "lines": "453-456",
          "snippet": "inline void swap(CryptoPP::PolynomialOverFixedRing<T,i> &a, CryptoPP::PolynomialOverFixedRing<T,i> &b)\n{\n\ta.swap(b);\n}",
          "includes": [
            "#include <vector>",
            "#include <iosfwd>",
            "#include \"algebra.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <iosfwd>\n#include \"algebra.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\ninline void swap(CryptoPP::PolynomialOverFixedRing<T,i> &a, CryptoPP::PolynomialOverFixedRing<T,i> &b)\n{\n\ta.swap(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsForwardTransformation",
          "args": [],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.h",
          "lines": "25-25",
          "snippet": "bool IsForwardTransformation() const {return true;}",
          "includes": [
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n\nbool IsForwardTransformation() const {return true;}"
        }
      },
      {
        "call_info": {
          "callee": "crypt_block",
          "args": [
            "sbox+i",
            "sbox+i+2"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "crypt_block",
          "container": "Blowfish::Base",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/blowfish.cpp",
          "lines": "44-69",
          "snippet": "void Blowfish::Base::crypt_block(const word32 in[2], word32 out[2]) const\n{\n\tword32 left = in[0];\n\tword32 right = in[1];\n\n\tconst word32 *const s=sbox;\n\tconst word32 *p=pbox;\n\n\tleft ^= p[0];\n\n\tfor (unsigned i=0; i<ROUNDS/2; i++)\n\t{\n\t\tright ^= (((s[GETBYTE(left,3)] + s[256+GETBYTE(left,2)])\n\t\t\t  ^ s[2*256+GETBYTE(left,1)]) + s[3*256+GETBYTE(left,0)])\n\t\t\t  ^ p[2*i+1];\n\n\t\tleft ^= (((s[GETBYTE(right,3)] + s[256+GETBYTE(right,2)])\n\t\t\t ^ s[2*256+GETBYTE(right,1)]) + s[3*256+GETBYTE(right,0)])\n\t\t\t ^ p[2*i+2];\n\t}\n\n\tright ^= p[ROUNDS+1];\n\n\tout[0] = right;\n\tout[1] = left;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"blowfish.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"blowfish.h\"\n#include \"pch.h\"\n\nBlowfish {\n  Base {\n    void Blowfish::Base::crypt_block(const word32 in[2], word32 out[2]) const\n    {\n    \tword32 left = in[0];\n    \tword32 right = in[1];\n    \n    \tconst word32 *const s=sbox;\n    \tconst word32 *p=pbox;\n    \n    \tleft ^= p[0];\n    \n    \tfor (unsigned i=0; i<ROUNDS/2; i++)\n    \t{\n    \t\tright ^= (((s[GETBYTE(left,3)] + s[256+GETBYTE(left,2)])\n    \t\t\t  ^ s[2*256+GETBYTE(left,1)]) + s[3*256+GETBYTE(left,0)])\n    \t\t\t  ^ p[2*i+1];\n    \n    \t\tleft ^= (((s[GETBYTE(right,3)] + s[256+GETBYTE(right,2)])\n    \t\t\t ^ s[2*256+GETBYTE(right,1)]) + s[3*256+GETBYTE(right,0)])\n    \t\t\t ^ p[2*i+2];\n    \t}\n    \n    \tright ^= p[ROUNDS+1];\n    \n    \tout[0] = right;\n    \tout[1] = left;\n    }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "sbox",
            "s_init",
            "sizeof(s_init)"
          ],
          "line": 17
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "pbox",
            "p_init",
            "sizeof(p_init)"
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "keylength"
          ],
          "line": 11
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"blowfish.h\"\n#include \"pch.h\"\n\nBlowfish {\n  Base {\n    void Blowfish::Base::UncheckedSetKey(const byte *key_string, unsigned int keylength, const NameValuePairs &)\n    {\n    \tAssertValidKeyLength(keylength);\n    \n    \tunsigned i, j=0, k;\n    \tword32 data, dspace[2] = {0, 0};\n    \n    \tmemcpy(pbox, p_init, sizeof(p_init));\n    \tmemcpy(sbox, s_init, sizeof(s_init));\n    \n    \t// Xor key string into encryption key vector\n    \tfor (i=0 ; i<ROUNDS+2 ; ++i)\n    \t{\n    \t\tdata = 0 ;\n    \t\tfor (k=0 ; k<4 ; ++k )\n    \t\t\tdata = (data << 8) | key_string[j++ % keylength];\n    \t\tpbox[i] ^= data;\n    \t}\n    \n    \tcrypt_block(dspace, pbox);\n    \n    \tfor (i=0; i<ROUNDS; i+=2)\n    \t\tcrypt_block(pbox+i, pbox+i+2);\n    \n    \tcrypt_block(pbox+ROUNDS, sbox);\n    \n    \tfor (i=0; i<4*256-2; i+=2)\n    \t\tcrypt_block(sbox+i, sbox+i+2);\n    \n    \tif (!IsForwardTransformation())\n    \t\tfor (i=0; i<(ROUNDS+2)/2; i++)\n    \t\t\tstd::swap(pbox[i], pbox[ROUNDS+1-i]);\n    }\n  }\n}"
  }
]