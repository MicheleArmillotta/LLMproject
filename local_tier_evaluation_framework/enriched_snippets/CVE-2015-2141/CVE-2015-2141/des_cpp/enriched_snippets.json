[
  {
    "function_name": "DES_XEX3::Base::ProcessAndXorBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "442-447",
    "snippet": "void DES_XEX3::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\txorbuf(outBlock, inBlock, m_x1, BLOCKSIZE);\n\tm_des->ProcessAndXorBlock(outBlock, xorBlock, outBlock);\n\txorbuf(outBlock, m_x3, BLOCKSIZE);\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "xorbuf",
          "args": [
            "outBlock",
            "m_x3",
            "BLOCKSIZE"
          ],
          "line": 446
        },
        "resolved": true,
        "details": {
          "function_name": "xorbuf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.cpp",
          "lines": "17-45",
          "snippet": "void xorbuf(byte *buf, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(buf) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(buf) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)buf)[i] ^= ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\tbuf += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)buf)[i] ^= ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\tbuf += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\tbuf[i] ^= mask[i];\n}",
          "includes": [
            "#include <malloc.h>",
            "#include <new>",
            "#include \"words.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <malloc.h>\n#include <new>\n#include \"words.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid xorbuf(byte *buf, const byte *mask, size_t count)\n{\n\tsize_t i;\n\n\tif (IsAligned<word32>(buf) && IsAligned<word32>(mask))\n\t{\n\t\tif (!CRYPTOPP_BOOL_SLOW_WORD64 && IsAligned<word64>(buf) && IsAligned<word64>(mask))\n\t\t{\n\t\t\tfor (i=0; i<count/8; i++)\n\t\t\t\t((word64*)buf)[i] ^= ((word64*)mask)[i];\n\t\t\tcount -= 8*i;\n\t\t\tif (!count)\n\t\t\t\treturn;\n\t\t\tbuf += 8*i;\n\t\t\tmask += 8*i;\n\t\t}\n\n\t\tfor (i=0; i<count/4; i++)\n\t\t\t((word32*)buf)[i] ^= ((word32*)mask)[i];\n\t\tcount -= 4*i;\n\t\tif (!count)\n\t\t\treturn;\n\t\tbuf += 4*i;\n\t\tmask += 4*i;\n\t}\n\n\tfor (i=0; i<count; i++)\n\t\tbuf[i] ^= mask[i];\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_des->ProcessAndXorBlock",
          "args": [
            "outBlock",
            "xorBlock",
            "outBlock"
          ],
          "line": 445
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES_XEX3::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\txorbuf(outBlock, inBlock, m_x1, BLOCKSIZE);\n\tm_des->ProcessAndXorBlock(outBlock, xorBlock, outBlock);\n\txorbuf(outBlock, m_x3, BLOCKSIZE);\n}"
  },
  {
    "function_name": "DES_XEX3::Base::UncheckedSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "430-440",
    "snippet": "void DES_XEX3::Base::UncheckedSetKey(const byte *key, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tif (!m_des.get())\n\t\tm_des.reset(new DES::Encryption);\n\n\tmemcpy(m_x1, key + (IsForwardTransformation() ? 0 : 16), BLOCKSIZE);\n\tm_des->RawSetKey(GetCipherDirection(), key + 8);\n\tmemcpy(m_x3, key + (IsForwardTransformation() ? 16 : 0), BLOCKSIZE);\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m_x3",
            "key + (IsForwardTransformation() ? 16 : 0)",
            "BLOCKSIZE"
          ],
          "line": 439
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsForwardTransformation",
          "args": [],
          "line": 439
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.h",
          "lines": "25-25",
          "snippet": "bool IsForwardTransformation() const {return true;}",
          "includes": [
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n\nbool IsForwardTransformation() const {return true;}"
        }
      },
      {
        "call_info": {
          "callee": "m_des->RawSetKey",
          "args": [
            "GetCipherDirection()",
            "key + 8"
          ],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetCipherDirection",
          "args": [],
          "line": 438
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "m_x1",
            "key + (IsForwardTransformation() ? 0 : 16)",
            "BLOCKSIZE"
          ],
          "line": 437
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des.reset",
          "args": [
            "new DES::Encryption"
          ],
          "line": 435
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des.get",
          "args": [],
          "line": 434
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "length"
          ],
          "line": 432
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES_XEX3::Base::UncheckedSetKey(const byte *key, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tif (!m_des.get())\n\t\tm_des.reset(new DES::Encryption);\n\n\tmemcpy(m_x1, key + (IsForwardTransformation() ? 0 : 16), BLOCKSIZE);\n\tm_des->RawSetKey(GetCipherDirection(), key + 8);\n\tmemcpy(m_x3, key + (IsForwardTransformation() ? 16 : 0), BLOCKSIZE);\n}"
  },
  {
    "function_name": "DES::Base::ProcessAndXorBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "420-428",
    "snippet": "void DES::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 l,r;\n\tBlock::Get(inBlock)(l)(r);\n\tIPERM(l,r);\n\tRawProcessBlock(l, r);\n\tFPERM(l,r);\n\tBlock::Put(xorBlock, outBlock)(r)(l);\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "l"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 427
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "FPERM",
          "args": [
            "l",
            "r"
          ],
          "line": 426
        },
        "resolved": true,
        "details": {
          "function_name": "FPERM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "98-118",
          "snippet": "static inline void FPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotrFixed(right, 1U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 9U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 6U);\n\twork = (left ^ right) & 0x33333333;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 18U);\n\twork = (left ^ right) & 0xffff0000;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 20U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 4U);\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline void FPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotrFixed(right, 1U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 9U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 6U);\n\twork = (left ^ right) & 0x33333333;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 18U);\n\twork = (left ^ right) & 0xffff0000;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 20U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 4U);\n}"
        }
      },
      {
        "call_info": {
          "callee": "RawProcessBlock",
          "args": [
            "l",
            "r"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "RawDES::RawProcessBlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "322-353",
          "snippet": "void RawDES::RawProcessBlock(word32 &l_, word32 &r_) const\n{\n\tword32 l = l_, r = r_;\n\tconst word32 *kptr=k;\n\n\tfor (unsigned i=0; i<8; i++)\n\t{\n\t\tword32 work = rotrFixed(r, 4U) ^ kptr[4*i+0];\n\t\tl ^= Spbox[6][(work) & 0x3f]\n\t\t  ^  Spbox[4][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[2][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[0][(work >> 24) & 0x3f];\n\t\twork = r ^ kptr[4*i+1];\n\t\tl ^= Spbox[7][(work) & 0x3f]\n\t\t  ^  Spbox[5][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[3][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[1][(work >> 24) & 0x3f];\n\n\t\twork = rotrFixed(l, 4U) ^ kptr[4*i+2];\n\t\tr ^= Spbox[6][(work) & 0x3f]\n\t\t  ^  Spbox[4][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[2][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[0][(work >> 24) & 0x3f];\n\t\twork = l ^ kptr[4*i+3];\n\t\tr ^= Spbox[7][(work) & 0x3f]\n\t\t  ^  Spbox[5][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[3][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[1][(work >> 24) & 0x3f];\n\t}\n\n\tl_ = l; r_ = r;\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid RawDES::RawProcessBlock(word32 &l_, word32 &r_) const\n{\n\tword32 l = l_, r = r_;\n\tconst word32 *kptr=k;\n\n\tfor (unsigned i=0; i<8; i++)\n\t{\n\t\tword32 work = rotrFixed(r, 4U) ^ kptr[4*i+0];\n\t\tl ^= Spbox[6][(work) & 0x3f]\n\t\t  ^  Spbox[4][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[2][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[0][(work >> 24) & 0x3f];\n\t\twork = r ^ kptr[4*i+1];\n\t\tl ^= Spbox[7][(work) & 0x3f]\n\t\t  ^  Spbox[5][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[3][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[1][(work >> 24) & 0x3f];\n\n\t\twork = rotrFixed(l, 4U) ^ kptr[4*i+2];\n\t\tr ^= Spbox[6][(work) & 0x3f]\n\t\t  ^  Spbox[4][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[2][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[0][(work >> 24) & 0x3f];\n\t\twork = l ^ kptr[4*i+3];\n\t\tr ^= Spbox[7][(work) & 0x3f]\n\t\t  ^  Spbox[5][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[3][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[1][(work >> 24) & 0x3f];\n\t}\n\n\tl_ = l; r_ = r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IPERM",
          "args": [
            "l",
            "r"
          ],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "IPERM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "76-96",
          "snippet": "static inline void IPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotlFixed(right, 4U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 20U);\n\twork = (left ^ right) & 0xffff0000;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 18U);\n\twork = (left ^ right) & 0x33333333;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 6U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tleft ^= work;\n\tright = rotlFixed(right^work, 9U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tleft = rotlFixed(left^work, 1U);\n\tright ^= work;\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline void IPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotlFixed(right, 4U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 20U);\n\twork = (left ^ right) & 0xffff0000;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 18U);\n\twork = (left ^ right) & 0x33333333;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 6U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tleft ^= work;\n\tright = rotlFixed(right^work, 9U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tleft = rotlFixed(left^work, 1U);\n\tright ^= work;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "r"
          ],
          "line": 423
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 l,r;\n\tBlock::Get(inBlock)(l)(r);\n\tIPERM(l,r);\n\tRawProcessBlock(l, r);\n\tFPERM(l,r);\n\tBlock::Put(xorBlock, outBlock)(r)(l);\n}"
  },
  {
    "function_name": "DES::CorrectKeyParityBits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "412-417",
    "snippet": "void DES::CorrectKeyParityBits(byte *key)\n{\n\tfor (unsigned int i=0; i<8; i++)\n\t\tif (!CheckParity(key[i]))\n\t\t\tkey[i] ^= 1;\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckParity",
          "args": [
            "key[i]"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "CheckParity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "398-402",
          "snippet": "static inline bool CheckParity(byte b)\n{\n\tunsigned int a = b ^ (b >> 4);\n\treturn ((a ^ (a>>1) ^ (a>>2) ^ (a>>3)) & 1) == 1;\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline bool CheckParity(byte b)\n{\n\tunsigned int a = b ^ (b >> 4);\n\treturn ((a ^ (a>>1) ^ (a>>2) ^ (a>>3)) & 1) == 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES::CorrectKeyParityBits(byte *key)\n{\n\tfor (unsigned int i=0; i<8; i++)\n\t\tif (!CheckParity(key[i]))\n\t\t\tkey[i] ^= 1;\n}"
  },
  {
    "function_name": "DES::CheckKeyParityBits",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "404-410",
    "snippet": "bool DES::CheckKeyParityBits(const byte *key)\n{\n\tfor (unsigned int i=0; i<8; i++)\n\t\tif (!CheckParity(key[i]))\n\t\t\treturn false;\n\treturn true;\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CheckParity",
          "args": [
            "key[i]"
          ],
          "line": 407
        },
        "resolved": true,
        "details": {
          "function_name": "CheckParity",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "398-402",
          "snippet": "static inline bool CheckParity(byte b)\n{\n\tunsigned int a = b ^ (b >> 4);\n\treturn ((a ^ (a>>1) ^ (a>>2) ^ (a>>3)) & 1) == 1;\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline bool CheckParity(byte b)\n{\n\tunsigned int a = b ^ (b >> 4);\n\treturn ((a ^ (a>>1) ^ (a>>2) ^ (a>>3)) & 1) == 1;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nbool DES::CheckKeyParityBits(const byte *key)\n{\n\tfor (unsigned int i=0; i<8; i++)\n\t\tif (!CheckParity(key[i]))\n\t\t\treturn false;\n\treturn true;\n}"
  },
  {
    "function_name": "CheckParity",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "398-402",
    "snippet": "static inline bool CheckParity(byte b)\n{\n\tunsigned int a = b ^ (b >> 4);\n\treturn ((a ^ (a>>1) ^ (a>>2) ^ (a>>3)) & 1) == 1;\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline bool CheckParity(byte b)\n{\n\tunsigned int a = b ^ (b >> 4);\n\treturn ((a ^ (a>>1) ^ (a>>2) ^ (a>>3)) & 1) == 1;\n}"
  },
  {
    "function_name": "DES_EDE3::Base::ProcessAndXorBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "384-394",
    "snippet": "void DES_EDE3::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 l,r;\n\tBlock::Get(inBlock)(l)(r);\n\tIPERM(l,r);\n\tm_des1.RawProcessBlock(l, r);\n\tm_des2.RawProcessBlock(r, l);\n\tm_des3.RawProcessBlock(l, r);\n\tFPERM(l,r);\n\tBlock::Put(xorBlock, outBlock)(r)(l);\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "l"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 393
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "FPERM",
          "args": [
            "l",
            "r"
          ],
          "line": 392
        },
        "resolved": true,
        "details": {
          "function_name": "FPERM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "98-118",
          "snippet": "static inline void FPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotrFixed(right, 1U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 9U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 6U);\n\twork = (left ^ right) & 0x33333333;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 18U);\n\twork = (left ^ right) & 0xffff0000;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 20U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 4U);\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline void FPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotrFixed(right, 1U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 9U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 6U);\n\twork = (left ^ right) & 0x33333333;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 18U);\n\twork = (left ^ right) & 0xffff0000;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 20U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 4U);\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_des3.RawProcessBlock",
          "args": [
            "l",
            "r"
          ],
          "line": 391
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des2.RawProcessBlock",
          "args": [
            "r",
            "l"
          ],
          "line": 390
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des1.RawProcessBlock",
          "args": [
            "l",
            "r"
          ],
          "line": 389
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IPERM",
          "args": [
            "l",
            "r"
          ],
          "line": 388
        },
        "resolved": true,
        "details": {
          "function_name": "IPERM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "76-96",
          "snippet": "static inline void IPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotlFixed(right, 4U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 20U);\n\twork = (left ^ right) & 0xffff0000;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 18U);\n\twork = (left ^ right) & 0x33333333;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 6U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tleft ^= work;\n\tright = rotlFixed(right^work, 9U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tleft = rotlFixed(left^work, 1U);\n\tright ^= work;\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline void IPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotlFixed(right, 4U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 20U);\n\twork = (left ^ right) & 0xffff0000;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 18U);\n\twork = (left ^ right) & 0x33333333;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 6U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tleft ^= work;\n\tright = rotlFixed(right^work, 9U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tleft = rotlFixed(left^work, 1U);\n\tright ^= work;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "r"
          ],
          "line": 387
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES_EDE3::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 l,r;\n\tBlock::Get(inBlock)(l)(r);\n\tIPERM(l,r);\n\tm_des1.RawProcessBlock(l, r);\n\tm_des2.RawProcessBlock(r, l);\n\tm_des3.RawProcessBlock(l, r);\n\tFPERM(l,r);\n\tBlock::Put(xorBlock, outBlock)(r)(l);\n}"
  },
  {
    "function_name": "DES_EDE3::Base::UncheckedSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "375-382",
    "snippet": "void DES_EDE3::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tm_des1.RawSetKey(GetCipherDirection(), userKey + (IsForwardTransformation() ? 0 : 16));\n\tm_des2.RawSetKey(ReverseCipherDir(GetCipherDirection()), userKey + 8);\n\tm_des3.RawSetKey(GetCipherDirection(), userKey + (IsForwardTransformation() ? 16 : 0));\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_des3.RawSetKey",
          "args": [
            "GetCipherDirection()",
            "userKey + (IsForwardTransformation() ? 16 : 0)"
          ],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsForwardTransformation",
          "args": [],
          "line": 381
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.h",
          "lines": "25-25",
          "snippet": "bool IsForwardTransformation() const {return true;}",
          "includes": [
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n\nbool IsForwardTransformation() const {return true;}"
        }
      },
      {
        "call_info": {
          "callee": "GetCipherDirection",
          "args": [],
          "line": 381
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des2.RawSetKey",
          "args": [
            "ReverseCipherDir(GetCipherDirection())",
            "userKey + 8"
          ],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReverseCipherDir",
          "args": [
            "GetCipherDirection()"
          ],
          "line": 380
        },
        "resolved": true,
        "details": {
          "function_name": "ReverseCipherDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "14-17",
          "snippet": "inline CipherDir ReverseCipherDir(CipherDir dir)\n{\n\treturn (dir == ENCRYPTION) ? DECRYPTION : ENCRYPTION;\n}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\ninline CipherDir ReverseCipherDir(CipherDir dir)\n{\n\treturn (dir == ENCRYPTION) ? DECRYPTION : ENCRYPTION;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetCipherDirection",
          "args": [],
          "line": 380
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des1.RawSetKey",
          "args": [
            "GetCipherDirection()",
            "userKey + (IsForwardTransformation() ? 0 : 16)"
          ],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetCipherDirection",
          "args": [],
          "line": 379
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "length"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES_EDE3::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tm_des1.RawSetKey(GetCipherDirection(), userKey + (IsForwardTransformation() ? 0 : 16));\n\tm_des2.RawSetKey(ReverseCipherDir(GetCipherDirection()), userKey + 8);\n\tm_des3.RawSetKey(GetCipherDirection(), userKey + (IsForwardTransformation() ? 16 : 0));\n}"
  },
  {
    "function_name": "DES_EDE2::Base::ProcessAndXorBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "363-373",
    "snippet": "void DES_EDE2::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 l,r;\n\tBlock::Get(inBlock)(l)(r);\n\tIPERM(l,r);\n\tm_des1.RawProcessBlock(l, r);\n\tm_des2.RawProcessBlock(r, l);\n\tm_des1.RawProcessBlock(l, r);\n\tFPERM(l,r);\n\tBlock::Put(xorBlock, outBlock)(r)(l);\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "l"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "FPERM",
          "args": [
            "l",
            "r"
          ],
          "line": 371
        },
        "resolved": true,
        "details": {
          "function_name": "FPERM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "98-118",
          "snippet": "static inline void FPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotrFixed(right, 1U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 9U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 6U);\n\twork = (left ^ right) & 0x33333333;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 18U);\n\twork = (left ^ right) & 0xffff0000;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 20U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 4U);\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline void FPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotrFixed(right, 1U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 9U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 6U);\n\twork = (left ^ right) & 0x33333333;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 18U);\n\twork = (left ^ right) & 0xffff0000;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 20U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 4U);\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_des1.RawProcessBlock",
          "args": [
            "l",
            "r"
          ],
          "line": 370
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des2.RawProcessBlock",
          "args": [
            "r",
            "l"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des1.RawProcessBlock",
          "args": [
            "l",
            "r"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IPERM",
          "args": [
            "l",
            "r"
          ],
          "line": 367
        },
        "resolved": true,
        "details": {
          "function_name": "IPERM",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "76-96",
          "snippet": "static inline void IPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotlFixed(right, 4U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 20U);\n\twork = (left ^ right) & 0xffff0000;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 18U);\n\twork = (left ^ right) & 0x33333333;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 6U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tleft ^= work;\n\tright = rotlFixed(right^work, 9U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tleft = rotlFixed(left^work, 1U);\n\tright ^= work;\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline void IPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotlFixed(right, 4U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 20U);\n\twork = (left ^ right) & 0xffff0000;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 18U);\n\twork = (left ^ right) & 0x33333333;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 6U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tleft ^= work;\n\tright = rotlFixed(right^work, 9U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tleft = rotlFixed(left^work, 1U);\n\tright ^= work;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "r"
          ],
          "line": 366
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES_EDE2::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 l,r;\n\tBlock::Get(inBlock)(l)(r);\n\tIPERM(l,r);\n\tm_des1.RawProcessBlock(l, r);\n\tm_des2.RawProcessBlock(r, l);\n\tm_des1.RawProcessBlock(l, r);\n\tFPERM(l,r);\n\tBlock::Put(xorBlock, outBlock)(r)(l);\n}"
  },
  {
    "function_name": "DES_EDE2::Base::UncheckedSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "355-361",
    "snippet": "void DES_EDE2::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tm_des1.RawSetKey(GetCipherDirection(), userKey);\n\tm_des2.RawSetKey(ReverseCipherDir(GetCipherDirection()), userKey+8);\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "m_des2.RawSetKey",
          "args": [
            "ReverseCipherDir(GetCipherDirection())",
            "userKey+8"
          ],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ReverseCipherDir",
          "args": [
            "GetCipherDirection()"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "ReverseCipherDir",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/seckey.h",
          "lines": "14-17",
          "snippet": "inline CipherDir ReverseCipherDir(CipherDir dir)\n{\n\treturn (dir == ENCRYPTION) ? DECRYPTION : ENCRYPTION;\n}",
          "includes": [
            "#include \"simple.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"simple.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\ninline CipherDir ReverseCipherDir(CipherDir dir)\n{\n\treturn (dir == ENCRYPTION) ? DECRYPTION : ENCRYPTION;\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetCipherDirection",
          "args": [],
          "line": 360
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_des1.RawSetKey",
          "args": [
            "GetCipherDirection()",
            "userKey"
          ],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetCipherDirection",
          "args": [],
          "line": 359
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "length"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES_EDE2::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tm_des1.RawSetKey(GetCipherDirection(), userKey);\n\tm_des2.RawSetKey(ReverseCipherDir(GetCipherDirection()), userKey+8);\n}"
  },
  {
    "function_name": "RawDES::RawProcessBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "322-353",
    "snippet": "void RawDES::RawProcessBlock(word32 &l_, word32 &r_) const\n{\n\tword32 l = l_, r = r_;\n\tconst word32 *kptr=k;\n\n\tfor (unsigned i=0; i<8; i++)\n\t{\n\t\tword32 work = rotrFixed(r, 4U) ^ kptr[4*i+0];\n\t\tl ^= Spbox[6][(work) & 0x3f]\n\t\t  ^  Spbox[4][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[2][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[0][(work >> 24) & 0x3f];\n\t\twork = r ^ kptr[4*i+1];\n\t\tl ^= Spbox[7][(work) & 0x3f]\n\t\t  ^  Spbox[5][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[3][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[1][(work >> 24) & 0x3f];\n\n\t\twork = rotrFixed(l, 4U) ^ kptr[4*i+2];\n\t\tr ^= Spbox[6][(work) & 0x3f]\n\t\t  ^  Spbox[4][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[2][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[0][(work >> 24) & 0x3f];\n\t\twork = l ^ kptr[4*i+3];\n\t\tr ^= Spbox[7][(work) & 0x3f]\n\t\t  ^  Spbox[5][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[3][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[1][(work >> 24) & 0x3f];\n\t}\n\n\tl_ = l; r_ = r;\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rotrFixed",
          "args": [
            "l",
            "4U"
          ],
          "line": 340
        },
        "resolved": true,
        "details": {
          "function_name": "rotrFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "586-590",
          "snippet": "inline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid RawDES::RawProcessBlock(word32 &l_, word32 &r_) const\n{\n\tword32 l = l_, r = r_;\n\tconst word32 *kptr=k;\n\n\tfor (unsigned i=0; i<8; i++)\n\t{\n\t\tword32 work = rotrFixed(r, 4U) ^ kptr[4*i+0];\n\t\tl ^= Spbox[6][(work) & 0x3f]\n\t\t  ^  Spbox[4][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[2][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[0][(work >> 24) & 0x3f];\n\t\twork = r ^ kptr[4*i+1];\n\t\tl ^= Spbox[7][(work) & 0x3f]\n\t\t  ^  Spbox[5][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[3][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[1][(work >> 24) & 0x3f];\n\n\t\twork = rotrFixed(l, 4U) ^ kptr[4*i+2];\n\t\tr ^= Spbox[6][(work) & 0x3f]\n\t\t  ^  Spbox[4][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[2][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[0][(work >> 24) & 0x3f];\n\t\twork = l ^ kptr[4*i+3];\n\t\tr ^= Spbox[7][(work) & 0x3f]\n\t\t  ^  Spbox[5][(work >> 8) & 0x3f]\n\t\t  ^  Spbox[3][(work >> 16) & 0x3f]\n\t\t  ^  Spbox[1][(work >> 24) & 0x3f];\n\t}\n\n\tl_ = l; r_ = r;\n}"
  },
  {
    "function_name": "RawDES::RawSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "274-320",
    "snippet": "void RawDES::RawSetKey(CipherDir dir, const byte *key)\n{\n\tSecByteBlock buffer(56+56+8);\n\tbyte *const pc1m=buffer;                 /* place to modify pc1 into */\n\tbyte *const pcr=pc1m+56;                 /* place to rotate pc1 into */\n\tbyte *const ks=pcr+56;\n\tregister int i,j,l;\n\tint m;\n\t\n\tfor (j=0; j<56; j++) {          /* convert pc1 to bits of key */\n\t\tl=pc1[j]-1;             /* integer bit location  */\n\t\tm = l & 07;             /* find bit              */\n\t\tpc1m[j]=(key[l>>3] &    /* find which key byte l is in */\n\t\t\tbytebit[m])     /* and which bit of that byte */\n\t\t\t? 1 : 0;        /* and store 1-bit result */\n\t}\n\tfor (i=0; i<16; i++) {          /* key chunk for each iteration */\n\t\tmemset(ks,0,8);         /* Clear key schedule */\n\t\tfor (j=0; j<56; j++)    /* rotate pc1 the right amount */\n\t\t\tpcr[j] = pc1m[(l=j+totrot[i])<(j<28? 28 : 56) ? l: l-28];\n\t\t/* rotate left and right halves independently */\n\t\tfor (j=0; j<48; j++){   /* select bits individually */\n\t\t\t/* check bit that goes to ks[j] */\n\t\t\tif (pcr[pc2[j]-1]){\n\t\t\t\t/* mask it in if it's there */\n\t\t\t\tl= j % 6;\n\t\t\t\tks[j/6] |= bytebit[l] >> 2;\n\t\t\t}\n\t\t}\n\t\t/* Now convert to odd/even interleaved form for use in F */\n\t\tk[2*i] = ((word32)ks[0] << 24)\n\t\t\t| ((word32)ks[2] << 16)\n\t\t\t| ((word32)ks[4] << 8)\n\t\t\t| ((word32)ks[6]);\n\t\tk[2*i+1] = ((word32)ks[1] << 24)\n\t\t\t| ((word32)ks[3] << 16)\n\t\t\t| ((word32)ks[5] << 8)\n\t\t\t| ((word32)ks[7]);\n\t}\n\t\n\tif (dir==DECRYPTION)     // reverse key schedule order\n\t\tfor (i=0; i<16; i+=2)\n\t\t{\n\t\t\tstd::swap(k[i], k[32-2-i]);\n\t\t\tstd::swap(k[i+1], k[32-1-i]);\n\t\t}\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::swap",
          "args": [
            "k[i+1]",
            "k[32-1-i]"
          ],
          "line": 318
        },
        "resolved": true,
        "details": {
          "function_name": "swap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/polynomi.h",
          "lines": "453-456",
          "snippet": "inline void swap(CryptoPP::PolynomialOverFixedRing<T,i> &a, CryptoPP::PolynomialOverFixedRing<T,i> &b)\n{\n\ta.swap(b);\n}",
          "includes": [
            "#include <vector>",
            "#include <iosfwd>",
            "#include \"algebra.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <iosfwd>\n#include \"algebra.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\ninline void swap(CryptoPP::PolynomialOverFixedRing<T,i> &a, CryptoPP::PolynomialOverFixedRing<T,i> &b)\n{\n\ta.swap(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "ks",
            "0",
            "8"
          ],
          "line": 291
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid RawDES::RawSetKey(CipherDir dir, const byte *key)\n{\n\tSecByteBlock buffer(56+56+8);\n\tbyte *const pc1m=buffer;                 /* place to modify pc1 into */\n\tbyte *const pcr=pc1m+56;                 /* place to rotate pc1 into */\n\tbyte *const ks=pcr+56;\n\tregister int i,j,l;\n\tint m;\n\t\n\tfor (j=0; j<56; j++) {          /* convert pc1 to bits of key */\n\t\tl=pc1[j]-1;             /* integer bit location  */\n\t\tm = l & 07;             /* find bit              */\n\t\tpc1m[j]=(key[l>>3] &    /* find which key byte l is in */\n\t\t\tbytebit[m])     /* and which bit of that byte */\n\t\t\t? 1 : 0;        /* and store 1-bit result */\n\t}\n\tfor (i=0; i<16; i++) {          /* key chunk for each iteration */\n\t\tmemset(ks,0,8);         /* Clear key schedule */\n\t\tfor (j=0; j<56; j++)    /* rotate pc1 the right amount */\n\t\t\tpcr[j] = pc1m[(l=j+totrot[i])<(j<28? 28 : 56) ? l: l-28];\n\t\t/* rotate left and right halves independently */\n\t\tfor (j=0; j<48; j++){   /* select bits individually */\n\t\t\t/* check bit that goes to ks[j] */\n\t\t\tif (pcr[pc2[j]-1]){\n\t\t\t\t/* mask it in if it's there */\n\t\t\t\tl= j % 6;\n\t\t\t\tks[j/6] |= bytebit[l] >> 2;\n\t\t\t}\n\t\t}\n\t\t/* Now convert to odd/even interleaved form for use in F */\n\t\tk[2*i] = ((word32)ks[0] << 24)\n\t\t\t| ((word32)ks[2] << 16)\n\t\t\t| ((word32)ks[4] << 8)\n\t\t\t| ((word32)ks[6]);\n\t\tk[2*i+1] = ((word32)ks[1] << 24)\n\t\t\t| ((word32)ks[3] << 16)\n\t\t\t| ((word32)ks[5] << 8)\n\t\t\t| ((word32)ks[7]);\n\t}\n\t\n\tif (dir==DECRYPTION)     // reverse key schedule order\n\t\tfor (i=0; i<16; i+=2)\n\t\t{\n\t\t\tstd::swap(k[i], k[32-2-i]);\n\t\t\tstd::swap(k[i+1], k[32-1-i]);\n\t\t}\n}"
  },
  {
    "function_name": "DES::Base::UncheckedSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "120-125",
    "snippet": "void DES::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tRawSetKey(GetCipherDirection(), userKey);\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "RawSetKey",
          "args": [
            "GetCipherDirection()",
            "userKey"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "RawDES::RawSetKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
          "lines": "274-320",
          "snippet": "void RawDES::RawSetKey(CipherDir dir, const byte *key)\n{\n\tSecByteBlock buffer(56+56+8);\n\tbyte *const pc1m=buffer;                 /* place to modify pc1 into */\n\tbyte *const pcr=pc1m+56;                 /* place to rotate pc1 into */\n\tbyte *const ks=pcr+56;\n\tregister int i,j,l;\n\tint m;\n\t\n\tfor (j=0; j<56; j++) {          /* convert pc1 to bits of key */\n\t\tl=pc1[j]-1;             /* integer bit location  */\n\t\tm = l & 07;             /* find bit              */\n\t\tpc1m[j]=(key[l>>3] &    /* find which key byte l is in */\n\t\t\tbytebit[m])     /* and which bit of that byte */\n\t\t\t? 1 : 0;        /* and store 1-bit result */\n\t}\n\tfor (i=0; i<16; i++) {          /* key chunk for each iteration */\n\t\tmemset(ks,0,8);         /* Clear key schedule */\n\t\tfor (j=0; j<56; j++)    /* rotate pc1 the right amount */\n\t\t\tpcr[j] = pc1m[(l=j+totrot[i])<(j<28? 28 : 56) ? l: l-28];\n\t\t/* rotate left and right halves independently */\n\t\tfor (j=0; j<48; j++){   /* select bits individually */\n\t\t\t/* check bit that goes to ks[j] */\n\t\t\tif (pcr[pc2[j]-1]){\n\t\t\t\t/* mask it in if it's there */\n\t\t\t\tl= j % 6;\n\t\t\t\tks[j/6] |= bytebit[l] >> 2;\n\t\t\t}\n\t\t}\n\t\t/* Now convert to odd/even interleaved form for use in F */\n\t\tk[2*i] = ((word32)ks[0] << 24)\n\t\t\t| ((word32)ks[2] << 16)\n\t\t\t| ((word32)ks[4] << 8)\n\t\t\t| ((word32)ks[6]);\n\t\tk[2*i+1] = ((word32)ks[1] << 24)\n\t\t\t| ((word32)ks[3] << 16)\n\t\t\t| ((word32)ks[5] << 8)\n\t\t\t| ((word32)ks[7]);\n\t}\n\t\n\tif (dir==DECRYPTION)     // reverse key schedule order\n\t\tfor (i=0; i<16; i+=2)\n\t\t{\n\t\t\tstd::swap(k[i], k[32-2-i]);\n\t\t\tstd::swap(k[i+1], k[32-1-i]);\n\t\t}\n}",
          "includes": [
            "#include \"des.h\"",
            "#include \"misc.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid RawDES::RawSetKey(CipherDir dir, const byte *key)\n{\n\tSecByteBlock buffer(56+56+8);\n\tbyte *const pc1m=buffer;                 /* place to modify pc1 into */\n\tbyte *const pcr=pc1m+56;                 /* place to rotate pc1 into */\n\tbyte *const ks=pcr+56;\n\tregister int i,j,l;\n\tint m;\n\t\n\tfor (j=0; j<56; j++) {          /* convert pc1 to bits of key */\n\t\tl=pc1[j]-1;             /* integer bit location  */\n\t\tm = l & 07;             /* find bit              */\n\t\tpc1m[j]=(key[l>>3] &    /* find which key byte l is in */\n\t\t\tbytebit[m])     /* and which bit of that byte */\n\t\t\t? 1 : 0;        /* and store 1-bit result */\n\t}\n\tfor (i=0; i<16; i++) {          /* key chunk for each iteration */\n\t\tmemset(ks,0,8);         /* Clear key schedule */\n\t\tfor (j=0; j<56; j++)    /* rotate pc1 the right amount */\n\t\t\tpcr[j] = pc1m[(l=j+totrot[i])<(j<28? 28 : 56) ? l: l-28];\n\t\t/* rotate left and right halves independently */\n\t\tfor (j=0; j<48; j++){   /* select bits individually */\n\t\t\t/* check bit that goes to ks[j] */\n\t\t\tif (pcr[pc2[j]-1]){\n\t\t\t\t/* mask it in if it's there */\n\t\t\t\tl= j % 6;\n\t\t\t\tks[j/6] |= bytebit[l] >> 2;\n\t\t\t}\n\t\t}\n\t\t/* Now convert to odd/even interleaved form for use in F */\n\t\tk[2*i] = ((word32)ks[0] << 24)\n\t\t\t| ((word32)ks[2] << 16)\n\t\t\t| ((word32)ks[4] << 8)\n\t\t\t| ((word32)ks[6]);\n\t\tk[2*i+1] = ((word32)ks[1] << 24)\n\t\t\t| ((word32)ks[3] << 16)\n\t\t\t| ((word32)ks[5] << 8)\n\t\t\t| ((word32)ks[7]);\n\t}\n\t\n\tif (dir==DECRYPTION)     // reverse key schedule order\n\t\tfor (i=0; i<16; i+=2)\n\t\t{\n\t\t\tstd::swap(k[i], k[32-2-i]);\n\t\t\tstd::swap(k[i+1], k[32-1-i]);\n\t\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetCipherDirection",
          "args": [],
          "line": 124
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "length"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nvoid DES::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tRawSetKey(GetCipherDirection(), userKey);\n}"
  },
  {
    "function_name": "FPERM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "98-118",
    "snippet": "static inline void FPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotrFixed(right, 1U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 9U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 6U);\n\twork = (left ^ right) & 0x33333333;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 18U);\n\twork = (left ^ right) & 0xffff0000;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 20U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 4U);\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rotrFixed",
          "args": [
            "left^work",
            "4U"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "rotrFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "586-590",
          "snippet": "inline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "left^work",
            "20U"
          ],
          "line": 114
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline void FPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotrFixed(right, 1U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 9U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 6U);\n\twork = (left ^ right) & 0x33333333;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 18U);\n\twork = (left ^ right) & 0xffff0000;\n\tright ^= work;\n\tleft = rotlFixed(left^work, 20U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tright ^= work;\n\tleft = rotrFixed(left^work, 4U);\n}"
  },
  {
    "function_name": "IPERM",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/des.cpp",
    "lines": "76-96",
    "snippet": "static inline void IPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotlFixed(right, 4U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 20U);\n\twork = (left ^ right) & 0xffff0000;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 18U);\n\twork = (left ^ right) & 0x33333333;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 6U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tleft ^= work;\n\tright = rotlFixed(right^work, 9U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tleft = rotlFixed(left^work, 1U);\n\tright ^= work;\n}",
    "includes": [
      "#include \"des.h\"",
      "#include \"misc.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "left^work",
            "1U"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotrFixed",
          "args": [
            "right^work",
            "6U"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "rotrFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "586-590",
          "snippet": "inline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"des.h\"\n#include \"misc.h\"\n#include \"pch.h\"\n\nstatic inline void IPERM(word32 &left, word32 &right)\n{\n\tword32 work;\n\n\tright = rotlFixed(right, 4U);\n\twork = (left ^ right) & 0xf0f0f0f0;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 20U);\n\twork = (left ^ right) & 0xffff0000;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 18U);\n\twork = (left ^ right) & 0x33333333;\n\tleft ^= work;\n\tright = rotrFixed(right^work, 6U);\n\twork = (left ^ right) & 0x00ff00ff;\n\tleft ^= work;\n\tright = rotlFixed(right^work, 9U);\n\twork = (left ^ right) & 0xaaaaaaaa;\n\tleft = rotlFixed(left^work, 1U);\n\tright ^= work;\n}"
  }
]