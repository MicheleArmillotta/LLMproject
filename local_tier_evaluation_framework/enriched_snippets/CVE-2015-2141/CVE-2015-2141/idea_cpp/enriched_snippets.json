[
  {
    "function_name": "IDEA::Base::ProcessAndXorBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "158-190",
    "snippet": "void IDEA::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\ttypedef BlockGetAndPut<word16, BigEndian> Block;\n\n\tconst IDEA::Word *key = m_key;\n\tIDEA::Word x0,x1,x2,x3,t0,t1;\n\tBlock::Get(inBlock)(x0)(x1)(x2)(x3);\n\n\tfor (unsigned int i=0; i<ROUNDS; i++)\n\t{\n\t\tMUL(x0, key[i*6+0]);\n\t\tx1 += key[i*6+1];\n\t\tx2 += key[i*6+2];\n\t\tMUL(x3, key[i*6+3]);\n\t\tt0 = x0^x2; \n\t\tMUL(t0, key[i*6+4]);\n\t\tt1 = t0 + (x1^x3);\n\t\tMUL(t1, key[i*6+5]);\n\t\tt0 += t1;\n\t\tx0 ^= t1;\n\t\tx3 ^= t0;\n\t\tt0 ^= x1;\n\t\tx1 = x2^t1;\n\t\tx2 = t0;\n\t}\n\n\tMUL(x0, key[ROUNDS*6+0]);\n\tx2 += key[ROUNDS*6+1];\n\tx1 += key[ROUNDS*6+2];\n\tMUL(x3, key[ROUNDS*6+3]);\n\n\tBlock::Put(xorBlock, outBlock)(x0)(x2)(x1)(x3);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "x3"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "MUL",
          "args": [
            "x3",
            "key[ROUNDS*6+3]"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "IDEA::Base::LookupMUL",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
          "lines": "75-78",
          "snippet": "inline void IDEA::Base::LookupMUL(IDEA::Word &a, IDEA::Word b)\n{\n\ta = antilog[low16(log[low16(a)]+b)];\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"idea.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\ninline void IDEA::Base::LookupMUL(IDEA::Word &a, IDEA::Word b)\n{\n\ta = antilog[low16(log[low16(a)]+b)];\n}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "x3"
          ],
          "line": 164
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nvoid IDEA::Base::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\ttypedef BlockGetAndPut<word16, BigEndian> Block;\n\n\tconst IDEA::Word *key = m_key;\n\tIDEA::Word x0,x1,x2,x3,t0,t1;\n\tBlock::Get(inBlock)(x0)(x1)(x2)(x3);\n\n\tfor (unsigned int i=0; i<ROUNDS; i++)\n\t{\n\t\tMUL(x0, key[i*6+0]);\n\t\tx1 += key[i*6+1];\n\t\tx2 += key[i*6+2];\n\t\tMUL(x3, key[i*6+3]);\n\t\tt0 = x0^x2; \n\t\tMUL(t0, key[i*6+4]);\n\t\tt1 = t0 + (x1^x3);\n\t\tMUL(t1, key[i*6+5]);\n\t\tt0 += t1;\n\t\tx0 ^= t1;\n\t\tx3 ^= t0;\n\t\tt0 ^= x1;\n\t\tx1 = x2^t1;\n\t\tx2 = t0;\n\t}\n\n\tMUL(x0, key[ROUNDS*6+0]);\n\tx2 += key[ROUNDS*6+1];\n\tx1 += key[ROUNDS*6+2];\n\tMUL(x3, key[ROUNDS*6+3]);\n\n\tBlock::Put(xorBlock, outBlock)(x0)(x2)(x1)(x3);\n}"
  },
  {
    "function_name": "IDEA::Base::DeKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "129-150",
    "snippet": "void IDEA::Base::DeKey()\n{\n\tFixedSizeSecBlock<IDEA::Word, 6*ROUNDS+4> tempkey;\n\tsize_t i;\n\n\tfor (i=0; i<ROUNDS; i++)\n\t{\n\t\ttempkey[i*6+0] = MulInv(m_key[(ROUNDS-i)*6+0]);\n\t\ttempkey[i*6+1] = AddInv(m_key[(ROUNDS-i)*6+1+(i>0)]);\n\t\ttempkey[i*6+2] = AddInv(m_key[(ROUNDS-i)*6+2-(i>0)]);\n\t\ttempkey[i*6+3] = MulInv(m_key[(ROUNDS-i)*6+3]);\n\t\ttempkey[i*6+4] =        m_key[(ROUNDS-1-i)*6+4];\n\t\ttempkey[i*6+5] =        m_key[(ROUNDS-1-i)*6+5];\n\t}\n\n\ttempkey[i*6+0] = MulInv(m_key[(ROUNDS-i)*6+0]);\n\ttempkey[i*6+1] = AddInv(m_key[(ROUNDS-i)*6+1]);\n\ttempkey[i*6+2] = AddInv(m_key[(ROUNDS-i)*6+2]);\n\ttempkey[i*6+3] = MulInv(m_key[(ROUNDS-i)*6+3]);\n\n\tm_key = tempkey;\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "MulInv",
          "args": [
            "m_key[(ROUNDS-i)*6+3]"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "MulInv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
          "lines": "113-122",
          "snippet": "static IDEA::Word MulInv(IDEA::Word x)\n{\n\tIDEA::Word y=x;\n\tfor (unsigned i=0; i<15; i++)\n\t{\n\t\tDirectMUL(y,low16(y));\n\t\tDirectMUL(y,x);\n\t}\n\treturn low16(y);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"idea.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nstatic IDEA::Word MulInv(IDEA::Word x)\n{\n\tIDEA::Word y=x;\n\tfor (unsigned i=0; i<15; i++)\n\t{\n\t\tDirectMUL(y,low16(y));\n\t\tDirectMUL(y,x);\n\t}\n\treturn low16(y);\n}"
        }
      },
      {
        "call_info": {
          "callee": "AddInv",
          "args": [
            "m_key[(ROUNDS-i)*6+2]"
          ],
          "line": 146
        },
        "resolved": true,
        "details": {
          "function_name": "AddInv",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
          "lines": "124-127",
          "snippet": "static inline IDEA::Word AddInv(IDEA::Word x)\n{\n\treturn low16(0-x);\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"idea.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nstatic inline IDEA::Word AddInv(IDEA::Word x)\n{\n\treturn low16(0-x);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nvoid IDEA::Base::DeKey()\n{\n\tFixedSizeSecBlock<IDEA::Word, 6*ROUNDS+4> tempkey;\n\tsize_t i;\n\n\tfor (i=0; i<ROUNDS; i++)\n\t{\n\t\ttempkey[i*6+0] = MulInv(m_key[(ROUNDS-i)*6+0]);\n\t\ttempkey[i*6+1] = AddInv(m_key[(ROUNDS-i)*6+1+(i>0)]);\n\t\ttempkey[i*6+2] = AddInv(m_key[(ROUNDS-i)*6+2-(i>0)]);\n\t\ttempkey[i*6+3] = MulInv(m_key[(ROUNDS-i)*6+3]);\n\t\ttempkey[i*6+4] =        m_key[(ROUNDS-1-i)*6+4];\n\t\ttempkey[i*6+5] =        m_key[(ROUNDS-1-i)*6+5];\n\t}\n\n\ttempkey[i*6+0] = MulInv(m_key[(ROUNDS-i)*6+0]);\n\ttempkey[i*6+1] = AddInv(m_key[(ROUNDS-i)*6+1]);\n\ttempkey[i*6+2] = AddInv(m_key[(ROUNDS-i)*6+2]);\n\ttempkey[i*6+3] = MulInv(m_key[(ROUNDS-i)*6+3]);\n\n\tm_key = tempkey;\n}"
  },
  {
    "function_name": "AddInv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "124-127",
    "snippet": "static inline IDEA::Word AddInv(IDEA::Word x)\n{\n\treturn low16(0-x);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "low16",
          "args": [
            "0-x"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nstatic inline IDEA::Word AddInv(IDEA::Word x)\n{\n\treturn low16(0-x);\n}"
  },
  {
    "function_name": "MulInv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "113-122",
    "snippet": "static IDEA::Word MulInv(IDEA::Word x)\n{\n\tIDEA::Word y=x;\n\tfor (unsigned i=0; i<15; i++)\n\t{\n\t\tDirectMUL(y,low16(y));\n\t\tDirectMUL(y,x);\n\t}\n\treturn low16(y);\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "low16",
          "args": [
            "y"
          ],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectMUL",
          "args": [
            "y",
            "x"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DirectMUL",
          "args": [
            "y",
            "low16(y)"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "low16",
          "args": [
            "y"
          ],
          "line": 118
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nstatic IDEA::Word MulInv(IDEA::Word x)\n{\n\tIDEA::Word y=x;\n\tfor (unsigned i=0; i<15; i++)\n\t{\n\t\tDirectMUL(y,low16(y));\n\t\tDirectMUL(y,x);\n\t}\n\treturn low16(y);\n}"
  },
  {
    "function_name": "IDEA::Base::EnKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "99-111",
    "snippet": "void IDEA::Base::EnKey (const byte *userKey)\n{\n\tunsigned int i;\n\t\n\tfor (i=0; i<8; i++)\n\t\tm_key[i] = ((IDEA::Word)userKey[2*i]<<8) | userKey[2*i+1];\n\t\n\tfor (; i<IDEA_KEYLEN; i++)\n\t{\n\t\tunsigned int j = RoundDownToMultipleOf(i,8U)-8;\n\t\tm_key[i] = low16((m_key[j+(i+1)%8] << 9) | (m_key[j+(i+2)%8] >> 7));\n\t}\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const int IDEA_KEYLEN=(6*IDEA::ROUNDS+4);"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "low16",
          "args": [
            "(m_key[j+(i+1)%8] << 9) | (m_key[j+(i+2)%8] >> 7)"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "RoundDownToMultipleOf",
          "args": [
            "i",
            "8U"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "RoundDownToMultipleOf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "346-352",
          "snippet": "inline T1 RoundDownToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (IsPowerOf2(m))\n\t\treturn n - ModPowerOf2(n, m);\n\telse\n\t\treturn n - n%m;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T1 RoundDownToMultipleOf(const T1 &n, const T2 &m)\n{\n\tif (IsPowerOf2(m))\n\t\treturn n - ModPowerOf2(n, m);\n\telse\n\t\treturn n - n%m;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nstatic const int IDEA_KEYLEN=(6*IDEA::ROUNDS+4);\n\nvoid IDEA::Base::EnKey (const byte *userKey)\n{\n\tunsigned int i;\n\t\n\tfor (i=0; i<8; i++)\n\t\tm_key[i] = ((IDEA::Word)userKey[2*i]<<8) | userKey[2*i+1];\n\t\n\tfor (; i<IDEA_KEYLEN; i++)\n\t{\n\t\tunsigned int j = RoundDownToMultipleOf(i,8U)-8;\n\t\tm_key[i] = low16((m_key[j+(i+1)%8] << 9) | (m_key[j+(i+2)%8] >> 7));\n\t}\n}"
  },
  {
    "function_name": "IDEA::Base::UncheckedSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "81-97",
    "snippet": "void IDEA::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\t\n#ifdef IDEA_LARGECACHE\n\tBuildLogTables();\n#endif\n\t\n\tEnKey(userKey);\n\t\n\tif (!IsForwardTransformation())\n\t\tDeKey();\n\t\n#ifdef IDEA_LARGECACHE\n\tLookupKeyLogs();\n#endif\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "LookupKeyLogs",
          "args": [],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "IDEA::Base::LookupKeyLogs",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
          "lines": "59-73",
          "snippet": "void IDEA::Base::LookupKeyLogs()\n{\n\tIDEA::Word* Z=key;\n\tint r=ROUNDS;\n\tdo\n\t{\n\t\tZ[0] = log[Z[0]];\n\t\tZ[3] = log[Z[3]];\n\t\tZ[4] = log[Z[4]];\n\t\tZ[5] = log[Z[5]];\n\t\tZ+=6;\n\t} while (--r);\n\tZ[0] = log[Z[0]];\n\tZ[3] = log[Z[3]];\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"idea.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nvoid IDEA::Base::LookupKeyLogs()\n{\n\tIDEA::Word* Z=key;\n\tint r=ROUNDS;\n\tdo\n\t{\n\t\tZ[0] = log[Z[0]];\n\t\tZ[3] = log[Z[3]];\n\t\tZ[4] = log[Z[4]];\n\t\tZ[5] = log[Z[5]];\n\t\tZ+=6;\n\t} while (--r);\n\tZ[0] = log[Z[0]];\n\tZ[3] = log[Z[3]];\n}"
        }
      },
      {
        "call_info": {
          "callee": "DeKey",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "IDEA::Base::DeKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
          "lines": "129-150",
          "snippet": "void IDEA::Base::DeKey()\n{\n\tFixedSizeSecBlock<IDEA::Word, 6*ROUNDS+4> tempkey;\n\tsize_t i;\n\n\tfor (i=0; i<ROUNDS; i++)\n\t{\n\t\ttempkey[i*6+0] = MulInv(m_key[(ROUNDS-i)*6+0]);\n\t\ttempkey[i*6+1] = AddInv(m_key[(ROUNDS-i)*6+1+(i>0)]);\n\t\ttempkey[i*6+2] = AddInv(m_key[(ROUNDS-i)*6+2-(i>0)]);\n\t\ttempkey[i*6+3] = MulInv(m_key[(ROUNDS-i)*6+3]);\n\t\ttempkey[i*6+4] =        m_key[(ROUNDS-1-i)*6+4];\n\t\ttempkey[i*6+5] =        m_key[(ROUNDS-1-i)*6+5];\n\t}\n\n\ttempkey[i*6+0] = MulInv(m_key[(ROUNDS-i)*6+0]);\n\ttempkey[i*6+1] = AddInv(m_key[(ROUNDS-i)*6+1]);\n\ttempkey[i*6+2] = AddInv(m_key[(ROUNDS-i)*6+2]);\n\ttempkey[i*6+3] = MulInv(m_key[(ROUNDS-i)*6+3]);\n\n\tm_key = tempkey;\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"idea.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nvoid IDEA::Base::DeKey()\n{\n\tFixedSizeSecBlock<IDEA::Word, 6*ROUNDS+4> tempkey;\n\tsize_t i;\n\n\tfor (i=0; i<ROUNDS; i++)\n\t{\n\t\ttempkey[i*6+0] = MulInv(m_key[(ROUNDS-i)*6+0]);\n\t\ttempkey[i*6+1] = AddInv(m_key[(ROUNDS-i)*6+1+(i>0)]);\n\t\ttempkey[i*6+2] = AddInv(m_key[(ROUNDS-i)*6+2-(i>0)]);\n\t\ttempkey[i*6+3] = MulInv(m_key[(ROUNDS-i)*6+3]);\n\t\ttempkey[i*6+4] =        m_key[(ROUNDS-1-i)*6+4];\n\t\ttempkey[i*6+5] =        m_key[(ROUNDS-1-i)*6+5];\n\t}\n\n\ttempkey[i*6+0] = MulInv(m_key[(ROUNDS-i)*6+0]);\n\ttempkey[i*6+1] = AddInv(m_key[(ROUNDS-i)*6+1]);\n\ttempkey[i*6+2] = AddInv(m_key[(ROUNDS-i)*6+2]);\n\ttempkey[i*6+3] = MulInv(m_key[(ROUNDS-i)*6+3]);\n\n\tm_key = tempkey;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsForwardTransformation",
          "args": [],
          "line": 91
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.h",
          "lines": "25-25",
          "snippet": "bool IsForwardTransformation() const {return true;}",
          "includes": [
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n\nbool IsForwardTransformation() const {return true;}"
        }
      },
      {
        "call_info": {
          "callee": "EnKey",
          "args": [
            "userKey"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "IDEA::Base::EnKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
          "lines": "99-111",
          "snippet": "void IDEA::Base::EnKey (const byte *userKey)\n{\n\tunsigned int i;\n\t\n\tfor (i=0; i<8; i++)\n\t\tm_key[i] = ((IDEA::Word)userKey[2*i]<<8) | userKey[2*i+1];\n\t\n\tfor (; i<IDEA_KEYLEN; i++)\n\t{\n\t\tunsigned int j = RoundDownToMultipleOf(i,8U)-8;\n\t\tm_key[i] = low16((m_key[j+(i+1)%8] << 9) | (m_key[j+(i+2)%8] >> 7));\n\t}\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"idea.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const int IDEA_KEYLEN=(6*IDEA::ROUNDS+4);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nstatic const int IDEA_KEYLEN=(6*IDEA::ROUNDS+4);\n\nvoid IDEA::Base::EnKey (const byte *userKey)\n{\n\tunsigned int i;\n\t\n\tfor (i=0; i<8; i++)\n\t\tm_key[i] = ((IDEA::Word)userKey[2*i]<<8) | userKey[2*i+1];\n\t\n\tfor (; i<IDEA_KEYLEN; i++)\n\t{\n\t\tunsigned int j = RoundDownToMultipleOf(i,8U)-8;\n\t\tm_key[i] = low16((m_key[j+(i+1)%8] << 9) | (m_key[j+(i+2)%8] >> 7));\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "BuildLogTables",
          "args": [],
          "line": 86
        },
        "resolved": true,
        "details": {
          "function_name": "IDEA::Base::BuildLogTables",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
          "lines": "37-57",
          "snippet": "void IDEA::Base::BuildLogTables()\n{\n\tif (tablesBuilt)\n\t\treturn;\n\telse\n\t{\n\t\ttablesBuilt = true;\n\t\t\n\t\tIDEA::Word x=1;\n\t\tword32 i;\n\t\t\n\t\tfor (i=0; i<0x10000; i++)\n\t\t{\n\t\t\tantilog[i] = (word16)x;\n\t\t\tDirectMUL(x, 3);\n\t\t}\n\t\t\n\t\tfor (i=0; i<0x10000; i++)\n\t\t\tlog[antilog[i]] = (word16)i;\n\t}\n}",
          "includes": [
            "#include \"misc.h\"",
            "#include \"idea.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nvoid IDEA::Base::BuildLogTables()\n{\n\tif (tablesBuilt)\n\t\treturn;\n\telse\n\t{\n\t\ttablesBuilt = true;\n\t\t\n\t\tIDEA::Word x=1;\n\t\tword32 i;\n\t\t\n\t\tfor (i=0; i<0x10000; i++)\n\t\t{\n\t\t\tantilog[i] = (word16)x;\n\t\t\tDirectMUL(x, 3);\n\t\t}\n\t\t\n\t\tfor (i=0; i<0x10000; i++)\n\t\t\tlog[antilog[i]] = (word16)i;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "length"
          ],
          "line": 83
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nvoid IDEA::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\t\n#ifdef IDEA_LARGECACHE\n\tBuildLogTables();\n#endif\n\t\n\tEnKey(userKey);\n\t\n\tif (!IsForwardTransformation())\n\t\tDeKey();\n\t\n#ifdef IDEA_LARGECACHE\n\tLookupKeyLogs();\n#endif\n}"
  },
  {
    "function_name": "IDEA::Base::LookupMUL",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "75-78",
    "snippet": "inline void IDEA::Base::LookupMUL(IDEA::Word &a, IDEA::Word b)\n{\n\ta = antilog[low16(log[low16(a)]+b)];\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "low16",
          "args": [
            "log[low16(a)]+b"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "low16",
          "args": [
            "a"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\ninline void IDEA::Base::LookupMUL(IDEA::Word &a, IDEA::Word b)\n{\n\ta = antilog[low16(log[low16(a)]+b)];\n}"
  },
  {
    "function_name": "IDEA::Base::LookupKeyLogs",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "59-73",
    "snippet": "void IDEA::Base::LookupKeyLogs()\n{\n\tIDEA::Word* Z=key;\n\tint r=ROUNDS;\n\tdo\n\t{\n\t\tZ[0] = log[Z[0]];\n\t\tZ[3] = log[Z[3]];\n\t\tZ[4] = log[Z[4]];\n\t\tZ[5] = log[Z[5]];\n\t\tZ+=6;\n\t} while (--r);\n\tZ[0] = log[Z[0]];\n\tZ[3] = log[Z[3]];\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nvoid IDEA::Base::LookupKeyLogs()\n{\n\tIDEA::Word* Z=key;\n\tint r=ROUNDS;\n\tdo\n\t{\n\t\tZ[0] = log[Z[0]];\n\t\tZ[3] = log[Z[3]];\n\t\tZ[4] = log[Z[4]];\n\t\tZ[5] = log[Z[5]];\n\t\tZ+=6;\n\t} while (--r);\n\tZ[0] = log[Z[0]];\n\tZ[3] = log[Z[3]];\n}"
  },
  {
    "function_name": "IDEA::Base::BuildLogTables",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/idea.cpp",
    "lines": "37-57",
    "snippet": "void IDEA::Base::BuildLogTables()\n{\n\tif (tablesBuilt)\n\t\treturn;\n\telse\n\t{\n\t\ttablesBuilt = true;\n\t\t\n\t\tIDEA::Word x=1;\n\t\tword32 i;\n\t\t\n\t\tfor (i=0; i<0x10000; i++)\n\t\t{\n\t\t\tantilog[i] = (word16)x;\n\t\t\tDirectMUL(x, 3);\n\t\t}\n\t\t\n\t\tfor (i=0; i<0x10000; i++)\n\t\t\tlog[antilog[i]] = (word16)i;\n\t}\n}",
    "includes": [
      "#include \"misc.h\"",
      "#include \"idea.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "DirectMUL",
          "args": [
            "x",
            "3"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"misc.h\"\n#include \"idea.h\"\n#include \"pch.h\"\n\nvoid IDEA::Base::BuildLogTables()\n{\n\tif (tablesBuilt)\n\t\treturn;\n\telse\n\t{\n\t\ttablesBuilt = true;\n\t\t\n\t\tIDEA::Word x=1;\n\t\tword32 i;\n\t\t\n\t\tfor (i=0; i<0x10000; i++)\n\t\t{\n\t\t\tantilog[i] = (word16)x;\n\t\t\tDirectMUL(x, 3);\n\t\t}\n\t\t\n\t\tfor (i=0; i<0x10000; i++)\n\t\t\tlog[antilog[i]] = (word16)i;\n\t}\n}"
  }
]