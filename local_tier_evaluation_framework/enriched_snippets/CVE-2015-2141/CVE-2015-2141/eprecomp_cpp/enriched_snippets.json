[
  {
    "function_name": "DL_FixedBasePrecomputationImpl<T>::CascadeExponentiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
    "lines": "98-108",
    "snippet": "T \n\tDL_FixedBasePrecomputationImpl<T>::CascadeExponentiate(const DL_GroupPrecomputation<Element> &group, const Integer &exponent, \n\t\tconst DL_FixedBasePrecomputation<T> &i_pc2, const Integer &exponent2) const\n{\n\tstd::vector<BaseAndExponent<Element> > eb;\t// array of segments of the exponent and precalculated bases\n\tconst DL_FixedBasePrecomputationImpl<T> &pc2 = static_cast<const DL_FixedBasePrecomputationImpl<T> &>(i_pc2);\n\teb.reserve(m_bases.size() + pc2.m_bases.size());\n\tPrepareCascade(group, eb, exponent);\n\tpc2.PrepareCascade(group, eb, exponent2);\n\treturn group.ConvertOut(GeneralCascadeMultiplication<Element>(group.GetGroup(), eb.begin(), eb.end()));\n}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"eprecomp.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group.ConvertOut",
          "args": [
            "GeneralCascadeMultiplication<Element>(group.GetGroup(), eb.begin(), eb.end())"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertOut",
          "container": "DL_GroupPrecomputation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.h",
          "lines": "18-18",
          "snippet": "virtual Element ConvertOut(const Element &v) const {return v;}",
          "includes": [
            "#include \"eprecomp.cpp\"",
            "#include <vector>",
            "#include \"algebra.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eprecomp.cpp\"\n#include <vector>\n#include \"algebra.h\"\n#include \"integer.h\"\n\nDL_GroupPrecomputation {\n  virtual Element ConvertOut(const Element &v) const {return v;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GeneralCascadeMultiplication<Element>",
          "args": [
            "group.GetGroup()",
            "eb.begin()",
            "eb.end()"
          ],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "GeneralCascadeMultiplication",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algebra.cpp",
          "lines": "172-204",
          "snippet": "Element GeneralCascadeMultiplication(const AbstractGroup<Element> &group, Iterator begin, Iterator end)\n{\n\tif (end-begin == 1)\n\t\treturn group.ScalarMultiply(begin->base, begin->exponent);\n\telse if (end-begin == 2)\n\t\treturn group.CascadeScalarMultiply(begin->base, begin->exponent, (begin+1)->base, (begin+1)->exponent);\n\telse\n\t{\n\t\tInteger q, t;\n\t\tIterator last = end;\n\t\t--last;\n\n\t\tstd::make_heap(begin, end);\n\t\tstd::pop_heap(begin, end);\n\n\t\twhile (!!begin->exponent)\n\t\t{\n\t\t\t// last->exponent is largest exponent, begin->exponent is next largest\n\t\t\tt = last->exponent;\n\t\t\tInteger::Divide(last->exponent, q, t, begin->exponent);\n\n\t\t\tif (q == Integer::One())\n\t\t\t\tgroup.Accumulate(begin->base, last->base);\t// avoid overhead of ScalarMultiply()\n\t\t\telse\n\t\t\t\tgroup.Accumulate(begin->base, group.ScalarMultiply(last->base, q));\n\n\t\t\tstd::push_heap(begin, end);\n\t\t\tstd::pop_heap(begin, end);\n\t\t}\n\n\t\treturn group.ScalarMultiply(last->base, last->exponent);\n\t}\n}",
          "includes": [
            "#include <vector>",
            "#include \"integer.h\"",
            "#include \"algebra.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"integer.h\"\n#include \"algebra.h\"\n#include \"pch.h\"\n\nElement GeneralCascadeMultiplication(const AbstractGroup<Element> &group, Iterator begin, Iterator end)\n{\n\tif (end-begin == 1)\n\t\treturn group.ScalarMultiply(begin->base, begin->exponent);\n\telse if (end-begin == 2)\n\t\treturn group.CascadeScalarMultiply(begin->base, begin->exponent, (begin+1)->base, (begin+1)->exponent);\n\telse\n\t{\n\t\tInteger q, t;\n\t\tIterator last = end;\n\t\t--last;\n\n\t\tstd::make_heap(begin, end);\n\t\tstd::pop_heap(begin, end);\n\n\t\twhile (!!begin->exponent)\n\t\t{\n\t\t\t// last->exponent is largest exponent, begin->exponent is next largest\n\t\t\tt = last->exponent;\n\t\t\tInteger::Divide(last->exponent, q, t, begin->exponent);\n\n\t\t\tif (q == Integer::One())\n\t\t\t\tgroup.Accumulate(begin->base, last->base);\t// avoid overhead of ScalarMultiply()\n\t\t\telse\n\t\t\t\tgroup.Accumulate(begin->base, group.ScalarMultiply(last->base, q));\n\n\t\t\tstd::push_heap(begin, end);\n\t\t\tstd::pop_heap(begin, end);\n\t\t}\n\n\t\treturn group.ScalarMultiply(last->base, last->exponent);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "eb.end",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "296-297",
          "snippet": "const_iterator end() const\n\t\t{return m_ptr+m_size;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator end() const\n  \t\t{return m_ptr+m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "eb.begin",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "group.GetGroup",
          "args": [],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pc2.PrepareCascade",
          "args": [
            "group",
            "eb",
            "exponent2"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PrepareCascade",
          "args": [
            "group",
            "eb",
            "exponent"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "DL_FixedBasePrecomputationImpl<T>::PrepareCascade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
          "lines": "67-88",
          "snippet": "void DL_FixedBasePrecomputationImpl<T>::PrepareCascade(const DL_GroupPrecomputation<Element> &i_group, std::vector<BaseAndExponent<Element> > &eb, const Integer &exponent) const\n{\n\tconst AbstractGroup<T> &group = i_group.GetGroup();\n\n\tInteger r, q, e = exponent;\n\tbool fastNegate = group.InversionIsFast() && m_windowSize > 1;\n\tunsigned int i;\n\n\tfor (i=0; i+1<m_bases.size(); i++)\n\t{\n\t\tInteger::DivideByPowerOf2(r, q, e, m_windowSize);\n\t\tstd::swap(q, e);\n\t\tif (fastNegate && r.GetBit(m_windowSize-1))\n\t\t{\n\t\t\t++e;\n\t\t\teb.push_back(BaseAndExponent<Element>(group.Inverse(m_bases[i]), m_exponentBase - r));\n\t\t}\n\t\telse\n\t\t\teb.push_back(BaseAndExponent<Element>(m_bases[i], r));\n\t}\n\teb.push_back(BaseAndExponent<Element>(m_bases[i], e));\n}",
          "includes": [
            "#include \"asn.h\"",
            "#include \"eprecomp.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nvoid DL_FixedBasePrecomputationImpl<T>::PrepareCascade(const DL_GroupPrecomputation<Element> &i_group, std::vector<BaseAndExponent<Element> > &eb, const Integer &exponent) const\n{\n\tconst AbstractGroup<T> &group = i_group.GetGroup();\n\n\tInteger r, q, e = exponent;\n\tbool fastNegate = group.InversionIsFast() && m_windowSize > 1;\n\tunsigned int i;\n\n\tfor (i=0; i+1<m_bases.size(); i++)\n\t{\n\t\tInteger::DivideByPowerOf2(r, q, e, m_windowSize);\n\t\tstd::swap(q, e);\n\t\tif (fastNegate && r.GetBit(m_windowSize-1))\n\t\t{\n\t\t\t++e;\n\t\t\teb.push_back(BaseAndExponent<Element>(group.Inverse(m_bases[i]), m_exponentBase - r));\n\t\t}\n\t\telse\n\t\t\teb.push_back(BaseAndExponent<Element>(m_bases[i], r));\n\t}\n\teb.push_back(BaseAndExponent<Element>(m_bases[i], e));\n}"
        }
      },
      {
        "call_info": {
          "callee": "eb.reserve",
          "args": [
            "m_bases.size() + pc2.m_bases.size()"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pc2.m_bases.size",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<const DL_FixedBasePrecomputationImpl<T> &>",
          "args": [
            "i_pc2"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nT \n\tDL_FixedBasePrecomputationImpl<T>::CascadeExponentiate(const DL_GroupPrecomputation<Element> &group, const Integer &exponent, \n\t\tconst DL_FixedBasePrecomputation<T> &i_pc2, const Integer &exponent2) const\n{\n\tstd::vector<BaseAndExponent<Element> > eb;\t// array of segments of the exponent and precalculated bases\n\tconst DL_FixedBasePrecomputationImpl<T> &pc2 = static_cast<const DL_FixedBasePrecomputationImpl<T> &>(i_pc2);\n\teb.reserve(m_bases.size() + pc2.m_bases.size());\n\tPrepareCascade(group, eb, exponent);\n\tpc2.PrepareCascade(group, eb, exponent2);\n\treturn group.ConvertOut(GeneralCascadeMultiplication<Element>(group.GetGroup(), eb.begin(), eb.end()));\n}"
  },
  {
    "function_name": "DL_FixedBasePrecomputationImpl<T>::Exponentiate",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
    "lines": "90-96",
    "snippet": "T DL_FixedBasePrecomputationImpl<T>::Exponentiate(const DL_GroupPrecomputation<Element> &group, const Integer &exponent) const\n{\n\tstd::vector<BaseAndExponent<Element> > eb;\t// array of segments of the exponent and precalculated bases\n\teb.reserve(m_bases.size());\n\tPrepareCascade(group, eb, exponent);\n\treturn group.ConvertOut(GeneralCascadeMultiplication<Element>(group.GetGroup(), eb.begin(), eb.end()));\n}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"eprecomp.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group.ConvertOut",
          "args": [
            "GeneralCascadeMultiplication<Element>(group.GetGroup(), eb.begin(), eb.end())"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertOut",
          "container": "DL_GroupPrecomputation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.h",
          "lines": "18-18",
          "snippet": "virtual Element ConvertOut(const Element &v) const {return v;}",
          "includes": [
            "#include \"eprecomp.cpp\"",
            "#include <vector>",
            "#include \"algebra.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eprecomp.cpp\"\n#include <vector>\n#include \"algebra.h\"\n#include \"integer.h\"\n\nDL_GroupPrecomputation {\n  virtual Element ConvertOut(const Element &v) const {return v;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GeneralCascadeMultiplication<Element>",
          "args": [
            "group.GetGroup()",
            "eb.begin()",
            "eb.end()"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "GeneralCascadeMultiplication",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algebra.cpp",
          "lines": "172-204",
          "snippet": "Element GeneralCascadeMultiplication(const AbstractGroup<Element> &group, Iterator begin, Iterator end)\n{\n\tif (end-begin == 1)\n\t\treturn group.ScalarMultiply(begin->base, begin->exponent);\n\telse if (end-begin == 2)\n\t\treturn group.CascadeScalarMultiply(begin->base, begin->exponent, (begin+1)->base, (begin+1)->exponent);\n\telse\n\t{\n\t\tInteger q, t;\n\t\tIterator last = end;\n\t\t--last;\n\n\t\tstd::make_heap(begin, end);\n\t\tstd::pop_heap(begin, end);\n\n\t\twhile (!!begin->exponent)\n\t\t{\n\t\t\t// last->exponent is largest exponent, begin->exponent is next largest\n\t\t\tt = last->exponent;\n\t\t\tInteger::Divide(last->exponent, q, t, begin->exponent);\n\n\t\t\tif (q == Integer::One())\n\t\t\t\tgroup.Accumulate(begin->base, last->base);\t// avoid overhead of ScalarMultiply()\n\t\t\telse\n\t\t\t\tgroup.Accumulate(begin->base, group.ScalarMultiply(last->base, q));\n\n\t\t\tstd::push_heap(begin, end);\n\t\t\tstd::pop_heap(begin, end);\n\t\t}\n\n\t\treturn group.ScalarMultiply(last->base, last->exponent);\n\t}\n}",
          "includes": [
            "#include <vector>",
            "#include \"integer.h\"",
            "#include \"algebra.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"integer.h\"\n#include \"algebra.h\"\n#include \"pch.h\"\n\nElement GeneralCascadeMultiplication(const AbstractGroup<Element> &group, Iterator begin, Iterator end)\n{\n\tif (end-begin == 1)\n\t\treturn group.ScalarMultiply(begin->base, begin->exponent);\n\telse if (end-begin == 2)\n\t\treturn group.CascadeScalarMultiply(begin->base, begin->exponent, (begin+1)->base, (begin+1)->exponent);\n\telse\n\t{\n\t\tInteger q, t;\n\t\tIterator last = end;\n\t\t--last;\n\n\t\tstd::make_heap(begin, end);\n\t\tstd::pop_heap(begin, end);\n\n\t\twhile (!!begin->exponent)\n\t\t{\n\t\t\t// last->exponent is largest exponent, begin->exponent is next largest\n\t\t\tt = last->exponent;\n\t\t\tInteger::Divide(last->exponent, q, t, begin->exponent);\n\n\t\t\tif (q == Integer::One())\n\t\t\t\tgroup.Accumulate(begin->base, last->base);\t// avoid overhead of ScalarMultiply()\n\t\t\telse\n\t\t\t\tgroup.Accumulate(begin->base, group.ScalarMultiply(last->base, q));\n\n\t\t\tstd::push_heap(begin, end);\n\t\t\tstd::pop_heap(begin, end);\n\t\t}\n\n\t\treturn group.ScalarMultiply(last->base, last->exponent);\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "eb.end",
          "args": [],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "296-297",
          "snippet": "const_iterator end() const\n\t\t{return m_ptr+m_size;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator end() const\n  \t\t{return m_ptr+m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "eb.begin",
          "args": [],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "292-293",
          "snippet": "const_iterator begin() const\n\t\t{return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  const_iterator begin() const\n  \t\t{return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "group.GetGroup",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PrepareCascade",
          "args": [
            "group",
            "eb",
            "exponent"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "DL_FixedBasePrecomputationImpl<T>::PrepareCascade",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
          "lines": "67-88",
          "snippet": "void DL_FixedBasePrecomputationImpl<T>::PrepareCascade(const DL_GroupPrecomputation<Element> &i_group, std::vector<BaseAndExponent<Element> > &eb, const Integer &exponent) const\n{\n\tconst AbstractGroup<T> &group = i_group.GetGroup();\n\n\tInteger r, q, e = exponent;\n\tbool fastNegate = group.InversionIsFast() && m_windowSize > 1;\n\tunsigned int i;\n\n\tfor (i=0; i+1<m_bases.size(); i++)\n\t{\n\t\tInteger::DivideByPowerOf2(r, q, e, m_windowSize);\n\t\tstd::swap(q, e);\n\t\tif (fastNegate && r.GetBit(m_windowSize-1))\n\t\t{\n\t\t\t++e;\n\t\t\teb.push_back(BaseAndExponent<Element>(group.Inverse(m_bases[i]), m_exponentBase - r));\n\t\t}\n\t\telse\n\t\t\teb.push_back(BaseAndExponent<Element>(m_bases[i], r));\n\t}\n\teb.push_back(BaseAndExponent<Element>(m_bases[i], e));\n}",
          "includes": [
            "#include \"asn.h\"",
            "#include \"eprecomp.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nvoid DL_FixedBasePrecomputationImpl<T>::PrepareCascade(const DL_GroupPrecomputation<Element> &i_group, std::vector<BaseAndExponent<Element> > &eb, const Integer &exponent) const\n{\n\tconst AbstractGroup<T> &group = i_group.GetGroup();\n\n\tInteger r, q, e = exponent;\n\tbool fastNegate = group.InversionIsFast() && m_windowSize > 1;\n\tunsigned int i;\n\n\tfor (i=0; i+1<m_bases.size(); i++)\n\t{\n\t\tInteger::DivideByPowerOf2(r, q, e, m_windowSize);\n\t\tstd::swap(q, e);\n\t\tif (fastNegate && r.GetBit(m_windowSize-1))\n\t\t{\n\t\t\t++e;\n\t\t\teb.push_back(BaseAndExponent<Element>(group.Inverse(m_bases[i]), m_exponentBase - r));\n\t\t}\n\t\telse\n\t\t\teb.push_back(BaseAndExponent<Element>(m_bases[i], r));\n\t}\n\teb.push_back(BaseAndExponent<Element>(m_bases[i], e));\n}"
        }
      },
      {
        "call_info": {
          "callee": "eb.reserve",
          "args": [
            "m_bases.size()"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_bases.size",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nT DL_FixedBasePrecomputationImpl<T>::Exponentiate(const DL_GroupPrecomputation<Element> &group, const Integer &exponent) const\n{\n\tstd::vector<BaseAndExponent<Element> > eb;\t// array of segments of the exponent and precalculated bases\n\teb.reserve(m_bases.size());\n\tPrepareCascade(group, eb, exponent);\n\treturn group.ConvertOut(GeneralCascadeMultiplication<Element>(group.GetGroup(), eb.begin(), eb.end()));\n}"
  },
  {
    "function_name": "DL_FixedBasePrecomputationImpl<T>::PrepareCascade",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
    "lines": "67-88",
    "snippet": "void DL_FixedBasePrecomputationImpl<T>::PrepareCascade(const DL_GroupPrecomputation<Element> &i_group, std::vector<BaseAndExponent<Element> > &eb, const Integer &exponent) const\n{\n\tconst AbstractGroup<T> &group = i_group.GetGroup();\n\n\tInteger r, q, e = exponent;\n\tbool fastNegate = group.InversionIsFast() && m_windowSize > 1;\n\tunsigned int i;\n\n\tfor (i=0; i+1<m_bases.size(); i++)\n\t{\n\t\tInteger::DivideByPowerOf2(r, q, e, m_windowSize);\n\t\tstd::swap(q, e);\n\t\tif (fastNegate && r.GetBit(m_windowSize-1))\n\t\t{\n\t\t\t++e;\n\t\t\teb.push_back(BaseAndExponent<Element>(group.Inverse(m_bases[i]), m_exponentBase - r));\n\t\t}\n\t\telse\n\t\t\teb.push_back(BaseAndExponent<Element>(m_bases[i], r));\n\t}\n\teb.push_back(BaseAndExponent<Element>(m_bases[i], e));\n}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"eprecomp.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "eb.push_back",
          "args": [
            "BaseAndExponent<Element>(m_bases[i], e)"
          ],
          "line": 87
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BaseAndExponent<Element>",
          "args": [
            "m_bases[i]",
            "e"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "BaseAndExponent",
          "container": "BaseAndExponent",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/algebra.h",
          "lines": "123-123",
          "snippet": "BaseAndExponent(const T &base, const E &exponent) : base(base), exponent(exponent) {}",
          "includes": [
            "#include \"algebra.cpp\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"algebra.cpp\"\n#include \"config.h\"\n\nBaseAndExponent {\n  BaseAndExponent(const T &base, const E &exponent) : base(base), exponent(exponent) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "eb.push_back",
          "args": [
            "BaseAndExponent<Element>(m_bases[i], r)"
          ],
          "line": 85
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "eb.push_back",
          "args": [
            "BaseAndExponent<Element>(group.Inverse(m_bases[i]), m_exponentBase - r)"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group.Inverse",
          "args": [
            "m_bases[i]"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "Inverse",
          "container": "GF256",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/gf256.h",
          "lines": "32-33",
          "snippet": "Element Inverse(Element a) const\n\t\t{return a;}",
          "includes": [
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"cryptlib.h\"\n\nGF256 {\n  Element Inverse(Element a) const\n  \t\t{return a;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "r.GetBit",
          "args": [
            "m_windowSize-1"
          ],
          "line": 79
        },
        "resolved": true,
        "details": {
          "function_name": "Integer::GetBit",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "2894-2900",
          "snippet": "bool Integer::GetBit(size_t n) const\n{\n\tif (n/WORD_BITS >= reg.size())\n\t\treturn 0;\n\telse\n\t\treturn bool((reg[n/WORD_BITS] >> (n % WORD_BITS)) & 1);\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nbool Integer::GetBit(size_t n) const\n{\n\tif (n/WORD_BITS >= reg.size())\n\t\treturn 0;\n\telse\n\t\treturn bool((reg[n/WORD_BITS] >> (n % WORD_BITS)) & 1);\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::swap",
          "args": [
            "q",
            "e"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "swap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/polynomi.h",
          "lines": "453-456",
          "snippet": "inline void swap(CryptoPP::PolynomialOverFixedRing<T,i> &a, CryptoPP::PolynomialOverFixedRing<T,i> &b)\n{\n\ta.swap(b);\n}",
          "includes": [
            "#include <vector>",
            "#include <iosfwd>",
            "#include \"algebra.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <iosfwd>\n#include \"algebra.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\ninline void swap(CryptoPP::PolynomialOverFixedRing<T,i> &a, CryptoPP::PolynomialOverFixedRing<T,i> &b)\n{\n\ta.swap(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::DivideByPowerOf2",
          "args": [
            "r",
            "q",
            "e",
            "m_windowSize"
          ],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "Integer::DivideByPowerOf2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "3752-3778",
          "snippet": "void Integer::DivideByPowerOf2(Integer &r, Integer &q, const Integer &a, unsigned int n)\n{\n\tq = a;\n\tq >>= n;\n\n\tconst size_t wordCount = BitsToWords(n);\n\tif (wordCount <= a.WordCount())\n\t{\n\t\tr.reg.resize(RoundupSize(wordCount));\n\t\tCopyWords(r.reg, a.reg, wordCount);\n\t\tSetWords(r.reg+wordCount, 0, r.reg.size()-wordCount);\n\t\tif (n % WORD_BITS != 0)\n\t\t\tr.reg[wordCount-1] %= (word(1) << (n % WORD_BITS));\n\t}\n\telse\n\t{\n\t\tr.reg.resize(RoundupSize(a.WordCount()));\n\t\tCopyWords(r.reg, a.reg, r.reg.size());\n\t}\n\tr.sign = POSITIVE;\n\n\tif (a.IsNegative() && r.NotZero())\n\t{\n\t\t--q;\n\t\tr = Power2(n) - r;\n\t}\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nvoid Integer::DivideByPowerOf2(Integer &r, Integer &q, const Integer &a, unsigned int n)\n{\n\tq = a;\n\tq >>= n;\n\n\tconst size_t wordCount = BitsToWords(n);\n\tif (wordCount <= a.WordCount())\n\t{\n\t\tr.reg.resize(RoundupSize(wordCount));\n\t\tCopyWords(r.reg, a.reg, wordCount);\n\t\tSetWords(r.reg+wordCount, 0, r.reg.size()-wordCount);\n\t\tif (n % WORD_BITS != 0)\n\t\t\tr.reg[wordCount-1] %= (word(1) << (n % WORD_BITS));\n\t}\n\telse\n\t{\n\t\tr.reg.resize(RoundupSize(a.WordCount()));\n\t\tCopyWords(r.reg, a.reg, r.reg.size());\n\t}\n\tr.sign = POSITIVE;\n\n\tif (a.IsNegative() && r.NotZero())\n\t{\n\t\t--q;\n\t\tr = Power2(n) - r;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_bases.size",
          "args": [],
          "line": 75
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "group.InversionIsFast",
          "args": [],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "i_group.GetGroup",
          "args": [],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nvoid DL_FixedBasePrecomputationImpl<T>::PrepareCascade(const DL_GroupPrecomputation<Element> &i_group, std::vector<BaseAndExponent<Element> > &eb, const Integer &exponent) const\n{\n\tconst AbstractGroup<T> &group = i_group.GetGroup();\n\n\tInteger r, q, e = exponent;\n\tbool fastNegate = group.InversionIsFast() && m_windowSize > 1;\n\tunsigned int i;\n\n\tfor (i=0; i+1<m_bases.size(); i++)\n\t{\n\t\tInteger::DivideByPowerOf2(r, q, e, m_windowSize);\n\t\tstd::swap(q, e);\n\t\tif (fastNegate && r.GetBit(m_windowSize-1))\n\t\t{\n\t\t\t++e;\n\t\t\teb.push_back(BaseAndExponent<Element>(group.Inverse(m_bases[i]), m_exponentBase - r));\n\t\t}\n\t\telse\n\t\t\teb.push_back(BaseAndExponent<Element>(m_bases[i], r));\n\t}\n\teb.push_back(BaseAndExponent<Element>(m_bases[i], e));\n}"
  },
  {
    "function_name": "DL_FixedBasePrecomputationImpl<T>::Save",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
    "lines": "57-65",
    "snippet": "void DL_FixedBasePrecomputationImpl<T>::Save(const DL_GroupPrecomputation<Element> &group, BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder seq(bt);\n\tDEREncodeUnsigned<word32>(seq, 1);\t// version\n\tm_exponentBase.DEREncode(seq);\n\tfor (unsigned i=0; i<m_bases.size(); i++)\n\t\tgroup.DEREncodeElement(seq, m_bases[i]);\n\tseq.MessageEnd();\n}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"eprecomp.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "group.DEREncodeElement",
          "args": [
            "seq",
            "m_bases[i]"
          ],
          "line": 63
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncodeElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/ec2n.h",
          "lines": "101-101",
          "snippet": "void DEREncodeElement(BufferedTransformation &bt, const Element &v) const {m_ec.DEREncodePoint(bt, v, false);}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"smartptr.h\"",
            "#include \"eprecomp.h\"",
            "#include \"gf2n.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"gf2n.h\"\n\nvoid DEREncodeElement(BufferedTransformation &bt, const Element &v) const {m_ec.DEREncodePoint(bt, v, false);}"
        }
      },
      {
        "call_info": {
          "callee": "m_bases.size",
          "args": [],
          "line": 62
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_exponentBase.DEREncode",
          "args": [
            "seq"
          ],
          "line": 61
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "67-68",
          "snippet": "void DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid DEREncode(BufferedTransformation &bt) const\n\t\t{PKCS8PrivateKey::DEREncode(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "DEREncodeUnsigned<word32>",
          "args": [
            "seq",
            "1"
          ],
          "line": 60
        },
        "resolved": true,
        "details": {
          "function_name": "DEREncodeUnsigned",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/asn.h",
          "lines": "296-320",
          "snippet": "size_t DEREncodeUnsigned(BufferedTransformation &out, T w, byte asnTag = INTEGER)\n{\n\tbyte buf[sizeof(w)+1];\n\tunsigned int bc;\n\tif (asnTag == BOOLEAN)\n\t{\n\t\tbuf[sizeof(w)] = w ? 0xff : 0;\n\t\tbc = 1;\n\t}\n\telse\n\t{\n\t\tbuf[0] = 0;\n\t\tfor (unsigned int i=0; i<sizeof(w); i++)\n\t\t\tbuf[i+1] = byte(w >> (sizeof(w)-1-i)*8);\n\t\tbc = sizeof(w);\n\t\twhile (bc > 1 && buf[sizeof(w)+1-bc] == 0)\n\t\t\t--bc;\n\t\tif (buf[sizeof(w)+1-bc] & 0x80)\n\t\t\t++bc;\n\t}\n\tout.Put(asnTag);\n\tsize_t lengthBytes = DERLengthEncode(out, bc);\n\tout.Put(buf+sizeof(w)+1-bc, bc);\n\treturn 1+lengthBytes+bc;\n}",
          "includes": [
            "#include <vector>",
            "#include \"queue.h\"",
            "#include \"filters.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "CRYPTOPP_DLL void CRYPTOPP_API DEREncodeNull(BufferedTransformation &out);",
            "CRYPTOPP_DLL size_t CRYPTOPP_API DEREncodeTextString(BufferedTransformation &out, const std::string &str, byte asnTag);",
            "CRYPTOPP_DLL size_t CRYPTOPP_API BERDecodeTextString(BufferedTransformation &in, std::string &str, byte asnTag);"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include \"queue.h\"\n#include \"filters.h\"\n\nCRYPTOPP_DLL void CRYPTOPP_API DEREncodeNull(BufferedTransformation &out);\nCRYPTOPP_DLL size_t CRYPTOPP_API DEREncodeTextString(BufferedTransformation &out, const std::string &str, byte asnTag);\nCRYPTOPP_DLL size_t CRYPTOPP_API BERDecodeTextString(BufferedTransformation &in, std::string &str, byte asnTag);\n\nsize_t DEREncodeUnsigned(BufferedTransformation &out, T w, byte asnTag = INTEGER)\n{\n\tbyte buf[sizeof(w)+1];\n\tunsigned int bc;\n\tif (asnTag == BOOLEAN)\n\t{\n\t\tbuf[sizeof(w)] = w ? 0xff : 0;\n\t\tbc = 1;\n\t}\n\telse\n\t{\n\t\tbuf[0] = 0;\n\t\tfor (unsigned int i=0; i<sizeof(w); i++)\n\t\t\tbuf[i+1] = byte(w >> (sizeof(w)-1-i)*8);\n\t\tbc = sizeof(w);\n\t\twhile (bc > 1 && buf[sizeof(w)+1-bc] == 0)\n\t\t\t--bc;\n\t\tif (buf[sizeof(w)+1-bc] & 0x80)\n\t\t\t++bc;\n\t}\n\tout.Put(asnTag);\n\tsize_t lengthBytes = DERLengthEncode(out, bc);\n\tout.Put(buf+sizeof(w)+1-bc, bc);\n\treturn 1+lengthBytes+bc;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nvoid DL_FixedBasePrecomputationImpl<T>::Save(const DL_GroupPrecomputation<Element> &group, BufferedTransformation &bt) const\n{\n\tDERSequenceEncoder seq(bt);\n\tDEREncodeUnsigned<word32>(seq, 1);\t// version\n\tm_exponentBase.DEREncode(seq);\n\tfor (unsigned i=0; i<m_bases.size(); i++)\n\t\tgroup.DEREncodeElement(seq, m_bases[i]);\n\tseq.MessageEnd();\n}"
  },
  {
    "function_name": "DL_FixedBasePrecomputationImpl<T>::Load",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
    "lines": "42-55",
    "snippet": "void DL_FixedBasePrecomputationImpl<T>::Load(const DL_GroupPrecomputation<Element> &group, BufferedTransformation &bt)\n{\n\tBERSequenceDecoder seq(bt);\n\tword32 version;\n\tBERDecodeUnsigned<word32>(seq, version, INTEGER, 1, 1);\n\tm_exponentBase.BERDecode(seq);\n\tm_windowSize = m_exponentBase.BitCount() - 1;\n\tm_bases.clear();\n\twhile (!seq.EndReached())\n\t\tm_bases.push_back(group.BERDecodeElement(seq));\n\tif (!m_bases.empty() && group.NeedConversions())\n\t\tm_base = group.ConvertOut(m_bases[0]);\n\tseq.MessageEnd();\n}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"eprecomp.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "seq.MessageEnd",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "MessageEnd",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "807-808",
          "snippet": "bool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nbool MessageEnd(int propagation=-1, bool blocking=true)\n\t\t\t{return !!Put2(NULL, 0, propagation < 0 ? -1 : propagation+1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "group.ConvertOut",
          "args": [
            "m_bases[0]"
          ],
          "line": 53
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertOut",
          "container": "DL_GroupPrecomputation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.h",
          "lines": "18-18",
          "snippet": "virtual Element ConvertOut(const Element &v) const {return v;}",
          "includes": [
            "#include \"eprecomp.cpp\"",
            "#include <vector>",
            "#include \"algebra.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eprecomp.cpp\"\n#include <vector>\n#include \"algebra.h\"\n#include \"integer.h\"\n\nDL_GroupPrecomputation {\n  virtual Element ConvertOut(const Element &v) const {return v;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "group.NeedConversions",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "NeedConversions",
          "container": "DL_GroupPrecomputation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.h",
          "lines": "16-16",
          "snippet": "virtual bool NeedConversions() const {return false;}",
          "includes": [
            "#include \"eprecomp.cpp\"",
            "#include <vector>",
            "#include \"algebra.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eprecomp.cpp\"\n#include <vector>\n#include \"algebra.h\"\n#include \"integer.h\"\n\nDL_GroupPrecomputation {\n  virtual bool NeedConversions() const {return false;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_bases.empty",
          "args": [],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_bases.push_back",
          "args": [
            "group.BERDecodeElement(seq)"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group.BERDecodeElement",
          "args": [
            "seq"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "BERDecodeElement",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/ec2n.h",
          "lines": "100-100",
          "snippet": "Element BERDecodeElement(BufferedTransformation &bt) const {return m_ec.BERDecodePoint(bt);}",
          "includes": [
            "#include \"pubkey.h\"",
            "#include \"smartptr.h\"",
            "#include \"eprecomp.h\"",
            "#include \"gf2n.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"pubkey.h\"\n#include \"smartptr.h\"\n#include \"eprecomp.h\"\n#include \"gf2n.h\"\n\nElement BERDecodeElement(BufferedTransformation &bt) const {return m_ec.BERDecodePoint(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "seq.EndReached",
          "args": [],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_bases.clear",
          "args": [],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_exponentBase.BitCount",
          "args": [],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_exponentBase.BERDecode",
          "args": [
            "seq"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "BERDecode",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rsa.h",
          "lines": "65-66",
          "snippet": "void BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}",
          "includes": [
            "#include \"emsa2.h\"",
            "#include \"oaep.h\"",
            "#include \"pkcspad.h\"",
            "#include \"asn.h\"",
            "#include \"pubkey.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"emsa2.h\"\n#include \"oaep.h\"\n#include \"pkcspad.h\"\n#include \"asn.h\"\n#include \"pubkey.h\"\n\nvoid BERDecode(BufferedTransformation &bt)\n\t\t{PKCS8PrivateKey::BERDecode(bt);}"
        }
      },
      {
        "call_info": {
          "callee": "BERDecodeUnsigned<word32>",
          "args": [
            "seq",
            "version",
            "INTEGER",
            "1",
            "1"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nvoid DL_FixedBasePrecomputationImpl<T>::Load(const DL_GroupPrecomputation<Element> &group, BufferedTransformation &bt)\n{\n\tBERSequenceDecoder seq(bt);\n\tword32 version;\n\tBERDecodeUnsigned<word32>(seq, version, INTEGER, 1, 1);\n\tm_exponentBase.BERDecode(seq);\n\tm_windowSize = m_exponentBase.BitCount() - 1;\n\tm_bases.clear();\n\twhile (!seq.EndReached())\n\t\tm_bases.push_back(group.BERDecodeElement(seq));\n\tif (!m_bases.empty() && group.NeedConversions())\n\t\tm_base = group.ConvertOut(m_bases[0]);\n\tseq.MessageEnd();\n}"
  },
  {
    "function_name": "DL_FixedBasePrecomputationImpl<T>::Precompute",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
    "lines": "26-40",
    "snippet": "void DL_FixedBasePrecomputationImpl<T>::Precompute(const DL_GroupPrecomputation<Element> &group, unsigned int maxExpBits, unsigned int storage)\n{\n\tassert(m_bases.size() > 0);\n\tassert(storage <= maxExpBits);\n\n\tif (storage > 1)\n\t{\n\t\tm_windowSize = (maxExpBits+storage-1)/storage;\n\t\tm_exponentBase = Integer::Power2(m_windowSize);\n\t}\n\n\tm_bases.resize(storage);\n\tfor (unsigned i=1; i<storage; i++)\n\t\tm_bases[i] = group.GetGroup().ScalarMultiply(m_bases[i-1], m_exponentBase);\n}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"eprecomp.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group.GetGroup",
          "args": [
            "m_bases[i-1]",
            "m_exponentBase"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "group.GetGroup",
          "args": [],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_bases.resize",
          "args": [
            "storage"
          ],
          "line": 37
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "203-211",
          "snippet": "void resize(size_t newSize)\n\t{\n\t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n\t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n\t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n\t\tdelete [] this->m_ptr;\n\t\tthis->m_size = newSize;\n\t\tthis->m_ptr = newPtr;\n\t}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  void resize(size_t newSize)\n  \t{\n  \t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n  \t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n  \t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n  \t\tdelete [] this->m_ptr;\n  \t\tthis->m_size = newSize;\n  \t\tthis->m_ptr = newPtr;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "Integer::Power2",
          "args": [
            "m_windowSize"
          ],
          "line": 34
        },
        "resolved": true,
        "details": {
          "function_name": "Integer::Power2",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "2846-2851",
          "snippet": "Integer Integer::Power2(size_t e)\n{\n\tInteger r((word)0, BitsToWords(e+1));\n\tr.SetBit(e);\n\treturn r;\n}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nInteger Integer::Power2(size_t e)\n{\n\tInteger r((word)0, BitsToWords(e+1));\n\tr.SetBit(e);\n\treturn r;\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "storage <= maxExpBits"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "m_bases.size() > 0"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "m_bases.size",
          "args": [],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "202-202",
          "snippet": "size_t size() const {return this->m_size;}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  size_t size() const {return this->m_size;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nvoid DL_FixedBasePrecomputationImpl<T>::Precompute(const DL_GroupPrecomputation<Element> &group, unsigned int maxExpBits, unsigned int storage)\n{\n\tassert(m_bases.size() > 0);\n\tassert(storage <= maxExpBits);\n\n\tif (storage > 1)\n\t{\n\t\tm_windowSize = (maxExpBits+storage-1)/storage;\n\t\tm_exponentBase = Integer::Power2(m_windowSize);\n\t}\n\n\tm_bases.resize(storage);\n\tfor (unsigned i=1; i<storage; i++)\n\t\tm_bases[i] = group.GetGroup().ScalarMultiply(m_bases[i-1], m_exponentBase);\n}"
  },
  {
    "function_name": "DL_FixedBasePrecomputationImpl<T>::SetBase",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.cpp",
    "lines": "12-24",
    "snippet": "void DL_FixedBasePrecomputationImpl<T>::SetBase(const DL_GroupPrecomputation<Element> &group, const Element &i_base)\n{\n\tm_base = group.NeedConversions() ? group.ConvertIn(i_base) : i_base;\n\n\tif (m_bases.empty() || !(m_base == m_bases[0]))\n\t{\n\t\tm_bases.resize(1);\n\t\tm_bases[0] = m_base;\n\t}\n\n\tif (group.NeedConversions())\n\t\tm_base = i_base;\n}",
    "includes": [
      "#include \"asn.h\"",
      "#include \"eprecomp.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "group.NeedConversions",
          "args": [],
          "line": 22
        },
        "resolved": true,
        "details": {
          "function_name": "NeedConversions",
          "container": "DL_GroupPrecomputation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.h",
          "lines": "16-16",
          "snippet": "virtual bool NeedConversions() const {return false;}",
          "includes": [
            "#include \"eprecomp.cpp\"",
            "#include <vector>",
            "#include \"algebra.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eprecomp.cpp\"\n#include <vector>\n#include \"algebra.h\"\n#include \"integer.h\"\n\nDL_GroupPrecomputation {\n  virtual bool NeedConversions() const {return false;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_bases.resize",
          "args": [
            "1"
          ],
          "line": 18
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "vector_member_ptrs",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/smartptr.h",
          "lines": "203-211",
          "snippet": "void resize(size_t newSize)\n\t{\n\t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n\t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n\t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n\t\tdelete [] this->m_ptr;\n\t\tthis->m_size = newSize;\n\t\tthis->m_ptr = newPtr;\n\t}",
          "includes": [
            "#include <algorithm>",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <algorithm>\n#include \"config.h\"\n\nvector_member_ptrs {\n  void resize(size_t newSize)\n  \t{\n  \t\tmember_ptr<T> *newPtr = new member_ptr<T>[newSize];\n  \t\tfor (size_t i=0; i<this->m_size && i<newSize; i++)\n  \t\t\tnewPtr[i].reset(this->m_ptr[i].release());\n  \t\tdelete [] this->m_ptr;\n  \t\tthis->m_size = newSize;\n  \t\tthis->m_ptr = newPtr;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_bases.empty",
          "args": [],
          "line": 16
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "303-303",
          "snippet": "bool empty() const {return m_size == 0;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  bool empty() const {return m_size == 0;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "group.ConvertIn",
          "args": [
            "i_base"
          ],
          "line": 14
        },
        "resolved": true,
        "details": {
          "function_name": "ConvertIn",
          "container": "DL_GroupPrecomputation",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/eprecomp.h",
          "lines": "17-17",
          "snippet": "virtual Element ConvertIn(const Element &v) const {return v;}",
          "includes": [
            "#include \"eprecomp.cpp\"",
            "#include <vector>",
            "#include \"algebra.h\"",
            "#include \"integer.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"eprecomp.cpp\"\n#include <vector>\n#include \"algebra.h\"\n#include \"integer.h\"\n\nDL_GroupPrecomputation {\n  virtual Element ConvertIn(const Element &v) const {return v;}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"asn.h\"\n#include \"eprecomp.h\"\n#include \"pch.h\"\n\nvoid DL_FixedBasePrecomputationImpl<T>::SetBase(const DL_GroupPrecomputation<Element> &group, const Element &i_base)\n{\n\tm_base = group.NeedConversions() ? group.ConvertIn(i_base) : i_base;\n\n\tif (m_bases.empty() || !(m_base == m_bases[0]))\n\t{\n\t\tm_bases.resize(1);\n\t\tm_bases[0] = m_base;\n\t}\n\n\tif (group.NeedConversions())\n\t\tm_base = i_base;\n}"
  }
]