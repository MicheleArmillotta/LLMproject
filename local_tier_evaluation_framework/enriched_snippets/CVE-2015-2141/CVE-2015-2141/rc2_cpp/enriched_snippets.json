[
  {
    "function_name": "RC2::Dec::ProcessAndXorBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rc2.cpp",
    "lines": "87-116",
    "snippet": "void RC2::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword16 R0, R1, R2, R3;\n\tBlock::Get(inBlock)(R0)(R1)(R2)(R3);\n\n\tfor (int i = 15; i >= 0; i--)\n\t{\n\t\tif (i == 4 || i == 10)\n\t\t{\n\t\t\tR3 -= K[R2 & 63];\n\t\t\tR2 -= K[R1 & 63];\n\t\t\tR1 -= K[R0 & 63];\n\t\t\tR0 -= K[R3 & 63];\n\t\t}\n\n\t\tR3 = rotrFixed(R3, 5);\n\t\tR3 -= (R0 & ~R2) + (R1 & R2) + K[4*i+3];\n\n\t\tR2 = rotrFixed(R2, 3);\n\t\tR2 -= (R3 & ~R1) + (R0 & R1) + K[4*i+2];\n\n\t\tR1 = rotrFixed(R1, 2);\n\t\tR1 -= (R2 & ~R0) + (R3 & R0) + K[4*i+1];\n\n\t\tR0 = rotrFixed(R0, 1);\n\t\tR0 -= (R1 & ~R3) + (R2 & R3) + K[4*i+0];\n\t}\n\n\tBlock::Put(xorBlock, outBlock)(R0)(R1)(R2)(R3);\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"rc2.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "R3"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 115
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotrFixed",
          "args": [
            "R0",
            "1"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "rotrFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "586-590",
          "snippet": "inline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotrFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x>>y) | (x<<(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "R3"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"misc.h\"\n#include \"rc2.h\"\n#include \"pch.h\"\n\nvoid RC2::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword16 R0, R1, R2, R3;\n\tBlock::Get(inBlock)(R0)(R1)(R2)(R3);\n\n\tfor (int i = 15; i >= 0; i--)\n\t{\n\t\tif (i == 4 || i == 10)\n\t\t{\n\t\t\tR3 -= K[R2 & 63];\n\t\t\tR2 -= K[R1 & 63];\n\t\t\tR1 -= K[R0 & 63];\n\t\t\tR0 -= K[R3 & 63];\n\t\t}\n\n\t\tR3 = rotrFixed(R3, 5);\n\t\tR3 -= (R0 & ~R2) + (R1 & R2) + K[4*i+3];\n\n\t\tR2 = rotrFixed(R2, 3);\n\t\tR2 -= (R3 & ~R1) + (R0 & R1) + K[4*i+2];\n\n\t\tR1 = rotrFixed(R1, 2);\n\t\tR1 -= (R2 & ~R0) + (R3 & R0) + K[4*i+1];\n\n\t\tR0 = rotrFixed(R0, 1);\n\t\tR0 -= (R1 & ~R3) + (R2 & R3) + K[4*i+0];\n\t}\n\n\tBlock::Put(xorBlock, outBlock)(R0)(R1)(R2)(R3);\n}"
  },
  {
    "function_name": "RC2::Enc::ProcessAndXorBlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rc2.cpp",
    "lines": "56-85",
    "snippet": "void RC2::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword16 R0, R1, R2, R3;\n\tBlock::Get(inBlock)(R0)(R1)(R2)(R3);\n\n\tfor (int i = 0; i < 16; i++)\n\t{\n\t\tR0 += (R1 & ~R3) + (R2 & R3) + K[4*i+0];\n\t\tR0 = rotlFixed(R0, 1);\n\n\t\tR1 += (R2 & ~R0) + (R3 & R0) + K[4*i+1];\n\t\tR1 = rotlFixed(R1, 2);\n\n\t\tR2 += (R3 & ~R1) + (R0 & R1) + K[4*i+2];\n\t\tR2 = rotlFixed(R2, 3);\n\n\t\tR3 += (R0 & ~R2) + (R1 & R2) + K[4*i+3];\n\t\tR3 = rotlFixed(R3, 5);\n\n\t\tif (i == 4 || i == 10)\n\t\t{\n\t\t\tR0 += K[R3 & 63];\n\t\t\tR1 += K[R0 & 63];\n\t\t\tR2 += K[R1 & 63];\n\t\t\tR3 += K[R2 & 63];\n\t\t}\n\t}\n\n\tBlock::Put(xorBlock, outBlock)(R0)(R1)(R2)(R3);\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"rc2.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "R3"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "R3",
            "5"
          ],
          "line": 73
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "R3"
          ],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"misc.h\"\n#include \"rc2.h\"\n#include \"pch.h\"\n\nvoid RC2::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword16 R0, R1, R2, R3;\n\tBlock::Get(inBlock)(R0)(R1)(R2)(R3);\n\n\tfor (int i = 0; i < 16; i++)\n\t{\n\t\tR0 += (R1 & ~R3) + (R2 & R3) + K[4*i+0];\n\t\tR0 = rotlFixed(R0, 1);\n\n\t\tR1 += (R2 & ~R0) + (R3 & R0) + K[4*i+1];\n\t\tR1 = rotlFixed(R1, 2);\n\n\t\tR2 += (R3 & ~R1) + (R0 & R1) + K[4*i+2];\n\t\tR2 = rotlFixed(R2, 3);\n\n\t\tR3 += (R0 & ~R2) + (R1 & R2) + K[4*i+3];\n\t\tR3 = rotlFixed(R3, 5);\n\n\t\tif (i == 4 || i == 10)\n\t\t{\n\t\t\tR0 += K[R3 & 63];\n\t\t\tR1 += K[R0 & 63];\n\t\t\tR2 += K[R1 & 63];\n\t\t\tR3 += K[R2 & 63];\n\t\t}\n\t}\n\n\tBlock::Put(xorBlock, outBlock)(R0)(R1)(R2)(R3);\n}"
  },
  {
    "function_name": "RC2::Base::UncheckedSetKey",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/rc2.cpp",
    "lines": "10-52",
    "snippet": "void RC2::Base::UncheckedSetKey(const byte *key, unsigned int keyLen, const NameValuePairs &params)\n{\n\tAssertValidKeyLength(keyLen);\n\n\tint effectiveLen = params.GetIntValueWithDefault(Name::EffectiveKeyLength(), DEFAULT_EFFECTIVE_KEYLENGTH);\n\tif (effectiveLen > MAX_EFFECTIVE_KEYLENGTH)\n\t\tthrow InvalidArgument(\"RC2: effective key length parameter exceeds maximum\");\n\n\tstatic const unsigned char PITABLE[256] = {\n\t\t217,120,249,196, 25,221,181,237, 40,233,253,121, 74,160,216,157,\n\t\t198,126, 55,131, 43,118, 83,142, 98, 76,100,136, 68,139,251,162,\n\t\t 23,154, 89,245,135,179, 79, 19, 97, 69,109,141,  9,129,125, 50,\n\t\t189,143, 64,235,134,183,123, 11,240,149, 33, 34, 92,107, 78,130,\n\t\t 84,214,101,147,206, 96,178, 28,115, 86,192, 20,167,140,241,220,\n\t\t 18,117,202, 31, 59,190,228,209, 66, 61,212, 48,163, 60,182, 38,\n\t\t111,191, 14,218, 70,105,  7, 87, 39,242, 29,155,188,148, 67,  3,\n\t\t248, 17,199,246,144,239, 62,231,  6,195,213, 47,200,102, 30,215,\n\t\t  8,232,234,222,128, 82,238,247,132,170,114,172, 53, 77,106, 42,\n\t\t150, 26,210,113, 90, 21, 73,116, 75,159,208, 94,  4, 24,164,236,\n\t\t194,224, 65,110, 15, 81,203,204, 36,145,175, 80,161,244,112, 57,\n\t\t153,124, 58,133, 35,184,180,122,252,  2, 54, 91, 37, 85,151, 49,\n\t\t 45, 93,250,152,227,138,146,174,  5,223, 41, 16,103,108,186,201,\n\t\t211,  0,230,207,225,158,168, 44, 99, 22,  1, 63, 88,226,137,169,\n\t\t 13, 56, 52, 27,171, 51,255,176,187, 72, 12, 95,185,177,205, 46,\n\t\t197,243,219, 71,229,165,156,119, 10,166, 32,104,254,127,193,173};\n\n\tSecByteBlock L(128);\n\tmemcpy(L, key, keyLen);\n\n\tint i;\n\tfor (i=keyLen; i<128; i++)\n\t\tL[i] = PITABLE[(L[i-1] + L[i-keyLen]) & 255];\n\n\tunsigned int T8 = (effectiveLen+7) / 8;\n\tbyte TM = 255 >> ((8-(effectiveLen%8))%8);\n\tL[128-T8] = PITABLE[L[128-T8] & TM];\n\n\tfor (i=127-T8; i>=0; i--)\n\t\tL[i] = PITABLE[L[i+1] ^ L[i+T8]];\n\n\tfor (i=0; i<64; i++)\n\t\tK[i] = L[2*i] + (L[2*i+1] << 8);\n}",
    "includes": [
      "#include \"argnames.h\"",
      "#include \"misc.h\"",
      "#include \"rc2.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "L",
            "key",
            "keyLen"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "InvalidArgument",
          "args": [
            "\"RC2: effective key length parameter exceeds maximum\""
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "params.GetIntValueWithDefault",
          "args": [
            "Name::EffectiveKeyLength()",
            "DEFAULT_EFFECTIVE_KEYLENGTH"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Name::EffectiveKeyLength",
          "args": [],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "keyLen"
          ],
          "line": 12
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"argnames.h\"\n#include \"misc.h\"\n#include \"rc2.h\"\n#include \"pch.h\"\n\nvoid RC2::Base::UncheckedSetKey(const byte *key, unsigned int keyLen, const NameValuePairs &params)\n{\n\tAssertValidKeyLength(keyLen);\n\n\tint effectiveLen = params.GetIntValueWithDefault(Name::EffectiveKeyLength(), DEFAULT_EFFECTIVE_KEYLENGTH);\n\tif (effectiveLen > MAX_EFFECTIVE_KEYLENGTH)\n\t\tthrow InvalidArgument(\"RC2: effective key length parameter exceeds maximum\");\n\n\tstatic const unsigned char PITABLE[256] = {\n\t\t217,120,249,196, 25,221,181,237, 40,233,253,121, 74,160,216,157,\n\t\t198,126, 55,131, 43,118, 83,142, 98, 76,100,136, 68,139,251,162,\n\t\t 23,154, 89,245,135,179, 79, 19, 97, 69,109,141,  9,129,125, 50,\n\t\t189,143, 64,235,134,183,123, 11,240,149, 33, 34, 92,107, 78,130,\n\t\t 84,214,101,147,206, 96,178, 28,115, 86,192, 20,167,140,241,220,\n\t\t 18,117,202, 31, 59,190,228,209, 66, 61,212, 48,163, 60,182, 38,\n\t\t111,191, 14,218, 70,105,  7, 87, 39,242, 29,155,188,148, 67,  3,\n\t\t248, 17,199,246,144,239, 62,231,  6,195,213, 47,200,102, 30,215,\n\t\t  8,232,234,222,128, 82,238,247,132,170,114,172, 53, 77,106, 42,\n\t\t150, 26,210,113, 90, 21, 73,116, 75,159,208, 94,  4, 24,164,236,\n\t\t194,224, 65,110, 15, 81,203,204, 36,145,175, 80,161,244,112, 57,\n\t\t153,124, 58,133, 35,184,180,122,252,  2, 54, 91, 37, 85,151, 49,\n\t\t 45, 93,250,152,227,138,146,174,  5,223, 41, 16,103,108,186,201,\n\t\t211,  0,230,207,225,158,168, 44, 99, 22,  1, 63, 88,226,137,169,\n\t\t 13, 56, 52, 27,171, 51,255,176,187, 72, 12, 95,185,177,205, 46,\n\t\t197,243,219, 71,229,165,156,119, 10,166, 32,104,254,127,193,173};\n\n\tSecByteBlock L(128);\n\tmemcpy(L, key, keyLen);\n\n\tint i;\n\tfor (i=keyLen; i<128; i++)\n\t\tL[i] = PITABLE[(L[i-1] + L[i-keyLen]) & 255];\n\n\tunsigned int T8 = (effectiveLen+7) / 8;\n\tbyte TM = 255 >> ((8-(effectiveLen%8))%8);\n\tL[128-T8] = PITABLE[L[128-T8] & TM];\n\n\tfor (i=127-T8; i>=0; i--)\n\t\tL[i] = PITABLE[L[i+1] ^ L[i+T8]];\n\n\tfor (i=0; i<64; i++)\n\t\tK[i] = L[2*i] + (L[2*i+1] << 8);\n}"
  }
]