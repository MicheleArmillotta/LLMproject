[
  {
    "function_name": "ProcessAndXorBlock",
    "container": "Square::Dec",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/square.cpp",
    "lines": "152-175",
    "snippet": "void Square::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 text[4], temp[4];\n\tBlock::Get(inBlock)(text[0])(text[1])(text[2])(text[3]);\n   \n\t/* initial key addition */\n\ttext[0] ^= roundkeys(0, 0);\n\ttext[1] ^= roundkeys(0, 1);\n\ttext[2] ^= roundkeys(0, 2);\n\ttext[3] ^= roundkeys(0, 3);\n \n\t/* ROUNDS - 1 full rounds */\n\tfor (int i=1; i+1<ROUNDS; i+=2)\n\t{\n\t\tsquareRound (text, temp, Td[0], Td[1], Td[2], Td[3], roundkeys4(i));\n\t\tsquareRound (temp, text, Td[0], Td[1], Td[2], Td[3], roundkeys4(i+1));\n\t}\n\tsquareRound (text, temp, Td[0], Td[1], Td[2], Td[3], roundkeys4(ROUNDS-1));\n\n\t/* last round (diffusion becomes only transposition) */\n\tsquareFinal (text, temp, Sd, roundkeys4(ROUNDS));\n\n\tBlock::Put(xorBlock, outBlock)(text[0])(text[1])(text[2])(text[3]);\n}",
    "includes": [
      "#include \"gf256.h\"",
      "#include \"misc.h\"",
      "#include \"square.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "text[3]"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 174
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "squareFinal",
          "args": [
            "text",
            "temp",
            "Sd",
            "roundkeys4(ROUNDS)"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "ROUNDS"
          ],
          "line": 172
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squareRound",
          "args": [
            "text",
            "temp",
            "Td[0]",
            "Td[1]",
            "Td[2]",
            "Td[3]",
            "roundkeys4(ROUNDS-1)"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "ROUNDS-1"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squareRound",
          "args": [
            "temp",
            "text",
            "Td[0]",
            "Td[1]",
            "Td[2]",
            "Td[3]",
            "roundkeys4(i+1)"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "i+1"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squareRound",
          "args": [
            "text",
            "temp",
            "Td[0]",
            "Td[1]",
            "Td[2]",
            "Td[3]",
            "roundkeys4(i)"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "i"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "0",
            "3"
          ],
          "line": 161
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "0",
            "2"
          ],
          "line": 160
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "0",
            "1"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "0",
            "0"
          ],
          "line": 158
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "text[3]"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"gf256.h\"\n#include \"misc.h\"\n#include \"square.h\"\n#include \"pch.h\"\n\nSquare {\n  Dec {\n    void Square::Dec::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tword32 text[4], temp[4];\n    \tBlock::Get(inBlock)(text[0])(text[1])(text[2])(text[3]);\n       \n    \t/* initial key addition */\n    \ttext[0] ^= roundkeys(0, 0);\n    \ttext[1] ^= roundkeys(0, 1);\n    \ttext[2] ^= roundkeys(0, 2);\n    \ttext[3] ^= roundkeys(0, 3);\n     \n    \t/* ROUNDS - 1 full rounds */\n    \tfor (int i=1; i+1<ROUNDS; i+=2)\n    \t{\n    \t\tsquareRound (text, temp, Td[0], Td[1], Td[2], Td[3], roundkeys4(i));\n    \t\tsquareRound (temp, text, Td[0], Td[1], Td[2], Td[3], roundkeys4(i+1));\n    \t}\n    \tsquareRound (text, temp, Td[0], Td[1], Td[2], Td[3], roundkeys4(ROUNDS-1));\n    \n    \t/* last round (diffusion becomes only transposition) */\n    \tsquareFinal (text, temp, Sd, roundkeys4(ROUNDS));\n    \n    \tBlock::Put(xorBlock, outBlock)(text[0])(text[1])(text[2])(text[3]);\n    }\n  }\n}"
  },
  {
    "function_name": "ProcessAndXorBlock",
    "container": "Square::Enc",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/square.cpp",
    "lines": "127-150",
    "snippet": "void Square::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n{\n\tword32 text[4], temp[4];\n\tBlock::Get(inBlock)(text[0])(text[1])(text[2])(text[3]);\n   \n\t/* initial key addition */\n\ttext[0] ^= roundkeys(0, 0);\n\ttext[1] ^= roundkeys(0, 1);\n\ttext[2] ^= roundkeys(0, 2);\n\ttext[3] ^= roundkeys(0, 3);\n \n\t/* ROUNDS - 1 full rounds */\n\tfor (int i=1; i+1<ROUNDS; i+=2)\n\t{\n\t\tsquareRound (text, temp, Te[0], Te[1], Te[2], Te[3], roundkeys4(i));\n\t\tsquareRound (temp, text, Te[0], Te[1], Te[2], Te[3], roundkeys4(i+1));\n\t}\n\tsquareRound (text, temp, Te[0], Te[1], Te[2], Te[3], roundkeys4(ROUNDS-1));\n\n\t/* last round (diffusion becomes only transposition) */\n\tsquareFinal (text, temp, Se, roundkeys4(ROUNDS));\n\n\tBlock::Put(xorBlock, outBlock)(text[0])(text[1])(text[2])(text[3]);\n}",
    "includes": [
      "#include \"gf256.h\"",
      "#include \"misc.h\"",
      "#include \"square.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "text[3]"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "Put",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/cryptlib.h",
          "lines": "785-786",
          "snippet": "size_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}",
          "includes": [
            "#include \"stdcpp.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"stdcpp.h\"\n#include \"config.h\"\n\nsize_t Put(byte inByte, bool blocking=true)\n\t\t\t{return Put(&inByte, 1, blocking);}"
        }
      },
      {
        "call_info": {
          "callee": "Block::Put",
          "args": [
            "xorBlock",
            "outBlock"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "PutBlock",
          "container": "PutBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1179-1180",
          "snippet": "PutBlock(const void *xorBlock, void *block)\n\t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nPutBlock {\n  PutBlock(const void *xorBlock, void *block)\n  \t\t: m_xorBlock((const byte *)xorBlock), m_block((byte *)block) {}\n}"
        }
      },
      {
        "call_info": {
          "callee": "squareFinal",
          "args": [
            "text",
            "temp",
            "Se",
            "roundkeys4(ROUNDS)"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "ROUNDS"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squareRound",
          "args": [
            "text",
            "temp",
            "Te[0]",
            "Te[1]",
            "Te[2]",
            "Te[3]",
            "roundkeys4(ROUNDS-1)"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "ROUNDS-1"
          ],
          "line": 144
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squareRound",
          "args": [
            "temp",
            "text",
            "Te[0]",
            "Te[1]",
            "Te[2]",
            "Te[3]",
            "roundkeys4(i+1)"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "i+1"
          ],
          "line": 142
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "squareRound",
          "args": [
            "text",
            "temp",
            "Te[0]",
            "Te[1]",
            "Te[2]",
            "Te[3]",
            "roundkeys4(i)"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "i"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "0",
            "3"
          ],
          "line": 136
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "0",
            "2"
          ],
          "line": 135
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "0",
            "1"
          ],
          "line": 134
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "0",
            "0"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Block::Get",
          "args": [
            "text[3]"
          ],
          "line": 130
        },
        "resolved": true,
        "details": {
          "function_name": "Get",
          "container": "BlockGetAndPut",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "1201-1201",
          "snippet": "static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\nBlockGetAndPut {\n  static inline GetBlock<T, B, GA> Get(const void *block) {return GetBlock<T, B, GA>(block);}\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"gf256.h\"\n#include \"misc.h\"\n#include \"square.h\"\n#include \"pch.h\"\n\nSquare {\n  Enc {\n    void Square::Enc::ProcessAndXorBlock(const byte *inBlock, const byte *xorBlock, byte *outBlock) const\n    {\n    \tword32 text[4], temp[4];\n    \tBlock::Get(inBlock)(text[0])(text[1])(text[2])(text[3]);\n       \n    \t/* initial key addition */\n    \ttext[0] ^= roundkeys(0, 0);\n    \ttext[1] ^= roundkeys(0, 1);\n    \ttext[2] ^= roundkeys(0, 2);\n    \ttext[3] ^= roundkeys(0, 3);\n     \n    \t/* ROUNDS - 1 full rounds */\n    \tfor (int i=1; i+1<ROUNDS; i+=2)\n    \t{\n    \t\tsquareRound (text, temp, Te[0], Te[1], Te[2], Te[3], roundkeys4(i));\n    \t\tsquareRound (temp, text, Te[0], Te[1], Te[2], Te[3], roundkeys4(i+1));\n    \t}\n    \tsquareRound (text, temp, Te[0], Te[1], Te[2], Te[3], roundkeys4(ROUNDS-1));\n    \n    \t/* last round (diffusion becomes only transposition) */\n    \tsquareFinal (text, temp, Se, roundkeys4(ROUNDS));\n    \n    \tBlock::Put(xorBlock, outBlock)(text[0])(text[1])(text[2])(text[3]);\n    }\n  }\n}"
  },
  {
    "function_name": "UncheckedSetKey",
    "container": "Square::Base",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/square.cpp",
    "lines": "37-70",
    "snippet": "void Square::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n{\n\tAssertValidKeyLength(length);\n\n\tstatic const word32 offset[ROUNDS] = {\n\t0x01000000UL, 0x02000000UL, 0x04000000UL, 0x08000000UL,\n\t0x10000000UL, 0x20000000UL, 0x40000000UL, 0x80000000UL,\n\t};\n\n\tGetUserKey(BIG_ENDIAN_ORDER, m_roundkeys.data(), KEYLENGTH/4, userKey, KEYLENGTH);\n\n\t/* apply the key evolution function */\n\tfor (int i = 1; i < ROUNDS+1; i++)\n\t{\n\t\troundkeys(i, 0) = roundkeys(i-1, 0) ^ rotlFixed(roundkeys(i-1, 3), 8U) ^ offset[i-1];\n\t\troundkeys(i, 1) = roundkeys(i-1, 1) ^ roundkeys(i, 0);\n\t\troundkeys(i, 2) = roundkeys(i-1, 2) ^ roundkeys(i, 1);\n\t\troundkeys(i, 3) = roundkeys(i-1, 3) ^ roundkeys(i, 2);\n\t}  \n\n\t/* produce the round keys */\n\tif (IsForwardTransformation())\n\t{\n\t\tfor (int i = 0; i < ROUNDS; i++)\n\t\t\tSquareTransform (roundkeys4(i), roundkeys4(i));\n\t}\n\telse\n\t{\n\t\tfor (int i = 0; i < ROUNDS/2; i++)\n\t\t\tfor (int j = 0; j < 4; j++)\n\t\t\t\tstd::swap(roundkeys(i, j), roundkeys(ROUNDS-i, j));\n\t\tSquareTransform (roundkeys4(ROUNDS), roundkeys4(ROUNDS));\n\t}\n}",
    "includes": [
      "#include \"gf256.h\"",
      "#include \"misc.h\"",
      "#include \"square.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SquareTransform",
          "args": [
            "roundkeys4(ROUNDS)",
            "roundkeys4(ROUNDS)"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "SquareTransform",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/square.cpp",
          "lines": "12-32",
          "snippet": "static void SquareTransform (word32 in[4], word32 out[4])\n{\n\tstatic const byte G[4][4] = \n\t{\n\t\t0x02U, 0x01U, 0x01U, 0x03U, \n\t\t0x03U, 0x02U, 0x01U, 0x01U, \n\t\t0x01U, 0x03U, 0x02U, 0x01U, \n\t\t0x01U, 0x01U, 0x03U, 0x02U\n\t};\n\n\tGF256 gf256(0xf5);\n\n\tfor (int i = 0; i < 4; i++)\n\t{\n\t\tword32 temp = 0;\n\t\tfor (int j = 0; j < 4; j++)\n\t\t\tfor (int k = 0; k < 4; k++)\n\t\t\t\ttemp ^= (word32)gf256.Multiply(GETBYTE(in[i], 3-k), G[k][j]) << ((3-j)*8);\n\t\tout[i] = temp;\n\t}\n}",
          "includes": [
            "#include \"gf256.h\"",
            "#include \"misc.h\"",
            "#include \"square.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"gf256.h\"\n#include \"misc.h\"\n#include \"square.h\"\n#include \"pch.h\"\n\nstatic void SquareTransform (word32 in[4], word32 out[4])\n{\n\tstatic const byte G[4][4] = \n\t{\n\t\t0x02U, 0x01U, 0x01U, 0x03U, \n\t\t0x03U, 0x02U, 0x01U, 0x01U, \n\t\t0x01U, 0x03U, 0x02U, 0x01U, \n\t\t0x01U, 0x01U, 0x03U, 0x02U\n\t};\n\n\tGF256 gf256(0xf5);\n\n\tfor (int i = 0; i < 4; i++)\n\t{\n\t\tword32 temp = 0;\n\t\tfor (int j = 0; j < 4; j++)\n\t\t\tfor (int k = 0; k < 4; k++)\n\t\t\t\ttemp ^= (word32)gf256.Multiply(GETBYTE(in[i], 3-k), G[k][j]) << ((3-j)*8);\n\t\tout[i] = temp;\n\t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "ROUNDS"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "ROUNDS"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::swap",
          "args": [
            "roundkeys(i, j)",
            "roundkeys(ROUNDS-i, j)"
          ],
          "line": 67
        },
        "resolved": true,
        "details": {
          "function_name": "swap",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/polynomi.h",
          "lines": "453-456",
          "snippet": "inline void swap(CryptoPP::PolynomialOverFixedRing<T,i> &a, CryptoPP::PolynomialOverFixedRing<T,i> &b)\n{\n\ta.swap(b);\n}",
          "includes": [
            "#include <vector>",
            "#include <iosfwd>",
            "#include \"algebra.h\"",
            "#include \"misc.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <vector>\n#include <iosfwd>\n#include \"algebra.h\"\n#include \"misc.h\"\n#include \"cryptlib.h\"\n\ninline void swap(CryptoPP::PolynomialOverFixedRing<T,i> &a, CryptoPP::PolynomialOverFixedRing<T,i> &b)\n{\n\ta.swap(b);\n}"
        }
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "ROUNDS-i",
            "j"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i",
            "j"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "i"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys4",
          "args": [
            "i"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IsForwardTransformation",
          "args": [],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "IsForwardTransformation",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/arc4.h",
          "lines": "25-25",
          "snippet": "bool IsForwardTransformation() const {return true;}",
          "includes": [
            "#include \"strciphr.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"strciphr.h\"\n\nbool IsForwardTransformation() const {return true;}"
        }
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i",
            "2"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i-1",
            "3"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i",
            "3"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i",
            "1"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i-1",
            "2"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i",
            "2"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i",
            "0"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i-1",
            "1"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i",
            "1"
          ],
          "line": 52
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "rotlFixed",
          "args": [
            "roundkeys(i-1, 3)",
            "8U"
          ],
          "line": 51
        },
        "resolved": true,
        "details": {
          "function_name": "rotlFixed",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "580-584",
          "snippet": "inline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\ninline T rotlFixed(T x, unsigned int y)\n{\n\tassert(y < sizeof(T)*8);\n\treturn y ? T((x<<y) | (x>>(sizeof(T)*8-y))) : x;\n}"
        }
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i-1",
            "3"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i-1",
            "0"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "roundkeys",
          "args": [
            "i",
            "0"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetUserKey",
          "args": [
            "BIG_ENDIAN_ORDER",
            "m_roundkeys.data()",
            "KEYLENGTH/4",
            "userKey",
            "KEYLENGTH"
          ],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "GetUserKey",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/misc.h",
          "lines": "946-953",
          "snippet": "inline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}",
          "includes": [
            "#include <byteswap.h>",
            "#include <mem.h>",
            "#include <intrin.h>",
            "#include <string.h>\t\t// for memcpy and memmove",
            "#include \"smartptr.h\"",
            "#include \"cryptlib.h\""
          ],
          "macros_used": [
            "#define memcpy_s CryptoPP::memcpy_s"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <byteswap.h>\n#include <mem.h>\n#include <intrin.h>\n#include <string.h>\t\t// for memcpy and memmove\n#include \"smartptr.h\"\n#include \"cryptlib.h\"\n\n#define memcpy_s CryptoPP::memcpy_s\n\ninline void GetUserKey(ByteOrder order, T *out, size_t outlen, const byte *in, size_t inlen)\n{\n\tconst size_t U = sizeof(T);\n\tassert(inlen <= outlen*U);\n\tmemcpy_s(out, outlen*U, in, inlen);\n\tmemset_z((byte *)out+inlen, 0, outlen*U-inlen);\n\tConditionalByteReverse(order, out, out, RoundUpToMultipleOf(inlen, U));\n}"
        }
      },
      {
        "call_info": {
          "callee": "m_roundkeys.data",
          "args": [],
          "line": 46
        },
        "resolved": true,
        "details": {
          "function_name": "data",
          "container": "SecBlock",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/secblock.h",
          "lines": "300-300",
          "snippet": "typename A::const_pointer data() const {return m_ptr;}",
          "includes": [
            "#include <assert.h>",
            "#include \"misc.h\"",
            "#include \"config.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <assert.h>\n#include \"misc.h\"\n#include \"config.h\"\n\nSecBlock {\n  typename A::const_pointer data() const {return m_ptr;}\n}"
        }
      },
      {
        "call_info": {
          "callee": "AssertValidKeyLength",
          "args": [
            "length"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gf256.h\"\n#include \"misc.h\"\n#include \"square.h\"\n#include \"pch.h\"\n\nSquare {\n  Base {\n    void Square::Base::UncheckedSetKey(const byte *userKey, unsigned int length, const NameValuePairs &)\n    {\n    \tAssertValidKeyLength(length);\n    \n    \tstatic const word32 offset[ROUNDS] = {\n    \t0x01000000UL, 0x02000000UL, 0x04000000UL, 0x08000000UL,\n    \t0x10000000UL, 0x20000000UL, 0x40000000UL, 0x80000000UL,\n    \t};\n    \n    \tGetUserKey(BIG_ENDIAN_ORDER, m_roundkeys.data(), KEYLENGTH/4, userKey, KEYLENGTH);\n    \n    \t/* apply the key evolution function */\n    \tfor (int i = 1; i < ROUNDS+1; i++)\n    \t{\n    \t\troundkeys(i, 0) = roundkeys(i-1, 0) ^ rotlFixed(roundkeys(i-1, 3), 8U) ^ offset[i-1];\n    \t\troundkeys(i, 1) = roundkeys(i-1, 1) ^ roundkeys(i, 0);\n    \t\troundkeys(i, 2) = roundkeys(i-1, 2) ^ roundkeys(i, 1);\n    \t\troundkeys(i, 3) = roundkeys(i-1, 3) ^ roundkeys(i, 2);\n    \t}  \n    \n    \t/* produce the round keys */\n    \tif (IsForwardTransformation())\n    \t{\n    \t\tfor (int i = 0; i < ROUNDS; i++)\n    \t\t\tSquareTransform (roundkeys4(i), roundkeys4(i));\n    \t}\n    \telse\n    \t{\n    \t\tfor (int i = 0; i < ROUNDS/2; i++)\n    \t\t\tfor (int j = 0; j < 4; j++)\n    \t\t\t\tstd::swap(roundkeys(i, j), roundkeys(ROUNDS-i, j));\n    \t\tSquareTransform (roundkeys4(ROUNDS), roundkeys4(ROUNDS));\n    \t}\n    }\n  }\n}"
  },
  {
    "function_name": "SquareTransform",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/square.cpp",
    "lines": "12-32",
    "snippet": "static void SquareTransform (word32 in[4], word32 out[4])\n{\n\tstatic const byte G[4][4] = \n\t{\n\t\t0x02U, 0x01U, 0x01U, 0x03U, \n\t\t0x03U, 0x02U, 0x01U, 0x01U, \n\t\t0x01U, 0x03U, 0x02U, 0x01U, \n\t\t0x01U, 0x01U, 0x03U, 0x02U\n\t};\n\n\tGF256 gf256(0xf5);\n\n\tfor (int i = 0; i < 4; i++)\n\t{\n\t\tword32 temp = 0;\n\t\tfor (int j = 0; j < 4; j++)\n\t\t\tfor (int k = 0; k < 4; k++)\n\t\t\t\ttemp ^= (word32)gf256.Multiply(GETBYTE(in[i], 3-k), G[k][j]) << ((3-j)*8);\n\t\tout[i] = temp;\n\t}\n}",
    "includes": [
      "#include \"gf256.h\"",
      "#include \"misc.h\"",
      "#include \"square.h\"",
      "#include \"pch.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "gf256.Multiply",
          "args": [
            "GETBYTE(in[i], 3-k)",
            "G[k][j]"
          ],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "Multiply",
          "container": "Word",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2015-2141/repo/integer.cpp",
          "lines": "309-314",
          "snippet": "static Word Multiply(hword a, hword b)\n\t{\n\t\tWord r;\n\t\tr.m_whole = (word)a * b;\n\t\treturn r;\n\t}",
          "includes": [
            "#include <c_asm.h>",
            "#include <intrin.h>",
            "#include <iostream>",
            "#include \"cpu.h\"",
            "#include \"sha.h\"",
            "#include \"pubkey.h\"\t\t// for P1363_KDF2",
            "#include \"algparam.h\"",
            "#include \"words.h\"",
            "#include \"oids.h\"",
            "#include \"asn.h\"",
            "#include \"nbtheory.h\"",
            "#include \"modarith.h\"",
            "#include \"integer.h\"",
            "#include \"pch.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <c_asm.h>\n#include <intrin.h>\n#include <iostream>\n#include \"cpu.h\"\n#include \"sha.h\"\n#include \"pubkey.h\"\t\t// for P1363_KDF2\n#include \"algparam.h\"\n#include \"words.h\"\n#include \"oids.h\"\n#include \"asn.h\"\n#include \"nbtheory.h\"\n#include \"modarith.h\"\n#include \"integer.h\"\n#include \"pch.h\"\n\nWord {\n  static Word Multiply(hword a, hword b)\n  \t{\n  \t\tWord r;\n  \t\tr.m_whole = (word)a * b;\n  \t\treturn r;\n  \t}\n}"
        }
      },
      {
        "call_info": {
          "callee": "GETBYTE",
          "args": [
            "in[i]",
            "3-k"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"gf256.h\"\n#include \"misc.h\"\n#include \"square.h\"\n#include \"pch.h\"\n\nstatic void SquareTransform (word32 in[4], word32 out[4])\n{\n\tstatic const byte G[4][4] = \n\t{\n\t\t0x02U, 0x01U, 0x01U, 0x03U, \n\t\t0x03U, 0x02U, 0x01U, 0x01U, \n\t\t0x01U, 0x03U, 0x02U, 0x01U, \n\t\t0x01U, 0x01U, 0x03U, 0x02U\n\t};\n\n\tGF256 gf256(0xf5);\n\n\tfor (int i = 0; i < 4; i++)\n\t{\n\t\tword32 temp = 0;\n\t\tfor (int j = 0; j < 4; j++)\n\t\t\tfor (int k = 0; k < 4; k++)\n\t\t\t\ttemp ^= (word32)gf256.Multiply(GETBYTE(in[i], 3-k), G[k][j]) << ((3-j)*8);\n\t\tout[i] = temp;\n\t}\n}"
  }
]