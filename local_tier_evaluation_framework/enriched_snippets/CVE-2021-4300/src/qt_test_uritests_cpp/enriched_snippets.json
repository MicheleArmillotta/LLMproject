[
  {
    "function_name": "uriTests",
    "container": "URITests",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/test/uritests.cpp",
    "lines": "16-71",
    "snippet": "void URITests::uriTests()\n{\n    SendCoinsRecipient rv;\n    QUrl uri;\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-dontexist=\"));\n    QVERIFY(!GUIUtil::parseBitcoinURI(uri, &rv));\n\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?dontexist=\"));\n    QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n    QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n    QVERIFY(rv.label == QString());\n    QVERIFY(rv.amount == 0);\n\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?label=Wikipedia Example Address\"));\n    QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n    QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n    QVERIFY(rv.label == QString(\"Wikipedia Example Address\"));\n    QVERIFY(rv.amount == 0);\n\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=0.001\"));\n    QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n    QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n    QVERIFY(rv.label == QString());\n    QVERIFY(rv.amount == 100000);\n\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1.001\"));\n    QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n    QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n    QVERIFY(rv.label == QString());\n    QVERIFY(rv.amount == 100100000);\n\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=100&label=Wikipedia Example\"));\n    QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n    QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n    QVERIFY(rv.amount == 10000000000LL);\n    QVERIFY(rv.label == QString(\"Wikipedia Example\"));\n\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\"));\n    QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n    QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n    QVERIFY(rv.label == QString());\n\n    QVERIFY(GUIUtil::parseBitcoinURI(\"bitcoin://175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\", &rv));\n    QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n    QVERIFY(rv.label == QString());\n\n    // We currently don't implement the message parameter (ok, yea, we break spec...)\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-message=Wikipedia Example Address\"));\n    QVERIFY(!GUIUtil::parseBitcoinURI(uri, &rv));\n\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000&label=Wikipedia Example\"));\n    QVERIFY(!GUIUtil::parseBitcoinURI(uri, &rv));\n\n    uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000.0&label=Wikipedia Example\"));\n    QVERIFY(!GUIUtil::parseBitcoinURI(uri, &rv));\n}",
    "includes": [
      "#include <QUrl>",
      "#include \"../walletmodel.h\"",
      "#include \"../guiutil.h\"",
      "#include \"uritests.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "!GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::parseBitcoinURI",
          "args": [
            "uri",
            "&rv"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "parseBitcoinURI",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "124-136",
          "snippet": "bool parseBitcoinURI(QString uri, SendCoinsRecipient *out)\n{\n    // Convert halcyon:// to halcyon:\n    //\n    //    Cannot handle this later, because bitcoin:// will cause Qt to see the part after // as host,\n    //    which will lower-case it (and thus invalidate the address).\n    if(uri.startsWith(\"halcyon://\"))\n    {\n        uri.replace(0, 12, \"halcyon:\");\n    }\n    QUrl uriInstance(uri);\n    return parseBitcoinURI(uriInstance, out);\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nbool parseBitcoinURI(QString uri, SendCoinsRecipient *out)\n{\n    // Convert halcyon:// to halcyon:\n    //\n    //    Cannot handle this later, because bitcoin:// will cause Qt to see the part after // as host,\n    //    which will lower-case it (and thus invalidate the address).\n    if(uri.startsWith(\"halcyon://\"))\n    {\n        uri.replace(0, 12, \"halcyon:\");\n    }\n    QUrl uriInstance(uri);\n    return parseBitcoinURI(uriInstance, out);\n}"
        }
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000.0&label=Wikipedia Example\")"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000.0&label=Wikipedia Example\""
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "!GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000&label=Wikipedia Example\")"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000&label=Wikipedia Example\""
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "!GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 64
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-message=Wikipedia Example Address\")"
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-message=Wikipedia Example Address\""
          ],
          "line": 63
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.label == QString()"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\")"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\""
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "GUIUtil::parseBitcoinURI(\"bitcoin://175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\", &rv)"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.label == QString()"
          ],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 56
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\")"
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\""
          ],
          "line": 55
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\")"
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\""
          ],
          "line": 53
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.label == QString(\"Wikipedia Example\")"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"Wikipedia Example\""
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.amount == 10000000000LL"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\")"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\""
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=100&label=Wikipedia Example\")"
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=100&label=Wikipedia Example\""
          ],
          "line": 47
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.amount == 100100000"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.label == QString()"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\")"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\""
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 42
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1.001\")"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1.001\""
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.amount == 100000"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.label == QString()"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\")"
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\""
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=0.001\")"
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=0.001\""
          ],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.amount == 0"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.label == QString(\"Wikipedia Example Address\")"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"Wikipedia Example Address\""
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\")"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\""
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?label=Wikipedia Example Address\")"
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?label=Wikipedia Example Address\""
          ],
          "line": 29
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.amount == 0"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.label == QString()"
          ],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [],
          "line": 26
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\")"
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\""
          ],
          "line": 25
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?dontexist=\")"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?dontexist=\""
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QVERIFY",
          "args": [
            "!GUIUtil::parseBitcoinURI(uri, &rv)"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uri.setUrl",
          "args": [
            "QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-dontexist=\")"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-dontexist=\""
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QUrl>\n#include \"../walletmodel.h\"\n#include \"../guiutil.h\"\n#include \"uritests.h\"\n\nURITests {\n  void URITests::uriTests()\n  {\n      SendCoinsRecipient rv;\n      QUrl uri;\n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-dontexist=\"));\n      QVERIFY(!GUIUtil::parseBitcoinURI(uri, &rv));\n  \n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?dontexist=\"));\n      QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n      QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n      QVERIFY(rv.label == QString());\n      QVERIFY(rv.amount == 0);\n  \n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?label=Wikipedia Example Address\"));\n      QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n      QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n      QVERIFY(rv.label == QString(\"Wikipedia Example Address\"));\n      QVERIFY(rv.amount == 0);\n  \n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=0.001\"));\n      QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n      QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n      QVERIFY(rv.label == QString());\n      QVERIFY(rv.amount == 100000);\n  \n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1.001\"));\n      QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n      QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n      QVERIFY(rv.label == QString());\n      QVERIFY(rv.amount == 100100000);\n  \n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=100&label=Wikipedia Example\"));\n      QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n      QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n      QVERIFY(rv.amount == 10000000000LL);\n      QVERIFY(rv.label == QString(\"Wikipedia Example\"));\n  \n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\"));\n      QVERIFY(GUIUtil::parseBitcoinURI(uri, &rv));\n      QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n      QVERIFY(rv.label == QString());\n  \n      QVERIFY(GUIUtil::parseBitcoinURI(\"bitcoin://175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\", &rv));\n      QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n      QVERIFY(rv.label == QString());\n  \n      // We currently don't implement the message parameter (ok, yea, we break spec...)\n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-message=Wikipedia Example Address\"));\n      QVERIFY(!GUIUtil::parseBitcoinURI(uri, &rv));\n  \n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000&label=Wikipedia Example\"));\n      QVERIFY(!GUIUtil::parseBitcoinURI(uri, &rv));\n  \n      uri.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000.0&label=Wikipedia Example\"));\n      QVERIFY(!GUIUtil::parseBitcoinURI(uri, &rv));\n  }\n}"
  }
]