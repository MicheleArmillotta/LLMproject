[
  {
    "function_name": "print",
    "container": "CInv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "146-149",
    "snippet": "void CInv::print() const\n{\n    printf(\"CInv(%s)\\n\", ToString().c_str());\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"CInv(%s)\\n\"",
            "ToString().c_str()"
          ],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CInv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
          "lines": "141-144",
          "snippet": "std::string CInv::ToString() const\n{\n    return strprintf(\"%s %s\", GetCommand(), hash.ToString().substr(0,20).c_str());\n}",
          "includes": [
            "# include <arpa/inet.h>",
            "#include \"netbase.h\"",
            "#include \"util.h\"",
            "#include \"protocol.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCInv {\n  std::string CInv::ToString() const\n  {\n      return strprintf(\"%s %s\", GetCommand(), hash.ToString().substr(0,20).c_str());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCInv {\n  void CInv::print() const\n  {\n      printf(\"CInv(%s)\\n\", ToString().c_str());\n  }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CInv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "141-144",
    "snippet": "std::string CInv::ToString() const\n{\n    return strprintf(\"%s %s\", GetCommand(), hash.ToString().substr(0,20).c_str());\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%s %s\"",
            "GetCommand()",
            "hash.ToString().substr(0,20).c_str()"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "hash.ToString",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CInv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
          "lines": "141-144",
          "snippet": "std::string CInv::ToString() const\n{\n    return strprintf(\"%s %s\", GetCommand(), hash.ToString().substr(0,20).c_str());\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "hash.ToString",
          "args": [
            "0",
            "20"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Harness",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/table_test.cc",
          "lines": "595-602",
          "snippet": "std::string ToString(const KVMap& data,\n                       const KVMap::const_reverse_iterator& it) {\n    if (it == data.rend()) {\n      return \"END\";\n    } else {\n      return \"'\" + it->first + \"->\" + it->second + \"'\";\n    }\n  }",
          "includes": [
            "#include \"util/testutil.h\"",
            "#include \"util/testharness.h\"",
            "#include \"util/random.h\"",
            "#include \"table/format.h\"",
            "#include \"table/block_builder.h\"",
            "#include \"table/block.h\"",
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"db/write_batch_internal.h\"",
            "#include \"db/memtable.h\"",
            "#include \"db/dbformat.h\"",
            "#include <string>",
            "#include <map>",
            "#include \"leveldb/table.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/testutil.h\"\n#include \"util/testharness.h\"\n#include \"util/random.h\"\n#include \"table/format.h\"\n#include \"table/block_builder.h\"\n#include \"table/block.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"db/write_batch_internal.h\"\n#include \"db/memtable.h\"\n#include \"db/dbformat.h\"\n#include <string>\n#include <map>\n#include \"leveldb/table.h\"\n\nHarness {\n  std::string ToString(const KVMap& data,\n                         const KVMap::const_reverse_iterator& it) {\n      if (it == data.rend()) {\n        return \"END\";\n      } else {\n        return \"'\" + it->first + \"->\" + it->second + \"'\";\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetCommand",
          "args": [],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "GetCommand",
          "container": "CMessageHeader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
          "lines": "38-44",
          "snippet": "std::string CMessageHeader::GetCommand() const\n{\n    if (pchCommand[COMMAND_SIZE-1] == 0)\n        return std::string(pchCommand, pchCommand + strlen(pchCommand));\n    else\n        return std::string(pchCommand, pchCommand + COMMAND_SIZE);\n}",
          "includes": [
            "# include <arpa/inet.h>",
            "#include \"netbase.h\"",
            "#include \"util.h\"",
            "#include \"protocol.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCMessageHeader {\n  std::string CMessageHeader::GetCommand() const\n  {\n      if (pchCommand[COMMAND_SIZE-1] == 0)\n          return std::string(pchCommand, pchCommand + strlen(pchCommand));\n      else\n          return std::string(pchCommand, pchCommand + COMMAND_SIZE);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCInv {\n  std::string CInv::ToString() const\n  {\n      return strprintf(\"%s %s\", GetCommand(), hash.ToString().substr(0,20).c_str());\n  }\n}"
  },
  {
    "function_name": "IsKnownType",
    "container": "CInv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "129-132",
    "snippet": "bool CInv::IsKnownType() const\n{\n    return (type >= 1 && type < (int)ARRAYLEN(ppszTypeName));\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char* ppszTypeName[] =\n{\n    \"ERROR\",\n    \"tx\",\n    \"block\",\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "ARRAYLEN",
          "args": [
            "ppszTypeName"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nstatic const char* ppszTypeName[] =\n{\n    \"ERROR\",\n    \"tx\",\n    \"block\",\n};\n\nCInv {\n  bool CInv::IsKnownType() const\n  {\n      return (type >= 1 && type < (int)ARRAYLEN(ppszTypeName));\n  }\n}"
  },
  {
    "function_name": "CInv",
    "container": "CInv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "108-122",
    "snippet": "CInv::CInv(const std::string& strType, const uint256& hashIn)\n{\n    unsigned int i;\n    for (i = 1; i < ARRAYLEN(ppszTypeName); i++)\n    {\n        if (strType == ppszTypeName[i])\n        {\n            type = i;\n            break;\n        }\n    }\n    if (i == ARRAYLEN(ppszTypeName))\n        throw std::out_of_range(strprintf(\"CInv::CInv(string, uint256) : unknown type '%s'\", strType.c_str()));\n    hash = hashIn;\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "static const char* ppszTypeName[] =\n{\n    \"ERROR\",\n    \"tx\",\n    \"block\",\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::out_of_range",
          "args": [
            "strprintf(\"CInv::CInv(string, uint256) : unknown type '%s'\", strType.c_str())"
          ],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"CInv::CInv(string, uint256) : unknown type '%s'\"",
            "strType.c_str()"
          ],
          "line": 120
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "strType.c_str",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAYLEN",
          "args": [
            "ppszTypeName"
          ],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ARRAYLEN",
          "args": [
            "ppszTypeName"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nstatic const char* ppszTypeName[] =\n{\n    \"ERROR\",\n    \"tx\",\n    \"block\",\n};\n\nCInv {\n  CInv::CInv(const std::string& strType, const uint256& hashIn)\n  {\n      unsigned int i;\n      for (i = 1; i < ARRAYLEN(ppszTypeName); i++)\n      {\n          if (strType == ppszTypeName[i])\n          {\n              type = i;\n              break;\n          }\n      }\n      if (i == ARRAYLEN(ppszTypeName))\n          throw std::out_of_range(strprintf(\"CInv::CInv(string, uint256) : unknown type '%s'\", strType.c_str()));\n      hash = hashIn;\n  }\n}"
  },
  {
    "function_name": "CInv",
    "container": "CInv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "102-106",
    "snippet": "CInv::CInv(int typeIn, const uint256& hashIn)\n{\n    type = typeIn;\n    hash = hashIn;\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCInv {\n  CInv::CInv(int typeIn, const uint256& hashIn)\n  {\n      type = typeIn;\n      hash = hashIn;\n  }\n}"
  },
  {
    "function_name": "CInv",
    "container": "CInv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "96-100",
    "snippet": "CInv::CInv()\n{\n    type = 0;\n    hash = 0;\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCInv {\n  CInv::CInv()\n  {\n      type = 0;\n      hash = 0;\n  }\n}"
  },
  {
    "function_name": "Init",
    "container": "CAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "89-94",
    "snippet": "void CAddress::Init()\n{\n    nServices = NODE_NETWORK;\n    nTime = 100000000;\n    nLastTry = 0;\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCAddress {\n  void CAddress::Init()\n  {\n      nServices = NODE_NETWORK;\n      nTime = 100000000;\n      nLastTry = 0;\n  }\n}"
  },
  {
    "function_name": "CAddress",
    "container": "CAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "83-87",
    "snippet": "CAddress::CAddress(CService ipIn, uint64_t nServicesIn) : CService(ipIn)\n{\n    Init();\n    nServices = nServicesIn;\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
          "lines": "89-94",
          "snippet": "void CAddress::Init()\n{\n    nServices = NODE_NETWORK;\n    nTime = 100000000;\n    nLastTry = 0;\n}",
          "includes": [
            "# include <arpa/inet.h>",
            "#include \"netbase.h\"",
            "#include \"util.h\"",
            "#include \"protocol.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCAddress {\n  void CAddress::Init()\n  {\n      nServices = NODE_NETWORK;\n      nTime = 100000000;\n      nLastTry = 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCAddress {\n  CAddress::CAddress(CService ipIn, uint64_t nServicesIn) : CService(ipIn)\n  {\n      Init();\n      nServices = nServicesIn;\n  }\n}"
  },
  {
    "function_name": "CAddress",
    "container": "CAddress",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "78-81",
    "snippet": "CAddress::CAddress() : CService()\n{\n    Init();\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Init",
          "args": [],
          "line": 80
        },
        "resolved": true,
        "details": {
          "function_name": "Init",
          "container": "CAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
          "lines": "89-94",
          "snippet": "void CAddress::Init()\n{\n    nServices = NODE_NETWORK;\n    nTime = 100000000;\n    nLastTry = 0;\n}",
          "includes": [
            "# include <arpa/inet.h>",
            "#include \"netbase.h\"",
            "#include \"util.h\"",
            "#include \"protocol.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCAddress {\n  void CAddress::Init()\n  {\n      nServices = NODE_NETWORK;\n      nTime = 100000000;\n      nLastTry = 0;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCAddress {\n  CAddress::CAddress() : CService()\n  {\n      Init();\n  }\n}"
  },
  {
    "function_name": "IsValid",
    "container": "CMessageHeader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "46-74",
    "snippet": "bool CMessageHeader::IsValid() const\n{\n    // Check start string\n    if (memcmp(pchMessageStart, ::pchMessageStart, sizeof(pchMessageStart)) != 0)\n        return false;\n\n    // Check the command string for errors\n    for (const char* p1 = pchCommand; p1 < pchCommand + COMMAND_SIZE; p1++)\n    {\n        if (*p1 == 0)\n        {\n            // Must be all zeros after the first zero\n            for (; p1 < pchCommand + COMMAND_SIZE; p1++)\n                if (*p1 != 0)\n                    return false;\n        }\n        else if (*p1 < ' ' || *p1 > 0x7E)\n            return false;\n    }\n\n    // Message size\n    if (nMessageSize > MAX_SIZE)\n    {\n        printf(\"CMessageHeader::IsValid() : (%s, %u bytes) nMessageSize > MAX_SIZE\\n\", GetCommand().c_str(), nMessageSize);\n        return false;\n    }\n\n    return true;\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"CMessageHeader::IsValid() : (%s, %u bytes) nMessageSize > MAX_SIZE\\n\"",
            "GetCommand().c_str()",
            "nMessageSize"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetCommand",
          "args": [],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "GetCommand",
          "container": "CMessageHeader",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
          "lines": "38-44",
          "snippet": "std::string CMessageHeader::GetCommand() const\n{\n    if (pchCommand[COMMAND_SIZE-1] == 0)\n        return std::string(pchCommand, pchCommand + strlen(pchCommand));\n    else\n        return std::string(pchCommand, pchCommand + COMMAND_SIZE);\n}",
          "includes": [
            "# include <arpa/inet.h>",
            "#include \"netbase.h\"",
            "#include \"util.h\"",
            "#include \"protocol.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCMessageHeader {\n  std::string CMessageHeader::GetCommand() const\n  {\n      if (pchCommand[COMMAND_SIZE-1] == 0)\n          return std::string(pchCommand, pchCommand + strlen(pchCommand));\n      else\n          return std::string(pchCommand, pchCommand + COMMAND_SIZE);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "pchMessageStart",
            "::pchMessageStart",
            "sizeof(pchMessageStart)"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCMessageHeader {\n  bool CMessageHeader::IsValid() const\n  {\n      // Check start string\n      if (memcmp(pchMessageStart, ::pchMessageStart, sizeof(pchMessageStart)) != 0)\n          return false;\n  \n      // Check the command string for errors\n      for (const char* p1 = pchCommand; p1 < pchCommand + COMMAND_SIZE; p1++)\n      {\n          if (*p1 == 0)\n          {\n              // Must be all zeros after the first zero\n              for (; p1 < pchCommand + COMMAND_SIZE; p1++)\n                  if (*p1 != 0)\n                      return false;\n          }\n          else if (*p1 < ' ' || *p1 > 0x7E)\n              return false;\n      }\n  \n      // Message size\n      if (nMessageSize > MAX_SIZE)\n      {\n          printf(\"CMessageHeader::IsValid() : (%s, %u bytes) nMessageSize > MAX_SIZE\\n\", GetCommand().c_str(), nMessageSize);\n          return false;\n      }\n  \n      return true;\n  }\n}"
  },
  {
    "function_name": "GetCommand",
    "container": "CMessageHeader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "38-44",
    "snippet": "std::string CMessageHeader::GetCommand() const\n{\n    if (pchCommand[COMMAND_SIZE-1] == 0)\n        return std::string(pchCommand, pchCommand + strlen(pchCommand));\n    else\n        return std::string(pchCommand, pchCommand + COMMAND_SIZE);\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "pchCommand",
            "pchCommand + COMMAND_SIZE"
          ],
          "line": 43
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "pchCommand",
            "pchCommand + strlen(pchCommand)"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "pchCommand"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCMessageHeader {\n  std::string CMessageHeader::GetCommand() const\n  {\n      if (pchCommand[COMMAND_SIZE-1] == 0)\n          return std::string(pchCommand, pchCommand + strlen(pchCommand));\n      else\n          return std::string(pchCommand, pchCommand + COMMAND_SIZE);\n  }\n}"
  },
  {
    "function_name": "CMessageHeader",
    "container": "CMessageHeader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "30-36",
    "snippet": "CMessageHeader::CMessageHeader(const char* pszCommand, unsigned int nMessageSizeIn)\n{\n    memcpy(pchMessageStart, ::pchMessageStart, sizeof(pchMessageStart));\n    strncpy(pchCommand, pszCommand, COMMAND_SIZE);\n    nMessageSize = nMessageSizeIn;\n    nChecksum = 0;\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strncpy",
          "args": [
            "pchCommand",
            "pszCommand",
            "COMMAND_SIZE"
          ],
          "line": 33
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "pchMessageStart",
            "::pchMessageStart",
            "sizeof(pchMessageStart)"
          ],
          "line": 32
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCMessageHeader {\n  CMessageHeader::CMessageHeader(const char* pszCommand, unsigned int nMessageSizeIn)\n  {\n      memcpy(pchMessageStart, ::pchMessageStart, sizeof(pchMessageStart));\n      strncpy(pchCommand, pszCommand, COMMAND_SIZE);\n      nMessageSize = nMessageSizeIn;\n      nChecksum = 0;\n  }\n}"
  },
  {
    "function_name": "CMessageHeader",
    "container": "CMessageHeader",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/protocol.cpp",
    "lines": "21-28",
    "snippet": "CMessageHeader::CMessageHeader()\n{\n    memcpy(pchMessageStart, ::pchMessageStart, sizeof(pchMessageStart));\n    memset(pchCommand, 0, sizeof(pchCommand));\n    pchCommand[1] = 1;\n    nMessageSize = -1;\n    nChecksum = 0;\n}",
    "includes": [
      "# include <arpa/inet.h>",
      "#include \"netbase.h\"",
      "#include \"util.h\"",
      "#include \"protocol.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "pchCommand",
            "0",
            "sizeof(pchCommand)"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "pchMessageStart",
            "::pchMessageStart",
            "sizeof(pchMessageStart)"
          ],
          "line": 23
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "# include <arpa/inet.h>\n#include \"netbase.h\"\n#include \"util.h\"\n#include \"protocol.h\"\n\nCMessageHeader {\n  CMessageHeader::CMessageHeader()\n  {\n      memcpy(pchMessageStart, ::pchMessageStart, sizeof(pchMessageStart));\n      memset(pchCommand, 0, sizeof(pchCommand));\n      pchCommand[1] = 1;\n      nMessageSize = -1;\n      nChecksum = 0;\n  }\n}"
  }
]