[
  {
    "function_name": "GetID",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "583-586",
    "snippet": "CScriptID GetID() const\n    {\n        return CScriptID(Hash160(*this));\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CScriptID",
          "args": [
            "Hash160(*this)"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "CScriptID",
          "container": "CScriptID",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "60-60",
          "snippet": "CScriptID(const uint160 &in) : uint160(in) { }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCScriptID {\n  CScriptID(const uint160 &in) : uint160(in) { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Hash160",
          "args": [
            "*this"
          ],
          "line": 585
        },
        "resolved": true,
        "details": {
          "function_name": "Hash160",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "554-561",
          "snippet": "inline uint160 Hash160(const std::vector<unsigned char>& vch)\n{\n    uint256 hash1;\n    SHA256(&vch[0], vch.size(), (unsigned char*)&hash1);\n    uint160 hash2;\n    RIPEMD160((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint160 Hash160(const std::vector<unsigned char>& vch)\n{\n    uint256 hash1;\n    SHA256(&vch[0], vch.size(), (unsigned char*)&hash1);\n    uint160 hash2;\n    RIPEMD160((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  CScriptID GetID() const\n      {\n          return CScriptID(Hash160(*this));\n      }\n}"
  },
  {
    "function_name": "print",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "578-581",
    "snippet": "void print() const\n    {\n        printf(\"%s\\n\", ToString().c_str());\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"%s\\n\"",
            "ToString().c_str()"
          ],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ToString",
          "args": [],
          "line": 580
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "555-576",
          "snippet": "std::string ToString(bool fShort=false) const\n    {\n        std::string str;\n        opcodetype opcode;\n        std::vector<unsigned char> vch;\n        const_iterator pc = begin();\n        while (pc < end())\n        {\n            if (!str.empty())\n                str += \" \";\n            if (!GetOp(pc, opcode, vch))\n            {\n                str += \"[error]\";\n                return str;\n            }\n            if (0 <= opcode && opcode <= OP_PUSHDATA4)\n                str += fShort? ValueString(vch).substr(0, 10) : ValueString(vch);\n            else\n                str += GetOpName(opcode);\n        }\n        return str;\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  std::string ToString(bool fShort=false) const\n      {\n          std::string str;\n          opcodetype opcode;\n          std::vector<unsigned char> vch;\n          const_iterator pc = begin();\n          while (pc < end())\n          {\n              if (!str.empty())\n                  str += \" \";\n              if (!GetOp(pc, opcode, vch))\n              {\n                  str += \"[error]\";\n                  return str;\n              }\n              if (0 <= opcode && opcode <= OP_PUSHDATA4)\n                  str += fShort? ValueString(vch).substr(0, 10) : ValueString(vch);\n              else\n                  str += GetOpName(opcode);\n          }\n          return str;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  void print() const\n      {\n          printf(\"%s\\n\", ToString().c_str());\n      }\n}"
  },
  {
    "function_name": "ToString",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "555-576",
    "snippet": "std::string ToString(bool fShort=false) const\n    {\n        std::string str;\n        opcodetype opcode;\n        std::vector<unsigned char> vch;\n        const_iterator pc = begin();\n        while (pc < end())\n        {\n            if (!str.empty())\n                str += \" \";\n            if (!GetOp(pc, opcode, vch))\n            {\n                str += \"[error]\";\n                return str;\n            }\n            if (0 <= opcode && opcode <= OP_PUSHDATA4)\n                str += fShort? ValueString(vch).substr(0, 10) : ValueString(vch);\n            else\n                str += GetOpName(opcode);\n        }\n        return str;\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetOpName",
          "args": [
            "opcode"
          ],
          "line": 573
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ValueString",
          "args": [
            "vch"
          ],
          "line": 571
        },
        "resolved": true,
        "details": {
          "function_name": "ValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "210-216",
          "snippet": "inline std::string ValueString(const std::vector<unsigned char>& vch)\n{\n    if (vch.size() <= 4)\n        return strprintf(\"%d\", CBigNum(vch).getint());\n    else\n        return HexStr(vch);\n}",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\ninline std::string ValueString(const std::vector<unsigned char>& vch)\n{\n    if (vch.size() <= 4)\n        return strprintf(\"%d\", CBigNum(vch).getint());\n    else\n        return HexStr(vch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "ValueString",
          "args": [
            "0",
            "10"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetOp",
          "args": [
            "pc",
            "opcode",
            "vch"
          ],
          "line": 565
        },
        "resolved": true,
        "details": {
          "function_name": "GetOp2",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "418-469",
          "snippet": "bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n    {\n        opcodeRet = OP_INVALIDOPCODE;\n        if (pvchRet)\n            pvchRet->clear();\n        if (pc >= end())\n            return false;\n\n        // Read instruction\n        if (end() - pc < 1)\n            return false;\n        unsigned int opcode = *pc++;\n\n        // Immediate operand\n        if (opcode <= OP_PUSHDATA4)\n        {\n            unsigned int nSize;\n            if (opcode < OP_PUSHDATA1)\n            {\n                nSize = opcode;\n            }\n            else if (opcode == OP_PUSHDATA1)\n            {\n                if (end() - pc < 1)\n                    return false;\n                nSize = *pc++;\n            }\n            else if (opcode == OP_PUSHDATA2)\n            {\n                if (end() - pc < 2)\n                    return false;\n                nSize = 0;\n                memcpy(&nSize, &pc[0], 2);\n                pc += 2;\n            }\n            else if (opcode == OP_PUSHDATA4)\n            {\n                if (end() - pc < 4)\n                    return false;\n                memcpy(&nSize, &pc[0], 4);\n                pc += 4;\n            }\n            if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                return false;\n            if (pvchRet)\n                pvchRet->assign(pc, pc + nSize);\n            pc += nSize;\n        }\n\n        opcodeRet = (opcodetype)opcode;\n        return true;\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n      {\n          opcodeRet = OP_INVALIDOPCODE;\n          if (pvchRet)\n              pvchRet->clear();\n          if (pc >= end())\n              return false;\n  \n          // Read instruction\n          if (end() - pc < 1)\n              return false;\n          unsigned int opcode = *pc++;\n  \n          // Immediate operand\n          if (opcode <= OP_PUSHDATA4)\n          {\n              unsigned int nSize;\n              if (opcode < OP_PUSHDATA1)\n              {\n                  nSize = opcode;\n              }\n              else if (opcode == OP_PUSHDATA1)\n              {\n                  if (end() - pc < 1)\n                      return false;\n                  nSize = *pc++;\n              }\n              else if (opcode == OP_PUSHDATA2)\n              {\n                  if (end() - pc < 2)\n                      return false;\n                  nSize = 0;\n                  memcpy(&nSize, &pc[0], 2);\n                  pc += 2;\n              }\n              else if (opcode == OP_PUSHDATA4)\n              {\n                  if (end() - pc < 4)\n                      return false;\n                  memcpy(&nSize, &pc[0], 4);\n                  pc += 4;\n              }\n              if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                  return false;\n              if (pvchRet)\n                  pvchRet->assign(pc, pc + nSize);\n              pc += nSize;\n          }\n  \n          opcodeRet = (opcodetype)opcode;\n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.empty",
          "args": [],
          "line": 563
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 561
        },
        "resolved": true,
        "details": {
          "function_name": "SendBufferSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "30-30",
          "snippet": "inline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }"
        }
      },
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 560
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  std::string ToString(bool fShort=false) const\n      {\n          std::string str;\n          opcodetype opcode;\n          std::vector<unsigned char> vch;\n          const_iterator pc = begin();\n          while (pc < end())\n          {\n              if (!str.empty())\n                  str += \" \";\n              if (!GetOp(pc, opcode, vch))\n              {\n                  str += \"[error]\";\n                  return str;\n              }\n              if (0 <= opcode && opcode <= OP_PUSHDATA4)\n                  str += fShort? ValueString(vch).substr(0, 10) : ValueString(vch);\n              else\n                  str += GetOpName(opcode);\n          }\n          return str;\n      }\n}"
  },
  {
    "function_name": "PrintHex",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "550-553",
    "snippet": "void PrintHex() const\n    {\n        printf(\"CScript(%s)\\n\", HexStr(begin(), end(), true).c_str());\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "printf",
          "args": [
            "\"CScript(%s)\\n\"",
            "HexStr(begin(), end(), true).c_str()"
          ],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "HexStr",
          "args": [
            "begin()",
            "end()",
            "true"
          ],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "SendBufferSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "30-30",
          "snippet": "inline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }"
        }
      },
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 552
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  void PrintHex() const\n      {\n          printf(\"CScript(%s)\\n\", HexStr(begin(), end(), true).c_str());\n      }\n}"
  },
  {
    "function_name": "IsPushOnly",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "529-541",
    "snippet": "bool IsPushOnly() const\n    {\n        const_iterator pc = begin();\n        while (pc < end())\n        {\n            opcodetype opcode;\n            if (!GetOp(pc, opcode))\n                return false;\n            if (opcode > OP_16)\n                return false;\n        }\n        return true;\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetOp",
          "args": [
            "pc",
            "opcode"
          ],
          "line": 535
        },
        "resolved": true,
        "details": {
          "function_name": "GetOp",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "413-416",
          "snippet": "bool GetOp(const_iterator& pc, opcodetype& opcodeRet) const\n    {\n        return GetOp2(pc, opcodeRet, NULL);\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp(const_iterator& pc, opcodetype& opcodeRet) const\n      {\n          return GetOp2(pc, opcodeRet, NULL);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 532
        },
        "resolved": true,
        "details": {
          "function_name": "SendBufferSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "30-30",
          "snippet": "inline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }"
        }
      },
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 531
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool IsPushOnly() const\n      {\n          const_iterator pc = begin();\n          while (pc < end())\n          {\n              opcodetype opcode;\n              if (!GetOp(pc, opcode))\n                  return false;\n              if (opcode > OP_16)\n                  return false;\n          }\n          return true;\n      }\n}"
  },
  {
    "function_name": "Find",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "505-513",
    "snippet": "int Find(opcodetype op) const\n    {\n        int nFound = 0;\n        opcodetype opcode;\n        for (const_iterator pc = begin(); pc != end() && GetOp(pc, opcode);)\n            if (opcode == op)\n                ++nFound;\n        return nFound;\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetOp",
          "args": [
            "pc",
            "opcode"
          ],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "GetOp",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "413-416",
          "snippet": "bool GetOp(const_iterator& pc, opcodetype& opcodeRet) const\n    {\n        return GetOp2(pc, opcodeRet, NULL);\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp(const_iterator& pc, opcodetype& opcodeRet) const\n      {\n          return GetOp2(pc, opcodeRet, NULL);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "SendBufferSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "30-30",
          "snippet": "inline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }"
        }
      },
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 509
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  int Find(opcodetype op) const\n      {\n          int nFound = 0;\n          opcodetype opcode;\n          for (const_iterator pc = begin(); pc != end() && GetOp(pc, opcode);)\n              if (opcode == op)\n                  ++nFound;\n          return nFound;\n      }\n}"
  },
  {
    "function_name": "FindAndDelete",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "487-504",
    "snippet": "int FindAndDelete(const CScript& b)\n    {\n        int nFound = 0;\n        if (b.empty())\n            return nFound;\n        iterator pc = begin();\n        opcodetype opcode;\n        do\n        {\n            while (end() - pc >= (long)b.size() && memcmp(&pc[0], &b[0], b.size()) == 0)\n            {\n                erase(pc, pc + b.size());\n                ++nFound;\n            }\n        }\n        while (GetOp(pc, opcode));\n        return nFound;\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetOp",
          "args": [
            "pc",
            "opcode"
          ],
          "line": 502
        },
        "resolved": true,
        "details": {
          "function_name": "GetOp",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "413-416",
          "snippet": "bool GetOp(const_iterator& pc, opcodetype& opcodeRet) const\n    {\n        return GetOp2(pc, opcodeRet, NULL);\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp(const_iterator& pc, opcodetype& opcodeRet) const\n      {\n          return GetOp2(pc, opcodeRet, NULL);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "erase",
          "args": [
            "pc",
            "pc + b.size()"
          ],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "870-888",
          "snippet": "iterator erase(iterator first, iterator last)\n    {\n        if (first == vch.begin() + nReadPos)\n        {\n            // special case for erasing from the front\n            if (last == vch.end())\n            {\n                nReadPos = 0;\n                return vch.erase(vch.begin(), vch.end());\n            }\n            else\n            {\n                nReadPos = (last - vch.begin());\n                return last;\n            }\n        }\n        else\n            return vch.erase(first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  iterator erase(iterator first, iterator last)\n      {\n          if (first == vch.begin() + nReadPos)\n          {\n              // special case for erasing from the front\n              if (last == vch.end())\n              {\n                  nReadPos = 0;\n                  return vch.erase(vch.begin(), vch.end());\n              }\n              else\n              {\n                  nReadPos = (last - vch.begin());\n                  return last;\n              }\n          }\n          else\n              return vch.erase(first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b.size",
          "args": [],
          "line": 498
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "memcmp",
          "args": [
            "&pc[0]",
            "&b[0]",
            "b.size()"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 496
        },
        "resolved": true,
        "details": {
          "function_name": "SendBufferSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "30-30",
          "snippet": "inline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }"
        }
      },
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 492
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b.empty",
          "args": [],
          "line": 490
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  int FindAndDelete(const CScript& b)\n      {\n          int nFound = 0;\n          if (b.empty())\n              return nFound;\n          iterator pc = begin();\n          opcodetype opcode;\n          do\n          {\n              while (end() - pc >= (long)b.size() && memcmp(&pc[0], &b[0], b.size()) == 0)\n              {\n                  erase(pc, pc + b.size());\n                  ++nFound;\n              }\n          }\n          while (GetOp(pc, opcode));\n          return nFound;\n      }\n}"
  },
  {
    "function_name": "EncodeOP_N",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "479-485",
    "snippet": "static opcodetype EncodeOP_N(int n)\n    {\n        assert(n >= 0 && n <= 16);\n        if (n == 0)\n            return OP_0;\n        return (opcodetype)(OP_1+n-1);\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "OP_1+n-1"
          ],
          "line": 484
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "n >= 0 && n <= 16"
          ],
          "line": 481
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  static opcodetype EncodeOP_N(int n)\n      {\n          assert(n >= 0 && n <= 16);\n          if (n == 0)\n              return OP_0;\n          return (opcodetype)(OP_1+n-1);\n      }\n}"
  },
  {
    "function_name": "DecodeOP_N",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "472-478",
    "snippet": "static int DecodeOP_N(opcodetype opcode)\n    {\n        if (opcode == OP_0)\n            return 0;\n        assert(opcode >= OP_1 && opcode <= OP_16);\n        return (int)opcode - (int)(OP_1 - 1);\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "opcode >= OP_1 && opcode <= OP_16"
          ],
          "line": 476
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  static int DecodeOP_N(opcodetype opcode)\n      {\n          if (opcode == OP_0)\n              return 0;\n          assert(opcode >= OP_1 && opcode <= OP_16);\n          return (int)opcode - (int)(OP_1 - 1);\n      }\n}"
  },
  {
    "function_name": "GetOp2",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "418-469",
    "snippet": "bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n    {\n        opcodeRet = OP_INVALIDOPCODE;\n        if (pvchRet)\n            pvchRet->clear();\n        if (pc >= end())\n            return false;\n\n        // Read instruction\n        if (end() - pc < 1)\n            return false;\n        unsigned int opcode = *pc++;\n\n        // Immediate operand\n        if (opcode <= OP_PUSHDATA4)\n        {\n            unsigned int nSize;\n            if (opcode < OP_PUSHDATA1)\n            {\n                nSize = opcode;\n            }\n            else if (opcode == OP_PUSHDATA1)\n            {\n                if (end() - pc < 1)\n                    return false;\n                nSize = *pc++;\n            }\n            else if (opcode == OP_PUSHDATA2)\n            {\n                if (end() - pc < 2)\n                    return false;\n                nSize = 0;\n                memcpy(&nSize, &pc[0], 2);\n                pc += 2;\n            }\n            else if (opcode == OP_PUSHDATA4)\n            {\n                if (end() - pc < 4)\n                    return false;\n                memcpy(&nSize, &pc[0], 4);\n                pc += 4;\n            }\n            if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                return false;\n            if (pvchRet)\n                pvchRet->assign(pc, pc + nSize);\n            pc += nSize;\n        }\n\n        opcodeRet = (opcodetype)opcode;\n        return true;\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "pvchRet->assign",
          "args": [
            "pc",
            "pc + nSize"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "end",
          "args": [],
          "line": 460
        },
        "resolved": true,
        "details": {
          "function_name": "SendBufferSize",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/net.h",
          "lines": "30-30",
          "snippet": "inline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }",
          "includes": [
            "#include \"addrman.h\"",
            "#include \"protocol.h\"",
            "#include \"netbase.h\"",
            "#include \"mruset.h\"",
            "#include <arpa/inet.h>",
            "#include <openssl/rand.h>",
            "#include <boost/foreach.hpp>",
            "#include <boost/array.hpp>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"addrman.h\"\n#include \"protocol.h\"\n#include \"netbase.h\"\n#include \"mruset.h\"\n#include <arpa/inet.h>\n#include <openssl/rand.h>\n#include <boost/foreach.hpp>\n#include <boost/array.hpp>\n#include <deque>\n\ninline unsigned int SendBufferSize() { return 1000*GetArg(\"-maxsendbuffer\", 1*1000); }"
        }
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&nSize",
            "&pc[0]",
            "4"
          ],
          "line": 457
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&nSize",
            "&pc[0]",
            "2"
          ],
          "line": 450
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pvchRet->clear",
          "args": [],
          "line": 422
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n      {\n          opcodeRet = OP_INVALIDOPCODE;\n          if (pvchRet)\n              pvchRet->clear();\n          if (pc >= end())\n              return false;\n  \n          // Read instruction\n          if (end() - pc < 1)\n              return false;\n          unsigned int opcode = *pc++;\n  \n          // Immediate operand\n          if (opcode <= OP_PUSHDATA4)\n          {\n              unsigned int nSize;\n              if (opcode < OP_PUSHDATA1)\n              {\n                  nSize = opcode;\n              }\n              else if (opcode == OP_PUSHDATA1)\n              {\n                  if (end() - pc < 1)\n                      return false;\n                  nSize = *pc++;\n              }\n              else if (opcode == OP_PUSHDATA2)\n              {\n                  if (end() - pc < 2)\n                      return false;\n                  nSize = 0;\n                  memcpy(&nSize, &pc[0], 2);\n                  pc += 2;\n              }\n              else if (opcode == OP_PUSHDATA4)\n              {\n                  if (end() - pc < 4)\n                      return false;\n                  memcpy(&nSize, &pc[0], 4);\n                  pc += 4;\n              }\n              if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                  return false;\n              if (pvchRet)\n                  pvchRet->assign(pc, pc + nSize);\n              pc += nSize;\n          }\n  \n          opcodeRet = (opcodetype)opcode;\n          return true;\n      }\n}"
  },
  {
    "function_name": "GetOp",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "413-416",
    "snippet": "bool GetOp(const_iterator& pc, opcodetype& opcodeRet) const\n    {\n        return GetOp2(pc, opcodeRet, NULL);\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetOp2",
          "args": [
            "pc",
            "opcodeRet",
            "NULL"
          ],
          "line": 415
        },
        "resolved": true,
        "details": {
          "function_name": "GetOp2",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "418-469",
          "snippet": "bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n    {\n        opcodeRet = OP_INVALIDOPCODE;\n        if (pvchRet)\n            pvchRet->clear();\n        if (pc >= end())\n            return false;\n\n        // Read instruction\n        if (end() - pc < 1)\n            return false;\n        unsigned int opcode = *pc++;\n\n        // Immediate operand\n        if (opcode <= OP_PUSHDATA4)\n        {\n            unsigned int nSize;\n            if (opcode < OP_PUSHDATA1)\n            {\n                nSize = opcode;\n            }\n            else if (opcode == OP_PUSHDATA1)\n            {\n                if (end() - pc < 1)\n                    return false;\n                nSize = *pc++;\n            }\n            else if (opcode == OP_PUSHDATA2)\n            {\n                if (end() - pc < 2)\n                    return false;\n                nSize = 0;\n                memcpy(&nSize, &pc[0], 2);\n                pc += 2;\n            }\n            else if (opcode == OP_PUSHDATA4)\n            {\n                if (end() - pc < 4)\n                    return false;\n                memcpy(&nSize, &pc[0], 4);\n                pc += 4;\n            }\n            if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                return false;\n            if (pvchRet)\n                pvchRet->assign(pc, pc + nSize);\n            pc += nSize;\n        }\n\n        opcodeRet = (opcodetype)opcode;\n        return true;\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n      {\n          opcodeRet = OP_INVALIDOPCODE;\n          if (pvchRet)\n              pvchRet->clear();\n          if (pc >= end())\n              return false;\n  \n          // Read instruction\n          if (end() - pc < 1)\n              return false;\n          unsigned int opcode = *pc++;\n  \n          // Immediate operand\n          if (opcode <= OP_PUSHDATA4)\n          {\n              unsigned int nSize;\n              if (opcode < OP_PUSHDATA1)\n              {\n                  nSize = opcode;\n              }\n              else if (opcode == OP_PUSHDATA1)\n              {\n                  if (end() - pc < 1)\n                      return false;\n                  nSize = *pc++;\n              }\n              else if (opcode == OP_PUSHDATA2)\n              {\n                  if (end() - pc < 2)\n                      return false;\n                  nSize = 0;\n                  memcpy(&nSize, &pc[0], 2);\n                  pc += 2;\n              }\n              else if (opcode == OP_PUSHDATA4)\n              {\n                  if (end() - pc < 4)\n                      return false;\n                  memcpy(&nSize, &pc[0], 4);\n                  pc += 4;\n              }\n              if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                  return false;\n              if (pvchRet)\n                  pvchRet->assign(pc, pc + nSize);\n              pc += nSize;\n          }\n  \n          opcodeRet = (opcodetype)opcode;\n          return true;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp(const_iterator& pc, opcodetype& opcodeRet) const\n      {\n          return GetOp2(pc, opcodeRet, NULL);\n      }\n}"
  },
  {
    "function_name": "GetOp",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "408-411",
    "snippet": "bool GetOp(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>& vchRet) const\n    {\n        return GetOp2(pc, opcodeRet, &vchRet);\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GetOp2",
          "args": [
            "pc",
            "opcodeRet",
            "&vchRet"
          ],
          "line": 410
        },
        "resolved": true,
        "details": {
          "function_name": "GetOp2",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "418-469",
          "snippet": "bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n    {\n        opcodeRet = OP_INVALIDOPCODE;\n        if (pvchRet)\n            pvchRet->clear();\n        if (pc >= end())\n            return false;\n\n        // Read instruction\n        if (end() - pc < 1)\n            return false;\n        unsigned int opcode = *pc++;\n\n        // Immediate operand\n        if (opcode <= OP_PUSHDATA4)\n        {\n            unsigned int nSize;\n            if (opcode < OP_PUSHDATA1)\n            {\n                nSize = opcode;\n            }\n            else if (opcode == OP_PUSHDATA1)\n            {\n                if (end() - pc < 1)\n                    return false;\n                nSize = *pc++;\n            }\n            else if (opcode == OP_PUSHDATA2)\n            {\n                if (end() - pc < 2)\n                    return false;\n                nSize = 0;\n                memcpy(&nSize, &pc[0], 2);\n                pc += 2;\n            }\n            else if (opcode == OP_PUSHDATA4)\n            {\n                if (end() - pc < 4)\n                    return false;\n                memcpy(&nSize, &pc[0], 4);\n                pc += 4;\n            }\n            if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                return false;\n            if (pvchRet)\n                pvchRet->assign(pc, pc + nSize);\n            pc += nSize;\n        }\n\n        opcodeRet = (opcodetype)opcode;\n        return true;\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n      {\n          opcodeRet = OP_INVALIDOPCODE;\n          if (pvchRet)\n              pvchRet->clear();\n          if (pc >= end())\n              return false;\n  \n          // Read instruction\n          if (end() - pc < 1)\n              return false;\n          unsigned int opcode = *pc++;\n  \n          // Immediate operand\n          if (opcode <= OP_PUSHDATA4)\n          {\n              unsigned int nSize;\n              if (opcode < OP_PUSHDATA1)\n              {\n                  nSize = opcode;\n              }\n              else if (opcode == OP_PUSHDATA1)\n              {\n                  if (end() - pc < 1)\n                      return false;\n                  nSize = *pc++;\n              }\n              else if (opcode == OP_PUSHDATA2)\n              {\n                  if (end() - pc < 2)\n                      return false;\n                  nSize = 0;\n                  memcpy(&nSize, &pc[0], 2);\n                  pc += 2;\n              }\n              else if (opcode == OP_PUSHDATA4)\n              {\n                  if (end() - pc < 4)\n                      return false;\n                  memcpy(&nSize, &pc[0], 4);\n                  pc += 4;\n              }\n              if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                  return false;\n              if (pvchRet)\n                  pvchRet->assign(pc, pc + nSize);\n              pc += nSize;\n          }\n  \n          opcodeRet = (opcodetype)opcode;\n          return true;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>& vchRet) const\n      {\n          return GetOp2(pc, opcodeRet, &vchRet);\n      }\n}"
  },
  {
    "function_name": "GetOp",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "400-406",
    "snippet": "bool GetOp(iterator& pc, opcodetype& opcodeRet)\n    {\n         const_iterator pc2 = pc;\n         bool fRet = GetOp2(pc2, opcodeRet, NULL);\n         pc = begin() + (pc2 - begin());\n         return fRet;\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetOp2",
          "args": [
            "pc2",
            "opcodeRet",
            "NULL"
          ],
          "line": 403
        },
        "resolved": true,
        "details": {
          "function_name": "GetOp2",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "418-469",
          "snippet": "bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n    {\n        opcodeRet = OP_INVALIDOPCODE;\n        if (pvchRet)\n            pvchRet->clear();\n        if (pc >= end())\n            return false;\n\n        // Read instruction\n        if (end() - pc < 1)\n            return false;\n        unsigned int opcode = *pc++;\n\n        // Immediate operand\n        if (opcode <= OP_PUSHDATA4)\n        {\n            unsigned int nSize;\n            if (opcode < OP_PUSHDATA1)\n            {\n                nSize = opcode;\n            }\n            else if (opcode == OP_PUSHDATA1)\n            {\n                if (end() - pc < 1)\n                    return false;\n                nSize = *pc++;\n            }\n            else if (opcode == OP_PUSHDATA2)\n            {\n                if (end() - pc < 2)\n                    return false;\n                nSize = 0;\n                memcpy(&nSize, &pc[0], 2);\n                pc += 2;\n            }\n            else if (opcode == OP_PUSHDATA4)\n            {\n                if (end() - pc < 4)\n                    return false;\n                memcpy(&nSize, &pc[0], 4);\n                pc += 4;\n            }\n            if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                return false;\n            if (pvchRet)\n                pvchRet->assign(pc, pc + nSize);\n            pc += nSize;\n        }\n\n        opcodeRet = (opcodetype)opcode;\n        return true;\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n      {\n          opcodeRet = OP_INVALIDOPCODE;\n          if (pvchRet)\n              pvchRet->clear();\n          if (pc >= end())\n              return false;\n  \n          // Read instruction\n          if (end() - pc < 1)\n              return false;\n          unsigned int opcode = *pc++;\n  \n          // Immediate operand\n          if (opcode <= OP_PUSHDATA4)\n          {\n              unsigned int nSize;\n              if (opcode < OP_PUSHDATA1)\n              {\n                  nSize = opcode;\n              }\n              else if (opcode == OP_PUSHDATA1)\n              {\n                  if (end() - pc < 1)\n                      return false;\n                  nSize = *pc++;\n              }\n              else if (opcode == OP_PUSHDATA2)\n              {\n                  if (end() - pc < 2)\n                      return false;\n                  nSize = 0;\n                  memcpy(&nSize, &pc[0], 2);\n                  pc += 2;\n              }\n              else if (opcode == OP_PUSHDATA4)\n              {\n                  if (end() - pc < 4)\n                      return false;\n                  memcpy(&nSize, &pc[0], 4);\n                  pc += 4;\n              }\n              if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                  return false;\n              if (pvchRet)\n                  pvchRet->assign(pc, pc + nSize);\n              pc += nSize;\n          }\n  \n          opcodeRet = (opcodetype)opcode;\n          return true;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp(iterator& pc, opcodetype& opcodeRet)\n      {\n           const_iterator pc2 = pc;\n           bool fRet = GetOp2(pc2, opcodeRet, NULL);\n           pc = begin() + (pc2 - begin());\n           return fRet;\n      }\n}"
  },
  {
    "function_name": "GetOp",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "391-398",
    "snippet": "bool GetOp(iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>& vchRet)\n    {\n         // Wrapper so it can be called with either iterator or const_iterator\n         const_iterator pc2 = pc;\n         bool fRet = GetOp2(pc2, opcodeRet, &vchRet);\n         pc = begin() + (pc2 - begin());\n         return fRet;\n    }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "begin",
          "args": [],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetOp2",
          "args": [
            "pc2",
            "opcodeRet",
            "&vchRet"
          ],
          "line": 395
        },
        "resolved": true,
        "details": {
          "function_name": "GetOp2",
          "container": "CScript",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "418-469",
          "snippet": "bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n    {\n        opcodeRet = OP_INVALIDOPCODE;\n        if (pvchRet)\n            pvchRet->clear();\n        if (pc >= end())\n            return false;\n\n        // Read instruction\n        if (end() - pc < 1)\n            return false;\n        unsigned int opcode = *pc++;\n\n        // Immediate operand\n        if (opcode <= OP_PUSHDATA4)\n        {\n            unsigned int nSize;\n            if (opcode < OP_PUSHDATA1)\n            {\n                nSize = opcode;\n            }\n            else if (opcode == OP_PUSHDATA1)\n            {\n                if (end() - pc < 1)\n                    return false;\n                nSize = *pc++;\n            }\n            else if (opcode == OP_PUSHDATA2)\n            {\n                if (end() - pc < 2)\n                    return false;\n                nSize = 0;\n                memcpy(&nSize, &pc[0], 2);\n                pc += 2;\n            }\n            else if (opcode == OP_PUSHDATA4)\n            {\n                if (end() - pc < 4)\n                    return false;\n                memcpy(&nSize, &pc[0], 4);\n                pc += 4;\n            }\n            if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                return false;\n            if (pvchRet)\n                pvchRet->assign(pc, pc + nSize);\n            pc += nSize;\n        }\n\n        opcodeRet = (opcodetype)opcode;\n        return true;\n    }",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp2(const_iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>* pvchRet) const\n      {\n          opcodeRet = OP_INVALIDOPCODE;\n          if (pvchRet)\n              pvchRet->clear();\n          if (pc >= end())\n              return false;\n  \n          // Read instruction\n          if (end() - pc < 1)\n              return false;\n          unsigned int opcode = *pc++;\n  \n          // Immediate operand\n          if (opcode <= OP_PUSHDATA4)\n          {\n              unsigned int nSize;\n              if (opcode < OP_PUSHDATA1)\n              {\n                  nSize = opcode;\n              }\n              else if (opcode == OP_PUSHDATA1)\n              {\n                  if (end() - pc < 1)\n                      return false;\n                  nSize = *pc++;\n              }\n              else if (opcode == OP_PUSHDATA2)\n              {\n                  if (end() - pc < 2)\n                      return false;\n                  nSize = 0;\n                  memcpy(&nSize, &pc[0], 2);\n                  pc += 2;\n              }\n              else if (opcode == OP_PUSHDATA4)\n              {\n                  if (end() - pc < 4)\n                      return false;\n                  memcpy(&nSize, &pc[0], 4);\n                  pc += 4;\n              }\n              if (end() - pc < 0 || (unsigned int)(end() - pc) < nSize)\n                  return false;\n              if (pvchRet)\n                  pvchRet->assign(pc, pc + nSize);\n              pc += nSize;\n          }\n  \n          opcodeRet = (opcodetype)opcode;\n          return true;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  bool GetOp(iterator& pc, opcodetype& opcodeRet, std::vector<unsigned char>& vchRet)\n      {\n           // Wrapper so it can be called with either iterator or const_iterator\n           const_iterator pc2 = pc;\n           bool fRet = GetOp2(pc2, opcodeRet, &vchRet);\n           pc = begin() + (pc2 - begin());\n           return fRet;\n      }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "306-306",
    "snippet": "explicit CScript(const std::vector<unsigned char>& b) { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(const std::vector<unsigned char>& b) { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "305-305",
    "snippet": "explicit CScript(const CBigNum& b) { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(const CBigNum& b) { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "304-304",
    "snippet": "explicit CScript(const uint256& b) { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(const uint256& b) { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "303-303",
    "snippet": "explicit CScript(opcodetype b)     { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(opcodetype b)     { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "301-301",
    "snippet": "explicit CScript(unsigned long long b) { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(unsigned long long b) { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "300-300",
    "snippet": "explicit CScript(unsigned long b)      { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(unsigned long b)      { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "299-299",
    "snippet": "explicit CScript(unsigned short b)     { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(unsigned short b)     { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "298-298",
    "snippet": "explicit CScript(unsigned int b)       { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(unsigned int b)       { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "297-297",
    "snippet": "explicit CScript(unsigned char b)      { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(unsigned char b)      { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "296-296",
    "snippet": "explicit CScript(long long b)          { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(long long b)          { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "295-295",
    "snippet": "explicit CScript(long b)               { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(long b)               { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "294-294",
    "snippet": "explicit CScript(int b)                { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(int b)                { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "293-293",
    "snippet": "explicit CScript(short b)              { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(short b)              { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "292-292",
    "snippet": "explicit CScript(signed char b)        { operator<<(b); }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  explicit CScript(signed char b)        { operator<<(b); }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "274-274",
    "snippet": "CScript(const unsigned char* pbegin, const unsigned char* pend) : std::vector<unsigned char>(pbegin, pend) { }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  CScript(const unsigned char* pbegin, const unsigned char* pend) : std::vector<unsigned char>(pbegin, pend) { }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "272-272",
    "snippet": "CScript(const_iterator pbegin, const_iterator pend) : std::vector<unsigned char>(pbegin, pend) { }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  CScript(const_iterator pbegin, const_iterator pend) : std::vector<unsigned char>(pbegin, pend) { }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "271-271",
    "snippet": "CScript(const CScript& b) : std::vector<unsigned char>(b.begin(), b.end()) { }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "b.end",
          "args": [],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "b.begin",
          "args": [],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  CScript(const CScript& b) : std::vector<unsigned char>(b.begin(), b.end()) { }\n}"
  },
  {
    "function_name": "CScript",
    "container": "CScript",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "270-270",
    "snippet": "CScript() { }",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nCScript {\n  CScript() { }\n}"
  },
  {
    "function_name": "StackString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "218-228",
    "snippet": "inline std::string StackString(const std::vector<std::vector<unsigned char> >& vStack)\n{\n    std::string str;\n    BOOST_FOREACH(const std::vector<unsigned char>& vch, vStack)\n    {\n        if (!str.empty())\n            str += \" \";\n        str += ValueString(vch);\n    }\n    return str;\n}",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ValueString",
          "args": [
            "vch"
          ],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "ValueString",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
          "lines": "210-216",
          "snippet": "inline std::string ValueString(const std::vector<unsigned char>& vch)\n{\n    if (vch.size() <= 4)\n        return strprintf(\"%d\", CBigNum(vch).getint());\n    else\n        return HexStr(vch);\n}",
          "includes": [
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include <boost/variant.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\ninline std::string ValueString(const std::vector<unsigned char>& vch)\n{\n    if (vch.size() <= 4)\n        return strprintf(\"%d\", CBigNum(vch).getint());\n    else\n        return HexStr(vch);\n}"
        }
      },
      {
        "call_info": {
          "callee": "str.empty",
          "args": [],
          "line": 223
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\ninline std::string StackString(const std::vector<std::vector<unsigned char> >& vStack)\n{\n    std::string str;\n    BOOST_FOREACH(const std::vector<unsigned char>& vch, vStack)\n    {\n        if (!str.empty())\n            str += \" \";\n        str += ValueString(vch);\n    }\n    return str;\n}"
  },
  {
    "function_name": "ValueString",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.h",
    "lines": "210-216",
    "snippet": "inline std::string ValueString(const std::vector<unsigned char>& vch)\n{\n    if (vch.size() <= 4)\n        return strprintf(\"%d\", CBigNum(vch).getint());\n    else\n        return HexStr(vch);\n}",
    "includes": [
      "#include \"bignum.h\"",
      "#include \"keystore.h\"",
      "#include <boost/variant.hpp>",
      "#include <boost/foreach.hpp>",
      "#include <stdint.h>",
      "#include <vector>",
      "#include <string>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "HexStr",
          "args": [
            "vch"
          ],
          "line": 215
        },
        "resolved": true,
        "details": {
          "function_name": "HexStr",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "341-344",
          "snippet": "inline std::string HexStr(const std::vector<unsigned char>& vch, bool fSpaces=false)\n{\n    return HexStr(vch.begin(), vch.end(), fSpaces);\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline std::string HexStr(const std::vector<unsigned char>& vch, bool fSpaces=false)\n{\n    return HexStr(vch.begin(), vch.end(), fSpaces);\n}"
        }
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%d\"",
            "CBigNum(vch).getint()"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBigNum",
          "args": [],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "isOne",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "538-540",
          "snippet": "bool isOne() const {\n        return BN_is_one(this);\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  bool isOne() const {\n          return BN_is_one(this);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBigNum",
          "args": [
            "vch"
          ],
          "line": 213
        },
        "resolved": true,
        "details": {
          "function_name": "gcd",
          "container": "CBigNum",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bignum.h",
          "lines": "515-521",
          "snippet": "CBigNum gcd( const CBigNum& b) const{\n        CAutoBN_CTX pctx;\n        CBigNum ret;\n        if (!BN_gcd(&ret, this, &b, pctx))\n            throw bignum_error(\"CBigNum::gcd*= :BN_gcd\");\n        return ret;\n    }",
          "includes": [
            "#include <stdint.h>",
            "#include <vector>",
            "#include <stdexcept>",
            "#include <openssl/bn.h>",
            "#include \"version.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <stdint.h>\n#include <vector>\n#include <stdexcept>\n#include <openssl/bn.h>\n#include \"version.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n\nCBigNum {\n  CBigNum gcd( const CBigNum& b) const{\n          CAutoBN_CTX pctx;\n          CBigNum ret;\n          if (!BN_gcd(&ret, this, &b, pctx))\n              throw bignum_error(\"CBigNum::gcd*= :BN_gcd\");\n          return ret;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vch.size",
          "args": [],
          "line": 212
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"bignum.h\"\n#include \"keystore.h\"\n#include <boost/variant.hpp>\n#include <boost/foreach.hpp>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\ninline std::string ValueString(const std::vector<unsigned char>& vch)\n{\n    if (vch.size() <= 4)\n        return strprintf(\"%d\", CBigNum(vch).getint());\n    else\n        return HexStr(vch);\n}"
  }
]