[
  {
    "function_name": "getTxID",
    "container": "TransactionRecord",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
    "lines": "245-248",
    "snippet": "std::string TransactionRecord::getTxID()\n{\n    return hash.ToString() + strprintf(\"-%03d\", idx);\n}",
    "includes": [
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"transactionrecord.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"-%03d\"",
            "idx"
          ],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "real_strprintf",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "331-338",
          "snippet": "string real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nstring real_strprintf(const std::string &format, int dummy, ...)\n{\n    va_list arg_ptr;\n    va_start(arg_ptr, dummy);\n    string str = vstrprintf(format.c_str(), arg_ptr);\n    va_end(arg_ptr);\n    return str;\n}"
        }
      },
      {
        "call_info": {
          "callee": "hash.ToString",
          "args": [],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  std::string TransactionRecord::getTxID()\n  {\n      return hash.ToString() + strprintf(\"-%03d\", idx);\n  }\n}"
  },
  {
    "function_name": "statusUpdateNeeded",
    "container": "TransactionRecord",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
    "lines": "240-243",
    "snippet": "bool TransactionRecord::statusUpdateNeeded()\n{\n    return status.cur_num_blocks != nBestHeight;\n}",
    "includes": [
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"transactionrecord.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  bool TransactionRecord::statusUpdateNeeded()\n  {\n      return status.cur_num_blocks != nBestHeight;\n  }\n}"
  },
  {
    "function_name": "updateStatus",
    "container": "TransactionRecord",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
    "lines": "156-238",
    "snippet": "void TransactionRecord::updateStatus(const CWalletTx &wtx)\n{\n    // Determine transaction status\n\n    // Find the block the tx is in\n    CBlockIndex* pindex = NULL;\n    std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(wtx.hashBlock);\n    if (mi != mapBlockIndex.end())\n        pindex = (*mi).second;\n\n    // Sort order, unrecorded transactions sort to the top\n    status.sortKey = strprintf(\"%010d-%01d-%010u-%03d\",\n        (pindex ? pindex->nHeight : std::numeric_limits<int>::max()),\n        (wtx.IsCoinBase() ? 1 : 0),\n        wtx.nTimeReceived,\n        idx);\n    status.countsForBalance = wtx.IsTrusted() && !(wtx.GetBlocksToMaturity() > 0);\n    status.depth = wtx.GetDepthInMainChain();\n    status.cur_num_blocks = nBestHeight;\n\n    if (!wtx.IsFinal())\n    {\n        if (wtx.nLockTime < LOCKTIME_THRESHOLD)\n        {\n            status.status = TransactionStatus::OpenUntilBlock;\n            status.open_for = nBestHeight - wtx.nLockTime;\n        }\n        else\n        {\n            status.status = TransactionStatus::OpenUntilDate;\n            status.open_for = wtx.nLockTime;\n        }\n    }\n\n    // For generated transactions, determine maturity\n    else if(type == TransactionRecord::Generated)\n    {\n        if (wtx.GetBlocksToMaturity() > 0)\n        {\n            status.status = TransactionStatus::Immature;\n\n            if (wtx.IsInMainChain())\n            {\n                status.matures_in = wtx.GetBlocksToMaturity();\n\n                // Check if the block was requested by anyone\n                if (GetAdjustedTime() - wtx.nTimeReceived > 2 * 60 && wtx.GetRequestCount() == 0)\n                    status.status = TransactionStatus::MaturesWarning;\n            }\n            else\n            {\n                status.status = TransactionStatus::NotAccepted;\n            }\n        }\n        else\n        {\n            status.status = TransactionStatus::Confirmed;\n        }\n    }\n    else\n    {\n        if (status.depth < 0)\n        {\n            status.status = TransactionStatus::Conflicted;\n        }\n        else if (GetAdjustedTime() - wtx.nTimeReceived > 2 * 60 && wtx.GetRequestCount() == 0)\n        {\n            status.status = TransactionStatus::Offline;\n        }\n        else if (status.depth == 0)\n        {\n            status.status = TransactionStatus::Unconfirmed;\n        }\n        else if (status.depth < RecommendedNumConfirmations)\n        {\n            status.status = TransactionStatus::Confirming;\n        }\n        else\n        {\n            status.status = TransactionStatus::Confirmed;\n        }\n    }\n}",
    "includes": [
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"transactionrecord.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wtx.GetRequestCount",
          "args": [],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "GetRequestCount",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.cpp",
          "lines": "639-676",
          "snippet": "int CWalletTx::GetRequestCount() const\n{\n    // Returns -1 if it wasn't being tracked\n    int nRequests = -1;\n    {\n        LOCK(pwallet->cs_wallet);\n        if (IsCoinBase() || IsCoinStake())\n        {\n            // Generated block\n            if (hashBlock != 0)\n            {\n                map<uint256, int>::const_iterator mi = pwallet->mapRequestCount.find(hashBlock);\n                if (mi != pwallet->mapRequestCount.end())\n                    nRequests = (*mi).second;\n            }\n        }\n        else\n        {\n            // Did anyone request this transaction?\n            map<uint256, int>::const_iterator mi = pwallet->mapRequestCount.find(GetHash());\n            if (mi != pwallet->mapRequestCount.end())\n            {\n                nRequests = (*mi).second;\n\n                // How about the block it's in?\n                if (nRequests == 0 && hashBlock != 0)\n                {\n                    map<uint256, int>::const_iterator mi = pwallet->mapRequestCount.find(hashBlock);\n                    if (mi != pwallet->mapRequestCount.end())\n                        nRequests = (*mi).second;\n                    else\n                        nRequests = 1; // If it's in someone else's block it must have got out\n                }\n            }\n        }\n    }\n    return nRequests;\n}",
          "includes": [
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"coincontrol.h\"",
            "#include \"kernel.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"crypter.h\"",
            "#include \"walletdb.h\"",
            "#include \"wallet.h\"",
            "#include \"txdb.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/replace.hpp>\n#include \"coincontrol.h\"\n#include \"kernel.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"crypter.h\"\n#include \"walletdb.h\"\n#include \"wallet.h\"\n#include \"txdb.h\"\n\nCWalletTx {\n  int CWalletTx::GetRequestCount() const\n  {\n      // Returns -1 if it wasn't being tracked\n      int nRequests = -1;\n      {\n          LOCK(pwallet->cs_wallet);\n          if (IsCoinBase() || IsCoinStake())\n          {\n              // Generated block\n              if (hashBlock != 0)\n              {\n                  map<uint256, int>::const_iterator mi = pwallet->mapRequestCount.find(hashBlock);\n                  if (mi != pwallet->mapRequestCount.end())\n                      nRequests = (*mi).second;\n              }\n          }\n          else\n          {\n              // Did anyone request this transaction?\n              map<uint256, int>::const_iterator mi = pwallet->mapRequestCount.find(GetHash());\n              if (mi != pwallet->mapRequestCount.end())\n              {\n                  nRequests = (*mi).second;\n  \n                  // How about the block it's in?\n                  if (nRequests == 0 && hashBlock != 0)\n                  {\n                      map<uint256, int>::const_iterator mi = pwallet->mapRequestCount.find(hashBlock);\n                      if (mi != pwallet->mapRequestCount.end())\n                          nRequests = (*mi).second;\n                      else\n                          nRequests = 1; // If it's in someone else's block it must have got out\n                  }\n              }\n          }\n      }\n      return nRequests;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetAdjustedTime",
          "args": [],
          "line": 221
        },
        "resolved": true,
        "details": {
          "function_name": "GetAdjustedTime",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.cpp",
          "lines": "1201-1214",
          "snippet": "int64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}",
          "includes": [
            "#include <execinfo.h>",
            "# include <sys/prctl.h>",
            "#include \"shlobj.h\"",
            "#include <io.h> /* for _commit */",
            "#include <stdarg.h>",
            "#include <openssl/rand.h>",
            "#include <openssl/crypto.h>",
            "#include <boost/thread.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/program_options/parsers.hpp>",
            "#include <boost/program_options/detail/config_file.hpp>",
            "#include <boost/algorithm/string/join.hpp>",
            "#include \"ui_interface.h\"",
            "#include \"version.h\"",
            "#include \"strlcpy.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "extern int64 nNtpOffset;",
            "int64 nPeersOffset = INT64_MAX;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <execinfo.h>\n# include <sys/prctl.h>\n#include \"shlobj.h\"\n#include <io.h> /* for _commit */\n#include <stdarg.h>\n#include <openssl/rand.h>\n#include <openssl/crypto.h>\n#include <boost/thread.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/program_options/parsers.hpp>\n#include <boost/program_options/detail/config_file.hpp>\n#include <boost/algorithm/string/join.hpp>\n#include \"ui_interface.h\"\n#include \"version.h\"\n#include \"strlcpy.h\"\n#include \"sync.h\"\n#include \"util.h\"\n\nextern int64 nNtpOffset;\nint64 nPeersOffset = INT64_MAX;\n\nint64_t GetAdjustedTime() {\n\n    int64 nTime = GetTime();\n\n     /* If the NTP and system time are within half an hour, follow the former */\n    if(abs64(nNtpOffset) < 30 * 60)\n      return(nTime + nNtpOffset);\n\n     /* If the median peer time and system time are within 1 hour, follow the former */\n    if(abs64(nPeersOffset) < 60 * 60)\n      return(nTime + nPeersOffset);\n\n     return(nTime);\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.GetBlocksToMaturity",
          "args": [],
          "line": 199
        },
        "resolved": true,
        "details": {
          "function_name": "GetBlocksToMaturity",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "817-822",
          "snippet": "int CMerkleTx::GetBlocksToMaturity() const\n{\n    if (!(IsCoinBase() || IsCoinStake()))\n        return 0;\n    return max(0, (nCoinbaseMaturity+10) - GetDepthInMainChain());\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "int nCoinbaseMaturity = 50;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nint nCoinbaseMaturity = 50;\n\nCMerkleTx {\n  int CMerkleTx::GetBlocksToMaturity() const\n  {\n      if (!(IsCoinBase() || IsCoinStake()))\n          return 0;\n      return max(0, (nCoinbaseMaturity+10) - GetDepthInMainChain());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.IsInMainChain",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "IsInMainChain",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1291-1294",
          "snippet": "bool IsInMainChain() const\n    {\n        return (pnext || this == pindexBest);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsInMainChain() const\n      {\n          return (pnext || this == pindexBest);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.IsFinal",
          "args": [],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "IsFinal",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "491-506",
          "snippet": "bool IsFinal(int nBlockHeight=0, int64_t nBlockTime=0) const\n    {\n        // Time based nLockTime implemented in 0.1.6\n        if (nLockTime == 0)\n            return true;\n        if (nBlockHeight == 0)\n            nBlockHeight = nBestHeight;\n        if (nBlockTime == 0)\n            nBlockTime = GetAdjustedTime();\n        if ((int64_t)nLockTime < ((int64_t)nLockTime < LOCKTIME_THRESHOLD ? (int64_t)nBlockHeight : nBlockTime))\n            return true;\n        BOOST_FOREACH(const CTxIn& txin, vin)\n            if (!txin.IsFinal())\n                return false;\n        return true;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsFinal(int nBlockHeight=0, int64_t nBlockTime=0) const\n      {\n          // Time based nLockTime implemented in 0.1.6\n          if (nLockTime == 0)\n              return true;\n          if (nBlockHeight == 0)\n              nBlockHeight = nBestHeight;\n          if (nBlockTime == 0)\n              nBlockTime = GetAdjustedTime();\n          if ((int64_t)nLockTime < ((int64_t)nLockTime < LOCKTIME_THRESHOLD ? (int64_t)nBlockHeight : nBlockTime))\n              return true;\n          BOOST_FOREACH(const CTxIn& txin, vin)\n              if (!txin.IsFinal())\n                  return false;\n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.GetDepthInMainChain",
          "args": [],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "GetDepthInMainChain",
          "container": "CMerkleTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "765-765",
          "snippet": "int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCMerkleTx {\n  int GetDepthInMainChain() const { CBlockIndex *pindexRet; return GetDepthInMainChain(pindexRet); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.IsTrusted",
          "args": [],
          "line": 172
        },
        "resolved": true,
        "details": {
          "function_name": "IsTrusted",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "646-694",
          "snippet": "bool IsTrusted() const\n    {\n        // Quick answer in most cases\n        if (!IsFinal())\n            return false;\n        int nDepth = GetDepthInMainChain();\n        if (nDepth >= 1)\n            return true;\n        if (nDepth < 0)\n            return false;\n        if (fConfChange || !IsFromMe()) // using wtx's cached debit\n            return false;\n\n        // If no confirmations but it's from us, we can still\n        // consider it confirmed if all dependencies are confirmed\n        std::map<uint256, const CMerkleTx*> mapPrev;\n        std::vector<const CMerkleTx*> vWorkQueue;\n        vWorkQueue.reserve(vtxPrev.size()+1);\n        vWorkQueue.push_back(this);\n        for (unsigned int i = 0; i < vWorkQueue.size(); i++)\n        {\n            const CMerkleTx* ptx = vWorkQueue[i];\n\n            if (!ptx->IsFinal())\n                return false;\n            int nPDepth = ptx->GetDepthInMainChain();\n            if (nPDepth >= 1)\n                continue;\n            if (nPDepth < 0)\n                return false;\n            if (!pwallet->IsFromMe(*ptx))\n                return false;\n\n            if (mapPrev.empty())\n            {\n                BOOST_FOREACH(const CMerkleTx& tx, vtxPrev)\n                    mapPrev[tx.GetHash()] = &tx;\n            }\n\n            BOOST_FOREACH(const CTxIn& txin, ptx->vin)\n            {\n                if (!mapPrev.count(txin.prevout.hash))\n                    return false;\n                vWorkQueue.push_back(mapPrev[txin.prevout.hash]);\n            }\n        }\n\n        return true;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  bool IsTrusted() const\n      {\n          // Quick answer in most cases\n          if (!IsFinal())\n              return false;\n          int nDepth = GetDepthInMainChain();\n          if (nDepth >= 1)\n              return true;\n          if (nDepth < 0)\n              return false;\n          if (fConfChange || !IsFromMe()) // using wtx's cached debit\n              return false;\n  \n          // If no confirmations but it's from us, we can still\n          // consider it confirmed if all dependencies are confirmed\n          std::map<uint256, const CMerkleTx*> mapPrev;\n          std::vector<const CMerkleTx*> vWorkQueue;\n          vWorkQueue.reserve(vtxPrev.size()+1);\n          vWorkQueue.push_back(this);\n          for (unsigned int i = 0; i < vWorkQueue.size(); i++)\n          {\n              const CMerkleTx* ptx = vWorkQueue[i];\n  \n              if (!ptx->IsFinal())\n                  return false;\n              int nPDepth = ptx->GetDepthInMainChain();\n              if (nPDepth >= 1)\n                  continue;\n              if (nPDepth < 0)\n                  return false;\n              if (!pwallet->IsFromMe(*ptx))\n                  return false;\n  \n              if (mapPrev.empty())\n              {\n                  BOOST_FOREACH(const CMerkleTx& tx, vtxPrev)\n                      mapPrev[tx.GetHash()] = &tx;\n              }\n  \n              BOOST_FOREACH(const CTxIn& txin, ptx->vin)\n              {\n                  if (!mapPrev.count(txin.prevout.hash))\n                      return false;\n                  vWorkQueue.push_back(mapPrev[txin.prevout.hash]);\n              }\n          }\n  \n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "strprintf",
          "args": [
            "\"%010d-%01d-%010u-%03d\"",
            "(pindex ? pindex->nHeight : std::numeric_limits<int>::max())",
            "(wtx.IsCoinBase() ? 1 : 0)",
            "wtx.nTimeReceived",
            "idx"
          ],
          "line": 167
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wtx.IsCoinBase",
          "args": [],
          "line": 169
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinBase",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "537-540",
          "snippet": "bool IsCoinBase() const\n    {\n        return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinBase() const\n      {\n          return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::numeric_limits<int>::max",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "mapBlockIndex.end",
          "args": [],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapBlockIndex.find",
          "args": [
            "wtx.hashBlock"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "find",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "33-33",
          "snippet": "const_iterator find(const key_type& k) const { return map.find(k); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator find(const key_type& k) const { return map.find(k); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  void TransactionRecord::updateStatus(const CWalletTx &wtx)\n  {\n      // Determine transaction status\n  \n      // Find the block the tx is in\n      CBlockIndex* pindex = NULL;\n      std::map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(wtx.hashBlock);\n      if (mi != mapBlockIndex.end())\n          pindex = (*mi).second;\n  \n      // Sort order, unrecorded transactions sort to the top\n      status.sortKey = strprintf(\"%010d-%01d-%010u-%03d\",\n          (pindex ? pindex->nHeight : std::numeric_limits<int>::max()),\n          (wtx.IsCoinBase() ? 1 : 0),\n          wtx.nTimeReceived,\n          idx);\n      status.countsForBalance = wtx.IsTrusted() && !(wtx.GetBlocksToMaturity() > 0);\n      status.depth = wtx.GetDepthInMainChain();\n      status.cur_num_blocks = nBestHeight;\n  \n      if (!wtx.IsFinal())\n      {\n          if (wtx.nLockTime < LOCKTIME_THRESHOLD)\n          {\n              status.status = TransactionStatus::OpenUntilBlock;\n              status.open_for = nBestHeight - wtx.nLockTime;\n          }\n          else\n          {\n              status.status = TransactionStatus::OpenUntilDate;\n              status.open_for = wtx.nLockTime;\n          }\n      }\n  \n      // For generated transactions, determine maturity\n      else if(type == TransactionRecord::Generated)\n      {\n          if (wtx.GetBlocksToMaturity() > 0)\n          {\n              status.status = TransactionStatus::Immature;\n  \n              if (wtx.IsInMainChain())\n              {\n                  status.matures_in = wtx.GetBlocksToMaturity();\n  \n                  // Check if the block was requested by anyone\n                  if (GetAdjustedTime() - wtx.nTimeReceived > 2 * 60 && wtx.GetRequestCount() == 0)\n                      status.status = TransactionStatus::MaturesWarning;\n              }\n              else\n              {\n                  status.status = TransactionStatus::NotAccepted;\n              }\n          }\n          else\n          {\n              status.status = TransactionStatus::Confirmed;\n          }\n      }\n      else\n      {\n          if (status.depth < 0)\n          {\n              status.status = TransactionStatus::Conflicted;\n          }\n          else if (GetAdjustedTime() - wtx.nTimeReceived > 2 * 60 && wtx.GetRequestCount() == 0)\n          {\n              status.status = TransactionStatus::Offline;\n          }\n          else if (status.depth == 0)\n          {\n              status.status = TransactionStatus::Unconfirmed;\n          }\n          else if (status.depth < RecommendedNumConfirmations)\n          {\n              status.status = TransactionStatus::Confirming;\n          }\n          else\n          {\n              status.status = TransactionStatus::Confirmed;\n          }\n      }\n  }\n}"
  },
  {
    "function_name": "decomposeTransaction",
    "container": "TransactionRecord",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
    "lines": "24-154",
    "snippet": "QList<TransactionRecord> TransactionRecord::decomposeTransaction(const CWallet *wallet, const CWalletTx &wtx)\n{\n    QList<TransactionRecord> parts;\n    int64_t nTime = wtx.GetTxTime();\n    int64_t nCredit = wtx.GetCredit(true);\n    int64_t nDebit = wtx.GetDebit();\n    int64_t nNet = nCredit - nDebit;\n    uint256 hash = wtx.GetHash(), hashPrev = 0;\n    std::map<std::string, std::string> mapValue = wtx.mapValue;\n\n    if (nNet > 0 || wtx.IsCoinBase() || wtx.IsCoinStake())\n    {\n        //\n        // Credit\n        //\n        BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n        {\n            if(wallet->IsMine(txout))\n            {\n                TransactionRecord sub(hash, nTime);\n                CTxDestination address;\n                sub.idx = parts.size(); // sequence number\n                sub.credit = txout.nValue;\n                if (ExtractDestination(txout.scriptPubKey, address) && IsMine(*wallet, address))\n                {\n                    // Received by Bitcoin Address\n                    sub.type = TransactionRecord::RecvWithAddress;\n                    sub.address = CBitcoinAddress(address).ToString();\n                }\n                else\n                {\n                    // Received by IP connection (deprecated features), or a multisignature or other non-simple transaction\n                    sub.type = TransactionRecord::RecvFromOther;\n                    sub.address = mapValue[\"from\"];\n                }\n                if (wtx.IsCoinBase())\n                {\n                    // Generated (proof-of-work)\n                    sub.type = TransactionRecord::Generated;\n                }\n                if (wtx.IsCoinStake())\n                {\n                    // Generated (proof-of-stake)\n\n                    if (hashPrev == hash)\n                        continue; // last coinstake output\n\n                    sub.type = TransactionRecord::Generated;\n                    sub.credit = nNet > 0 ? nNet : wtx.GetValueOut() - nDebit;\n                    hashPrev = hash;\n                }\n\n                parts.append(sub);\n            }\n        }\n    }\n    else\n    {\n        bool fAllFromMe = true;\n        BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n            fAllFromMe = fAllFromMe && wallet->IsMine(txin);\n\n        bool fAllToMe = true;\n        BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n            fAllToMe = fAllToMe && wallet->IsMine(txout);\n\n        if (fAllFromMe && fAllToMe)\n        {\n            // Payment to self\n            int64_t nChange = wtx.GetChange();\n\n            parts.append(TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, \"\",\n                            -(nDebit - nChange), nCredit - nChange));\n        }\n        else if (fAllFromMe)\n        {\n            //\n            // Debit\n            //\n            int64_t nTxFee = nDebit - wtx.GetValueOut();\n\n            for (unsigned int nOut = 0; nOut < wtx.vout.size(); nOut++)\n            {\n                const CTxOut& txout = wtx.vout[nOut];\n                TransactionRecord sub(hash, nTime);\n                sub.idx = parts.size();\n\n                if(wallet->IsMine(txout))\n                {\n                    // Ignore parts sent to self, as this is usually the change\n                    // from a transaction sent back to our own address.\n                    continue;\n                }\n\n                CTxDestination address;\n                if (ExtractDestination(txout.scriptPubKey, address))\n                {\n                    // Sent to Bitcoin Address\n                    sub.type = TransactionRecord::SendToAddress;\n                    sub.address = CBitcoinAddress(address).ToString();\n                }\n                else\n                {\n                    // Sent to IP, or other non-address transaction like OP_EVAL\n                    sub.type = TransactionRecord::SendToOther;\n                    sub.address = mapValue[\"to\"];\n                }\n\n                int64_t nValue = txout.nValue;\n                /* Add fee to first output */\n                if (nTxFee > 0)\n                {\n                    nValue += nTxFee;\n                    nTxFee = 0;\n                }\n                sub.debit = -nValue;\n\n                parts.append(sub);\n            }\n        }\n        else\n        {\n            //\n            // Mixed debit transaction, can't break down payees\n            //\n            parts.append(TransactionRecord(hash, nTime, TransactionRecord::Other, \"\", nNet, 0));\n        }\n    }\n\n    return parts;\n}",
    "includes": [
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"transactionrecord.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "parts.append",
          "args": [
            "TransactionRecord(hash, nTime, TransactionRecord::Other, \"\", nNet, 0)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "TransactionRecord",
          "args": [
            "hash",
            "nTime",
            "TransactionRecord::Other",
            "\"\"",
            "nNet",
            "0"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "TransactionRecord",
          "container": "TransactionRecord",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.h",
          "lines": "88-94",
          "snippet": "TransactionRecord(uint256 hash, int64_t time,\n                Type type, const std::string &address,\n                int64_t debit, int64_t credit):\n            hash(hash), time(time), type(type), address(address), debit(debit), credit(credit),\n            idx(0)\n    {\n    }",
          "includes": [
            "#include <QList>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QList>\n#include \"uint256.h\"\n\nTransactionRecord {\n  TransactionRecord(uint256 hash, int64_t time,\n                  Type type, const std::string &address,\n                  int64_t debit, int64_t credit):\n              hash(hash), time(time), type(type), address(address), debit(debit), credit(credit),\n              idx(0)\n      {\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parts.append",
          "args": [
            "sub"
          ],
          "line": 141
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "IsScript",
          "container": "CBitcoinAddress",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "384-394",
          "snippet": "bool IsScript() const {\n        if (!IsValid())\n            return false;\n        switch (nVersion) {\n        case SCRIPT_ADDRESS:\n        case SCRIPT_ADDRESS_TEST: {\n            return true;\n        }\n        default: return false;\n        }\n    }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddress {\n  bool IsScript() const {\n          if (!IsValid())\n              return false;\n          switch (nVersion) {\n          case SCRIPT_ADDRESS:\n          case SCRIPT_ADDRESS_TEST: {\n              return true;\n          }\n          default: return false;\n          }\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CBitcoinAddress",
          "args": [
            "address"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "operator()",
          "container": "CBitcoinAddressVisitor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/base58.h",
          "lines": "399-399",
          "snippet": "bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }",
          "includes": [
            "#include \"script.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"script.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include <vector>\n#include <string>\n\nCBitcoinAddressVisitor {\n  bool inline CBitcoinAddressVisitor::operator()(const CNoDestination &id) const { return false; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ExtractDestination",
          "args": [
            "txout.scriptPubKey",
            "address"
          ],
          "line": 119
        },
        "resolved": true,
        "details": {
          "function_name": "ExtractDestination",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.cpp",
          "lines": "1590-1614",
          "snippet": "bool ExtractDestination(const CScript& scriptPubKey, CTxDestination& addressRet)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    if (whichType == TX_PUBKEY)\n    {\n        addressRet = CPubKey(vSolutions[0]).GetID();\n        return true;\n    }\n    else if (whichType == TX_PUBKEYHASH)\n    {\n        addressRet = CKeyID(uint160(vSolutions[0]));\n        return true;\n    }\n    else if (whichType == TX_SCRIPTHASH)\n    {\n        addressRet = CScriptID(uint160(vSolutions[0]));\n        return true;\n    }\n    // Multisig txns have more than one address...\n    return false;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"sync.h\"",
            "#include \"main.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include \"script.h\"",
            "#include <boost/tuple/tuple_comparison.hpp>",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/foreach.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"sync.h\"\n#include \"main.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include \"keystore.h\"\n#include \"script.h\"\n#include <boost/tuple/tuple_comparison.hpp>\n#include <boost/tuple/tuple.hpp>\n#include <boost/foreach.hpp>\n\nbool ExtractDestination(const CScript& scriptPubKey, CTxDestination& addressRet)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    if (whichType == TX_PUBKEY)\n    {\n        addressRet = CPubKey(vSolutions[0]).GetID();\n        return true;\n    }\n    else if (whichType == TX_PUBKEYHASH)\n    {\n        addressRet = CKeyID(uint160(vSolutions[0]));\n        return true;\n    }\n    else if (whichType == TX_SCRIPTHASH)\n    {\n        addressRet = CScriptID(uint160(vSolutions[0]));\n        return true;\n    }\n    // Multisig txns have more than one address...\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wallet->IsMine",
          "args": [
            "txout"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "IsMine",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "230-236",
          "snippet": "bool IsMine(const CTransaction& tx) const\n    {\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n            if (IsMine(txout) && txout.nValue >= nMinimumInputValue)\n                return true;\n        return false;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  bool IsMine(const CTransaction& tx) const\n      {\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n              if (IsMine(txout) && txout.nValue >= nMinimumInputValue)\n                  return true;\n          return false;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parts.size",
          "args": [],
          "line": 109
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.GetValueOut",
          "args": [],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "GetValueOut",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "577-587",
          "snippet": "int64_t GetValueOut() const\n    {\n        int64_t nValueOut = 0;\n        BOOST_FOREACH(const CTxOut& txout, vout)\n        {\n            nValueOut += txout.nValue;\n            if (!MoneyRange(txout.nValue) || !MoneyRange(nValueOut))\n                throw std::runtime_error(\"CTransaction::GetValueOut() : value out of range\");\n        }\n        return nValueOut;\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  int64_t GetValueOut() const\n      {\n          int64_t nValueOut = 0;\n          BOOST_FOREACH(const CTxOut& txout, vout)\n          {\n              nValueOut += txout.nValue;\n              if (!MoneyRange(txout.nValue) || !MoneyRange(nValueOut))\n                  throw std::runtime_error(\"CTransaction::GetValueOut() : value out of range\");\n          }\n          return nValueOut;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parts.append",
          "args": [
            "TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, \"\",\n                            -(nDebit - nChange), nCredit - nChange)"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wtx.GetChange",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "GetChange",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "626-633",
          "snippet": "int64_t GetChange() const\n    {\n        if (fChangeCached)\n            return nChangeCached;\n        nChangeCached = pwallet->GetChange(*this);\n        fChangeCached = true;\n        return nChangeCached;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  int64_t GetChange() const\n      {\n          if (fChangeCached)\n              return nChangeCached;\n          nChangeCached = pwallet->GetChange(*this);\n          fChangeCached = true;\n          return nChangeCached;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "parts.append",
          "args": [
            "sub"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "wtx.IsCoinStake",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinStake",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "542-546",
          "snippet": "bool IsCoinStake() const\n    {\n        // ppcoin: the coin stake transaction is marked with the first output empty\n        return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinStake() const\n      {\n          // ppcoin: the coin stake transaction is marked with the first output empty\n          return (vin.size() > 0 && (!vin[0].prevout.IsNull()) && vout.size() >= 2 && vout[0].IsEmpty());\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.IsCoinBase",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinBase",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "537-540",
          "snippet": "bool IsCoinBase() const\n    {\n        return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinBase() const\n      {\n          return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IsMine",
          "args": [
            "*wallet",
            "address"
          ],
          "line": 47
        },
        "resolved": true,
        "details": {
          "function_name": "IsMine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/script.cpp",
          "lines": "1551-1588",
          "snippet": "bool IsMine(const CKeyStore &keystore, const CScript& scriptPubKey)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    CKeyID keyID;\n    switch (whichType)\n    {\n    case TX_NONSTANDARD:\n        return false;\n    case TX_PUBKEY:\n        keyID = CPubKey(vSolutions[0]).GetID();\n        return keystore.HaveKey(keyID);\n    case TX_PUBKEYHASH:\n        keyID = CKeyID(uint160(vSolutions[0]));\n        return keystore.HaveKey(keyID);\n    case TX_SCRIPTHASH:\n    {\n        CScript subscript;\n        if (!keystore.GetCScript(CScriptID(uint160(vSolutions[0])), subscript))\n            return false;\n        return IsMine(keystore, subscript);\n    }\n    case TX_MULTISIG:\n    {\n        // Only consider transactions \"mine\" if we own ALL the\n        // keys involved. multi-signature transactions that are\n        // partially owned (somebody else has a key that can spend\n        // them) enable spend-out-from-under-you attacks, especially\n        // in shared-wallet situations.\n        vector<valtype> keys(vSolutions.begin()+1, vSolutions.begin()+vSolutions.size()-1);\n        return HaveKeys(keys, keystore) == keys.size();\n    }\n    }\n    return false;\n}",
          "includes": [
            "#include \"util.h\"",
            "#include \"sync.h\"",
            "#include \"main.h\"",
            "#include \"key.h\"",
            "#include \"bignum.h\"",
            "#include \"keystore.h\"",
            "#include \"script.h\"",
            "#include <boost/tuple/tuple_comparison.hpp>",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/foreach.hpp>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util.h\"\n#include \"sync.h\"\n#include \"main.h\"\n#include \"key.h\"\n#include \"bignum.h\"\n#include \"keystore.h\"\n#include \"script.h\"\n#include <boost/tuple/tuple_comparison.hpp>\n#include <boost/tuple/tuple.hpp>\n#include <boost/foreach.hpp>\n\nbool IsMine(const CKeyStore &keystore, const CScript& scriptPubKey)\n{\n    vector<valtype> vSolutions;\n    txnouttype whichType;\n    if (!Solver(scriptPubKey, whichType, vSolutions))\n        return false;\n\n    CKeyID keyID;\n    switch (whichType)\n    {\n    case TX_NONSTANDARD:\n        return false;\n    case TX_PUBKEY:\n        keyID = CPubKey(vSolutions[0]).GetID();\n        return keystore.HaveKey(keyID);\n    case TX_PUBKEYHASH:\n        keyID = CKeyID(uint160(vSolutions[0]));\n        return keystore.HaveKey(keyID);\n    case TX_SCRIPTHASH:\n    {\n        CScript subscript;\n        if (!keystore.GetCScript(CScriptID(uint160(vSolutions[0])), subscript))\n            return false;\n        return IsMine(keystore, subscript);\n    }\n    case TX_MULTISIG:\n    {\n        // Only consider transactions \"mine\" if we own ALL the\n        // keys involved. multi-signature transactions that are\n        // partially owned (somebody else has a key that can spend\n        // them) enable spend-out-from-under-you attacks, especially\n        // in shared-wallet situations.\n        vector<valtype> keys(vSolutions.begin()+1, vSolutions.begin()+vSolutions.size()-1);\n        return HaveKeys(keys, keystore) == keys.size();\n    }\n    }\n    return false;\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.GetHash",
          "args": [],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "GetHash",
          "container": "CNetAddr",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "922-928",
          "snippet": "uint64_t CNetAddr::GetHash() const\n{\n    uint256 hash = Hash(&ip[0], &ip[16]);\n    uint64_t nRet;\n    memcpy(&nRet, &hash, sizeof(nRet));\n    return nRet;\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCNetAddr {\n  uint64_t CNetAddr::GetHash() const\n  {\n      uint256 hash = Hash(&ip[0], &ip[16]);\n      uint64_t nRet;\n      memcpy(&nRet, &hash, sizeof(nRet));\n      return nRet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.GetDebit",
          "args": [],
          "line": 29
        },
        "resolved": true,
        "details": {
          "function_name": "GetDebit",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "574-583",
          "snippet": "int64_t GetDebit() const\n    {\n        if (vin.empty())\n            return 0;\n        if (fDebitCached)\n            return nDebitCached;\n        nDebitCached = pwallet->GetDebit(*this);\n        fDebitCached = true;\n        return nDebitCached;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWalletTx {\n  int64_t GetDebit() const\n      {\n          if (vin.empty())\n              return 0;\n          if (fDebitCached)\n              return nDebitCached;\n          nDebitCached = pwallet->GetDebit(*this);\n          fDebitCached = true;\n          return nDebitCached;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.GetCredit",
          "args": [
            "true"
          ],
          "line": 28
        },
        "resolved": true,
        "details": {
          "function_name": "GetCredit",
          "container": "CWallet",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.h",
          "lines": "252-262",
          "snippet": "int64_t GetCredit(const CTransaction& tx) const\n    {\n        int64_t nCredit = 0;\n        BOOST_FOREACH(const CTxOut& txout, tx.vout)\n        {\n            nCredit += GetCredit(txout);\n            if (!MoneyRange(nCredit))\n                throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n        }\n        return nCredit;\n    }",
          "includes": [
            "#include \"walletdb.h\"",
            "#include \"util.h\"",
            "#include \"ui_interface.h\"",
            "#include \"script.h\"",
            "#include \"keystore.h\"",
            "#include \"key.h\"",
            "#include \"main.h\"",
            "#include <stdlib.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"walletdb.h\"\n#include \"util.h\"\n#include \"ui_interface.h\"\n#include \"script.h\"\n#include \"keystore.h\"\n#include \"key.h\"\n#include \"main.h\"\n#include <stdlib.h>\n#include <vector>\n#include <string>\n\nCWallet {\n  int64_t GetCredit(const CTransaction& tx) const\n      {\n          int64_t nCredit = 0;\n          BOOST_FOREACH(const CTxOut& txout, tx.vout)\n          {\n              nCredit += GetCredit(txout);\n              if (!MoneyRange(nCredit))\n                  throw std::runtime_error(\"CWallet::GetCredit() : value out of range\");\n          }\n          return nCredit;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.GetTxTime",
          "args": [],
          "line": 27
        },
        "resolved": true,
        "details": {
          "function_name": "GetTxTime",
          "container": "CWalletTx",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/wallet.cpp",
          "lines": "633-637",
          "snippet": "int64_t CWalletTx::GetTxTime() const\n{\n    int64_t n = nTimeSmart;\n    return n ? n : nTimeReceived;\n}",
          "includes": [
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"coincontrol.h\"",
            "#include \"kernel.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"crypter.h\"",
            "#include \"walletdb.h\"",
            "#include \"wallet.h\"",
            "#include \"txdb.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/replace.hpp>\n#include \"coincontrol.h\"\n#include \"kernel.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"crypter.h\"\n#include \"walletdb.h\"\n#include \"wallet.h\"\n#include \"txdb.h\"\n\nCWalletTx {\n  int64_t CWalletTx::GetTxTime() const\n  {\n      int64_t n = nTimeSmart;\n      return n ? n : nTimeReceived;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  QList<TransactionRecord> TransactionRecord::decomposeTransaction(const CWallet *wallet, const CWalletTx &wtx)\n  {\n      QList<TransactionRecord> parts;\n      int64_t nTime = wtx.GetTxTime();\n      int64_t nCredit = wtx.GetCredit(true);\n      int64_t nDebit = wtx.GetDebit();\n      int64_t nNet = nCredit - nDebit;\n      uint256 hash = wtx.GetHash(), hashPrev = 0;\n      std::map<std::string, std::string> mapValue = wtx.mapValue;\n  \n      if (nNet > 0 || wtx.IsCoinBase() || wtx.IsCoinStake())\n      {\n          //\n          // Credit\n          //\n          BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n          {\n              if(wallet->IsMine(txout))\n              {\n                  TransactionRecord sub(hash, nTime);\n                  CTxDestination address;\n                  sub.idx = parts.size(); // sequence number\n                  sub.credit = txout.nValue;\n                  if (ExtractDestination(txout.scriptPubKey, address) && IsMine(*wallet, address))\n                  {\n                      // Received by Bitcoin Address\n                      sub.type = TransactionRecord::RecvWithAddress;\n                      sub.address = CBitcoinAddress(address).ToString();\n                  }\n                  else\n                  {\n                      // Received by IP connection (deprecated features), or a multisignature or other non-simple transaction\n                      sub.type = TransactionRecord::RecvFromOther;\n                      sub.address = mapValue[\"from\"];\n                  }\n                  if (wtx.IsCoinBase())\n                  {\n                      // Generated (proof-of-work)\n                      sub.type = TransactionRecord::Generated;\n                  }\n                  if (wtx.IsCoinStake())\n                  {\n                      // Generated (proof-of-stake)\n  \n                      if (hashPrev == hash)\n                          continue; // last coinstake output\n  \n                      sub.type = TransactionRecord::Generated;\n                      sub.credit = nNet > 0 ? nNet : wtx.GetValueOut() - nDebit;\n                      hashPrev = hash;\n                  }\n  \n                  parts.append(sub);\n              }\n          }\n      }\n      else\n      {\n          bool fAllFromMe = true;\n          BOOST_FOREACH(const CTxIn& txin, wtx.vin)\n              fAllFromMe = fAllFromMe && wallet->IsMine(txin);\n  \n          bool fAllToMe = true;\n          BOOST_FOREACH(const CTxOut& txout, wtx.vout)\n              fAllToMe = fAllToMe && wallet->IsMine(txout);\n  \n          if (fAllFromMe && fAllToMe)\n          {\n              // Payment to self\n              int64_t nChange = wtx.GetChange();\n  \n              parts.append(TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, \"\",\n                              -(nDebit - nChange), nCredit - nChange));\n          }\n          else if (fAllFromMe)\n          {\n              //\n              // Debit\n              //\n              int64_t nTxFee = nDebit - wtx.GetValueOut();\n  \n              for (unsigned int nOut = 0; nOut < wtx.vout.size(); nOut++)\n              {\n                  const CTxOut& txout = wtx.vout[nOut];\n                  TransactionRecord sub(hash, nTime);\n                  sub.idx = parts.size();\n  \n                  if(wallet->IsMine(txout))\n                  {\n                      // Ignore parts sent to self, as this is usually the change\n                      // from a transaction sent back to our own address.\n                      continue;\n                  }\n  \n                  CTxDestination address;\n                  if (ExtractDestination(txout.scriptPubKey, address))\n                  {\n                      // Sent to Bitcoin Address\n                      sub.type = TransactionRecord::SendToAddress;\n                      sub.address = CBitcoinAddress(address).ToString();\n                  }\n                  else\n                  {\n                      // Sent to IP, or other non-address transaction like OP_EVAL\n                      sub.type = TransactionRecord::SendToOther;\n                      sub.address = mapValue[\"to\"];\n                  }\n  \n                  int64_t nValue = txout.nValue;\n                  /* Add fee to first output */\n                  if (nTxFee > 0)\n                  {\n                      nValue += nTxFee;\n                      nTxFee = 0;\n                  }\n                  sub.debit = -nValue;\n  \n                  parts.append(sub);\n              }\n          }\n          else\n          {\n              //\n              // Mixed debit transaction, can't break down payees\n              //\n              parts.append(TransactionRecord(hash, nTime, TransactionRecord::Other, \"\", nNet, 0));\n          }\n      }\n  \n      return parts;\n  }\n}"
  },
  {
    "function_name": "showTransaction",
    "container": "TransactionRecord",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactionrecord.cpp",
    "lines": "8-19",
    "snippet": "bool TransactionRecord::showTransaction(const CWalletTx &wtx)\n{\n    if (wtx.IsCoinBase())\n    {\n        // Ensures we show generated coins / mined transactions at depth 1\n        if (!wtx.IsInMainChain())\n        {\n            return false;\n        }\n    }\n    return true;\n}",
    "includes": [
      "#include \"base58.h\"",
      "#include \"wallet.h\"",
      "#include \"transactionrecord.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "wtx.IsInMainChain",
          "args": [],
          "line": 13
        },
        "resolved": true,
        "details": {
          "function_name": "IsInMainChain",
          "container": "CBlockIndex",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "1291-1294",
          "snippet": "bool IsInMainChain() const\n    {\n        return (pnext || this == pindexBest);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCBlockIndex {\n  bool IsInMainChain() const\n      {\n          return (pnext || this == pindexBest);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "wtx.IsCoinBase",
          "args": [],
          "line": 10
        },
        "resolved": true,
        "details": {
          "function_name": "IsCoinBase",
          "container": "CTransaction",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.h",
          "lines": "537-540",
          "snippet": "bool IsCoinBase() const\n    {\n        return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n    }",
          "includes": [
            "#include <list>",
            "#include \"x15hash.h\"",
            "#include \"neoscrypt.h\"",
            "#include \"script.h\"",
            "#include \"net.h\"",
            "#include \"sync.h\"",
            "#include \"bignum.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include \"x15hash.h\"\n#include \"neoscrypt.h\"\n#include \"script.h\"\n#include \"net.h\"\n#include \"sync.h\"\n#include \"bignum.h\"\n\nCTransaction {\n  bool IsCoinBase() const\n      {\n          return (vin.size() == 1 && vin[0].prevout.IsNull() && vout.size() >= 1);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"wallet.h\"\n#include \"transactionrecord.h\"\n\nTransactionRecord {\n  bool TransactionRecord::showTransaction(const CWalletTx &wtx)\n  {\n      if (wtx.IsCoinBase())\n      {\n          // Ensures we show generated coins / mined transactions at depth 1\n          if (!wtx.IsInMainChain())\n          {\n              return false;\n          }\n      }\n      return true;\n  }\n}"
  }
]