[
  {
    "function_name": "on_showCLOptionsButton_clicked",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "433-437",
    "snippet": "void RPCConsole::on_showCLOptionsButton_clicked()\n{\n    GUIUtil::HelpMessageBox help;\n    help.exec();\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "help.exec",
          "args": [],
          "line": 436
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::on_showCLOptionsButton_clicked()\n  {\n      GUIUtil::HelpMessageBox help;\n      help.exec();\n  }\n}"
  },
  {
    "function_name": "scrollToEnd",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "427-431",
    "snippet": "void RPCConsole::scrollToEnd()\n{\n    QScrollBar *scrollbar = ui->messagesWidget->verticalScrollBar();\n    scrollbar->setValue(scrollbar->maximum());\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "scrollbar->setValue",
          "args": [
            "scrollbar->maximum()"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "scrollbar->maximum",
          "args": [],
          "line": 430
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messagesWidget->verticalScrollBar",
          "args": [],
          "line": 429
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::scrollToEnd()\n  {\n      QScrollBar *scrollbar = ui->messagesWidget->verticalScrollBar();\n      scrollbar->setValue(scrollbar->maximum());\n  }\n}"
  },
  {
    "function_name": "on_openDebugLogfileButton_clicked",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "422-425",
    "snippet": "void RPCConsole::on_openDebugLogfileButton_clicked()\n{\n    GUIUtil::openDebugLogfile();\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "GUIUtil::openDebugLogfile",
          "args": [],
          "line": 424
        },
        "resolved": true,
        "details": {
          "function_name": "openDebugLogfile",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "240-247",
          "snippet": "void openDebugLogfile()\n{\n    boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n\n    /* Open debug.log with the associated application */\n    if (boost::filesystem::exists(pathDebug))\n        QDesktopServices::openUrl(QUrl::fromLocalFile(QString::fromStdString(pathDebug.string())));\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid openDebugLogfile()\n{\n    boost::filesystem::path pathDebug = GetDataDir() / \"debug.log\";\n\n    /* Open debug.log with the associated application */\n    if (boost::filesystem::exists(pathDebug))\n        QDesktopServices::openUrl(QUrl::fromLocalFile(QString::fromStdString(pathDebug.string())));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::on_openDebugLogfileButton_clicked()\n  {\n      GUIUtil::openDebugLogfile();\n  }\n}"
  },
  {
    "function_name": "on_tabWidget_currentChanged",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "414-420",
    "snippet": "void RPCConsole::on_tabWidget_currentChanged(int index)\n{\n    if(ui->tabWidget->widget(index) == ui->tab_console)\n    {\n        ui->lineEdit->setFocus();\n    }\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->lineEdit->setFocus",
          "args": [],
          "line": 418
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->tabWidget->widget",
          "args": [
            "index"
          ],
          "line": 416
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::on_tabWidget_currentChanged(int index)\n  {\n      if(ui->tabWidget->widget(index) == ui->tab_console)\n      {\n          ui->lineEdit->setFocus();\n      }\n  }\n}"
  },
  {
    "function_name": "startExecutor",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "389-412",
    "snippet": "void RPCConsole::startExecutor()\n{\n    QThread* thread = new QThread;\n    RPCExecutor *executor = new RPCExecutor();\n    executor->moveToThread(thread);\n\n    // Notify executor when thread started (in executor thread)\n    connect(thread, SIGNAL(started()), executor, SLOT(start()));\n    // Replies from executor object must go to this object\n    connect(executor, SIGNAL(reply(int,QString)), this, SLOT(message(int,QString)));\n    // Requests from this object must go to executor\n    connect(this, SIGNAL(cmdRequest(QString)), executor, SLOT(request(QString)));\n    // On stopExecutor signal\n    // - queue executor for deletion (in execution thread)\n    // - quit the Qt event loop in the execution thread\n    connect(this, SIGNAL(stopExecutor()), executor, SLOT(deleteLater()));\n    connect(this, SIGNAL(stopExecutor()), thread, SLOT(quit()));\n    // Queue the thread for deletion (in this thread) when it is finished\n    connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));\n\n    // Default implementation of QThread::run() simply spins up an event loop in the thread,\n    // which is what we want.\n    thread->start();\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "thread->start",
          "args": [],
          "line": 411
        },
        "resolved": true,
        "details": {
          "function_name": "start",
          "container": "RPCExecutor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "51-54",
          "snippet": "void RPCExecutor::start()\n{\n   // Nothing to do\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCExecutor {\n  void RPCExecutor::start()\n  {\n     // Nothing to do\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "thread",
            "SIGNAL(finished())",
            "thread",
            "SLOT(deleteLater())"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "deleteLater()"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deleteLater",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "finished()"
          ],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "finished",
          "args": [],
          "line": 407
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "this",
            "SIGNAL(stopExecutor())",
            "thread",
            "SLOT(quit())"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "quit()"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "quit",
          "args": [],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "stopExecutor()"
          ],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stopExecutor",
          "args": [],
          "line": 405
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "this",
            "SIGNAL(stopExecutor())",
            "executor",
            "SLOT(deleteLater())"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "deleteLater()"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "deleteLater",
          "args": [],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "stopExecutor()"
          ],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "stopExecutor",
          "args": [],
          "line": 404
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "this",
            "SIGNAL(cmdRequest(QString))",
            "executor",
            "SLOT(request(QString))"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "request(QString)"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "request",
          "args": [
            "QString"
          ],
          "line": 400
        },
        "resolved": true,
        "details": {
          "function_name": "request",
          "container": "RPCExecutor",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "140-186",
          "snippet": "void RPCExecutor::request(const QString &command)\n{\n    std::vector<std::string> args;\n    if(!parseCommandLine(args, command.toStdString()))\n    {\n        emit reply(RPCConsole::CMD_ERROR, QString(\"Parse error: unbalanced ' or \\\"\"));\n        return;\n    }\n    if(args.empty())\n        return; // Nothing to do\n    try\n    {\n        std::string strPrint;\n        // Convert argument list to JSON objects in method-dependent way,\n        // and pass it along with the method name to the dispatcher.\n        json_spirit::Value result = tableRPC.execute(\n            args[0],\n            RPCConvertValues(args[0], std::vector<std::string>(args.begin() + 1, args.end())));\n\n        // Format result reply\n        if (result.type() == json_spirit::null_type)\n            strPrint = \"\";\n        else if (result.type() == json_spirit::str_type)\n            strPrint = result.get_str();\n        else\n            strPrint = write_string(result, true);\n\n        emit reply(RPCConsole::CMD_REPLY, QString::fromStdString(strPrint));\n    }\n    catch (json_spirit::Object& objError)\n    {\n        try // Nice formatting for standard-format error\n        {\n            int code = find_value(objError, \"code\").get_int();\n            std::string message = find_value(objError, \"message\").get_str();\n            emit reply(RPCConsole::CMD_ERROR, QString::fromStdString(message) + \" (code \" + QString::number(code) + \")\");\n        }\n        catch(std::runtime_error &) // raised when converting to invalid type, i.e. missing code or message\n        {   // Show raw JSON object\n            emit reply(RPCConsole::CMD_ERROR, QString::fromStdString(write_string(json_spirit::Value(objError), false)));\n        }\n    }\n    catch (std::exception& e)\n    {\n        emit reply(RPCConsole::CMD_ERROR, QString(\"Error: \") + QString::fromStdString(e.what()));\n    }\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCExecutor {\n  void RPCExecutor::request(const QString &command)\n  {\n      std::vector<std::string> args;\n      if(!parseCommandLine(args, command.toStdString()))\n      {\n          emit reply(RPCConsole::CMD_ERROR, QString(\"Parse error: unbalanced ' or \\\"\"));\n          return;\n      }\n      if(args.empty())\n          return; // Nothing to do\n      try\n      {\n          std::string strPrint;\n          // Convert argument list to JSON objects in method-dependent way,\n          // and pass it along with the method name to the dispatcher.\n          json_spirit::Value result = tableRPC.execute(\n              args[0],\n              RPCConvertValues(args[0], std::vector<std::string>(args.begin() + 1, args.end())));\n  \n          // Format result reply\n          if (result.type() == json_spirit::null_type)\n              strPrint = \"\";\n          else if (result.type() == json_spirit::str_type)\n              strPrint = result.get_str();\n          else\n              strPrint = write_string(result, true);\n  \n          emit reply(RPCConsole::CMD_REPLY, QString::fromStdString(strPrint));\n      }\n      catch (json_spirit::Object& objError)\n      {\n          try // Nice formatting for standard-format error\n          {\n              int code = find_value(objError, \"code\").get_int();\n              std::string message = find_value(objError, \"message\").get_str();\n              emit reply(RPCConsole::CMD_ERROR, QString::fromStdString(message) + \" (code \" + QString::number(code) + \")\");\n          }\n          catch(std::runtime_error &) // raised when converting to invalid type, i.e. missing code or message\n          {   // Show raw JSON object\n              emit reply(RPCConsole::CMD_ERROR, QString::fromStdString(write_string(json_spirit::Value(objError), false)));\n          }\n      }\n      catch (std::exception& e)\n      {\n          emit reply(RPCConsole::CMD_ERROR, QString(\"Error: \") + QString::fromStdString(e.what()));\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "cmdRequest(QString)"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "cmdRequest",
          "args": [
            "QString"
          ],
          "line": 400
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "thread",
            "SIGNAL(started())",
            "executor",
            "SLOT(start())"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "start()"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "start",
          "args": [],
          "line": 396
        },
        "resolved": true,
        "details": {
          "function_name": "startExecutor",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "389-412",
          "snippet": "void RPCConsole::startExecutor()\n{\n    QThread* thread = new QThread;\n    RPCExecutor *executor = new RPCExecutor();\n    executor->moveToThread(thread);\n\n    // Notify executor when thread started (in executor thread)\n    connect(thread, SIGNAL(started()), executor, SLOT(start()));\n    // Replies from executor object must go to this object\n    connect(executor, SIGNAL(reply(int,QString)), this, SLOT(message(int,QString)));\n    // Requests from this object must go to executor\n    connect(this, SIGNAL(cmdRequest(QString)), executor, SLOT(request(QString)));\n    // On stopExecutor signal\n    // - queue executor for deletion (in execution thread)\n    // - quit the Qt event loop in the execution thread\n    connect(this, SIGNAL(stopExecutor()), executor, SLOT(deleteLater()));\n    connect(this, SIGNAL(stopExecutor()), thread, SLOT(quit()));\n    // Queue the thread for deletion (in this thread) when it is finished\n    connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));\n\n    // Default implementation of QThread::run() simply spins up an event loop in the thread,\n    // which is what we want.\n    thread->start();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "started()"
          ],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "started",
          "args": [],
          "line": 396
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "executor->moveToThread",
          "args": [
            "thread"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::startExecutor()\n  {\n      QThread* thread = new QThread;\n      RPCExecutor *executor = new RPCExecutor();\n      executor->moveToThread(thread);\n  \n      // Notify executor when thread started (in executor thread)\n      connect(thread, SIGNAL(started()), executor, SLOT(start()));\n      // Replies from executor object must go to this object\n      connect(executor, SIGNAL(reply(int,QString)), this, SLOT(message(int,QString)));\n      // Requests from this object must go to executor\n      connect(this, SIGNAL(cmdRequest(QString)), executor, SLOT(request(QString)));\n      // On stopExecutor signal\n      // - queue executor for deletion (in execution thread)\n      // - quit the Qt event loop in the execution thread\n      connect(this, SIGNAL(stopExecutor()), executor, SLOT(deleteLater()));\n      connect(this, SIGNAL(stopExecutor()), thread, SLOT(quit()));\n      // Queue the thread for deletion (in this thread) when it is finished\n      connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));\n  \n      // Default implementation of QThread::run() simply spins up an event loop in the thread,\n      // which is what we want.\n      thread->start();\n  }\n}"
  },
  {
    "function_name": "browseHistory",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "376-387",
    "snippet": "void RPCConsole::browseHistory(int offset)\n{\n    historyPtr += offset;\n    if(historyPtr < 0)\n        historyPtr = 0;\n    if(historyPtr > history.size())\n        historyPtr = history.size();\n    QString cmd;\n    if(historyPtr < history.size())\n        cmd = history.at(historyPtr);\n    ui->lineEdit->setText(cmd);\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->lineEdit->setText",
          "args": [
            "cmd"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "history.at",
          "args": [
            "historyPtr"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "history.size",
          "args": [],
          "line": 384
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::browseHistory(int offset)\n  {\n      historyPtr += offset;\n      if(historyPtr < 0)\n          historyPtr = 0;\n      if(historyPtr > history.size())\n          historyPtr = history.size();\n      QString cmd;\n      if(historyPtr < history.size())\n          cmd = history.at(historyPtr);\n      ui->lineEdit->setText(cmd);\n  }\n}"
  },
  {
    "function_name": "on_lineEdit_returnPressed",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "353-374",
    "snippet": "void RPCConsole::on_lineEdit_returnPressed()\n{\n    QString cmd = ui->lineEdit->text();\n    ui->lineEdit->clear();\n\n    if(!cmd.isEmpty())\n    {\n        message(CMD_REQUEST, cmd);\n        emit cmdRequest(cmd);\n        // Truncate history from current position\n        history.erase(history.begin() + historyPtr, history.end());\n        // Append command to history\n        history.append(cmd);\n        // Enforce maximum history size\n        while(history.size() > CONSOLE_HISTORY)\n            history.removeFirst();\n        // Set pointer to end of history\n        historyPtr = history.size();\n        // Scroll console view to end\n        scrollToEnd();\n    }\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const int CONSOLE_HISTORY = 50;"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "scrollToEnd",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "scrollToEnd",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "427-431",
          "snippet": "void RPCConsole::scrollToEnd()\n{\n    QScrollBar *scrollbar = ui->messagesWidget->verticalScrollBar();\n    scrollbar->setValue(scrollbar->maximum());\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::scrollToEnd()\n  {\n      QScrollBar *scrollbar = ui->messagesWidget->verticalScrollBar();\n      scrollbar->setValue(scrollbar->maximum());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "history.size",
          "args": [],
          "line": 370
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "history.removeFirst",
          "args": [],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "history.append",
          "args": [
            "cmd"
          ],
          "line": 365
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "history.erase",
          "args": [
            "history.begin() + historyPtr",
            "history.end()"
          ],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "870-888",
          "snippet": "iterator erase(iterator first, iterator last)\n    {\n        if (first == vch.begin() + nReadPos)\n        {\n            // special case for erasing from the front\n            if (last == vch.end())\n            {\n                nReadPos = 0;\n                return vch.erase(vch.begin(), vch.end());\n            }\n            else\n            {\n                nReadPos = (last - vch.begin());\n                return last;\n            }\n        }\n        else\n            return vch.erase(first, last);\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  iterator erase(iterator first, iterator last)\n      {\n          if (first == vch.begin() + nReadPos)\n          {\n              // special case for erasing from the front\n              if (last == vch.end())\n              {\n                  nReadPos = 0;\n                  return vch.erase(vch.begin(), vch.end());\n              }\n              else\n              {\n                  nReadPos = (last - vch.begin());\n                  return last;\n              }\n          }\n          else\n              return vch.erase(first, last);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "history.end",
          "args": [],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "history.begin",
          "args": [],
          "line": 363
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "message",
          "args": [
            "CMD_REQUEST",
            "cmd"
          ],
          "line": 360
        },
        "resolved": true,
        "details": {
          "function_name": "verifymessage",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/rpcwallet.cpp",
          "lines": "401-435",
          "snippet": "Value verifymessage(const Array& params, bool fHelp)\n{\n    if (fHelp || params.size() != 3)\n        throw runtime_error(\n            \"verifymessage <halcyonaddress> <signature> <message>\\n\"\n            \"Verify a signed message\");\n\n    string strAddress  = params[0].get_str();\n    string strSign     = params[1].get_str();\n    string strMessage  = params[2].get_str();\n\n    CBitcoinAddress addr(strAddress);\n    if (!addr.IsValid())\n        throw JSONRPCError(RPC_TYPE_ERROR, \"Invalid address\");\n\n    CKeyID keyID;\n    if (!addr.GetKeyID(keyID))\n        throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n\n    bool fInvalid = false;\n    vector<unsigned char> vchSig = DecodeBase64(strSign.c_str(), &fInvalid);\n\n    if (fInvalid)\n        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Malformed base64 encoding\");\n\n    CDataStream ss(SER_GETHASH, 0);\n    ss << strMessageMagic;\n    ss << strMessage;\n\n    CKey key;\n    if (!key.SetCompactSignature(Hash(ss.begin(), ss.end()), vchSig))\n        return false;\n\n    return (key.GetPubKey().GetID() == keyID);\n}",
          "includes": [
            "#include \"base58.h\"",
            "#include \"ntp.h\"",
            "#include \"util.h\"",
            "#include \"init.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"walletdb.h\"",
            "#include \"wallet.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"ntp.h\"\n#include \"util.h\"\n#include \"init.h\"\n#include \"bitcoinrpc.h\"\n#include \"walletdb.h\"\n#include \"wallet.h\"\n\nValue verifymessage(const Array& params, bool fHelp)\n{\n    if (fHelp || params.size() != 3)\n        throw runtime_error(\n            \"verifymessage <halcyonaddress> <signature> <message>\\n\"\n            \"Verify a signed message\");\n\n    string strAddress  = params[0].get_str();\n    string strSign     = params[1].get_str();\n    string strMessage  = params[2].get_str();\n\n    CBitcoinAddress addr(strAddress);\n    if (!addr.IsValid())\n        throw JSONRPCError(RPC_TYPE_ERROR, \"Invalid address\");\n\n    CKeyID keyID;\n    if (!addr.GetKeyID(keyID))\n        throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to key\");\n\n    bool fInvalid = false;\n    vector<unsigned char> vchSig = DecodeBase64(strSign.c_str(), &fInvalid);\n\n    if (fInvalid)\n        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Malformed base64 encoding\");\n\n    CDataStream ss(SER_GETHASH, 0);\n    ss << strMessageMagic;\n    ss << strMessage;\n\n    CKey key;\n    if (!key.SetCompactSignature(Hash(ss.begin(), ss.end()), vchSig))\n        return false;\n\n    return (key.GetPubKey().GetID() == keyID);\n}"
        }
      },
      {
        "call_info": {
          "callee": "cmd.isEmpty",
          "args": [],
          "line": 358
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lineEdit->clear",
          "args": [],
          "line": 356
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->lineEdit->text",
          "args": [],
          "line": 355
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst int CONSOLE_HISTORY = 50;\n\nRPCConsole {\n  void RPCConsole::on_lineEdit_returnPressed()\n  {\n      QString cmd = ui->lineEdit->text();\n      ui->lineEdit->clear();\n  \n      if(!cmd.isEmpty())\n      {\n          message(CMD_REQUEST, cmd);\n          emit cmdRequest(cmd);\n          // Truncate history from current position\n          history.erase(history.begin() + historyPtr, history.end());\n          // Append command to history\n          history.append(cmd);\n          // Enforce maximum history size\n          while(history.size() > CONSOLE_HISTORY)\n              history.removeFirst();\n          // Set pointer to end of history\n          historyPtr = history.size();\n          // Scroll console view to end\n          scrollToEnd();\n      }\n  }\n}"
  },
  {
    "function_name": "setNumBlocks",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "341-351",
    "snippet": "void RPCConsole::setNumBlocks(int count, int countOfPeers)\n{\n    ui->numberOfBlocks->setText(QString::number(count));\n    ui->totalBlocks->setText(QString::number(countOfPeers));\n    if(clientModel)\n    {\n        // If there is no current number available display N/A instead of 0, which can't ever be true\n        ui->totalBlocks->setText(clientModel->getNumBlocksOfPeers() == 0 ? tr(\"N/A\") : QString::number(clientModel->getNumBlocksOfPeers()));\n        ui->lastBlockTime->setText(clientModel->getLastBlockDate().toString());\n    }\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->lastBlockTime->setText",
          "args": [
            "clientModel->getLastBlockDate().toString()"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "clientModel->getLastBlockDate",
          "args": [],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "getLastBlockDate",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "51-57",
          "snippet": "QDateTime ClientModel::getLastBlockDate() const\n{\n    if (pindexBest)\n        return QDateTime::fromTime_t(pindexBest->GetBlockTime());\n    else\n        return QDateTime::fromTime_t(1393221600); // Genesis block's time\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QDateTime ClientModel::getLastBlockDate() const\n  {\n      if (pindexBest)\n          return QDateTime::fromTime_t(pindexBest->GetBlockTime());\n      else\n          return QDateTime::fromTime_t(1393221600); // Genesis block's time\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "clientModel->getNumBlocksOfPeers()"
          ],
          "line": 348
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clientModel->getNumBlocksOfPeers",
          "args": [],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "getNumBlocksOfPeers",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "109-112",
          "snippet": "int ClientModel::getNumBlocksOfPeers() const\n{\n    return GetNumBlocksOfPeers();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumBlocksOfPeers() const\n  {\n      return GetNumBlocksOfPeers();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"N/A\""
          ],
          "line": 348
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "countOfPeers"
          ],
          "line": 344
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "count"
          ],
          "line": 343
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::setNumBlocks(int count, int countOfPeers)\n  {\n      ui->numberOfBlocks->setText(QString::number(count));\n      ui->totalBlocks->setText(QString::number(countOfPeers));\n      if(clientModel)\n      {\n          // If there is no current number available display N/A instead of 0, which can't ever be true\n          ui->totalBlocks->setText(clientModel->getNumBlocksOfPeers() == 0 ? tr(\"N/A\") : QString::number(clientModel->getNumBlocksOfPeers()));\n          ui->lastBlockTime->setText(clientModel->getLastBlockDate().toString());\n      }\n  }\n}"
  },
  {
    "function_name": "setNumConnections",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "336-339",
    "snippet": "void RPCConsole::setNumConnections(int count)\n{\n    ui->numberOfConnections->setText(QString::number(count));\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->numberOfConnections->setText",
          "args": [
            "QString::number(count)"
          ],
          "line": 338
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "count"
          ],
          "line": 338
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::setNumConnections(int count)\n  {\n      ui->numberOfConnections->setText(QString::number(count));\n  }\n}"
  },
  {
    "function_name": "message",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "320-334",
    "snippet": "void RPCConsole::message(int category, const QString &message, bool html)\n{\n    QTime time = QTime::currentTime();\n    QString timeString = time.toString();\n    QString out;\n    out += \"<table><tr><td class=\\\"time\\\" width=\\\"65\\\">\" + timeString + \"</td>\";\n    out += \"<td class=\\\"icon\\\" width=\\\"32\\\"><img src=\\\"\" + categoryClass(category) + \"\\\"></td>\";\n    out += \"<td class=\\\"message \" + categoryClass(category) + \"\\\" valign=\\\"middle\\\">\";\n    if(html)\n        out += message;\n    else\n        out += GUIUtil::HtmlEscape(message, true);\n    out += \"</td></tr></table>\";\n    ui->messagesWidget->append(out);\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->messagesWidget->append",
          "args": [
            "out"
          ],
          "line": 333
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::HtmlEscape",
          "args": [
            "message",
            "true"
          ],
          "line": 331
        },
        "resolved": true,
        "details": {
          "function_name": "HtmlEscape",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "148-151",
          "snippet": "QString HtmlEscape(const std::string& str, bool fMultiLine)\n{\n    return HtmlEscape(QString::fromStdString(str), fMultiLine);\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nQString HtmlEscape(const std::string& str, bool fMultiLine)\n{\n    return HtmlEscape(QString::fromStdString(str), fMultiLine);\n}"
        }
      },
      {
        "call_info": {
          "callee": "categoryClass",
          "args": [
            "category"
          ],
          "line": 327
        },
        "resolved": true,
        "details": {
          "function_name": "categoryClass",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "278-287",
          "snippet": "static QString categoryClass(int category)\n{\n    switch(category)\n    {\n    case RPCConsole::CMD_REQUEST:  return \"cmd-request\"; break;\n    case RPCConsole::CMD_REPLY:    return \"cmd-reply\"; break;\n    case RPCConsole::CMD_ERROR:    return \"cmd-error\"; break;\n    default:                       return \"misc\";\n    }\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nstatic QString categoryClass(int category)\n{\n    switch(category)\n    {\n    case RPCConsole::CMD_REQUEST:  return \"cmd-request\"; break;\n    case RPCConsole::CMD_REPLY:    return \"cmd-reply\"; break;\n    case RPCConsole::CMD_ERROR:    return \"cmd-error\"; break;\n    default:                       return \"misc\";\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "time.toString",
          "args": [],
          "line": 323
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QTime::currentTime",
          "args": [],
          "line": 322
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::message(int category, const QString &message, bool html)\n  {\n      QTime time = QTime::currentTime();\n      QString timeString = time.toString();\n      QString out;\n      out += \"<table><tr><td class=\\\"time\\\" width=\\\"65\\\">\" + timeString + \"</td>\";\n      out += \"<td class=\\\"icon\\\" width=\\\"32\\\"><img src=\\\"\" + categoryClass(category) + \"\\\"></td>\";\n      out += \"<td class=\\\"message \" + categoryClass(category) + \"\\\" valign=\\\"middle\\\">\";\n      if(html)\n          out += message;\n      else\n          out += GUIUtil::HtmlEscape(message, true);\n      out += \"</td></tr></table>\";\n      ui->messagesWidget->append(out);\n  }\n}"
  },
  {
    "function_name": "clear",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "289-318",
    "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [
      "const QSize ICON_SIZE(24, 24);",
      "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
    ],
    "called_functions": [
      {
        "call_info": {
          "callee": "message",
          "args": [
            "CMD_REPLY",
            "(tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\"))",
            "true"
          ],
          "line": 315
        },
        "resolved": true,
        "details": {
          "function_name": "message",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "320-334",
          "snippet": "void RPCConsole::message(int category, const QString &message, bool html)\n{\n    QTime time = QTime::currentTime();\n    QString timeString = time.toString();\n    QString out;\n    out += \"<table><tr><td class=\\\"time\\\" width=\\\"65\\\">\" + timeString + \"</td>\";\n    out += \"<td class=\\\"icon\\\" width=\\\"32\\\"><img src=\\\"\" + categoryClass(category) + \"\\\"></td>\";\n    out += \"<td class=\\\"message \" + categoryClass(category) + \"\\\" valign=\\\"middle\\\">\";\n    if(html)\n        out += message;\n    else\n        out += GUIUtil::HtmlEscape(message, true);\n    out += \"</td></tr></table>\";\n    ui->messagesWidget->append(out);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::message(int category, const QString &message, bool html)\n  {\n      QTime time = QTime::currentTime();\n      QString timeString = time.toString();\n      QString out;\n      out += \"<table><tr><td class=\\\"time\\\" width=\\\"65\\\">\" + timeString + \"</td>\";\n      out += \"<td class=\\\"icon\\\" width=\\\"32\\\"><img src=\\\"\" + categoryClass(category) + \"\\\"></td>\";\n      out += \"<td class=\\\"message \" + categoryClass(category) + \"\\\" valign=\\\"middle\\\">\";\n      if(html)\n          out += message;\n      else\n          out += GUIUtil::HtmlEscape(message, true);\n      out += \"</td></tr></table>\";\n      ui->messagesWidget->append(out);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Type <b>help</b> for an overview of available commands.\""
          ],
          "line": 317
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->messagesWidget->document",
          "args": [
            "\"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \""
          ],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messagesWidget->document",
          "args": [],
          "line": 306
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messagesWidget->document",
          "args": [
            "QTextDocument::ImageResource",
            "QUrl(ICON_MAPPING[i].url)",
            "QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation)"
          ],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QImage",
          "args": [
            "ICON_SIZE",
            "Qt::IgnoreAspectRatio",
            "Qt::SmoothTransformation"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QImage",
          "args": [
            "ICON_MAPPING[i].source"
          ],
          "line": 302
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QUrl",
          "args": [
            "ICON_MAPPING[i].url"
          ],
          "line": 301
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->messagesWidget->document",
          "args": [],
          "line": 299
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lineEdit->setFocus",
          "args": [],
          "line": 293
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->lineEdit->clear",
          "args": [],
          "line": 292
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
  },
  {
    "function_name": "categoryClass",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "278-287",
    "snippet": "static QString categoryClass(int category)\n{\n    switch(category)\n    {\n    case RPCConsole::CMD_REQUEST:  return \"cmd-request\"; break;\n    case RPCConsole::CMD_REPLY:    return \"cmd-reply\"; break;\n    case RPCConsole::CMD_ERROR:    return \"cmd-error\"; break;\n    default:                       return \"misc\";\n    }\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nstatic QString categoryClass(int category)\n{\n    switch(category)\n    {\n    case RPCConsole::CMD_REQUEST:  return \"cmd-request\"; break;\n    case RPCConsole::CMD_REPLY:    return \"cmd-reply\"; break;\n    case RPCConsole::CMD_ERROR:    return \"cmd-error\"; break;\n    default:                       return \"misc\";\n    }\n}"
  },
  {
    "function_name": "setClientModel",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "256-276",
    "snippet": "void RPCConsole::setClientModel(ClientModel *model)\n{\n    this->clientModel = model;\n    if(model)\n    {\n        // Subscribe to information, replies, messages, errors\n        connect(model, SIGNAL(numConnectionsChanged(int)), this, SLOT(setNumConnections(int)));\n        connect(model, SIGNAL(numBlocksChanged(int,int)), this, SLOT(setNumBlocks(int,int)));\n\n        // Provide initial values\n        ui->clientVersion->setText(model->formatFullVersion());\n        ui->clientName->setText(model->clientName());\n        ui->buildDate->setText(model->formatBuildDate());\n        ui->startupTime->setText(model->formatClientStartupTime());\n\n        setNumConnections(model->getNumConnections());\n        ui->isTestNet->setChecked(model->isTestNet());\n\n        setNumBlocks(model->getNumBlocks(), model->getNumBlocksOfPeers());\n    }\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "setNumBlocks",
          "args": [
            "model->getNumBlocks()",
            "model->getNumBlocksOfPeers()"
          ],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "setNumBlocks",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "341-351",
          "snippet": "void RPCConsole::setNumBlocks(int count, int countOfPeers)\n{\n    ui->numberOfBlocks->setText(QString::number(count));\n    ui->totalBlocks->setText(QString::number(countOfPeers));\n    if(clientModel)\n    {\n        // If there is no current number available display N/A instead of 0, which can't ever be true\n        ui->totalBlocks->setText(clientModel->getNumBlocksOfPeers() == 0 ? tr(\"N/A\") : QString::number(clientModel->getNumBlocksOfPeers()));\n        ui->lastBlockTime->setText(clientModel->getLastBlockDate().toString());\n    }\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::setNumBlocks(int count, int countOfPeers)\n  {\n      ui->numberOfBlocks->setText(QString::number(count));\n      ui->totalBlocks->setText(QString::number(countOfPeers));\n      if(clientModel)\n      {\n          // If there is no current number available display N/A instead of 0, which can't ever be true\n          ui->totalBlocks->setText(clientModel->getNumBlocksOfPeers() == 0 ? tr(\"N/A\") : QString::number(clientModel->getNumBlocksOfPeers()));\n          ui->lastBlockTime->setText(clientModel->getLastBlockDate().toString());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getNumBlocksOfPeers",
          "args": [],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "getNumBlocksOfPeers",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "109-112",
          "snippet": "int ClientModel::getNumBlocksOfPeers() const\n{\n    return GetNumBlocksOfPeers();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumBlocksOfPeers() const\n  {\n      return GetNumBlocksOfPeers();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getNumBlocks",
          "args": [],
          "line": 274
        },
        "resolved": true,
        "details": {
          "function_name": "getNumBlocks",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "40-43",
          "snippet": "int ClientModel::getNumBlocks() const\n{\n    return nBestHeight;\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumBlocks() const\n  {\n      return nBestHeight;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->isTestNet->setChecked",
          "args": [
            "model->isTestNet()"
          ],
          "line": 272
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->isTestNet",
          "args": [],
          "line": 272
        },
        "resolved": true,
        "details": {
          "function_name": "isTestNet",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "99-102",
          "snippet": "bool ClientModel::isTestNet() const\n{\n    return fTestNet;\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  bool ClientModel::isTestNet() const\n  {\n      return fTestNet;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "setNumConnections",
          "args": [
            "model->getNumConnections()"
          ],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "setNumConnections",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "336-339",
          "snippet": "void RPCConsole::setNumConnections(int count)\n{\n    ui->numberOfConnections->setText(QString::number(count));\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::setNumConnections(int count)\n  {\n      ui->numberOfConnections->setText(QString::number(count));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->getNumConnections",
          "args": [],
          "line": 271
        },
        "resolved": true,
        "details": {
          "function_name": "getNumConnections",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "35-38",
          "snippet": "int ClientModel::getNumConnections() const\n{\n    return vNodes.size();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  int ClientModel::getNumConnections() const\n  {\n      return vNodes.size();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->startupTime->setText",
          "args": [
            "model->formatClientStartupTime()"
          ],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->formatClientStartupTime",
          "args": [],
          "line": 269
        },
        "resolved": true,
        "details": {
          "function_name": "formatClientStartupTime",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "139-142",
          "snippet": "QString ClientModel::formatClientStartupTime() const\n{\n    return QDateTime::fromTime_t(nClientStartupTime).toString();\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "static const int64_t nClientStartupTime = GetTime();"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nstatic const int64_t nClientStartupTime = GetTime();\n\nClientModel {\n  QString ClientModel::formatClientStartupTime() const\n  {\n      return QDateTime::fromTime_t(nClientStartupTime).toString();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->formatBuildDate",
          "args": [],
          "line": 268
        },
        "resolved": true,
        "details": {
          "function_name": "formatBuildDate",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "129-132",
          "snippet": "QString ClientModel::formatBuildDate() const\n{\n    return QString::fromStdString(CLIENT_DATE);\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QString ClientModel::formatBuildDate() const\n  {\n      return QString::fromStdString(CLIENT_DATE);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->clientName",
          "args": [],
          "line": 267
        },
        "resolved": true,
        "details": {
          "function_name": "clientName",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "134-137",
          "snippet": "QString ClientModel::clientName() const\n{\n    return QString::fromStdString(CLIENT_NAME);\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QString ClientModel::clientName() const\n  {\n      return QString::fromStdString(CLIENT_NAME);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "model->formatFullVersion",
          "args": [],
          "line": 266
        },
        "resolved": true,
        "details": {
          "function_name": "formatFullVersion",
          "container": "ClientModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/clientmodel.cpp",
          "lines": "124-127",
          "snippet": "QString ClientModel::formatFullVersion() const\n{\n    return QString::fromStdString(FormatFullVersion());\n}",
          "includes": [
            "#include <QTimer>",
            "#include <QDateTime>",
            "#include \"ui_interface.h\"",
            "#include \"main.h\"",
            "#include \"alert.h\"",
            "#include \"transactiontablemodel.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"guiconstants.h\"",
            "#include \"clientmodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QTimer>\n#include <QDateTime>\n#include \"ui_interface.h\"\n#include \"main.h\"\n#include \"alert.h\"\n#include \"transactiontablemodel.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"guiconstants.h\"\n#include \"clientmodel.h\"\n\nClientModel {\n  QString ClientModel::formatFullVersion() const\n  {\n      return QString::fromStdString(FormatFullVersion());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::setClientModel(ClientModel *model)\n  {\n      this->clientModel = model;\n      if(model)\n      {\n          // Subscribe to information, replies, messages, errors\n          connect(model, SIGNAL(numConnectionsChanged(int)), this, SLOT(setNumConnections(int)));\n          connect(model, SIGNAL(numBlocksChanged(int,int)), this, SLOT(setNumBlocks(int,int)));\n  \n          // Provide initial values\n          ui->clientVersion->setText(model->formatFullVersion());\n          ui->clientName->setText(model->clientName());\n          ui->buildDate->setText(model->formatBuildDate());\n          ui->startupTime->setText(model->formatClientStartupTime());\n  \n          setNumConnections(model->getNumConnections());\n          ui->isTestNet->setChecked(model->isTestNet());\n  \n          setNumBlocks(model->getNumBlocks(), model->getNumBlocksOfPeers());\n      }\n  }\n}"
  },
  {
    "function_name": "eventFilter",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "220-254",
    "snippet": "bool RPCConsole::eventFilter(QObject* obj, QEvent *event)\n{\n    if(event->type() == QEvent::KeyPress) // Special key handling\n    {\n        QKeyEvent *keyevt = static_cast<QKeyEvent*>(event);\n        int key = keyevt->key();\n        Qt::KeyboardModifiers mod = keyevt->modifiers();\n        switch(key)\n        {\n        case Qt::Key_Up: if(obj == ui->lineEdit) { browseHistory(-1); return true; } break;\n        case Qt::Key_Down: if(obj == ui->lineEdit) { browseHistory(1); return true; } break;\n        case Qt::Key_PageUp: /* pass paging keys to messages widget */\n        case Qt::Key_PageDown:\n            if(obj == ui->lineEdit)\n            {\n                QApplication::postEvent(ui->messagesWidget, new QKeyEvent(*keyevt));\n                return true;\n            }\n            break;\n        default:\n            // Typing in messages widget brings focus to line edit, and redirects key there\n            // Exclude most combinations and keys that emit no text, except paste shortcuts\n            if(obj == ui->messagesWidget && (\n                  (!mod && !keyevt->text().isEmpty() && key != Qt::Key_Tab) ||\n                  ((mod & Qt::ControlModifier) && key == Qt::Key_V) ||\n                  ((mod & Qt::ShiftModifier) && key == Qt::Key_Insert)))\n            {\n                ui->lineEdit->setFocus();\n                QApplication::postEvent(ui->lineEdit, new QKeyEvent(*keyevt));\n                return true;\n            }\n        }\n    }\n    return QDialog::eventFilter(obj, event);\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDialog::eventFilter",
          "args": [
            "obj",
            "event"
          ],
          "line": 253
        },
        "resolved": true,
        "details": {
          "function_name": "eventFilter",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "220-254",
          "snippet": "bool RPCConsole::eventFilter(QObject* obj, QEvent *event)\n{\n    if(event->type() == QEvent::KeyPress) // Special key handling\n    {\n        QKeyEvent *keyevt = static_cast<QKeyEvent*>(event);\n        int key = keyevt->key();\n        Qt::KeyboardModifiers mod = keyevt->modifiers();\n        switch(key)\n        {\n        case Qt::Key_Up: if(obj == ui->lineEdit) { browseHistory(-1); return true; } break;\n        case Qt::Key_Down: if(obj == ui->lineEdit) { browseHistory(1); return true; } break;\n        case Qt::Key_PageUp: /* pass paging keys to messages widget */\n        case Qt::Key_PageDown:\n            if(obj == ui->lineEdit)\n            {\n                QApplication::postEvent(ui->messagesWidget, new QKeyEvent(*keyevt));\n                return true;\n            }\n            break;\n        default:\n            // Typing in messages widget brings focus to line edit, and redirects key there\n            // Exclude most combinations and keys that emit no text, except paste shortcuts\n            if(obj == ui->messagesWidget && (\n                  (!mod && !keyevt->text().isEmpty() && key != Qt::Key_Tab) ||\n                  ((mod & Qt::ControlModifier) && key == Qt::Key_V) ||\n                  ((mod & Qt::ShiftModifier) && key == Qt::Key_Insert)))\n            {\n                ui->lineEdit->setFocus();\n                QApplication::postEvent(ui->lineEdit, new QKeyEvent(*keyevt));\n                return true;\n            }\n        }\n    }\n    return QDialog::eventFilter(obj, event);\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::postEvent",
          "args": [
            "ui->lineEdit",
            "new QKeyEvent(*keyevt)"
          ],
          "line": 248
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lineEdit->setFocus",
          "args": [],
          "line": 247
        },
        "resolved": true,
        "details": {
          "function_name": "setFocus",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "162-165",
          "snippet": "void SendCoinsEntry::setFocus()\n{\n    ui->payTo->setFocus();\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setFocus()\n  {\n      ui->payTo->setFocus();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keyevt->text",
          "args": [],
          "line": 243
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QApplication::postEvent",
          "args": [
            "ui->messagesWidget",
            "new QKeyEvent(*keyevt)"
          ],
          "line": 235
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "browseHistory",
          "args": [
            "1"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "browseHistory",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "376-387",
          "snippet": "void RPCConsole::browseHistory(int offset)\n{\n    historyPtr += offset;\n    if(historyPtr < 0)\n        historyPtr = 0;\n    if(historyPtr > history.size())\n        historyPtr = history.size();\n    QString cmd;\n    if(historyPtr < history.size())\n        cmd = history.at(historyPtr);\n    ui->lineEdit->setText(cmd);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::browseHistory(int offset)\n  {\n      historyPtr += offset;\n      if(historyPtr < 0)\n          historyPtr = 0;\n      if(historyPtr > history.size())\n          historyPtr = history.size();\n      QString cmd;\n      if(historyPtr < history.size())\n          cmd = history.at(historyPtr);\n      ui->lineEdit->setText(cmd);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "keyevt->modifiers",
          "args": [],
          "line": 226
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "keyevt->key",
          "args": [],
          "line": 225
        },
        "resolved": true,
        "details": {
          "function_name": "key",
          "container": "LRUHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "37-45",
          "snippet": "Slice key() const {\n    // For cheaper lookups, we allow a temporary Handle object\n    // to store a pointer to a key in \"value\".\n    if (next == this) {\n      return *(reinterpret_cast<Slice*>(value));\n    } else {\n      return Slice(key_data, key_length);\n    }\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nLRUHandle {\n  Slice key() const {\n      // For cheaper lookups, we allow a temporary Handle object\n      // to store a pointer to a key in \"value\".\n      if (next == this) {\n        return *(reinterpret_cast<Slice*>(value));\n      } else {\n        return Slice(key_data, key_length);\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<QKeyEvent*>",
          "args": [
            "event"
          ],
          "line": 224
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "event->type",
          "args": [],
          "line": 222
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  bool RPCConsole::eventFilter(QObject* obj, QEvent *event)\n  {\n      if(event->type() == QEvent::KeyPress) // Special key handling\n      {\n          QKeyEvent *keyevt = static_cast<QKeyEvent*>(event);\n          int key = keyevt->key();\n          Qt::KeyboardModifiers mod = keyevt->modifiers();\n          switch(key)\n          {\n          case Qt::Key_Up: if(obj == ui->lineEdit) { browseHistory(-1); return true; } break;\n          case Qt::Key_Down: if(obj == ui->lineEdit) { browseHistory(1); return true; } break;\n          case Qt::Key_PageUp: /* pass paging keys to messages widget */\n          case Qt::Key_PageDown:\n              if(obj == ui->lineEdit)\n              {\n                  QApplication::postEvent(ui->messagesWidget, new QKeyEvent(*keyevt));\n                  return true;\n              }\n              break;\n          default:\n              // Typing in messages widget brings focus to line edit, and redirects key there\n              // Exclude most combinations and keys that emit no text, except paste shortcuts\n              if(obj == ui->messagesWidget && (\n                    (!mod && !keyevt->text().isEmpty() && key != Qt::Key_Tab) ||\n                    ((mod & Qt::ControlModifier) && key == Qt::Key_V) ||\n                    ((mod & Qt::ShiftModifier) && key == Qt::Key_Insert)))\n              {\n                  ui->lineEdit->setFocus();\n                  QApplication::postEvent(ui->lineEdit, new QKeyEvent(*keyevt));\n                  return true;\n              }\n          }\n      }\n      return QDialog::eventFilter(obj, event);\n  }\n}"
  },
  {
    "function_name": "~RPCConsole",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "214-218",
    "snippet": "RPCConsole::~RPCConsole()\n{\n    emit stopExecutor();\n    delete ui;\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  RPCConsole::~RPCConsole()\n  {\n      emit stopExecutor();\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "RPCConsole",
    "container": "RPCConsole",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "188-212",
    "snippet": "RPCConsole::RPCConsole(QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::RPCConsole),\n    historyPtr(0)\n{\n    ui->setupUi(this);\n\n#ifndef Q_OS_MAC\n    ui->openDebugLogfileButton->setIcon(QIcon(\":/icons/export\"));\n    ui->showCLOptionsButton->setIcon(QIcon(\":/icons/options\"));\n#endif\n\n    // Install event filter for up and down arrow\n    ui->lineEdit->installEventFilter(this);\n    ui->messagesWidget->installEventFilter(this);\n\n    connect(ui->clearButton, SIGNAL(clicked()), this, SLOT(clear()));\n\n    // set OpenSSL version label\n    ui->openSSLVersion->setText(SSLeay_version(SSLEAY_VERSION));\n\n    startExecutor();\n\n    clear();\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "clear",
          "args": [],
          "line": 211
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "startExecutor",
          "args": [],
          "line": 209
        },
        "resolved": true,
        "details": {
          "function_name": "startExecutor",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "389-412",
          "snippet": "void RPCConsole::startExecutor()\n{\n    QThread* thread = new QThread;\n    RPCExecutor *executor = new RPCExecutor();\n    executor->moveToThread(thread);\n\n    // Notify executor when thread started (in executor thread)\n    connect(thread, SIGNAL(started()), executor, SLOT(start()));\n    // Replies from executor object must go to this object\n    connect(executor, SIGNAL(reply(int,QString)), this, SLOT(message(int,QString)));\n    // Requests from this object must go to executor\n    connect(this, SIGNAL(cmdRequest(QString)), executor, SLOT(request(QString)));\n    // On stopExecutor signal\n    // - queue executor for deletion (in execution thread)\n    // - quit the Qt event loop in the execution thread\n    connect(this, SIGNAL(stopExecutor()), executor, SLOT(deleteLater()));\n    connect(this, SIGNAL(stopExecutor()), thread, SLOT(quit()));\n    // Queue the thread for deletion (in this thread) when it is finished\n    connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));\n\n    // Default implementation of QThread::run() simply spins up an event loop in the thread,\n    // which is what we want.\n    thread->start();\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::startExecutor()\n  {\n      QThread* thread = new QThread;\n      RPCExecutor *executor = new RPCExecutor();\n      executor->moveToThread(thread);\n  \n      // Notify executor when thread started (in executor thread)\n      connect(thread, SIGNAL(started()), executor, SLOT(start()));\n      // Replies from executor object must go to this object\n      connect(executor, SIGNAL(reply(int,QString)), this, SLOT(message(int,QString)));\n      // Requests from this object must go to executor\n      connect(this, SIGNAL(cmdRequest(QString)), executor, SLOT(request(QString)));\n      // On stopExecutor signal\n      // - queue executor for deletion (in execution thread)\n      // - quit the Qt event loop in the execution thread\n      connect(this, SIGNAL(stopExecutor()), executor, SLOT(deleteLater()));\n      connect(this, SIGNAL(stopExecutor()), thread, SLOT(quit()));\n      // Queue the thread for deletion (in this thread) when it is finished\n      connect(thread, SIGNAL(finished()), thread, SLOT(deleteLater()));\n  \n      // Default implementation of QThread::run() simply spins up an event loop in the thread,\n      // which is what we want.\n      thread->start();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->openSSLVersion->setText",
          "args": [
            "SSLeay_version(SSLEAY_VERSION)"
          ],
          "line": 207
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SSLeay_version",
          "args": [
            "SSLEAY_VERSION"
          ],
          "line": 207
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "connect",
          "args": [
            "ui->clearButton",
            "SIGNAL(clicked())",
            "this",
            "SLOT(clear())"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SLOT",
          "args": [
            "clear()"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "SIGNAL",
          "args": [
            "clicked()"
          ],
          "line": 204
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "clicked",
          "args": [],
          "line": 204
        },
        "resolved": true,
        "details": {
          "function_name": "on_showCLOptionsButton_clicked",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "433-437",
          "snippet": "void RPCConsole::on_showCLOptionsButton_clicked()\n{\n    GUIUtil::HelpMessageBox help;\n    help.exec();\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  void RPCConsole::on_showCLOptionsButton_clicked()\n  {\n      GUIUtil::HelpMessageBox help;\n      help.exec();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->messagesWidget->installEventFilter",
          "args": [
            "this"
          ],
          "line": 202
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->lineEdit->installEventFilter",
          "args": [
            "this"
          ],
          "line": 201
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->showCLOptionsButton->setIcon",
          "args": [
            "QIcon(\":/icons/options\")"
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/options\""
          ],
          "line": 197
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->openDebugLogfileButton->setIcon",
          "args": [
            "QIcon(\":/icons/export\")"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QIcon",
          "args": [
            "\":/icons/export\""
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 193
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCConsole {\n  RPCConsole::RPCConsole(QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::RPCConsole),\n      historyPtr(0)\n  {\n      ui->setupUi(this);\n  \n  #ifndef Q_OS_MAC\n      ui->openDebugLogfileButton->setIcon(QIcon(\":/icons/export\"));\n      ui->showCLOptionsButton->setIcon(QIcon(\":/icons/options\"));\n  #endif\n  \n      // Install event filter for up and down arrow\n      ui->lineEdit->installEventFilter(this);\n      ui->messagesWidget->installEventFilter(this);\n  \n      connect(ui->clearButton, SIGNAL(clicked()), this, SLOT(clear()));\n  \n      // set OpenSSL version label\n      ui->openSSLVersion->setText(SSLeay_version(SSLEAY_VERSION));\n  \n      startExecutor();\n  \n      clear();\n  }\n}"
  },
  {
    "function_name": "request",
    "container": "RPCExecutor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "140-186",
    "snippet": "void RPCExecutor::request(const QString &command)\n{\n    std::vector<std::string> args;\n    if(!parseCommandLine(args, command.toStdString()))\n    {\n        emit reply(RPCConsole::CMD_ERROR, QString(\"Parse error: unbalanced ' or \\\"\"));\n        return;\n    }\n    if(args.empty())\n        return; // Nothing to do\n    try\n    {\n        std::string strPrint;\n        // Convert argument list to JSON objects in method-dependent way,\n        // and pass it along with the method name to the dispatcher.\n        json_spirit::Value result = tableRPC.execute(\n            args[0],\n            RPCConvertValues(args[0], std::vector<std::string>(args.begin() + 1, args.end())));\n\n        // Format result reply\n        if (result.type() == json_spirit::null_type)\n            strPrint = \"\";\n        else if (result.type() == json_spirit::str_type)\n            strPrint = result.get_str();\n        else\n            strPrint = write_string(result, true);\n\n        emit reply(RPCConsole::CMD_REPLY, QString::fromStdString(strPrint));\n    }\n    catch (json_spirit::Object& objError)\n    {\n        try // Nice formatting for standard-format error\n        {\n            int code = find_value(objError, \"code\").get_int();\n            std::string message = find_value(objError, \"message\").get_str();\n            emit reply(RPCConsole::CMD_ERROR, QString::fromStdString(message) + \" (code \" + QString::number(code) + \")\");\n        }\n        catch(std::runtime_error &) // raised when converting to invalid type, i.e. missing code or message\n        {   // Show raw JSON object\n            emit reply(RPCConsole::CMD_ERROR, QString::fromStdString(write_string(json_spirit::Value(objError), false)));\n        }\n    }\n    catch (std::exception& e)\n    {\n        emit reply(RPCConsole::CMD_ERROR, QString(\"Error: \") + QString::fromStdString(e.what()));\n    }\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "e.what()"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "e.what",
          "args": [],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"Error: \""
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::number",
          "args": [
            "code"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromStdString",
          "args": [
            "message"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "objError",
            "\"message\""
          ],
          "line": 174
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "find_value",
          "args": [
            "objError",
            "\"code\""
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "write_string",
          "args": [
            "result",
            "true"
          ],
          "line": 165
        },
        "resolved": true,
        "details": {
          "function_name": "write_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "234-243",
          "snippet": "typename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\ntypename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }"
        }
      },
      {
        "call_info": {
          "callee": "result.get_str",
          "args": [],
          "line": 163
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result.type",
          "args": [],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "tableRPC.execute",
          "args": [
            "args[0]",
            "RPCConvertValues(args[0], std::vector<std::string>(args.begin() + 1, args.end()))"
          ],
          "line": 155
        },
        "resolved": true,
        "details": {
          "function_name": "execute",
          "container": "CRPCTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1111-1142",
          "snippet": "json_spirit::Value CRPCTable::execute(const std::string &strMethod, const json_spirit::Array &params) const\n{\n    // Find method\n    const CRPCCommand *pcmd = tableRPC[strMethod];\n    if (!pcmd)\n        throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n\n    // Observe safe mode\n    string strWarning = GetWarnings(\"rpc\");\n    if (strWarning != \"\" && !GetBoolArg(\"-disablesafemode\") &&\n        !pcmd->okSafeMode)\n        throw JSONRPCError(RPC_FORBIDDEN_BY_SAFE_MODE, string(\"Safe mode: \") + strWarning);\n\n    try\n    {\n        // Execute\n        Value result;\n        {\n            if (pcmd->unlocked)\n                result = pcmd->actor(params, false);\n            else {\n                LOCK2(cs_main, pwalletMain->cs_wallet);\n                result = pcmd->actor(params, false);\n            }\n        }\n        return result;\n    }\n    catch (std::exception& e)\n    {\n        throw JSONRPCError(RPC_MISC_ERROR, e.what());\n    }\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nCRPCTable {\n  json_spirit::Value CRPCTable::execute(const std::string &strMethod, const json_spirit::Array &params) const\n  {\n      // Find method\n      const CRPCCommand *pcmd = tableRPC[strMethod];\n      if (!pcmd)\n          throw JSONRPCError(RPC_METHOD_NOT_FOUND, \"Method not found\");\n  \n      // Observe safe mode\n      string strWarning = GetWarnings(\"rpc\");\n      if (strWarning != \"\" && !GetBoolArg(\"-disablesafemode\") &&\n          !pcmd->okSafeMode)\n          throw JSONRPCError(RPC_FORBIDDEN_BY_SAFE_MODE, string(\"Safe mode: \") + strWarning);\n  \n      try\n      {\n          // Execute\n          Value result;\n          {\n              if (pcmd->unlocked)\n                  result = pcmd->actor(params, false);\n              else {\n                  LOCK2(cs_main, pwalletMain->cs_wallet);\n                  result = pcmd->actor(params, false);\n              }\n          }\n          return result;\n      }\n      catch (std::exception& e)\n      {\n          throw JSONRPCError(RPC_MISC_ERROR, e.what());\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "RPCConvertValues",
          "args": [
            "args[0]",
            "std::vector<std::string>(args.begin() + 1, args.end())"
          ],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "RPCConvertValues",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bitcoinrpc.cpp",
          "lines": "1227-1289",
          "snippet": "Array RPCConvertValues(const std::string &strMethod, const std::vector<std::string> &strParams)\n{\n    Array params;\n    BOOST_FOREACH(const std::string &param, strParams)\n        params.push_back(param);\n\n    int n = params.size();\n\n    //\n    // Special case non-string parameter types\n    //\n    if (strMethod == \"stop\"                   && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"sendtoaddress\"          && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"settxfee\"               && n > 0) ConvertTo<double>(params[0]);\n    if (strMethod == \"getreceivedbyaddress\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getreceivedbyaccount\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getbalance\"             && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getblock\"               && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockbynumber\"       && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"getblockbynumber\"       && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockhash\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"move\"                   && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"move\"                   && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendfrom\"               && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"sendfrom\"               && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"listtransactions\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listtransactions\"       && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"listaccounts\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"walletpassphrase\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"walletpassphrase\"       && n > 2) ConvertTo<bool>(params[2]);\n    if (strMethod == \"getblocktemplate\"       && n > 0) ConvertTo<Object>(params[0]);\n    if (strMethod == \"listsinceblock\"         && n > 1) ConvertTo<boost::int64_t>(params[1]);\n\n    if (strMethod == \"sendalert\"              && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"sendalert\"              && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendalert\"              && n > 4) ConvertTo<boost::int64_t>(params[4]);\n    if (strMethod == \"sendalert\"              && n > 5) ConvertTo<boost::int64_t>(params[5]);\n    if (strMethod == \"sendalert\"              && n > 6) ConvertTo<boost::int64_t>(params[6]);\n\n    if (strMethod == \"sendmany\"               && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"sendmany\"               && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"reservebalance\"         && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"reservebalance\"         && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"addmultisigaddress\"     && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"addmultisigaddress\"     && n > 1) ConvertTo<Array>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listunspent\"            && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 2) ConvertTo<Array>(params[2]);\n    if (strMethod == \"getrawtransaction\"      && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"createrawtransaction\"   && n > 0) ConvertTo<Array>(params[0]);\n    if (strMethod == \"createrawtransaction\"   && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"signrawtransaction\"     && n > 1) ConvertTo<Array>(params[1], true);\n    if (strMethod == \"signrawtransaction\"     && n > 2) ConvertTo<Array>(params[2], true);\n    if (strMethod == \"keypoolrefill\"          && n > 0) ConvertTo<boost::int64_t>(params[0]);\n\n    if((strMethod == \"importprivkey\")         && (n > 2)) ConvertTo<bool>(params[2]);\n\n    return params;\n}",
          "includes": [
            "#include <list>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/asio/ssl.hpp>",
            "#include <boost/algorithm/string.hpp>",
            "#include <boost/iostreams/stream.hpp>",
            "#include <boost/iostreams/concepts.hpp>",
            "#include <boost/foreach.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include <boost/asio/ip/v6_only.hpp>",
            "#include <boost/asio.hpp>",
            "#include \"db.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"base58.h\"",
            "#include \"ui_interface.h\"",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"init.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <list>\n#include <boost/shared_ptr.hpp>\n#include <boost/filesystem/fstream.hpp>\n#include <boost/asio/ssl.hpp>\n#include <boost/algorithm/string.hpp>\n#include <boost/iostreams/stream.hpp>\n#include <boost/iostreams/concepts.hpp>\n#include <boost/foreach.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include <boost/asio/ip/v6_only.hpp>\n#include <boost/asio.hpp>\n#include \"db.h\"\n#include \"bitcoinrpc.h\"\n#include \"base58.h\"\n#include \"ui_interface.h\"\n#include \"sync.h\"\n#include \"util.h\"\n#include \"init.h\"\n\nArray RPCConvertValues(const std::string &strMethod, const std::vector<std::string> &strParams)\n{\n    Array params;\n    BOOST_FOREACH(const std::string &param, strParams)\n        params.push_back(param);\n\n    int n = params.size();\n\n    //\n    // Special case non-string parameter types\n    //\n    if (strMethod == \"stop\"                   && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"sendtoaddress\"          && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"settxfee\"               && n > 0) ConvertTo<double>(params[0]);\n    if (strMethod == \"getreceivedbyaddress\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getreceivedbyaccount\"   && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaddress\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listreceivedbyaccount\"  && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getbalance\"             && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"getblock\"               && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockbynumber\"       && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"getblockbynumber\"       && n > 1) ConvertTo<bool>(params[1]);\n    if (strMethod == \"getblockhash\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"move\"                   && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"move\"                   && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendfrom\"               && n > 2) ConvertTo<double>(params[2]);\n    if (strMethod == \"sendfrom\"               && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"listtransactions\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listtransactions\"       && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"listaccounts\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"walletpassphrase\"       && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"walletpassphrase\"       && n > 2) ConvertTo<bool>(params[2]);\n    if (strMethod == \"getblocktemplate\"       && n > 0) ConvertTo<Object>(params[0]);\n    if (strMethod == \"listsinceblock\"         && n > 1) ConvertTo<boost::int64_t>(params[1]);\n\n    if (strMethod == \"sendalert\"              && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"sendalert\"              && n > 3) ConvertTo<boost::int64_t>(params[3]);\n    if (strMethod == \"sendalert\"              && n > 4) ConvertTo<boost::int64_t>(params[4]);\n    if (strMethod == \"sendalert\"              && n > 5) ConvertTo<boost::int64_t>(params[5]);\n    if (strMethod == \"sendalert\"              && n > 6) ConvertTo<boost::int64_t>(params[6]);\n\n    if (strMethod == \"sendmany\"               && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"sendmany\"               && n > 2) ConvertTo<boost::int64_t>(params[2]);\n    if (strMethod == \"reservebalance\"         && n > 0) ConvertTo<bool>(params[0]);\n    if (strMethod == \"reservebalance\"         && n > 1) ConvertTo<double>(params[1]);\n    if (strMethod == \"addmultisigaddress\"     && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"addmultisigaddress\"     && n > 1) ConvertTo<Array>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 0) ConvertTo<boost::int64_t>(params[0]);\n    if (strMethod == \"listunspent\"            && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"listunspent\"            && n > 2) ConvertTo<Array>(params[2]);\n    if (strMethod == \"getrawtransaction\"      && n > 1) ConvertTo<boost::int64_t>(params[1]);\n    if (strMethod == \"createrawtransaction\"   && n > 0) ConvertTo<Array>(params[0]);\n    if (strMethod == \"createrawtransaction\"   && n > 1) ConvertTo<Object>(params[1]);\n    if (strMethod == \"signrawtransaction\"     && n > 1) ConvertTo<Array>(params[1], true);\n    if (strMethod == \"signrawtransaction\"     && n > 2) ConvertTo<Array>(params[2], true);\n    if (strMethod == \"keypoolrefill\"          && n > 0) ConvertTo<boost::int64_t>(params[0]);\n\n    if((strMethod == \"importprivkey\")         && (n > 2)) ConvertTo<bool>(params[2]);\n\n    return params;\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::vector<std::string>",
          "args": [
            "args.begin() + 1",
            "args.end()"
          ],
          "line": 157
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "args.end",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "args.begin",
          "args": [],
          "line": 157
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "args.empty",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"Parse error: unbalanced ' or \\\"\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "parseCommandLine",
          "args": [
            "args",
            "command.toStdString()"
          ],
          "line": 143
        },
        "resolved": true,
        "details": {
          "function_name": "parseCommandLine",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "70-138",
          "snippet": "bool parseCommandLine(std::vector<std::string> &args, const std::string &strCommand)\n{\n    enum CmdParseState\n    {\n        STATE_EATING_SPACES,\n        STATE_ARGUMENT,\n        STATE_SINGLEQUOTED,\n        STATE_DOUBLEQUOTED,\n        STATE_ESCAPE_OUTER,\n        STATE_ESCAPE_DOUBLEQUOTED\n    } state = STATE_EATING_SPACES;\n    std::string curarg;\n    foreach(char ch, strCommand)\n    {\n        switch(state)\n        {\n        case STATE_ARGUMENT: // In or after argument\n        case STATE_EATING_SPACES: // Handle runs of whitespace\n            switch(ch)\n            {\n            case '\"': state = STATE_DOUBLEQUOTED; break;\n            case '\\'': state = STATE_SINGLEQUOTED; break;\n            case '\\\\': state = STATE_ESCAPE_OUTER; break;\n            case ' ': case '\\n': case '\\t':\n                if(state == STATE_ARGUMENT) // Space ends argument\n                {\n                    args.push_back(curarg);\n                    curarg.clear();\n                }\n                state = STATE_EATING_SPACES;\n                break;\n            default: curarg += ch; state = STATE_ARGUMENT;\n            }\n            break;\n        case STATE_SINGLEQUOTED: // Single-quoted string\n            switch(ch)\n            {\n            case '\\'': state = STATE_ARGUMENT; break;\n            default: curarg += ch;\n            }\n            break;\n        case STATE_DOUBLEQUOTED: // Double-quoted string\n            switch(ch)\n            {\n            case '\"': state = STATE_ARGUMENT; break;\n            case '\\\\': state = STATE_ESCAPE_DOUBLEQUOTED; break;\n            default: curarg += ch;\n            }\n            break;\n        case STATE_ESCAPE_OUTER: // '\\' outside quotes\n            curarg += ch; state = STATE_ARGUMENT;\n            break;\n        case STATE_ESCAPE_DOUBLEQUOTED: // '\\' in double-quoted text\n            if(ch != '\"' && ch != '\\\\') curarg += '\\\\'; // keep '\\' for everything but the quote and '\\' itself\n            curarg += ch; state = STATE_DOUBLEQUOTED;\n            break;\n        }\n    }\n    switch(state) // final state\n    {\n    case STATE_EATING_SPACES:\n        return true;\n    case STATE_ARGUMENT:\n        args.push_back(curarg);\n        return true;\n    default: // ERROR to end in one of the other states\n        return false;\n    }\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nbool parseCommandLine(std::vector<std::string> &args, const std::string &strCommand)\n{\n    enum CmdParseState\n    {\n        STATE_EATING_SPACES,\n        STATE_ARGUMENT,\n        STATE_SINGLEQUOTED,\n        STATE_DOUBLEQUOTED,\n        STATE_ESCAPE_OUTER,\n        STATE_ESCAPE_DOUBLEQUOTED\n    } state = STATE_EATING_SPACES;\n    std::string curarg;\n    foreach(char ch, strCommand)\n    {\n        switch(state)\n        {\n        case STATE_ARGUMENT: // In or after argument\n        case STATE_EATING_SPACES: // Handle runs of whitespace\n            switch(ch)\n            {\n            case '\"': state = STATE_DOUBLEQUOTED; break;\n            case '\\'': state = STATE_SINGLEQUOTED; break;\n            case '\\\\': state = STATE_ESCAPE_OUTER; break;\n            case ' ': case '\\n': case '\\t':\n                if(state == STATE_ARGUMENT) // Space ends argument\n                {\n                    args.push_back(curarg);\n                    curarg.clear();\n                }\n                state = STATE_EATING_SPACES;\n                break;\n            default: curarg += ch; state = STATE_ARGUMENT;\n            }\n            break;\n        case STATE_SINGLEQUOTED: // Single-quoted string\n            switch(ch)\n            {\n            case '\\'': state = STATE_ARGUMENT; break;\n            default: curarg += ch;\n            }\n            break;\n        case STATE_DOUBLEQUOTED: // Double-quoted string\n            switch(ch)\n            {\n            case '\"': state = STATE_ARGUMENT; break;\n            case '\\\\': state = STATE_ESCAPE_DOUBLEQUOTED; break;\n            default: curarg += ch;\n            }\n            break;\n        case STATE_ESCAPE_OUTER: // '\\' outside quotes\n            curarg += ch; state = STATE_ARGUMENT;\n            break;\n        case STATE_ESCAPE_DOUBLEQUOTED: // '\\' in double-quoted text\n            if(ch != '\"' && ch != '\\\\') curarg += '\\\\'; // keep '\\' for everything but the quote and '\\' itself\n            curarg += ch; state = STATE_DOUBLEQUOTED;\n            break;\n        }\n    }\n    switch(state) // final state\n    {\n    case STATE_EATING_SPACES:\n        return true;\n    case STATE_ARGUMENT:\n        args.push_back(curarg);\n        return true;\n    default: // ERROR to end in one of the other states\n        return false;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "command.toStdString",
          "args": [],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCExecutor {\n  void RPCExecutor::request(const QString &command)\n  {\n      std::vector<std::string> args;\n      if(!parseCommandLine(args, command.toStdString()))\n      {\n          emit reply(RPCConsole::CMD_ERROR, QString(\"Parse error: unbalanced ' or \\\"\"));\n          return;\n      }\n      if(args.empty())\n          return; // Nothing to do\n      try\n      {\n          std::string strPrint;\n          // Convert argument list to JSON objects in method-dependent way,\n          // and pass it along with the method name to the dispatcher.\n          json_spirit::Value result = tableRPC.execute(\n              args[0],\n              RPCConvertValues(args[0], std::vector<std::string>(args.begin() + 1, args.end())));\n  \n          // Format result reply\n          if (result.type() == json_spirit::null_type)\n              strPrint = \"\";\n          else if (result.type() == json_spirit::str_type)\n              strPrint = result.get_str();\n          else\n              strPrint = write_string(result, true);\n  \n          emit reply(RPCConsole::CMD_REPLY, QString::fromStdString(strPrint));\n      }\n      catch (json_spirit::Object& objError)\n      {\n          try // Nice formatting for standard-format error\n          {\n              int code = find_value(objError, \"code\").get_int();\n              std::string message = find_value(objError, \"message\").get_str();\n              emit reply(RPCConsole::CMD_ERROR, QString::fromStdString(message) + \" (code \" + QString::number(code) + \")\");\n          }\n          catch(std::runtime_error &) // raised when converting to invalid type, i.e. missing code or message\n          {   // Show raw JSON object\n              emit reply(RPCConsole::CMD_ERROR, QString::fromStdString(write_string(json_spirit::Value(objError), false)));\n          }\n      }\n      catch (std::exception& e)\n      {\n          emit reply(RPCConsole::CMD_ERROR, QString(\"Error: \") + QString::fromStdString(e.what()));\n      }\n  }\n}"
  },
  {
    "function_name": "parseCommandLine",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "70-138",
    "snippet": "bool parseCommandLine(std::vector<std::string> &args, const std::string &strCommand)\n{\n    enum CmdParseState\n    {\n        STATE_EATING_SPACES,\n        STATE_ARGUMENT,\n        STATE_SINGLEQUOTED,\n        STATE_DOUBLEQUOTED,\n        STATE_ESCAPE_OUTER,\n        STATE_ESCAPE_DOUBLEQUOTED\n    } state = STATE_EATING_SPACES;\n    std::string curarg;\n    foreach(char ch, strCommand)\n    {\n        switch(state)\n        {\n        case STATE_ARGUMENT: // In or after argument\n        case STATE_EATING_SPACES: // Handle runs of whitespace\n            switch(ch)\n            {\n            case '\"': state = STATE_DOUBLEQUOTED; break;\n            case '\\'': state = STATE_SINGLEQUOTED; break;\n            case '\\\\': state = STATE_ESCAPE_OUTER; break;\n            case ' ': case '\\n': case '\\t':\n                if(state == STATE_ARGUMENT) // Space ends argument\n                {\n                    args.push_back(curarg);\n                    curarg.clear();\n                }\n                state = STATE_EATING_SPACES;\n                break;\n            default: curarg += ch; state = STATE_ARGUMENT;\n            }\n            break;\n        case STATE_SINGLEQUOTED: // Single-quoted string\n            switch(ch)\n            {\n            case '\\'': state = STATE_ARGUMENT; break;\n            default: curarg += ch;\n            }\n            break;\n        case STATE_DOUBLEQUOTED: // Double-quoted string\n            switch(ch)\n            {\n            case '\"': state = STATE_ARGUMENT; break;\n            case '\\\\': state = STATE_ESCAPE_DOUBLEQUOTED; break;\n            default: curarg += ch;\n            }\n            break;\n        case STATE_ESCAPE_OUTER: // '\\' outside quotes\n            curarg += ch; state = STATE_ARGUMENT;\n            break;\n        case STATE_ESCAPE_DOUBLEQUOTED: // '\\' in double-quoted text\n            if(ch != '\"' && ch != '\\\\') curarg += '\\\\'; // keep '\\' for everything but the quote and '\\' itself\n            curarg += ch; state = STATE_DOUBLEQUOTED;\n            break;\n        }\n    }\n    switch(state) // final state\n    {\n    case STATE_EATING_SPACES:\n        return true;\n    case STATE_ARGUMENT:\n        args.push_back(curarg);\n        return true;\n    default: // ERROR to end in one of the other states\n        return false;\n    }\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "args.push_back",
          "args": [
            "curarg"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "curarg.clear",
          "args": [],
          "line": 97
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "RPCConsole",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
          "lines": "289-318",
          "snippet": "void RPCConsole::clear()\n{\n    ui->messagesWidget->clear();\n    ui->lineEdit->clear();\n    ui->lineEdit->setFocus();\n\n    // Add smoothly scaled icon images.\n    // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n    for(int i=0; ICON_MAPPING[i].url; ++i)\n    {\n        ui->messagesWidget->document()->addResource(\n                    QTextDocument::ImageResource,\n                    QUrl(ICON_MAPPING[i].url),\n                    QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n    }\n\n    // Set default style sheet\n    ui->messagesWidget->document()->setDefaultStyleSheet(\n                \"table { }\"\n                \"td.time { color: #808080; padding-top: 3px; } \"\n                \"td.message { font-family: Monospace; font-size: 12px; } \"\n                \"td.cmd-request { color: #006060; } \"\n                \"td.cmd-error { color: red; } \"\n                \"b { color: #006060; } \"\n                );\n\n    message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                        tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                        tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n}",
          "includes": [
            "#include \"rpcconsole.moc\"",
            "#include <openssl/crypto.h>",
            "#include <QScrollBar>",
            "#include <QUrl>",
            "#include <QKeyEvent>",
            "#include <QTextEdit>",
            "#include <QThread>",
            "#include <QTimer>",
            "#include <QTime>",
            "#include \"guiutil.h\"",
            "#include \"bitcoinrpc.h\"",
            "#include \"clientmodel.h\"",
            "#include \"ui_rpcconsole.h\"",
            "#include \"rpcconsole.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QSize ICON_SIZE(24, 24);",
            "const struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};"
          ],
          "called_functions": [],
          "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nconst QSize ICON_SIZE(24, 24);\nconst struct {\n    const char *url;\n    const char *source;\n} ICON_MAPPING[] = {\n    {\"cmd-request\", \":/icons/tx_input\"},\n    {\"cmd-reply\", \":/icons/tx_output\"},\n    {\"cmd-error\", \":/icons/tx_output\"},\n    {\"misc\", \":/icons/tx_inout\"},\n    {NULL, NULL}\n};\n\nRPCConsole {\n  void RPCConsole::clear()\n  {\n      ui->messagesWidget->clear();\n      ui->lineEdit->clear();\n      ui->lineEdit->setFocus();\n  \n      // Add smoothly scaled icon images.\n      // (when using width/height on an img, Qt uses nearest instead of linear interpolation)\n      for(int i=0; ICON_MAPPING[i].url; ++i)\n      {\n          ui->messagesWidget->document()->addResource(\n                      QTextDocument::ImageResource,\n                      QUrl(ICON_MAPPING[i].url),\n                      QImage(ICON_MAPPING[i].source).scaled(ICON_SIZE, Qt::IgnoreAspectRatio, Qt::SmoothTransformation));\n      }\n  \n      // Set default style sheet\n      ui->messagesWidget->document()->setDefaultStyleSheet(\n                  \"table { }\"\n                  \"td.time { color: #808080; padding-top: 3px; } \"\n                  \"td.message { font-family: Monospace; font-size: 12px; } \"\n                  \"td.cmd-request { color: #006060; } \"\n                  \"td.cmd-error { color: red; } \"\n                  \"b { color: #006060; } \"\n                  );\n  \n      message(CMD_REPLY, (tr(\"Welcome to the Halcyon RPC console.\") + \"<br>\" +\n                          tr(\"Use up and down arrows to navigate history, and <b>Ctrl-L</b> to clear screen.\") + \"<br>\" +\n                          tr(\"Type <b>help</b> for an overview of available commands.\")), true);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "args.push_back",
          "args": [
            "curarg"
          ],
          "line": 96
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nbool parseCommandLine(std::vector<std::string> &args, const std::string &strCommand)\n{\n    enum CmdParseState\n    {\n        STATE_EATING_SPACES,\n        STATE_ARGUMENT,\n        STATE_SINGLEQUOTED,\n        STATE_DOUBLEQUOTED,\n        STATE_ESCAPE_OUTER,\n        STATE_ESCAPE_DOUBLEQUOTED\n    } state = STATE_EATING_SPACES;\n    std::string curarg;\n    foreach(char ch, strCommand)\n    {\n        switch(state)\n        {\n        case STATE_ARGUMENT: // In or after argument\n        case STATE_EATING_SPACES: // Handle runs of whitespace\n            switch(ch)\n            {\n            case '\"': state = STATE_DOUBLEQUOTED; break;\n            case '\\'': state = STATE_SINGLEQUOTED; break;\n            case '\\\\': state = STATE_ESCAPE_OUTER; break;\n            case ' ': case '\\n': case '\\t':\n                if(state == STATE_ARGUMENT) // Space ends argument\n                {\n                    args.push_back(curarg);\n                    curarg.clear();\n                }\n                state = STATE_EATING_SPACES;\n                break;\n            default: curarg += ch; state = STATE_ARGUMENT;\n            }\n            break;\n        case STATE_SINGLEQUOTED: // Single-quoted string\n            switch(ch)\n            {\n            case '\\'': state = STATE_ARGUMENT; break;\n            default: curarg += ch;\n            }\n            break;\n        case STATE_DOUBLEQUOTED: // Double-quoted string\n            switch(ch)\n            {\n            case '\"': state = STATE_ARGUMENT; break;\n            case '\\\\': state = STATE_ESCAPE_DOUBLEQUOTED; break;\n            default: curarg += ch;\n            }\n            break;\n        case STATE_ESCAPE_OUTER: // '\\' outside quotes\n            curarg += ch; state = STATE_ARGUMENT;\n            break;\n        case STATE_ESCAPE_DOUBLEQUOTED: // '\\' in double-quoted text\n            if(ch != '\"' && ch != '\\\\') curarg += '\\\\'; // keep '\\' for everything but the quote and '\\' itself\n            curarg += ch; state = STATE_DOUBLEQUOTED;\n            break;\n        }\n    }\n    switch(state) // final state\n    {\n    case STATE_EATING_SPACES:\n        return true;\n    case STATE_ARGUMENT:\n        args.push_back(curarg);\n        return true;\n    default: // ERROR to end in one of the other states\n        return false;\n    }\n}"
  },
  {
    "function_name": "start",
    "container": "RPCExecutor",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/rpcconsole.cpp",
    "lines": "51-54",
    "snippet": "void RPCExecutor::start()\n{\n   // Nothing to do\n}",
    "includes": [
      "#include \"rpcconsole.moc\"",
      "#include <openssl/crypto.h>",
      "#include <QScrollBar>",
      "#include <QUrl>",
      "#include <QKeyEvent>",
      "#include <QTextEdit>",
      "#include <QThread>",
      "#include <QTimer>",
      "#include <QTime>",
      "#include \"guiutil.h\"",
      "#include \"bitcoinrpc.h\"",
      "#include \"clientmodel.h\"",
      "#include \"ui_rpcconsole.h\"",
      "#include \"rpcconsole.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"rpcconsole.moc\"\n#include <openssl/crypto.h>\n#include <QScrollBar>\n#include <QUrl>\n#include <QKeyEvent>\n#include <QTextEdit>\n#include <QThread>\n#include <QTimer>\n#include <QTime>\n#include \"guiutil.h\"\n#include \"bitcoinrpc.h\"\n#include \"clientmodel.h\"\n#include \"ui_rpcconsole.h\"\n#include \"rpcconsole.h\"\n\nRPCExecutor {\n  void RPCExecutor::start()\n  {\n     // Nothing to do\n  }\n}"
  }
]