[
  {
    "function_name": "WriteMinVersion",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "184-187",
    "snippet": "bool WriteMinVersion(int nVersion)\n    {\n        return Write(std::string(\"minversion\"), nVersion);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::string(\"minversion\")",
            "nVersion"
          ],
          "line": 186
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"minversion\""
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteMinVersion(int nVersion)\n      {\n          return Write(std::string(\"minversion\"), nVersion);\n      }\n}"
  },
  {
    "function_name": "EraseSetting",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "178-182",
    "snippet": "bool EraseSetting(const std::string& strKey)\n    {\n        nWalletDBUpdated++;\n        return Erase(std::make_pair(std::string(\"setting\"), strKey));\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Erase",
          "args": [
            "std::make_pair(std::string(\"setting\"), strKey)"
          ],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "EraseSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "178-182",
          "snippet": "bool EraseSetting(const std::string& strKey)\n    {\n        nWalletDBUpdated++;\n        return Erase(std::make_pair(std::string(\"setting\"), strKey));\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"setting\")",
            "strKey"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"setting\""
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool EraseSetting(const std::string& strKey)\n      {\n          nWalletDBUpdated++;\n          return Erase(std::make_pair(std::string(\"setting\"), strKey));\n      }\n}"
  },
  {
    "function_name": "WriteSetting",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "173-177",
    "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"setting\"), strKey)",
            "value"
          ],
          "line": 176
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"setting\")",
            "strKey"
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"setting\""
          ],
          "line": 176
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
  },
  {
    "function_name": "ReadSetting",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "168-171",
    "snippet": "bool ReadSetting(const std::string& strKey, T& value)\n    {\n        return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Read",
          "args": [
            "std::make_pair(std::string(\"setting\"), strKey)",
            "value"
          ],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "ReadSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "168-171",
          "snippet": "bool ReadSetting(const std::string& strKey, T& value)\n    {\n        return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"setting\")",
            "strKey"
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"setting\""
          ],
          "line": 170
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool ReadSetting(const std::string& strKey, T& value)\n      {\n          return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
  },
  {
    "function_name": "ErasePool",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "159-163",
    "snippet": "bool ErasePool(int64_t nPool)\n    {\n        nWalletDBUpdated++;\n        return Erase(std::make_pair(std::string(\"pool\"), nPool));\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Erase",
          "args": [
            "std::make_pair(std::string(\"pool\"), nPool)"
          ],
          "line": 162
        },
        "resolved": true,
        "details": {
          "function_name": "EraseSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "178-182",
          "snippet": "bool EraseSetting(const std::string& strKey)\n    {\n        nWalletDBUpdated++;\n        return Erase(std::make_pair(std::string(\"setting\"), strKey));\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool EraseSetting(const std::string& strKey)\n      {\n          nWalletDBUpdated++;\n          return Erase(std::make_pair(std::string(\"setting\"), strKey));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"pool\")",
            "nPool"
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"pool\""
          ],
          "line": 162
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool ErasePool(int64_t nPool)\n      {\n          nWalletDBUpdated++;\n          return Erase(std::make_pair(std::string(\"pool\"), nPool));\n      }\n}"
  },
  {
    "function_name": "WritePool",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "153-157",
    "snippet": "bool WritePool(int64_t nPool, const CKeyPool& keypool)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"pool\"), nPool), keypool);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"pool\"), nPool)",
            "keypool"
          ],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"pool\")",
            "nPool"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"pool\""
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WritePool(int64_t nPool, const CKeyPool& keypool)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"pool\"), nPool), keypool);\n      }\n}"
  },
  {
    "function_name": "ReadPool",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "148-151",
    "snippet": "bool ReadPool(int64_t nPool, CKeyPool& keypool)\n    {\n        return Read(std::make_pair(std::string(\"pool\"), nPool), keypool);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Read",
          "args": [
            "std::make_pair(std::string(\"pool\"), nPool)",
            "keypool"
          ],
          "line": 150
        },
        "resolved": true,
        "details": {
          "function_name": "ReadSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "168-171",
          "snippet": "bool ReadSetting(const std::string& strKey, T& value)\n    {\n        return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool ReadSetting(const std::string& strKey, T& value)\n      {\n          return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"pool\")",
            "nPool"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"pool\""
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool ReadPool(int64_t nPool, CKeyPool& keypool)\n      {\n          return Read(std::make_pair(std::string(\"pool\"), nPool), keypool);\n      }\n}"
  },
  {
    "function_name": "WriteDefaultKey",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "142-146",
    "snippet": "bool WriteDefaultKey(const CPubKey& vchPubKey)\n    {\n        nWalletDBUpdated++;\n        return Write(std::string(\"defaultkey\"), vchPubKey.Raw());\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::string(\"defaultkey\")",
            "vchPubKey.Raw()"
          ],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchPubKey.Raw",
          "args": [],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "Raw",
          "container": "CPubKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "96-98",
          "snippet": "std::vector<unsigned char> Raw() const {\n        return vchPubKey;\n    }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  std::vector<unsigned char> Raw() const {\n          return vchPubKey;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"defaultkey\""
          ],
          "line": 145
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteDefaultKey(const CPubKey& vchPubKey)\n      {\n          nWalletDBUpdated++;\n          return Write(std::string(\"defaultkey\"), vchPubKey.Raw());\n      }\n}"
  },
  {
    "function_name": "WriteOrderPosNext",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "136-140",
    "snippet": "bool WriteOrderPosNext(int64_t nOrderPosNext)\n    {\n        nWalletDBUpdated++;\n        return Write(std::string(\"orderposnext\"), nOrderPosNext);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::string(\"orderposnext\")",
            "nOrderPosNext"
          ],
          "line": 139
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"orderposnext\""
          ],
          "line": 139
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteOrderPosNext(int64_t nOrderPosNext)\n      {\n          nWalletDBUpdated++;\n          return Write(std::string(\"orderposnext\"), nOrderPosNext);\n      }\n}"
  },
  {
    "function_name": "ReadBestBlock",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "131-134",
    "snippet": "bool ReadBestBlock(CBlockLocator& locator)\n    {\n        return Read(std::string(\"bestblock\"), locator);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Read",
          "args": [
            "std::string(\"bestblock\")",
            "locator"
          ],
          "line": 133
        },
        "resolved": true,
        "details": {
          "function_name": "ReadSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "168-171",
          "snippet": "bool ReadSetting(const std::string& strKey, T& value)\n    {\n        return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool ReadSetting(const std::string& strKey, T& value)\n      {\n          return Read(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"bestblock\""
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool ReadBestBlock(CBlockLocator& locator)\n      {\n          return Read(std::string(\"bestblock\"), locator);\n      }\n}"
  },
  {
    "function_name": "WriteBestBlock",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "125-129",
    "snippet": "bool WriteBestBlock(const CBlockLocator& locator)\n    {\n        nWalletDBUpdated++;\n        return Write(std::string(\"bestblock\"), locator);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::string(\"bestblock\")",
            "locator"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"bestblock\""
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteBestBlock(const CBlockLocator& locator)\n      {\n          nWalletDBUpdated++;\n          return Write(std::string(\"bestblock\"), locator);\n      }\n}"
  },
  {
    "function_name": "WriteCScript",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "119-123",
    "snippet": "bool WriteCScript(const uint160& hash, const CScript& redeemScript)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"cscript\"), hash), redeemScript, false);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"cscript\"), hash)",
            "redeemScript",
            "false"
          ],
          "line": 122
        },
        "resolved": true,
        "details": {
          "function_name": "WriteCryptedKey",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "95-111",
          "snippet": "bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n    {\n        nWalletDBUpdated++;\n        bool fEraseUnencryptedKey = true;\n\n        if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n            return false;\n\n        if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n            return false;\n        if (fEraseUnencryptedKey)\n        {\n            Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n            Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n        }\n        return true;\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n      {\n          nWalletDBUpdated++;\n          bool fEraseUnencryptedKey = true;\n  \n          if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n              return false;\n  \n          if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n              return false;\n          if (fEraseUnencryptedKey)\n          {\n              Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n              Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n          }\n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"cscript\")",
            "hash"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"cscript\""
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteCScript(const uint160& hash, const CScript& redeemScript)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"cscript\"), hash), redeemScript, false);\n      }\n}"
  },
  {
    "function_name": "WriteMasterKey",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "113-117",
    "snippet": "bool WriteMasterKey(unsigned int nID, const CMasterKey& kMasterKey)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"mkey\"), nID), kMasterKey, true);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"mkey\"), nID)",
            "kMasterKey",
            "true"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "WriteCryptedKey",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "95-111",
          "snippet": "bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n    {\n        nWalletDBUpdated++;\n        bool fEraseUnencryptedKey = true;\n\n        if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n            return false;\n\n        if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n            return false;\n        if (fEraseUnencryptedKey)\n        {\n            Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n            Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n        }\n        return true;\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n      {\n          nWalletDBUpdated++;\n          bool fEraseUnencryptedKey = true;\n  \n          if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n              return false;\n  \n          if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n              return false;\n          if (fEraseUnencryptedKey)\n          {\n              Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n              Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n          }\n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"mkey\")",
            "nID"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"mkey\""
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteMasterKey(unsigned int nID, const CMasterKey& kMasterKey)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"mkey\"), nID), kMasterKey, true);\n      }\n}"
  },
  {
    "function_name": "WriteCryptedKey",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "95-111",
    "snippet": "bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n    {\n        nWalletDBUpdated++;\n        bool fEraseUnencryptedKey = true;\n\n        if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n            return false;\n\n        if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n            return false;\n        if (fEraseUnencryptedKey)\n        {\n            Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n            Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n        }\n        return true;\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Erase",
          "args": [
            "std::make_pair(std::string(\"wkey\"), vchPubKey.Raw())"
          ],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "EraseSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "178-182",
          "snippet": "bool EraseSetting(const std::string& strKey)\n    {\n        nWalletDBUpdated++;\n        return Erase(std::make_pair(std::string(\"setting\"), strKey));\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool EraseSetting(const std::string& strKey)\n      {\n          nWalletDBUpdated++;\n          return Erase(std::make_pair(std::string(\"setting\"), strKey));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"wkey\")",
            "vchPubKey.Raw()"
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchPubKey.Raw",
          "args": [],
          "line": 108
        },
        "resolved": true,
        "details": {
          "function_name": "Raw",
          "container": "CPubKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "96-98",
          "snippet": "std::vector<unsigned char> Raw() const {\n        return vchPubKey;\n    }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  std::vector<unsigned char> Raw() const {\n          return vchPubKey;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"wkey\""
          ],
          "line": 108
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"key\")",
            "vchPubKey.Raw()"
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"key\""
          ],
          "line": 107
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"ckey\"), vchPubKey.Raw())",
            "vchCryptedSecret",
            "false"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "WriteCryptedKey",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "95-111",
          "snippet": "bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n    {\n        nWalletDBUpdated++;\n        bool fEraseUnencryptedKey = true;\n\n        if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n            return false;\n\n        if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n            return false;\n        if (fEraseUnencryptedKey)\n        {\n            Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n            Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n        }\n        return true;\n    }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"ckey\")",
            "vchPubKey.Raw()"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"ckey\""
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"keymeta\"), vchPubKey)",
            "keyMeta"
          ],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"keymeta\")",
            "vchPubKey"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"keymeta\""
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n      {\n          nWalletDBUpdated++;\n          bool fEraseUnencryptedKey = true;\n  \n          if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n              return false;\n  \n          if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n              return false;\n          if (fEraseUnencryptedKey)\n          {\n              Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n              Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n          }\n          return true;\n      }\n}"
  },
  {
    "function_name": "WriteKey",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "85-93",
    "snippet": "bool WriteKey(const CPubKey& vchPubKey, const CPrivKey& vchPrivKey, const CKeyMetadata &keyMeta)\n    {\n        nWalletDBUpdated++;\n\n        if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n            return false;\n\n        return Write(std::make_pair(std::string(\"key\"), vchPubKey.Raw()), vchPrivKey, false);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"key\"), vchPubKey.Raw())",
            "vchPrivKey",
            "false"
          ],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "WriteCryptedKey",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "95-111",
          "snippet": "bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n    {\n        nWalletDBUpdated++;\n        bool fEraseUnencryptedKey = true;\n\n        if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n            return false;\n\n        if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n            return false;\n        if (fEraseUnencryptedKey)\n        {\n            Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n            Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n        }\n        return true;\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteCryptedKey(const CPubKey& vchPubKey, const std::vector<unsigned char>& vchCryptedSecret, const CKeyMetadata &keyMeta)\n      {\n          nWalletDBUpdated++;\n          bool fEraseUnencryptedKey = true;\n  \n          if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n              return false;\n  \n          if (!Write(std::make_pair(std::string(\"ckey\"), vchPubKey.Raw()), vchCryptedSecret, false))\n              return false;\n          if (fEraseUnencryptedKey)\n          {\n              Erase(std::make_pair(std::string(\"key\"), vchPubKey.Raw()));\n              Erase(std::make_pair(std::string(\"wkey\"), vchPubKey.Raw()));\n          }\n          return true;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"key\")",
            "vchPubKey.Raw()"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "vchPubKey.Raw",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "Raw",
          "container": "CPubKey",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "96-98",
          "snippet": "std::vector<unsigned char> Raw() const {\n        return vchPubKey;\n    }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  std::vector<unsigned char> Raw() const {\n          return vchPubKey;\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"key\""
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"keymeta\"), vchPubKey)",
            "keyMeta"
          ],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"keymeta\")",
            "vchPubKey"
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"keymeta\""
          ],
          "line": 89
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteKey(const CPubKey& vchPubKey, const CPrivKey& vchPrivKey, const CKeyMetadata &keyMeta)\n      {\n          nWalletDBUpdated++;\n  \n          if(!Write(std::make_pair(std::string(\"keymeta\"), vchPubKey), keyMeta))\n              return false;\n  \n          return Write(std::make_pair(std::string(\"key\"), vchPubKey.Raw()), vchPrivKey, false);\n      }\n}"
  },
  {
    "function_name": "EraseTx",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "79-83",
    "snippet": "bool EraseTx(uint256 hash)\n    {\n        nWalletDBUpdated++;\n        return Erase(std::make_pair(std::string(\"tx\"), hash));\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Erase",
          "args": [
            "std::make_pair(std::string(\"tx\"), hash)"
          ],
          "line": 82
        },
        "resolved": true,
        "details": {
          "function_name": "EraseSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "178-182",
          "snippet": "bool EraseSetting(const std::string& strKey)\n    {\n        nWalletDBUpdated++;\n        return Erase(std::make_pair(std::string(\"setting\"), strKey));\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool EraseSetting(const std::string& strKey)\n      {\n          nWalletDBUpdated++;\n          return Erase(std::make_pair(std::string(\"setting\"), strKey));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"tx\")",
            "hash"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"tx\""
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool EraseTx(uint256 hash)\n      {\n          nWalletDBUpdated++;\n          return Erase(std::make_pair(std::string(\"tx\"), hash));\n      }\n}"
  },
  {
    "function_name": "WriteTx",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "73-77",
    "snippet": "bool WriteTx(uint256 hash, const CWalletTx& wtx)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"tx\"), hash), wtx);\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Write",
          "args": [
            "std::make_pair(std::string(\"tx\"), hash)",
            "wtx"
          ],
          "line": 76
        },
        "resolved": true,
        "details": {
          "function_name": "WriteSetting",
          "container": "CWalletDB",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "173-177",
          "snippet": "bool WriteSetting(const std::string& strKey, const T& value)\n    {\n        nWalletDBUpdated++;\n        return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteSetting(const std::string& strKey, const T& value)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"setting\"), strKey), value);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::make_pair",
          "args": [
            "std::string(\"tx\")",
            "hash"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "\"tx\""
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  bool WriteTx(uint256 hash, const CWalletTx& wtx)\n      {\n          nWalletDBUpdated++;\n          return Write(std::make_pair(std::string(\"tx\"), hash), wtx);\n      }\n}"
  },
  {
    "function_name": "CWalletDB",
    "container": "CWalletDB",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "62-64",
    "snippet": "CWalletDB(std::string strFilename, const char* pszMode=\"r+\") : CDB(strFilename.c_str(), pszMode)\n    {\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strFilename.c_str",
          "args": [],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCWalletDB {\n  CWalletDB(std::string strFilename, const char* pszMode=\"r+\") : CDB(strFilename.c_str(), pszMode)\n      {\n      }\n}"
  },
  {
    "function_name": "SetNull",
    "container": "CKeyMetadata",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "50-54",
    "snippet": "void SetNull()\n    {\n        nVersion = CKeyMetadata::CURRENT_VERSION;\n        nCreateTime = 0;\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCKeyMetadata {\n  void SetNull()\n      {\n          nVersion = CKeyMetadata::CURRENT_VERSION;\n          nCreateTime = 0;\n      }\n}"
  },
  {
    "function_name": "CKeyMetadata",
    "container": "CKeyMetadata",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "37-41",
    "snippet": "CKeyMetadata(int64_t nCreateTime_)\n    {\n        nVersion = CKeyMetadata::CURRENT_VERSION;\n        nCreateTime = nCreateTime_;\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCKeyMetadata {\n  CKeyMetadata(int64_t nCreateTime_)\n      {\n          nVersion = CKeyMetadata::CURRENT_VERSION;\n          nCreateTime = nCreateTime_;\n      }\n}"
  },
  {
    "function_name": "CKeyMetadata",
    "container": "CKeyMetadata",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
    "lines": "33-36",
    "snippet": "CKeyMetadata()\n    {\n        SetNull();\n    }",
    "includes": [
      "#include \"base58.h\"",
      "#include \"db.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetNull",
          "args": [],
          "line": 35
        },
        "resolved": true,
        "details": {
          "function_name": "SetNull",
          "container": "CKeyMetadata",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/walletdb.h",
          "lines": "50-54",
          "snippet": "void SetNull()\n    {\n        nVersion = CKeyMetadata::CURRENT_VERSION;\n        nCreateTime = 0;\n    }",
          "includes": [
            "#include \"base58.h\"",
            "#include \"db.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCKeyMetadata {\n  void SetNull()\n      {\n          nVersion = CKeyMetadata::CURRENT_VERSION;\n          nCreateTime = 0;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"base58.h\"\n#include \"db.h\"\n\nCKeyMetadata {\n  CKeyMetadata()\n      {\n          SetNull();\n      }\n}"
  }
]