[
  {
    "function_name": "Add",
    "container": "BlockBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block_builder.cc",
    "lines": "73-107",
    "snippet": "void BlockBuilder::Add(const Slice& key, const Slice& value) {\n  Slice last_key_piece(last_key_);\n  assert(!finished_);\n  assert(counter_ <= options_->block_restart_interval);\n  assert(buffer_.empty() // No values yet?\n         || options_->comparator->Compare(key, last_key_piece) > 0);\n  size_t shared = 0;\n  if (counter_ < options_->block_restart_interval) {\n    // See how much sharing to do with previous string\n    const size_t min_length = std::min(last_key_piece.size(), key.size());\n    while ((shared < min_length) && (last_key_piece[shared] == key[shared])) {\n      shared++;\n    }\n  } else {\n    // Restart compression\n    restarts_.push_back(buffer_.size());\n    counter_ = 0;\n  }\n  const size_t non_shared = key.size() - shared;\n\n  // Add \"<shared><non_shared><value_size>\" to buffer_\n  PutVarint32(&buffer_, shared);\n  PutVarint32(&buffer_, non_shared);\n  PutVarint32(&buffer_, value.size());\n\n  // Add string delta to buffer_ followed by value\n  buffer_.append(key.data() + shared, non_shared);\n  buffer_.append(value.data(), value.size());\n\n  // Update state\n  last_key_.resize(shared);\n  last_key_.append(key.data() + shared, non_shared);\n  assert(Slice(last_key_) == key);\n  counter_++;\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <assert.h>",
      "#include <algorithm>",
      "#include \"table/block_builder.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "Slice(last_key_) == key"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "last_key_"
          ],
          "line": 105
        },
        "resolved": true,
        "details": {
          "function_name": "HashSlice",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "276-278",
          "snippet": "static inline uint32_t HashSlice(const Slice& s) {\n    return Hash(s.data(), s.size(), 0);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  static inline uint32_t HashSlice(const Slice& s) {\n      return Hash(s.data(), s.size(), 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "last_key_.append",
          "args": [
            "key.data() + shared",
            "non_shared"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.data",
          "args": [],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "last_key_.resize",
          "args": [
            "shared"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "resize",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "804-804",
          "snippet": "void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  void resize(size_type n, value_type c=0)         { vch.resize(n + nReadPos, c); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_.append",
          "args": [
            "value.data()",
            "value.size()"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.size",
          "args": [],
          "line": 100
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.data",
          "args": [],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "buffer_.append",
          "args": [
            "key.data() + shared",
            "non_shared"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "key.data",
          "args": [],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutVarint32",
          "args": [
            "&buffer_",
            "value.size()"
          ],
          "line": 96
        },
        "resolved": true,
        "details": {
          "function_name": "PutVarint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "75-79",
          "snippet": "void PutVarint32(std::string* dst, uint32_t v) {\n  char buf[5];\n  char* ptr = EncodeVarint32(buf, v);\n  dst->append(buf, ptr - buf);\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutVarint32(std::string* dst, uint32_t v) {\n  char buf[5];\n  char* ptr = EncodeVarint32(buf, v);\n  dst->append(buf, ptr - buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "restarts_.push_back",
          "args": [
            "buffer_.size()"
          ],
          "line": 88
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::min",
          "args": [
            "last_key_piece.size()",
            "key.size()"
          ],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "buffer_.empty() // No values yet?\n         || options_->comparator->Compare(key, last_key_piece) > 0"
          ],
          "line": 77
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "options_->comparator->Compare",
          "args": [
            "key",
            "last_key_piece"
          ],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "Compare",
          "container": "leveldb_comparator_t",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "73-75",
          "snippet": "virtual int Compare(const Slice& a, const Slice& b) const {\n    return (*compare_)(state_, a.data(), a.size(), b.data(), b.size());\n  }",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nleveldb_comparator_t {\n  virtual int Compare(const Slice& a, const Slice& b) const {\n      return (*compare_)(state_, a.data(), a.size(), b.data(), b.size());\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "buffer_.empty",
          "args": [],
          "line": 77
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "BlockBuilder",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block_builder.h",
          "lines": "38-40",
          "snippet": "bool empty() const {\n    return buffer_.empty();\n  }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <vector>\n\nBlockBuilder {\n  bool empty() const {\n      return buffer_.empty();\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "counter_ <= options_->block_restart_interval"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "!finished_"
          ],
          "line": 75
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/comparator.h\"\n#include <assert.h>\n#include <algorithm>\n#include \"table/block_builder.h\"\n\nBlockBuilder {\n  void BlockBuilder::Add(const Slice& key, const Slice& value) {\n    Slice last_key_piece(last_key_);\n    assert(!finished_);\n    assert(counter_ <= options_->block_restart_interval);\n    assert(buffer_.empty() // No values yet?\n           || options_->comparator->Compare(key, last_key_piece) > 0);\n    size_t shared = 0;\n    if (counter_ < options_->block_restart_interval) {\n      // See how much sharing to do with previous string\n      const size_t min_length = std::min(last_key_piece.size(), key.size());\n      while ((shared < min_length) && (last_key_piece[shared] == key[shared])) {\n        shared++;\n      }\n    } else {\n      // Restart compression\n      restarts_.push_back(buffer_.size());\n      counter_ = 0;\n    }\n    const size_t non_shared = key.size() - shared;\n  \n    // Add \"<shared><non_shared><value_size>\" to buffer_\n    PutVarint32(&buffer_, shared);\n    PutVarint32(&buffer_, non_shared);\n    PutVarint32(&buffer_, value.size());\n  \n    // Add string delta to buffer_ followed by value\n    buffer_.append(key.data() + shared, non_shared);\n    buffer_.append(value.data(), value.size());\n  \n    // Update state\n    last_key_.resize(shared);\n    last_key_.append(key.data() + shared, non_shared);\n    assert(Slice(last_key_) == key);\n    counter_++;\n  }\n}"
  },
  {
    "function_name": "Finish",
    "container": "BlockBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block_builder.cc",
    "lines": "63-71",
    "snippet": "Slice BlockBuilder::Finish() {\n  // Append restart array\n  for (size_t i = 0; i < restarts_.size(); i++) {\n    PutFixed32(&buffer_, restarts_[i]);\n  }\n  PutFixed32(&buffer_, restarts_.size());\n  finished_ = true;\n  return Slice(buffer_);\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <assert.h>",
      "#include <algorithm>",
      "#include \"table/block_builder.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "buffer_"
          ],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "HashSlice",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "276-278",
          "snippet": "static inline uint32_t HashSlice(const Slice& s) {\n    return Hash(s.data(), s.size(), 0);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  static inline uint32_t HashSlice(const Slice& s) {\n      return Hash(s.data(), s.size(), 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PutFixed32",
          "args": [
            "&buffer_",
            "restarts_.size()"
          ],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "35-39",
          "snippet": "void PutFixed32(std::string* dst, uint32_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed32(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed32(std::string* dst, uint32_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed32(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "restarts_.size",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/comparator.h\"\n#include <assert.h>\n#include <algorithm>\n#include \"table/block_builder.h\"\n\nBlockBuilder {\n  Slice BlockBuilder::Finish() {\n    // Append restart array\n    for (size_t i = 0; i < restarts_.size(); i++) {\n      PutFixed32(&buffer_, restarts_[i]);\n    }\n    PutFixed32(&buffer_, restarts_.size());\n    finished_ = true;\n    return Slice(buffer_);\n  }\n}"
  },
  {
    "function_name": "CurrentSizeEstimate",
    "container": "BlockBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block_builder.cc",
    "lines": "57-61",
    "snippet": "size_t BlockBuilder::CurrentSizeEstimate() const {\n  return (buffer_.size() +                        // Raw data buffer\n          restarts_.size() * sizeof(uint32_t) +   // Restart array\n          sizeof(uint32_t));                      // Restart array length\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <assert.h>",
      "#include <algorithm>",
      "#include \"table/block_builder.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "restarts_.size",
          "args": [],
          "line": 59
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "BlockHandle",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/format.h",
          "lines": "31-31",
          "snippet": "uint64_t size() const { return size_; }",
          "includes": [
            "#include \"leveldb/table_builder.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <stdint.h>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/table_builder.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/slice.h\"\n#include <stdint.h>\n#include <string>\n\nBlockHandle {\n  uint64_t size() const { return size_; }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/comparator.h\"\n#include <assert.h>\n#include <algorithm>\n#include \"table/block_builder.h\"\n\nBlockBuilder {\n  size_t BlockBuilder::CurrentSizeEstimate() const {\n    return (buffer_.size() +                        // Raw data buffer\n            restarts_.size() * sizeof(uint32_t) +   // Restart array\n            sizeof(uint32_t));                      // Restart array length\n  }\n}"
  },
  {
    "function_name": "Reset",
    "container": "BlockBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block_builder.cc",
    "lines": "48-55",
    "snippet": "void BlockBuilder::Reset() {\n  buffer_.clear();\n  restarts_.clear();\n  restarts_.push_back(0);       // First restart point is at offset 0\n  counter_ = 0;\n  finished_ = false;\n  last_key_.clear();\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <assert.h>",
      "#include <algorithm>",
      "#include \"table/block_builder.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "last_key_.clear",
          "args": [],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "restarts_.push_back",
          "args": [
            "0"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/comparator.h\"\n#include <assert.h>\n#include <algorithm>\n#include \"table/block_builder.h\"\n\nBlockBuilder {\n  void BlockBuilder::Reset() {\n    buffer_.clear();\n    restarts_.clear();\n    restarts_.push_back(0);       // First restart point is at offset 0\n    counter_ = 0;\n    finished_ = false;\n    last_key_.clear();\n  }\n}"
  },
  {
    "function_name": "BlockBuilder",
    "container": "BlockBuilder",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/table/block_builder.cc",
    "lines": "39-46",
    "snippet": "BlockBuilder::BlockBuilder(const Options* options)\n    : options_(options),\n      restarts_(),\n      counter_(0),\n      finished_(false) {\n  assert(options->block_restart_interval >= 1);\n  restarts_.push_back(0);       // First restart point is at offset 0\n}",
    "includes": [
      "#include \"util/coding.h\"",
      "#include \"leveldb/table_builder.h\"",
      "#include \"leveldb/comparator.h\"",
      "#include <assert.h>",
      "#include <algorithm>",
      "#include \"table/block_builder.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "restarts_.push_back",
          "args": [
            "0"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "options->block_restart_interval >= 1"
          ],
          "line": 44
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/coding.h\"\n#include \"leveldb/table_builder.h\"\n#include \"leveldb/comparator.h\"\n#include <assert.h>\n#include <algorithm>\n#include \"table/block_builder.h\"\n\nBlockBuilder {\n  BlockBuilder::BlockBuilder(const Options* options)\n      : options_(options),\n        restarts_(),\n        counter_(0),\n        finished_(false) {\n    assert(options->block_restart_interval >= 1);\n    restarts_.push_back(0);       // First restart point is at offset 0\n  }\n}"
  }
]