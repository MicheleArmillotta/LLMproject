[
  {
    "function_name": "Raw",
    "container": "CPubKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "96-98",
    "snippet": "std::vector<unsigned char> Raw() const {\n        return vchPubKey;\n    }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  std::vector<unsigned char> Raw() const {\n          return vchPubKey;\n      }\n}"
  },
  {
    "function_name": "IsCompressed",
    "container": "CPubKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "92-94",
    "snippet": "bool IsCompressed() const {\n        return vchPubKey.size() == 33;\n    }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchPubKey.size",
          "args": [],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  bool IsCompressed() const {\n          return vchPubKey.size() == 33;\n      }\n}"
  },
  {
    "function_name": "IsValid",
    "container": "CPubKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "88-90",
    "snippet": "bool IsValid() const {\n        return vchPubKey.size() == 33 || vchPubKey.size() == 65;\n    }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "vchPubKey.size",
          "args": [],
          "line": 89
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  bool IsValid() const {\n          return vchPubKey.size() == 33 || vchPubKey.size() == 65;\n      }\n}"
  },
  {
    "function_name": "GetHash",
    "container": "CPubKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "84-86",
    "snippet": "uint256 GetHash() const {\n        return Hash(vchPubKey.begin(), vchPubKey.end());\n    }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Hash",
          "args": [
            "vchPubKey.begin()",
            "vchPubKey.end()"
          ],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "Hash",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "34-38",
          "snippet": "inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n{\n    // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n    return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  inline unsigned int CBloomFilter::Hash(unsigned int nHashNum, const std::vector<unsigned char>& vDataToHash) const\n  {\n      // 0xFBA4C795 chosen as it guarantees a reasonable bit difference between nHashNum values.\n      return MurmurHash3(nHashNum * 0xFBA4C795 + nTweak, vDataToHash) % (vData.size() * 8);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchPubKey.end",
          "args": [],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "vchPubKey.begin",
          "args": [],
          "line": 85
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  uint256 GetHash() const {\n          return Hash(vchPubKey.begin(), vchPubKey.end());\n      }\n}"
  },
  {
    "function_name": "GetID",
    "container": "CPubKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "80-82",
    "snippet": "CKeyID GetID() const {\n        return CKeyID(Hash160(vchPubKey));\n    }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "CKeyID",
          "args": [
            "Hash160(vchPubKey)"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "CKeyID",
          "container": "CKeyID",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
          "lines": "52-52",
          "snippet": "CKeyID(const uint160 &in) : uint160(in) { }",
          "includes": [
            "#include <openssl/ec.h> // for EC_KEY definition",
            "#include \"util.h\"",
            "#include \"uint256.h\"",
            "#include \"serialize.h\"",
            "#include \"allocators.h\"",
            "#include <vector>",
            "#include <stdexcept>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCKeyID {\n  CKeyID(const uint160 &in) : uint160(in) { }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Hash160",
          "args": [
            "vchPubKey"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "Hash160",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/util.h",
          "lines": "554-561",
          "snippet": "inline uint160 Hash160(const std::vector<unsigned char>& vch)\n{\n    uint256 hash1;\n    SHA256(&vch[0], vch.size(), (unsigned char*)&hash1);\n    uint160 hash2;\n    RIPEMD160((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}",
          "includes": [
            "#include <inttypes.h>",
            "#include <stdint.h>",
            "#include \"netbase.h\" // for AddTimeData",
            "#include <openssl/ripemd.h>",
            "#include <openssl/sha.h>",
            "#include <boost/date_time/posix_time/posix_time_types.hpp>",
            "#include <boost/date_time/gregorian/gregorian_types.hpp>",
            "#include <boost/filesystem/path.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/thread.hpp>",
            "#include <string>",
            "#include <vector>",
            "#include <map>",
            "#include <sys/resource.h>",
            "#include <sys/time.h>",
            "#include <sys/types.h>",
            "#include \"uint256.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <inttypes.h>\n#include <stdint.h>\n#include \"netbase.h\" // for AddTimeData\n#include <openssl/ripemd.h>\n#include <openssl/sha.h>\n#include <boost/date_time/posix_time/posix_time_types.hpp>\n#include <boost/date_time/gregorian/gregorian_types.hpp>\n#include <boost/filesystem/path.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/thread.hpp>\n#include <string>\n#include <vector>\n#include <map>\n#include <sys/resource.h>\n#include <sys/time.h>\n#include <sys/types.h>\n#include \"uint256.h\"\n\ninline uint160 Hash160(const std::vector<unsigned char>& vch)\n{\n    uint256 hash1;\n    SHA256(&vch[0], vch.size(), (unsigned char*)&hash1);\n    uint160 hash2;\n    RIPEMD160((unsigned char*)&hash1, sizeof(hash1), (unsigned char*)&hash2);\n    return hash2;\n}"
        }
      }
    ],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  CKeyID GetID() const {\n          return CKeyID(Hash160(vchPubKey));\n      }\n}"
  },
  {
    "function_name": "CPubKey",
    "container": "CPubKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "71-71",
    "snippet": "CPubKey(const std::vector<unsigned char> &vchPubKeyIn) : vchPubKey(vchPubKeyIn) { }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  CPubKey(const std::vector<unsigned char> &vchPubKeyIn) : vchPubKey(vchPubKeyIn) { }\n}"
  },
  {
    "function_name": "CPubKey",
    "container": "CPubKey",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "70-70",
    "snippet": "CPubKey() { }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCPubKey {\n  CPubKey() { }\n}"
  },
  {
    "function_name": "CScriptID",
    "container": "CScriptID",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "60-60",
    "snippet": "CScriptID(const uint160 &in) : uint160(in) { }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCScriptID {\n  CScriptID(const uint160 &in) : uint160(in) { }\n}"
  },
  {
    "function_name": "CScriptID",
    "container": "CScriptID",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "59-59",
    "snippet": "CScriptID() : uint160(0) { }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCScriptID {\n  CScriptID() : uint160(0) { }\n}"
  },
  {
    "function_name": "CKeyID",
    "container": "CKeyID",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "52-52",
    "snippet": "CKeyID(const uint160 &in) : uint160(in) { }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCKeyID {\n  CKeyID(const uint160 &in) : uint160(in) { }\n}"
  },
  {
    "function_name": "CKeyID",
    "container": "CKeyID",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "51-51",
    "snippet": "CKeyID() : uint160(0) { }",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nCKeyID {\n  CKeyID() : uint160(0) { }\n}"
  },
  {
    "function_name": "key_error",
    "container": "key_error",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/key.h",
    "lines": "44-44",
    "snippet": "explicit key_error(const std::string& str) : std::runtime_error(str) {}",
    "includes": [
      "#include <openssl/ec.h> // for EC_KEY definition",
      "#include \"util.h\"",
      "#include \"uint256.h\"",
      "#include \"serialize.h\"",
      "#include \"allocators.h\"",
      "#include <vector>",
      "#include <stdexcept>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <openssl/ec.h> // for EC_KEY definition\n#include \"util.h\"\n#include \"uint256.h\"\n#include \"serialize.h\"\n#include \"allocators.h\"\n#include <vector>\n#include <stdexcept>\n\nkey_error {\n  explicit key_error(const std::string& str) : std::runtime_error(str) {}\n}"
  }
]