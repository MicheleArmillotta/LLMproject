[
  {
    "function_name": "NewWritableFile",
    "container": "ErrorEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.h",
    "lines": "39-47",
    "snippet": "virtual Status NewWritableFile(const std::string& fname,\n                                 WritableFile** result) {\n    if (writable_file_error_) {\n      ++num_writable_file_errors_;\n      *result = NULL;\n      return Status::IOError(fname, \"fake error\");\n    }\n    return target()->NewWritableFile(fname, result);\n  }",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "target",
          "args": [
            "fname",
            "result"
          ],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "target",
          "args": [],
          "line": 46
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "fname",
            "\"fake error\""
          ],
          "line": 44
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n\nErrorEnv {\n  virtual Status NewWritableFile(const std::string& fname,\n                                   WritableFile** result) {\n      if (writable_file_error_) {\n        ++num_writable_file_errors_;\n        *result = NULL;\n        return Status::IOError(fname, \"fake error\");\n      }\n      return target()->NewWritableFile(fname, result);\n    }\n}"
  },
  {
    "function_name": "ErrorEnv",
    "container": "ErrorEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testutil.h",
    "lines": "35-37",
    "snippet": "ErrorEnv() : EnvWrapper(Env::Default()),\n               writable_file_error_(false),\n               num_writable_file_errors_(0) { }",
    "includes": [
      "#include \"util/random.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Env::Default",
          "args": [],
          "line": 35
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/random.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n\nErrorEnv {\n  ErrorEnv() : EnvWrapper(Env::Default()),\n                 writable_file_error_(false),\n                 num_writable_file_errors_(0) { }\n}"
  }
]