[
  {
    "function_name": "main",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "194-196",
    "snippet": "int main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "leveldb::test::RunAllTests",
          "args": [],
          "line": 195
        },
        "resolved": true,
        "details": {
          "function_name": "RunAllTests",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/testharness.cc",
          "lines": "36-58",
          "snippet": "int RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}",
          "includes": [
            "#include <sys/types.h>",
            "#include <sys/stat.h>",
            "#include <stdlib.h>",
            "#include <string>",
            "#include \"util/testharness.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <sys/types.h>\n#include <sys/stat.h>\n#include <stdlib.h>\n#include <string>\n#include \"util/testharness.h\"\n\nint RunAllTests() {\n  const char* matcher = getenv(\"LEVELDB_TESTS\");\n\n  int num = 0;\n  if (tests != NULL) {\n    for (size_t i = 0; i < tests->size(); i++) {\n      const Test& t = (*tests)[i];\n      if (matcher != NULL) {\n        std::string name = t.base;\n        name.push_back('.');\n        name.append(t.name);\n        if (strstr(name.c_str(), matcher) == NULL) {\n          continue;\n        }\n      }\n      fprintf(stderr, \"==== Test %s.%s\\n\", t.base, t.name);\n      (*t.func)();\n      ++num;\n    }\n  }\n  fprintf(stderr, \"==== PASSED %d tests\\n\", num);\n  return 0;\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nint main(int argc, char** argv) {\n  return leveldb::test::RunAllTests();\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "172-190",
    "snippet": "TEST(Coding, Strings) {\n  std::string s;\n  PutLengthPrefixedSlice(&s, Slice(\"\"));\n  PutLengthPrefixedSlice(&s, Slice(\"foo\"));\n  PutLengthPrefixedSlice(&s, Slice(\"bar\"));\n  PutLengthPrefixedSlice(&s, Slice(std::string(200, 'x')));\n\n  Slice input(s);\n  Slice v;\n  ASSERT_TRUE(GetLengthPrefixedSlice(&input, &v));\n  ASSERT_EQ(\"\", v.ToString());\n  ASSERT_TRUE(GetLengthPrefixedSlice(&input, &v));\n  ASSERT_EQ(\"foo\", v.ToString());\n  ASSERT_TRUE(GetLengthPrefixedSlice(&input, &v));\n  ASSERT_EQ(\"bar\", v.ToString());\n  ASSERT_TRUE(GetLengthPrefixedSlice(&input, &v));\n  ASSERT_EQ(std::string(200, 'x'), v.ToString());\n  ASSERT_EQ(\"\", input.ToString());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"\"",
            "input.ToString()"
          ],
          "line": 189
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.ToString",
          "args": [],
          "line": 189
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Histogram",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/histogram.cc",
          "lines": "105-137",
          "snippet": "std::string Histogram::ToString() const {\n  std::string r;\n  char buf[200];\n  snprintf(buf, sizeof(buf),\n           \"Count: %.0f  Average: %.4f  StdDev: %.2f\\n\",\n           num_, Average(), StandardDeviation());\n  r.append(buf);\n  snprintf(buf, sizeof(buf),\n           \"Min: %.4f  Median: %.4f  Max: %.4f\\n\",\n           (num_ == 0.0 ? 0.0 : min_), Median(), max_);\n  r.append(buf);\n  r.append(\"------------------------------------------------------\\n\");\n  const double mult = 100.0 / num_;\n  double sum = 0;\n  for (int b = 0; b < kNumBuckets; b++) {\n    if (buckets_[b] <= 0.0) continue;\n    sum += buckets_[b];\n    snprintf(buf, sizeof(buf),\n             \"[ %7.0f, %7.0f ) %7.0f %7.3f%% %7.3f%% \",\n             ((b == 0) ? 0.0 : kBucketLimit[b-1]),      // left\n             kBucketLimit[b],                           // right\n             buckets_[b],                               // count\n             mult * buckets_[b],                        // percentage\n             mult * sum);                               // cumulative percentage\n    r.append(buf);\n\n    // Add hash marks based on percentage; 20 marks for 100%.\n    int marks = static_cast<int>(20*(buckets_[b] / num_) + 0.5);\n    r.append(marks, '#');\n    r.push_back('\\n');\n  }\n  return r;\n}",
          "includes": [
            "#include \"util/histogram.h\"",
            "#include \"port/port.h\"",
            "#include <stdio.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/histogram.h\"\n#include \"port/port.h\"\n#include <stdio.h>\n#include <math.h>\n\nHistogram {\n  std::string Histogram::ToString() const {\n    std::string r;\n    char buf[200];\n    snprintf(buf, sizeof(buf),\n             \"Count: %.0f  Average: %.4f  StdDev: %.2f\\n\",\n             num_, Average(), StandardDeviation());\n    r.append(buf);\n    snprintf(buf, sizeof(buf),\n             \"Min: %.4f  Median: %.4f  Max: %.4f\\n\",\n             (num_ == 0.0 ? 0.0 : min_), Median(), max_);\n    r.append(buf);\n    r.append(\"------------------------------------------------------\\n\");\n    const double mult = 100.0 / num_;\n    double sum = 0;\n    for (int b = 0; b < kNumBuckets; b++) {\n      if (buckets_[b] <= 0.0) continue;\n      sum += buckets_[b];\n      snprintf(buf, sizeof(buf),\n               \"[ %7.0f, %7.0f ) %7.0f %7.3f%% %7.3f%% \",\n               ((b == 0) ? 0.0 : kBucketLimit[b-1]),      // left\n               kBucketLimit[b],                           // right\n               buckets_[b],                               // count\n               mult * buckets_[b],                        // percentage\n               mult * sum);                               // cumulative percentage\n      r.append(buf);\n  \n      // Add hash marks based on percentage; 20 marks for 100%.\n      int marks = static_cast<int>(20*(buckets_[b] / num_) + 0.5);\n      r.append(marks, '#');\n      r.push_back('\\n');\n    }\n    return r;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "std::string(200, 'x')",
            "v.ToString()"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "v.ToString",
          "args": [],
          "line": 188
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "CService",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/netbase.cpp",
          "lines": "1172-1175",
          "snippet": "std::string CService::ToString() const\n{\n    return ToStringIPPort();\n}",
          "includes": [
            "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()",
            "#include \"strlcpy.h\"",
            "#include <sys/fcntl.h>",
            "#include \"sync.h\"",
            "#include \"util.h\"",
            "#include \"netbase.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/algorithm/string/case_conv.hpp> // for to_lower()\n#include \"strlcpy.h\"\n#include <sys/fcntl.h>\n#include \"sync.h\"\n#include \"util.h\"\n#include \"netbase.h\"\n\nCService {\n  std::string CService::ToString() const\n  {\n      return ToStringIPPort();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "200",
            "'x'"
          ],
          "line": 188
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetLengthPrefixedSlice(&input, &v)"
          ],
          "line": 187
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetLengthPrefixedSlice",
          "args": [
            "&input",
            "&v"
          ],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"bar\"",
            "v.ToString()"
          ],
          "line": 186
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetLengthPrefixedSlice(&input, &v)"
          ],
          "line": 185
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"foo\"",
            "v.ToString()"
          ],
          "line": 184
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetLengthPrefixedSlice(&input, &v)"
          ],
          "line": 183
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "\"\"",
            "v.ToString()"
          ],
          "line": 182
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetLengthPrefixedSlice(&input, &v)"
          ],
          "line": 181
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutLengthPrefixedSlice",
          "args": [
            "&s",
            "Slice(std::string(200, 'x'))"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "PutLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "98-101",
          "snippet": "void PutLengthPrefixedSlice(std::string* dst, const Slice& value) {\n  PutVarint32(dst, value.size());\n  dst->append(value.data(), value.size());\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutLengthPrefixedSlice(std::string* dst, const Slice& value) {\n  PutVarint32(dst, value.size());\n  dst->append(value.data(), value.size());\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "std::string(200, 'x')"
          ],
          "line": 177
        },
        "resolved": true,
        "details": {
          "function_name": "HashSlice",
          "container": "ShardedLRUCache",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/cache.cc",
          "lines": "276-278",
          "snippet": "static inline uint32_t HashSlice(const Slice& s) {\n    return Hash(s.data(), s.size(), 0);\n  }",
          "includes": [
            "#include \"util/mutexlock.h\"",
            "#include \"util/hash.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/mutexlock.h\"\n#include \"util/hash.h\"\n#include \"port/port.h\"\n#include \"leveldb/cache.h\"\n#include <stdlib.h>\n#include <stdio.h>\n#include <assert.h>\n\nShardedLRUCache {\n  static inline uint32_t HashSlice(const Slice& s) {\n      return Hash(s.data(), s.size(), 0);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "200",
            "'x'"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Strings) {\n  std::string s;\n  PutLengthPrefixedSlice(&s, Slice(\"\"));\n  PutLengthPrefixedSlice(&s, Slice(\"foo\"));\n  PutLengthPrefixedSlice(&s, Slice(\"bar\"));\n  PutLengthPrefixedSlice(&s, Slice(std::string(200, 'x')));\n\n  Slice input(s);\n  Slice v;\n  ASSERT_TRUE(GetLengthPrefixedSlice(&input, &v));\n  ASSERT_EQ(\"\", v.ToString());\n  ASSERT_TRUE(GetLengthPrefixedSlice(&input, &v));\n  ASSERT_EQ(\"foo\", v.ToString());\n  ASSERT_TRUE(GetLengthPrefixedSlice(&input, &v));\n  ASSERT_EQ(\"bar\", v.ToString());\n  ASSERT_TRUE(GetLengthPrefixedSlice(&input, &v));\n  ASSERT_EQ(std::string(200, 'x'), v.ToString());\n  ASSERT_EQ(\"\", input.ToString());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "160-170",
    "snippet": "TEST(Coding, Varint64Truncation) {\n  uint64_t large_value = (1ull << 63) + 100ull;\n  std::string s;\n  PutVarint64(&s, large_value);\n  uint64_t result;\n  for (size_t len = 0; len < s.size() - 1; len++) {\n    ASSERT_TRUE(GetVarint64Ptr(s.data(), s.data() + len, &result) == NULL);\n  }\n  ASSERT_TRUE(GetVarint64Ptr(s.data(), s.data() + s.size(), &result) != NULL);\n  ASSERT_EQ(large_value, result);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "large_value",
            "result"
          ],
          "line": 169
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetVarint64Ptr(s.data(), s.data() + s.size(), &result) != NULL"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetVarint64Ptr",
          "args": [
            "s.data()",
            "s.data() + s.size()",
            "&result"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.size",
          "args": [],
          "line": 168
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetVarint64Ptr(s.data(), s.data() + len, &result) == NULL"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetVarint64Ptr",
          "args": [
            "s.data()",
            "s.data() + len",
            "&result"
          ],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 166
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutVarint64",
          "args": [
            "&s",
            "large_value"
          ],
          "line": 163
        },
        "resolved": true,
        "details": {
          "function_name": "PutVarint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "92-96",
          "snippet": "void PutVarint64(std::string* dst, uint64_t v) {\n  char buf[10];\n  char* ptr = EncodeVarint64(buf, v);\n  dst->append(buf, ptr - buf);\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutVarint64(std::string* dst, uint64_t v) {\n  char buf[10];\n  char* ptr = EncodeVarint64(buf, v);\n  dst->append(buf, ptr - buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Varint64Truncation) {\n  uint64_t large_value = (1ull << 63) + 100ull;\n  std::string s;\n  PutVarint64(&s, large_value);\n  uint64_t result;\n  for (size_t len = 0; len < s.size() - 1; len++) {\n    ASSERT_TRUE(GetVarint64Ptr(s.data(), s.data() + len, &result) == NULL);\n  }\n  ASSERT_TRUE(GetVarint64Ptr(s.data(), s.data() + s.size(), &result) != NULL);\n  ASSERT_EQ(large_value, result);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "153-158",
    "snippet": "TEST(Coding, Varint64Overflow) {\n  uint64_t result;\n  std::string input(\"\\x81\\x82\\x83\\x84\\x85\\x81\\x82\\x83\\x84\\x85\\x11\");\n  ASSERT_TRUE(GetVarint64Ptr(input.data(), input.data() + input.size(), &result)\n              == NULL);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetVarint64Ptr(input.data(), input.data() + input.size(), &result)\n              == NULL"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetVarint64Ptr",
          "args": [
            "input.data()",
            "input.data() + input.size()",
            "&result"
          ],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.size",
          "args": [],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.data",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.data",
          "args": [],
          "line": 156
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Varint64Overflow) {\n  uint64_t result;\n  std::string input(\"\\x81\\x82\\x83\\x84\\x85\\x81\\x82\\x83\\x84\\x85\\x11\");\n  ASSERT_TRUE(GetVarint64Ptr(input.data(), input.data() + input.size(), &result)\n              == NULL);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "141-151",
    "snippet": "TEST(Coding, Varint32Truncation) {\n  uint32_t large_value = (1u << 31) + 100;\n  std::string s;\n  PutVarint32(&s, large_value);\n  uint32_t result;\n  for (size_t len = 0; len < s.size() - 1; len++) {\n    ASSERT_TRUE(GetVarint32Ptr(s.data(), s.data() + len, &result) == NULL);\n  }\n  ASSERT_TRUE(GetVarint32Ptr(s.data(), s.data() + s.size(), &result) != NULL);\n  ASSERT_EQ(large_value, result);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "large_value",
            "result"
          ],
          "line": 150
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetVarint32Ptr(s.data(), s.data() + s.size(), &result) != NULL"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetVarint32Ptr",
          "args": [
            "s.data()",
            "s.data() + s.size()",
            "&result"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.size",
          "args": [],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetVarint32Ptr(s.data(), s.data() + len, &result) == NULL"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetVarint32Ptr",
          "args": [
            "s.data()",
            "s.data() + len",
            "&result"
          ],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 147
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutVarint32",
          "args": [
            "&s",
            "large_value"
          ],
          "line": 144
        },
        "resolved": true,
        "details": {
          "function_name": "PutVarint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "75-79",
          "snippet": "void PutVarint32(std::string* dst, uint32_t v) {\n  char buf[5];\n  char* ptr = EncodeVarint32(buf, v);\n  dst->append(buf, ptr - buf);\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutVarint32(std::string* dst, uint32_t v) {\n  char buf[5];\n  char* ptr = EncodeVarint32(buf, v);\n  dst->append(buf, ptr - buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Varint32Truncation) {\n  uint32_t large_value = (1u << 31) + 100;\n  std::string s;\n  PutVarint32(&s, large_value);\n  uint32_t result;\n  for (size_t len = 0; len < s.size() - 1; len++) {\n    ASSERT_TRUE(GetVarint32Ptr(s.data(), s.data() + len, &result) == NULL);\n  }\n  ASSERT_TRUE(GetVarint32Ptr(s.data(), s.data() + s.size(), &result) != NULL);\n  ASSERT_EQ(large_value, result);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "134-139",
    "snippet": "TEST(Coding, Varint32Overflow) {\n  uint32_t result;\n  std::string input(\"\\x81\\x82\\x83\\x84\\x85\\x11\");\n  ASSERT_TRUE(GetVarint32Ptr(input.data(), input.data() + input.size(), &result)\n              == NULL);\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "GetVarint32Ptr(input.data(), input.data() + input.size(), &result)\n              == NULL"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetVarint32Ptr",
          "args": [
            "input.data()",
            "input.data() + input.size()",
            "&result"
          ],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.size",
          "args": [],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "input.data",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "input.data",
          "args": [],
          "line": 137
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Varint32Overflow) {\n  uint32_t result;\n  std::string input(\"\\x81\\x82\\x83\\x84\\x85\\x11\");\n  ASSERT_TRUE(GetVarint32Ptr(input.data(), input.data() + input.size(), &result)\n              == NULL);\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "98-132",
    "snippet": "TEST(Coding, Varint64) {\n  // Construct the list of values to check\n  std::vector<uint64_t> values;\n  // Some special values\n  values.push_back(0);\n  values.push_back(100);\n  values.push_back(~static_cast<uint64_t>(0));\n  values.push_back(~static_cast<uint64_t>(0) - 1);\n  for (uint32_t k = 0; k < 64; k++) {\n    // Test values near powers of two\n    const uint64_t power = 1ull << k;\n    values.push_back(power);\n    values.push_back(power-1);\n    values.push_back(power+1);\n  }\n\n  std::string s;\n  for (size_t i = 0; i < values.size(); i++) {\n    PutVarint64(&s, values[i]);\n  }\n\n  const char* p = s.data();\n  const char* limit = p + s.size();\n  for (size_t i = 0; i < values.size(); i++) {\n    ASSERT_TRUE(p < limit);\n    uint64_t actual;\n    const char* start = p;\n    p = GetVarint64Ptr(p, limit, &actual);\n    ASSERT_TRUE(p != NULL);\n    ASSERT_EQ(values[i], actual);\n    ASSERT_EQ(VarintLength(actual), p - start);\n  }\n  ASSERT_EQ(p, limit);\n\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "p",
            "limit"
          ],
          "line": 130
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "VarintLength(actual)",
            "p - start"
          ],
          "line": 128
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VarintLength",
          "args": [
            "actual"
          ],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "VarintLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "103-110",
          "snippet": "int VarintLength(uint64_t v) {\n  int len = 1;\n  while (v >= 128) {\n    v >>= 7;\n    len++;\n  }\n  return len;\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nint VarintLength(uint64_t v) {\n  int len = 1;\n  while (v >= 128) {\n    v >>= 7;\n    len++;\n  }\n  return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "values[i]",
            "actual"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "p != NULL"
          ],
          "line": 126
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetVarint64Ptr",
          "args": [
            "p",
            "limit",
            "&actual"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "p < limit"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "values.size",
          "args": [],
          "line": 121
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 119
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutVarint64",
          "args": [
            "&s",
            "values[i]"
          ],
          "line": 116
        },
        "resolved": true,
        "details": {
          "function_name": "PutVarint64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "92-96",
          "snippet": "void PutVarint64(std::string* dst, uint64_t v) {\n  char buf[10];\n  char* ptr = EncodeVarint64(buf, v);\n  dst->append(buf, ptr - buf);\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutVarint64(std::string* dst, uint64_t v) {\n  char buf[10];\n  char* ptr = EncodeVarint64(buf, v);\n  dst->append(buf, ptr - buf);\n}"
        }
      },
      {
        "call_info": {
          "callee": "values.push_back",
          "args": [
            "power+1"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "values.push_back",
          "args": [
            "power-1"
          ],
          "line": 110
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "values.push_back",
          "args": [
            "power"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "values.push_back",
          "args": [
            "~static_cast<uint64_t>(0) - 1"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "0"
          ],
          "line": 105
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "values.push_back",
          "args": [
            "~static_cast<uint64_t>(0)"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "0"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "values.push_back",
          "args": [
            "100"
          ],
          "line": 103
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "values.push_back",
          "args": [
            "0"
          ],
          "line": 102
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Varint64) {\n  // Construct the list of values to check\n  std::vector<uint64_t> values;\n  // Some special values\n  values.push_back(0);\n  values.push_back(100);\n  values.push_back(~static_cast<uint64_t>(0));\n  values.push_back(~static_cast<uint64_t>(0) - 1);\n  for (uint32_t k = 0; k < 64; k++) {\n    // Test values near powers of two\n    const uint64_t power = 1ull << k;\n    values.push_back(power);\n    values.push_back(power-1);\n    values.push_back(power+1);\n  }\n\n  std::string s;\n  for (size_t i = 0; i < values.size(); i++) {\n    PutVarint64(&s, values[i]);\n  }\n\n  const char* p = s.data();\n  const char* limit = p + s.size();\n  for (size_t i = 0; i < values.size(); i++) {\n    ASSERT_TRUE(p < limit);\n    uint64_t actual;\n    const char* start = p;\n    p = GetVarint64Ptr(p, limit, &actual);\n    ASSERT_TRUE(p != NULL);\n    ASSERT_EQ(values[i], actual);\n    ASSERT_EQ(VarintLength(actual), p - start);\n  }\n  ASSERT_EQ(p, limit);\n\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "77-96",
    "snippet": "TEST(Coding, Varint32) {\n  std::string s;\n  for (uint32_t i = 0; i < (32 * 32); i++) {\n    uint32_t v = (i / 32) << (i % 32);\n    PutVarint32(&s, v);\n  }\n\n  const char* p = s.data();\n  const char* limit = p + s.size();\n  for (uint32_t i = 0; i < (32 * 32); i++) {\n    uint32_t expected = (i / 32) << (i % 32);\n    uint32_t actual;\n    const char* start = p;\n    p = GetVarint32Ptr(p, limit, &actual);\n    ASSERT_TRUE(p != NULL);\n    ASSERT_EQ(expected, actual);\n    ASSERT_EQ(VarintLength(actual), p - start);\n  }\n  ASSERT_EQ(p, s.data() + s.size());\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "p",
            "s.data() + s.size()"
          ],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.size",
          "args": [],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 95
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "VarintLength(actual)",
            "p - start"
          ],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "VarintLength",
          "args": [
            "actual"
          ],
          "line": 93
        },
        "resolved": true,
        "details": {
          "function_name": "VarintLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "103-110",
          "snippet": "int VarintLength(uint64_t v) {\n  int len = 1;\n  while (v >= 128) {\n    v >>= 7;\n    len++;\n  }\n  return len;\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nint VarintLength(uint64_t v) {\n  int len = 1;\n  while (v >= 128) {\n    v >>= 7;\n    len++;\n  }\n  return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "expected",
            "actual"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_TRUE",
          "args": [
            "p != NULL"
          ],
          "line": 91
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetVarint32Ptr",
          "args": [
            "p",
            "limit",
            "&actual"
          ],
          "line": 90
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 84
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutVarint32",
          "args": [
            "&s",
            "v"
          ],
          "line": 81
        },
        "resolved": true,
        "details": {
          "function_name": "PutVarint32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "75-79",
          "snippet": "void PutVarint32(std::string* dst, uint32_t v) {\n  char buf[5];\n  char* ptr = EncodeVarint32(buf, v);\n  dst->append(buf, ptr - buf);\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutVarint32(std::string* dst, uint32_t v) {\n  char buf[5];\n  char* ptr = EncodeVarint32(buf, v);\n  dst->append(buf, ptr - buf);\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Varint32) {\n  std::string s;\n  for (uint32_t i = 0; i < (32 * 32); i++) {\n    uint32_t v = (i / 32) << (i % 32);\n    PutVarint32(&s, v);\n  }\n\n  const char* p = s.data();\n  const char* limit = p + s.size();\n  for (uint32_t i = 0; i < (32 * 32); i++) {\n    uint32_t expected = (i / 32) << (i % 32);\n    uint32_t actual;\n    const char* start = p;\n    p = GetVarint32Ptr(p, limit, &actual);\n    ASSERT_TRUE(p != NULL);\n    ASSERT_EQ(expected, actual);\n    ASSERT_EQ(VarintLength(actual), p - start);\n  }\n  ASSERT_EQ(p, s.data() + s.size());\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "55-75",
    "snippet": "TEST(Coding, EncodingOutput) {\n  std::string dst;\n  PutFixed32(&dst, 0x04030201);\n  ASSERT_EQ(4, dst.size());\n  ASSERT_EQ(0x01, static_cast<int>(dst[0]));\n  ASSERT_EQ(0x02, static_cast<int>(dst[1]));\n  ASSERT_EQ(0x03, static_cast<int>(dst[2]));\n  ASSERT_EQ(0x04, static_cast<int>(dst[3]));\n\n  dst.clear();\n  PutFixed64(&dst, 0x0807060504030201ull);\n  ASSERT_EQ(8, dst.size());\n  ASSERT_EQ(0x01, static_cast<int>(dst[0]));\n  ASSERT_EQ(0x02, static_cast<int>(dst[1]));\n  ASSERT_EQ(0x03, static_cast<int>(dst[2]));\n  ASSERT_EQ(0x04, static_cast<int>(dst[3]));\n  ASSERT_EQ(0x05, static_cast<int>(dst[4]));\n  ASSERT_EQ(0x06, static_cast<int>(dst[5]));\n  ASSERT_EQ(0x07, static_cast<int>(dst[6]));\n  ASSERT_EQ(0x08, static_cast<int>(dst[7]));\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x08",
            "static_cast<int>(dst[7])"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[7]"
          ],
          "line": 74
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x07",
            "static_cast<int>(dst[6])"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[6]"
          ],
          "line": 73
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x06",
            "static_cast<int>(dst[5])"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[5]"
          ],
          "line": 72
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x05",
            "static_cast<int>(dst[4])"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[4]"
          ],
          "line": 71
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x04",
            "static_cast<int>(dst[3])"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[3]"
          ],
          "line": 70
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x03",
            "static_cast<int>(dst[2])"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[2]"
          ],
          "line": 69
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x02",
            "static_cast<int>(dst[1])"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[1]"
          ],
          "line": 68
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x01",
            "static_cast<int>(dst[0])"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[0]"
          ],
          "line": 67
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "8",
            "dst.size()"
          ],
          "line": 66
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dst.size",
          "args": [],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "PutFixed64",
          "args": [
            "&dst",
            "0x0807060504030201ull"
          ],
          "line": 65
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "41-45",
          "snippet": "void PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "dst.clear",
          "args": [],
          "line": 64
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x04",
            "static_cast<int>(dst[3])"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[3]"
          ],
          "line": 62
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x03",
            "static_cast<int>(dst[2])"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[2]"
          ],
          "line": 61
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x02",
            "static_cast<int>(dst[1])"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[1]"
          ],
          "line": 60
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "0x01",
            "static_cast<int>(dst[0])"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<int>",
          "args": [
            "dst[0]"
          ],
          "line": 59
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "4",
            "dst.size()"
          ],
          "line": 58
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutFixed32",
          "args": [
            "&dst",
            "0x04030201"
          ],
          "line": 57
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "35-39",
          "snippet": "void PutFixed32(std::string* dst, uint32_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed32(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed32(std::string* dst, uint32_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed32(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, EncodingOutput) {\n  std::string dst;\n  PutFixed32(&dst, 0x04030201);\n  ASSERT_EQ(4, dst.size());\n  ASSERT_EQ(0x01, static_cast<int>(dst[0]));\n  ASSERT_EQ(0x02, static_cast<int>(dst[1]));\n  ASSERT_EQ(0x03, static_cast<int>(dst[2]));\n  ASSERT_EQ(0x04, static_cast<int>(dst[3]));\n\n  dst.clear();\n  PutFixed64(&dst, 0x0807060504030201ull);\n  ASSERT_EQ(8, dst.size());\n  ASSERT_EQ(0x01, static_cast<int>(dst[0]));\n  ASSERT_EQ(0x02, static_cast<int>(dst[1]));\n  ASSERT_EQ(0x03, static_cast<int>(dst[2]));\n  ASSERT_EQ(0x04, static_cast<int>(dst[3]));\n  ASSERT_EQ(0x05, static_cast<int>(dst[4]));\n  ASSERT_EQ(0x06, static_cast<int>(dst[5]));\n  ASSERT_EQ(0x07, static_cast<int>(dst[6]));\n  ASSERT_EQ(0x08, static_cast<int>(dst[7]));\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "27-52",
    "snippet": "TEST(Coding, Fixed64) {\n  std::string s;\n  for (int power = 0; power <= 63; power++) {\n    uint64_t v = static_cast<uint64_t>(1) << power;\n    PutFixed64(&s, v - 1);\n    PutFixed64(&s, v + 0);\n    PutFixed64(&s, v + 1);\n  }\n\n  const char* p = s.data();\n  for (int power = 0; power <= 63; power++) {\n    uint64_t v = static_cast<uint64_t>(1) << power;\n    uint64_t actual;\n    actual = DecodeFixed64(p);\n    ASSERT_EQ(v-1, actual);\n    p += sizeof(uint64_t);\n\n    actual = DecodeFixed64(p);\n    ASSERT_EQ(v+0, actual);\n    p += sizeof(uint64_t);\n\n    actual = DecodeFixed64(p);\n    ASSERT_EQ(v+1, actual);\n    p += sizeof(uint64_t);\n  }\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "v+1",
            "actual"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DecodeFixed64",
          "args": [
            "p"
          ],
          "line": 48
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.h",
          "lines": "72-83",
          "snippet": "inline uint64_t DecodeFixed64(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint64_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    uint64_t lo = DecodeFixed32(ptr);\n    uint64_t hi = DecodeFixed32(ptr + 4);\n    return (hi << 32) | lo;\n  }\n}",
          "includes": [
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <string>",
            "#include <string.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include <string>\n#include <string.h>\n#include <stdint.h>\n\ninline uint64_t DecodeFixed64(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint64_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    uint64_t lo = DecodeFixed32(ptr);\n    uint64_t hi = DecodeFixed32(ptr + 4);\n    return (hi << 32) | lo;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "v+0",
            "actual"
          ],
          "line": 45
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "v-1",
            "actual"
          ],
          "line": 41
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "1"
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutFixed64",
          "args": [
            "&s",
            "v + 1"
          ],
          "line": 33
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed64",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "41-45",
          "snippet": "void PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed64(std::string* dst, uint64_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed64(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      },
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "1"
          ],
          "line": 30
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Fixed64) {\n  std::string s;\n  for (int power = 0; power <= 63; power++) {\n    uint64_t v = static_cast<uint64_t>(1) << power;\n    PutFixed64(&s, v - 1);\n    PutFixed64(&s, v + 0);\n    PutFixed64(&s, v + 1);\n  }\n\n  const char* p = s.data();\n  for (int power = 0; power <= 63; power++) {\n    uint64_t v = static_cast<uint64_t>(1) << power;\n    uint64_t actual;\n    actual = DecodeFixed64(p);\n    ASSERT_EQ(v-1, actual);\n    p += sizeof(uint64_t);\n\n    actual = DecodeFixed64(p);\n    ASSERT_EQ(v+0, actual);\n    p += sizeof(uint64_t);\n\n    actual = DecodeFixed64(p);\n    ASSERT_EQ(v+1, actual);\n    p += sizeof(uint64_t);\n  }\n}"
  },
  {
    "function_name": "TEST",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding_test.cc",
    "lines": "13-25",
    "snippet": "TEST(Coding, Fixed32) {\n  std::string s;\n  for (uint32_t v = 0; v < 100000; v++) {\n    PutFixed32(&s, v);\n  }\n\n  const char* p = s.data();\n  for (uint32_t v = 0; v < 100000; v++) {\n    uint32_t actual = DecodeFixed32(p);\n    ASSERT_EQ(v, actual);\n    p += sizeof(uint32_t);\n  }\n}",
    "includes": [
      "#include \"util/testharness.h\"",
      "#include \"util/coding.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ASSERT_EQ",
          "args": [
            "v",
            "actual"
          ],
          "line": 22
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "DecodeFixed32",
          "args": [
            "p"
          ],
          "line": 21
        },
        "resolved": true,
        "details": {
          "function_name": "DecodeFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.h",
          "lines": "58-70",
          "snippet": "inline uint32_t DecodeFixed32(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint32_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    return ((static_cast<uint32_t>(static_cast<unsigned char>(ptr[0])))\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[1])) << 8)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[2])) << 16)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[3])) << 24));\n  }\n}",
          "includes": [
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include <string>",
            "#include <string.h>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include <string>\n#include <string.h>\n#include <stdint.h>\n\ninline uint32_t DecodeFixed32(const char* ptr) {\n  if (port::kLittleEndian) {\n    // Load the raw bytes\n    uint32_t result;\n    memcpy(&result, ptr, sizeof(result));  // gcc optimizes this to a plain load\n    return result;\n  } else {\n    return ((static_cast<uint32_t>(static_cast<unsigned char>(ptr[0])))\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[1])) << 8)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[2])) << 16)\n        | (static_cast<uint32_t>(static_cast<unsigned char>(ptr[3])) << 24));\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.data",
          "args": [],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PutFixed32",
          "args": [
            "&s",
            "v"
          ],
          "line": 16
        },
        "resolved": true,
        "details": {
          "function_name": "PutFixed32",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "35-39",
          "snippet": "void PutFixed32(std::string* dst, uint32_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed32(buf, value);\n  dst->append(buf, sizeof(buf));\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nvoid PutFixed32(std::string* dst, uint32_t value) {\n  char buf[sizeof(value)];\n  EncodeFixed32(buf, value);\n  dst->append(buf, sizeof(buf));\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/testharness.h\"\n#include \"util/coding.h\"\n\nTEST(Coding, Fixed32) {\n  std::string s;\n  for (uint32_t v = 0; v < 100000; v++) {\n    PutFixed32(&s, v);\n  }\n\n  const char* p = s.data();\n  for (uint32_t v = 0; v < 100000; v++) {\n    uint32_t actual = DecodeFixed32(p);\n    ASSERT_EQ(v, actual);\n    p += sizeof(uint32_t);\n  }\n}"
  }
]