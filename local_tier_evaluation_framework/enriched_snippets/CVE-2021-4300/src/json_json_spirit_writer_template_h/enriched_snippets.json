[
  {
    "function_name": "write_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "234-243",
    "snippet": "typename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "os.str",
          "args": [],
          "line": 242
        },
        "resolved": true,
        "details": {
          "function_name": "str",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "789-792",
          "snippet": "std::string str() const\n    {\n        return (std::string(begin(), end()));\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  std::string str() const\n      {\n          return (std::string(begin(), end()));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "write_stream",
          "args": [
            "value",
            "os",
            "pretty"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "write_stream",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "228-231",
          "snippet": "void write_stream( const Value_type& value, Ostream_type& os, bool pretty )\n    {\n        Generator< Value_type, Ostream_type >( value, os, pretty );\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nvoid write_stream( const Value_type& value, Ostream_type& os, bool pretty )\n    {\n        Generator< Value_type, Ostream_type >( value, os, pretty );\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\ntypename Value_type::String_type write_string( const Value_type& value, bool pretty )\n    {\n        typedef typename Value_type::String_type::value_type Char_type;\n\n        std::basic_ostringstream< Char_type > os;\n\n        write_stream( value, os, pretty );\n\n        return os.str();\n    }"
  },
  {
    "function_name": "write_stream",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "228-231",
    "snippet": "void write_stream( const Value_type& value, Ostream_type& os, bool pretty )\n    {\n        Generator< Value_type, Ostream_type >( value, os, pretty );\n    }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Generator< Value_type, Ostream_type >",
          "args": [
            "value",
            "os",
            "pretty"
          ],
          "line": 230
        },
        "resolved": true,
        "details": {
          "function_name": "output_array_or_obj",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "175-198",
          "snippet": "void output_array_or_obj( const T& t, Char_type start_char, Char_type end_char )\n        {\n            os_ << start_char; new_line();\n\n            ++indentation_level_;\n            \n            for( typename T::const_iterator i = t.begin(); i != t.end(); ++i )\n            {\n                indent(); output( *i );\n\n                typename T::const_iterator next = i;\n\n                if( ++next != t.end())\n                {\n                    os_ << ',';\n                }\n\n                new_line();\n            }\n\n            --indentation_level_;\n\n            indent(); os_ << end_char;\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output_array_or_obj( const T& t, Char_type start_char, Char_type end_char )\n          {\n              os_ << start_char; new_line();\n  \n              ++indentation_level_;\n              \n              for( typename T::const_iterator i = t.begin(); i != t.end(); ++i )\n              {\n                  indent(); output( *i );\n  \n                  typename T::const_iterator next = i;\n  \n                  if( ++next != t.end())\n                  {\n                      os_ << ',';\n                  }\n  \n                  new_line();\n              }\n  \n              --indentation_level_;\n  \n              indent(); os_ << end_char;\n          }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nvoid write_stream( const Value_type& value, Ostream_type& os, bool pretty )\n    {\n        Generator< Value_type, Ostream_type >( value, os, pretty );\n    }"
  },
  {
    "function_name": "new_line",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "215-218",
    "snippet": "void new_line()\n        {\n            if( pretty_ ) os_ << '\\n';\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void new_line()\n          {\n              if( pretty_ ) os_ << '\\n';\n          }\n}"
  },
  {
    "function_name": "space",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "210-213",
    "snippet": "void space()\n        {\n            if( pretty_ ) os_ << ' ';\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void space()\n          {\n              if( pretty_ ) os_ << ' ';\n          }\n}"
  },
  {
    "function_name": "indent",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "200-208",
    "snippet": "void indent()\n        {\n            if( !pretty_ ) return;\n\n            for( int i = 0; i < indentation_level_; ++i )\n            { \n                os_ << \"    \";\n            }\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void indent()\n          {\n              if( !pretty_ ) return;\n  \n              for( int i = 0; i < indentation_level_; ++i )\n              { \n                  os_ << \"    \";\n              }\n          }\n}"
  },
  {
    "function_name": "output_array_or_obj",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "175-198",
    "snippet": "void output_array_or_obj( const T& t, Char_type start_char, Char_type end_char )\n        {\n            os_ << start_char; new_line();\n\n            ++indentation_level_;\n            \n            for( typename T::const_iterator i = t.begin(); i != t.end(); ++i )\n            {\n                indent(); output( *i );\n\n                typename T::const_iterator next = i;\n\n                if( ++next != t.end())\n                {\n                    os_ << ',';\n                }\n\n                new_line();\n            }\n\n            --indentation_level_;\n\n            indent(); os_ << end_char;\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "indent",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "indent",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "200-208",
          "snippet": "void indent()\n        {\n            if( !pretty_ ) return;\n\n            for( int i = 0; i < indentation_level_; ++i )\n            { \n                os_ << \"    \";\n            }\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void indent()\n          {\n              if( !pretty_ ) return;\n  \n              for( int i = 0; i < indentation_level_; ++i )\n              { \n                  os_ << \"    \";\n              }\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "new_line",
          "args": [],
          "line": 192
        },
        "resolved": true,
        "details": {
          "function_name": "new_line",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "215-218",
          "snippet": "void new_line()\n        {\n            if( pretty_ ) os_ << '\\n';\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void new_line()\n          {\n              if( pretty_ ) os_ << '\\n';\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "t.end",
          "args": [],
          "line": 187
        },
        "resolved": true,
        "details": {
          "function_name": "end",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "30-30",
          "snippet": "const_iterator end() const { return map.end(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator end() const { return map.end(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output",
          "args": [
            "*i"
          ],
          "line": 183
        },
        "resolved": true,
        "details": {
          "function_name": "output",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "169-172",
          "snippet": "void output( bool b )\n        {\n            os_ << to_str< String_type >( b ? \"true\" : \"false\" );\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output( bool b )\n          {\n              os_ << to_str< String_type >( b ? \"true\" : \"false\" );\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "t.begin",
          "args": [],
          "line": 181
        },
        "resolved": true,
        "details": {
          "function_name": "begin",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "29-29",
          "snippet": "const_iterator begin() const { return map.begin(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  const_iterator begin() const { return map.begin(); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output_array_or_obj( const T& t, Char_type start_char, Char_type end_char )\n          {\n              os_ << start_char; new_line();\n  \n              ++indentation_level_;\n              \n              for( typename T::const_iterator i = t.begin(); i != t.end(); ++i )\n              {\n                  indent(); output( *i );\n  \n                  typename T::const_iterator next = i;\n  \n                  if( ++next != t.end())\n                  {\n                      os_ << ',';\n                  }\n  \n                  new_line();\n              }\n  \n              --indentation_level_;\n  \n              indent(); os_ << end_char;\n          }\n}"
  },
  {
    "function_name": "output",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "169-172",
    "snippet": "void output( bool b )\n        {\n            os_ << to_str< String_type >( b ? \"true\" : \"false\" );\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "to_str< String_type >",
          "args": [
            "b ? \"true\" : \"false\""
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output( bool b )\n          {\n              os_ << to_str< String_type >( b ? \"true\" : \"false\" );\n          }\n}"
  },
  {
    "function_name": "output",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "164-167",
    "snippet": "void output( const String_type& s )\n        {\n            os_ << '\"' << add_esc_chars( s ) << '\"';\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "add_esc_chars",
          "args": [
            "s"
          ],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "add_esc_chars",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "61-89",
          "snippet": "String_type add_esc_chars( const String_type& s )\n    {\n        typedef typename String_type::const_iterator Iter_type;\n        typedef typename String_type::value_type     Char_type;\n\n        String_type result;\n\n        const Iter_type end( s.end() );\n\n        for( Iter_type i = s.begin(); i != end; ++i )\n        {\n            const Char_type c( *i );\n\n            if( add_esc_char( c, result ) ) continue;\n\n            const wint_t unsigned_c( ( c >= 0 ) ? c : 256 + c );\n\n            if( iswprint( unsigned_c ) )\n            {\n                result += c;\n            }\n            else\n            {\n                result += non_printable_to_string< String_type >( unsigned_c );\n            }\n        }\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type add_esc_chars( const String_type& s )\n    {\n        typedef typename String_type::const_iterator Iter_type;\n        typedef typename String_type::value_type     Char_type;\n\n        String_type result;\n\n        const Iter_type end( s.end() );\n\n        for( Iter_type i = s.begin(); i != end; ++i )\n        {\n            const Char_type c( *i );\n\n            if( add_esc_char( c, result ) ) continue;\n\n            const wint_t unsigned_c( ( c >= 0 ) ? c : 256 + c );\n\n            if( iswprint( unsigned_c ) )\n            {\n                result += c;\n            }\n            else\n            {\n                result += non_printable_to_string< String_type >( unsigned_c );\n            }\n        }\n\n        return result;\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output( const String_type& s )\n          {\n              os_ << '\"' << add_esc_chars( s ) << '\"';\n          }\n}"
  },
  {
    "function_name": "output_int",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "152-162",
    "snippet": "void output_int( const Value_type& value )\n        {\n            if( value.is_uint64() )\n            {\n                os_ << value.get_uint64();\n            }\n            else\n            {\n               os_ << value.get_int64();\n            }\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "value.get_int64",
          "args": [],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "get_int64",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "393-398",
          "snippet": "boost::int64_t Value_impl< Config >::get_int64() const\n    {\n        check_type(  int_type );\n\n        return boost::get< boost::int64_t >( v_ );\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  boost::int64_t Value_impl< Config >::get_int64() const\n      {\n          check_type(  int_type );\n  \n          return boost::get< boost::int64_t >( v_ );\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.get_uint64",
          "args": [],
          "line": 156
        },
        "resolved": true,
        "details": {
          "function_name": "get_uint64",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "401-406",
          "snippet": "boost::uint64_t Value_impl< Config >::get_uint64() const\n    {\n        check_type(  int_type );\n\n        return static_cast< boost::uint64_t >( get_int64() );\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  boost::uint64_t Value_impl< Config >::get_uint64() const\n      {\n          check_type(  int_type );\n  \n          return static_cast< boost::uint64_t >( get_int64() );\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.is_uint64",
          "args": [],
          "line": 154
        },
        "resolved": true,
        "details": {
          "function_name": "is_uint64",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "327-330",
          "snippet": "bool Value_impl< Config >::is_uint64() const\n    {\n        return is_uint64_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  bool Value_impl< Config >::is_uint64() const\n      {\n          return is_uint64_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output_int( const Value_type& value )\n          {\n              if( value.is_uint64() )\n              {\n                  os_ << value.get_uint64();\n              }\n              else\n              {\n                 os_ << value.get_int64();\n              }\n          }\n}"
  },
  {
    "function_name": "output",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "145-150",
    "snippet": "void output( const Obj_member_type& member )\n        {\n            output( Config_type::get_name( member ) ); space(); \n            os_ << ':'; space(); \n            output( Config_type::get_value( member ) );\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output",
          "args": [
            "Config_type::get_value( member )"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "output",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "169-172",
          "snippet": "void output( bool b )\n        {\n            os_ << to_str< String_type >( b ? \"true\" : \"false\" );\n        }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "Config_type::get_value",
          "args": [
            "member"
          ],
          "line": 149
        },
        "resolved": true,
        "details": {
          "function_name": "get_value",
          "container": "Config_map",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "178-181",
          "snippet": "static Value_type get_value( const Pair_type& pair )\n        {\n            return pair.second;\n        }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nConfig_map {\n  static Value_type get_value( const Pair_type& pair )\n          {\n              return pair.second;\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "space",
          "args": [],
          "line": 148
        },
        "resolved": true,
        "details": {
          "function_name": "space",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "210-213",
          "snippet": "void space()\n        {\n            if( pretty_ ) os_ << ' ';\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void space()\n          {\n              if( pretty_ ) os_ << ' ';\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Config_type::get_name",
          "args": [
            "member"
          ],
          "line": 147
        },
        "resolved": true,
        "details": {
          "function_name": "get_name",
          "container": "Config_map",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "173-176",
          "snippet": "static String_type get_name( const Pair_type& pair )\n        {\n            return pair.first;\n        }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nConfig_map {\n  static String_type get_name( const Pair_type& pair )\n          {\n              return pair.first;\n          }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output( const Obj_member_type& member )\n          {\n              output( Config_type::get_name( member ) ); space(); \n              os_ << ':'; space(); \n              output( Config_type::get_value( member ) );\n          }\n}"
  },
  {
    "function_name": "output",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "140-143",
    "snippet": "void output( const Array_type& arr )\n        {\n            output_array_or_obj( arr, '[', ']' );\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output_array_or_obj",
          "args": [
            "arr",
            "'['",
            "']'"
          ],
          "line": 142
        },
        "resolved": true,
        "details": {
          "function_name": "output_array_or_obj",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "175-198",
          "snippet": "void output_array_or_obj( const T& t, Char_type start_char, Char_type end_char )\n        {\n            os_ << start_char; new_line();\n\n            ++indentation_level_;\n            \n            for( typename T::const_iterator i = t.begin(); i != t.end(); ++i )\n            {\n                indent(); output( *i );\n\n                typename T::const_iterator next = i;\n\n                if( ++next != t.end())\n                {\n                    os_ << ',';\n                }\n\n                new_line();\n            }\n\n            --indentation_level_;\n\n            indent(); os_ << end_char;\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output_array_or_obj( const T& t, Char_type start_char, Char_type end_char )\n          {\n              os_ << start_char; new_line();\n  \n              ++indentation_level_;\n              \n              for( typename T::const_iterator i = t.begin(); i != t.end(); ++i )\n              {\n                  indent(); output( *i );\n  \n                  typename T::const_iterator next = i;\n  \n                  if( ++next != t.end())\n                  {\n                      os_ << ',';\n                  }\n  \n                  new_line();\n              }\n  \n              --indentation_level_;\n  \n              indent(); os_ << end_char;\n          }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output( const Array_type& arr )\n          {\n              output_array_or_obj( arr, '[', ']' );\n          }\n}"
  },
  {
    "function_name": "output",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "135-138",
    "snippet": "void output( const Object_type& obj )\n        {\n            output_array_or_obj( obj, '{', '}' );\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output_array_or_obj",
          "args": [
            "obj",
            "'{'",
            "'}'"
          ],
          "line": 137
        },
        "resolved": true,
        "details": {
          "function_name": "output_array_or_obj",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "175-198",
          "snippet": "void output_array_or_obj( const T& t, Char_type start_char, Char_type end_char )\n        {\n            os_ << start_char; new_line();\n\n            ++indentation_level_;\n            \n            for( typename T::const_iterator i = t.begin(); i != t.end(); ++i )\n            {\n                indent(); output( *i );\n\n                typename T::const_iterator next = i;\n\n                if( ++next != t.end())\n                {\n                    os_ << ',';\n                }\n\n                new_line();\n            }\n\n            --indentation_level_;\n\n            indent(); os_ << end_char;\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output_array_or_obj( const T& t, Char_type start_char, Char_type end_char )\n          {\n              os_ << start_char; new_line();\n  \n              ++indentation_level_;\n              \n              for( typename T::const_iterator i = t.begin(); i != t.end(); ++i )\n              {\n                  indent(); output( *i );\n  \n                  typename T::const_iterator next = i;\n  \n                  if( ++next != t.end())\n                  {\n                      os_ << ',';\n                  }\n  \n                  new_line();\n              }\n  \n              --indentation_level_;\n  \n              indent(); os_ << end_char;\n          }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output( const Object_type& obj )\n          {\n              output_array_or_obj( obj, '{', '}' );\n          }\n}"
  },
  {
    "function_name": "output",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "116-133",
    "snippet": "void output( const Value_type& value )\n        {\n            switch( value.type() )\n            {\n                case obj_type:   output( value.get_obj() );   break;\n                case array_type: output( value.get_array() ); break;\n                case str_type:   output( value.get_str() );   break;\n                case bool_type:  output( value.get_bool() );  break;\n                case int_type:   output_int( value );         break;\n\n                /// Bitcoin: Added std::fixed and changed precision from 16 to 8\n                case real_type:  os_ << std::showpoint << std::fixed << std::setprecision(8)\n                                     << value.get_real();     break;\n\n                case null_type:  os_ << \"null\";               break;\n                default: assert( false );\n            }\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "false"
          ],
          "line": 131
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.get_real",
          "args": [],
          "line": 128
        },
        "resolved": true,
        "details": {
          "function_name": "get_real",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "409-420",
          "snippet": "double Value_impl< Config >::get_real() const\n    {\n        if( type() == int_type )\n        {\n            return is_uint64() ? static_cast< double >( get_uint64() )\n                               : static_cast< double >( get_int64() );\n        }\n\n        check_type(  real_type );\n\n        return boost::get< double >( v_ );\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  double Value_impl< Config >::get_real() const\n      {\n          if( type() == int_type )\n          {\n              return is_uint64() ? static_cast< double >( get_uint64() )\n                                 : static_cast< double >( get_int64() );\n          }\n  \n          check_type(  real_type );\n  \n          return boost::get< double >( v_ );\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::setprecision",
          "args": [
            "8"
          ],
          "line": 127
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "output_int",
          "args": [
            "value"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "output_int",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "152-162",
          "snippet": "void output_int( const Value_type& value )\n        {\n            if( value.is_uint64() )\n            {\n                os_ << value.get_uint64();\n            }\n            else\n            {\n               os_ << value.get_int64();\n            }\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output_int( const Value_type& value )\n          {\n              if( value.is_uint64() )\n              {\n                  os_ << value.get_uint64();\n              }\n              else\n              {\n                 os_ << value.get_int64();\n              }\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "output",
          "args": [
            "value.get_bool()"
          ],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "output",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "169-172",
          "snippet": "void output( bool b )\n        {\n            os_ << to_str< String_type >( b ? \"true\" : \"false\" );\n        }",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "value.get_bool",
          "args": [],
          "line": 123
        },
        "resolved": true,
        "details": {
          "function_name": "get_bool",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "377-382",
          "snippet": "bool Value_impl< Config >::get_bool() const\n    {\n        check_type(  bool_type );\n\n        return boost::get< bool >( v_ );\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  bool Value_impl< Config >::get_bool() const\n      {\n          check_type(  bool_type );\n  \n          return boost::get< bool >( v_ );\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "value.get_str",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.get_array",
          "args": [],
          "line": 121
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.get_obj",
          "args": [],
          "line": 120
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "value.type",
          "args": [],
          "line": 118
        },
        "resolved": true,
        "details": {
          "function_name": "type",
          "container": "Value_impl< Config >",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_value.h",
          "lines": "321-324",
          "snippet": "Value_type Value_impl< Config >::type() const\n    {\n        return type_;\n    }",
          "includes": [
            "#include <boost/variant.hpp>",
            "#include <boost/shared_ptr.hpp>",
            "#include <boost/cstdint.hpp>",
            "#include <boost/config.hpp>",
            "#include <stdexcept>",
            "#include <sstream>",
            "#include <cassert>",
            "#include <string>",
            "#include <map>",
            "#include <vector>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/variant.hpp>\n#include <boost/shared_ptr.hpp>\n#include <boost/cstdint.hpp>\n#include <boost/config.hpp>\n#include <stdexcept>\n#include <sstream>\n#include <cassert>\n#include <string>\n#include <map>\n#include <vector>\n\nValue_impl< Config > {\n  Value_type Value_impl< Config >::type() const\n      {\n          return type_;\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output( const Value_type& value )\n          {\n              switch( value.type() )\n              {\n                  case obj_type:   output( value.get_obj() );   break;\n                  case array_type: output( value.get_array() ); break;\n                  case str_type:   output( value.get_str() );   break;\n                  case bool_type:  output( value.get_bool() );  break;\n                  case int_type:   output_int( value );         break;\n  \n                  /// Bitcoin: Added std::fixed and changed precision from 16 to 8\n                  case real_type:  os_ << std::showpoint << std::fixed << std::setprecision(8)\n                                       << value.get_real();     break;\n  \n                  case null_type:  os_ << \"null\";               break;\n                  default: assert( false );\n              }\n          }\n}"
  },
  {
    "function_name": "Generator",
    "container": "Generator",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "106-112",
    "snippet": "Generator( const Value_type& value, Ostream_type& os, bool pretty )\n        :   os_( os )\n        ,   indentation_level_( 0 )\n        ,   pretty_( pretty )\n        {\n            output( value );\n        }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "output",
          "args": [
            "value"
          ],
          "line": 111
        },
        "resolved": true,
        "details": {
          "function_name": "output",
          "container": "Generator",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "169-172",
          "snippet": "void output( bool b )\n        {\n            os_ << to_str< String_type >( b ? \"true\" : \"false\" );\n        }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  void output( bool b )\n          {\n              os_ << to_str< String_type >( b ? \"true\" : \"false\" );\n          }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nGenerator {\n  Generator( const Value_type& value, Ostream_type& os, bool pretty )\n          :   os_( os )\n          ,   indentation_level_( 0 )\n          ,   pretty_( pretty )\n          {\n              output( value );\n          }\n}"
  },
  {
    "function_name": "add_esc_chars",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "61-89",
    "snippet": "String_type add_esc_chars( const String_type& s )\n    {\n        typedef typename String_type::const_iterator Iter_type;\n        typedef typename String_type::value_type     Char_type;\n\n        String_type result;\n\n        const Iter_type end( s.end() );\n\n        for( Iter_type i = s.begin(); i != end; ++i )\n        {\n            const Char_type c( *i );\n\n            if( add_esc_char( c, result ) ) continue;\n\n            const wint_t unsigned_c( ( c >= 0 ) ? c : 256 + c );\n\n            if( iswprint( unsigned_c ) )\n            {\n                result += c;\n            }\n            else\n            {\n                result += non_printable_to_string< String_type >( unsigned_c );\n            }\n        }\n\n        return result;\n    }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "non_printable_to_string< String_type >",
          "args": [
            "unsigned_c"
          ],
          "line": 84
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "iswprint",
          "args": [
            "unsigned_c"
          ],
          "line": 78
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "add_esc_char",
          "args": [
            "c",
            "result"
          ],
          "line": 74
        },
        "resolved": true,
        "details": {
          "function_name": "add_esc_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "44-58",
          "snippet": "bool add_esc_char( Char_type c, String_type& s )\n    {\n        switch( c )\n        {\n            case '\"':  s += to_str< String_type >( \"\\\\\\\"\" ); return true;\n            case '\\\\': s += to_str< String_type >( \"\\\\\\\\\" ); return true;\n            case '\\b': s += to_str< String_type >( \"\\\\b\"  ); return true;\n            case '\\f': s += to_str< String_type >( \"\\\\f\"  ); return true;\n            case '\\n': s += to_str< String_type >( \"\\\\n\"  ); return true;\n            case '\\r': s += to_str< String_type >( \"\\\\r\"  ); return true;\n            case '\\t': s += to_str< String_type >( \"\\\\t\"  ); return true;\n        }\n\n        return false;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nbool add_esc_char( Char_type c, String_type& s )\n    {\n        switch( c )\n        {\n            case '\"':  s += to_str< String_type >( \"\\\\\\\"\" ); return true;\n            case '\\\\': s += to_str< String_type >( \"\\\\\\\\\" ); return true;\n            case '\\b': s += to_str< String_type >( \"\\\\b\"  ); return true;\n            case '\\f': s += to_str< String_type >( \"\\\\f\"  ); return true;\n            case '\\n': s += to_str< String_type >( \"\\\\n\"  ); return true;\n            case '\\r': s += to_str< String_type >( \"\\\\r\"  ); return true;\n            case '\\t': s += to_str< String_type >( \"\\\\t\"  ); return true;\n        }\n\n        return false;\n    }"
        }
      },
      {
        "call_info": {
          "callee": "s.begin",
          "args": [],
          "line": 70
        },
        "resolved": true,
        "details": {
          "function_name": "begin_compound",
          "container": "Semantic_actions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_reader_template.h",
          "lines": "308-322",
          "snippet": "void begin_compound()\n        {\n            if( current_p_ == 0 )\n            {\n                add_first( Array_or_obj() );\n            }\n            else\n            {\n                stack_.push_back( current_p_ );\n\n                Array_or_obj new_array_or_obj;   // avoid copy by building new array or object in place\n\n                current_p_ = add_to_current( new_array_or_obj );\n            }\n        }",
          "includes": [
            "#include <boost/spirit/iterator/position_iterator.hpp>",
            "#include <boost/spirit/iterator/multi_pass.hpp>",
            "#include <boost/spirit/utility/escape_char.hpp>",
            "#include <boost/spirit/utility/confix.hpp>",
            "#include <boost/spirit/core.hpp>",
            "#include <boost/spirit/include/classic_position_iterator.hpp>",
            "#include <boost/spirit/include/classic_multi_pass.hpp>",
            "#include <boost/spirit/include/classic_escape_char.hpp>",
            "#include <boost/spirit/include/classic_confix.hpp>",
            "#include <boost/spirit/include/classic_core.hpp>",
            "#include <boost/version.hpp>",
            "#include <boost/function.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include \"json_spirit_error_position.h\"",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/spirit/iterator/position_iterator.hpp>\n#include <boost/spirit/iterator/multi_pass.hpp>\n#include <boost/spirit/utility/escape_char.hpp>\n#include <boost/spirit/utility/confix.hpp>\n#include <boost/spirit/core.hpp>\n#include <boost/spirit/include/classic_position_iterator.hpp>\n#include <boost/spirit/include/classic_multi_pass.hpp>\n#include <boost/spirit/include/classic_escape_char.hpp>\n#include <boost/spirit/include/classic_confix.hpp>\n#include <boost/spirit/include/classic_core.hpp>\n#include <boost/version.hpp>\n#include <boost/function.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include \"json_spirit_error_position.h\"\n#include \"json_spirit_value.h\"\n\nSemantic_actions {\n  void begin_compound()\n          {\n              if( current_p_ == 0 )\n              {\n                  add_first( Array_or_obj() );\n              }\n              else\n              {\n                  stack_.push_back( current_p_ );\n  \n                  Array_or_obj new_array_or_obj;   // avoid copy by building new array or object in place\n  \n                  current_p_ = add_to_current( new_array_or_obj );\n              }\n          }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.end",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "end_compound",
          "container": "Semantic_actions",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_reader_template.h",
          "lines": "324-332",
          "snippet": "void end_compound()\n        {\n            if( current_p_ != &value_ )\n            {\n                current_p_ = stack_.back();\n                \n                stack_.pop_back();\n            }    \n        }",
          "includes": [
            "#include <boost/spirit/iterator/position_iterator.hpp>",
            "#include <boost/spirit/iterator/multi_pass.hpp>",
            "#include <boost/spirit/utility/escape_char.hpp>",
            "#include <boost/spirit/utility/confix.hpp>",
            "#include <boost/spirit/core.hpp>",
            "#include <boost/spirit/include/classic_position_iterator.hpp>",
            "#include <boost/spirit/include/classic_multi_pass.hpp>",
            "#include <boost/spirit/include/classic_escape_char.hpp>",
            "#include <boost/spirit/include/classic_confix.hpp>",
            "#include <boost/spirit/include/classic_core.hpp>",
            "#include <boost/version.hpp>",
            "#include <boost/function.hpp>",
            "#include <boost/bind.hpp>",
            "#include <boost/bind/bind.hpp>",
            "#include \"json_spirit_error_position.h\"",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <boost/spirit/iterator/position_iterator.hpp>\n#include <boost/spirit/iterator/multi_pass.hpp>\n#include <boost/spirit/utility/escape_char.hpp>\n#include <boost/spirit/utility/confix.hpp>\n#include <boost/spirit/core.hpp>\n#include <boost/spirit/include/classic_position_iterator.hpp>\n#include <boost/spirit/include/classic_multi_pass.hpp>\n#include <boost/spirit/include/classic_escape_char.hpp>\n#include <boost/spirit/include/classic_confix.hpp>\n#include <boost/spirit/include/classic_core.hpp>\n#include <boost/version.hpp>\n#include <boost/function.hpp>\n#include <boost/bind.hpp>\n#include <boost/bind/bind.hpp>\n#include \"json_spirit_error_position.h\"\n#include \"json_spirit_value.h\"\n\nSemantic_actions {\n  void end_compound()\n          {\n              if( current_p_ != &value_ )\n              {\n                  current_p_ = stack_.back();\n                  \n                  stack_.pop_back();\n              }    \n          }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type add_esc_chars( const String_type& s )\n    {\n        typedef typename String_type::const_iterator Iter_type;\n        typedef typename String_type::value_type     Char_type;\n\n        String_type result;\n\n        const Iter_type end( s.end() );\n\n        for( Iter_type i = s.begin(); i != end; ++i )\n        {\n            const Char_type c( *i );\n\n            if( add_esc_char( c, result ) ) continue;\n\n            const wint_t unsigned_c( ( c >= 0 ) ? c : 256 + c );\n\n            if( iswprint( unsigned_c ) )\n            {\n                result += c;\n            }\n            else\n            {\n                result += non_printable_to_string< String_type >( unsigned_c );\n            }\n        }\n\n        return result;\n    }"
  },
  {
    "function_name": "add_esc_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "44-58",
    "snippet": "bool add_esc_char( Char_type c, String_type& s )\n    {\n        switch( c )\n        {\n            case '\"':  s += to_str< String_type >( \"\\\\\\\"\" ); return true;\n            case '\\\\': s += to_str< String_type >( \"\\\\\\\\\" ); return true;\n            case '\\b': s += to_str< String_type >( \"\\\\b\"  ); return true;\n            case '\\f': s += to_str< String_type >( \"\\\\f\"  ); return true;\n            case '\\n': s += to_str< String_type >( \"\\\\n\"  ); return true;\n            case '\\r': s += to_str< String_type >( \"\\\\r\"  ); return true;\n            case '\\t': s += to_str< String_type >( \"\\\\t\"  ); return true;\n        }\n\n        return false;\n    }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "to_str< String_type >",
          "args": [
            "\"\\\\t\""
          ],
          "line": 54
        },
        "resolved": true,
        "details": {
          "function_name": "non_printable_to_string",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "29-41",
          "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nbool add_esc_char( Char_type c, String_type& s )\n    {\n        switch( c )\n        {\n            case '\"':  s += to_str< String_type >( \"\\\\\\\"\" ); return true;\n            case '\\\\': s += to_str< String_type >( \"\\\\\\\\\" ); return true;\n            case '\\b': s += to_str< String_type >( \"\\\\b\"  ); return true;\n            case '\\f': s += to_str< String_type >( \"\\\\f\"  ); return true;\n            case '\\n': s += to_str< String_type >( \"\\\\n\"  ); return true;\n            case '\\r': s += to_str< String_type >( \"\\\\r\"  ); return true;\n            case '\\t': s += to_str< String_type >( \"\\\\t\"  ); return true;\n        }\n\n        return false;\n    }"
  },
  {
    "function_name": "non_printable_to_string",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "29-41",
    "snippet": "String_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "to_hex_char",
          "args": [
            "c & 0x000F"
          ],
          "line": 38
        },
        "resolved": true,
        "details": {
          "function_name": "to_hex_char",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
          "lines": "17-26",
          "snippet": "inline char to_hex_char( unsigned int c )\n    {\n        assert( c <= 0xF );\n\n        const char ch = static_cast< char >( c );\n\n        if( ch < 10 ) return '0' + ch;\n\n        return 'A' - 10 + ch;\n    }",
          "includes": [
            "#include <iomanip>",
            "#include <sstream>",
            "#include <cassert>",
            "#include \"json_spirit_value.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\ninline char to_hex_char( unsigned int c )\n    {\n        assert( c <= 0xF );\n\n        const char ch = static_cast< char >( c );\n\n        if( ch < 10 ) return '0' + ch;\n\n        return 'A' - 10 + ch;\n    }"
        }
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\nString_type non_printable_to_string( unsigned int c )\n    {\n        String_type result( 6, '\\\\' );\n\n        result[1] = 'u';\n\n        result[ 5 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 4 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 3 ] = to_hex_char( c & 0x000F ); c >>= 4;\n        result[ 2 ] = to_hex_char( c & 0x000F );\n\n        return result;\n    }"
  },
  {
    "function_name": "to_hex_char",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/json/json_spirit_writer_template.h",
    "lines": "17-26",
    "snippet": "inline char to_hex_char( unsigned int c )\n    {\n        assert( c <= 0xF );\n\n        const char ch = static_cast< char >( c );\n\n        if( ch < 10 ) return '0' + ch;\n\n        return 'A' - 10 + ch;\n    }",
    "includes": [
      "#include <iomanip>",
      "#include <sstream>",
      "#include <cassert>",
      "#include \"json_spirit_value.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast< char >",
          "args": [
            "c"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "assert",
          "args": [
            "c <= 0xF"
          ],
          "line": 19
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <iomanip>\n#include <sstream>\n#include <cassert>\n#include \"json_spirit_value.h\"\n\ninline char to_hex_char( unsigned int c )\n    {\n        assert( c <= 0xF );\n\n        const char ch = static_cast< char >( c );\n\n        if( ch < 10 ) return '0' + ch;\n\n        return 'A' - 10 + ch;\n    }"
  }
]