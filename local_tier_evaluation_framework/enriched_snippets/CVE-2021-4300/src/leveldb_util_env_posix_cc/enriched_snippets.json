[
  {
    "function_name": "InitDefaultEnv",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "601-601",
    "snippet": "static void InitDefaultEnv() { default_env = new PosixEnv; }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic void InitDefaultEnv() { default_env = new PosixEnv; }"
  },
  {
    "function_name": "StartThread",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "588-595",
    "snippet": "void PosixEnv::StartThread(void (*function)(void* arg), void* arg) {\n  pthread_t t;\n  StartThreadState* state = new StartThreadState;\n  state->user_function = function;\n  state->arg = arg;\n  PthreadCall(\"start thread\",\n              pthread_create(&t, NULL,  &StartThreadWrapper, state));\n}",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PthreadCall",
          "args": [
            "\"start thread\"",
            "pthread_create(&t, NULL,  &StartThreadWrapper, state)"
          ],
          "line": 593
        },
        "resolved": true,
        "details": {
          "function_name": "PthreadCall",
          "container": "PosixEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "500-505",
          "snippet": "void PthreadCall(const char* label, int result) {\n    if (result != 0) {\n      fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n      abort();\n    }\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  void PthreadCall(const char* label, int result) {\n      if (result != 0) {\n        fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n        abort();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_create",
          "args": [
            "&t",
            "NULL",
            "&StartThreadWrapper",
            "state"
          ],
          "line": 594
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  void PosixEnv::StartThread(void (*function)(void* arg), void* arg) {\n    pthread_t t;\n    StartThreadState* state = new StartThreadState;\n    state->user_function = function;\n    state->arg = arg;\n    PthreadCall(\"start thread\",\n                pthread_create(&t, NULL,  &StartThreadWrapper, state));\n  }\n}"
  },
  {
    "function_name": "BGThread",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "558-573",
    "snippet": "void PosixEnv::BGThread() {\n  while (true) {\n    // Wait until there is an item that is ready to run\n    PthreadCall(\"lock\", pthread_mutex_lock(&mu_));\n    while (queue_.empty()) {\n      PthreadCall(\"wait\", pthread_cond_wait(&bgsignal_, &mu_));\n    }\n\n    void (*function)(void*) = queue_.front().function;\n    void* arg = queue_.front().arg;\n    queue_.pop_front();\n\n    PthreadCall(\"unlock\", pthread_mutex_unlock(&mu_));\n    (*function)(arg);\n  }\n}",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "",
          "args": [
            "arg"
          ],
          "line": 571
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "PthreadCall",
          "args": [
            "\"unlock\"",
            "pthread_mutex_unlock(&mu_)"
          ],
          "line": 570
        },
        "resolved": true,
        "details": {
          "function_name": "PthreadCall",
          "container": "PosixEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "500-505",
          "snippet": "void PthreadCall(const char* label, int result) {\n    if (result != 0) {\n      fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n      abort();\n    }\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  void PthreadCall(const char* label, int result) {\n      if (result != 0) {\n        fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n        abort();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&mu_"
          ],
          "line": 570
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_.pop_front",
          "args": [],
          "line": 568
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_.front",
          "args": [],
          "line": 567
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_.front",
          "args": [],
          "line": 566
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_cond_wait",
          "args": [
            "&bgsignal_",
            "&mu_"
          ],
          "line": 563
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_.empty",
          "args": [],
          "line": 562
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&mu_"
          ],
          "line": 561
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  void PosixEnv::BGThread() {\n    while (true) {\n      // Wait until there is an item that is ready to run\n      PthreadCall(\"lock\", pthread_mutex_lock(&mu_));\n      while (queue_.empty()) {\n        PthreadCall(\"wait\", pthread_cond_wait(&bgsignal_, &mu_));\n      }\n  \n      void (*function)(void*) = queue_.front().function;\n      void* arg = queue_.front().arg;\n      queue_.pop_front();\n  \n      PthreadCall(\"unlock\", pthread_mutex_unlock(&mu_));\n      (*function)(arg);\n    }\n  }\n}"
  },
  {
    "function_name": "Schedule",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "533-556",
    "snippet": "void PosixEnv::Schedule(void (*function)(void*), void* arg) {\n  PthreadCall(\"lock\", pthread_mutex_lock(&mu_));\n\n  // Start background thread if necessary\n  if (!started_bgthread_) {\n    started_bgthread_ = true;\n    PthreadCall(\n        \"create thread\",\n        pthread_create(&bgthread_, NULL,  &PosixEnv::BGThreadWrapper, this));\n  }\n\n  // If the queue is currently empty, the background thread may currently be\n  // waiting.\n  if (queue_.empty()) {\n    PthreadCall(\"signal\", pthread_cond_signal(&bgsignal_));\n  }\n\n  // Add to priority queue\n  queue_.push_back(BGItem());\n  queue_.back().function = function;\n  queue_.back().arg = arg;\n\n  PthreadCall(\"unlock\", pthread_mutex_unlock(&mu_));\n}",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PthreadCall",
          "args": [
            "\"unlock\"",
            "pthread_mutex_unlock(&mu_)"
          ],
          "line": 555
        },
        "resolved": true,
        "details": {
          "function_name": "PthreadCall",
          "container": "PosixEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "500-505",
          "snippet": "void PthreadCall(const char* label, int result) {\n    if (result != 0) {\n      fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n      abort();\n    }\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  void PthreadCall(const char* label, int result) {\n      if (result != 0) {\n        fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n        abort();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_mutex_unlock",
          "args": [
            "&mu_"
          ],
          "line": 555
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_.back",
          "args": [],
          "line": 553
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_.back",
          "args": [],
          "line": 552
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_.push_back",
          "args": [
            "BGItem()"
          ],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "BGItem",
          "args": [],
          "line": 551
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_cond_signal",
          "args": [
            "&bgsignal_"
          ],
          "line": 547
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "queue_.empty",
          "args": [],
          "line": 546
        },
        "resolved": true,
        "details": {
          "function_name": "empty",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "32-32",
          "snippet": "bool empty() const { return map.empty(); }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  bool empty() const { return map.empty(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_create",
          "args": [
            "&bgthread_",
            "NULL",
            "&PosixEnv::BGThreadWrapper",
            "this"
          ],
          "line": 541
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_lock",
          "args": [
            "&mu_"
          ],
          "line": 534
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  void PosixEnv::Schedule(void (*function)(void*), void* arg) {\n    PthreadCall(\"lock\", pthread_mutex_lock(&mu_));\n  \n    // Start background thread if necessary\n    if (!started_bgthread_) {\n      started_bgthread_ = true;\n      PthreadCall(\n          \"create thread\",\n          pthread_create(&bgthread_, NULL,  &PosixEnv::BGThreadWrapper, this));\n    }\n  \n    // If the queue is currently empty, the background thread may currently be\n    // waiting.\n    if (queue_.empty()) {\n      PthreadCall(\"signal\", pthread_cond_signal(&bgsignal_));\n    }\n  \n    // Add to priority queue\n    queue_.push_back(BGItem());\n    queue_.back().function = function;\n    queue_.back().arg = arg;\n  \n    PthreadCall(\"unlock\", pthread_mutex_unlock(&mu_));\n  }\n}"
  },
  {
    "function_name": "PosixEnv",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "528-531",
    "snippet": "PosixEnv::PosixEnv() : started_bgthread_(false) {\n  PthreadCall(\"mutex_init\", pthread_mutex_init(&mu_, NULL));\n  PthreadCall(\"cvar_init\", pthread_cond_init(&bgsignal_, NULL));\n}",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "PthreadCall",
          "args": [
            "\"cvar_init\"",
            "pthread_cond_init(&bgsignal_, NULL)"
          ],
          "line": 530
        },
        "resolved": true,
        "details": {
          "function_name": "PthreadCall",
          "container": "PosixEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "500-505",
          "snippet": "void PthreadCall(const char* label, int result) {\n    if (result != 0) {\n      fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n      abort();\n    }\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  void PthreadCall(const char* label, int result) {\n      if (result != 0) {\n        fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n        abort();\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pthread_cond_init",
          "args": [
            "&bgsignal_",
            "NULL"
          ],
          "line": 530
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_mutex_init",
          "args": [
            "&mu_",
            "NULL"
          ],
          "line": 529
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  PosixEnv::PosixEnv() : started_bgthread_(false) {\n    PthreadCall(\"mutex_init\", pthread_mutex_init(&mu_, NULL));\n    PthreadCall(\"cvar_init\", pthread_cond_init(&bgsignal_, NULL));\n  }\n}"
  },
  {
    "function_name": "PthreadCall",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "500-505",
    "snippet": "void PthreadCall(const char* label, int result) {\n    if (result != 0) {\n      fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n      abort();\n    }\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "abort",
          "args": [],
          "line": 503
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fprintf",
          "args": [
            "stderr",
            "\"pthread %s: %s\\n\"",
            "label",
            "strerror(result)"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "result"
          ],
          "line": 502
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  void PthreadCall(const char* label, int result) {\n      if (result != 0) {\n        fprintf(stderr, \"pthread %s: %s\\n\", label, strerror(result));\n        abort();\n      }\n    }\n}"
  },
  {
    "function_name": "SleepForMicroseconds",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "495-497",
    "snippet": "virtual void SleepForMicroseconds(int micros) {\n    usleep(micros);\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "usleep",
          "args": [
            "micros"
          ],
          "line": 496
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual void SleepForMicroseconds(int micros) {\n      usleep(micros);\n    }\n}"
  },
  {
    "function_name": "NowMicros",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "489-493",
    "snippet": "virtual uint64_t NowMicros() {\n    struct timeval tv;\n    gettimeofday(&tv, NULL);\n    return static_cast<uint64_t>(tv.tv_sec) * 1000000 + tv.tv_usec;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "static_cast<uint64_t>",
          "args": [
            "tv.tv_sec"
          ],
          "line": 492
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "gettimeofday",
          "args": [
            "&tv",
            "NULL"
          ],
          "line": 491
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual uint64_t NowMicros() {\n      struct timeval tv;\n      gettimeofday(&tv, NULL);\n      return static_cast<uint64_t>(tv.tv_sec) * 1000000 + tv.tv_usec;\n    }\n}"
  },
  {
    "function_name": "NewLogger",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "478-487",
    "snippet": "virtual Status NewLogger(const std::string& fname, Logger** result) {\n    FILE* f = fopen(fname.c_str(), \"w\");\n    if (f == NULL) {\n      *result = NULL;\n      return IOError(fname, errno);\n    } else {\n      *result = new PosixLogger(f, &PosixEnv::gettid);\n      return Status::OK();\n    }\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 485
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "fname",
            "errno"
          ],
          "line": 482
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "fname.c_str()",
            "\"w\""
          ],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 479
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status NewLogger(const std::string& fname, Logger** result) {\n      FILE* f = fopen(fname.c_str(), \"w\");\n      if (f == NULL) {\n        *result = NULL;\n        return IOError(fname, errno);\n      } else {\n        *result = new PosixLogger(f, &PosixEnv::gettid);\n        return Status::OK();\n      }\n    }\n}"
  },
  {
    "function_name": "gettid",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "471-476",
    "snippet": "static uint64_t gettid() {\n    pthread_t tid = pthread_self();\n    uint64_t thread_id = 0;\n    memcpy(&thread_id, &tid, std::min(sizeof(thread_id), sizeof(tid)));\n    return thread_id;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "memcpy",
          "args": [
            "&thread_id",
            "&tid",
            "std::min(sizeof(thread_id), sizeof(tid))"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "std::min",
          "args": [
            "sizeof(thread_id)",
            "sizeof(tid)"
          ],
          "line": 474
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "pthread_self",
          "args": [],
          "line": 472
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  static uint64_t gettid() {\n      pthread_t tid = pthread_self();\n      uint64_t thread_id = 0;\n      memcpy(&thread_id, &tid, std::min(sizeof(thread_id), sizeof(tid)));\n      return thread_id;\n    }\n}"
  },
  {
    "function_name": "GetTestDirectory",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "457-469",
    "snippet": "virtual Status GetTestDirectory(std::string* result) {\n    const char* env = getenv(\"TEST_TMPDIR\");\n    if (env && env[0] != '\\0') {\n      *result = env;\n    } else {\n      char buf[100];\n      snprintf(buf, sizeof(buf), \"/tmp/leveldbtest-%d\", int(geteuid()));\n      *result = buf;\n    }\n    // Directory may already exist\n    CreateDir(*result);\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 468
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "CreateDir",
          "args": [
            "*result"
          ],
          "line": 467
        },
        "resolved": true,
        "details": {
          "function_name": "CreateDir",
          "container": "PosixEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "383-389",
          "snippet": "virtual Status CreateDir(const std::string& name) {\n    Status result;\n    if (mkdir(name.c_str(), 0755) != 0) {\n      result = IOError(name, errno);\n    }\n    return result;\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status CreateDir(const std::string& name) {\n      Status result;\n      if (mkdir(name.c_str(), 0755) != 0) {\n        result = IOError(name, errno);\n      }\n      return result;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "snprintf",
          "args": [
            "buf",
            "sizeof(buf)",
            "\"/tmp/leveldbtest-%d\"",
            "int(geteuid())"
          ],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "int",
          "args": [
            "geteuid()"
          ],
          "line": 463
        },
        "resolved": true,
        "details": {
          "function_name": "VarintLength",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "103-110",
          "snippet": "int VarintLength(uint64_t v) {\n  int len = 1;\n  while (v >= 128) {\n    v >>= 7;\n    len++;\n  }\n  return len;\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nint VarintLength(uint64_t v) {\n  int len = 1;\n  while (v >= 128) {\n    v >>= 7;\n    len++;\n  }\n  return len;\n}"
        }
      },
      {
        "call_info": {
          "callee": "geteuid",
          "args": [],
          "line": 463
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "getenv",
          "args": [
            "\"TEST_TMPDIR\""
          ],
          "line": 458
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status GetTestDirectory(std::string* result) {\n      const char* env = getenv(\"TEST_TMPDIR\");\n      if (env && env[0] != '\\0') {\n        *result = env;\n      } else {\n        char buf[100];\n        snprintf(buf, sizeof(buf), \"/tmp/leveldbtest-%d\", int(geteuid()));\n        *result = buf;\n      }\n      // Directory may already exist\n      CreateDir(*result);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "UnlockFile",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "441-451",
    "snippet": "virtual Status UnlockFile(FileLock* lock) {\n    PosixFileLock* my_lock = reinterpret_cast<PosixFileLock*>(lock);\n    Status result;\n    if (LockOrUnlock(my_lock->fd_, false) == -1) {\n      result = IOError(\"unlock\", errno);\n    }\n    locks_.Remove(my_lock->name_);\n    close(my_lock->fd_);\n    delete my_lock;\n    return result;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "my_lock->fd_"
          ],
          "line": 448
        },
        "resolved": true,
        "details": {
          "function_name": "myclosesocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/compat.h",
          "lines": "50-61",
          "snippet": "inline int myclosesocket(SOCKET& hSocket)\n{\n    if (hSocket == INVALID_SOCKET)\n        return WSAENOTSOCK;\n#ifdef WIN32\n    int ret = closesocket(hSocket);\n#else\n    int ret = close(hSocket);\n#endif\n    hSocket = INVALID_SOCKET;\n    return ret;\n}",
          "includes": [
            "#include \"errno.h\"",
            "#include <ifaddrs.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <ws2tcpip.h>",
            "#include <mswsock.h>",
            "#include <winsock2.h>"
          ],
          "macros_used": [
            "#define INVALID_SOCKET      (SOCKET)(~0)",
            "#define WSAENOTSOCK         EBADF"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"errno.h\"\n#include <ifaddrs.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <sys/fcntl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <ws2tcpip.h>\n#include <mswsock.h>\n#include <winsock2.h>\n\n#define INVALID_SOCKET      (SOCKET)(~0)\n#define WSAENOTSOCK         EBADF\n\ninline int myclosesocket(SOCKET& hSocket)\n{\n    if (hSocket == INVALID_SOCKET)\n        return WSAENOTSOCK;\n#ifdef WIN32\n    int ret = closesocket(hSocket);\n#else\n    int ret = close(hSocket);\n#endif\n    hSocket = INVALID_SOCKET;\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "locks_.Remove",
          "args": [
            "my_lock->name_"
          ],
          "line": 447
        },
        "resolved": true,
        "details": {
          "function_name": "Remove",
          "container": "PosixLockTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "289-292",
          "snippet": "void Remove(const std::string& fname) {\n    MutexLock l(&mu_);\n    locked_files_.erase(fname);\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixLockTable {\n  void Remove(const std::string& fname) {\n      MutexLock l(&mu_);\n      locked_files_.erase(fname);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "\"unlock\"",
            "errno"
          ],
          "line": 445
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "LockOrUnlock",
          "args": [
            "my_lock->fd_",
            "false"
          ],
          "line": 444
        },
        "resolved": true,
        "details": {
          "function_name": "LockOrUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "260-269",
          "snippet": "static int LockOrUnlock(int fd, bool lock) {\n  errno = 0;\n  struct flock f;\n  memset(&f, 0, sizeof(f));\n  f.l_type = (lock ? F_WRLCK : F_UNLCK);\n  f.l_whence = SEEK_SET;\n  f.l_start = 0;\n  f.l_len = 0;        // Lock/unlock entire file\n  return fcntl(fd, F_SETLK, &f);\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic int LockOrUnlock(int fd, bool lock) {\n  errno = 0;\n  struct flock f;\n  memset(&f, 0, sizeof(f));\n  f.l_type = (lock ? F_WRLCK : F_UNLCK);\n  f.l_whence = SEEK_SET;\n  f.l_start = 0;\n  f.l_len = 0;        // Lock/unlock entire file\n  return fcntl(fd, F_SETLK, &f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<PosixFileLock*>",
          "args": [
            "lock"
          ],
          "line": 442
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status UnlockFile(FileLock* lock) {\n      PosixFileLock* my_lock = reinterpret_cast<PosixFileLock*>(lock);\n      Status result;\n      if (LockOrUnlock(my_lock->fd_, false) == -1) {\n        result = IOError(\"unlock\", errno);\n      }\n      locks_.Remove(my_lock->name_);\n      close(my_lock->fd_);\n      delete my_lock;\n      return result;\n    }\n}"
  },
  {
    "function_name": "LockFile",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "419-439",
    "snippet": "virtual Status LockFile(const std::string& fname, FileLock** lock) {\n    *lock = NULL;\n    Status result;\n    int fd = open(fname.c_str(), O_RDWR | O_CREAT, 0644);\n    if (fd < 0) {\n      result = IOError(fname, errno);\n    } else if (!locks_.Insert(fname)) {\n      close(fd);\n      result = Status::IOError(\"lock \" + fname, \"already held by process\");\n    } else if (LockOrUnlock(fd, true) == -1) {\n      result = IOError(\"lock \" + fname, errno);\n      close(fd);\n      locks_.Remove(fname);\n    } else {\n      PosixFileLock* my_lock = new PosixFileLock;\n      my_lock->fd_ = fd;\n      my_lock->name_ = fname;\n      *lock = my_lock;\n    }\n    return result;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "locks_.Remove",
          "args": [
            "fname"
          ],
          "line": 431
        },
        "resolved": true,
        "details": {
          "function_name": "Remove",
          "container": "PosixLockTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "289-292",
          "snippet": "void Remove(const std::string& fname) {\n    MutexLock l(&mu_);\n    locked_files_.erase(fname);\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixLockTable {\n  void Remove(const std::string& fname) {\n      MutexLock l(&mu_);\n      locked_files_.erase(fname);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 430
        },
        "resolved": true,
        "details": {
          "function_name": "myclosesocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/compat.h",
          "lines": "50-61",
          "snippet": "inline int myclosesocket(SOCKET& hSocket)\n{\n    if (hSocket == INVALID_SOCKET)\n        return WSAENOTSOCK;\n#ifdef WIN32\n    int ret = closesocket(hSocket);\n#else\n    int ret = close(hSocket);\n#endif\n    hSocket = INVALID_SOCKET;\n    return ret;\n}",
          "includes": [
            "#include \"errno.h\"",
            "#include <ifaddrs.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <ws2tcpip.h>",
            "#include <mswsock.h>",
            "#include <winsock2.h>"
          ],
          "macros_used": [
            "#define INVALID_SOCKET      (SOCKET)(~0)",
            "#define WSAENOTSOCK         EBADF"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"errno.h\"\n#include <ifaddrs.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <sys/fcntl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <ws2tcpip.h>\n#include <mswsock.h>\n#include <winsock2.h>\n\n#define INVALID_SOCKET      (SOCKET)(~0)\n#define WSAENOTSOCK         EBADF\n\ninline int myclosesocket(SOCKET& hSocket)\n{\n    if (hSocket == INVALID_SOCKET)\n        return WSAENOTSOCK;\n#ifdef WIN32\n    int ret = closesocket(hSocket);\n#else\n    int ret = close(hSocket);\n#endif\n    hSocket = INVALID_SOCKET;\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "\"lock \" + fname",
            "errno"
          ],
          "line": 429
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "LockOrUnlock",
          "args": [
            "fd",
            "true"
          ],
          "line": 428
        },
        "resolved": true,
        "details": {
          "function_name": "LockOrUnlock",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "260-269",
          "snippet": "static int LockOrUnlock(int fd, bool lock) {\n  errno = 0;\n  struct flock f;\n  memset(&f, 0, sizeof(f));\n  f.l_type = (lock ? F_WRLCK : F_UNLCK);\n  f.l_whence = SEEK_SET;\n  f.l_start = 0;\n  f.l_len = 0;        // Lock/unlock entire file\n  return fcntl(fd, F_SETLK, &f);\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic int LockOrUnlock(int fd, bool lock) {\n  errno = 0;\n  struct flock f;\n  memset(&f, 0, sizeof(f));\n  f.l_type = (lock ? F_WRLCK : F_UNLCK);\n  f.l_whence = SEEK_SET;\n  f.l_start = 0;\n  f.l_len = 0;        // Lock/unlock entire file\n  return fcntl(fd, F_SETLK, &f);\n}"
        }
      },
      {
        "call_info": {
          "callee": "locks_.Insert",
          "args": [
            "fname"
          ],
          "line": 425
        },
        "resolved": true,
        "details": {
          "function_name": "Insert",
          "container": "PosixLockTable",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "285-288",
          "snippet": "bool Insert(const std::string& fname) {\n    MutexLock l(&mu_);\n    return locked_files_.insert(fname).second;\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixLockTable {\n  bool Insert(const std::string& fname) {\n      MutexLock l(&mu_);\n      return locked_files_.insert(fname).second;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "fname.c_str()",
            "O_RDWR | O_CREAT",
            "0644"
          ],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 422
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status LockFile(const std::string& fname, FileLock** lock) {\n      *lock = NULL;\n      Status result;\n      int fd = open(fname.c_str(), O_RDWR | O_CREAT, 0644);\n      if (fd < 0) {\n        result = IOError(fname, errno);\n      } else if (!locks_.Insert(fname)) {\n        close(fd);\n        result = Status::IOError(\"lock \" + fname, \"already held by process\");\n      } else if (LockOrUnlock(fd, true) == -1) {\n        result = IOError(\"lock \" + fname, errno);\n        close(fd);\n        locks_.Remove(fname);\n      } else {\n        PosixFileLock* my_lock = new PosixFileLock;\n        my_lock->fd_ = fd;\n        my_lock->name_ = fname;\n        *lock = my_lock;\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "RenameFile",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "411-417",
    "snippet": "virtual Status RenameFile(const std::string& src, const std::string& target) {\n    Status result;\n    if (rename(src.c_str(), target.c_str()) != 0) {\n      result = IOError(src, errno);\n    }\n    return result;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "src",
            "errno"
          ],
          "line": 414
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rename",
          "args": [
            "src.c_str()",
            "target.c_str()"
          ],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "target.c_str",
          "args": [],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "src.c_str",
          "args": [],
          "line": 413
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status RenameFile(const std::string& src, const std::string& target) {\n      Status result;\n      if (rename(src.c_str(), target.c_str()) != 0) {\n        result = IOError(src, errno);\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "GetFileSize",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "399-409",
    "snippet": "virtual Status GetFileSize(const std::string& fname, uint64_t* size) {\n    Status s;\n    struct stat sbuf;\n    if (stat(fname.c_str(), &sbuf) != 0) {\n      *size = 0;\n      s = IOError(fname, errno);\n    } else {\n      *size = sbuf.st_size;\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "fname",
            "errno"
          ],
          "line": 404
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "stat",
          "args": [
            "fname.c_str()",
            "&sbuf"
          ],
          "line": 402
        },
        "resolved": true,
        "details": {
          "function_name": "setstate",
          "container": "CAutoFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "1070-1075",
          "snippet": "void setstate(short bits, const char* psz)\n    {\n        state |= bits;\n        if (state & exceptmask)\n            THROW_WITH_STACKTRACE(std::ios_base::failure(psz));\n    }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCAutoFile {\n  void setstate(short bits, const char* psz)\n      {\n          state |= bits;\n          if (state & exceptmask)\n              THROW_WITH_STACKTRACE(std::ios_base::failure(psz));\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 402
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status GetFileSize(const std::string& fname, uint64_t* size) {\n      Status s;\n      struct stat sbuf;\n      if (stat(fname.c_str(), &sbuf) != 0) {\n        *size = 0;\n        s = IOError(fname, errno);\n      } else {\n        *size = sbuf.st_size;\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "DeleteDir",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "391-397",
    "snippet": "virtual Status DeleteDir(const std::string& name) {\n    Status result;\n    if (rmdir(name.c_str()) != 0) {\n      result = IOError(name, errno);\n    }\n    return result;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "name",
            "errno"
          ],
          "line": 394
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "rmdir",
          "args": [
            "name.c_str()"
          ],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 393
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status DeleteDir(const std::string& name) {\n      Status result;\n      if (rmdir(name.c_str()) != 0) {\n        result = IOError(name, errno);\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "CreateDir",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "383-389",
    "snippet": "virtual Status CreateDir(const std::string& name) {\n    Status result;\n    if (mkdir(name.c_str(), 0755) != 0) {\n      result = IOError(name, errno);\n    }\n    return result;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "name",
            "errno"
          ],
          "line": 386
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mkdir",
          "args": [
            "name.c_str()",
            "0755"
          ],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "name.c_str",
          "args": [],
          "line": 385
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status CreateDir(const std::string& name) {\n      Status result;\n      if (mkdir(name.c_str(), 0755) != 0) {\n        result = IOError(name, errno);\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "DeleteFile",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "375-381",
    "snippet": "virtual Status DeleteFile(const std::string& fname) {\n    Status result;\n    if (unlink(fname.c_str()) != 0) {\n      result = IOError(fname, errno);\n    }\n    return result;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "fname",
            "errno"
          ],
          "line": 378
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "unlink",
          "args": [
            "fname.c_str()"
          ],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 377
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status DeleteFile(const std::string& fname) {\n      Status result;\n      if (unlink(fname.c_str()) != 0) {\n        result = IOError(fname, errno);\n      }\n      return result;\n    }\n}"
  },
  {
    "function_name": "GetChildren",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "360-373",
    "snippet": "virtual Status GetChildren(const std::string& dir,\n                             std::vector<std::string>* result) {\n    result->clear();\n    DIR* d = opendir(dir.c_str());\n    if (d == NULL) {\n      return IOError(dir, errno);\n    }\n    struct dirent* entry;\n    while ((entry = readdir(d)) != NULL) {\n      result->push_back(entry->d_name);\n    }\n    closedir(d);\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 372
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "closedir",
          "args": [
            "d"
          ],
          "line": 371
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result->push_back",
          "args": [
            "entry->d_name"
          ],
          "line": 369
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "readdir",
          "args": [
            "d"
          ],
          "line": 368
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "dir",
            "errno"
          ],
          "line": 365
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "opendir",
          "args": [
            "dir.c_str()"
          ],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "dir.c_str",
          "args": [],
          "line": 363
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "result->clear",
          "args": [],
          "line": 362
        },
        "resolved": true,
        "details": {
          "function_name": "clear",
          "container": "CTxMemPool",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/main.cpp",
          "lines": "768-774",
          "snippet": "void CTxMemPool::clear()\n{\n    LOCK(cs);\n    mapTx.clear();\n    mapNextTx.clear();\n    ++nTransactionsUpdated;\n}",
          "includes": [
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <boost/algorithm/string/replace.hpp>",
            "#include \"kernel.h\"",
            "#include \"ui_interface.h\"",
            "#include \"init.h\"",
            "#include \"net.h\"",
            "#include \"txdb.h\"",
            "#include \"db.h\"",
            "#include \"checkpoints.h\"",
            "#include \"alert.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "unsigned int nTransactionsUpdated = 0;"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <boost/algorithm/string/replace.hpp>\n#include \"kernel.h\"\n#include \"ui_interface.h\"\n#include \"init.h\"\n#include \"net.h\"\n#include \"txdb.h\"\n#include \"db.h\"\n#include \"checkpoints.h\"\n#include \"alert.h\"\n\nunsigned int nTransactionsUpdated = 0;\n\nCTxMemPool {\n  void CTxMemPool::clear()\n  {\n      LOCK(cs);\n      mapTx.clear();\n      mapNextTx.clear();\n      ++nTransactionsUpdated;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status GetChildren(const std::string& dir,\n                               std::vector<std::string>* result) {\n      result->clear();\n      DIR* d = opendir(dir.c_str());\n      if (d == NULL) {\n        return IOError(dir, errno);\n      }\n      struct dirent* entry;\n      while ((entry = readdir(d)) != NULL) {\n        result->push_back(entry->d_name);\n      }\n      closedir(d);\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "FileExists",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "356-358",
    "snippet": "virtual bool FileExists(const std::string& fname) {\n    return access(fname.c_str(), F_OK) == 0;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "access",
          "args": [
            "fname.c_str()",
            "F_OK"
          ],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 357
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual bool FileExists(const std::string& fname) {\n      return access(fname.c_str(), F_OK) == 0;\n    }\n}"
  },
  {
    "function_name": "NewWritableFile",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "343-354",
    "snippet": "virtual Status NewWritableFile(const std::string& fname,\n                                 WritableFile** result) {\n    Status s;\n    FILE* f = fopen(fname.c_str(), \"w\");\n    if (f == NULL) {\n      *result = NULL;\n      s = IOError(fname, errno);\n    } else {\n      *result = new PosixWritableFile(fname, f);\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "fname",
            "errno"
          ],
          "line": 349
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "fname.c_str()",
            "\"w\""
          ],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 346
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status NewWritableFile(const std::string& fname,\n                                   WritableFile** result) {\n      Status s;\n      FILE* f = fopen(fname.c_str(), \"w\");\n      if (f == NULL) {\n        *result = NULL;\n        s = IOError(fname, errno);\n      } else {\n        *result = new PosixWritableFile(fname, f);\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "NewRandomAccessFile",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "315-341",
    "snippet": "virtual Status NewRandomAccessFile(const std::string& fname,\n                                     RandomAccessFile** result) {\n    *result = NULL;\n    Status s;\n    int fd = open(fname.c_str(), O_RDONLY);\n    if (fd < 0) {\n      s = IOError(fname, errno);\n    } else if (mmap_limit_.Acquire()) {\n      uint64_t size;\n      s = GetFileSize(fname, &size);\n      if (s.ok()) {\n        void* base = mmap(NULL, size, PROT_READ, MAP_SHARED, fd, 0);\n        if (base != MAP_FAILED) {\n          *result = new PosixMmapReadableFile(fname, base, size, &mmap_limit_);\n        } else {\n          s = IOError(fname, errno);\n        }\n      }\n      close(fd);\n      if (!s.ok()) {\n        mmap_limit_.Release();\n      }\n    } else {\n      *result = new PosixRandomAccessFile(fname, fd);\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mmap_limit_.Release",
          "args": [],
          "line": 335
        },
        "resolved": true,
        "details": {
          "function_name": "Release",
          "container": "MmapLimiter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "123-126",
          "snippet": "void Release() {\n    MutexLock l(&mu_);\n    SetAllowed(GetAllowed() + 1);\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  void Release() {\n      MutexLock l(&mu_);\n      SetAllowed(GetAllowed() + 1);\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 334
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 333
        },
        "resolved": true,
        "details": {
          "function_name": "myclosesocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/compat.h",
          "lines": "50-61",
          "snippet": "inline int myclosesocket(SOCKET& hSocket)\n{\n    if (hSocket == INVALID_SOCKET)\n        return WSAENOTSOCK;\n#ifdef WIN32\n    int ret = closesocket(hSocket);\n#else\n    int ret = close(hSocket);\n#endif\n    hSocket = INVALID_SOCKET;\n    return ret;\n}",
          "includes": [
            "#include \"errno.h\"",
            "#include <ifaddrs.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <ws2tcpip.h>",
            "#include <mswsock.h>",
            "#include <winsock2.h>"
          ],
          "macros_used": [
            "#define INVALID_SOCKET      (SOCKET)(~0)",
            "#define WSAENOTSOCK         EBADF"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"errno.h\"\n#include <ifaddrs.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <sys/fcntl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <ws2tcpip.h>\n#include <mswsock.h>\n#include <winsock2.h>\n\n#define INVALID_SOCKET      (SOCKET)(~0)\n#define WSAENOTSOCK         EBADF\n\ninline int myclosesocket(SOCKET& hSocket)\n{\n    if (hSocket == INVALID_SOCKET)\n        return WSAENOTSOCK;\n#ifdef WIN32\n    int ret = closesocket(hSocket);\n#else\n    int ret = close(hSocket);\n#endif\n    hSocket = INVALID_SOCKET;\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "fname",
            "errno"
          ],
          "line": 330
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "mmap",
          "args": [
            "NULL",
            "size",
            "PROT_READ",
            "MAP_SHARED",
            "fd",
            "0"
          ],
          "line": 326
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GetFileSize",
          "args": [
            "fname",
            "&size"
          ],
          "line": 324
        },
        "resolved": true,
        "details": {
          "function_name": "GetFileSize",
          "container": "PosixEnv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "399-409",
          "snippet": "virtual Status GetFileSize(const std::string& fname, uint64_t* size) {\n    Status s;\n    struct stat sbuf;\n    if (stat(fname.c_str(), &sbuf) != 0) {\n      *size = 0;\n      s = IOError(fname, errno);\n    } else {\n      *size = sbuf.st_size;\n    }\n    return s;\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status GetFileSize(const std::string& fname, uint64_t* size) {\n      Status s;\n      struct stat sbuf;\n      if (stat(fname.c_str(), &sbuf) != 0) {\n        *size = 0;\n        s = IOError(fname, errno);\n      } else {\n        *size = sbuf.st_size;\n      }\n      return s;\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mmap_limit_.Acquire",
          "args": [],
          "line": 322
        },
        "resolved": true,
        "details": {
          "function_name": "Acquire",
          "container": "MmapLimiter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "108-120",
          "snippet": "bool Acquire() {\n    if (GetAllowed() <= 0) {\n      return false;\n    }\n    MutexLock l(&mu_);\n    intptr_t x = GetAllowed();\n    if (x <= 0) {\n      return false;\n    } else {\n      SetAllowed(x - 1);\n      return true;\n    }\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  bool Acquire() {\n      if (GetAllowed() <= 0) {\n        return false;\n      }\n      MutexLock l(&mu_);\n      intptr_t x = GetAllowed();\n      if (x <= 0) {\n        return false;\n      } else {\n        SetAllowed(x - 1);\n        return true;\n      }\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "fname.c_str()",
            "O_RDONLY"
          ],
          "line": 319
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_options_set_max_open_files",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "433-435",
          "snippet": "void leveldb_options_set_max_open_files(leveldb_options_t* opt, int n) {\n  opt->rep.max_open_files = n;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_max_open_files(leveldb_options_t* opt, int n) {\n  opt->rep.max_open_files = n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 319
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status NewRandomAccessFile(const std::string& fname,\n                                       RandomAccessFile** result) {\n      *result = NULL;\n      Status s;\n      int fd = open(fname.c_str(), O_RDONLY);\n      if (fd < 0) {\n        s = IOError(fname, errno);\n      } else if (mmap_limit_.Acquire()) {\n        uint64_t size;\n        s = GetFileSize(fname, &size);\n        if (s.ok()) {\n          void* base = mmap(NULL, size, PROT_READ, MAP_SHARED, fd, 0);\n          if (base != MAP_FAILED) {\n            *result = new PosixMmapReadableFile(fname, base, size, &mmap_limit_);\n          } else {\n            s = IOError(fname, errno);\n          }\n        }\n        close(fd);\n        if (!s.ok()) {\n          mmap_limit_.Release();\n        }\n      } else {\n        *result = new PosixRandomAccessFile(fname, fd);\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "NewSequentialFile",
    "container": "PosixEnv",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "303-313",
    "snippet": "virtual Status NewSequentialFile(const std::string& fname,\n                                   SequentialFile** result) {\n    FILE* f = fopen(fname.c_str(), \"r\");\n    if (f == NULL) {\n      *result = NULL;\n      return IOError(fname, errno);\n    } else {\n      *result = new PosixSequentialFile(fname, f);\n      return Status::OK();\n    }\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 311
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "fname",
            "errno"
          ],
          "line": 308
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fopen",
          "args": [
            "fname.c_str()",
            "\"r\""
          ],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fname.c_str",
          "args": [],
          "line": 305
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixEnv {\n  virtual Status NewSequentialFile(const std::string& fname,\n                                     SequentialFile** result) {\n      FILE* f = fopen(fname.c_str(), \"r\");\n      if (f == NULL) {\n        *result = NULL;\n        return IOError(fname, errno);\n      } else {\n        *result = new PosixSequentialFile(fname, f);\n        return Status::OK();\n      }\n    }\n}"
  },
  {
    "function_name": "Remove",
    "container": "PosixLockTable",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "289-292",
    "snippet": "void Remove(const std::string& fname) {\n    MutexLock l(&mu_);\n    locked_files_.erase(fname);\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "locked_files_.erase",
          "args": [
            "fname"
          ],
          "line": 291
        },
        "resolved": true,
        "details": {
          "function_name": "erase",
          "container": "limitedmap",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/limitedmap.h",
          "lines": "49-65",
          "snippet": "void erase(const key_type& k)\n    {\n        iterator itTarget = map.find(k);\n        if (itTarget == map.end())\n            return;\n        std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n        for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n            if (it->second == itTarget)\n            {\n                rmap.erase(it);\n                map.erase(itTarget);\n                return;\n            }\n        // Shouldn't ever get here\n        assert(0); //TODO remove me\n        map.erase(itTarget);\n    }",
          "includes": [
            "#include <deque>",
            "#include <map>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <deque>\n#include <map>\n\nlimitedmap {\n  void erase(const key_type& k)\n      {\n          iterator itTarget = map.find(k);\n          if (itTarget == map.end())\n              return;\n          std::pair<rmap_iterator, rmap_iterator> itPair = rmap.equal_range(itTarget->second);\n          for (rmap_iterator it = itPair.first; it != itPair.second; ++it)\n              if (it->second == itTarget)\n              {\n                  rmap.erase(it);\n                  map.erase(itTarget);\n                  return;\n              }\n          // Shouldn't ever get here\n          assert(0); //TODO remove me\n          map.erase(itTarget);\n      }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixLockTable {\n  void Remove(const std::string& fname) {\n      MutexLock l(&mu_);\n      locked_files_.erase(fname);\n    }\n}"
  },
  {
    "function_name": "Insert",
    "container": "PosixLockTable",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "285-288",
    "snippet": "bool Insert(const std::string& fname) {\n    MutexLock l(&mu_);\n    return locked_files_.insert(fname).second;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "locked_files_.insert",
          "args": [
            "fname"
          ],
          "line": 287
        },
        "resolved": true,
        "details": {
          "function_name": "insert",
          "container": "CBloomFilter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/bloom.cpp",
          "lines": "61-65",
          "snippet": "void CBloomFilter::insert(const uint256& hash)\n{\n    vector<unsigned char> data(BEGIN(hash), END(hash));\n    insert(data);\n}",
          "includes": [
            "#include \"hash.h\"",
            "#include \"script.h\"",
            "#include \"main.h\"",
            "#include \"bloom.h\"",
            "#include <stdlib.h>",
            "#include <math.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"hash.h\"\n#include \"script.h\"\n#include \"main.h\"\n#include \"bloom.h\"\n#include <stdlib.h>\n#include <math.h>\n\nCBloomFilter {\n  void CBloomFilter::insert(const uint256& hash)\n  {\n      vector<unsigned char> data(BEGIN(hash), END(hash));\n      insert(data);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixLockTable {\n  bool Insert(const std::string& fname) {\n      MutexLock l(&mu_);\n      return locked_files_.insert(fname).second;\n    }\n}"
  },
  {
    "function_name": "LockOrUnlock",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "260-269",
    "snippet": "static int LockOrUnlock(int fd, bool lock) {\n  errno = 0;\n  struct flock f;\n  memset(&f, 0, sizeof(f));\n  f.l_type = (lock ? F_WRLCK : F_UNLCK);\n  f.l_whence = SEEK_SET;\n  f.l_start = 0;\n  f.l_len = 0;        // Lock/unlock entire file\n  return fcntl(fd, F_SETLK, &f);\n}",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "fcntl",
          "args": [
            "fd",
            "F_SETLK",
            "&f"
          ],
          "line": 268
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "memset",
          "args": [
            "&f",
            "0",
            "sizeof(f)"
          ],
          "line": 263
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic int LockOrUnlock(int fd, bool lock) {\n  errno = 0;\n  struct flock f;\n  memset(&f, 0, sizeof(f));\n  f.l_type = (lock ? F_WRLCK : F_UNLCK);\n  f.l_whence = SEEK_SET;\n  f.l_start = 0;\n  f.l_len = 0;        // Lock/unlock entire file\n  return fcntl(fd, F_SETLK, &f);\n}"
  },
  {
    "function_name": "Sync",
    "container": "PosixWritableFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "246-257",
    "snippet": "virtual Status Sync() {\n    // Ensure new files referred to by the manifest are in the filesystem.\n    Status s = SyncDirIfManifest();\n    if (!s.ok()) {\n      return s;\n    }\n    if (fflush_unlocked(file_) != 0 ||\n        fdatasync(fileno(file_)) != 0) {\n      s = Status::IOError(filename_, strerror(errno));\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "filename_",
            "strerror(errno)"
          ],
          "line": 254
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "errno"
          ],
          "line": 254
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fdatasync",
          "args": [
            "fileno(file_)"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fileno",
          "args": [
            "file_"
          ],
          "line": 253
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "fflush_unlocked",
          "args": [
            "file_"
          ],
          "line": 252
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "s.ok",
          "args": [],
          "line": 249
        },
        "resolved": true,
        "details": {
          "function_name": "ok",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "52-52",
          "snippet": "bool ok() const { return (state_ == NULL); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  bool ok() const { return (state_ == NULL); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "SyncDirIfManifest",
          "args": [],
          "line": 248
        },
        "resolved": true,
        "details": {
          "function_name": "SyncDirIfManifest",
          "container": "PosixWritableFile",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "219-244",
          "snippet": "Status SyncDirIfManifest() {\n    const char* f = filename_.c_str();\n    const char* sep = strrchr(f, '/');\n    Slice basename;\n    std::string dir;\n    if (sep == NULL) {\n      dir = \".\";\n      basename = f;\n    } else {\n      dir = std::string(f, sep - f);\n      basename = sep + 1;\n    }\n    Status s;\n    if (basename.starts_with(\"MANIFEST\")) {\n      int fd = open(dir.c_str(), O_RDONLY);\n      if (fd < 0) {\n        s = IOError(dir, errno);\n      } else {\n        if (fsync(fd) < 0) {\n          s = IOError(dir, errno);\n        }\n        close(fd);\n      }\n    }\n    return s;\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixWritableFile {\n  Status SyncDirIfManifest() {\n      const char* f = filename_.c_str();\n      const char* sep = strrchr(f, '/');\n      Slice basename;\n      std::string dir;\n      if (sep == NULL) {\n        dir = \".\";\n        basename = f;\n      } else {\n        dir = std::string(f, sep - f);\n        basename = sep + 1;\n      }\n      Status s;\n      if (basename.starts_with(\"MANIFEST\")) {\n        int fd = open(dir.c_str(), O_RDONLY);\n        if (fd < 0) {\n          s = IOError(dir, errno);\n        } else {\n          if (fsync(fd) < 0) {\n            s = IOError(dir, errno);\n          }\n          close(fd);\n        }\n      }\n      return s;\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixWritableFile {\n  virtual Status Sync() {\n      // Ensure new files referred to by the manifest are in the filesystem.\n      Status s = SyncDirIfManifest();\n      if (!s.ok()) {\n        return s;\n      }\n      if (fflush_unlocked(file_) != 0 ||\n          fdatasync(fileno(file_)) != 0) {\n        s = Status::IOError(filename_, strerror(errno));\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "SyncDirIfManifest",
    "container": "PosixWritableFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "219-244",
    "snippet": "Status SyncDirIfManifest() {\n    const char* f = filename_.c_str();\n    const char* sep = strrchr(f, '/');\n    Slice basename;\n    std::string dir;\n    if (sep == NULL) {\n      dir = \".\";\n      basename = f;\n    } else {\n      dir = std::string(f, sep - f);\n      basename = sep + 1;\n    }\n    Status s;\n    if (basename.starts_with(\"MANIFEST\")) {\n      int fd = open(dir.c_str(), O_RDONLY);\n      if (fd < 0) {\n        s = IOError(dir, errno);\n      } else {\n        if (fsync(fd) < 0) {\n          s = IOError(dir, errno);\n        }\n        close(fd);\n      }\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "close",
          "args": [
            "fd"
          ],
          "line": 240
        },
        "resolved": true,
        "details": {
          "function_name": "myclosesocket",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/compat.h",
          "lines": "50-61",
          "snippet": "inline int myclosesocket(SOCKET& hSocket)\n{\n    if (hSocket == INVALID_SOCKET)\n        return WSAENOTSOCK;\n#ifdef WIN32\n    int ret = closesocket(hSocket);\n#else\n    int ret = close(hSocket);\n#endif\n    hSocket = INVALID_SOCKET;\n    return ret;\n}",
          "includes": [
            "#include \"errno.h\"",
            "#include <ifaddrs.h>",
            "#include <netinet/in.h>",
            "#include <net/if.h>",
            "#include <netdb.h>",
            "#include <arpa/inet.h>",
            "#include <sys/fcntl.h>",
            "#include <sys/socket.h>",
            "#include <sys/types.h>",
            "#include <ws2tcpip.h>",
            "#include <mswsock.h>",
            "#include <winsock2.h>"
          ],
          "macros_used": [
            "#define INVALID_SOCKET      (SOCKET)(~0)",
            "#define WSAENOTSOCK         EBADF"
          ],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"errno.h\"\n#include <ifaddrs.h>\n#include <netinet/in.h>\n#include <net/if.h>\n#include <netdb.h>\n#include <arpa/inet.h>\n#include <sys/fcntl.h>\n#include <sys/socket.h>\n#include <sys/types.h>\n#include <ws2tcpip.h>\n#include <mswsock.h>\n#include <winsock2.h>\n\n#define INVALID_SOCKET      (SOCKET)(~0)\n#define WSAENOTSOCK         EBADF\n\ninline int myclosesocket(SOCKET& hSocket)\n{\n    if (hSocket == INVALID_SOCKET)\n        return WSAENOTSOCK;\n#ifdef WIN32\n    int ret = closesocket(hSocket);\n#else\n    int ret = close(hSocket);\n#endif\n    hSocket = INVALID_SOCKET;\n    return ret;\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "dir",
            "errno"
          ],
          "line": 238
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fsync",
          "args": [
            "fd"
          ],
          "line": 237
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "open",
          "args": [
            "dir.c_str()",
            "O_RDONLY"
          ],
          "line": 233
        },
        "resolved": true,
        "details": {
          "function_name": "leveldb_options_set_max_open_files",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/db/c.cc",
          "lines": "433-435",
          "snippet": "void leveldb_options_set_max_open_files(leveldb_options_t* opt, int n) {\n  opt->rep.max_open_files = n;\n}",
          "includes": [
            "#include \"leveldb/write_batch.h\"",
            "#include \"leveldb/status.h\"",
            "#include \"leveldb/options.h\"",
            "#include \"leveldb/iterator.h\"",
            "#include \"leveldb/filter_policy.h\"",
            "#include \"leveldb/env.h\"",
            "#include \"leveldb/db.h\"",
            "#include \"leveldb/comparator.h\"",
            "#include \"leveldb/cache.h\"",
            "#include <unistd.h>",
            "#include <stdlib.h>",
            "#include \"leveldb/c.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/write_batch.h\"\n#include \"leveldb/status.h\"\n#include \"leveldb/options.h\"\n#include \"leveldb/iterator.h\"\n#include \"leveldb/filter_policy.h\"\n#include \"leveldb/env.h\"\n#include \"leveldb/db.h\"\n#include \"leveldb/comparator.h\"\n#include \"leveldb/cache.h\"\n#include <unistd.h>\n#include <stdlib.h>\n#include \"leveldb/c.h\"\n\nvoid leveldb_options_set_max_open_files(leveldb_options_t* opt, int n) {\n  opt->rep.max_open_files = n;\n}"
        }
      },
      {
        "call_info": {
          "callee": "dir.c_str",
          "args": [],
          "line": 233
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "basename.starts_with",
          "args": [
            "\"MANIFEST\""
          ],
          "line": 232
        },
        "resolved": true,
        "details": {
          "function_name": "starts_with",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "75-78",
          "snippet": "bool starts_with(const Slice& x) const {\n    return ((size_ >= x.size_) &&\n            (memcmp(data_, x.data_, x.size_) == 0));\n  }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  bool starts_with(const Slice& x) const {\n      return ((size_ >= x.size_) &&\n              (memcmp(data_, x.data_, x.size_) == 0));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "std::string",
          "args": [
            "f",
            "sep - f"
          ],
          "line": 228
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "strrchr",
          "args": [
            "f",
            "'/'"
          ],
          "line": 221
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "filename_.c_str",
          "args": [],
          "line": 220
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixWritableFile {\n  Status SyncDirIfManifest() {\n      const char* f = filename_.c_str();\n      const char* sep = strrchr(f, '/');\n      Slice basename;\n      std::string dir;\n      if (sep == NULL) {\n        dir = \".\";\n        basename = f;\n      } else {\n        dir = std::string(f, sep - f);\n        basename = sep + 1;\n      }\n      Status s;\n      if (basename.starts_with(\"MANIFEST\")) {\n        int fd = open(dir.c_str(), O_RDONLY);\n        if (fd < 0) {\n          s = IOError(dir, errno);\n        } else {\n          if (fsync(fd) < 0) {\n            s = IOError(dir, errno);\n          }\n          close(fd);\n        }\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "Flush",
    "container": "PosixWritableFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "212-217",
    "snippet": "virtual Status Flush() {\n    if (fflush_unlocked(file_) != 0) {\n      return IOError(filename_, errno);\n    }\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 216
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "filename_",
            "errno"
          ],
          "line": 214
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fflush_unlocked",
          "args": [
            "file_"
          ],
          "line": 213
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixWritableFile {\n  virtual Status Flush() {\n      if (fflush_unlocked(file_) != 0) {\n        return IOError(filename_, errno);\n      }\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "Close",
    "container": "PosixWritableFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "203-210",
    "snippet": "virtual Status Close() {\n    Status result;\n    if (fclose(file_) != 0) {\n      result = IOError(filename_, errno);\n    }\n    file_ = NULL;\n    return result;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "filename_",
            "errno"
          ],
          "line": 206
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fclose",
          "args": [
            "file_"
          ],
          "line": 205
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixWritableFile {\n  virtual Status Close() {\n      Status result;\n      if (fclose(file_) != 0) {\n        result = IOError(filename_, errno);\n      }\n      file_ = NULL;\n      return result;\n    }\n}"
  },
  {
    "function_name": "Append",
    "container": "PosixWritableFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "195-201",
    "snippet": "virtual Status Append(const Slice& data) {\n    size_t r = fwrite_unlocked(data.data(), 1, data.size(), file_);\n    if (r != data.size()) {\n      return IOError(filename_, errno);\n    }\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 200
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "filename_",
            "errno"
          ],
          "line": 198
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "data.size",
          "args": [],
          "line": 197
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "base_uint",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/uint256.h",
          "lines": "354-357",
          "snippet": "unsigned int size()\n    {\n        return sizeof(pn);\n    }",
          "includes": [
            "#include <string.h>",
            "#include <stdio.h>",
            "#include <stdint.h>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string.h>\n#include <stdio.h>\n#include <stdint.h>\n#include <vector>\n#include <string>\n\nbase_uint {\n  unsigned int size()\n      {\n          return sizeof(pn);\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fwrite_unlocked",
          "args": [
            "data.data()",
            "1",
            "data.size()",
            "file_"
          ],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "data.data",
          "args": [],
          "line": 196
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixWritableFile {\n  virtual Status Append(const Slice& data) {\n      size_t r = fwrite_unlocked(data.data(), 1, data.size(), file_);\n      if (r != data.size()) {\n        return IOError(filename_, errno);\n      }\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "PosixWritableFile",
    "container": "PosixWritableFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "185-186",
    "snippet": "PosixWritableFile(const std::string& fname, FILE* f)\n      : filename_(fname), file_(f) { }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixWritableFile {\n  PosixWritableFile(const std::string& fname, FILE* f)\n        : filename_(fname), file_(f) { }\n}"
  },
  {
    "function_name": "Read",
    "container": "PosixMmapReadableFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "166-176",
    "snippet": "virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                      char* scratch) const {\n    Status s;\n    if (offset + n > length_) {\n      *result = Slice();\n      s = IOError(filename_, EINVAL);\n    } else {\n      *result = Slice(reinterpret_cast<char*>(mmapped_region_) + offset, n);\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "reinterpret_cast<char*>(mmapped_region_) + offset",
            "n"
          ],
          "line": 173
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<char*>",
          "args": [
            "mmapped_region_"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "filename_",
            "EINVAL"
          ],
          "line": 171
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [],
          "line": 170
        },
        "resolved": true,
        "details": {
          "function_name": "ToString",
          "container": "Slice",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/slice.h",
          "lines": "66-66",
          "snippet": "std::string ToString() const { return std::string(data_, size_); }",
          "includes": [
            "#include <string>",
            "#include <string.h>",
            "#include <stddef.h>",
            "#include <assert.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <string>\n#include <string.h>\n#include <stddef.h>\n#include <assert.h>\n\nSlice {\n  std::string ToString() const { return std::string(data_, size_); }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixMmapReadableFile {\n  virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                        char* scratch) const {\n      Status s;\n      if (offset + n > length_) {\n        *result = Slice();\n        s = IOError(filename_, EINVAL);\n      } else {\n        *result = Slice(reinterpret_cast<char*>(mmapped_region_) + offset, n);\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "PosixMmapReadableFile",
    "container": "PosixMmapReadableFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "155-159",
    "snippet": "PosixMmapReadableFile(const std::string& fname, void* base, size_t length,\n                        MmapLimiter* limiter)\n      : filename_(fname), mmapped_region_(base), length_(length),\n        limiter_(limiter) {\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixMmapReadableFile {\n  PosixMmapReadableFile(const std::string& fname, void* base, size_t length,\n                          MmapLimiter* limiter)\n        : filename_(fname), mmapped_region_(base), length_(length),\n          limiter_(limiter) {\n    }\n}"
  },
  {
    "function_name": "SetAllowed",
    "container": "MmapLimiter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "137-139",
    "snippet": "void SetAllowed(intptr_t v) {\n    allowed_.Release_Store(reinterpret_cast<void*>(v));\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "allowed_.Release_Store",
          "args": [
            "reinterpret_cast<void*>(v)"
          ],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "Release_Store",
          "container": "AtomicPointer",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/port/atomic_pointer.h",
          "lines": "198-205",
          "snippet": "inline void Release_Store(void* v) {\n    __asm__ __volatile__ (\n        \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n        :\n        : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n        : \"memory\"\n        );\n  }",
          "includes": [
            "#include <libkern/OSAtomic.h>",
            "#include <windows.h>",
            "#include <cstdatomic>",
            "#include <stdint.h>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <libkern/OSAtomic.h>\n#include <windows.h>\n#include <cstdatomic>\n#include <stdint.h>\n\nAtomicPointer {\n  inline void Release_Store(void* v) {\n      __asm__ __volatile__ (\n          \"st8.rel [%[rep_]] = %[v]  \\n\\t\"\n          :\n          : [rep_] \"r\" (&rep_), [v] \"r\" (v)\n          : \"memory\"\n          );\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "reinterpret_cast<void*>",
          "args": [
            "v"
          ],
          "line": 138
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  void SetAllowed(intptr_t v) {\n      allowed_.Release_Store(reinterpret_cast<void*>(v));\n    }\n}"
  },
  {
    "function_name": "GetAllowed",
    "container": "MmapLimiter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "132-134",
    "snippet": "intptr_t GetAllowed() const {\n    return reinterpret_cast<intptr_t>(allowed_.Acquire_Load());\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "reinterpret_cast<intptr_t>",
          "args": [
            "allowed_.Acquire_Load()"
          ],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "allowed_.Acquire_Load",
          "args": [],
          "line": 133
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  intptr_t GetAllowed() const {\n      return reinterpret_cast<intptr_t>(allowed_.Acquire_Load());\n    }\n}"
  },
  {
    "function_name": "Release",
    "container": "MmapLimiter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "123-126",
    "snippet": "void Release() {\n    MutexLock l(&mu_);\n    SetAllowed(GetAllowed() + 1);\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetAllowed",
          "args": [
            "GetAllowed() + 1"
          ],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "SetAllowed",
          "container": "MmapLimiter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "137-139",
          "snippet": "void SetAllowed(intptr_t v) {\n    allowed_.Release_Store(reinterpret_cast<void*>(v));\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  void SetAllowed(intptr_t v) {\n      allowed_.Release_Store(reinterpret_cast<void*>(v));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetAllowed",
          "args": [],
          "line": 125
        },
        "resolved": true,
        "details": {
          "function_name": "GetAllowed",
          "container": "MmapLimiter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "132-134",
          "snippet": "intptr_t GetAllowed() const {\n    return reinterpret_cast<intptr_t>(allowed_.Acquire_Load());\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  intptr_t GetAllowed() const {\n      return reinterpret_cast<intptr_t>(allowed_.Acquire_Load());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  void Release() {\n      MutexLock l(&mu_);\n      SetAllowed(GetAllowed() + 1);\n    }\n}"
  },
  {
    "function_name": "Acquire",
    "container": "MmapLimiter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "108-120",
    "snippet": "bool Acquire() {\n    if (GetAllowed() <= 0) {\n      return false;\n    }\n    MutexLock l(&mu_);\n    intptr_t x = GetAllowed();\n    if (x <= 0) {\n      return false;\n    } else {\n      SetAllowed(x - 1);\n      return true;\n    }\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetAllowed",
          "args": [
            "x - 1"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "SetAllowed",
          "container": "MmapLimiter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "137-139",
          "snippet": "void SetAllowed(intptr_t v) {\n    allowed_.Release_Store(reinterpret_cast<void*>(v));\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  void SetAllowed(intptr_t v) {\n      allowed_.Release_Store(reinterpret_cast<void*>(v));\n    }\n}"
        }
      },
      {
        "call_info": {
          "callee": "GetAllowed",
          "args": [],
          "line": 113
        },
        "resolved": true,
        "details": {
          "function_name": "GetAllowed",
          "container": "MmapLimiter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "132-134",
          "snippet": "intptr_t GetAllowed() const {\n    return reinterpret_cast<intptr_t>(allowed_.Acquire_Load());\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  intptr_t GetAllowed() const {\n      return reinterpret_cast<intptr_t>(allowed_.Acquire_Load());\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  bool Acquire() {\n      if (GetAllowed() <= 0) {\n        return false;\n      }\n      MutexLock l(&mu_);\n      intptr_t x = GetAllowed();\n      if (x <= 0) {\n        return false;\n      } else {\n        SetAllowed(x - 1);\n        return true;\n      }\n    }\n}"
  },
  {
    "function_name": "MmapLimiter",
    "container": "MmapLimiter",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "102-104",
    "snippet": "MmapLimiter() {\n    SetAllowed(sizeof(void*) >= 8 ? 1000 : 0);\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "SetAllowed",
          "args": [
            "sizeof(void*) >= 8 ? 1000 : 0"
          ],
          "line": 103
        },
        "resolved": true,
        "details": {
          "function_name": "SetAllowed",
          "container": "MmapLimiter",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "137-139",
          "snippet": "void SetAllowed(intptr_t v) {\n    allowed_.Release_Store(reinterpret_cast<void*>(v));\n  }",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  void SetAllowed(intptr_t v) {\n      allowed_.Release_Store(reinterpret_cast<void*>(v));\n    }\n}"
        }
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nMmapLimiter {\n  MmapLimiter() {\n      SetAllowed(sizeof(void*) >= 8 ? 1000 : 0);\n    }\n}"
  },
  {
    "function_name": "Read",
    "container": "PosixRandomAccessFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "83-93",
    "snippet": "virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                      char* scratch) const {\n    Status s;\n    ssize_t r = pread(fd_, scratch, n, static_cast<off_t>(offset));\n    *result = Slice(scratch, (r < 0) ? 0 : r);\n    if (r < 0) {\n      // An error: return a non-ok status\n      s = IOError(filename_, errno);\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "filename_",
            "errno"
          ],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "scratch",
            "(r < 0) ? 0 : r"
          ],
          "line": 87
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "pread",
          "args": [
            "fd_",
            "scratch",
            "n",
            "static_cast<off_t>(offset)"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "static_cast<off_t>",
          "args": [
            "offset"
          ],
          "line": 86
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixRandomAccessFile {\n  virtual Status Read(uint64_t offset, size_t n, Slice* result,\n                        char* scratch) const {\n      Status s;\n      ssize_t r = pread(fd_, scratch, n, static_cast<off_t>(offset));\n      *result = Slice(scratch, (r < 0) ? 0 : r);\n      if (r < 0) {\n        // An error: return a non-ok status\n        s = IOError(filename_, errno);\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "PosixRandomAccessFile",
    "container": "PosixRandomAccessFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "79-80",
    "snippet": "PosixRandomAccessFile(const std::string& fname, int fd)\n      : filename_(fname), fd_(fd) { }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixRandomAccessFile {\n  PosixRandomAccessFile(const std::string& fname, int fd)\n        : filename_(fname), fd_(fd) { }\n}"
  },
  {
    "function_name": "Skip",
    "container": "PosixSequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "64-69",
    "snippet": "virtual Status Skip(uint64_t n) {\n    if (fseek(file_, n, SEEK_CUR)) {\n      return IOError(filename_, errno);\n    }\n    return Status::OK();\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::OK",
          "args": [],
          "line": 68
        },
        "resolved": true,
        "details": {
          "function_name": "OK",
          "container": "Status",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/include/leveldb/status.h",
          "lines": "32-32",
          "snippet": "static Status OK() { return Status(); }",
          "includes": [
            "#include \"leveldb/slice.h\"",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"leveldb/slice.h\"\n#include <string>\n\nStatus {\n  static Status OK() { return Status(); }\n}"
        }
      },
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "filename_",
            "errno"
          ],
          "line": 66
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "fseek",
          "args": [
            "file_",
            "n",
            "SEEK_CUR"
          ],
          "line": 65
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixSequentialFile {\n  virtual Status Skip(uint64_t n) {\n      if (fseek(file_, n, SEEK_CUR)) {\n        return IOError(filename_, errno);\n      }\n      return Status::OK();\n    }\n}"
  },
  {
    "function_name": "Read",
    "container": "PosixSequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "49-62",
    "snippet": "virtual Status Read(size_t n, Slice* result, char* scratch) {\n    Status s;\n    size_t r = fread_unlocked(scratch, 1, n, file_);\n    *result = Slice(scratch, r);\n    if (r < n) {\n      if (feof(file_)) {\n        // We leave status as ok if we hit the end of the file\n      } else {\n        // A partial read with an error: return a non-ok status\n        s = IOError(filename_, errno);\n      }\n    }\n    return s;\n  }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "IOError",
          "args": [
            "filename_",
            "errno"
          ],
          "line": 58
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "includes": [
            "#include \"util/posix_logger.h\"",
            "#include \"util/mutexlock.h\"",
            "#include \"util/logging.h\"",
            "#include \"port/port.h\"",
            "#include \"leveldb/slice.h\"",
            "#include \"leveldb/env.h\"",
            "#include <sys/stat.h>",
            "#include <unistd.h>",
            "#include <time.h>",
            "#include <sys/types.h>",
            "#include <sys/time.h>",
            "#include <sys/stat.h>",
            "#include <sys/mman.h>",
            "#include <string.h>",
            "#include <stdlib.h>",
            "#include <stdio.h>",
            "#include <pthread.h>",
            "#include <fcntl.h>",
            "#include <errno.h>",
            "#include <dirent.h>",
            "#include <set>",
            "#include <deque>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
        }
      },
      {
        "call_info": {
          "callee": "feof",
          "args": [
            "file_"
          ],
          "line": 54
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Slice",
          "args": [
            "scratch",
            "r"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "GetLengthPrefixedSlice",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/coding.cc",
          "lines": "182-192",
          "snippet": "bool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}",
          "includes": [
            "#include \"util/coding.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"util/coding.h\"\n\nbool GetLengthPrefixedSlice(Slice* input, Slice* result) {\n  uint32_t len;\n  if (GetVarint32(input, &len) &&\n      input->size() >= len) {\n    *result = Slice(input->data(), len);\n    input->remove_prefix(len);\n    return true;\n  } else {\n    return false;\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "fread_unlocked",
          "args": [
            "scratch",
            "1",
            "n",
            "file_"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixSequentialFile {\n  virtual Status Read(size_t n, Slice* result, char* scratch) {\n      Status s;\n      size_t r = fread_unlocked(scratch, 1, n, file_);\n      *result = Slice(scratch, r);\n      if (r < n) {\n        if (feof(file_)) {\n          // We leave status as ok if we hit the end of the file\n        } else {\n          // A partial read with an error: return a non-ok status\n          s = IOError(filename_, errno);\n        }\n      }\n      return s;\n    }\n}"
  },
  {
    "function_name": "PosixSequentialFile",
    "container": "PosixSequentialFile",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "45-46",
    "snippet": "PosixSequentialFile(const std::string& fname, FILE* f)\n      : filename_(fname), file_(f) { }",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nPosixSequentialFile {\n  PosixSequentialFile(const std::string& fname, FILE* f)\n        : filename_(fname), file_(f) { }\n}"
  },
  {
    "function_name": "IOError",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
    "lines": "35-37",
    "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
    "includes": [
      "#include \"util/posix_logger.h\"",
      "#include \"util/mutexlock.h\"",
      "#include \"util/logging.h\"",
      "#include \"port/port.h\"",
      "#include \"leveldb/slice.h\"",
      "#include \"leveldb/env.h\"",
      "#include <sys/stat.h>",
      "#include <unistd.h>",
      "#include <time.h>",
      "#include <sys/types.h>",
      "#include <sys/time.h>",
      "#include <sys/stat.h>",
      "#include <sys/mman.h>",
      "#include <string.h>",
      "#include <stdlib.h>",
      "#include <stdio.h>",
      "#include <pthread.h>",
      "#include <fcntl.h>",
      "#include <errno.h>",
      "#include <dirent.h>",
      "#include <set>",
      "#include <deque>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Status::IOError",
          "args": [
            "context",
            "strerror(err_number)"
          ],
          "line": 36
        },
        "resolved": true,
        "details": {
          "function_name": "IOError",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/leveldb/util/env_posix.cc",
          "lines": "35-37",
          "snippet": "static Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "strerror",
          "args": [
            "err_number"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include \"util/posix_logger.h\"\n#include \"util/mutexlock.h\"\n#include \"util/logging.h\"\n#include \"port/port.h\"\n#include \"leveldb/slice.h\"\n#include \"leveldb/env.h\"\n#include <sys/stat.h>\n#include <unistd.h>\n#include <time.h>\n#include <sys/types.h>\n#include <sys/time.h>\n#include <sys/stat.h>\n#include <sys/mman.h>\n#include <string.h>\n#include <stdlib.h>\n#include <stdio.h>\n#include <pthread.h>\n#include <fcntl.h>\n#include <errno.h>\n#include <dirent.h>\n#include <set>\n#include <deque>\n\nstatic Status IOError(const std::string& context, int err_number) {\n  return Status::IOError(context, strerror(err_number));\n}"
  }
]