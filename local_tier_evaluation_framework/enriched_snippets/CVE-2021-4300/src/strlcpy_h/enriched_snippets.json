[
  {
    "function_name": "strlcat",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/strlcpy.h",
    "lines": "62-89",
    "snippet": "inline size_t strlcat(char *dst, const char *src, size_t siz)\n{\n    char *d = dst;\n    const char *s = src;\n    size_t n = siz;\n    size_t dlen;\n\n    /* Find the end of dst and adjust bytes left but don't go past end */\n    while (n-- != 0 && *d != '\\0')\n        d++;\n    dlen = d - dst;\n    n = siz - dlen;\n\n    if (n == 0)\n        return(dlen + strlen(s));\n    while (*s != '\\0')\n    {\n        if (n != 1)\n        {\n            *d++ = *s;\n            n--;\n        }\n        s++;\n    }\n    *d = '\\0';\n\n    return(dlen + (s - src)); /* count does not include NUL */\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "strlen",
          "args": [
            "s"
          ],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\ninline size_t strlcat(char *dst, const char *src, size_t siz)\n{\n    char *d = dst;\n    const char *s = src;\n    size_t n = siz;\n    size_t dlen;\n\n    /* Find the end of dst and adjust bytes left but don't go past end */\n    while (n-- != 0 && *d != '\\0')\n        d++;\n    dlen = d - dst;\n    n = siz - dlen;\n\n    if (n == 0)\n        return(dlen + strlen(s));\n    while (*s != '\\0')\n    {\n        if (n != 1)\n        {\n            *d++ = *s;\n            n--;\n        }\n        s++;\n    }\n    *d = '\\0';\n\n    return(dlen + (s - src)); /* count does not include NUL */\n}"
  },
  {
    "function_name": "strlcpy",
    "container": null,
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/strlcpy.h",
    "lines": "27-53",
    "snippet": "inline size_t strlcpy(char *dst, const char *src, size_t siz)\n{\n    char *d = dst;\n    const char *s = src;\n    size_t n = siz;\n\n    /* Copy as many bytes as will fit */\n    if (n != 0)\n    {\n        while (--n != 0)\n        {\n            if ((*d++ = *s++) == '\\0')\n                break;\n        }\n    }\n\n    /* Not enough room in dst, add NUL and traverse rest of src */\n    if (n == 0)\n    {\n        if (siz != 0)\n            *d = '\\0';  /* NUL-terminate dst */\n        while (*s++)\n            ;\n    }\n\n    return(s - src - 1); /* count does not include NUL */\n}",
    "includes": [
      "#include <string.h>",
      "#include <stdlib.h>"
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <string.h>\n#include <stdlib.h>\n\ninline size_t strlcpy(char *dst, const char *src, size_t siz)\n{\n    char *d = dst;\n    const char *s = src;\n    size_t n = siz;\n\n    /* Copy as many bytes as will fit */\n    if (n != 0)\n    {\n        while (--n != 0)\n        {\n            if ((*d++ = *s++) == '\\0')\n                break;\n        }\n    }\n\n    /* Not enough room in dst, add NUL and traverse rest of src */\n    if (n == 0)\n    {\n        if (siz != 0)\n            *d = '\\0';  /* NUL-terminate dst */\n        while (*s++)\n            ;\n    }\n\n    return(s - src - 1); /* count does not include NUL */\n}"
  }
]