[
  {
    "function_name": "data(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "163-181",
    "snippet": "Variant BitcoinUnits::data(const QModelIndex &index, int role) const\n{\n    int row = index.row();\n    if(row >= 0 && row < unitlist.size())\n    {\n        Unit unit = unitlist.at(row);\n        switch(role)\n        {\n        case Qt::EditRole:\n        case Qt::DisplayRole:\n            return QVariant(name(unit));\n        case Qt::ToolTipRole:\n            return QVariant(description(unit));\n        case UnitRole:\n            return QVariant(static_cast<int>(unit));\n        }\n    }\n    return QVariant();\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "Variant(",
          "args": [],
          "line": 180
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [
            "tatic_cast<int>(unit))"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tatic_cast<int>",
          "args": [
            "nit)"
          ],
          "line": 177
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [
            "escription(unit))"
          ],
          "line": 175
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "escription(",
          "args": [
            "nit)"
          ],
          "line": 175
        },
        "resolved": true,
        "details": {
          "function_name": "description(",
          "container": "itcoinUnits",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
          "lines": "44-53",
          "snippet": "String BitcoinUnits::description(int unit)\n{\n    switch(unit)\n    {\n    case BTC: return QString(\"halcyons\");\n    case mBTC: return QString(\"Milli-halcyons (1 / 1,000)\");\n    case uBTC: return QString(\"Micro-halcyons (1 / 1,000,000)\");\n    default: return QString(\"???\");\n    }\n}",
          "includes": [
            "#include <QStringList>",
            "#include \"bitcoinunits.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  String BitcoinUnits::description(int unit)\n  {\n      switch(unit)\n      {\n      case BTC: return QString(\"halcyons\");\n      case mBTC: return QString(\"Milli-halcyons (1 / 1,000)\");\n      case uBTC: return QString(\"Micro-halcyons (1 / 1,000,000)\");\n      default: return QString(\"???\");\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "Variant(",
          "args": [
            "ame(unit))"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ame(",
          "args": [
            "nit)"
          ],
          "line": 173
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nitlist.at",
          "args": [
            "ow)"
          ],
          "line": 168
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "nitlist.size",
          "args": [],
          "line": 166
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ndex.row",
          "args": [],
          "line": 165
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  Variant BitcoinUnits::data(const QModelIndex &index, int role) const\n  {\n      int row = index.row();\n      if(row >= 0 && row < unitlist.size())\n      {\n          Unit unit = unitlist.at(row);\n          switch(role)\n          {\n          case Qt::EditRole:\n          case Qt::DisplayRole:\n              return QVariant(name(unit));\n          case Qt::ToolTipRole:\n              return QVariant(description(unit));\n          case UnitRole:\n              return QVariant(static_cast<int>(unit));\n          }\n      }\n      return QVariant();\n  }\n}"
  },
  {
    "function_name": "rowCount(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "157-161",
    "snippet": "nt BitcoinUnits::rowCount(const QModelIndex &parent) const\n{\n    Q_UNUSED(parent);\n    return unitlist.size();\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "nitlist.size",
          "args": [],
          "line": 160
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "_UNUSED(",
          "args": [
            "arent)"
          ],
          "line": 159
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  nt BitcoinUnits::rowCount(const QModelIndex &parent) const\n  {\n      Q_UNUSED(parent);\n      return unitlist.size();\n  }\n}"
  },
  {
    "function_name": "parse(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "120-155",
    "snippet": "ool BitcoinUnits::parse(int unit, const QString &value, qint64 *val_out)\n{\n    if(!valid(unit) || value.isEmpty())\n        return false; // Refuse to parse invalid unit or empty string\n    int num_decimals = decimals(unit);\n    QStringList parts = value.split(\".\");\n\n    if(parts.size() > 2)\n    {\n        return false; // More than one dot\n    }\n    QString whole = parts[0];\n    QString decimals;\n\n    if(parts.size() > 1)\n    {\n        decimals = parts[1];\n    }\n    if(decimals.size() > num_decimals)\n    {\n        return false; // Exceeds max precision\n    }\n    bool ok = false;\n    QString str = whole + decimals.leftJustified(num_decimals, '0');\n\n    if(str.size() > 18)\n    {\n        return false; // Longer numbers will exceed 63 bits\n    }\n    qint64 retvalue = str.toLongLong(&ok);\n    if(val_out)\n    {\n        *val_out = retvalue;\n    }\n    return ok;\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "tr.toLongLong",
          "args": [
            "ok)"
          ],
          "line": 149
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr.size",
          "args": [],
          "line": 145
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "CDataStream",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/serialize.h",
          "lines": "802-802",
          "snippet": "size_type size() const                           { return vch.size() - nReadPos; }",
          "includes": [
            "#include \"version.h\"",
            "#include \"allocators.h\"",
            "#include <boost/tuple/tuple.hpp>",
            "#include <boost/type_traits/is_fundamental.hpp>",
            "#include <cstdio>",
            "#include <cstring>",
            "#include <stdint.h>",
            "#include <limits>",
            "#include <cassert>",
            "#include <set>",
            "#include <map>",
            "#include <vector>",
            "#include <string>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"version.h\"\n#include \"allocators.h\"\n#include <boost/tuple/tuple.hpp>\n#include <boost/type_traits/is_fundamental.hpp>\n#include <cstdio>\n#include <cstring>\n#include <stdint.h>\n#include <limits>\n#include <cassert>\n#include <set>\n#include <map>\n#include <vector>\n#include <string>\n\nCDataStream {\n  size_type size() const                           { return vch.size() - nReadPos; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ecimals.leftJustified",
          "args": [
            "um_decimals,",
            "0')"
          ],
          "line": 143
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecimals.size",
          "args": [],
          "line": 138
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "alue.split",
          "args": [
            ".\")"
          ],
          "line": 125
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecimals(",
          "args": [
            "nit)"
          ],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "decimals(",
          "container": "itcoinUnits",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
          "lines": "77-86",
          "snippet": "nt BitcoinUnits::decimals(int unit)\n{\n    switch(unit)\n    {\n    case BTC: return 8;\n    case mBTC: return 5;\n    case uBTC: return 2;\n    default: return 0;\n    }\n}",
          "includes": [
            "#include <QStringList>",
            "#include \"bitcoinunits.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  nt BitcoinUnits::decimals(int unit)\n  {\n      switch(unit)\n      {\n      case BTC: return 8;\n      case mBTC: return 5;\n      case uBTC: return 2;\n      default: return 0;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "alue.isEmpty",
          "args": [],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alid(",
          "args": [
            "nit)"
          ],
          "line": 122
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  ool BitcoinUnits::parse(int unit, const QString &value, qint64 *val_out)\n  {\n      if(!valid(unit) || value.isEmpty())\n          return false; // Refuse to parse invalid unit or empty string\n      int num_decimals = decimals(unit);\n      QStringList parts = value.split(\".\");\n  \n      if(parts.size() > 2)\n      {\n          return false; // More than one dot\n      }\n      QString whole = parts[0];\n      QString decimals;\n  \n      if(parts.size() > 1)\n      {\n          decimals = parts[1];\n      }\n      if(decimals.size() > num_decimals)\n      {\n          return false; // Exceeds max precision\n      }\n      bool ok = false;\n      QString str = whole + decimals.leftJustified(num_decimals, '0');\n  \n      if(str.size() > 18)\n      {\n          return false; // Longer numbers will exceed 63 bits\n      }\n      qint64 retvalue = str.toLongLong(&ok);\n      if(val_out)\n      {\n          *val_out = retvalue;\n      }\n      return ok;\n  }\n}"
  },
  {
    "function_name": "formatWithUnit(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "115-118",
    "snippet": "String BitcoinUnits::formatWithUnit(int unit, qint64 amount, bool plussign)\n{\n    return format(unit, amount, plussign) + QString(\" \") + name(unit);\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ame(",
          "args": [
            "nit)"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "\")"
          ],
          "line": 117
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ormat(",
          "args": [
            "nit,",
            "mount,",
            "lussign)"
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "format(",
          "container": "itcoinUnits",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
          "lines": "88-113",
          "snippet": "String BitcoinUnits::format(int unit, qint64 n, bool fPlus)\n{\n    // Note: not using straight sprintf here because we do NOT want\n    // localized number formatting.\n    if(!valid(unit))\n        return QString(); // Refuse to format invalid unit\n    qint64 coin = factor(unit);\n    int num_decimals = decimals(unit);\n    qint64 n_abs = (n > 0 ? n : -n);\n    qint64 quotient = n_abs / coin;\n    qint64 remainder = n_abs % coin;\n    QString quotient_str = QString::number(quotient);\n    QString remainder_str = QString::number(remainder).rightJustified(num_decimals, '0');\n\n    // Right-trim excess zeros after the decimal point\n    int nTrim = 0;\n    for (int i = remainder_str.size()-1; i>=2 && (remainder_str.at(i) == '0'); --i)\n        ++nTrim;\n    remainder_str.chop(nTrim);\n\n    if (n < 0)\n        quotient_str.insert(0, '-');\n    else if (fPlus && n > 0)\n        quotient_str.insert(0, '+');\n    return quotient_str + QString(\".\") + remainder_str;\n}",
          "includes": [
            "#include <QStringList>",
            "#include \"bitcoinunits.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  String BitcoinUnits::format(int unit, qint64 n, bool fPlus)\n  {\n      // Note: not using straight sprintf here because we do NOT want\n      // localized number formatting.\n      if(!valid(unit))\n          return QString(); // Refuse to format invalid unit\n      qint64 coin = factor(unit);\n      int num_decimals = decimals(unit);\n      qint64 n_abs = (n > 0 ? n : -n);\n      qint64 quotient = n_abs / coin;\n      qint64 remainder = n_abs % coin;\n      QString quotient_str = QString::number(quotient);\n      QString remainder_str = QString::number(remainder).rightJustified(num_decimals, '0');\n  \n      // Right-trim excess zeros after the decimal point\n      int nTrim = 0;\n      for (int i = remainder_str.size()-1; i>=2 && (remainder_str.at(i) == '0'); --i)\n          ++nTrim;\n      remainder_str.chop(nTrim);\n  \n      if (n < 0)\n          quotient_str.insert(0, '-');\n      else if (fPlus && n > 0)\n          quotient_str.insert(0, '+');\n      return quotient_str + QString(\".\") + remainder_str;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  String BitcoinUnits::formatWithUnit(int unit, qint64 amount, bool plussign)\n  {\n      return format(unit, amount, plussign) + QString(\" \") + name(unit);\n  }\n}"
  },
  {
    "function_name": "format(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "88-113",
    "snippet": "String BitcoinUnits::format(int unit, qint64 n, bool fPlus)\n{\n    // Note: not using straight sprintf here because we do NOT want\n    // localized number formatting.\n    if(!valid(unit))\n        return QString(); // Refuse to format invalid unit\n    qint64 coin = factor(unit);\n    int num_decimals = decimals(unit);\n    qint64 n_abs = (n > 0 ? n : -n);\n    qint64 quotient = n_abs / coin;\n    qint64 remainder = n_abs % coin;\n    QString quotient_str = QString::number(quotient);\n    QString remainder_str = QString::number(remainder).rightJustified(num_decimals, '0');\n\n    // Right-trim excess zeros after the decimal point\n    int nTrim = 0;\n    for (int i = remainder_str.size()-1; i>=2 && (remainder_str.at(i) == '0'); --i)\n        ++nTrim;\n    remainder_str.chop(nTrim);\n\n    if (n < 0)\n        quotient_str.insert(0, '-');\n    else if (fPlus && n > 0)\n        quotient_str.insert(0, '+');\n    return quotient_str + QString(\".\") + remainder_str;\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "String(",
          "args": [
            ".\")"
          ],
          "line": 112
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uotient_str.insert",
          "args": [
            ",",
            "+')"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "uotient_str.insert",
          "args": [
            ",",
            "-')"
          ],
          "line": 109
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "emainder_str.chop",
          "args": [
            "Trim)"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "emainder_str.at",
          "args": [
            ")"
          ],
          "line": 104
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "emainder_str.size",
          "args": [],
          "line": 104
        },
        "resolved": true,
        "details": {
          "function_name": "size",
          "container": "TransactionTablePriv",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/transactiontablemodel.cpp",
          "lines": "170-173",
          "snippet": "int size()\n    {\n        return cachedWallet.size();\n    }",
          "includes": [
            "#include <QtAlgorithms>",
            "#include <QDateTime>",
            "#include <QIcon>",
            "#include <QTimer>",
            "#include <QColor>",
            "#include <QList>",
            "#include <QLocale>",
            "#include \"ui_interface.h\"",
            "#include \"wallet.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"transactiondesc.h\"",
            "#include \"guiconstants.h\"",
            "#include \"transactionrecord.h\"",
            "#include \"guiutil.h\"",
            "#include \"transactiontablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QtAlgorithms>\n#include <QDateTime>\n#include <QIcon>\n#include <QTimer>\n#include <QColor>\n#include <QList>\n#include <QLocale>\n#include \"ui_interface.h\"\n#include \"wallet.h\"\n#include \"bitcoinunits.h\"\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"transactiondesc.h\"\n#include \"guiconstants.h\"\n#include \"transactionrecord.h\"\n#include \"guiutil.h\"\n#include \"transactiontablemodel.h\"\n\nTransactionTablePriv {\n  int size()\n      {\n          return cachedWallet.size();\n      }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String::number",
          "args": [
            "um_decimals,",
            "0')"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::number(",
          "args": [
            "emainder)"
          ],
          "line": 100
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String::number(",
          "args": [
            "uotient)"
          ],
          "line": 99
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ecimals(",
          "args": [
            "nit)"
          ],
          "line": 95
        },
        "resolved": true,
        "details": {
          "function_name": "decimals(",
          "container": "itcoinUnits",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
          "lines": "77-86",
          "snippet": "nt BitcoinUnits::decimals(int unit)\n{\n    switch(unit)\n    {\n    case BTC: return 8;\n    case mBTC: return 5;\n    case uBTC: return 2;\n    default: return 0;\n    }\n}",
          "includes": [
            "#include <QStringList>",
            "#include \"bitcoinunits.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  nt BitcoinUnits::decimals(int unit)\n  {\n      switch(unit)\n      {\n      case BTC: return 8;\n      case mBTC: return 5;\n      case uBTC: return 2;\n      default: return 0;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "actor(",
          "args": [
            "nit)"
          ],
          "line": 94
        },
        "resolved": true,
        "details": {
          "function_name": "factor(",
          "container": "itcoinUnits",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
          "lines": "55-64",
          "snippet": "int64 BitcoinUnits::factor(int unit)\n{\n    switch(unit)\n    {\n    case BTC:  return 100000000;\n    case mBTC: return 100000;\n    case uBTC: return 100;\n    default:   return 100000000;\n    }\n}",
          "includes": [
            "#include <QStringList>",
            "#include \"bitcoinunits.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  int64 BitcoinUnits::factor(int unit)\n  {\n      switch(unit)\n      {\n      case BTC:  return 100000000;\n      case mBTC: return 100000;\n      case uBTC: return 100;\n      default:   return 100000000;\n      }\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [],
          "line": 93
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "alid(",
          "args": [
            "nit)"
          ],
          "line": 92
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  String BitcoinUnits::format(int unit, qint64 n, bool fPlus)\n  {\n      // Note: not using straight sprintf here because we do NOT want\n      // localized number formatting.\n      if(!valid(unit))\n          return QString(); // Refuse to format invalid unit\n      qint64 coin = factor(unit);\n      int num_decimals = decimals(unit);\n      qint64 n_abs = (n > 0 ? n : -n);\n      qint64 quotient = n_abs / coin;\n      qint64 remainder = n_abs % coin;\n      QString quotient_str = QString::number(quotient);\n      QString remainder_str = QString::number(remainder).rightJustified(num_decimals, '0');\n  \n      // Right-trim excess zeros after the decimal point\n      int nTrim = 0;\n      for (int i = remainder_str.size()-1; i>=2 && (remainder_str.at(i) == '0'); --i)\n          ++nTrim;\n      remainder_str.chop(nTrim);\n  \n      if (n < 0)\n          quotient_str.insert(0, '-');\n      else if (fPlus && n > 0)\n          quotient_str.insert(0, '+');\n      return quotient_str + QString(\".\") + remainder_str;\n  }\n}"
  },
  {
    "function_name": "decimals(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "77-86",
    "snippet": "nt BitcoinUnits::decimals(int unit)\n{\n    switch(unit)\n    {\n    case BTC: return 8;\n    case mBTC: return 5;\n    case uBTC: return 2;\n    default: return 0;\n    }\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  nt BitcoinUnits::decimals(int unit)\n  {\n      switch(unit)\n      {\n      case BTC: return 8;\n      case mBTC: return 5;\n      case uBTC: return 2;\n      default: return 0;\n      }\n  }\n}"
  },
  {
    "function_name": "amountDigits(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "66-75",
    "snippet": "nt BitcoinUnits::amountDigits(int unit)\n{\n    switch(unit)\n    {\n    case BTC: return 8; // 21,000,000 (# digits, without commas)\n    case mBTC: return 11; // 21,000,000,000\n    case uBTC: return 14; // 21,000,000,000,000\n    default: return 0;\n    }\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  nt BitcoinUnits::amountDigits(int unit)\n  {\n      switch(unit)\n      {\n      case BTC: return 8; // 21,000,000 (# digits, without commas)\n      case mBTC: return 11; // 21,000,000,000\n      case uBTC: return 14; // 21,000,000,000,000\n      default: return 0;\n      }\n  }\n}"
  },
  {
    "function_name": "factor(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "55-64",
    "snippet": "int64 BitcoinUnits::factor(int unit)\n{\n    switch(unit)\n    {\n    case BTC:  return 100000000;\n    case mBTC: return 100000;\n    case uBTC: return 100;\n    default:   return 100000000;\n    }\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  int64 BitcoinUnits::factor(int unit)\n  {\n      switch(unit)\n      {\n      case BTC:  return 100000000;\n      case mBTC: return 100000;\n      case uBTC: return 100;\n      default:   return 100000000;\n      }\n  }\n}"
  },
  {
    "function_name": "description(",
    "container": "itcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "44-53",
    "snippet": "String BitcoinUnits::description(int unit)\n{\n    switch(unit)\n    {\n    case BTC: return QString(\"halcyons\");\n    case mBTC: return QString(\"Milli-halcyons (1 / 1,000)\");\n    case uBTC: return QString(\"Micro-halcyons (1 / 1,000,000)\");\n    default: return QString(\"???\");\n    }\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "???\")"
          ],
          "line": 51
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "Micro-halcyons (1 / 1,000,000)\")"
          ],
          "line": 50
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "Milli-halcyons (1 / 1,000)\")"
          ],
          "line": 49
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "halcyons\")"
          ],
          "line": 48
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nitcoinUnits {\n  String BitcoinUnits::description(int unit)\n  {\n      switch(unit)\n      {\n      case BTC: return QString(\"halcyons\");\n      case mBTC: return QString(\"Milli-halcyons (1 / 1,000)\");\n      case uBTC: return QString(\"Micro-halcyons (1 / 1,000,000)\");\n      default: return QString(\"???\");\n      }\n  }\n}"
  },
  {
    "function_name": "name",
    "container": "BitcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "33-42",
    "snippet": "QString BitcoinUnits::name(int unit)\n{\n    switch(unit)\n    {\n    case BTC: return QString(\"HAL\");\n    case mBTC: return QString(\"mHAL\");\n    case uBTC: return QString::fromUtf8(\"μHAL\");\n    default: return QString(\"???\");\n    }\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "String(",
          "args": [
            "???\")"
          ],
          "line": 40
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString::fromUtf8",
          "args": [
            "\"μHAL\")"
          ],
          "line": 39
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"mHAL\""
          ],
          "line": 38
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QString",
          "args": [
            "\"HAL\""
          ],
          "line": 37
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nBitcoinUnits {\n  QString BitcoinUnits::name(int unit)\n  {\n      switch(unit)\n      {\n      case BTC: return QString(\"HAL\");\n      case mBTC: return QString(\"mHAL\");\n      case uBTC: return QString::fromUtf8(\"μHAL\");\n      default: return QString(\"???\");\n      }\n  }\n}"
  },
  {
    "function_name": "valid",
    "container": "BitcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "20-31",
    "snippet": "bool BitcoinUnits::valid(int unit)\n{\n    switch(unit)\n    {\n    case BTC:\n    case mBTC:\n    case uBTC:\n        return true;\n    default:\n        return false;\n    }\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nBitcoinUnits {\n  bool BitcoinUnits::valid(int unit)\n  {\n      switch(unit)\n      {\n      case BTC:\n      case mBTC:\n      case uBTC:\n          return true;\n      default:\n          return false;\n      }\n  }\n}"
  },
  {
    "function_name": "availableUnits",
    "container": "BitcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "11-18",
    "snippet": "QList<BitcoinUnits::Unit> BitcoinUnits::availableUnits()\n{\n    QList<BitcoinUnits::Unit> unitlist;\n    unitlist.append(BTC);\n    unitlist.append(mBTC);\n    unitlist.append(uBTC);\n    return unitlist;\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "unitlist.append",
          "args": [
            "uBTC"
          ],
          "line": 16
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unitlist.append",
          "args": [
            "mBTC"
          ],
          "line": 15
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "unitlist.append",
          "args": [
            "BTC"
          ],
          "line": 14
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nBitcoinUnits {\n  QList<BitcoinUnits::Unit> BitcoinUnits::availableUnits()\n  {\n      QList<BitcoinUnits::Unit> unitlist;\n      unitlist.append(BTC);\n      unitlist.append(mBTC);\n      unitlist.append(uBTC);\n      return unitlist;\n  }\n}"
  },
  {
    "function_name": "BitcoinUnits",
    "container": "BitcoinUnits",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
    "lines": "5-9",
    "snippet": "BitcoinUnits::BitcoinUnits(QObject *parent):\n        QAbstractListModel(parent),\n        unitlist(availableUnits())\n{\n}",
    "includes": [
      "#include <QStringList>",
      "#include \"bitcoinunits.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "availableUnits",
          "args": [],
          "line": 7
        },
        "resolved": true,
        "details": {
          "function_name": "availableUnits",
          "container": "BitcoinUnits",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinunits.cpp",
          "lines": "11-18",
          "snippet": "QList<BitcoinUnits::Unit> BitcoinUnits::availableUnits()\n{\n    QList<BitcoinUnits::Unit> unitlist;\n    unitlist.append(BTC);\n    unitlist.append(mBTC);\n    unitlist.append(uBTC);\n    return unitlist;\n}",
          "includes": [
            "#include <QStringList>",
            "#include \"bitcoinunits.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nBitcoinUnits {\n  QList<BitcoinUnits::Unit> BitcoinUnits::availableUnits()\n  {\n      QList<BitcoinUnits::Unit> unitlist;\n      unitlist.append(BTC);\n      unitlist.append(mBTC);\n      unitlist.append(uBTC);\n      return unitlist;\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QStringList>\n#include \"bitcoinunits.h\"\n\nBitcoinUnits {\n  BitcoinUnits::BitcoinUnits(QObject *parent):\n          QAbstractListModel(parent),\n          unitlist(availableUnits())\n  {\n  }\n}"
  }
]