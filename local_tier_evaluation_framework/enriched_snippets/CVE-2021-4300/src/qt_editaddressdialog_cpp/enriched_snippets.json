[
  {
    "function_name": "setAddress",
    "container": "EditAddressDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
    "lines": "132-136",
    "snippet": "void EditAddressDialog::setAddress(const QString &address)\n{\n    this->address = address;\n    ui->addressEdit->setText(address);\n}",
    "includes": [
      "#include <QMessageBox>",
      "#include <QDataWidgetMapper>",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_editaddressdialog.h\"",
      "#include \"editaddressdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "ui->addressEdit->setText",
          "args": [
            "address"
          ],
          "line": 135
        },
        "resolved": true,
        "details": {
          "function_name": "setText",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "48-54",
          "snippet": "void BitcoinAmountField::setText(const QString &text)\n{\n    if (text.isEmpty())\n        amount->clear();\n    else\n        amount->setValue(text.toDouble());\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  void BitcoinAmountField::setText(const QString &text)\n  {\n      if (text.isEmpty())\n          amount->clear();\n      else\n          amount->setValue(text.toDouble());\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::setAddress(const QString &address)\n  {\n      this->address = address;\n      ui->addressEdit->setText(address);\n  }\n}"
  },
  {
    "function_name": "getAddress",
    "container": "EditAddressDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
    "lines": "127-130",
    "snippet": "QString EditAddressDialog::getAddress() const\n{\n    return address;\n}",
    "includes": [
      "#include <QMessageBox>",
      "#include <QDataWidgetMapper>",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_editaddressdialog.h\"",
      "#include \"editaddressdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  QString EditAddressDialog::getAddress() const\n  {\n      return address;\n  }\n}"
  },
  {
    "function_name": "accept",
    "container": "EditAddressDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
    "lines": "85-125",
    "snippet": "void EditAddressDialog::accept()\n{\n    if(!model)\n        return;\n\n    if(!saveCurrentRow())\n    {\n        switch(model->getEditStatus())\n        {\n        case AddressTableModel::OK:\n            // Failed with unknown reason. Just reject.\n            break;\n        case AddressTableModel::NO_CHANGES:\n            // No changes were made during edit operation. Just reject.\n            break;\n        case AddressTableModel::INVALID_ADDRESS:\n            QMessageBox::warning(this, windowTitle(),\n                tr(\"The entered address \\\"%1\\\" is not a valid Halcyon address.\").arg(ui->addressEdit->text()),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::DUPLICATE_ADDRESS:\n            QMessageBox::warning(this, windowTitle(),\n                tr(\"The entered address \\\"%1\\\" is already in the address book.\").arg(ui->addressEdit->text()),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::WALLET_UNLOCK_FAILURE:\n            QMessageBox::critical(this, windowTitle(),\n                tr(\"Could not unlock wallet.\"),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::KEY_GENERATION_FAILURE:\n            QMessageBox::critical(this, windowTitle(),\n                tr(\"New key generation failed.\"),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n\n        }\n        return;\n    }\n    QDialog::accept();\n}",
    "includes": [
      "#include <QMessageBox>",
      "#include <QDataWidgetMapper>",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_editaddressdialog.h\"",
      "#include \"editaddressdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "QDialog::accept",
          "args": [],
          "line": 124
        },
        "resolved": true,
        "details": {
          "function_name": "accept",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "85-125",
          "snippet": "void EditAddressDialog::accept()\n{\n    if(!model)\n        return;\n\n    if(!saveCurrentRow())\n    {\n        switch(model->getEditStatus())\n        {\n        case AddressTableModel::OK:\n            // Failed with unknown reason. Just reject.\n            break;\n        case AddressTableModel::NO_CHANGES:\n            // No changes were made during edit operation. Just reject.\n            break;\n        case AddressTableModel::INVALID_ADDRESS:\n            QMessageBox::warning(this, windowTitle(),\n                tr(\"The entered address \\\"%1\\\" is not a valid Halcyon address.\").arg(ui->addressEdit->text()),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::DUPLICATE_ADDRESS:\n            QMessageBox::warning(this, windowTitle(),\n                tr(\"The entered address \\\"%1\\\" is already in the address book.\").arg(ui->addressEdit->text()),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::WALLET_UNLOCK_FAILURE:\n            QMessageBox::critical(this, windowTitle(),\n                tr(\"Could not unlock wallet.\"),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n        case AddressTableModel::KEY_GENERATION_FAILURE:\n            QMessageBox::critical(this, windowTitle(),\n                tr(\"New key generation failed.\"),\n                QMessageBox::Ok, QMessageBox::Ok);\n            break;\n\n        }\n        return;\n    }\n    QDialog::accept();\n}",
          "note": "cyclic_reference_detected"
        }
      },
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "windowTitle()",
            "tr(\"New key generation failed.\")",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"New key generation failed.\""
          ],
          "line": 117
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "windowTitle",
          "args": [],
          "line": 116
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::critical",
          "args": [
            "this",
            "windowTitle()",
            "tr(\"Could not unlock wallet.\")",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "windowTitle",
          "args": [],
          "line": 111
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "windowTitle()",
            "tr(\"The entered address \\\"%1\\\" is already in the address book.\").arg(ui->addressEdit->text())",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->addressEdit->text",
          "args": [],
          "line": 107
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "windowTitle",
          "args": [],
          "line": 106
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "QMessageBox::warning",
          "args": [
            "this",
            "windowTitle()",
            "tr(\"The entered address \\\"%1\\\" is not a valid Halcyon address.\").arg(ui->addressEdit->text())",
            "QMessageBox::Ok",
            "QMessageBox::Ok"
          ],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "windowTitle",
          "args": [],
          "line": 101
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->getEditStatus",
          "args": [],
          "line": 92
        },
        "resolved": true,
        "details": {
          "function_name": "getEditStatus",
          "container": "AddressTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.h",
          "lines": "69-69",
          "snippet": "EditStatus getEditStatus() const { return editStatus; }",
          "includes": [
            "#include <QStringList>",
            "#include <QAbstractTableModel>"
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QStringList>\n#include <QAbstractTableModel>\n\nAddressTableModel {\n  EditStatus getEditStatus() const { return editStatus; }\n}"
        }
      },
      {
        "call_info": {
          "callee": "saveCurrentRow",
          "args": [],
          "line": 90
        },
        "resolved": true,
        "details": {
          "function_name": "saveCurrentRow",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "60-83",
          "snippet": "bool EditAddressDialog::saveCurrentRow()\n{\n    if(!model)\n        return false;\n\n    switch(mode)\n    {\n    case NewReceivingAddress:\n    case NewSendingAddress:\n        address = model->addRow(\n                mode == NewSendingAddress ? AddressTableModel::Send : AddressTableModel::Receive,\n                ui->labelEdit->text(),\n                ui->addressEdit->text());\n        break;\n    case EditReceivingAddress:\n    case EditSendingAddress:\n        if(mapper->submit())\n        {\n            address = ui->addressEdit->text();\n        }\n        break;\n    }\n    return !address.isEmpty();\n}",
          "includes": [
            "#include <QMessageBox>",
            "#include <QDataWidgetMapper>",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\"",
            "#include \"ui_editaddressdialog.h\"",
            "#include \"editaddressdialog.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  bool EditAddressDialog::saveCurrentRow()\n  {\n      if(!model)\n          return false;\n  \n      switch(mode)\n      {\n      case NewReceivingAddress:\n      case NewSendingAddress:\n          address = model->addRow(\n                  mode == NewSendingAddress ? AddressTableModel::Send : AddressTableModel::Receive,\n                  ui->labelEdit->text(),\n                  ui->addressEdit->text());\n          break;\n      case EditReceivingAddress:\n      case EditSendingAddress:\n          if(mapper->submit())\n          {\n              address = ui->addressEdit->text();\n          }\n          break;\n      }\n      return !address.isEmpty();\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::accept()\n  {\n      if(!model)\n          return;\n  \n      if(!saveCurrentRow())\n      {\n          switch(model->getEditStatus())\n          {\n          case AddressTableModel::OK:\n              // Failed with unknown reason. Just reject.\n              break;\n          case AddressTableModel::NO_CHANGES:\n              // No changes were made during edit operation. Just reject.\n              break;\n          case AddressTableModel::INVALID_ADDRESS:\n              QMessageBox::warning(this, windowTitle(),\n                  tr(\"The entered address \\\"%1\\\" is not a valid Halcyon address.\").arg(ui->addressEdit->text()),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::DUPLICATE_ADDRESS:\n              QMessageBox::warning(this, windowTitle(),\n                  tr(\"The entered address \\\"%1\\\" is already in the address book.\").arg(ui->addressEdit->text()),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::WALLET_UNLOCK_FAILURE:\n              QMessageBox::critical(this, windowTitle(),\n                  tr(\"Could not unlock wallet.\"),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n          case AddressTableModel::KEY_GENERATION_FAILURE:\n              QMessageBox::critical(this, windowTitle(),\n                  tr(\"New key generation failed.\"),\n                  QMessageBox::Ok, QMessageBox::Ok);\n              break;\n  \n          }\n          return;\n      }\n      QDialog::accept();\n  }\n}"
  },
  {
    "function_name": "saveCurrentRow",
    "container": "EditAddressDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
    "lines": "60-83",
    "snippet": "bool EditAddressDialog::saveCurrentRow()\n{\n    if(!model)\n        return false;\n\n    switch(mode)\n    {\n    case NewReceivingAddress:\n    case NewSendingAddress:\n        address = model->addRow(\n                mode == NewSendingAddress ? AddressTableModel::Send : AddressTableModel::Receive,\n                ui->labelEdit->text(),\n                ui->addressEdit->text());\n        break;\n    case EditReceivingAddress:\n    case EditSendingAddress:\n        if(mapper->submit())\n        {\n            address = ui->addressEdit->text();\n        }\n        break;\n    }\n    return !address.isEmpty();\n}",
    "includes": [
      "#include <QMessageBox>",
      "#include <QDataWidgetMapper>",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_editaddressdialog.h\"",
      "#include \"editaddressdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "address.isEmpty",
          "args": [],
          "line": 82
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->addressEdit->text",
          "args": [],
          "line": 78
        },
        "resolved": true,
        "details": {
          "function_name": "text",
          "container": "BitcoinAmountField",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/bitcoinamountfield.cpp",
          "lines": "83-89",
          "snippet": "QString BitcoinAmountField::text() const\n{\n    if (amount->text().isEmpty())\n        return QString();\n    else\n        return amount->text();\n}",
          "includes": [
            "#include <qmath.h>",
            "#include <QApplication>",
            "#include <QComboBox>",
            "#include <QDoubleSpinBox>",
            "#include <QKeyEvent>",
            "#include <QHBoxLayout>",
            "#include <QRegExpValidator>",
            "#include <QLineEdit>",
            "#include <QLabel>",
            "#include \"guiconstants.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"qvaluecombobox.h\"",
            "#include \"bitcoinamountfield.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <qmath.h>\n#include <QApplication>\n#include <QComboBox>\n#include <QDoubleSpinBox>\n#include <QKeyEvent>\n#include <QHBoxLayout>\n#include <QRegExpValidator>\n#include <QLineEdit>\n#include <QLabel>\n#include \"guiconstants.h\"\n#include \"bitcoinunits.h\"\n#include \"qvaluecombobox.h\"\n#include \"bitcoinamountfield.h\"\n\nBitcoinAmountField {\n  QString BitcoinAmountField::text() const\n  {\n      if (amount->text().isEmpty())\n          return QString();\n      else\n          return amount->text();\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapper->submit",
          "args": [],
          "line": 76
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "model->addRow",
          "args": [
            "mode == NewSendingAddress ? AddressTableModel::Send : AddressTableModel::Receive",
            "ui->labelEdit->text()",
            "ui->addressEdit->text()"
          ],
          "line": 69
        },
        "resolved": true,
        "details": {
          "function_name": "addRow",
          "container": "AddressTableModel",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/addresstablemodel.cpp",
          "lines": "321-374",
          "snippet": "QString AddressTableModel::addRow(const QString &type, const QString &label, const QString &address)\n{\n    std::string strLabel = label.toStdString();\n    std::string strAddress = address.toStdString();\n\n    editStatus = OK;\n\n    if(type == Send)\n    {\n        if(!walletModel->validateAddress(address))\n        {\n            editStatus = INVALID_ADDRESS;\n            return QString();\n        }\n        // Check for duplicate addresses\n        {\n            LOCK(wallet->cs_wallet);\n            if(wallet->mapAddressBook.count(CBitcoinAddress(strAddress).Get()))\n            {\n                editStatus = DUPLICATE_ADDRESS;\n                return QString();\n            }\n        }\n    }\n    else if(type == Receive)\n    {\n        // Generate a new address to associate with given label\n        WalletModel::UnlockContext ctx(walletModel->requestUnlock());\n        if(!ctx.isValid())\n        {\n            // Unlock wallet failed or was cancelled\n            editStatus = WALLET_UNLOCK_FAILURE;\n            return QString();\n        }\n        CPubKey newKey;\n        if(!wallet->GetKeyFromPool(newKey, true))\n        {\n            editStatus = KEY_GENERATION_FAILURE;\n            return QString();\n        }\n        strAddress = CBitcoinAddress(newKey.GetID()).ToString();\n    }\n    else\n    {\n        return QString();\n    }\n\n    // Add entry\n    {\n        LOCK(wallet->cs_wallet);\n        wallet->SetAddressBookName(CBitcoinAddress(strAddress).Get(), strLabel);\n    }\n    return QString::fromStdString(strAddress);\n}",
          "includes": [
            "#include <QColor>",
            "#include <QFont>",
            "#include \"base58.h\"",
            "#include \"wallet.h\"",
            "#include \"walletmodel.h\"",
            "#include \"guiutil.h\"",
            "#include \"addresstablemodel.h\""
          ],
          "macros_used": [],
          "globals_used": [
            "const QString AddressTableModel::Send = \"S\";",
            "const QString AddressTableModel::Receive = \"R\";"
          ],
          "called_functions": [],
          "contextual_snippet": "#include <QColor>\n#include <QFont>\n#include \"base58.h\"\n#include \"wallet.h\"\n#include \"walletmodel.h\"\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n\nconst QString AddressTableModel::Send = \"S\";\nconst QString AddressTableModel::Receive = \"R\";\n\nAddressTableModel {\n  QString AddressTableModel::addRow(const QString &type, const QString &label, const QString &address)\n  {\n      std::string strLabel = label.toStdString();\n      std::string strAddress = address.toStdString();\n  \n      editStatus = OK;\n  \n      if(type == Send)\n      {\n          if(!walletModel->validateAddress(address))\n          {\n              editStatus = INVALID_ADDRESS;\n              return QString();\n          }\n          // Check for duplicate addresses\n          {\n              LOCK(wallet->cs_wallet);\n              if(wallet->mapAddressBook.count(CBitcoinAddress(strAddress).Get()))\n              {\n                  editStatus = DUPLICATE_ADDRESS;\n                  return QString();\n              }\n          }\n      }\n      else if(type == Receive)\n      {\n          // Generate a new address to associate with given label\n          WalletModel::UnlockContext ctx(walletModel->requestUnlock());\n          if(!ctx.isValid())\n          {\n              // Unlock wallet failed or was cancelled\n              editStatus = WALLET_UNLOCK_FAILURE;\n              return QString();\n          }\n          CPubKey newKey;\n          if(!wallet->GetKeyFromPool(newKey, true))\n          {\n              editStatus = KEY_GENERATION_FAILURE;\n              return QString();\n          }\n          strAddress = CBitcoinAddress(newKey.GetID()).ToString();\n      }\n      else\n      {\n          return QString();\n      }\n  \n      // Add entry\n      {\n          LOCK(wallet->cs_wallet);\n          wallet->SetAddressBookName(CBitcoinAddress(strAddress).Get(), strLabel);\n      }\n      return QString::fromStdString(strAddress);\n  }\n}"
        }
      }
    ],
    "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  bool EditAddressDialog::saveCurrentRow()\n  {\n      if(!model)\n          return false;\n  \n      switch(mode)\n      {\n      case NewReceivingAddress:\n      case NewSendingAddress:\n          address = model->addRow(\n                  mode == NewSendingAddress ? AddressTableModel::Send : AddressTableModel::Receive,\n                  ui->labelEdit->text(),\n                  ui->addressEdit->text());\n          break;\n      case EditReceivingAddress:\n      case EditSendingAddress:\n          if(mapper->submit())\n          {\n              address = ui->addressEdit->text();\n          }\n          break;\n      }\n      return !address.isEmpty();\n  }\n}"
  },
  {
    "function_name": "loadRow",
    "container": "EditAddressDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
    "lines": "55-58",
    "snippet": "void EditAddressDialog::loadRow(int row)\n{\n    mapper->setCurrentIndex(row);\n}",
    "includes": [
      "#include <QMessageBox>",
      "#include <QDataWidgetMapper>",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_editaddressdialog.h\"",
      "#include \"editaddressdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapper->setCurrentIndex",
          "args": [
            "row"
          ],
          "line": 57
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::loadRow(int row)\n  {\n      mapper->setCurrentIndex(row);\n  }\n}"
  },
  {
    "function_name": "setModel",
    "container": "EditAddressDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
    "lines": "44-53",
    "snippet": "void EditAddressDialog::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    mapper->setModel(model);\n    mapper->addMapping(ui->labelEdit, AddressTableModel::Label);\n    mapper->addMapping(ui->addressEdit, AddressTableModel::Address);\n}",
    "includes": [
      "#include <QMessageBox>",
      "#include <QDataWidgetMapper>",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_editaddressdialog.h\"",
      "#include \"editaddressdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapper->addMapping",
          "args": [
            "ui->addressEdit",
            "AddressTableModel::Address"
          ],
          "line": 52
        },
        "resolved": true,
        "details": {
          "function_name": "addMapping",
          "container": "MonitoredDataMapper",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/monitoreddatamapper.cpp",
          "lines": "13-17",
          "snippet": "void MonitoredDataMapper::addMapping(QWidget *widget, int section)\n{\n    QDataWidgetMapper::addMapping(widget, section);\n    addChangeMonitor(widget);\n}",
          "includes": [
            "#include <QMetaProperty>",
            "#include <QMetaObject>",
            "#include <QWidget>",
            "#include \"monitoreddatamapper.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QMetaProperty>\n#include <QMetaObject>\n#include <QWidget>\n#include \"monitoreddatamapper.h\"\n\nMonitoredDataMapper {\n  void MonitoredDataMapper::addMapping(QWidget *widget, int section)\n  {\n      QDataWidgetMapper::addMapping(widget, section);\n      addChangeMonitor(widget);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "mapper->setModel",
          "args": [
            "model"
          ],
          "line": 50
        },
        "resolved": true,
        "details": {
          "function_name": "setModel",
          "container": "EditAddressDialog",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
          "lines": "44-53",
          "snippet": "void EditAddressDialog::setModel(AddressTableModel *model)\n{\n    this->model = model;\n    if(!model)\n        return;\n\n    mapper->setModel(model);\n    mapper->addMapping(ui->labelEdit, AddressTableModel::Label);\n    mapper->addMapping(ui->addressEdit, AddressTableModel::Address);\n}",
          "note": "cyclic_reference_detected"
        }
      }
    ],
    "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  void EditAddressDialog::setModel(AddressTableModel *model)\n  {\n      this->model = model;\n      if(!model)\n          return;\n  \n      mapper->setModel(model);\n      mapper->addMapping(ui->labelEdit, AddressTableModel::Label);\n      mapper->addMapping(ui->addressEdit, AddressTableModel::Address);\n  }\n}"
  },
  {
    "function_name": "~EditAddressDialog",
    "container": "EditAddressDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
    "lines": "39-42",
    "snippet": "EditAddressDialog::~EditAddressDialog()\n{\n    delete ui;\n}",
    "includes": [
      "#include <QMessageBox>",
      "#include <QDataWidgetMapper>",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_editaddressdialog.h\"",
      "#include \"editaddressdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [],
    "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  EditAddressDialog::~EditAddressDialog()\n  {\n      delete ui;\n  }\n}"
  },
  {
    "function_name": "EditAddressDialog",
    "container": "EditAddressDialog",
    "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/editaddressdialog.cpp",
    "lines": "9-37",
    "snippet": "EditAddressDialog::EditAddressDialog(Mode mode, QWidget *parent) :\n    QDialog(parent),\n    ui(new Ui::EditAddressDialog), mapper(0), mode(mode), model(0)\n{\n    ui->setupUi(this);\n\n    GUIUtil::setupAddressWidget(ui->addressEdit, this);\n\n    switch(mode)\n    {\n    case NewReceivingAddress:\n        setWindowTitle(tr(\"New receiving address\"));\n        ui->addressEdit->setEnabled(false);\n        break;\n    case NewSendingAddress:\n        setWindowTitle(tr(\"New sending address\"));\n        break;\n    case EditReceivingAddress:\n        setWindowTitle(tr(\"Edit receiving address\"));\n        ui->addressEdit->setEnabled(false);\n        break;\n    case EditSendingAddress:\n        setWindowTitle(tr(\"Edit sending address\"));\n        break;\n    }\n\n    mapper = new QDataWidgetMapper(this);\n    mapper->setSubmitPolicy(QDataWidgetMapper::ManualSubmit);\n}",
    "includes": [
      "#include <QMessageBox>",
      "#include <QDataWidgetMapper>",
      "#include \"guiutil.h\"",
      "#include \"addresstablemodel.h\"",
      "#include \"ui_editaddressdialog.h\"",
      "#include \"editaddressdialog.h\""
    ],
    "macros_used": [],
    "globals_used": [],
    "called_functions": [
      {
        "call_info": {
          "callee": "mapper->setSubmitPolicy",
          "args": [
            "QDataWidgetMapper::ManualSubmit"
          ],
          "line": 36
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"Edit sending address\")"
          ],
          "line": 31
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "tr",
          "args": [
            "\"Edit sending address\""
          ],
          "line": 31
        },
        "resolved": true,
        "details": {
          "function_name": "setValue",
          "container": "SendCoinsEntry",
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/sendcoinsentry.cpp",
          "lines": "150-155",
          "snippet": "void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n{\n    ui->payTo->setText(value.address);\n    ui->addAsLabel->setText(value.label);\n    ui->payAmount->setValue(value.amount);\n}",
          "includes": [
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include \"addresstablemodel.h\"",
            "#include \"optionsmodel.h\"",
            "#include \"walletmodel.h\"",
            "#include \"addressbookpage.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"guiutil.h\"",
            "#include \"ui_sendcoinsentry.h\"",
            "#include \"sendcoinsentry.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include <QClipboard>\n#include <QApplication>\n#include \"addresstablemodel.h\"\n#include \"optionsmodel.h\"\n#include \"walletmodel.h\"\n#include \"addressbookpage.h\"\n#include \"bitcoinunits.h\"\n#include \"guiutil.h\"\n#include \"ui_sendcoinsentry.h\"\n#include \"sendcoinsentry.h\"\n\nSendCoinsEntry {\n  void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n  {\n      ui->payTo->setText(value.address);\n      ui->addAsLabel->setText(value.label);\n      ui->payAmount->setValue(value.amount);\n  }\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->addressEdit->setEnabled",
          "args": [
            "false"
          ],
          "line": 28
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"Edit receiving address\")"
          ],
          "line": 27
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"New sending address\")"
          ],
          "line": 24
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "ui->addressEdit->setEnabled",
          "args": [
            "false"
          ],
          "line": 21
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "setWindowTitle",
          "args": [
            "tr(\"New receiving address\")"
          ],
          "line": 20
        },
        "resolved": false,
        "reason": "library_or_external"
      },
      {
        "call_info": {
          "callee": "GUIUtil::setupAddressWidget",
          "args": [
            "ui->addressEdit",
            "this"
          ],
          "line": 15
        },
        "resolved": true,
        "details": {
          "function_name": "setupAddressWidget",
          "container": null,
          "file": "/home/michele/Desktop/ricerca/output_repos_cpp/CVE-2021-4300/repo/src/qt/guiutil.cpp",
          "lines": "62-67",
          "snippet": "void setupAddressWidget(QLineEdit *widget, QWidget *parent)\n{\n    widget->setMaxLength(BitcoinAddressValidator::MaxAddressLength);\n    widget->setValidator(new BitcoinAddressValidator(parent));\n    widget->setFont(bitcoinAddressFont());\n}",
          "includes": [
            "#include \"shellapi.h\"",
            "#include \"shlobj.h\"",
            "#include \"shlwapi.h\"",
            "#include <boost/filesystem/fstream.hpp>",
            "#include <boost/filesystem.hpp>",
            "#include <QThread>",
            "#include <QDesktopServices>",
            "#include <QFileDialog>",
            "#include <QClipboard>",
            "#include <QApplication>",
            "#include <QAbstractItemView>",
            "#include <QTextDocument> // For Qt::escape",
            "#include <QUrl>",
            "#include <QLineEdit>",
            "#include <QFont>",
            "#include <QDoubleValidator>",
            "#include <QDateTime>",
            "#include <QString>",
            "#include \"init.h\"",
            "#include \"util.h\"",
            "#include \"bitcoinunits.h\"",
            "#include \"walletmodel.h\"",
            "#include \"bitcoinaddressvalidator.h\"",
            "#include \"guiutil.h\""
          ],
          "macros_used": [],
          "globals_used": [],
          "called_functions": [],
          "contextual_snippet": "#include \"shellapi.h\"\n#include \"shlobj.h\"\n#include \"shlwapi.h\"\n#include <boost/filesystem/fstream.hpp>\n#include <boost/filesystem.hpp>\n#include <QThread>\n#include <QDesktopServices>\n#include <QFileDialog>\n#include <QClipboard>\n#include <QApplication>\n#include <QAbstractItemView>\n#include <QTextDocument> // For Qt::escape\n#include <QUrl>\n#include <QLineEdit>\n#include <QFont>\n#include <QDoubleValidator>\n#include <QDateTime>\n#include <QString>\n#include \"init.h\"\n#include \"util.h\"\n#include \"bitcoinunits.h\"\n#include \"walletmodel.h\"\n#include \"bitcoinaddressvalidator.h\"\n#include \"guiutil.h\"\n\nvoid setupAddressWidget(QLineEdit *widget, QWidget *parent)\n{\n    widget->setMaxLength(BitcoinAddressValidator::MaxAddressLength);\n    widget->setValidator(new BitcoinAddressValidator(parent));\n    widget->setFont(bitcoinAddressFont());\n}"
        }
      },
      {
        "call_info": {
          "callee": "ui->setupUi",
          "args": [
            "this"
          ],
          "line": 13
        },
        "resolved": false,
        "reason": "library_or_external"
      }
    ],
    "contextual_snippet": "#include <QMessageBox>\n#include <QDataWidgetMapper>\n#include \"guiutil.h\"\n#include \"addresstablemodel.h\"\n#include \"ui_editaddressdialog.h\"\n#include \"editaddressdialog.h\"\n\nEditAddressDialog {\n  EditAddressDialog::EditAddressDialog(Mode mode, QWidget *parent) :\n      QDialog(parent),\n      ui(new Ui::EditAddressDialog), mapper(0), mode(mode), model(0)\n  {\n      ui->setupUi(this);\n  \n      GUIUtil::setupAddressWidget(ui->addressEdit, this);\n  \n      switch(mode)\n      {\n      case NewReceivingAddress:\n          setWindowTitle(tr(\"New receiving address\"));\n          ui->addressEdit->setEnabled(false);\n          break;\n      case NewSendingAddress:\n          setWindowTitle(tr(\"New sending address\"));\n          break;\n      case EditReceivingAddress:\n          setWindowTitle(tr(\"Edit receiving address\"));\n          ui->addressEdit->setEnabled(false);\n          break;\n      case EditSendingAddress:\n          setWindowTitle(tr(\"Edit sending address\"));\n          break;\n      }\n  \n      mapper = new QDataWidgetMapper(this);\n      mapper->setSubmitPolicy(QDataWidgetMapper::ManualSubmit);\n  }\n}"
  }
]